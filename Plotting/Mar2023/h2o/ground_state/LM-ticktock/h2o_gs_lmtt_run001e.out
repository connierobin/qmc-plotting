Rank =    0  Free Memory = 72998 MB
Rank =    1  Free Memory = 72998 MB
Rank =    2  Free Memory = 72998 MB
Rank =    3  Free Memory = 72998 MB
Rank =    4  Free Memory = 72998 MB
Rank =    5  Free Memory = 72997 MB
Rank =    6  Free Memory = 72996 MB
Rank =    7  Free Memory = 72996 MB
Rank =    8  Free Memory = 72996 MB
Rank =    9  Free Memory = 72996 MB
Rank =   10  Free Memory = 72996 MB
Rank =   11  Free Memory = 72996 MB
Rank =   12  Free Memory = 72996 MB
Rank =   13  Free Memory = 72996 MB
Rank =   14  Free Memory = 72995 MB
Rank =   15  Free Memory = 72981 MB
Rank =   16  Free Memory = 72981 MB
Rank =   17  Free Memory = 72981 MB
Rank =   18  Free Memory = 72981 MB
Rank =   19  Free Memory = 72981 MB
Rank =   20  Free Memory = 72981 MB
Rank =   21  Free Memory = 72981 MB
Rank =   22  Free Memory = 72981 MB
Rank =   23  Free Memory = 72981 MB
Rank =   24  Free Memory = 72981 MB
Rank =   25  Free Memory = 72981 MB
Rank =   26  Free Memory = 72981 MB
Rank =   27  Free Memory = 72981 MB
Rank =   28  Free Memory = 72981 MB
Rank =   29  Free Memory = 72981 MB
Rank =   30  Free Memory = 72981 MB
Rank =   31  Free Memory = 72981 MB
Rank =   32  Free Memory = 85250 MB
Rank =   33  Free Memory = 85250 MB
Rank =   34  Free Memory = 85250 MB
Rank =   35  Free Memory = 85250 MB
Rank =   36  Free Memory = 85250 MB
Rank =   37  Free Memory = 85250 MB
Rank =   38  Free Memory = 85250 MB
Rank =   39  Free Memory = 85250 MB
Rank =   40  Free Memory = 85250 MB
Rank =   41  Free Memory = 85250 MB
Rank =   42  Free Memory = 85250 MB
Rank =   43  Free Memory = 85250 MB
Rank =   44  Free Memory = 85250 MB
Rank =   45  Free Memory = 85250 MB
Rank =   46  Free Memory = 85250 MB
Rank =   47  Free Memory = 85250 MB
Rank =   48  Free Memory = 85250 MB
Rank =   49  Free Memory = 85250 MB
Rank =   50  Free Memory = 85250 MB
Rank =   51  Free Memory = 85250 MB
Rank =   52  Free Memory = 85250 MB
Rank =   53  Free Memory = 85250 MB
Rank =   54  Free Memory = 85250 MB
Rank =   55  Free Memory = 85250 MB
Rank =   56  Free Memory = 85250 MB
Rank =   57  Free Memory = 85250 MB
Rank =   58  Free Memory = 85250 MB
Rank =   59  Free Memory = 85250 MB
Rank =   60  Free Memory = 85250 MB
Rank =   61  Free Memory = 85250 MB
Rank =   62  Free Memory = 85250 MB
Rank =   63  Free Memory = 85250 MB
Rank =   64  Free Memory = 84646 MB
Rank =   65  Free Memory = 84646 MB
Rank =   66  Free Memory = 84645 MB
Rank =   67  Free Memory = 84645 MB
Rank =   68  Free Memory = 84645 MB
Rank =   69  Free Memory = 84645 MB
Rank =   70  Free Memory = 84645 MB
Rank =   71  Free Memory = 84645 MB
Rank =   72  Free Memory = 84645 MB
Rank =   73  Free Memory = 84645 MB
Rank =   74  Free Memory = 84644 MB
Rank =   75  Free Memory = 84644 MB
Rank =   76  Free Memory = 84644 MB
Rank =   77  Free Memory = 84644 MB
Rank =   78  Free Memory = 84644 MB
Rank =   79  Free Memory = 84644 MB
Rank =   80  Free Memory = 84644 MB
Rank =   81  Free Memory = 84644 MB
Rank =   82  Free Memory = 84644 MB
Rank =   83  Free Memory = 84644 MB
Rank =   84  Free Memory = 84644 MB
Rank =   85  Free Memory = 84644 MB
Rank =   86  Free Memory = 84644 MB
Rank =   87  Free Memory = 84644 MB
Rank =   88  Free Memory = 84644 MB
Rank =   89  Free Memory = 84644 MB
Rank =   90  Free Memory = 84644 MB
Rank =   91  Free Memory = 84644 MB
Rank =   92  Free Memory = 84644 MB
Rank =   93  Free Memory = 84644 MB
Rank =   94  Free Memory = 84644 MB
Rank =   95  Free Memory = 84644 MB
Rank =   96  Free Memory = 84347 MB
Rank =   97  Free Memory = 84347 MB
Rank =   98  Free Memory = 84347 MB
Rank =   99  Free Memory = 84347 MB
Rank =  100  Free Memory = 84347 MB
Rank =  101  Free Memory = 84347 MB
Rank =  102  Free Memory = 84347 MB
Rank =  103  Free Memory = 84347 MB
Rank =  104  Free Memory = 84347 MB
Rank =  105  Free Memory = 84347 MB
Rank =  106  Free Memory = 84347 MB
Rank =  107  Free Memory = 84347 MB
Rank =  108  Free Memory = 84347 MB
Rank =  109  Free Memory = 84347 MB
Rank =  110  Free Memory = 84347 MB
Rank =  111  Free Memory = 84347 MB
Rank =  112  Free Memory = 84347 MB
Rank =  113  Free Memory = 84347 MB
Rank =  114  Free Memory = 84347 MB
Rank =  115  Free Memory = 84347 MB
Rank =  116  Free Memory = 84347 MB
Rank =  117  Free Memory = 84347 MB
Rank =  118  Free Memory = 84347 MB
Rank =  119  Free Memory = 84347 MB
Rank =  120  Free Memory = 84347 MB
Rank =  121  Free Memory = 84347 MB
Rank =  122  Free Memory = 84347 MB
Rank =  123  Free Memory = 84347 MB
Rank =  124  Free Memory = 84347 MB
Rank =  125  Free Memory = 84347 MB
Rank =  126  Free Memory = 84347 MB
Rank =  127  Free Memory = 84347 MB
  Input file(s): opt_h2o_gs_lmtt_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001e.xml

  Project = H2O
  date    = 2023-03-06 10:37:47 PST
  host    = n0117.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 763

  Range of prime numbers to use as seeds over processors and threads = 5827-6959


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.911967e-01    1         1 OFF
     uu_1                 2.952136e-02    1         1 OFF
     uu_2                -6.465040e-02    1         1 OFF
     uu_3                -1.204190e-01    1         1 OFF
     uu_4                -1.562044e-01    1         1 OFF
     uu_5                -1.681909e-01    1         1 OFF
     uu_6                -1.563004e-01    1         1 OFF
     uu_7                -1.093951e-01    1         1 OFF
     uu_8                -3.891562e-02    1         1 OFF
     uu_9                 2.013265e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.529731e-01    1         1 OFF
     ud_1                 9.540209e-02    1         1 OFF
     ud_2                -1.296613e-02    1         1 OFF
     ud_3                -7.411366e-02    1         1 OFF
     ud_4                -1.245724e-01    1         1 OFF
     ud_5                -1.629623e-01    1         1 OFF
     ud_6                -1.779116e-01    1         1 OFF
     ud_7                -1.588952e-01    1         1 OFF
     ud_8                -1.113543e-01    1         1 OFF
     ud_9                 3.229722e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.136376e-01    1         1 OFF
     eO_1                -5.950502e-01    1         1 OFF
     eO_2                -1.857512e-01    1         1 OFF
     eO_3                 8.168652e-02    1         1 OFF
     eO_4                 2.059842e-01    1         1 OFF
     eO_5                 2.973205e-01    1         1 OFF
     eO_6                 3.259205e-01    1         1 OFF
     eO_7                 5.328910e-01    1         1 OFF
     eO_8                 1.580914e-01    1         1 OFF
     eO_9                 5.331355e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.218423e-01    1         1 OFF
     eH1_1                -1.430037e-01    1         1 OFF
     eH1_2                -1.019338e-01    1         1 OFF
     eH1_3                -6.433220e-02    1         1 OFF
     eH1_4                -1.811495e-02    1         1 OFF
     eH1_5                -4.815560e-03    1         1 OFF
     eH1_6                 3.565050e-02    1         1 OFF
     eH1_7                 7.899260e-02    1         1 OFF
     eH1_8                 2.643002e-01    1         1 OFF
     eH1_9                 1.135317e-01    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.106720e-01    1         1 OFF
     eH2_1                -1.318816e-01    1         1 OFF
     eH2_2                -9.075272e-02    1         1 OFF
     eH2_3                -5.299842e-02    1         1 OFF
     eH2_4                -6.342495e-03    1         1 OFF
     eH2_5                 5.548739e-03    1         1 OFF
     eH2_6                 4.766135e-02    1         1 OFF
     eH2_7                 3.899821e-02    1         1 OFF
     eH2_8                 2.479170e-01    1         1 OFF
     eH2_9                 1.153680e-01    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.711083e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.0415e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.166291
====================================================
  Execution time = 1.5316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1887e-01
  Total weights = 1.957201180e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019943801
                                         uncertainty =       0.002440137036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303019943801
                                         uncertainty =       0.002440137036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389247352
  error estimate for blocks of size 2^( 2) =       0.000399019505
  error estimate for blocks of size 2^( 3) =       0.000407363919
  error estimate for blocks of size 2^( 4) =       0.000413802173
  error estimate for blocks of size 2^( 5) =       0.000417088537
  error estimate for blocks of size 2^( 6) =       0.000421030328
  error estimate for blocks of size 2^( 7) =       0.000421675875

      target function =                  N/A
              le_mean =     -17.216412510659
             les_mean =     296.723727134937
             stat err =       0.000418399228
             autocorr =       1.155394820389
              std dev =       0.550478884082
             le_variance =       0.303027001820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721641251066e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412510704       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216417649722       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216419435848       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216419277972       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.513776e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412510704       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414632858       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414775919       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414826946       residual = 2.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.880933e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412510704       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413144522       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413092359       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413122570       residual = 4.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 9.174303e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7923e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.060591e-02                3 1 ON  0
ci_002 -3.053279e-02                3 1 ON  1
ci_003 -2.520122e-02                3 1 ON  2
ci_004 2.154033e-02                 3 1 ON  3
ci_005 2.183731e-02                 3 1 ON  4
ci_006 -1.954146e-02                3 1 ON  5
ci_007 -1.979587e-02                3 1 ON  6
ci_008 -1.822952e-02                3 1 ON  7
ci_009 -1.816778e-02                3 1 ON  8
ci_010 -1.683630e-02                3 1 ON  9
ci_011 -1.619947e-02                3 1 ON  10
ci_012 -1.649869e-02                3 1 ON  11
ci_013 -1.911556e-02                3 1 ON  12
ci_014 1.397156e-02                 3 1 ON  13
ci_015 1.440229e-02                 3 1 ON  14
ci_016 1.612369e-02                 3 1 ON  15
ci_017 1.675962e-02                 3 1 ON  16
ci_018 1.301274e-02                 3 1 ON  17
ci_019 1.315963e-02                 3 1 ON  18
ci_020 1.381667e-02                 3 1 ON  19
ci_021 1.309505e-02                 3 1 ON  20
ci_022 1.184228e-02                 3 1 ON  21
ci_023 1.209274e-02                 3 1 ON  22
ci_024 1.106029e-02                 3 1 ON  23
ci_025 1.078398e-02                 3 1 ON  24
ci_026 1.201688e-02                 3 1 ON  25
ci_027 1.197470e-02                 3 1 ON  26
ci_028 -1.435362e-02                3 1 ON  27
ci_029 -1.458744e-02                3 1 ON  28
ci_030 -1.090500e-02                3 1 ON  29
ci_031 -1.098680e-02                3 1 ON  30
ci_032 -1.386248e-02                3 1 ON  31
ci_033 1.057036e-02                 3 1 ON  32
ci_034 1.051496e-02                 3 1 ON  33
ci_035 -4.866628e-03                3 1 ON  34
ci_036 -1.088689e-02                3 1 ON  35
ci_037 -1.099065e-02                3 1 ON  36
ci_038 1.312303e-03                 3 1 ON  37
ci_039 1.358543e-03                 3 1 ON  38
ci_040 -4.139075e-03                3 1 ON  39
ci_041 9.627979e-03                 3 1 ON  40
ci_042 9.941046e-03                 3 1 ON  41
ci_043 -3.507314e-03                3 1 ON  42
ci_044 -1.499881e-02                3 1 ON  43
ci_045 -1.737294e-03                3 1 ON  44
ci_046 5.492828e-03                 3 1 ON  45
ci_047 5.582134e-03                 3 1 ON  46
ci_048 -1.189686e-02                3 1 ON  47
ci_049 -1.193192e-02                3 1 ON  48
ci_050 7.573817e-03                 3 1 ON  49
ci_051 7.705572e-03                 3 1 ON  50
ci_052 -6.819467e-03                3 1 ON  51
ci_053 -6.765670e-03                3 1 ON  52
ci_054 -2.638071e-03                3 1 ON  53
ci_055 -2.229158e-03                3 1 ON  54
ci_056 4.763060e-03                 3 1 ON  55
ci_057 4.873818e-03                 3 1 ON  56
ci_058 -7.223165e-03                3 1 ON  57
ci_059 -6.943511e-03                3 1 ON  58
ci_060 8.763328e-03                 3 1 ON  59
ci_061 8.541920e-03                 3 1 ON  60
ci_062 -2.968321e-03                3 1 ON  61
ci_063 -2.901865e-03                3 1 ON  62
ci_064 -3.292440e-03                3 1 ON  63
ci_065 -4.297800e-03                3 1 ON  64
ci_066 6.012738e-03                 3 1 ON  65
ci_067 6.072767e-03                 3 1 ON  66
ci_068 -4.574287e-03                3 1 ON  67
ci_069 -4.752347e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.342593
====================================================
  Execution time = 1.4005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1403e-01
  Total weights = 1.9572e+06
  Execution time = 1.8374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302356431362
                                         uncertainty =       0.002651106102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302356431362
                                         uncertainty =       0.002651106102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388785286
  error estimate for blocks of size 2^( 2) =       0.000398997221
  error estimate for blocks of size 2^( 3) =       0.000408081270
  error estimate for blocks of size 2^( 4) =       0.000414277578
  error estimate for blocks of size 2^( 5) =       0.000418900978
  error estimate for blocks of size 2^( 6) =       0.000423145292
  error estimate for blocks of size 2^( 7) =       0.000425815107

      target function =                  N/A
              le_mean =     -17.217153561597
             les_mean =     296.745145324590
             stat err =       0.000420534739
             autocorr =       1.169995286983
              std dev =       0.549825424853
             le_variance =       0.302307997815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301830009438
                                         uncertainty =       0.002636392625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301830009438
                                         uncertainty =       0.002636392625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388446289
  error estimate for blocks of size 2^( 2) =       0.000398695650
  error estimate for blocks of size 2^( 3) =       0.000407820751
  error estimate for blocks of size 2^( 4) =       0.000414045942
  error estimate for blocks of size 2^( 5) =       0.000418714875
  error estimate for blocks of size 2^( 6) =       0.000422984781
  error estimate for blocks of size 2^( 7) =       0.000425661967

      target function =                  N/A
              le_mean =     -17.217152631399
             les_mean =     296.754466542802
             stat err =       0.000420351891
             autocorr =       1.171019313497
              std dev =       0.549346010129
             le_variance =       0.301781038844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301869069225
                                         uncertainty =       0.002640875776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301869069225
                                         uncertainty =       0.002640875776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388471527
  error estimate for blocks of size 2^( 2) =       0.000398715046
  error estimate for blocks of size 2^( 3) =       0.000407833384
  error estimate for blocks of size 2^( 4) =       0.000414054457
  error estimate for blocks of size 2^( 5) =       0.000418707741
  error estimate for blocks of size 2^( 6) =       0.000422970317
  error estimate for blocks of size 2^( 7) =       0.000425654721

      target function =                  N/A
              le_mean =     -17.217149213474
             les_mean =     296.744245756531
             stat err =       0.000420346809
             autocorr =       1.170838849927
              std dev =       0.549381701972
             le_variance =       0.301820254461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302270370372
                                         uncertainty =       0.002649628496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302270370372
                                         uncertainty =       0.002649628496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388729910
  error estimate for blocks of size 2^( 2) =       0.000398946619
  error estimate for blocks of size 2^( 3) =       0.000408036355
  error estimate for blocks of size 2^( 4) =       0.000414235666
  error estimate for blocks of size 2^( 5) =       0.000418862848
  error estimate for blocks of size 2^( 6) =       0.000423110305
  error estimate for blocks of size 2^( 7) =       0.000425783114

      target function =                  N/A
              le_mean =     -17.217151907661
             les_mean =     296.755857726107
             stat err =       0.000420497983
             autocorr =       1.170124082630
              std dev =       0.549747111464
             le_variance =       0.302221886563


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217153561597        initial  <--
     2.5000e-01     2.5000e+00             7.5138e-04       -17.217152631399
     1.0000e+00     1.0000e+01             2.8809e-04       -17.217149213474
     4.0000e+00     4.0000e+01             9.1743e-05       -17.217151907661

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2947
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1252e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.296013
====================================================
  Execution time = 1.4337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1854e-01
  Total weights = 1.957042404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302410067924
                                         uncertainty =       0.002245321937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302410067924
                                         uncertainty =       0.002245321937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388853825
  error estimate for blocks of size 2^( 2) =       0.000398082358
  error estimate for blocks of size 2^( 3) =       0.000406833650
  error estimate for blocks of size 2^( 4) =       0.000412743034
  error estimate for blocks of size 2^( 5) =       0.000416383626
  error estimate for blocks of size 2^( 6) =       0.000417486100
  error estimate for blocks of size 2^( 7) =       0.000418937498

      target function =                  N/A
              le_mean =     -17.216131143879
             les_mean =     296.713712369288
             stat err =       0.000416387565
             autocorr =       1.146628549711
              std dev =       0.549922353136
             le_variance =       0.302414594478


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613114388e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131143919       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216132196673       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216132240964       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216132242199       residual = 3.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.270107e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131143919       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131428374       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131448560       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131451757       residual = 4.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.486222e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131143919       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131216499       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131222233       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131223295       residual = 5.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 8.934859e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6863e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.084141e-02 3 1  ON 0
ci_002                -3.048385e-02 3 1  ON 1
ci_003                -2.522734e-02 3 1  ON 2
ci_004                 2.152435e-02 3 1  ON 3
ci_005                 2.187893e-02 3 1  ON 4
ci_006                -1.971441e-02 3 1  ON 5
ci_007                -2.003161e-02 3 1  ON 6
ci_008                -1.832774e-02 3 1  ON 7
ci_009                -1.833756e-02 3 1  ON 8
ci_010                -1.670407e-02 3 1  ON 9
ci_011                -1.624842e-02 3 1  ON 10
ci_012                -1.640208e-02 3 1  ON 11
ci_013                -1.885930e-02 3 1  ON 12
ci_014                 1.381465e-02 3 1  ON 13
ci_015                 1.458937e-02 3 1  ON 14
ci_016                 1.625922e-02 3 1  ON 15
ci_017                 1.672816e-02 3 1  ON 16
ci_018                 1.312624e-02 3 1  ON 17
ci_019                 1.330366e-02 3 1  ON 18
ci_020                 1.382336e-02 3 1  ON 19
ci_021                 1.327008e-02 3 1  ON 20
ci_022                 1.180107e-02 3 1  ON 21
ci_023                 1.190566e-02 3 1  ON 22
ci_024                 1.105802e-02 3 1  ON 23
ci_025                 1.094866e-02 3 1  ON 24
ci_026                 1.201131e-02 3 1  ON 25
ci_027                 1.189896e-02 3 1  ON 26
ci_028                -1.416807e-02 3 1  ON 27
ci_029                -1.461698e-02 3 1  ON 28
ci_030                -1.094162e-02 3 1  ON 29
ci_031                -1.092994e-02 3 1  ON 30
ci_032                -1.398890e-02 3 1  ON 31
ci_033                 1.053886e-02 3 1  ON 32
ci_034                 1.055858e-02 3 1  ON 33
ci_035                -5.139624e-03 3 1  ON 34
ci_036                -1.072891e-02 3 1  ON 35
ci_037                -1.102603e-02 3 1  ON 36
ci_038                 1.335726e-03 3 1  ON 37
ci_039                 1.309418e-03 3 1  ON 38
ci_040                -4.212119e-03 3 1  ON 39
ci_041                 9.575744e-03 3 1  ON 40
ci_042                 1.001604e-02 3 1  ON 41
ci_043                -3.590985e-03 3 1  ON 42
ci_044                -1.509415e-02 3 1  ON 43
ci_045                -1.836657e-03 3 1  ON 44
ci_046                 5.398637e-03 3 1  ON 45
ci_047                 5.666809e-03 3 1  ON 46
ci_048                -1.197565e-02 3 1  ON 47
ci_049                -1.195248e-02 3 1  ON 48
ci_050                 7.782530e-03 3 1  ON 49
ci_051                 7.617073e-03 3 1  ON 50
ci_052                -6.891396e-03 3 1  ON 51
ci_053                -6.804220e-03 3 1  ON 52
ci_054                -2.473715e-03 3 1  ON 53
ci_055                -2.293673e-03 3 1  ON 54
ci_056                 4.846918e-03 3 1  ON 55
ci_057                 5.117009e-03 3 1  ON 56
ci_058                -7.230815e-03 3 1  ON 57
ci_059                -7.027991e-03 3 1  ON 58
ci_060                 8.618705e-03 3 1  ON 59
ci_061                 8.457546e-03 3 1  ON 60
ci_062                -2.945282e-03 3 1  ON 61
ci_063                -2.917380e-03 3 1  ON 62
ci_064                -3.483239e-03 3 1  ON 63
ci_065                -4.420034e-03 3 1  ON 64
ci_066                 5.846846e-03 3 1  ON 65
ci_067                 5.939373e-03 3 1  ON 66
ci_068                -4.585662e-03 3 1  ON 67
ci_069                -4.724097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.244989
====================================================
  Execution time = 1.3981e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1644e-01
  Total weights = 1.9568e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303979218485
                                         uncertainty =       0.002121241318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303979218485
                                         uncertainty =       0.002121241318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389819499
  error estimate for blocks of size 2^( 2) =       0.000399380619
  error estimate for blocks of size 2^( 3) =       0.000408353089
  error estimate for blocks of size 2^( 4) =       0.000413952473
  error estimate for blocks of size 2^( 5) =       0.000417642324
  error estimate for blocks of size 2^( 6) =       0.000418672129
  error estimate for blocks of size 2^( 7) =       0.000419400181

      target function =                  N/A
              le_mean =     -17.216816771701
             les_mean =     296.735258711415
             stat err =       0.000417416777
             autocorr =       1.146601969543
              std dev =       0.551288021732
             le_variance =       0.303918482906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303852718816
                                         uncertainty =       0.002116606044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303852718816
                                         uncertainty =       0.002116606044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389738360
  error estimate for blocks of size 2^( 2) =       0.000399304572
  error estimate for blocks of size 2^( 3) =       0.000408279057
  error estimate for blocks of size 2^( 4) =       0.000413879555
  error estimate for blocks of size 2^( 5) =       0.000417570749
  error estimate for blocks of size 2^( 6) =       0.000418600438
  error estimate for blocks of size 2^( 7) =       0.000419333350

      target function =                  N/A
              le_mean =     -17.216819189145
             les_mean =     296.735201438561
             stat err =       0.000417346023
             autocorr =       1.146690596708
              std dev =       0.551173275147
             le_variance =       0.303791979236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303908633104
                                         uncertainty =       0.002118672727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303908633104
                                         uncertainty =       0.002118672727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389774227
  error estimate for blocks of size 2^( 2) =       0.000399338171
  error estimate for blocks of size 2^( 3) =       0.000408311703
  error estimate for blocks of size 2^( 4) =       0.000413911785
  error estimate for blocks of size 2^( 5) =       0.000417602126
  error estimate for blocks of size 2^( 6) =       0.000418632116
  error estimate for blocks of size 2^( 7) =       0.000419362819

      target function =                  N/A
              le_mean =     -17.216817873014
             les_mean =     296.735527250599
             stat err =       0.000417377212
             autocorr =       1.146650932793
              std dev =       0.551223998261
             le_variance =       0.303847896258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303970013403
                                         uncertainty =       0.002120909449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303970013403
                                         uncertainty =       0.002120909449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389813595
  error estimate for blocks of size 2^( 2) =       0.000399375070
  error estimate for blocks of size 2^( 3) =       0.000408347677
  error estimate for blocks of size 2^( 4) =       0.000413947126
  error estimate for blocks of size 2^( 5) =       0.000417637065
  error estimate for blocks of size 2^( 6) =       0.000418666904
  error estimate for blocks of size 2^( 7) =       0.000419395225

      target function =                  N/A
              le_mean =     -17.216816909390
             les_mean =     296.735486036646
             stat err =       0.000417411580
             autocorr =       1.146608147738
              std dev =       0.551279672882
             le_variance =       0.303909277732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216816771701        initial
     2.5000e+00     2.5000e+01             1.2701e-04       -17.216819189145  <--
     1.0000e+01     1.0000e+02             3.4862e-05       -17.216817873014
     4.0000e+01     4.0000e+02             8.9349e-06       -17.216816909390

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3255e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.085616e-02 3 1  ON 0
ci_002                -3.043794e-02 3 1  ON 1
ci_003                -2.515718e-02 3 1  ON 2
ci_004                 2.152930e-02 3 1  ON 3
ci_005                 2.187644e-02 3 1  ON 4
ci_006                -1.971513e-02 3 1  ON 5
ci_007                -1.996666e-02 3 1  ON 6
ci_008                -1.825016e-02 3 1  ON 7
ci_009                -1.828774e-02 3 1  ON 8
ci_010                -1.671381e-02 3 1  ON 9
ci_011                -1.621525e-02 3 1  ON 10
ci_012                -1.639755e-02 3 1  ON 11
ci_013                -1.888065e-02 3 1  ON 12
ci_014                 1.373475e-02 3 1  ON 13
ci_015                 1.450884e-02 3 1  ON 14
ci_016                 1.627811e-02 3 1  ON 15
ci_017                 1.665331e-02 3 1  ON 16
ci_018                 1.315334e-02 3 1  ON 17
ci_019                 1.330329e-02 3 1  ON 18
ci_020                 1.378119e-02 3 1  ON 19
ci_021                 1.325151e-02 3 1  ON 20
ci_022                 1.172621e-02 3 1  ON 21
ci_023                 1.183979e-02 3 1  ON 22
ci_024                 1.103553e-02 3 1  ON 23
ci_025                 1.090280e-02 3 1  ON 24
ci_026                 1.197567e-02 3 1  ON 25
ci_027                 1.189606e-02 3 1  ON 26
ci_028                -1.414214e-02 3 1  ON 27
ci_029                -1.459586e-02 3 1  ON 28
ci_030                -1.095541e-02 3 1  ON 29
ci_031                -1.088642e-02 3 1  ON 30
ci_032                -1.401975e-02 3 1  ON 31
ci_033                 1.052146e-02 3 1  ON 32
ci_034                 1.057896e-02 3 1  ON 33
ci_035                -5.100730e-03 3 1  ON 34
ci_036                -1.064454e-02 3 1  ON 35
ci_037                -1.104701e-02 3 1  ON 36
ci_038                 1.318559e-03 3 1  ON 37
ci_039                 1.323293e-03 3 1  ON 38
ci_040                -4.157973e-03 3 1  ON 39
ci_041                 9.595389e-03 3 1  ON 40
ci_042                 1.007860e-02 3 1  ON 41
ci_043                -3.563030e-03 3 1  ON 42
ci_044                -1.514115e-02 3 1  ON 43
ci_045                -1.808080e-03 3 1  ON 44
ci_046                 5.436785e-03 3 1  ON 45
ci_047                 5.648161e-03 3 1  ON 46
ci_048                -1.196416e-02 3 1  ON 47
ci_049                -1.194443e-02 3 1  ON 48
ci_050                 7.833576e-03 3 1  ON 49
ci_051                 7.629192e-03 3 1  ON 50
ci_052                -6.859075e-03 3 1  ON 51
ci_053                -6.814965e-03 3 1  ON 52
ci_054                -2.469977e-03 3 1  ON 53
ci_055                -2.296893e-03 3 1  ON 54
ci_056                 4.939067e-03 3 1  ON 55
ci_057                 5.067885e-03 3 1  ON 56
ci_058                -7.287639e-03 3 1  ON 57
ci_059                -7.060312e-03 3 1  ON 58
ci_060                 8.641137e-03 3 1  ON 59
ci_061                 8.424944e-03 3 1  ON 60
ci_062                -2.995672e-03 3 1  ON 61
ci_063                -2.931743e-03 3 1  ON 62
ci_064                -3.416328e-03 3 1  ON 63
ci_065                -4.349307e-03 3 1  ON 64
ci_066                 5.827497e-03 3 1  ON 65
ci_067                 5.862542e-03 3 1  ON 66
ci_068                -4.611249e-03 3 1  ON 67
ci_069                -4.697579e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.21403
====================================================
  Execution time = 1.4322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1720e-01
  Total weights = 1.956983032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304015007054
                                         uncertainty =       0.002113887210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304015007054
                                         uncertainty =       0.002113887210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389827005
  error estimate for blocks of size 2^( 2) =       0.000399896686
  error estimate for blocks of size 2^( 3) =       0.000408768659
  error estimate for blocks of size 2^( 4) =       0.000414786857
  error estimate for blocks of size 2^( 5) =       0.000418842314
  error estimate for blocks of size 2^( 6) =       0.000419225780
  error estimate for blocks of size 2^( 7) =       0.000420338211

      target function =                  N/A
              le_mean =     -17.216718786746
             les_mean =     296.732610006087
             stat err =       0.000418298290
             autocorr =       1.151405599006
              std dev =       0.551298637213
             le_variance =       0.303930187393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671878675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718786795       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216726252194       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216726082372       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216726143704       residual = 7.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.440219e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718786795       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721200133       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721308042       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721322790       residual = 3.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.403943e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718786795       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719437831       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719482860       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719488738       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.757867e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6846e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.078717e-02 3 1  ON 0
ci_002                -3.044152e-02 3 1  ON 1
ci_003                -2.510007e-02 3 1  ON 2
ci_004                 2.153112e-02 3 1  ON 3
ci_005                 2.179297e-02 3 1  ON 4
ci_006                -1.972526e-02 3 1  ON 5
ci_007                -1.989752e-02 3 1  ON 6
ci_008                -1.824119e-02 3 1  ON 7
ci_009                -1.826573e-02 3 1  ON 8
ci_010                -1.671940e-02 3 1  ON 9
ci_011                -1.623009e-02 3 1  ON 10
ci_012                -1.643721e-02 3 1  ON 11
ci_013                -1.892091e-02 3 1  ON 12
ci_014                 1.373214e-02 3 1  ON 13
ci_015                 1.436844e-02 3 1  ON 14
ci_016                 1.629718e-02 3 1  ON 15
ci_017                 1.663973e-02 3 1  ON 16
ci_018                 1.312402e-02 3 1  ON 17
ci_019                 1.331474e-02 3 1  ON 18
ci_020                 1.375533e-02 3 1  ON 19
ci_021                 1.317288e-02 3 1  ON 20
ci_022                 1.186561e-02 3 1  ON 21
ci_023                 1.180739e-02 3 1  ON 22
ci_024                 1.102557e-02 3 1  ON 23
ci_025                 1.095008e-02 3 1  ON 24
ci_026                 1.200671e-02 3 1  ON 25
ci_027                 1.191529e-02 3 1  ON 26
ci_028                -1.412861e-02 3 1  ON 27
ci_029                -1.460083e-02 3 1  ON 28
ci_030                -1.093946e-02 3 1  ON 29
ci_031                -1.089264e-02 3 1  ON 30
ci_032                -1.412002e-02 3 1  ON 31
ci_033                 1.050870e-02 3 1  ON 32
ci_034                 1.052233e-02 3 1  ON 33
ci_035                -5.089011e-03 3 1  ON 34
ci_036                -1.055995e-02 3 1  ON 35
ci_037                -1.097272e-02 3 1  ON 36
ci_038                 1.338274e-03 3 1  ON 37
ci_039                 1.269138e-03 3 1  ON 38
ci_040                -4.094594e-03 3 1  ON 39
ci_041                 9.506838e-03 3 1  ON 40
ci_042                 1.000408e-02 3 1  ON 41
ci_043                -3.512280e-03 3 1  ON 42
ci_044                -1.514881e-02 3 1  ON 43
ci_045                -1.798452e-03 3 1  ON 44
ci_046                 5.385787e-03 3 1  ON 45
ci_047                 5.655743e-03 3 1  ON 46
ci_048                -1.193556e-02 3 1  ON 47
ci_049                -1.197507e-02 3 1  ON 48
ci_050                 7.830583e-03 3 1  ON 49
ci_051                 7.633849e-03 3 1  ON 50
ci_052                -6.800633e-03 3 1  ON 51
ci_053                -6.878922e-03 3 1  ON 52
ci_054                -2.450342e-03 3 1  ON 53
ci_055                -2.337321e-03 3 1  ON 54
ci_056                 4.911000e-03 3 1  ON 55
ci_057                 4.984772e-03 3 1  ON 56
ci_058                -7.276637e-03 3 1  ON 57
ci_059                -7.103983e-03 3 1  ON 58
ci_060                 8.595655e-03 3 1  ON 59
ci_061                 8.445449e-03 3 1  ON 60
ci_062                -2.960737e-03 3 1  ON 61
ci_063                -3.061789e-03 3 1  ON 62
ci_064                -3.321442e-03 3 1  ON 63
ci_065                -4.279842e-03 3 1  ON 64
ci_066                 5.896306e-03 3 1  ON 65
ci_067                 5.866531e-03 3 1  ON 66
ci_068                -4.620004e-03 3 1  ON 67
ci_069                -4.752070e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2461
    reference variance = 0.255253
====================================================
  Execution time = 1.4050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1538e-01
  Total weights = 1.9570e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298977951171
                                         uncertainty =       0.001667431219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298977951171
                                         uncertainty =       0.001667431219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386646173
  error estimate for blocks of size 2^( 2) =       0.000396411359
  error estimate for blocks of size 2^( 3) =       0.000405294680
  error estimate for blocks of size 2^( 4) =       0.000411663385
  error estimate for blocks of size 2^( 5) =       0.000415133508
  error estimate for blocks of size 2^( 6) =       0.000415964270
  error estimate for blocks of size 2^( 7) =       0.000419279302

      target function =                  N/A
              le_mean =     -17.216368718139
             les_mean =     296.718771307617
             stat err =       0.000415510116
             autocorr =       1.154877108076
              std dev =       0.546800261030
             le_variance =       0.298990525463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951017221
                                         uncertainty =       0.001663245102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951017221
                                         uncertainty =       0.001663245102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386628377
  error estimate for blocks of size 2^( 2) =       0.000396402382
  error estimate for blocks of size 2^( 3) =       0.000405294325
  error estimate for blocks of size 2^( 4) =       0.000411677107
  error estimate for blocks of size 2^( 5) =       0.000415142737
  error estimate for blocks of size 2^( 6) =       0.000415972981
  error estimate for blocks of size 2^( 7) =       0.000419277223

      target function =                  N/A
              le_mean =     -17.216371593228
             les_mean =     296.719974125165
             stat err =       0.000415517512
             autocorr =       1.155024537991
              std dev =       0.546775094553
             le_variance =       0.298963004023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298944159240
                                         uncertainty =       0.001665029544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298944159240
                                         uncertainty =       0.001665029544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386624070
  error estimate for blocks of size 2^( 2) =       0.000396395069
  error estimate for blocks of size 2^( 3) =       0.000405284561
  error estimate for blocks of size 2^( 4) =       0.000411662551
  error estimate for blocks of size 2^( 5) =       0.000415130502
  error estimate for blocks of size 2^( 6) =       0.000415960336
  error estimate for blocks of size 2^( 7) =       0.000419269197

      target function =                  N/A
              le_mean =     -17.216369493631
             les_mean =     296.718816436624
             stat err =       0.000415505647
             autocorr =       1.154984307459
              std dev =       0.546769003303
             le_variance =       0.298956342973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298971112039
                                         uncertainty =       0.001667111233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298971112039
                                         uncertainty =       0.001667111233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641715
  error estimate for blocks of size 2^( 2) =       0.000396407687
  error estimate for blocks of size 2^( 3) =       0.000405291856
  error estimate for blocks of size 2^( 4) =       0.000411661733
  error estimate for blocks of size 2^( 5) =       0.000415131547
  error estimate for blocks of size 2^( 6) =       0.000415961528
  error estimate for blocks of size 2^( 7) =       0.000419275676

      target function =                  N/A
              le_mean =     -17.216368658695
             les_mean =     296.718818304723
             stat err =       0.000415507621
             autocorr =       1.154889862558
              std dev =       0.546793957772
             le_variance =       0.298983632256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216368718139        initial
     6.2500e-01     6.2500e+00             4.4402e-04       -17.216371593228  <--
     2.5000e+00     2.5000e+01             1.4039e-04       -17.216369493631
     1.0000e+01     1.0000e+02             3.7579e-05       -17.216368658695

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.3332e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.062359e-02 3 1  ON 0
ci_002                -3.045216e-02 3 1  ON 1
ci_003                -2.496866e-02 3 1  ON 2
ci_004                 2.153960e-02 3 1  ON 3
ci_005                 2.160036e-02 3 1  ON 4
ci_006                -1.975191e-02 3 1  ON 5
ci_007                -1.974180e-02 3 1  ON 6
ci_008                -1.822365e-02 3 1  ON 7
ci_009                -1.821987e-02 3 1  ON 8
ci_010                -1.673148e-02 3 1  ON 9
ci_011                -1.625872e-02 3 1  ON 10
ci_012                -1.652361e-02 3 1  ON 11
ci_013                -1.901498e-02 3 1  ON 12
ci_014                 1.372799e-02 3 1  ON 13
ci_015                 1.406482e-02 3 1  ON 14
ci_016                 1.634745e-02 3 1  ON 15
ci_017                 1.661214e-02 3 1  ON 16
ci_018                 1.306677e-02 3 1  ON 17
ci_019                 1.334356e-02 3 1  ON 18
ci_020                 1.369967e-02 3 1  ON 19
ci_021                 1.299399e-02 3 1  ON 20
ci_022                 1.216203e-02 3 1  ON 21
ci_023                 1.173962e-02 3 1  ON 22
ci_024                 1.100054e-02 3 1  ON 23
ci_025                 1.106207e-02 3 1  ON 24
ci_026                 1.207972e-02 3 1  ON 25
ci_027                 1.196259e-02 3 1  ON 26
ci_028                -1.410187e-02 3 1  ON 27
ci_029                -1.461833e-02 3 1  ON 28
ci_030                -1.090757e-02 3 1  ON 29
ci_031                -1.090956e-02 3 1  ON 30
ci_032                -1.432915e-02 3 1  ON 31
ci_033                 1.048511e-02 3 1  ON 32
ci_034                 1.039816e-02 3 1  ON 33
ci_035                -5.070679e-03 3 1  ON 34
ci_036                -1.037020e-02 3 1  ON 35
ci_037                -1.080863e-02 3 1  ON 36
ci_038                 1.376112e-03 3 1  ON 37
ci_039                 1.170313e-03 3 1  ON 38
ci_040                -3.985110e-03 3 1  ON 39
ci_041                 9.316560e-03 3 1  ON 40
ci_042                 9.845467e-03 3 1  ON 41
ci_043                -3.418603e-03 3 1  ON 42
ci_044                -1.517160e-02 3 1  ON 43
ci_045                -1.784257e-03 3 1  ON 44
ci_046                 5.278669e-03 3 1  ON 45
ci_047                 5.673036e-03 3 1  ON 46
ci_048                -1.187519e-02 3 1  ON 47
ci_049                -1.205608e-02 3 1  ON 48
ci_050                 7.824704e-03 3 1  ON 49
ci_051                 7.645085e-03 3 1  ON 50
ci_052                -6.683954e-03 3 1  ON 51
ci_053                -7.006651e-03 3 1  ON 52
ci_054                -2.406702e-03 3 1  ON 53
ci_055                -2.419016e-03 3 1  ON 54
ci_056                 4.854879e-03 3 1  ON 55
ci_057                 4.821837e-03 3 1  ON 56
ci_058                -7.254976e-03 3 1  ON 57
ci_059                -7.193638e-03 3 1  ON 58
ci_060                 8.496230e-03 3 1  ON 59
ci_061                 8.487261e-03 3 1  ON 60
ci_062                -2.887044e-03 3 1  ON 61
ci_063                -3.331155e-03 3 1  ON 62
ci_064                -3.168300e-03 3 1  ON 63
ci_065                -4.162891e-03 3 1  ON 64
ci_066                 6.027901e-03 3 1  ON 65
ci_067                 5.873643e-03 3 1  ON 66
ci_068                -4.640245e-03 3 1  ON 67
ci_069                -4.868324e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.239
    reference variance = 0.228521
====================================================
  Execution time = 1.4269e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.957074507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300004867091
                                         uncertainty =       0.002205000346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300004867091
                                         uncertainty =       0.002205000346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387263734
  error estimate for blocks of size 2^( 2) =       0.000396944961
  error estimate for blocks of size 2^( 3) =       0.000404993293
  error estimate for blocks of size 2^( 4) =       0.000411260435
  error estimate for blocks of size 2^( 5) =       0.000415305162
  error estimate for blocks of size 2^( 6) =       0.000416360138
  error estimate for blocks of size 2^( 7) =       0.000416334444

      target function =                  N/A
              le_mean =     -17.217171790240
             les_mean =     296.743143369340
             stat err =       0.000414815045
             autocorr =       1.147348472373
              std dev =       0.547673624477
             le_variance =       0.299946398948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717179024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171790307       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217180188292       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217180348087       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217180256675       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 7.392452e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171790307       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217175742060       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217175781668       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217175829895       residual = 6.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.411264e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171790307       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217173057803       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217173074317       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217173099622       residual = 2.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.168796e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6776e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.039067e-02 3 1  ON 0
ci_002                -3.045077e-02 3 1  ON 1
ci_003                -2.521607e-02 3 1  ON 2
ci_004                 2.139724e-02 3 1  ON 3
ci_005                 2.157850e-02 3 1  ON 4
ci_006                -1.944056e-02 3 1  ON 5
ci_007                -1.968790e-02 3 1  ON 6
ci_008                -1.819320e-02 3 1  ON 7
ci_009                -1.851320e-02 3 1  ON 8
ci_010                -1.673479e-02 3 1  ON 9
ci_011                -1.620744e-02 3 1  ON 10
ci_012                -1.652591e-02 3 1  ON 11
ci_013                -1.892274e-02 3 1  ON 12
ci_014                 1.383777e-02 3 1  ON 13
ci_015                 1.382931e-02 3 1  ON 14
ci_016                 1.632642e-02 3 1  ON 15
ci_017                 1.652615e-02 3 1  ON 16
ci_018                 1.292750e-02 3 1  ON 17
ci_019                 1.312985e-02 3 1  ON 18
ci_020                 1.378617e-02 3 1  ON 19
ci_021                 1.283409e-02 3 1  ON 20
ci_022                 1.194007e-02 3 1  ON 21
ci_023                 1.145809e-02 3 1  ON 22
ci_024                 1.110512e-02 3 1  ON 23
ci_025                 1.096168e-02 3 1  ON 24
ci_026                 1.176569e-02 3 1  ON 25
ci_027                 1.191921e-02 3 1  ON 26
ci_028                -1.416448e-02 3 1  ON 27
ci_029                -1.438364e-02 3 1  ON 28
ci_030                -1.083585e-02 3 1  ON 29
ci_031                -1.102923e-02 3 1  ON 30
ci_032                -1.423111e-02 3 1  ON 31
ci_033                 1.045180e-02 3 1  ON 32
ci_034                 1.027053e-02 3 1  ON 33
ci_035                -4.973951e-03 3 1  ON 34
ci_036                -1.069336e-02 3 1  ON 35
ci_037                -1.085300e-02 3 1  ON 36
ci_038                 1.238976e-03 3 1  ON 37
ci_039                 1.199671e-03 3 1  ON 38
ci_040                -3.965107e-03 3 1  ON 39
ci_041                 9.461917e-03 3 1  ON 40
ci_042                 9.651730e-03 3 1  ON 41
ci_043                -3.475062e-03 3 1  ON 42
ci_044                -1.531247e-02 3 1  ON 43
ci_045                -1.725080e-03 3 1  ON 44
ci_046                 5.256457e-03 3 1  ON 45
ci_047                 5.523588e-03 3 1  ON 46
ci_048                -1.176413e-02 3 1  ON 47
ci_049                -1.205871e-02 3 1  ON 48
ci_050                 7.692632e-03 3 1  ON 49
ci_051                 7.504519e-03 3 1  ON 50
ci_052                -6.743973e-03 3 1  ON 51
ci_053                -7.072806e-03 3 1  ON 52
ci_054                -2.401906e-03 3 1  ON 53
ci_055                -2.398999e-03 3 1  ON 54
ci_056                 4.932187e-03 3 1  ON 55
ci_057                 4.722555e-03 3 1  ON 56
ci_058                -7.162981e-03 3 1  ON 57
ci_059                -6.865358e-03 3 1  ON 58
ci_060                 8.513423e-03 3 1  ON 59
ci_061                 8.684274e-03 3 1  ON 60
ci_062                -2.906253e-03 3 1  ON 61
ci_063                -3.153007e-03 3 1  ON 62
ci_064                -3.211673e-03 3 1  ON 63
ci_065                -3.929319e-03 3 1  ON 64
ci_066                 5.686774e-03 3 1  ON 65
ci_067                 5.844205e-03 3 1  ON 66
ci_068                -4.762510e-03 3 1  ON 67
ci_069                -5.069118e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.269683
====================================================
  Execution time = 1.4016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1730e-01
  Total weights = 1.9567e+06
  Execution time = 1.8306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302013085853
                                         uncertainty =       0.001839816010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302013085853
                                         uncertainty =       0.001839816010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388532379
  error estimate for blocks of size 2^( 2) =       0.000398188922
  error estimate for blocks of size 2^( 3) =       0.000407062610
  error estimate for blocks of size 2^( 4) =       0.000413412588
  error estimate for blocks of size 2^( 5) =       0.000416705846
  error estimate for blocks of size 2^( 6) =       0.000417856385
  error estimate for blocks of size 2^( 7) =       0.000420074168

      target function =                  N/A
              le_mean =     -17.216197867506
             les_mean =     296.726769767317
             stat err =       0.000417012247
             autocorr =       1.151975345261
              std dev =       0.549467760232
             le_variance =       0.301914819535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301240714719
                                         uncertainty =       0.001833589617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301240714719
                                         uncertainty =       0.001833589617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388034942
  error estimate for blocks of size 2^( 2) =       0.000397711605
  error estimate for blocks of size 2^( 3) =       0.000406605440
  error estimate for blocks of size 2^( 4) =       0.000412984334
  error estimate for blocks of size 2^( 5) =       0.000416278730
  error estimate for blocks of size 2^( 6) =       0.000417469896
  error estimate for blocks of size 2^( 7) =       0.000419690274

      target function =                  N/A
              le_mean =     -17.216213828424
             les_mean =     296.935159604621
             stat err =       0.000416605809
             autocorr =       1.152680566439
              std dev =       0.548764277964
             le_variance =       0.301142232769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301158832706
                                         uncertainty =       0.001825731493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301158832706
                                         uncertainty =       0.001825731493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387982429
  error estimate for blocks of size 2^( 2) =       0.000397661365
  error estimate for blocks of size 2^( 3) =       0.000406560086
  error estimate for blocks of size 2^( 4) =       0.000412943374
  error estimate for blocks of size 2^( 5) =       0.000416245730
  error estimate for blocks of size 2^( 6) =       0.000417419826
  error estimate for blocks of size 2^( 7) =       0.000419617529

      target function =                  N/A
              le_mean =     -17.216206771881
             les_mean =     296.715925057083
             stat err =       0.000416556615
             autocorr =       1.152720340339
              std dev =       0.548690012363
             le_variance =       0.301060729667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301847851430
                                         uncertainty =       0.001835269492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301847851430
                                         uncertainty =       0.001835269492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388426071
  error estimate for blocks of size 2^( 2) =       0.000398087046
  error estimate for blocks of size 2^( 3) =       0.000406964815
  error estimate for blocks of size 2^( 4) =       0.000413318485
  error estimate for blocks of size 2^( 5) =       0.000416607966
  error estimate for blocks of size 2^( 6) =       0.000417768028
  error estimate for blocks of size 2^( 7) =       0.000419996036

      target function =                  N/A
              le_mean =     -17.216198968199
             les_mean =     296.730291463678
             stat err =       0.000416922629
             autocorr =       1.152110646280
              std dev =       0.549317418189
             le_variance =       0.301749625926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216197867506        initial
     1.5625e-01     1.5625e+00             7.3925e-04       -17.216213828424  <--
     6.2500e-01     6.2500e+00             3.4113e-04       -17.216206771881
     2.5000e+00     2.5000e+01             1.1688e-04       -17.216198968199

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.3290e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.009315e-02 3 1  ON 0
ci_002                -3.046432e-02 3 1  ON 1
ci_003                -2.555854e-02 3 1  ON 2
ci_004                 2.121171e-02 3 1  ON 3
ci_005                 2.154496e-02 3 1  ON 4
ci_006                -1.902977e-02 3 1  ON 5
ci_007                -1.964119e-02 3 1  ON 6
ci_008                -1.816425e-02 3 1  ON 7
ci_009                -1.881563e-02 3 1  ON 8
ci_010                -1.672615e-02 3 1  ON 9
ci_011                -1.616146e-02 3 1  ON 10
ci_012                -1.653932e-02 3 1  ON 11
ci_013                -1.879267e-02 3 1  ON 12
ci_014                 1.398426e-02 3 1  ON 13
ci_015                 1.354736e-02 3 1  ON 14
ci_016                 1.633661e-02 3 1  ON 15
ci_017                 1.645879e-02 3 1  ON 16
ci_018                 1.277457e-02 3 1  ON 17
ci_019                 1.288084e-02 3 1  ON 18
ci_020                 1.389956e-02 3 1  ON 19
ci_021                 1.261876e-02 3 1  ON 20
ci_022                 1.166345e-02 3 1  ON 21
ci_023                 1.112953e-02 3 1  ON 22
ci_024                 1.125495e-02 3 1  ON 23
ci_025                 1.081281e-02 3 1  ON 24
ci_026                 1.138654e-02 3 1  ON 25
ci_027                 1.186677e-02 3 1  ON 26
ci_028                -1.426261e-02 3 1  ON 27
ci_029                -1.406876e-02 3 1  ON 28
ci_030                -1.076725e-02 3 1  ON 29
ci_031                -1.120961e-02 3 1  ON 30
ci_032                -1.412161e-02 3 1  ON 31
ci_033                 1.041772e-02 3 1  ON 32
ci_034                 1.011554e-02 3 1  ON 33
ci_035                -4.900146e-03 3 1  ON 34
ci_036                -1.110945e-02 3 1  ON 35
ci_037                -1.091449e-02 3 1  ON 36
ci_038                 1.126443e-03 3 1  ON 37
ci_039                 1.224748e-03 3 1  ON 38
ci_040                -3.951615e-03 3 1  ON 39
ci_041                 9.646988e-03 3 1  ON 40
ci_042                 9.436749e-03 3 1  ON 41
ci_043                -3.533480e-03 3 1  ON 42
ci_044                -1.550101e-02 3 1  ON 43
ci_045                -1.674592e-03 3 1  ON 44
ci_046                 5.230812e-03 3 1  ON 45
ci_047                 5.357629e-03 3 1  ON 46
ci_048                -1.160783e-02 3 1  ON 47
ci_049                -1.208960e-02 3 1  ON 48
ci_050                 7.572586e-03 3 1  ON 49
ci_051                 7.379284e-03 3 1  ON 50
ci_052                -6.811387e-03 3 1  ON 51
ci_053                -7.142874e-03 3 1  ON 52
ci_054                -2.398542e-03 3 1  ON 53
ci_055                -2.382591e-03 3 1  ON 54
ci_056                 5.005580e-03 3 1  ON 55
ci_057                 4.627677e-03 3 1  ON 56
ci_058                -7.065900e-03 3 1  ON 57
ci_059                -6.516650e-03 3 1  ON 58
ci_060                 8.548177e-03 3 1  ON 59
ci_061                 8.934946e-03 3 1  ON 60
ci_062                -2.928956e-03 3 1  ON 61
ci_063                -2.971481e-03 3 1  ON 62
ci_064                -3.243003e-03 3 1  ON 63
ci_065                -3.759008e-03 3 1  ON 64
ci_066                 5.377564e-03 3 1  ON 65
ci_067                 5.817407e-03 3 1  ON 66
ci_068                -4.928673e-03 3 1  ON 67
ci_069                -5.318008e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.239381
====================================================
  Execution time = 1.4380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2100e-01
  Total weights = 1.956628811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303622904131
                                         uncertainty =       0.002512160076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303622904131
                                         uncertainty =       0.002512160076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389593392
  error estimate for blocks of size 2^( 2) =       0.000399602814
  error estimate for blocks of size 2^( 3) =       0.000408408419
  error estimate for blocks of size 2^( 4) =       0.000415192540
  error estimate for blocks of size 2^( 5) =       0.000419042722
  error estimate for blocks of size 2^( 6) =       0.000421182401
  error estimate for blocks of size 2^( 7) =       0.000424321512

      target function =                  N/A
              le_mean =     -17.217145648275
             les_mean =     296.751101033262
             stat err =       0.000419934794
             autocorr =       1.161824565470
              std dev =       0.550968259328
             le_variance =       0.303566022787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714564827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217145648334       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217154385611       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153448888       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217152837001       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217152739065       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.176060e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217145648334       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217151920160       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217151419958       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217151165956       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 8.610775e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217145648334       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217148594643       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217148516772       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217148463992       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.156195e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6903e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.031926e-02 3 1  ON 0
ci_002                -2.991435e-02 3 1  ON 1
ci_003                -2.534809e-02 3 1  ON 2
ci_004                 2.057735e-02 3 1  ON 3
ci_005                 2.082768e-02 3 1  ON 4
ci_006                -1.892449e-02 3 1  ON 5
ci_007                -1.908543e-02 3 1  ON 6
ci_008                -1.771606e-02 3 1  ON 7
ci_009                -1.795455e-02 3 1  ON 8
ci_010                -1.672295e-02 3 1  ON 9
ci_011                -1.677417e-02 3 1  ON 10
ci_012                -1.606906e-02 3 1  ON 11
ci_013                -1.901058e-02 3 1  ON 12
ci_014                 1.451010e-02 3 1  ON 13
ci_015                 1.330611e-02 3 1  ON 14
ci_016                 1.628043e-02 3 1  ON 15
ci_017                 1.630948e-02 3 1  ON 16
ci_018                 1.290250e-02 3 1  ON 17
ci_019                 1.283556e-02 3 1  ON 18
ci_020                 1.444323e-02 3 1  ON 19
ci_021                 1.310373e-02 3 1  ON 20
ci_022                 1.176739e-02 3 1  ON 21
ci_023                 1.195606e-02 3 1  ON 22
ci_024                 1.101316e-02 3 1  ON 23
ci_025                 1.092110e-02 3 1  ON 24
ci_026                 1.119473e-02 3 1  ON 25
ci_027                 1.129063e-02 3 1  ON 26
ci_028                -1.479002e-02 3 1  ON 27
ci_029                -1.403284e-02 3 1  ON 28
ci_030                -1.042913e-02 3 1  ON 29
ci_031                -1.118331e-02 3 1  ON 30
ci_032                -1.405312e-02 3 1  ON 31
ci_033                 1.002285e-02 3 1  ON 32
ci_034                 1.002596e-02 3 1  ON 33
ci_035                -4.654369e-03 3 1  ON 34
ci_036                -1.063871e-02 3 1  ON 35
ci_037                -1.116853e-02 3 1  ON 36
ci_038                 1.216560e-03 3 1  ON 37
ci_039                 1.640495e-03 3 1  ON 38
ci_040                -4.238459e-03 3 1  ON 39
ci_041                 9.708314e-03 3 1  ON 40
ci_042                 9.731795e-03 3 1  ON 41
ci_043                -3.134469e-03 3 1  ON 42
ci_044                -1.494043e-02 3 1  ON 43
ci_045                -1.591413e-03 3 1  ON 44
ci_046                 5.455081e-03 3 1  ON 45
ci_047                 5.505964e-03 3 1  ON 46
ci_048                -1.123781e-02 3 1  ON 47
ci_049                -1.226207e-02 3 1  ON 48
ci_050                 7.971303e-03 3 1  ON 49
ci_051                 8.081509e-03 3 1  ON 50
ci_052                -6.499432e-03 3 1  ON 51
ci_053                -6.694535e-03 3 1  ON 52
ci_054                -2.376021e-03 3 1  ON 53
ci_055                -2.402377e-03 3 1  ON 54
ci_056                 4.949971e-03 3 1  ON 55
ci_057                 4.888585e-03 3 1  ON 56
ci_058                -7.399824e-03 3 1  ON 57
ci_059                -6.606639e-03 3 1  ON 58
ci_060                 8.413105e-03 3 1  ON 59
ci_061                 8.426364e-03 3 1  ON 60
ci_062                -2.908915e-03 3 1  ON 61
ci_063                -3.020987e-03 3 1  ON 62
ci_064                -3.118664e-03 3 1  ON 63
ci_065                -3.985104e-03 3 1  ON 64
ci_066                 5.587489e-03 3 1  ON 65
ci_067                 5.792617e-03 3 1  ON 66
ci_068                -4.800991e-03 3 1  ON 67
ci_069                -5.312209e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2816
    reference variance = 0.266389
====================================================
  Execution time = 1.4252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2024e-01
  Total weights = 1.9568e+06
  Execution time = 1.9637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304933262119
                                         uncertainty =       0.002320180617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304933262119
                                         uncertainty =       0.002320180617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390445087
  error estimate for blocks of size 2^( 2) =       0.000400757303
  error estimate for blocks of size 2^( 3) =       0.000409262544
  error estimate for blocks of size 2^( 4) =       0.000415841361
  error estimate for blocks of size 2^( 5) =       0.000419939199
  error estimate for blocks of size 2^( 6) =       0.000422584878
  error estimate for blocks of size 2^( 7) =       0.000424891200

      target function =                  N/A
              le_mean =     -17.216387838717
             les_mean =     296.730704371714
             stat err =       0.000420814159
             autocorr =       1.161611126459
              std dev =       0.552172737847
             le_variance =       0.304894732421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304370371055
                                         uncertainty =       0.002304317292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304370371055
                                         uncertainty =       0.002304317292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390086548
  error estimate for blocks of size 2^( 2) =       0.000400426181
  error estimate for blocks of size 2^( 3) =       0.000408970928
  error estimate for blocks of size 2^( 4) =       0.000415571747
  error estimate for blocks of size 2^( 5) =       0.000419676540
  error estimate for blocks of size 2^( 6) =       0.000422315571
  error estimate for blocks of size 2^( 7) =       0.000424657461

      target function =                  N/A
              le_mean =     -17.216363042357
             les_mean =     296.724973624333
             stat err =       0.000420555329
             autocorr =       1.162316315017
              std dev =       0.551665686495
             le_variance =       0.304335029656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304598947366
                                         uncertainty =       0.002289712443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304598947366
                                         uncertainty =       0.002289712443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390232944
  error estimate for blocks of size 2^( 2) =       0.000400581894
  error estimate for blocks of size 2^( 3) =       0.000409141891
  error estimate for blocks of size 2^( 4) =       0.000415750448
  error estimate for blocks of size 2^( 5) =       0.000419852907
  error estimate for blocks of size 2^( 6) =       0.000422493602
  error estimate for blocks of size 2^( 7) =       0.000424839570

      target function =                  N/A
              le_mean =     -17.216386374468
             les_mean =     296.801824770297
             stat err =       0.000420734132
             autocorr =       1.162432197683
              std dev =       0.551872721508
             le_variance =       0.304563500745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304682006021
                                         uncertainty =       0.002314383207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304682006021
                                         uncertainty =       0.002314383207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390284693
  error estimate for blocks of size 2^( 2) =       0.000400603027
  error estimate for blocks of size 2^( 3) =       0.000409121777
  error estimate for blocks of size 2^( 4) =       0.000415706682
  error estimate for blocks of size 2^( 5) =       0.000419799521
  error estimate for blocks of size 2^( 6) =       0.000422432071
  error estimate for blocks of size 2^( 7) =       0.000424756373

      target function =                  N/A
              le_mean =     -17.216367596383
             les_mean =     296.728055586397
             stat err =       0.000420673662
             autocorr =       1.161789926711
              std dev =       0.551945906007
             le_variance =       0.304644283157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216387838717        initial  <--
     3.9062e-02     3.9062e-01             1.1761e-03       -17.216363042357
     1.5625e-01     1.5625e+00             8.6108e-04       -17.216386374468
     6.2500e-01     6.2500e+00             4.1562e-04       -17.216367596383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.7373
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.009315e-02 3 1  ON 0
ci_002                -3.046432e-02 3 1  ON 1
ci_003                -2.555854e-02 3 1  ON 2
ci_004                 2.121171e-02 3 1  ON 3
ci_005                 2.154496e-02 3 1  ON 4
ci_006                -1.902977e-02 3 1  ON 5
ci_007                -1.964119e-02 3 1  ON 6
ci_008                -1.816425e-02 3 1  ON 7
ci_009                -1.881563e-02 3 1  ON 8
ci_010                -1.672615e-02 3 1  ON 9
ci_011                -1.616146e-02 3 1  ON 10
ci_012                -1.653932e-02 3 1  ON 11
ci_013                -1.879267e-02 3 1  ON 12
ci_014                 1.398426e-02 3 1  ON 13
ci_015                 1.354736e-02 3 1  ON 14
ci_016                 1.633661e-02 3 1  ON 15
ci_017                 1.645879e-02 3 1  ON 16
ci_018                 1.277457e-02 3 1  ON 17
ci_019                 1.288084e-02 3 1  ON 18
ci_020                 1.389956e-02 3 1  ON 19
ci_021                 1.261876e-02 3 1  ON 20
ci_022                 1.166345e-02 3 1  ON 21
ci_023                 1.112953e-02 3 1  ON 22
ci_024                 1.125495e-02 3 1  ON 23
ci_025                 1.081281e-02 3 1  ON 24
ci_026                 1.138654e-02 3 1  ON 25
ci_027                 1.186677e-02 3 1  ON 26
ci_028                -1.426261e-02 3 1  ON 27
ci_029                -1.406876e-02 3 1  ON 28
ci_030                -1.076725e-02 3 1  ON 29
ci_031                -1.120961e-02 3 1  ON 30
ci_032                -1.412161e-02 3 1  ON 31
ci_033                 1.041772e-02 3 1  ON 32
ci_034                 1.011554e-02 3 1  ON 33
ci_035                -4.900146e-03 3 1  ON 34
ci_036                -1.110945e-02 3 1  ON 35
ci_037                -1.091449e-02 3 1  ON 36
ci_038                 1.126443e-03 3 1  ON 37
ci_039                 1.224748e-03 3 1  ON 38
ci_040                -3.951615e-03 3 1  ON 39
ci_041                 9.646988e-03 3 1  ON 40
ci_042                 9.436749e-03 3 1  ON 41
ci_043                -3.533480e-03 3 1  ON 42
ci_044                -1.550101e-02 3 1  ON 43
ci_045                -1.674592e-03 3 1  ON 44
ci_046                 5.230812e-03 3 1  ON 45
ci_047                 5.357629e-03 3 1  ON 46
ci_048                -1.160783e-02 3 1  ON 47
ci_049                -1.208960e-02 3 1  ON 48
ci_050                 7.572586e-03 3 1  ON 49
ci_051                 7.379284e-03 3 1  ON 50
ci_052                -6.811387e-03 3 1  ON 51
ci_053                -7.142874e-03 3 1  ON 52
ci_054                -2.398542e-03 3 1  ON 53
ci_055                -2.382591e-03 3 1  ON 54
ci_056                 5.005580e-03 3 1  ON 55
ci_057                 4.627677e-03 3 1  ON 56
ci_058                -7.065900e-03 3 1  ON 57
ci_059                -6.516650e-03 3 1  ON 58
ci_060                 8.548177e-03 3 1  ON 59
ci_061                 8.934946e-03 3 1  ON 60
ci_062                -2.928956e-03 3 1  ON 61
ci_063                -2.971481e-03 3 1  ON 62
ci_064                -3.243003e-03 3 1  ON 63
ci_065                -3.759008e-03 3 1  ON 64
ci_066                 5.377564e-03 3 1  ON 65
ci_067                 5.817407e-03 3 1  ON 66
ci_068                -4.928673e-03 3 1  ON 67
ci_069                -5.318008e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.305142
====================================================
  Execution time = 1.4509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1326e-01
  Total weights = 1.956725648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299048959842
                                         uncertainty =       0.001999507156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299048959842
                                         uncertainty =       0.001999507156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386740209
  error estimate for blocks of size 2^( 2) =       0.000396787798
  error estimate for blocks of size 2^( 3) =       0.000405515068
  error estimate for blocks of size 2^( 4) =       0.000411293755
  error estimate for blocks of size 2^( 5) =       0.000416052715
  error estimate for blocks of size 2^( 6) =       0.000417868458
  error estimate for blocks of size 2^( 7) =       0.000418752639

      target function =                  N/A
              le_mean =     -17.216758376523
             les_mean =     296.730030991407
             stat err =       0.000415991892
             autocorr =       1.156993920922
              std dev =       0.546933248252
             le_variance =       0.299135978043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675837652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216758376625       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760576029       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216759988461       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760065415       residual = 5.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.296225e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216758376625       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759159033       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216759151092       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.890862e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216758376625       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216758595355       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216758619331       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216758618876       residual = 3.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.349542e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6999e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.008951e-02 3 1  ON 0
ci_002                -3.045431e-02 3 1  ON 1
ci_003                -2.568543e-02 3 1  ON 2
ci_004                 2.116969e-02 3 1  ON 3
ci_005                 2.145538e-02 3 1  ON 4
ci_006                -1.905354e-02 3 1  ON 5
ci_007                -1.953759e-02 3 1  ON 6
ci_008                -1.821111e-02 3 1  ON 7
ci_009                -1.862655e-02 3 1  ON 8
ci_010                -1.681892e-02 3 1  ON 9
ci_011                -1.619724e-02 3 1  ON 10
ci_012                -1.647556e-02 3 1  ON 11
ci_013                -1.882526e-02 3 1  ON 12
ci_014                 1.397073e-02 3 1  ON 13
ci_015                 1.372876e-02 3 1  ON 14
ci_016                 1.641753e-02 3 1  ON 15
ci_017                 1.631348e-02 3 1  ON 16
ci_018                 1.268837e-02 3 1  ON 17
ci_019                 1.292047e-02 3 1  ON 18
ci_020                 1.377057e-02 3 1  ON 19
ci_021                 1.265063e-02 3 1  ON 20
ci_022                 1.156210e-02 3 1  ON 21
ci_023                 1.112780e-02 3 1  ON 22
ci_024                 1.131481e-02 3 1  ON 23
ci_025                 1.089561e-02 3 1  ON 24
ci_026                 1.140132e-02 3 1  ON 25
ci_027                 1.188901e-02 3 1  ON 26
ci_028                -1.412817e-02 3 1  ON 27
ci_029                -1.404848e-02 3 1  ON 28
ci_030                -1.085697e-02 3 1  ON 29
ci_031                -1.123047e-02 3 1  ON 30
ci_032                -1.403523e-02 3 1  ON 31
ci_033                 1.036900e-02 3 1  ON 32
ci_034                 1.012026e-02 3 1  ON 33
ci_035                -4.807794e-03 3 1  ON 34
ci_036                -1.115950e-02 3 1  ON 35
ci_037                -1.094265e-02 3 1  ON 36
ci_038                 1.081762e-03 3 1  ON 37
ci_039                 1.149291e-03 3 1  ON 38
ci_040                -3.957689e-03 3 1  ON 39
ci_041                 9.739077e-03 3 1  ON 40
ci_042                 9.512053e-03 3 1  ON 41
ci_043                -3.497684e-03 3 1  ON 42
ci_044                -1.553608e-02 3 1  ON 43
ci_045                -1.651379e-03 3 1  ON 44
ci_046                 5.355919e-03 3 1  ON 45
ci_047                 5.399363e-03 3 1  ON 46
ci_048                -1.174994e-02 3 1  ON 47
ci_049                -1.207641e-02 3 1  ON 48
ci_050                 7.566217e-03 3 1  ON 49
ci_051                 7.383622e-03 3 1  ON 50
ci_052                -6.894912e-03 3 1  ON 51
ci_053                -6.965707e-03 3 1  ON 52
ci_054                -2.294148e-03 3 1  ON 53
ci_055                -2.343583e-03 3 1  ON 54
ci_056                 5.060125e-03 3 1  ON 55
ci_057                 4.777793e-03 3 1  ON 56
ci_058                -7.062822e-03 3 1  ON 57
ci_059                -6.590545e-03 3 1  ON 58
ci_060                 8.660250e-03 3 1  ON 59
ci_061                 8.886712e-03 3 1  ON 60
ci_062                -3.054050e-03 3 1  ON 61
ci_063                -3.119189e-03 3 1  ON 62
ci_064                -3.187254e-03 3 1  ON 63
ci_065                -3.931211e-03 3 1  ON 64
ci_066                 5.485305e-03 3 1  ON 65
ci_067                 5.867033e-03 3 1  ON 66
ci_068                -4.985228e-03 3 1  ON 67
ci_069                -5.378001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 1.64059
====================================================
  Execution time = 1.3854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1800e-01
  Total weights = 1.9569e+06
  Execution time = 1.8288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302325304364
                                         uncertainty =       0.002414959463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302325304364
                                         uncertainty =       0.002414959463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388847539
  error estimate for blocks of size 2^( 2) =       0.000398707387
  error estimate for blocks of size 2^( 3) =       0.000407389228
  error estimate for blocks of size 2^( 4) =       0.000413711336
  error estimate for blocks of size 2^( 5) =       0.000416743156
  error estimate for blocks of size 2^( 6) =       0.000417098051
  error estimate for blocks of size 2^( 7) =       0.000416982945

      target function =                  N/A
              le_mean =     -17.217487608947
             les_mean =     296.764610341611
             stat err =       0.000416133872
             autocorr =       1.145268790157
              std dev =       0.549913463213
             le_variance =       0.302404817023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302619967109
                                         uncertainty =       0.002420501632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302619967109
                                         uncertainty =       0.002420501632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389038251
  error estimate for blocks of size 2^( 2) =       0.000398899257
  error estimate for blocks of size 2^( 3) =       0.000407567094
  error estimate for blocks of size 2^( 4) =       0.000413863052
  error estimate for blocks of size 2^( 5) =       0.000416905808
  error estimate for blocks of size 2^( 6) =       0.000417251898
  error estimate for blocks of size 2^( 7) =       0.000417142049

      target function =                  N/A
              le_mean =     -17.217505150015
             les_mean =     296.760355324861
             stat err =       0.000416290702
             autocorr =       1.145008771220
              std dev =       0.550183170659
             le_variance =       0.302701521277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302447536139
                                         uncertainty =       0.002421476581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302447536139
                                         uncertainty =       0.002421476581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388927036
  error estimate for blocks of size 2^( 2) =       0.000398782857
  error estimate for blocks of size 2^( 3) =       0.000407455228
  error estimate for blocks of size 2^( 4) =       0.000413763708
  error estimate for blocks of size 2^( 5) =       0.000416802315
  error estimate for blocks of size 2^( 6) =       0.000417147513
  error estimate for blocks of size 2^( 7) =       0.000417028589

      target function =                  N/A
              le_mean =     -17.217495805184
             les_mean =     296.759233026095
             stat err =       0.000416185531
             autocorr =       1.145084899897
              std dev =       0.550025889382
             le_variance =       0.302528478990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302335755650
                                         uncertainty =       0.002415938928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302335755650
                                         uncertainty =       0.002415938928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388854383
  error estimate for blocks of size 2^( 2) =       0.000398713855
  error estimate for blocks of size 2^( 3) =       0.000407394258
  error estimate for blocks of size 2^( 4) =       0.000413714087
  error estimate for blocks of size 2^( 5) =       0.000416746440
  error estimate for blocks of size 2^( 6) =       0.000417099360
  error estimate for blocks of size 2^( 7) =       0.000416983718

      target function =                  N/A
              le_mean =     -17.217488817415
             les_mean =     296.764019496983
             stat err =       0.000416135901
             autocorr =       1.145239646113
              std dev =       0.549923141821
             le_variance =       0.302415461910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217487608947        initial
     3.9062e-01     3.9062e+00             5.2962e-04       -17.217505150015  <--
     1.5625e+00     1.5625e+01             1.8909e-04       -17.217495805184
     6.2500e+00     6.2500e+01             5.3495e-05       -17.217488817415

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.3100e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.007736e-02 3 1  ON 0
ci_002                -3.043739e-02 3 1  ON 1
ci_003                -2.595435e-02 3 1  ON 2
ci_004                 2.107869e-02 3 1  ON 3
ci_005                 2.125964e-02 3 1  ON 4
ci_006                -1.910648e-02 3 1  ON 5
ci_007                -1.933139e-02 3 1  ON 6
ci_008                -1.828968e-02 3 1  ON 7
ci_009                -1.828601e-02 3 1  ON 8
ci_010                -1.701964e-02 3 1  ON 9
ci_011                -1.626799e-02 3 1  ON 10
ci_012                -1.635233e-02 3 1  ON 11
ci_013                -1.889226e-02 3 1  ON 12
ci_014                 1.395111e-02 3 1  ON 13
ci_015                 1.407459e-02 3 1  ON 14
ci_016                 1.658221e-02 3 1  ON 15
ci_017                 1.603100e-02 3 1  ON 16
ci_018                 1.252807e-02 3 1  ON 17
ci_019                 1.298517e-02 3 1  ON 18
ci_020                 1.350890e-02 3 1  ON 19
ci_021                 1.272075e-02 3 1  ON 20
ci_022                 1.138094e-02 3 1  ON 21
ci_023                 1.111265e-02 3 1  ON 22
ci_024                 1.145057e-02 3 1  ON 23
ci_025                 1.107311e-02 3 1  ON 24
ci_026                 1.142922e-02 3 1  ON 25
ci_027                 1.192208e-02 3 1  ON 26
ci_028                -1.386211e-02 3 1  ON 27
ci_029                -1.401261e-02 3 1  ON 28
ci_030                -1.102328e-02 3 1  ON 29
ci_031                -1.126719e-02 3 1  ON 30
ci_032                -1.388755e-02 3 1  ON 31
ci_033                 1.026761e-02 3 1  ON 32
ci_034                 1.012530e-02 3 1  ON 33
ci_035                -4.664230e-03 3 1  ON 34
ci_036                -1.125576e-02 3 1  ON 35
ci_037                -1.100033e-02 3 1  ON 36
ci_038                 1.015050e-03 3 1  ON 37
ci_039                 1.035759e-03 3 1  ON 38
ci_040                -3.968963e-03 3 1  ON 39
ci_041                 9.911408e-03 3 1  ON 40
ci_042                 9.650918e-03 3 1  ON 41
ci_043                -3.437299e-03 3 1  ON 42
ci_044                -1.561317e-02 3 1  ON 43
ci_045                -1.619308e-03 3 1  ON 44
ci_046                 5.579126e-03 3 1  ON 45
ci_047                 5.475602e-03 3 1  ON 46
ci_048                -1.206770e-02 3 1  ON 47
ci_049                -1.205213e-02 3 1  ON 48
ci_050                 7.557260e-03 3 1  ON 49
ci_051                 7.387930e-03 3 1  ON 50
ci_052                -7.032329e-03 3 1  ON 51
ci_053                -6.669543e-03 3 1  ON 52
ci_054                -2.109689e-03 3 1  ON 53
ci_055                -2.270615e-03 3 1  ON 54
ci_056                 5.153861e-03 3 1  ON 55
ci_057                 5.021426e-03 3 1  ON 56
ci_058                -7.053369e-03 3 1  ON 57
ci_059                -6.716807e-03 3 1  ON 58
ci_060                 8.867708e-03 3 1  ON 59
ci_061                 8.798384e-03 3 1  ON 60
ci_062                -3.274059e-03 3 1  ON 61
ci_063                -3.376904e-03 3 1  ON 62
ci_064                -3.116014e-03 3 1  ON 63
ci_065                -4.165931e-03 3 1  ON 64
ci_066                 5.656515e-03 3 1  ON 65
ci_067                 5.945967e-03 3 1  ON 66
ci_068                -5.093368e-03 3 1  ON 67
ci_069                -5.495942e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2285
    reference variance = 0.155281
====================================================
  Execution time = 1.4230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2122e-01
  Total weights = 1.956233956e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303498369785
                                         uncertainty =       0.004133490940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303498369785
                                         uncertainty =       0.004133490940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389569558
  error estimate for blocks of size 2^( 2) =       0.000399300756
  error estimate for blocks of size 2^( 3) =       0.000407909126
  error estimate for blocks of size 2^( 4) =       0.000414395444
  error estimate for blocks of size 2^( 5) =       0.000418893227
  error estimate for blocks of size 2^( 6) =       0.000421882923
  error estimate for blocks of size 2^( 7) =       0.000424224208

      target function =                  N/A
              le_mean =     -17.216429561344
             les_mean =     296.726668285557
             stat err =       0.000419848951
             autocorr =       1.161491721645
              std dev =       0.550934552551
             le_variance =       0.303528881194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642956134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429561386       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438422933       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216437130258       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216437445229       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216437437784       residual = 4.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.539585e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429561386       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216434378026       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216433969646       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216434052728       residual = 8.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.925894e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429561386       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431265893       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216431230575       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.695577e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6709e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.001238e-02 3 1  ON 0
ci_002                -3.020971e-02 3 1  ON 1
ci_003                -2.554590e-02 3 1  ON 2
ci_004                 2.096216e-02 3 1  ON 3
ci_005                 2.153978e-02 3 1  ON 4
ci_006                -1.910415e-02 3 1  ON 5
ci_007                -1.935340e-02 3 1  ON 6
ci_008                -1.793633e-02 3 1  ON 7
ci_009                -1.860371e-02 3 1  ON 8
ci_010                -1.705051e-02 3 1  ON 9
ci_011                -1.667135e-02 3 1  ON 10
ci_012                -1.555975e-02 3 1  ON 11
ci_013                -1.921244e-02 3 1  ON 12
ci_014                 1.360838e-02 3 1  ON 13
ci_015                 1.417597e-02 3 1  ON 14
ci_016                 1.667796e-02 3 1  ON 15
ci_017                 1.614109e-02 3 1  ON 16
ci_018                 1.236621e-02 3 1  ON 17
ci_019                 1.313287e-02 3 1  ON 18
ci_020                 1.334405e-02 3 1  ON 19
ci_021                 1.297345e-02 3 1  ON 20
ci_022                 1.132287e-02 3 1  ON 21
ci_023                 1.111381e-02 3 1  ON 22
ci_024                 1.119517e-02 3 1  ON 23
ci_025                 1.103299e-02 3 1  ON 24
ci_026                 1.177566e-02 3 1  ON 25
ci_027                 1.195179e-02 3 1  ON 26
ci_028                -1.385406e-02 3 1  ON 27
ci_029                -1.392346e-02 3 1  ON 28
ci_030                -1.095717e-02 3 1  ON 29
ci_031                -1.106366e-02 3 1  ON 30
ci_032                -1.396961e-02 3 1  ON 31
ci_033                 1.013244e-02 3 1  ON 32
ci_034                 1.006480e-02 3 1  ON 33
ci_035                -4.650938e-03 3 1  ON 34
ci_036                -1.122083e-02 3 1  ON 35
ci_037                -1.088947e-02 3 1  ON 36
ci_038                 1.014302e-03 3 1  ON 37
ci_039                 1.115377e-03 3 1  ON 38
ci_040                -4.061697e-03 3 1  ON 39
ci_041                 9.424932e-03 3 1  ON 40
ci_042                 9.940442e-03 3 1  ON 41
ci_043                -3.344865e-03 3 1  ON 42
ci_044                -1.564294e-02 3 1  ON 43
ci_045                -1.580139e-03 3 1  ON 44
ci_046                 5.382947e-03 3 1  ON 45
ci_047                 5.557125e-03 3 1  ON 46
ci_048                -1.195710e-02 3 1  ON 47
ci_049                -1.226224e-02 3 1  ON 48
ci_050                 7.597765e-03 3 1  ON 49
ci_051                 7.450595e-03 3 1  ON 50
ci_052                -7.219503e-03 3 1  ON 51
ci_053                -6.600186e-03 3 1  ON 52
ci_054                -2.083623e-03 3 1  ON 53
ci_055                -2.089606e-03 3 1  ON 54
ci_056                 4.470800e-03 3 1  ON 55
ci_057                 4.725735e-03 3 1  ON 56
ci_058                -6.593784e-03 3 1  ON 57
ci_059                -6.947238e-03 3 1  ON 58
ci_060                 8.732981e-03 3 1  ON 59
ci_061                 9.015015e-03 3 1  ON 60
ci_062                -2.996542e-03 3 1  ON 61
ci_063                -3.005907e-03 3 1  ON 62
ci_064                -3.264017e-03 3 1  ON 63
ci_065                -4.297288e-03 3 1  ON 64
ci_066                 5.806330e-03 3 1  ON 65
ci_067                 5.907626e-03 3 1  ON 66
ci_068                -5.173639e-03 3 1  ON 67
ci_069                -5.254349e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1447
    reference variance = 0.203836
====================================================
  Execution time = 1.3872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1855e-01
  Total weights = 1.9572e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0184987
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301457874003
                                         uncertainty =       0.001864047589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301457874003
                                         uncertainty =       0.001864047589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388242475
  error estimate for blocks of size 2^( 2) =       0.000398225415
  error estimate for blocks of size 2^( 3) =       0.000407177024
  error estimate for blocks of size 2^( 4) =       0.000413826567
  error estimate for blocks of size 2^( 5) =       0.000417520986
  error estimate for blocks of size 2^( 6) =       0.000419418708
  error estimate for blocks of size 2^( 7) =       0.000420886646

      target function =                  N/A
              le_mean =     -17.216455384476
             les_mean =     296.727946926417
             stat err =       0.000417913227
             autocorr =       1.158687011585
              std dev =       0.549057774209
             le_variance =       0.301464439419

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00837283
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301093776286
                                         uncertainty =       0.001855679561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301093776286
                                         uncertainty =       0.001855679561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388006957
  error estimate for blocks of size 2^( 2) =       0.000398001839
  error estimate for blocks of size 2^( 3) =       0.000406965765
  error estimate for blocks of size 2^( 4) =       0.000413636784
  error estimate for blocks of size 2^( 5) =       0.000417347277
  error estimate for blocks of size 2^( 6) =       0.000419212991
  error estimate for blocks of size 2^( 7) =       0.000420714693

      target function =                  N/A
              le_mean =     -17.216469192571
             les_mean =     296.745587252432
             stat err =       0.000417727936
             autocorr =       1.159065595251
              std dev =       0.548724701353
             le_variance =       0.301098797874

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0188893
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301095532539
                                         uncertainty =       0.001858315621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301095532539
                                         uncertainty =       0.001858315621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388008322
  error estimate for blocks of size 2^( 2) =       0.000398003888
  error estimate for blocks of size 2^( 3) =       0.000406965981
  error estimate for blocks of size 2^( 4) =       0.000413637642
  error estimate for blocks of size 2^( 5) =       0.000417349011
  error estimate for blocks of size 2^( 6) =       0.000419216799
  error estimate for blocks of size 2^( 7) =       0.000420717264

      target function =                  N/A
              le_mean =     -17.216473968692
             les_mean =     296.727512095154
             stat err =       0.000417730179
             autocorr =       1.159069886348
              std dev =       0.548726631573
             le_variance =       0.301100916198

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0755961
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301341553761
                                         uncertainty =       0.001862153547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301341553761
                                         uncertainty =       0.001862153547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388167507
  error estimate for blocks of size 2^( 2) =       0.000398153266
  error estimate for blocks of size 2^( 3) =       0.000407105428
  error estimate for blocks of size 2^( 4) =       0.000413758692
  error estimate for blocks of size 2^( 5) =       0.000417455082
  error estimate for blocks of size 2^( 6) =       0.000419350456
  error estimate for blocks of size 2^( 7) =       0.000420823701

      target function =                  N/A
              le_mean =     -17.216453228230
             les_mean =     296.728020531660
             stat err =       0.000417846983
             autocorr =       1.158767177007
              std dev =       0.548951752229
             le_variance =       0.301348026275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216455384476        initial
     9.7656e-02     9.7656e-01             1.5396e-03       -17.216469192571
     3.9062e-01     3.9062e+00             7.9259e-04       -17.216473968692  <--
     1.5625e+00     1.5625e+01             2.6956e-04       -17.216453228230

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.3116e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.001238e-02 3 1  ON 0
ci_002                -3.020971e-02 3 1  ON 1
ci_003                -2.554590e-02 3 1  ON 2
ci_004                 2.096216e-02 3 1  ON 3
ci_005                 2.153978e-02 3 1  ON 4
ci_006                -1.910415e-02 3 1  ON 5
ci_007                -1.935340e-02 3 1  ON 6
ci_008                -1.793633e-02 3 1  ON 7
ci_009                -1.860371e-02 3 1  ON 8
ci_010                -1.705051e-02 3 1  ON 9
ci_011                -1.667135e-02 3 1  ON 10
ci_012                -1.555975e-02 3 1  ON 11
ci_013                -1.921244e-02 3 1  ON 12
ci_014                 1.360838e-02 3 1  ON 13
ci_015                 1.417597e-02 3 1  ON 14
ci_016                 1.667796e-02 3 1  ON 15
ci_017                 1.614109e-02 3 1  ON 16
ci_018                 1.236621e-02 3 1  ON 17
ci_019                 1.313287e-02 3 1  ON 18
ci_020                 1.334405e-02 3 1  ON 19
ci_021                 1.297345e-02 3 1  ON 20
ci_022                 1.132287e-02 3 1  ON 21
ci_023                 1.111381e-02 3 1  ON 22
ci_024                 1.119517e-02 3 1  ON 23
ci_025                 1.103299e-02 3 1  ON 24
ci_026                 1.177566e-02 3 1  ON 25
ci_027                 1.195179e-02 3 1  ON 26
ci_028                -1.385406e-02 3 1  ON 27
ci_029                -1.392346e-02 3 1  ON 28
ci_030                -1.095717e-02 3 1  ON 29
ci_031                -1.106366e-02 3 1  ON 30
ci_032                -1.396961e-02 3 1  ON 31
ci_033                 1.013244e-02 3 1  ON 32
ci_034                 1.006480e-02 3 1  ON 33
ci_035                -4.650938e-03 3 1  ON 34
ci_036                -1.122083e-02 3 1  ON 35
ci_037                -1.088947e-02 3 1  ON 36
ci_038                 1.014302e-03 3 1  ON 37
ci_039                 1.115377e-03 3 1  ON 38
ci_040                -4.061697e-03 3 1  ON 39
ci_041                 9.424932e-03 3 1  ON 40
ci_042                 9.940442e-03 3 1  ON 41
ci_043                -3.344865e-03 3 1  ON 42
ci_044                -1.564294e-02 3 1  ON 43
ci_045                -1.580139e-03 3 1  ON 44
ci_046                 5.382947e-03 3 1  ON 45
ci_047                 5.557125e-03 3 1  ON 46
ci_048                -1.195710e-02 3 1  ON 47
ci_049                -1.226224e-02 3 1  ON 48
ci_050                 7.597765e-03 3 1  ON 49
ci_051                 7.450595e-03 3 1  ON 50
ci_052                -7.219503e-03 3 1  ON 51
ci_053                -6.600186e-03 3 1  ON 52
ci_054                -2.083623e-03 3 1  ON 53
ci_055                -2.089606e-03 3 1  ON 54
ci_056                 4.470800e-03 3 1  ON 55
ci_057                 4.725735e-03 3 1  ON 56
ci_058                -6.593784e-03 3 1  ON 57
ci_059                -6.947238e-03 3 1  ON 58
ci_060                 8.732981e-03 3 1  ON 59
ci_061                 9.015015e-03 3 1  ON 60
ci_062                -2.996542e-03 3 1  ON 61
ci_063                -3.005907e-03 3 1  ON 62
ci_064                -3.264017e-03 3 1  ON 63
ci_065                -4.297288e-03 3 1  ON 64
ci_066                 5.806330e-03 3 1  ON 65
ci_067                 5.907626e-03 3 1  ON 66
ci_068                -5.173639e-03 3 1  ON 67
ci_069                -5.254349e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1715
    reference variance = 0.203726
====================================================
  Execution time = 1.4271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2066e-01
  Total weights = 1.956672976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301885135278
                                         uncertainty =       0.002326830937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301885135278
                                         uncertainty =       0.002326830937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388453631
  error estimate for blocks of size 2^( 2) =       0.000397806335
  error estimate for blocks of size 2^( 3) =       0.000406313896
  error estimate for blocks of size 2^( 4) =       0.000411665767
  error estimate for blocks of size 2^( 5) =       0.000414814475
  error estimate for blocks of size 2^( 6) =       0.000417217632
  error estimate for blocks of size 2^( 7) =       0.000419878479

      target function =                  N/A
              le_mean =     -17.216220353916
             les_mean =     296.718901636514
             stat err =       0.000415894088
             autocorr =       1.146270520689
              std dev =       0.549356392977
             le_variance =       0.301792446505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622035392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220353952       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216221872637       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216221831717       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216222475358       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216222375220       residual = 4.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.378756e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220353952       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216221180523       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220806896       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216220897824       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.863816e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220353952       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220646758       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220402108       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216220385383       residual = 3.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.893453e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6753e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.010310e-02 3 1  ON 0
ci_002                -3.007014e-02 3 1  ON 1
ci_003                -2.565721e-02 3 1  ON 2
ci_004                 2.118287e-02 3 1  ON 3
ci_005                 2.144066e-02 3 1  ON 4
ci_006                -1.899804e-02 3 1  ON 5
ci_007                -1.896785e-02 3 1  ON 6
ci_008                -1.799144e-02 3 1  ON 7
ci_009                -1.803334e-02 3 1  ON 8
ci_010                -1.717626e-02 3 1  ON 9
ci_011                -1.675193e-02 3 1  ON 10
ci_012                -1.554612e-02 3 1  ON 11
ci_013                -1.913707e-02 3 1  ON 12
ci_014                 1.358338e-02 3 1  ON 13
ci_015                 1.395496e-02 3 1  ON 14
ci_016                 1.684349e-02 3 1  ON 15
ci_017                 1.592821e-02 3 1  ON 16
ci_018                 1.275976e-02 3 1  ON 17
ci_019                 1.281411e-02 3 1  ON 18
ci_020                 1.340627e-02 3 1  ON 19
ci_021                 1.297116e-02 3 1  ON 20
ci_022                 1.142146e-02 3 1  ON 21
ci_023                 1.135444e-02 3 1  ON 22
ci_024                 1.136186e-02 3 1  ON 23
ci_025                 1.129883e-02 3 1  ON 24
ci_026                 1.182295e-02 3 1  ON 25
ci_027                 1.177957e-02 3 1  ON 26
ci_028                -1.383437e-02 3 1  ON 27
ci_029                -1.400126e-02 3 1  ON 28
ci_030                -1.116764e-02 3 1  ON 29
ci_031                -1.081495e-02 3 1  ON 30
ci_032                -1.367940e-02 3 1  ON 31
ci_033                 1.036730e-02 3 1  ON 32
ci_034                 9.766384e-03 3 1  ON 33
ci_035                -4.876948e-03 3 1  ON 34
ci_036                -1.105946e-02 3 1  ON 35
ci_037                -1.026128e-02 3 1  ON 36
ci_038                 1.250961e-03 3 1  ON 37
ci_039                 1.143043e-03 3 1  ON 38
ci_040                -4.041304e-03 3 1  ON 39
ci_041                 9.241453e-03 3 1  ON 40
ci_042                 9.896482e-03 3 1  ON 41
ci_043                -3.006950e-03 3 1  ON 42
ci_044                -1.562100e-02 3 1  ON 43
ci_045                -1.576808e-03 3 1  ON 44
ci_046                 5.662879e-03 3 1  ON 45
ci_047                 6.141286e-03 3 1  ON 46
ci_048                -1.173149e-02 3 1  ON 47
ci_049                -1.161972e-02 3 1  ON 48
ci_050                 7.601498e-03 3 1  ON 49
ci_051                 7.448567e-03 3 1  ON 50
ci_052                -7.129441e-03 3 1  ON 51
ci_053                -6.486650e-03 3 1  ON 52
ci_054                -2.484502e-03 3 1  ON 53
ci_055                -2.460551e-03 3 1  ON 54
ci_056                 4.695032e-03 3 1  ON 55
ci_057                 4.813731e-03 3 1  ON 56
ci_058                -7.380166e-03 3 1  ON 57
ci_059                -6.914529e-03 3 1  ON 58
ci_060                 8.418892e-03 3 1  ON 59
ci_061                 9.005218e-03 3 1  ON 60
ci_062                -2.998363e-03 3 1  ON 61
ci_063                -2.841997e-03 3 1  ON 62
ci_064                -3.376699e-03 3 1  ON 63
ci_065                -4.275759e-03 3 1  ON 64
ci_066                 5.682706e-03 3 1  ON 65
ci_067                 5.986307e-03 3 1  ON 66
ci_068                -4.504190e-03 3 1  ON 67
ci_069                -4.983827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.282
    reference variance = 0.293501
====================================================
  Execution time = 1.4118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1425e-01
  Total weights = 1.9565e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299578370147
                                         uncertainty =       0.001910906153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299578370147
                                         uncertainty =       0.001910906153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387086291
  error estimate for blocks of size 2^( 2) =       0.000396814751
  error estimate for blocks of size 2^( 3) =       0.000405376580
  error estimate for blocks of size 2^( 4) =       0.000412647844
  error estimate for blocks of size 2^( 5) =       0.000416647639
  error estimate for blocks of size 2^( 6) =       0.000418429518
  error estimate for blocks of size 2^( 7) =       0.000419430748

      target function =                  N/A
              le_mean =     -17.216598010749
             les_mean =     296.726102077890
             stat err =       0.000416788937
             autocorr =       1.159355923703
              std dev =       0.547422682340
             le_variance =       0.299671593141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300305472157
                                         uncertainty =       0.001911052028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300305472157
                                         uncertainty =       0.001911052028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387562759
  error estimate for blocks of size 2^( 2) =       0.000397315266
  error estimate for blocks of size 2^( 3) =       0.000405921939
  error estimate for blocks of size 2^( 4) =       0.000413186797
  error estimate for blocks of size 2^( 5) =       0.000417231469
  error estimate for blocks of size 2^( 6) =       0.000418982342
  error estimate for blocks of size 2^( 7) =       0.000420000226

      target function =                  N/A
              le_mean =     -17.216581312965
             les_mean =     296.736021036998
             stat err =       0.000417350208
             autocorr =       1.159623992715
              std dev =       0.548096509495
             le_variance =       0.300409783721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300397998840
                                         uncertainty =       0.001913303866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300397998840
                                         uncertainty =       0.001913303866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387622794
  error estimate for blocks of size 2^( 2) =       0.000397376649
  error estimate for blocks of size 2^( 3) =       0.000405977889
  error estimate for blocks of size 2^( 4) =       0.000413240097
  error estimate for blocks of size 2^( 5) =       0.000417293855
  error estimate for blocks of size 2^( 6) =       0.000419060233
  error estimate for blocks of size 2^( 7) =       0.000420068410

      target function =                  N/A
              le_mean =     -17.216590985525
             les_mean =     296.805774911144
             stat err =       0.000417415649
             autocorr =       1.159628388464
              std dev =       0.548181411790
             le_variance =       0.300502860232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299657522814
                                         uncertainty =       0.001910555904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299657522814
                                         uncertainty =       0.001910555904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387138746
  error estimate for blocks of size 2^( 2) =       0.000396871864
  error estimate for blocks of size 2^( 3) =       0.000405441503
  error estimate for blocks of size 2^( 4) =       0.000412712197
  error estimate for blocks of size 2^( 5) =       0.000416723004
  error estimate for blocks of size 2^( 6) =       0.000418497861
  error estimate for blocks of size 2^( 7) =       0.000419502361

      target function =                  N/A
              le_mean =     -17.216589962521
             les_mean =     296.726191810100
             stat err =       0.000416858856
             autocorr =       1.159430674472
              std dev =       0.547496865537
             le_variance =       0.299752817773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216598010749        initial  <--
     9.7656e-02     9.7656e-01             1.3788e-03       -17.216581312965
     3.9062e-01     3.9062e+00             7.8638e-04       -17.216590985525
     1.5625e+00     1.5625e+01             2.8935e-04       -17.216589962521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3451
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.001238e-02 3 1  ON 0
ci_002                -3.020971e-02 3 1  ON 1
ci_003                -2.554590e-02 3 1  ON 2
ci_004                 2.096216e-02 3 1  ON 3
ci_005                 2.153978e-02 3 1  ON 4
ci_006                -1.910415e-02 3 1  ON 5
ci_007                -1.935340e-02 3 1  ON 6
ci_008                -1.793633e-02 3 1  ON 7
ci_009                -1.860371e-02 3 1  ON 8
ci_010                -1.705051e-02 3 1  ON 9
ci_011                -1.667135e-02 3 1  ON 10
ci_012                -1.555975e-02 3 1  ON 11
ci_013                -1.921244e-02 3 1  ON 12
ci_014                 1.360838e-02 3 1  ON 13
ci_015                 1.417597e-02 3 1  ON 14
ci_016                 1.667796e-02 3 1  ON 15
ci_017                 1.614109e-02 3 1  ON 16
ci_018                 1.236621e-02 3 1  ON 17
ci_019                 1.313287e-02 3 1  ON 18
ci_020                 1.334405e-02 3 1  ON 19
ci_021                 1.297345e-02 3 1  ON 20
ci_022                 1.132287e-02 3 1  ON 21
ci_023                 1.111381e-02 3 1  ON 22
ci_024                 1.119517e-02 3 1  ON 23
ci_025                 1.103299e-02 3 1  ON 24
ci_026                 1.177566e-02 3 1  ON 25
ci_027                 1.195179e-02 3 1  ON 26
ci_028                -1.385406e-02 3 1  ON 27
ci_029                -1.392346e-02 3 1  ON 28
ci_030                -1.095717e-02 3 1  ON 29
ci_031                -1.106366e-02 3 1  ON 30
ci_032                -1.396961e-02 3 1  ON 31
ci_033                 1.013244e-02 3 1  ON 32
ci_034                 1.006480e-02 3 1  ON 33
ci_035                -4.650938e-03 3 1  ON 34
ci_036                -1.122083e-02 3 1  ON 35
ci_037                -1.088947e-02 3 1  ON 36
ci_038                 1.014302e-03 3 1  ON 37
ci_039                 1.115377e-03 3 1  ON 38
ci_040                -4.061697e-03 3 1  ON 39
ci_041                 9.424932e-03 3 1  ON 40
ci_042                 9.940442e-03 3 1  ON 41
ci_043                -3.344865e-03 3 1  ON 42
ci_044                -1.564294e-02 3 1  ON 43
ci_045                -1.580139e-03 3 1  ON 44
ci_046                 5.382947e-03 3 1  ON 45
ci_047                 5.557125e-03 3 1  ON 46
ci_048                -1.195710e-02 3 1  ON 47
ci_049                -1.226224e-02 3 1  ON 48
ci_050                 7.597765e-03 3 1  ON 49
ci_051                 7.450595e-03 3 1  ON 50
ci_052                -7.219503e-03 3 1  ON 51
ci_053                -6.600186e-03 3 1  ON 52
ci_054                -2.083623e-03 3 1  ON 53
ci_055                -2.089606e-03 3 1  ON 54
ci_056                 4.470800e-03 3 1  ON 55
ci_057                 4.725735e-03 3 1  ON 56
ci_058                -6.593784e-03 3 1  ON 57
ci_059                -6.947238e-03 3 1  ON 58
ci_060                 8.732981e-03 3 1  ON 59
ci_061                 9.015015e-03 3 1  ON 60
ci_062                -2.996542e-03 3 1  ON 61
ci_063                -3.005907e-03 3 1  ON 62
ci_064                -3.264017e-03 3 1  ON 63
ci_065                -4.297288e-03 3 1  ON 64
ci_066                 5.806330e-03 3 1  ON 65
ci_067                 5.907626e-03 3 1  ON 66
ci_068                -5.173639e-03 3 1  ON 67
ci_069                -5.254349e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1728
    reference variance = 0.256975
====================================================
  Execution time = 1.4330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1440e-01
  Total weights = 1.957025658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300249919565
                                         uncertainty =       0.001704297202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300249919565
                                         uncertainty =       0.001704297202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387419162
  error estimate for blocks of size 2^( 2) =       0.000396830070
  error estimate for blocks of size 2^( 3) =       0.000405606124
  error estimate for blocks of size 2^( 4) =       0.000411542784
  error estimate for blocks of size 2^( 5) =       0.000415336299
  error estimate for blocks of size 2^( 6) =       0.000418028759
  error estimate for blocks of size 2^( 7) =       0.000421513539

      target function =                  N/A
              le_mean =     -17.216834368346
             les_mean =     296.733784991477
             stat err =       0.000416605345
             autocorr =       1.156345143063
              std dev =       0.547893433530
             le_variance =       0.300187214505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683436835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834368412       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216838806977       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216838533510       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216838575831       residual = 2.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 4.207026e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834368412       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835678104       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835628862       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835645851       residual = 1.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.234353e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216834368412       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216834711289       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216834701271       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216834705912       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 3.225644e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6816e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.001071e-02 3 1  ON 0
ci_002                -3.020917e-02 3 1  ON 1
ci_003                -2.545873e-02 3 1  ON 2
ci_004                 2.097851e-02 3 1  ON 3
ci_005                 2.151285e-02 3 1  ON 4
ci_006                -1.908563e-02 3 1  ON 5
ci_007                -1.934999e-02 3 1  ON 6
ci_008                -1.793023e-02 3 1  ON 7
ci_009                -1.857297e-02 3 1  ON 8
ci_010                -1.709234e-02 3 1  ON 9
ci_011                -1.674342e-02 3 1  ON 10
ci_012                -1.562027e-02 3 1  ON 11
ci_013                -1.916806e-02 3 1  ON 12
ci_014                 1.358993e-02 3 1  ON 13
ci_015                 1.418625e-02 3 1  ON 14
ci_016                 1.668317e-02 3 1  ON 15
ci_017                 1.618029e-02 3 1  ON 16
ci_018                 1.239642e-02 3 1  ON 17
ci_019                 1.314528e-02 3 1  ON 18
ci_020                 1.333529e-02 3 1  ON 19
ci_021                 1.302396e-02 3 1  ON 20
ci_022                 1.132612e-02 3 1  ON 21
ci_023                 1.112459e-02 3 1  ON 22
ci_024                 1.113610e-02 3 1  ON 23
ci_025                 1.104457e-02 3 1  ON 24
ci_026                 1.173406e-02 3 1  ON 25
ci_027                 1.194160e-02 3 1  ON 26
ci_028                -1.385297e-02 3 1  ON 27
ci_029                -1.392852e-02 3 1  ON 28
ci_030                -1.091236e-02 3 1  ON 29
ci_031                -1.104249e-02 3 1  ON 30
ci_032                -1.394868e-02 3 1  ON 31
ci_033                 1.010879e-02 3 1  ON 32
ci_034                 1.004065e-02 3 1  ON 33
ci_035                -4.660245e-03 3 1  ON 34
ci_036                -1.117285e-02 3 1  ON 35
ci_037                -1.087243e-02 3 1  ON 36
ci_038                 1.031681e-03 3 1  ON 37
ci_039                 1.131774e-03 3 1  ON 38
ci_040                -4.040920e-03 3 1  ON 39
ci_041                 9.478750e-03 3 1  ON 40
ci_042                 9.890059e-03 3 1  ON 41
ci_043                -3.283479e-03 3 1  ON 42
ci_044                -1.568104e-02 3 1  ON 43
ci_045                -1.571052e-03 3 1  ON 44
ci_046                 5.379250e-03 3 1  ON 45
ci_047                 5.507830e-03 3 1  ON 46
ci_048                -1.198251e-02 3 1  ON 47
ci_049                -1.227077e-02 3 1  ON 48
ci_050                 7.669761e-03 3 1  ON 49
ci_051                 7.480391e-03 3 1  ON 50
ci_052                -7.148521e-03 3 1  ON 51
ci_053                -6.624247e-03 3 1  ON 52
ci_054                -2.097623e-03 3 1  ON 53
ci_055                -2.094988e-03 3 1  ON 54
ci_056                 4.431051e-03 3 1  ON 55
ci_057                 4.743231e-03 3 1  ON 56
ci_058                -6.616451e-03 3 1  ON 57
ci_059                -6.934517e-03 3 1  ON 58
ci_060                 8.609545e-03 3 1  ON 59
ci_061                 9.039827e-03 3 1  ON 60
ci_062                -2.972575e-03 3 1  ON 61
ci_063                -2.992634e-03 3 1  ON 62
ci_064                -3.289611e-03 3 1  ON 63
ci_065                -4.279052e-03 3 1  ON 64
ci_066                 5.827540e-03 3 1  ON 65
ci_067                 5.926301e-03 3 1  ON 66
ci_068                -5.171264e-03 3 1  ON 67
ci_069                -5.238809e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1467
    reference variance = 0.16577
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.9568e+06
  Execution time = 1.8244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298774936696
                                         uncertainty =       0.001981500258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298774936696
                                         uncertainty =       0.001981500258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386473722
  error estimate for blocks of size 2^( 2) =       0.000396410501
  error estimate for blocks of size 2^( 3) =       0.000405403594
  error estimate for blocks of size 2^( 4) =       0.000411895135
  error estimate for blocks of size 2^( 5) =       0.000415980688
  error estimate for blocks of size 2^( 6) =       0.000416455095
  error estimate for blocks of size 2^( 7) =       0.000418874963

      target function =                  N/A
              le_mean =     -17.216752415483
             les_mean =     296.730096965544
             stat err =       0.000415801470
             autocorr =       1.157529588758
              std dev =       0.546556379614
             le_variance =       0.298723876097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298890517906
                                         uncertainty =       0.001995744272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298890517906
                                         uncertainty =       0.001995744272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386548273
  error estimate for blocks of size 2^( 2) =       0.000396478755
  error estimate for blocks of size 2^( 3) =       0.000405469825
  error estimate for blocks of size 2^( 4) =       0.000411966338
  error estimate for blocks of size 2^( 5) =       0.000416050465
  error estimate for blocks of size 2^( 6) =       0.000416512300
  error estimate for blocks of size 2^( 7) =       0.000418937467

      target function =                  N/A
              le_mean =     -17.216750476393
             les_mean =     296.731059067826
             stat err =       0.000415866643
             autocorr =       1.157445891006
              std dev =       0.546661810750
             le_variance =       0.298839135333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298838684089
                                         uncertainty =       0.001989923246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298838684089
                                         uncertainty =       0.001989923246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386514826
  error estimate for blocks of size 2^( 2) =       0.000396447861
  error estimate for blocks of size 2^( 3) =       0.000405439826
  error estimate for blocks of size 2^( 4) =       0.000411934358
  error estimate for blocks of size 2^( 5) =       0.000416018994
  error estimate for blocks of size 2^( 6) =       0.000416485733
  error estimate for blocks of size 2^( 7) =       0.000418908421

      target function =                  N/A
              le_mean =     -17.216750774377
             les_mean =     296.732778550207
             stat err =       0.000415836876
             autocorr =       1.157480505967
              std dev =       0.546614508846
             le_variance =       0.298787421281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298782451963
                                         uncertainty =       0.001982584454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298782451963
                                         uncertainty =       0.001982584454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386478566
  error estimate for blocks of size 2^( 2) =       0.000396414861
  error estimate for blocks of size 2^( 3) =       0.000405407819
  error estimate for blocks of size 2^( 4) =       0.000411899748
  error estimate for blocks of size 2^( 5) =       0.000415985200
  error estimate for blocks of size 2^( 6) =       0.000416458594
  error estimate for blocks of size 2^( 7) =       0.000418878875

      target function =                  N/A
              le_mean =     -17.216752109011
             les_mean =     296.730102862717
             stat err =       0.000415805604
             autocorr =       1.157523589407
              std dev =       0.546563229937
             le_variance =       0.298731364320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216752415483        initial  <--
     9.7656e-01     9.7656e+00             4.2070e-04       -17.216750476393
     3.9062e+00     3.9062e+01             1.2344e-04       -17.216750774377
     1.5625e+01     1.5625e+02             3.2256e-05       -17.216752109011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5165
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.001238e-02 3 1  ON 0
ci_002                -3.020971e-02 3 1  ON 1
ci_003                -2.554590e-02 3 1  ON 2
ci_004                 2.096216e-02 3 1  ON 3
ci_005                 2.153978e-02 3 1  ON 4
ci_006                -1.910415e-02 3 1  ON 5
ci_007                -1.935340e-02 3 1  ON 6
ci_008                -1.793633e-02 3 1  ON 7
ci_009                -1.860371e-02 3 1  ON 8
ci_010                -1.705051e-02 3 1  ON 9
ci_011                -1.667135e-02 3 1  ON 10
ci_012                -1.555975e-02 3 1  ON 11
ci_013                -1.921244e-02 3 1  ON 12
ci_014                 1.360838e-02 3 1  ON 13
ci_015                 1.417597e-02 3 1  ON 14
ci_016                 1.667796e-02 3 1  ON 15
ci_017                 1.614109e-02 3 1  ON 16
ci_018                 1.236621e-02 3 1  ON 17
ci_019                 1.313287e-02 3 1  ON 18
ci_020                 1.334405e-02 3 1  ON 19
ci_021                 1.297345e-02 3 1  ON 20
ci_022                 1.132287e-02 3 1  ON 21
ci_023                 1.111381e-02 3 1  ON 22
ci_024                 1.119517e-02 3 1  ON 23
ci_025                 1.103299e-02 3 1  ON 24
ci_026                 1.177566e-02 3 1  ON 25
ci_027                 1.195179e-02 3 1  ON 26
ci_028                -1.385406e-02 3 1  ON 27
ci_029                -1.392346e-02 3 1  ON 28
ci_030                -1.095717e-02 3 1  ON 29
ci_031                -1.106366e-02 3 1  ON 30
ci_032                -1.396961e-02 3 1  ON 31
ci_033                 1.013244e-02 3 1  ON 32
ci_034                 1.006480e-02 3 1  ON 33
ci_035                -4.650938e-03 3 1  ON 34
ci_036                -1.122083e-02 3 1  ON 35
ci_037                -1.088947e-02 3 1  ON 36
ci_038                 1.014302e-03 3 1  ON 37
ci_039                 1.115377e-03 3 1  ON 38
ci_040                -4.061697e-03 3 1  ON 39
ci_041                 9.424932e-03 3 1  ON 40
ci_042                 9.940442e-03 3 1  ON 41
ci_043                -3.344865e-03 3 1  ON 42
ci_044                -1.564294e-02 3 1  ON 43
ci_045                -1.580139e-03 3 1  ON 44
ci_046                 5.382947e-03 3 1  ON 45
ci_047                 5.557125e-03 3 1  ON 46
ci_048                -1.195710e-02 3 1  ON 47
ci_049                -1.226224e-02 3 1  ON 48
ci_050                 7.597765e-03 3 1  ON 49
ci_051                 7.450595e-03 3 1  ON 50
ci_052                -7.219503e-03 3 1  ON 51
ci_053                -6.600186e-03 3 1  ON 52
ci_054                -2.083623e-03 3 1  ON 53
ci_055                -2.089606e-03 3 1  ON 54
ci_056                 4.470800e-03 3 1  ON 55
ci_057                 4.725735e-03 3 1  ON 56
ci_058                -6.593784e-03 3 1  ON 57
ci_059                -6.947238e-03 3 1  ON 58
ci_060                 8.732981e-03 3 1  ON 59
ci_061                 9.015015e-03 3 1  ON 60
ci_062                -2.996542e-03 3 1  ON 61
ci_063                -3.005907e-03 3 1  ON 62
ci_064                -3.264017e-03 3 1  ON 63
ci_065                -4.297288e-03 3 1  ON 64
ci_066                 5.806330e-03 3 1  ON 65
ci_067                 5.907626e-03 3 1  ON 66
ci_068                -5.173639e-03 3 1  ON 67
ci_069                -5.254349e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.145803
====================================================
  Execution time = 1.4307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1562e-01
  Total weights = 1.956795344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301964367637
                                         uncertainty =       0.002246456483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301964367637
                                         uncertainty =       0.002246456483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388582193
  error estimate for blocks of size 2^( 2) =       0.000398913416
  error estimate for blocks of size 2^( 3) =       0.000407760318
  error estimate for blocks of size 2^( 4) =       0.000413742038
  error estimate for blocks of size 2^( 5) =       0.000416971035
  error estimate for blocks of size 2^( 6) =       0.000419577259
  error estimate for blocks of size 2^( 7) =       0.000421206738

      target function =                  N/A
              le_mean =     -17.216073515136
             les_mean =     296.708809428609
             stat err =       0.000417874267
             autocorr =       1.156446284240
              std dev =       0.549538208140
             le_variance =       0.301992242206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721607351514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216073515194       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216073789708       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216073787423       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216073788627       residual = 2.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 5.124940e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216073515194       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216073585134       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216073584816       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216073585115       residual = 2.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 1.313880e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216073515194       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216073532763       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216073532700       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216073532775       residual = 2.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 3.305765e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6789e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.001623e-02 3 1  ON 0
ci_002                -3.020696e-02 3 1  ON 1
ci_003                -2.554912e-02 3 1  ON 2
ci_004                 2.096086e-02 3 1  ON 3
ci_005                 2.153486e-02 3 1  ON 4
ci_006                -1.910609e-02 3 1  ON 5
ci_007                -1.935207e-02 3 1  ON 6
ci_008                -1.793919e-02 3 1  ON 7
ci_009                -1.859734e-02 3 1  ON 8
ci_010                -1.704775e-02 3 1  ON 9
ci_011                -1.666131e-02 3 1  ON 10
ci_012                -1.556497e-02 3 1  ON 11
ci_013                -1.921180e-02 3 1  ON 12
ci_014                 1.360940e-02 3 1  ON 13
ci_015                 1.417440e-02 3 1  ON 14
ci_016                 1.667677e-02 3 1  ON 15
ci_017                 1.613956e-02 3 1  ON 16
ci_018                 1.236919e-02 3 1  ON 17
ci_019                 1.313355e-02 3 1  ON 18
ci_020                 1.334507e-02 3 1  ON 19
ci_021                 1.297851e-02 3 1  ON 20
ci_022                 1.132753e-02 3 1  ON 21
ci_023                 1.111795e-02 3 1  ON 22
ci_024                 1.120004e-02 3 1  ON 23
ci_025                 1.103412e-02 3 1  ON 24
ci_026                 1.177097e-02 3 1  ON 25
ci_027                 1.195512e-02 3 1  ON 26
ci_028                -1.385732e-02 3 1  ON 27
ci_029                -1.392297e-02 3 1  ON 28
ci_030                -1.095634e-02 3 1  ON 29
ci_031                -1.106676e-02 3 1  ON 30
ci_032                -1.396785e-02 3 1  ON 31
ci_033                 1.012997e-02 3 1  ON 32
ci_034                 1.006507e-02 3 1  ON 33
ci_035                -4.652897e-03 3 1  ON 34
ci_036                -1.121469e-02 3 1  ON 35
ci_037                -1.088962e-02 3 1  ON 36
ci_038                 1.016137e-03 3 1  ON 37
ci_039                 1.119346e-03 3 1  ON 38
ci_040                -4.058334e-03 3 1  ON 39
ci_041                 9.433729e-03 3 1  ON 40
ci_042                 9.942774e-03 3 1  ON 41
ci_043                -3.343058e-03 3 1  ON 42
ci_044                -1.564779e-02 3 1  ON 43
ci_045                -1.579665e-03 3 1  ON 44
ci_046                 5.379494e-03 3 1  ON 45
ci_047                 5.556935e-03 3 1  ON 46
ci_048                -1.195762e-02 3 1  ON 47
ci_049                -1.226228e-02 3 1  ON 48
ci_050                 7.596296e-03 3 1  ON 49
ci_051                 7.459994e-03 3 1  ON 50
ci_052                -7.218000e-03 3 1  ON 51
ci_053                -6.603015e-03 3 1  ON 52
ci_054                -2.083629e-03 3 1  ON 53
ci_055                -2.090410e-03 3 1  ON 54
ci_056                 4.483939e-03 3 1  ON 55
ci_057                 4.723072e-03 3 1  ON 56
ci_058                -6.593644e-03 3 1  ON 57
ci_059                -6.951546e-03 3 1  ON 58
ci_060                 8.728554e-03 3 1  ON 59
ci_061                 9.012911e-03 3 1  ON 60
ci_062                -2.997227e-03 3 1  ON 61
ci_063                -3.002815e-03 3 1  ON 62
ci_064                -3.259761e-03 3 1  ON 63
ci_065                -4.294833e-03 3 1  ON 64
ci_066                 5.806595e-03 3 1  ON 65
ci_067                 5.905109e-03 3 1  ON 66
ci_068                -5.171870e-03 3 1  ON 67
ci_069                -5.254400e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.172349
====================================================
  Execution time = 1.3935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2323e-01
  Total weights = 1.9569e+06
  Execution time = 1.8271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303924807812
                                         uncertainty =       0.002400186098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303924807812
                                         uncertainty =       0.002400186098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389923342
  error estimate for blocks of size 2^( 2) =       0.000399612041
  error estimate for blocks of size 2^( 3) =       0.000408095651
  error estimate for blocks of size 2^( 4) =       0.000414265969
  error estimate for blocks of size 2^( 5) =       0.000418139216
  error estimate for blocks of size 2^( 6) =       0.000419910627
  error estimate for blocks of size 2^( 7) =       0.000422564660

      target function =                  N/A
              le_mean =     -17.216507928760
             les_mean =     296.731299730163
             stat err =       0.000418720118
             autocorr =       1.153158984797
              std dev =       0.551434878459
             le_variance =       0.304080425181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303945874593
                                         uncertainty =       0.002400542614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303945874593
                                         uncertainty =       0.002400542614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389937100
  error estimate for blocks of size 2^( 2) =       0.000399625437
  error estimate for blocks of size 2^( 3) =       0.000408108118
  error estimate for blocks of size 2^( 4) =       0.000414277986
  error estimate for blocks of size 2^( 5) =       0.000418151008
  error estimate for blocks of size 2^( 6) =       0.000419922432
  error estimate for blocks of size 2^( 7) =       0.000422574813

      target function =                  N/A
              le_mean =     -17.216508199334
             les_mean =     296.731848059088
             stat err =       0.000418731560
             autocorr =       1.153140631747
              std dev =       0.551454334810
             le_variance =       0.304101883381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935462469
                                         uncertainty =       0.002400368796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303935462469
                                         uncertainty =       0.002400368796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389930301
  error estimate for blocks of size 2^( 2) =       0.000399618821
  error estimate for blocks of size 2^( 3) =       0.000408101962
  error estimate for blocks of size 2^( 4) =       0.000414272061
  error estimate for blocks of size 2^( 5) =       0.000418145195
  error estimate for blocks of size 2^( 6) =       0.000419916611
  error estimate for blocks of size 2^( 7) =       0.000422569811

      target function =                  N/A
              le_mean =     -17.216508055562
             les_mean =     296.731529292301
             stat err =       0.000418725920
             autocorr =       1.153149780466
              std dev =       0.551444719938
             le_variance =       0.304091279148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303926135544
                                         uncertainty =       0.002400208946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303926135544
                                         uncertainty =       0.002400208946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389924209
  error estimate for blocks of size 2^( 2) =       0.000399612886
  error estimate for blocks of size 2^( 3) =       0.000408096437
  error estimate for blocks of size 2^( 4) =       0.000414266728
  error estimate for blocks of size 2^( 5) =       0.000418139960
  error estimate for blocks of size 2^( 6) =       0.000419911371
  error estimate for blocks of size 2^( 7) =       0.000422565296

      target function =                  N/A
              le_mean =     -17.216507942402
             les_mean =     296.731316113809
             stat err =       0.000418720839
             autocorr =       1.153157824471
              std dev =       0.551436105041
             le_variance =       0.304081777943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216507928760        initial
     9.7656e+00     9.7656e+01             5.1249e-05       -17.216508199334  <--
     3.9062e+01     3.9062e+02             1.3139e-05       -17.216508055562
     1.5625e+02     1.5625e+03             3.3058e-06       -17.216507942402

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.3178e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.002756e-02 3 1  ON 0
ci_002                -3.019886e-02 3 1  ON 1
ci_003                -2.555858e-02 3 1  ON 2
ci_004                 2.095703e-02 3 1  ON 3
ci_005                 2.152031e-02 3 1  ON 4
ci_006                -1.911176e-02 3 1  ON 5
ci_007                -1.934819e-02 3 1  ON 6
ci_008                -1.794750e-02 3 1  ON 7
ci_009                -1.857875e-02 3 1  ON 8
ci_010                -1.703965e-02 3 1  ON 9
ci_011                -1.663187e-02 3 1  ON 10
ci_012                -1.558035e-02 3 1  ON 11
ci_013                -1.920988e-02 3 1  ON 12
ci_014                 1.361241e-02 3 1  ON 13
ci_015                 1.416980e-02 3 1  ON 14
ci_016                 1.667324e-02 3 1  ON 15
ci_017                 1.613501e-02 3 1  ON 16
ci_018                 1.237791e-02 3 1  ON 17
ci_019                 1.313552e-02 3 1  ON 18
ci_020                 1.334809e-02 3 1  ON 19
ci_021                 1.299342e-02 3 1  ON 20
ci_022                 1.134119e-02 3 1  ON 21
ci_023                 1.113005e-02 3 1  ON 22
ci_024                 1.121444e-02 3 1  ON 23
ci_025                 1.103747e-02 3 1  ON 24
ci_026                 1.175719e-02 3 1  ON 25
ci_027                 1.196484e-02 3 1  ON 26
ci_028                -1.386689e-02 3 1  ON 27
ci_029                -1.392150e-02 3 1  ON 28
ci_030                -1.095390e-02 3 1  ON 29
ci_031                -1.107586e-02 3 1  ON 30
ci_032                -1.396269e-02 3 1  ON 31
ci_033                 1.012269e-02 3 1  ON 32
ci_034                 1.006588e-02 3 1  ON 33
ci_035                -4.658545e-03 3 1  ON 34
ci_036                -1.119665e-02 3 1  ON 35
ci_037                -1.089007e-02 3 1  ON 36
ci_038                 1.021430e-03 3 1  ON 37
ci_039                 1.130790e-03 3 1  ON 38
ci_040                -4.048669e-03 3 1  ON 39
ci_041                 9.459462e-03 3 1  ON 40
ci_042                 9.949584e-03 3 1  ON 41
ci_043                -3.337834e-03 3 1  ON 42
ci_044                -1.566215e-02 3 1  ON 43
ci_045                -1.578302e-03 3 1  ON 44
ci_046                 5.369407e-03 3 1  ON 45
ci_047                 5.556382e-03 3 1  ON 46
ci_048                -1.195917e-02 3 1  ON 47
ci_049                -1.226238e-02 3 1  ON 48
ci_050                 7.592022e-03 3 1  ON 49
ci_051                 7.487255e-03 3 1  ON 50
ci_052                -7.213621e-03 3 1  ON 51
ci_053                -6.611237e-03 3 1  ON 52
ci_054                -2.083656e-03 3 1  ON 53
ci_055                -2.092760e-03 3 1  ON 54
ci_056                 4.522050e-03 3 1  ON 55
ci_057                 4.715339e-03 3 1  ON 56
ci_058                -6.593228e-03 3 1  ON 57
ci_059                -6.964104e-03 3 1  ON 58
ci_060                 8.715562e-03 3 1  ON 59
ci_061                 9.006725e-03 3 1  ON 60
ci_062                -2.999219e-03 3 1  ON 61
ci_063                -2.993796e-03 3 1  ON 62
ci_064                -3.247644e-03 3 1  ON 63
ci_065                -4.287822e-03 3 1  ON 64
ci_066                 5.807359e-03 3 1  ON 65
ci_067                 5.897810e-03 3 1  ON 66
ci_068                -5.166657e-03 3 1  ON 67
ci_069                -5.254558e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.208
    reference variance = 0.257753
====================================================
  Execution time = 1.4409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1541e-01
  Total weights = 1.956870936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301410151463
                                         uncertainty =       0.002169844797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301410151463
                                         uncertainty =       0.002169844797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388176118
  error estimate for blocks of size 2^( 2) =       0.000397963855
  error estimate for blocks of size 2^( 3) =       0.000406479520
  error estimate for blocks of size 2^( 4) =       0.000412831470
  error estimate for blocks of size 2^( 5) =       0.000416224955
  error estimate for blocks of size 2^( 6) =       0.000418711584
  error estimate for blocks of size 2^( 7) =       0.000419368156

      target function =                  N/A
              le_mean =     -17.216827779039
             les_mean =     296.734572615556
             stat err =       0.000416784041
             autocorr =       1.152828057297
              std dev =       0.548963930875
             le_variance =       0.301361397402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682777904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827779111       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216829663317       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216829676455       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216829690863       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.341505e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827779111       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216828286371       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216828291612       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216828297069       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.620702e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216827779111       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216827908411       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216827909881       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216827911396       residual = 3.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 9.235577e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6948e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.003181e-02 3 1  ON 0
ci_002                -3.020630e-02 3 1  ON 1
ci_003                -2.556322e-02 3 1  ON 2
ci_004                 2.095518e-02 3 1  ON 3
ci_005                 2.150638e-02 3 1  ON 4
ci_006                -1.908886e-02 3 1  ON 5
ci_007                -1.934475e-02 3 1  ON 6
ci_008                -1.795402e-02 3 1  ON 7
ci_009                -1.855153e-02 3 1  ON 8
ci_010                -1.702951e-02 3 1  ON 9
ci_011                -1.662975e-02 3 1  ON 10
ci_012                -1.558564e-02 3 1  ON 11
ci_013                -1.921064e-02 3 1  ON 12
ci_014                 1.364828e-02 3 1  ON 13
ci_015                 1.413693e-02 3 1  ON 14
ci_016                 1.667056e-02 3 1  ON 15
ci_017                 1.615034e-02 3 1  ON 16
ci_018                 1.239409e-02 3 1  ON 17
ci_019                 1.313746e-02 3 1  ON 18
ci_020                 1.331945e-02 3 1  ON 19
ci_021                 1.299428e-02 3 1  ON 20
ci_022                 1.137739e-02 3 1  ON 21
ci_023                 1.114054e-02 3 1  ON 22
ci_024                 1.122188e-02 3 1  ON 23
ci_025                 1.104332e-02 3 1  ON 24
ci_026                 1.176004e-02 3 1  ON 25
ci_027                 1.196307e-02 3 1  ON 26
ci_028                -1.387036e-02 3 1  ON 27
ci_029                -1.394288e-02 3 1  ON 28
ci_030                -1.094736e-02 3 1  ON 29
ci_031                -1.108654e-02 3 1  ON 30
ci_032                -1.393664e-02 3 1  ON 31
ci_033                 1.012263e-02 3 1  ON 32
ci_034                 1.008242e-02 3 1  ON 33
ci_035                -4.654148e-03 3 1  ON 34
ci_036                -1.119105e-02 3 1  ON 35
ci_037                -1.087702e-02 3 1  ON 36
ci_038                 1.033790e-03 3 1  ON 37
ci_039                 1.121221e-03 3 1  ON 38
ci_040                -4.047722e-03 3 1  ON 39
ci_041                 9.487844e-03 3 1  ON 40
ci_042                 9.949580e-03 3 1  ON 41
ci_043                -3.315476e-03 3 1  ON 42
ci_044                -1.564298e-02 3 1  ON 43
ci_045                -1.588746e-03 3 1  ON 44
ci_046                 5.378406e-03 3 1  ON 45
ci_047                 5.549072e-03 3 1  ON 46
ci_048                -1.195689e-02 3 1  ON 47
ci_049                -1.226558e-02 3 1  ON 48
ci_050                 7.600911e-03 3 1  ON 49
ci_051                 7.501722e-03 3 1  ON 50
ci_052                -7.210341e-03 3 1  ON 51
ci_053                -6.645172e-03 3 1  ON 52
ci_054                -2.080966e-03 3 1  ON 53
ci_055                -2.098565e-03 3 1  ON 54
ci_056                 4.526436e-03 3 1  ON 55
ci_057                 4.719562e-03 3 1  ON 56
ci_058                -6.613774e-03 3 1  ON 57
ci_059                -6.957092e-03 3 1  ON 58
ci_060                 8.717404e-03 3 1  ON 59
ci_061                 8.988652e-03 3 1  ON 60
ci_062                -2.999033e-03 3 1  ON 61
ci_063                -2.997622e-03 3 1  ON 62
ci_064                -3.267618e-03 3 1  ON 63
ci_065                -4.292625e-03 3 1  ON 64
ci_066                 5.806221e-03 3 1  ON 65
ci_067                 5.895910e-03 3 1  ON 66
ci_068                -5.172544e-03 3 1  ON 67
ci_069                -5.253644e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2752
    reference variance = 0.385821
====================================================
  Execution time = 1.3950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1271e-01
  Total weights = 1.9567e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283893429
                                         uncertainty =       0.001927745862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283893429
                                         uncertainty =       0.001927745862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385558680
  error estimate for blocks of size 2^( 2) =       0.000395376327
  error estimate for blocks of size 2^( 3) =       0.000404279621
  error estimate for blocks of size 2^( 4) =       0.000410914605
  error estimate for blocks of size 2^( 5) =       0.000414656094
  error estimate for blocks of size 2^( 6) =       0.000417588947
  error estimate for blocks of size 2^( 7) =       0.000420010461

      target function =                  N/A
              le_mean =     -17.216474859344
             les_mean =     296.719713807524
             stat err =       0.000415792527
             autocorr =       1.162980381941
              std dev =       0.545262314412
             le_variance =       0.297310991518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297369915902
                                         uncertainty =       0.001929952420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297369915902
                                         uncertainty =       0.001929952420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385614516
  error estimate for blocks of size 2^( 2) =       0.000395427271
  error estimate for blocks of size 2^( 3) =       0.000404325241
  error estimate for blocks of size 2^( 4) =       0.000410958139
  error estimate for blocks of size 2^( 5) =       0.000414697271
  error estimate for blocks of size 2^( 6) =       0.000417633585
  error estimate for blocks of size 2^( 7) =       0.000420048798

      target function =                  N/A
              le_mean =     -17.216476496548
             les_mean =     296.721415855631
             stat err =       0.000415834448
             autocorr =       1.162878066605
              std dev =       0.545341279081
             le_variance =       0.297397110669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329966634
                                         uncertainty =       0.001928904893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329966634
                                         uncertainty =       0.001928904893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385588587
  error estimate for blocks of size 2^( 2) =       0.000395403556
  error estimate for blocks of size 2^( 3) =       0.000404303893
  error estimate for blocks of size 2^( 4) =       0.000410937720
  error estimate for blocks of size 2^( 5) =       0.000414677952
  error estimate for blocks of size 2^( 6) =       0.000417612932
  error estimate for blocks of size 2^( 7) =       0.000420031203

      target function =                  N/A
              le_mean =     -17.216475581833
             les_mean =     296.719776114993
             stat err =       0.000415814952
             autocorr =       1.162925412851
              std dev =       0.545304609639
             le_variance =       0.297357117294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297289648330
                                         uncertainty =       0.001927888253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297289648330
                                         uncertainty =       0.001927888253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385562416
  error estimate for blocks of size 2^( 2) =       0.000395379720
  error estimate for blocks of size 2^( 3) =       0.000404282634
  error estimate for blocks of size 2^( 4) =       0.000410917470
  error estimate for blocks of size 2^( 5) =       0.000414658797
  error estimate for blocks of size 2^( 6) =       0.000417591920
  error estimate for blocks of size 2^( 7) =       0.000420013029

      target function =                  N/A
              le_mean =     -17.216474936644
             les_mean =     296.719714404871
             stat err =       0.000415795304
             autocorr =       1.162973380537
              std dev =       0.545267597703
             le_variance =       0.297316753105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216474859344        initial
     2.4414e+00     2.4414e+01             1.3415e-04       -17.216476496548  <--
     9.7656e+00     9.7656e+01             3.6207e-05       -17.216475581833
     3.9062e+01     3.9062e+02             9.2356e-06       -17.216474936644

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.3205e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.004448e-02 3 1  ON 0
ci_002                -3.022637e-02 3 1  ON 1
ci_003                -2.557676e-02 3 1  ON 2
ci_004                 2.094966e-02 3 1  ON 3
ci_005                 2.146762e-02 3 1  ON 4
ci_006                -1.902499e-02 3 1  ON 5
ci_007                -1.933504e-02 3 1  ON 6
ci_008                -1.797141e-02 3 1  ON 7
ci_009                -1.847864e-02 3 1  ON 8
ci_010                -1.700155e-02 3 1  ON 9
ci_011                -1.662372e-02 3 1  ON 10
ci_012                -1.560021e-02 3 1  ON 11
ci_013                -1.921289e-02 3 1  ON 12
ci_014                 1.374584e-02 3 1  ON 13
ci_015                 1.404652e-02 3 1  ON 14
ci_016                 1.666358e-02 3 1  ON 15
ci_017                 1.619242e-02 3 1  ON 16
ci_018                 1.243786e-02 3 1  ON 17
ci_019                 1.314243e-02 3 1  ON 18
ci_020                 1.323952e-02 3 1  ON 19
ci_021                 1.299610e-02 3 1  ON 20
ci_022                 1.147534e-02 3 1  ON 21
ci_023                 1.116923e-02 3 1  ON 22
ci_024                 1.124301e-02 3 1  ON 23
ci_025                 1.105984e-02 3 1  ON 24
ci_026                 1.176758e-02 3 1  ON 25
ci_027                 1.195827e-02 3 1  ON 26
ci_028                -1.388023e-02 3 1  ON 27
ci_029                -1.400256e-02 3 1  ON 28
ci_030                -1.092914e-02 3 1  ON 29
ci_031                -1.111570e-02 3 1  ON 30
ci_032                -1.386665e-02 3 1  ON 31
ci_033                 1.012240e-02 3 1  ON 32
ci_034                 1.012744e-02 3 1  ON 33
ci_035                -4.642732e-03 3 1  ON 34
ci_036                -1.117524e-02 3 1  ON 35
ci_037                -1.084114e-02 3 1  ON 36
ci_038                 1.065765e-03 3 1  ON 37
ci_039                 1.096616e-03 3 1  ON 38
ci_040                -4.045117e-03 3 1  ON 39
ci_041                 9.564831e-03 3 1  ON 40
ci_042                 9.949413e-03 3 1  ON 41
ci_043                -3.257028e-03 3 1  ON 42
ci_044                -1.558936e-02 3 1  ON 43
ci_045                -1.615424e-03 3 1  ON 44
ci_046                 5.402674e-03 3 1  ON 45
ci_047                 5.529221e-03 3 1  ON 46
ci_048                -1.195084e-02 3 1  ON 47
ci_049                -1.227481e-02 3 1  ON 48
ci_050                 7.623887e-03 3 1  ON 49
ci_051                 7.539635e-03 3 1  ON 50
ci_052                -7.201579e-03 3 1  ON 51
ci_053                -6.735027e-03 3 1  ON 52
ci_054                -2.073575e-03 3 1  ON 53
ci_055                -2.114194e-03 3 1  ON 54
ci_056                 4.537968e-03 3 1  ON 55
ci_057                 4.730739e-03 3 1  ON 56
ci_058                -6.668690e-03 3 1  ON 57
ci_059                -6.937968e-03 3 1  ON 58
ci_060                 8.721962e-03 3 1  ON 59
ci_061                 8.938789e-03 3 1  ON 60
ci_062                -2.998387e-03 3 1  ON 61
ci_063                -3.007842e-03 3 1  ON 62
ci_064                -3.316974e-03 3 1  ON 63
ci_065                -4.304892e-03 3 1  ON 64
ci_066                 5.803322e-03 3 1  ON 65
ci_067                 5.890908e-03 3 1  ON 66
ci_068                -5.188231e-03 3 1  ON 67
ci_069                -5.250745e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0168e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.286459
====================================================
  Execution time = 1.4294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1574e-01
  Total weights = 1.956824178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298932082943
                                         uncertainty =       0.002234979549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298932082943
                                         uncertainty =       0.002234979549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386997667
  error estimate for blocks of size 2^( 2) =       0.000396956523
  error estimate for blocks of size 2^( 3) =       0.000405482978
  error estimate for blocks of size 2^( 4) =       0.000411142500
  error estimate for blocks of size 2^( 5) =       0.000414778456
  error estimate for blocks of size 2^( 6) =       0.000417553592
  error estimate for blocks of size 2^( 7) =       0.000418829303

      target function =                  N/A
              le_mean =     -17.216473316991
             les_mean =     296.722694955041
             stat err =       0.000415575963
             autocorr =       1.153145597603
              std dev =       0.547297349238
             le_variance =       0.299534388483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647331699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216473317034       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216478320624       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216478313940       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216478225513       residual = 3.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.427910e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216473317034       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474907452       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216474813728       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.388161e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216473317034       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216473743582       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216473710707       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.708482e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6829e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.002997e-02 3 1  ON 0
ci_002                -3.026128e-02 3 1  ON 1
ci_003                -2.557242e-02 3 1  ON 2
ci_004                 2.093956e-02 3 1  ON 3
ci_005                 2.143205e-02 3 1  ON 4
ci_006                -1.899074e-02 3 1  ON 5
ci_007                -1.937691e-02 3 1  ON 6
ci_008                -1.791154e-02 3 1  ON 7
ci_009                -1.843897e-02 3 1  ON 8
ci_010                -1.699779e-02 3 1  ON 9
ci_011                -1.660041e-02 3 1  ON 10
ci_012                -1.573903e-02 3 1  ON 11
ci_013                -1.918563e-02 3 1  ON 12
ci_014                 1.377451e-02 3 1  ON 13
ci_015                 1.391620e-02 3 1  ON 14
ci_016                 1.659752e-02 3 1  ON 15
ci_017                 1.622991e-02 3 1  ON 16
ci_018                 1.247751e-02 3 1  ON 17
ci_019                 1.322705e-02 3 1  ON 18
ci_020                 1.320239e-02 3 1  ON 19
ci_021                 1.307217e-02 3 1  ON 20
ci_022                 1.153261e-02 3 1  ON 21
ci_023                 1.115387e-02 3 1  ON 22
ci_024                 1.128865e-02 3 1  ON 23
ci_025                 1.106863e-02 3 1  ON 24
ci_026                 1.178465e-02 3 1  ON 25
ci_027                 1.184936e-02 3 1  ON 26
ci_028                -1.387163e-02 3 1  ON 27
ci_029                -1.406778e-02 3 1  ON 28
ci_030                -1.100445e-02 3 1  ON 29
ci_031                -1.104948e-02 3 1  ON 30
ci_032                -1.379123e-02 3 1  ON 31
ci_033                 1.018366e-02 3 1  ON 32
ci_034                 1.005984e-02 3 1  ON 33
ci_035                -4.634319e-03 3 1  ON 34
ci_036                -1.116997e-02 3 1  ON 35
ci_037                -1.085514e-02 3 1  ON 36
ci_038                 1.072785e-03 3 1  ON 37
ci_039                 1.121525e-03 3 1  ON 38
ci_040                -3.986428e-03 3 1  ON 39
ci_041                 9.578960e-03 3 1  ON 40
ci_042                 9.943830e-03 3 1  ON 41
ci_043                -3.259497e-03 3 1  ON 42
ci_044                -1.552800e-02 3 1  ON 43
ci_045                -1.597893e-03 3 1  ON 44
ci_046                 5.412488e-03 3 1  ON 45
ci_047                 5.514797e-03 3 1  ON 46
ci_048                -1.186471e-02 3 1  ON 47
ci_049                -1.228727e-02 3 1  ON 48
ci_050                 7.641045e-03 3 1  ON 49
ci_051                 7.465575e-03 3 1  ON 50
ci_052                -7.169852e-03 3 1  ON 51
ci_053                -6.705061e-03 3 1  ON 52
ci_054                -2.059730e-03 3 1  ON 53
ci_055                -2.165884e-03 3 1  ON 54
ci_056                 4.559614e-03 3 1  ON 55
ci_057                 4.759003e-03 3 1  ON 56
ci_058                -6.683280e-03 3 1  ON 57
ci_059                -6.901787e-03 3 1  ON 58
ci_060                 8.669013e-03 3 1  ON 59
ci_061                 8.863894e-03 3 1  ON 60
ci_062                -3.016888e-03 3 1  ON 61
ci_063                -3.014418e-03 3 1  ON 62
ci_064                -3.333030e-03 3 1  ON 63
ci_065                -4.288233e-03 3 1  ON 64
ci_066                 5.810306e-03 3 1  ON 65
ci_067                 5.874757e-03 3 1  ON 66
ci_068                -5.162791e-03 3 1  ON 67
ci_069                -5.244453e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.25033
====================================================
  Execution time = 1.3825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1917e-01
  Total weights = 1.9563e+06
  Execution time = 1.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303681879235
                                         uncertainty =       0.002499697659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303681879235
                                         uncertainty =       0.002499697659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389749250
  error estimate for blocks of size 2^( 2) =       0.000399444821
  error estimate for blocks of size 2^( 3) =       0.000408360257
  error estimate for blocks of size 2^( 4) =       0.000414527840
  error estimate for blocks of size 2^( 5) =       0.000418767407
  error estimate for blocks of size 2^( 6) =       0.000419928352
  error estimate for blocks of size 2^( 7) =       0.000420563685

      target function =                  N/A
              le_mean =     -17.217125445810
             les_mean =     296.748543087257
             stat err =       0.000418446821
             autocorr =       1.152683211645
              std dev =       0.551188675978
             le_variance =       0.303808956526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303467520044
                                         uncertainty =       0.002489672354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303467520044
                                         uncertainty =       0.002489672354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389611222
  error estimate for blocks of size 2^( 2) =       0.000399315315
  error estimate for blocks of size 2^( 3) =       0.000408234688
  error estimate for blocks of size 2^( 4) =       0.000414404978
  error estimate for blocks of size 2^( 5) =       0.000418654863
  error estimate for blocks of size 2^( 6) =       0.000419816145
  error estimate for blocks of size 2^( 7) =       0.000420451657

      target function =                  N/A
              le_mean =     -17.217129170875
             les_mean =     296.749791414948
             stat err =       0.000418331911
             autocorr =       1.152866642594
              std dev =       0.550993474616
             le_variance =       0.303593809070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303528514572
                                         uncertainty =       0.002493159688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303528514572
                                         uncertainty =       0.002493159688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389650575
  error estimate for blocks of size 2^( 2) =       0.000399351885
  error estimate for blocks of size 2^( 3) =       0.000408270133
  error estimate for blocks of size 2^( 4) =       0.000414439701
  error estimate for blocks of size 2^( 5) =       0.000418685894
  error estimate for blocks of size 2^( 6) =       0.000419846964
  error estimate for blocks of size 2^( 7) =       0.000420482370

      target function =                  N/A
              le_mean =     -17.217127073806
             les_mean =     296.748882955146
             stat err =       0.000418363732
             autocorr =       1.152809145417
              std dev =       0.551049128329
             le_variance =       0.303655141832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303659328941
                                         uncertainty =       0.002498788190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303659328941
                                         uncertainty =       0.002498788190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389734749
  error estimate for blocks of size 2^( 2) =       0.000399431117
  error estimate for blocks of size 2^( 3) =       0.000408346929
  error estimate for blocks of size 2^( 4) =       0.000414514789
  error estimate for blocks of size 2^( 5) =       0.000418755267
  error estimate for blocks of size 2^( 6) =       0.000419916227
  error estimate for blocks of size 2^( 7) =       0.000420551605

      target function =                  N/A
              le_mean =     -17.217125482767
             les_mean =     296.748578504201
             stat err =       0.000418434472
             autocorr =       1.152700955506
              std dev =       0.551168167763
             le_variance =       0.303786349155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217125445810        initial
     6.1035e-01     6.1035e+00             4.4279e-04       -17.217129170875  <--
     2.4414e+00     2.4414e+01             1.3882e-04       -17.217127073806
     9.7656e+00     9.7656e+01             3.7085e-05       -17.217125482767

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.3022e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.000166e-02 3 1  ON 0
ci_002                -3.033638e-02 3 1  ON 1
ci_003                -2.556836e-02 3 1  ON 2
ci_004                 2.091197e-02 3 1  ON 3
ci_005                 2.135527e-02 3 1  ON 4
ci_006                -1.891491e-02 3 1  ON 5
ci_007                -1.947062e-02 3 1  ON 6
ci_008                -1.779455e-02 3 1  ON 7
ci_009                -1.835811e-02 3 1  ON 8
ci_010                -1.698725e-02 3 1  ON 9
ci_011                -1.654990e-02 3 1  ON 10
ci_012                -1.604300e-02 3 1  ON 11
ci_013                -1.912026e-02 3 1  ON 12
ci_014                 1.383653e-02 3 1  ON 13
ci_015                 1.363364e-02 3 1  ON 14
ci_016                 1.644972e-02 3 1  ON 15
ci_017                 1.631164e-02 3 1  ON 16
ci_018                 1.256059e-02 3 1  ON 17
ci_019                 1.340476e-02 3 1  ON 18
ci_020                 1.311880e-02 3 1  ON 19
ci_021                 1.324484e-02 3 1  ON 20
ci_022                 1.165639e-02 3 1  ON 21
ci_023                 1.112389e-02 3 1  ON 22
ci_024                 1.139167e-02 3 1  ON 23
ci_025                 1.109421e-02 3 1  ON 24
ci_026                 1.182160e-02 3 1  ON 25
ci_027                 1.161270e-02 3 1  ON 26
ci_028                -1.385130e-02 3 1  ON 27
ci_029                -1.421314e-02 3 1  ON 28
ci_030                -1.116708e-02 3 1  ON 29
ci_031                -1.090874e-02 3 1  ON 30
ci_032                -1.363632e-02 3 1  ON 31
ci_033                 1.032133e-02 3 1  ON 32
ci_034                 9.916027e-03 3 1  ON 33
ci_035                -4.619180e-03 3 1  ON 34
ci_036                -1.115243e-02 3 1  ON 35
ci_037                -1.089022e-02 3 1  ON 36
ci_038                 1.086445e-03 3 1  ON 37
ci_039                 1.167061e-03 3 1  ON 38
ci_040                -3.881967e-03 3 1  ON 39
ci_041                 9.607322e-03 3 1  ON 40
ci_042                 9.931308e-03 3 1  ON 41
ci_043                -3.264444e-03 3 1  ON 42
ci_044                -1.538159e-02 3 1  ON 43
ci_045                -1.565390e-03 3 1  ON 44
ci_046                 5.433659e-03 3 1  ON 45
ci_047                 5.482876e-03 3 1  ON 46
ci_048                -1.166190e-02 3 1  ON 47
ci_049                -1.231800e-02 3 1  ON 48
ci_050                 7.671231e-03 3 1  ON 49
ci_051                 7.327979e-03 3 1  ON 50
ci_052                -7.106245e-03 3 1  ON 51
ci_053                -6.646072e-03 3 1  ON 52
ci_054                -2.030900e-03 3 1  ON 53
ci_055                -2.271838e-03 3 1  ON 54
ci_056                 4.600720e-03 3 1  ON 55
ci_057                 4.813603e-03 3 1  ON 56
ci_058                -6.714651e-03 3 1  ON 57
ci_059                -6.827239e-03 3 1  ON 58
ci_060                 8.554221e-03 3 1  ON 59
ci_061                 8.700546e-03 3 1  ON 60
ci_062                -3.054605e-03 3 1  ON 61
ci_063                -3.027597e-03 3 1  ON 62
ci_064                -3.361108e-03 3 1  ON 63
ci_065                -4.260665e-03 3 1  ON 64
ci_066                 5.823291e-03 3 1  ON 65
ci_067                 5.844492e-03 3 1  ON 66
ci_068                -5.105732e-03 3 1  ON 67
ci_069                -5.226741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2574
    reference variance = 0.473741
====================================================
  Execution time = 1.6447e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1287e-01
  Total weights = 1.956835159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385699505
                                         uncertainty =       0.001721608876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385699505
                                         uncertainty =       0.001721608876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386256370
  error estimate for blocks of size 2^( 2) =       0.000395854449
  error estimate for blocks of size 2^( 3) =       0.000404684992
  error estimate for blocks of size 2^( 4) =       0.000411200604
  error estimate for blocks of size 2^( 5) =       0.000415311336
  error estimate for blocks of size 2^( 6) =       0.000416624767
  error estimate for blocks of size 2^( 7) =       0.000415186076

      target function =                  N/A
              le_mean =     -17.216471228526
             les_mean =     296.719752806493
             stat err =       0.000414580696
             autocorr =       1.152038102509
              std dev =       0.546248997070
             le_variance =       0.298387966800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647122853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471228611       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216472578218       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216472868031       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216472563825       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.130623e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471228611       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471839256       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471709314       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471673651       residual = 2.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.601514e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471228611       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471420027       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471331049       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471319100       residual = 2.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.363614e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8964e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.037767e-02 3 1  ON 0
ci_002                -3.031928e-02 3 1  ON 1
ci_003                -2.539249e-02 3 1  ON 2
ci_004                 2.088311e-02 3 1  ON 3
ci_005                 2.110770e-02 3 1  ON 4
ci_006                -1.915170e-02 3 1  ON 5
ci_007                -1.942123e-02 3 1  ON 6
ci_008                -1.793968e-02 3 1  ON 7
ci_009                -1.830442e-02 3 1  ON 8
ci_010                -1.708826e-02 3 1  ON 9
ci_011                -1.636422e-02 3 1  ON 10
ci_012                -1.592266e-02 3 1  ON 11
ci_013                -1.958041e-02 3 1  ON 12
ci_014                 1.379212e-02 3 1  ON 13
ci_015                 1.379934e-02 3 1  ON 14
ci_016                 1.668002e-02 3 1  ON 15
ci_017                 1.640775e-02 3 1  ON 16
ci_018                 1.274396e-02 3 1  ON 17
ci_019                 1.332731e-02 3 1  ON 18
ci_020                 1.307211e-02 3 1  ON 19
ci_021                 1.337482e-02 3 1  ON 20
ci_022                 1.156519e-02 3 1  ON 21
ci_023                 1.132587e-02 3 1  ON 22
ci_024                 1.147589e-02 3 1  ON 23
ci_025                 1.100050e-02 3 1  ON 24
ci_026                 1.162934e-02 3 1  ON 25
ci_027                 1.168817e-02 3 1  ON 26
ci_028                -1.401851e-02 3 1  ON 27
ci_029                -1.440688e-02 3 1  ON 28
ci_030                -1.096749e-02 3 1  ON 29
ci_031                -1.085618e-02 3 1  ON 30
ci_032                -1.344891e-02 3 1  ON 31
ci_033                 1.024929e-02 3 1  ON 32
ci_034                 9.786650e-03 3 1  ON 33
ci_035                -4.653699e-03 3 1  ON 34
ci_036                -1.095356e-02 3 1  ON 35
ci_037                -1.089233e-02 3 1  ON 36
ci_038                 1.149497e-03 3 1  ON 37
ci_039                 1.230479e-03 3 1  ON 38
ci_040                -3.938549e-03 3 1  ON 39
ci_041                 9.699557e-03 3 1  ON 40
ci_042                 1.004800e-02 3 1  ON 41
ci_043                -3.340106e-03 3 1  ON 42
ci_044                -1.537499e-02 3 1  ON 43
ci_045                -1.531717e-03 3 1  ON 44
ci_046                 5.234530e-03 3 1  ON 45
ci_047                 5.243837e-03 3 1  ON 46
ci_048                -1.173005e-02 3 1  ON 47
ci_049                -1.216789e-02 3 1  ON 48
ci_050                 7.526533e-03 3 1  ON 49
ci_051                 7.299551e-03 3 1  ON 50
ci_052                -7.148345e-03 3 1  ON 51
ci_053                -6.651759e-03 3 1  ON 52
ci_054                -2.191466e-03 3 1  ON 53
ci_055                -2.383296e-03 3 1  ON 54
ci_056                 4.744652e-03 3 1  ON 55
ci_057                 4.545762e-03 3 1  ON 56
ci_058                -6.642955e-03 3 1  ON 57
ci_059                -6.746943e-03 3 1  ON 58
ci_060                 8.776239e-03 3 1  ON 59
ci_061                 8.921335e-03 3 1  ON 60
ci_062                -2.918583e-03 3 1  ON 61
ci_063                -2.917939e-03 3 1  ON 62
ci_064                -3.267066e-03 3 1  ON 63
ci_065                -4.322571e-03 3 1  ON 64
ci_066                 5.927440e-03 3 1  ON 65
ci_067                 5.914611e-03 3 1  ON 66
ci_068                -5.083450e-03 3 1  ON 67
ci_069                -5.447244e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1867
    reference variance = 0.1801
====================================================
  Execution time = 1.3814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1952e-01
  Total weights = 1.9568e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302297623642
                                         uncertainty =       0.002459833939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302297623642
                                         uncertainty =       0.002459833939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388725111
  error estimate for blocks of size 2^( 2) =       0.000398573981
  error estimate for blocks of size 2^( 3) =       0.000407624563
  error estimate for blocks of size 2^( 4) =       0.000412869043
  error estimate for blocks of size 2^( 5) =       0.000417135730
  error estimate for blocks of size 2^( 6) =       0.000420706508
  error estimate for blocks of size 2^( 7) =       0.000421421390

      target function =                  N/A
              le_mean =     -17.216411407084
             les_mean =     296.724229372709
             stat err =       0.000418033167
             autocorr =       1.156475105566
              std dev =       0.549740324333
             le_variance =       0.302214424198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302751913927
                                         uncertainty =       0.002517822868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302751913927
                                         uncertainty =       0.002517822868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389017909
  error estimate for blocks of size 2^( 2) =       0.000398855843
  error estimate for blocks of size 2^( 3) =       0.000407894960
  error estimate for blocks of size 2^( 4) =       0.000413132926
  error estimate for blocks of size 2^( 5) =       0.000417394225
  error estimate for blocks of size 2^( 6) =       0.000420992167
  error estimate for blocks of size 2^( 7) =       0.000421761742

      target function =                  N/A
              le_mean =     -17.216393860116
             les_mean =     296.995676518091
             stat err =       0.000418320265
             autocorr =       1.156321542538
              std dev =       0.550154403200
             le_variance =       0.302669867361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302671055266
                                         uncertainty =       0.002520517151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302671055266
                                         uncertainty =       0.002520517151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388965969
  error estimate for blocks of size 2^( 2) =       0.000398799935
  error estimate for blocks of size 2^( 3) =       0.000407835377
  error estimate for blocks of size 2^( 4) =       0.000413053482
  error estimate for blocks of size 2^( 5) =       0.000417333448
  error estimate for blocks of size 2^( 6) =       0.000420908226
  error estimate for blocks of size 2^( 7) =       0.000421607207

      target function =                  N/A
              le_mean =     -17.216404067967
             les_mean =     296.810801532803
             stat err =       0.000418225591
             autocorr =       1.156106904342
              std dev =       0.550080948212
             le_variance =       0.302589049586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302337187691
                                         uncertainty =       0.002469108647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302337187691
                                         uncertainty =       0.002469108647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388750686
  error estimate for blocks of size 2^( 2) =       0.000398597439
  error estimate for blocks of size 2^( 3) =       0.000407645863
  error estimate for blocks of size 2^( 4) =       0.000412886950
  error estimate for blocks of size 2^( 5) =       0.000417154368
  error estimate for blocks of size 2^( 6) =       0.000420728381
  error estimate for blocks of size 2^( 7) =       0.000421444867

      target function =                  N/A
              le_mean =     -17.216407478520
             les_mean =     296.723942724320
             stat err =       0.000418053641
             autocorr =       1.156436219123
              std dev =       0.549776492155
             le_variance =       0.302254191326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216411407084        initial  <--
     1.5259e-01     1.5259e+00             1.1306e-03       -17.216393860116
     6.1035e-01     6.1035e+00             4.6015e-04       -17.216404067967
     2.4414e+00     2.4414e+01             1.3636e-04       -17.216407478520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1530
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.000166e-02 3 1  ON 0
ci_002                -3.033638e-02 3 1  ON 1
ci_003                -2.556836e-02 3 1  ON 2
ci_004                 2.091197e-02 3 1  ON 3
ci_005                 2.135527e-02 3 1  ON 4
ci_006                -1.891491e-02 3 1  ON 5
ci_007                -1.947062e-02 3 1  ON 6
ci_008                -1.779455e-02 3 1  ON 7
ci_009                -1.835811e-02 3 1  ON 8
ci_010                -1.698725e-02 3 1  ON 9
ci_011                -1.654990e-02 3 1  ON 10
ci_012                -1.604300e-02 3 1  ON 11
ci_013                -1.912026e-02 3 1  ON 12
ci_014                 1.383653e-02 3 1  ON 13
ci_015                 1.363364e-02 3 1  ON 14
ci_016                 1.644972e-02 3 1  ON 15
ci_017                 1.631164e-02 3 1  ON 16
ci_018                 1.256059e-02 3 1  ON 17
ci_019                 1.340476e-02 3 1  ON 18
ci_020                 1.311880e-02 3 1  ON 19
ci_021                 1.324484e-02 3 1  ON 20
ci_022                 1.165639e-02 3 1  ON 21
ci_023                 1.112389e-02 3 1  ON 22
ci_024                 1.139167e-02 3 1  ON 23
ci_025                 1.109421e-02 3 1  ON 24
ci_026                 1.182160e-02 3 1  ON 25
ci_027                 1.161270e-02 3 1  ON 26
ci_028                -1.385130e-02 3 1  ON 27
ci_029                -1.421314e-02 3 1  ON 28
ci_030                -1.116708e-02 3 1  ON 29
ci_031                -1.090874e-02 3 1  ON 30
ci_032                -1.363632e-02 3 1  ON 31
ci_033                 1.032133e-02 3 1  ON 32
ci_034                 9.916027e-03 3 1  ON 33
ci_035                -4.619180e-03 3 1  ON 34
ci_036                -1.115243e-02 3 1  ON 35
ci_037                -1.089022e-02 3 1  ON 36
ci_038                 1.086445e-03 3 1  ON 37
ci_039                 1.167061e-03 3 1  ON 38
ci_040                -3.881967e-03 3 1  ON 39
ci_041                 9.607322e-03 3 1  ON 40
ci_042                 9.931308e-03 3 1  ON 41
ci_043                -3.264444e-03 3 1  ON 42
ci_044                -1.538159e-02 3 1  ON 43
ci_045                -1.565390e-03 3 1  ON 44
ci_046                 5.433659e-03 3 1  ON 45
ci_047                 5.482876e-03 3 1  ON 46
ci_048                -1.166190e-02 3 1  ON 47
ci_049                -1.231800e-02 3 1  ON 48
ci_050                 7.671231e-03 3 1  ON 49
ci_051                 7.327979e-03 3 1  ON 50
ci_052                -7.106245e-03 3 1  ON 51
ci_053                -6.646072e-03 3 1  ON 52
ci_054                -2.030900e-03 3 1  ON 53
ci_055                -2.271838e-03 3 1  ON 54
ci_056                 4.600720e-03 3 1  ON 55
ci_057                 4.813603e-03 3 1  ON 56
ci_058                -6.714651e-03 3 1  ON 57
ci_059                -6.827239e-03 3 1  ON 58
ci_060                 8.554221e-03 3 1  ON 59
ci_061                 8.700546e-03 3 1  ON 60
ci_062                -3.054605e-03 3 1  ON 61
ci_063                -3.027597e-03 3 1  ON 62
ci_064                -3.361108e-03 3 1  ON 63
ci_065                -4.260665e-03 3 1  ON 64
ci_066                 5.823291e-03 3 1  ON 65
ci_067                 5.844492e-03 3 1  ON 66
ci_068                -5.105732e-03 3 1  ON 67
ci_069                -5.226741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.189667
====================================================
  Execution time = 1.4279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1080e-01
  Total weights = 1.956914154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296390205281
                                         uncertainty =       0.001776778202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296390205281
                                         uncertainty =       0.001776778202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384915904
  error estimate for blocks of size 2^( 2) =       0.000395244227
  error estimate for blocks of size 2^( 3) =       0.000404059950
  error estimate for blocks of size 2^( 4) =       0.000410545627
  error estimate for blocks of size 2^( 5) =       0.000413772009
  error estimate for blocks of size 2^( 6) =       0.000417099688
  error estimate for blocks of size 2^( 7) =       0.000417840688

      target function =                  N/A
              le_mean =     -17.216935891240
             les_mean =     296.733682206545
             stat err =       0.000414814503
             autocorr =       1.161384841994
              std dev =       0.544353291409
             le_variance =       0.296320505868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693589124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935891263       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216939077612       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216939048056       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.298592e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935891263       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936781249       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936766048       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936765886       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 6.295272e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935891263       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936120479       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936116125       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936115947       residual = 2.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.612065e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6817e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.002249e-02 3 1  ON 0
ci_002                -3.032922e-02 3 1  ON 1
ci_003                -2.556770e-02 3 1  ON 2
ci_004                 2.091300e-02 3 1  ON 3
ci_005                 2.134422e-02 3 1  ON 4
ci_006                -1.894057e-02 3 1  ON 5
ci_007                -1.945294e-02 3 1  ON 6
ci_008                -1.782365e-02 3 1  ON 7
ci_009                -1.832534e-02 3 1  ON 8
ci_010                -1.700103e-02 3 1  ON 9
ci_011                -1.658549e-02 3 1  ON 10
ci_012                -1.601566e-02 3 1  ON 11
ci_013                -1.912257e-02 3 1  ON 12
ci_014                 1.384590e-02 3 1  ON 13
ci_015                 1.365675e-02 3 1  ON 14
ci_016                 1.645963e-02 3 1  ON 15
ci_017                 1.632737e-02 3 1  ON 16
ci_018                 1.255866e-02 3 1  ON 17
ci_019                 1.339342e-02 3 1  ON 18
ci_020                 1.316026e-02 3 1  ON 19
ci_021                 1.326493e-02 3 1  ON 20
ci_022                 1.166982e-02 3 1  ON 21
ci_023                 1.113062e-02 3 1  ON 22
ci_024                 1.136979e-02 3 1  ON 23
ci_025                 1.107512e-02 3 1  ON 24
ci_026                 1.181094e-02 3 1  ON 25
ci_027                 1.160646e-02 3 1  ON 26
ci_028                -1.391425e-02 3 1  ON 27
ci_029                -1.422049e-02 3 1  ON 28
ci_030                -1.115792e-02 3 1  ON 29
ci_031                -1.091249e-02 3 1  ON 30
ci_032                -1.360219e-02 3 1  ON 31
ci_033                 1.031328e-02 3 1  ON 32
ci_034                 9.939593e-03 3 1  ON 33
ci_035                -4.616251e-03 3 1  ON 34
ci_036                -1.114259e-02 3 1  ON 35
ci_037                -1.087020e-02 3 1  ON 36
ci_038                 1.079882e-03 3 1  ON 37
ci_039                 1.177106e-03 3 1  ON 38
ci_040                -3.897109e-03 3 1  ON 39
ci_041                 9.630055e-03 3 1  ON 40
ci_042                 9.938335e-03 3 1  ON 41
ci_043                -3.253069e-03 3 1  ON 42
ci_044                -1.535305e-02 3 1  ON 43
ci_045                -1.557991e-03 3 1  ON 44
ci_046                 5.479475e-03 3 1  ON 45
ci_047                 5.455735e-03 3 1  ON 46
ci_048                -1.165998e-02 3 1  ON 47
ci_049                -1.233114e-02 3 1  ON 48
ci_050                 7.636360e-03 3 1  ON 49
ci_051                 7.322301e-03 3 1  ON 50
ci_052                -7.098729e-03 3 1  ON 51
ci_053                -6.652797e-03 3 1  ON 52
ci_054                -2.062923e-03 3 1  ON 53
ci_055                -2.269757e-03 3 1  ON 54
ci_056                 4.592279e-03 3 1  ON 55
ci_057                 4.790189e-03 3 1  ON 56
ci_058                -6.698797e-03 3 1  ON 57
ci_059                -6.856492e-03 3 1  ON 58
ci_060                 8.507292e-03 3 1  ON 59
ci_061                 8.690670e-03 3 1  ON 60
ci_062                -3.026991e-03 3 1  ON 61
ci_063                -3.033447e-03 3 1  ON 62
ci_064                -3.352359e-03 3 1  ON 63
ci_065                -4.225865e-03 3 1  ON 64
ci_066                 5.803589e-03 3 1  ON 65
ci_067                 5.821825e-03 3 1  ON 66
ci_068                -5.074275e-03 3 1  ON 67
ci_069                -5.217967e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.325946
====================================================
  Execution time = 1.3841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1660e-01
  Total weights = 1.9569e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777188595
                                         uncertainty =       0.002237731997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777188595
                                         uncertainty =       0.002237731997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387837540
  error estimate for blocks of size 2^( 2) =       0.000397576159
  error estimate for blocks of size 2^( 3) =       0.000406086723
  error estimate for blocks of size 2^( 4) =       0.000412497704
  error estimate for blocks of size 2^( 5) =       0.000415870399
  error estimate for blocks of size 2^( 6) =       0.000417788845
  error estimate for blocks of size 2^( 7) =       0.000419645764

      target function =                  N/A
              le_mean =     -17.216527507766
             les_mean =     296.725475971593
             stat err =       0.000416450678
             autocorr =       1.152995093837
              std dev =       0.548485109663
             le_variance =       0.300835915522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300784259343
                                         uncertainty =       0.002242416950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300784259343
                                         uncertainty =       0.002242416950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387841864
  error estimate for blocks of size 2^( 2) =       0.000397578550
  error estimate for blocks of size 2^( 3) =       0.000406088256
  error estimate for blocks of size 2^( 4) =       0.000412497060
  error estimate for blocks of size 2^( 5) =       0.000415867994
  error estimate for blocks of size 2^( 6) =       0.000417791902
  error estimate for blocks of size 2^( 7) =       0.000419641578

      target function =                  N/A
              le_mean =     -17.216527706010
             les_mean =     296.725395704126
             stat err =       0.000416449634
             autocorr =       1.152963605010
              std dev =       0.548491223887
             le_variance =       0.300842622681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300779943766
                                         uncertainty =       0.002240439238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300779943766
                                         uncertainty =       0.002240439238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387839189
  error estimate for blocks of size 2^( 2) =       0.000397576710
  error estimate for blocks of size 2^( 3) =       0.000406086837
  error estimate for blocks of size 2^( 4) =       0.000412496606
  error estimate for blocks of size 2^( 5) =       0.000415868191
  error estimate for blocks of size 2^( 6) =       0.000417789728
  error estimate for blocks of size 2^( 7) =       0.000419642768

      target function =                  N/A
              le_mean =     -17.216527436910
             les_mean =     296.725408092242
             stat err =       0.000416449323
             autocorr =       1.152977789870
              std dev =       0.548487440686
             le_variance =       0.300838472590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777242441
                                         uncertainty =       0.002238077340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777242441
                                         uncertainty =       0.002238077340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387837559
  error estimate for blocks of size 2^( 2) =       0.000397576034
  error estimate for blocks of size 2^( 3) =       0.000406086547
  error estimate for blocks of size 2^( 4) =       0.000412497368
  error estimate for blocks of size 2^( 5) =       0.000415869924
  error estimate for blocks of size 2^( 6) =       0.000417788776
  error estimate for blocks of size 2^( 7) =       0.000419645199

      target function =                  N/A
              le_mean =     -17.216527471677
             les_mean =     296.725458125842
             stat err =       0.000416450317
             autocorr =       1.152992982225
              std dev =       0.548485135692
             le_variance =       0.300835944075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216527507766        initial
     1.5259e+00     1.5259e+01             2.2986e-04       -17.216527706010  <--
     6.1035e+00     6.1035e+01             6.2953e-05       -17.216527436910
     2.4414e+01     2.4414e+02             1.6121e-05       -17.216527471677

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.3281e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.007849e-02 3 1  ON 0
ci_002                -3.030810e-02 3 1  ON 1
ci_003                -2.556627e-02 3 1  ON 2
ci_004                 2.091443e-02 3 1  ON 3
ci_005                 2.131187e-02 3 1  ON 4
ci_006                -1.900676e-02 3 1  ON 5
ci_007                -1.940422e-02 3 1  ON 6
ci_008                -1.789676e-02 3 1  ON 7
ci_009                -1.824325e-02 3 1  ON 8
ci_010                -1.703969e-02 3 1  ON 9
ci_011                -1.667773e-02 3 1  ON 10
ci_012                -1.594220e-02 3 1  ON 11
ci_013                -1.912924e-02 3 1  ON 12
ci_014                 1.386835e-02 3 1  ON 13
ci_015                 1.371569e-02 3 1  ON 14
ci_016                 1.648459e-02 3 1  ON 15
ci_017                 1.636722e-02 3 1  ON 16
ci_018                 1.255229e-02 3 1  ON 17
ci_019                 1.336350e-02 3 1  ON 18
ci_020                 1.326972e-02 3 1  ON 19
ci_021                 1.331692e-02 3 1  ON 20
ci_022                 1.170325e-02 3 1  ON 21
ci_023                 1.114790e-02 3 1  ON 22
ci_024                 1.131152e-02 3 1  ON 23
ci_025                 1.102326e-02 3 1  ON 24
ci_026                 1.178235e-02 3 1  ON 25
ci_027                 1.158911e-02 3 1  ON 26
ci_028                -1.408116e-02 3 1  ON 27
ci_029                -1.423944e-02 3 1  ON 28
ci_030                -1.113264e-02 3 1  ON 29
ci_031                -1.092103e-02 3 1  ON 30
ci_032                -1.351604e-02 3 1  ON 31
ci_033                 1.029134e-02 3 1  ON 32
ci_034                 1.000046e-02 3 1  ON 33
ci_035                -4.609195e-03 3 1  ON 34
ci_036                -1.111637e-02 3 1  ON 35
ci_037                -1.081576e-02 3 1  ON 36
ci_038                 1.063834e-03 3 1  ON 37
ci_039                 1.201031e-03 3 1  ON 38
ci_040                -3.932013e-03 3 1  ON 39
ci_041                 9.688067e-03 3 1  ON 40
ci_042                 9.955988e-03 3 1  ON 41
ci_043                -3.224725e-03 3 1  ON 42
ci_044                -1.527505e-02 3 1  ON 43
ci_045                -1.540524e-03 3 1  ON 44
ci_046                 5.597491e-03 3 1  ON 45
ci_047                 5.385958e-03 3 1  ON 46
ci_048                -1.165233e-02 3 1  ON 47
ci_049                -1.236545e-02 3 1  ON 48
ci_050                 7.551526e-03 3 1  ON 49
ci_051                 7.309885e-03 3 1  ON 50
ci_052                -7.079475e-03 3 1  ON 51
ci_053                -6.669024e-03 3 1  ON 52
ci_054                -2.143899e-03 3 1  ON 53
ci_055                -2.264277e-03 3 1  ON 54
ci_056                 4.570915e-03 3 1  ON 55
ci_057                 4.732511e-03 3 1  ON 56
ci_058                -6.658705e-03 3 1  ON 57
ci_059                -6.930347e-03 3 1  ON 58
ci_060                 8.384542e-03 3 1  ON 59
ci_061                 8.664484e-03 3 1  ON 60
ci_062                -2.958327e-03 3 1  ON 61
ci_063                -3.047836e-03 3 1  ON 62
ci_064                -3.333320e-03 3 1  ON 63
ci_065                -4.147060e-03 3 1  ON 64
ci_066                 5.755353e-03 3 1  ON 65
ci_067                 5.766919e-03 3 1  ON 66
ci_068                -4.991575e-03 3 1  ON 67
ci_069                -5.194388e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.183532
====================================================
  Execution time = 1.4220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1406e-01
  Total weights = 1.956947417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072487534
                                         uncertainty =       0.002246266001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300072487534
                                         uncertainty =       0.002246266001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387314511
  error estimate for blocks of size 2^( 2) =       0.000396912911
  error estimate for blocks of size 2^( 3) =       0.000405758955
  error estimate for blocks of size 2^( 4) =       0.000411603422
  error estimate for blocks of size 2^( 5) =       0.000415623715
  error estimate for blocks of size 2^( 6) =       0.000418101924
  error estimate for blocks of size 2^( 7) =       0.000419622286

      target function =                  N/A
              le_mean =     -17.217078670196
             les_mean =     296.741857628296
             stat err =       0.000416237837
             autocorr =       1.154929771498
              std dev =       0.547745433688
             le_variance =       0.300025060126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707867020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217078670261       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217084926960       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217084600327       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217084609393       residual = 6.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 8.047824e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217078670261       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080836100       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080836791       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.578126e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217078670261       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217079269329       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217079286463       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217079291252       residual = 2.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 6.902417e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6789e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.019652e-02 3 1  ON 0
ci_002                -3.026763e-02 3 1  ON 1
ci_003                -2.537757e-02 3 1  ON 2
ci_004                 2.085185e-02 3 1  ON 3
ci_005                 2.120730e-02 3 1  ON 4
ci_006                -1.909572e-02 3 1  ON 5
ci_007                -1.939485e-02 3 1  ON 6
ci_008                -1.793839e-02 3 1  ON 7
ci_009                -1.815328e-02 3 1  ON 8
ci_010                -1.694498e-02 3 1  ON 9
ci_011                -1.665109e-02 3 1  ON 10
ci_012                -1.600234e-02 3 1  ON 11
ci_013                -1.903832e-02 3 1  ON 12
ci_014                 1.385454e-02 3 1  ON 13
ci_015                 1.385505e-02 3 1  ON 14
ci_016                 1.653238e-02 3 1  ON 15
ci_017                 1.637370e-02 3 1  ON 16
ci_018                 1.267096e-02 3 1  ON 17
ci_019                 1.332472e-02 3 1  ON 18
ci_020                 1.317986e-02 3 1  ON 19
ci_021                 1.350371e-02 3 1  ON 20
ci_022                 1.161070e-02 3 1  ON 21
ci_023                 1.112966e-02 3 1  ON 22
ci_024                 1.124409e-02 3 1  ON 23
ci_025                 1.106494e-02 3 1  ON 24
ci_026                 1.171196e-02 3 1  ON 25
ci_027                 1.158638e-02 3 1  ON 26
ci_028                -1.415998e-02 3 1  ON 27
ci_029                -1.429466e-02 3 1  ON 28
ci_030                -1.109198e-02 3 1  ON 29
ci_031                -1.096925e-02 3 1  ON 30
ci_032                -1.349839e-02 3 1  ON 31
ci_033                 1.044329e-02 3 1  ON 32
ci_034                 1.000007e-02 3 1  ON 33
ci_035                -4.660955e-03 3 1  ON 34
ci_036                -1.105539e-02 3 1  ON 35
ci_037                -1.081333e-02 3 1  ON 36
ci_038                 1.127254e-03 3 1  ON 37
ci_039                 1.189354e-03 3 1  ON 38
ci_040                -3.982988e-03 3 1  ON 39
ci_041                 9.737321e-03 3 1  ON 40
ci_042                 9.906460e-03 3 1  ON 41
ci_043                -3.240002e-03 3 1  ON 42
ci_044                -1.501724e-02 3 1  ON 43
ci_045                -1.551539e-03 3 1  ON 44
ci_046                 5.624280e-03 3 1  ON 45
ci_047                 5.343687e-03 3 1  ON 46
ci_048                -1.163220e-02 3 1  ON 47
ci_049                -1.238690e-02 3 1  ON 48
ci_050                 7.615061e-03 3 1  ON 49
ci_051                 7.378267e-03 3 1  ON 50
ci_052                -7.088833e-03 3 1  ON 51
ci_053                -6.642564e-03 3 1  ON 52
ci_054                -2.111030e-03 3 1  ON 53
ci_055                -2.264909e-03 3 1  ON 54
ci_056                 4.589923e-03 3 1  ON 55
ci_057                 4.754322e-03 3 1  ON 56
ci_058                -6.696428e-03 3 1  ON 57
ci_059                -6.897517e-03 3 1  ON 58
ci_060                 8.267472e-03 3 1  ON 59
ci_061                 8.696062e-03 3 1  ON 60
ci_062                -2.921947e-03 3 1  ON 61
ci_063                -2.985911e-03 3 1  ON 62
ci_064                -3.295785e-03 3 1  ON 63
ci_065                -4.252600e-03 3 1  ON 64
ci_066                 5.613977e-03 3 1  ON 65
ci_067                 5.707198e-03 3 1  ON 66
ci_068                -4.969914e-03 3 1  ON 67
ci_069                -5.185657e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2402
    reference variance = 0.273742
====================================================
  Execution time = 1.3804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1851e-01
  Total weights = 1.9566e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301542978396
                                         uncertainty =       0.003049311596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301542978396
                                         uncertainty =       0.003049311596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388261797
  error estimate for blocks of size 2^( 2) =       0.000397994888
  error estimate for blocks of size 2^( 3) =       0.000406239244
  error estimate for blocks of size 2^( 4) =       0.000412373254
  error estimate for blocks of size 2^( 5) =       0.000416912166
  error estimate for blocks of size 2^( 6) =       0.000420121326
  error estimate for blocks of size 2^( 7) =       0.000421171962

      target function =                  N/A
              le_mean =     -17.216938163448
             les_mean =     296.741249890926
             stat err =       0.000417644677
             autocorr =       1.157083177165
              std dev =       0.549085099660
             le_variance =       0.301494446669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301619166093
                                         uncertainty =       0.003049492272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301619166093
                                         uncertainty =       0.003049492272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388310922
  error estimate for blocks of size 2^( 2) =       0.000398038277
  error estimate for blocks of size 2^( 3) =       0.000406276654
  error estimate for blocks of size 2^( 4) =       0.000412407220
  error estimate for blocks of size 2^( 5) =       0.000416948506
  error estimate for blocks of size 2^( 6) =       0.000420146535
  error estimate for blocks of size 2^( 7) =       0.000421182351

      target function =                  N/A
              le_mean =     -17.216945068030
             les_mean =     296.749339682791
             stat err =       0.000417671153
             autocorr =       1.156937103459
              std dev =       0.549154572950
             le_variance =       0.301570744992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301600848896
                                         uncertainty =       0.003052307831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301600848896
                                         uncertainty =       0.003052307831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388299109
  error estimate for blocks of size 2^( 2) =       0.000398025714
  error estimate for blocks of size 2^( 3) =       0.000406267020
  error estimate for blocks of size 2^( 4) =       0.000412398656
  error estimate for blocks of size 2^( 5) =       0.000416934100
  error estimate for blocks of size 2^( 6) =       0.000420135388
  error estimate for blocks of size 2^( 7) =       0.000421180910

      target function =                  N/A
              le_mean =     -17.216941622191
             les_mean =     296.747169762274
             stat err =       0.000417662263
             autocorr =       1.156958252562
              std dev =       0.549137865630
             le_variance =       0.301552395469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301548674954
                                         uncertainty =       0.003050093679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301548674954
                                         uncertainty =       0.003050093679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388265475
  error estimate for blocks of size 2^( 2) =       0.000397998207
  error estimate for blocks of size 2^( 3) =       0.000406242987
  error estimate for blocks of size 2^( 4) =       0.000412376697
  error estimate for blocks of size 2^( 5) =       0.000416914689
  error estimate for blocks of size 2^( 6) =       0.000420123152
  error estimate for blocks of size 2^( 7) =       0.000421172667

      target function =                  N/A
              le_mean =     -17.216938782850
             les_mean =     296.748196024329
             stat err =       0.000417646801
             autocorr =       1.157073029508
              std dev =       0.549090300442
             le_variance =       0.301500158040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938163448        initial
     3.8147e-01     3.8147e+00             8.0478e-04       -17.216945068030  <--
     1.5259e+00     1.5259e+01             2.5781e-04       -17.216941622191
     6.1035e+00     6.1035e+01             6.9024e-05       -17.216938782850

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.3156e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.044071e-02 3 1  ON 0
ci_002                -3.018949e-02 3 1  ON 1
ci_003                -2.499655e-02 3 1  ON 2
ci_004                 2.071506e-02 3 1  ON 3
ci_005                 2.098242e-02 3 1  ON 4
ci_006                -1.926073e-02 3 1  ON 5
ci_007                -1.937593e-02 3 1  ON 6
ci_008                -1.801287e-02 3 1  ON 7
ci_009                -1.801469e-02 3 1  ON 8
ci_010                -1.675720e-02 3 1  ON 9
ci_011                -1.659457e-02 3 1  ON 10
ci_012                -1.610903e-02 3 1  ON 11
ci_013                -1.884516e-02 3 1  ON 12
ci_014                 1.383025e-02 3 1  ON 13
ci_015                 1.411022e-02 3 1  ON 14
ci_016                 1.662421e-02 3 1  ON 15
ci_017                 1.637905e-02 3 1  ON 16
ci_018                 1.288680e-02 3 1  ON 17
ci_019                 1.325572e-02 3 1  ON 18
ci_020                 1.299871e-02 3 1  ON 19
ci_021                 1.387726e-02 3 1  ON 20
ci_022                 1.144039e-02 3 1  ON 21
ci_023                 1.109328e-02 3 1  ON 22
ci_024                 1.110243e-02 3 1  ON 23
ci_025                 1.115926e-02 3 1  ON 24
ci_026                 1.157922e-02 3 1  ON 25
ci_027                 1.157550e-02 3 1  ON 26
ci_028                -1.432624e-02 3 1  ON 27
ci_029                -1.440899e-02 3 1  ON 28
ci_030                -1.101952e-02 3 1  ON 29
ci_031                -1.105577e-02 3 1  ON 30
ci_032                -1.346469e-02 3 1  ON 31
ci_033                 1.073245e-02 3 1  ON 32
ci_034                 1.000149e-02 3 1  ON 33
ci_035                -4.732151e-03 3 1  ON 34
ci_036                -1.093615e-02 3 1  ON 35
ci_037                -1.080666e-02 3 1  ON 36
ci_038                 1.220937e-03 3 1  ON 37
ci_039                 1.172212e-03 3 1  ON 38
ci_040                -4.056049e-03 3 1  ON 39
ci_041                 9.821962e-03 3 1  ON 40
ci_042                 9.816212e-03 3 1  ON 41
ci_043                -3.259618e-03 3 1  ON 42
ci_044                -1.447027e-02 3 1  ON 43
ci_045                -1.569807e-03 3 1  ON 44
ci_046                 5.674001e-03 3 1  ON 45
ci_047                 5.267508e-03 3 1  ON 46
ci_048                -1.160202e-02 3 1  ON 47
ci_049                -1.242521e-02 3 1  ON 48
ci_050                 7.711905e-03 3 1  ON 49
ci_051                 7.482949e-03 3 1  ON 50
ci_052                -7.101298e-03 3 1  ON 51
ci_053                -6.601883e-03 3 1  ON 52
ci_054                -2.057135e-03 3 1  ON 53
ci_055                -2.268403e-03 3 1  ON 54
ci_056                 4.618411e-03 3 1  ON 55
ci_057                 4.789593e-03 3 1  ON 56
ci_058                -6.756668e-03 3 1  ON 57
ci_059                -6.840545e-03 3 1  ON 58
ci_060                 8.052328e-03 3 1  ON 59
ci_061                 8.756207e-03 3 1  ON 60
ci_062                -2.857983e-03 3 1  ON 61
ci_063                -2.878791e-03 3 1  ON 62
ci_064                -3.241926e-03 3 1  ON 63
ci_065                -4.392365e-03 3 1  ON 64
ci_066                 5.393022e-03 3 1  ON 65
ci_067                 5.613791e-03 3 1  ON 66
ci_068                -4.922065e-03 3 1  ON 67
ci_069                -5.175019e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.269083
====================================================
  Execution time = 1.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1578e-01
  Total weights = 1.956520462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299924697493
                                         uncertainty =       0.002402658532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299924697493
                                         uncertainty =       0.002402658532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387249700
  error estimate for blocks of size 2^( 2) =       0.000397203282
  error estimate for blocks of size 2^( 3) =       0.000405744920
  error estimate for blocks of size 2^( 4) =       0.000411648046
  error estimate for blocks of size 2^( 5) =       0.000416557323
  error estimate for blocks of size 2^( 6) =       0.000417761541
  error estimate for blocks of size 2^( 7) =       0.000418828153

      target function =                  N/A
              le_mean =     -17.217338132447
             les_mean =     296.752510000382
             stat err =       0.000416198766
             autocorr =       1.155099499348
              std dev =       0.547653778083
             le_variance =       0.299924660648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721733813245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217338132531       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217353889465       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217354070675       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217354108788       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217354103403       residual = 5.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.013541e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217338132531       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217346812920       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217346860356       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217346859899       residual = 4.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.860875e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217338132531       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217341236627       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217341276466       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.655496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6888e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.039154e-02 3 1  ON 0
ci_002                -3.033045e-02 3 1  ON 1
ci_003                -2.474484e-02 3 1  ON 2
ci_004                 2.091419e-02 3 1  ON 3
ci_005                 2.070355e-02 3 1  ON 4
ci_006                -1.939953e-02 3 1  ON 5
ci_007                -1.944556e-02 3 1  ON 6
ci_008                -1.838364e-02 3 1  ON 7
ci_009                -1.801954e-02 3 1  ON 8
ci_010                -1.700725e-02 3 1  ON 9
ci_011                -1.654876e-02 3 1  ON 10
ci_012                -1.610678e-02 3 1  ON 11
ci_013                -1.912200e-02 3 1  ON 12
ci_014                 1.399569e-02 3 1  ON 13
ci_015                 1.437483e-02 3 1  ON 14
ci_016                 1.666475e-02 3 1  ON 15
ci_017                 1.654662e-02 3 1  ON 16
ci_018                 1.297716e-02 3 1  ON 17
ci_019                 1.326607e-02 3 1  ON 18
ci_020                 1.292813e-02 3 1  ON 19
ci_021                 1.354048e-02 3 1  ON 20
ci_022                 1.132014e-02 3 1  ON 21
ci_023                 1.121616e-02 3 1  ON 22
ci_024                 1.085045e-02 3 1  ON 23
ci_025                 1.164535e-02 3 1  ON 24
ci_026                 1.147281e-02 3 1  ON 25
ci_027                 1.110663e-02 3 1  ON 26
ci_028                -1.436250e-02 3 1  ON 27
ci_029                -1.441443e-02 3 1  ON 28
ci_030                -1.098426e-02 3 1  ON 29
ci_031                -1.106074e-02 3 1  ON 30
ci_032                -1.347017e-02 3 1  ON 31
ci_033                 1.058075e-02 3 1  ON 32
ci_034                 9.919296e-03 3 1  ON 33
ci_035                -4.638572e-03 3 1  ON 34
ci_036                -1.106190e-02 3 1  ON 35
ci_037                -1.057619e-02 3 1  ON 36
ci_038                 1.160641e-03 3 1  ON 37
ci_039                 1.295071e-03 3 1  ON 38
ci_040                -4.119802e-03 3 1  ON 39
ci_041                 9.873642e-03 3 1  ON 40
ci_042                 9.849312e-03 3 1  ON 41
ci_043                -3.014846e-03 3 1  ON 42
ci_044                -1.478939e-02 3 1  ON 43
ci_045                -1.414490e-03 3 1  ON 44
ci_046                 5.667536e-03 3 1  ON 45
ci_047                 5.447831e-03 3 1  ON 46
ci_048                -1.171994e-02 3 1  ON 47
ci_049                -1.209519e-02 3 1  ON 48
ci_050                 7.765166e-03 3 1  ON 49
ci_051                 7.493693e-03 3 1  ON 50
ci_052                -6.821295e-03 3 1  ON 51
ci_053                -6.966997e-03 3 1  ON 52
ci_054                -1.919972e-03 3 1  ON 53
ci_055                -2.055831e-03 3 1  ON 54
ci_056                 4.781042e-03 3 1  ON 55
ci_057                 5.109309e-03 3 1  ON 56
ci_058                -6.968614e-03 3 1  ON 57
ci_059                -6.683977e-03 3 1  ON 58
ci_060                 8.286630e-03 3 1  ON 59
ci_061                 8.924022e-03 3 1  ON 60
ci_062                -2.764464e-03 3 1  ON 61
ci_063                -2.542661e-03 3 1  ON 62
ci_064                -3.297023e-03 3 1  ON 63
ci_065                -4.309087e-03 3 1  ON 64
ci_066                 5.669761e-03 3 1  ON 65
ci_067                 6.040189e-03 3 1  ON 66
ci_068                -4.821958e-03 3 1  ON 67
ci_069                -4.896028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.240807
====================================================
  Execution time = 1.3748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2014e-01
  Total weights = 1.9568e+06
  Execution time = 1.8681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301960882718
                                         uncertainty =       0.002402691883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301960882718
                                         uncertainty =       0.002402691883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649565
  error estimate for blocks of size 2^( 2) =       0.000398342628
  error estimate for blocks of size 2^( 3) =       0.000407324701
  error estimate for blocks of size 2^( 4) =       0.000413073345
  error estimate for blocks of size 2^( 5) =       0.000417512195
  error estimate for blocks of size 2^( 6) =       0.000418653448
  error estimate for blocks of size 2^( 7) =       0.000419734248

      target function =                  N/A
              le_mean =     -17.217297753198
             les_mean =     296.779284407195
             stat err =       0.000417243309
             autocorr =       1.152556942264
              std dev =       0.549633485299
             le_variance =       0.302096968162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302895365570
                                         uncertainty =       0.002407030268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302895365570
                                         uncertainty =       0.002407030268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389285797
  error estimate for blocks of size 2^( 2) =       0.000398942744
  error estimate for blocks of size 2^( 3) =       0.000407888541
  error estimate for blocks of size 2^( 4) =       0.000413612882
  error estimate for blocks of size 2^( 5) =       0.000417999587
  error estimate for blocks of size 2^( 6) =       0.000419129357
  error estimate for blocks of size 2^( 7) =       0.000420237066

      target function =                  N/A
              le_mean =     -17.217295549230
             les_mean =     296.756178324632
             stat err =       0.000417744723
             autocorr =       1.151555375212
              std dev =       0.550533254139
             le_variance =       0.303086863912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303023774012
                                         uncertainty =       0.002411248412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303023774012
                                         uncertainty =       0.002411248412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389370126
  error estimate for blocks of size 2^( 2) =       0.000399023326
  error estimate for blocks of size 2^( 3) =       0.000407964667
  error estimate for blocks of size 2^( 4) =       0.000413687506
  error estimate for blocks of size 2^( 5) =       0.000418072508
  error estimate for blocks of size 2^( 6) =       0.000419200236
  error estimate for blocks of size 2^( 7) =       0.000420293692

      target function =                  N/A
              le_mean =     -17.217298951605
             les_mean =     296.757109385502
             stat err =       0.000417813485
             autocorr =       1.151435594829
              std dev =       0.550652513152
             le_variance =       0.303218190240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302110016858
                                         uncertainty =       0.002401925766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302110016858
                                         uncertainty =       0.002401925766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388750828
  error estimate for blocks of size 2^( 2) =       0.000398438806
  error estimate for blocks of size 2^( 3) =       0.000407414264
  error estimate for blocks of size 2^( 4) =       0.000413162211
  error estimate for blocks of size 2^( 5) =       0.000417591260
  error estimate for blocks of size 2^( 6) =       0.000418737380
  error estimate for blocks of size 2^( 7) =       0.000419833858

      target function =                  N/A
              le_mean =     -17.217292353393
             les_mean =     296.757002065857
             stat err =       0.000417331177
             autocorr =       1.152441813277
              std dev =       0.549776692840
             le_variance =       0.302254411990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217297753198        initial
     9.5367e-02     9.5367e-01             1.0135e-03       -17.217295549230
     3.8147e-01     3.8147e+00             4.8609e-04       -17.217298951605  <--
     1.5259e+00     1.5259e+01             1.6555e-04       -17.217292353393

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.3136e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.039154e-02 3 1  ON 0
ci_002                -3.033045e-02 3 1  ON 1
ci_003                -2.474484e-02 3 1  ON 2
ci_004                 2.091419e-02 3 1  ON 3
ci_005                 2.070355e-02 3 1  ON 4
ci_006                -1.939953e-02 3 1  ON 5
ci_007                -1.944556e-02 3 1  ON 6
ci_008                -1.838364e-02 3 1  ON 7
ci_009                -1.801954e-02 3 1  ON 8
ci_010                -1.700725e-02 3 1  ON 9
ci_011                -1.654876e-02 3 1  ON 10
ci_012                -1.610678e-02 3 1  ON 11
ci_013                -1.912200e-02 3 1  ON 12
ci_014                 1.399569e-02 3 1  ON 13
ci_015                 1.437483e-02 3 1  ON 14
ci_016                 1.666475e-02 3 1  ON 15
ci_017                 1.654662e-02 3 1  ON 16
ci_018                 1.297716e-02 3 1  ON 17
ci_019                 1.326607e-02 3 1  ON 18
ci_020                 1.292813e-02 3 1  ON 19
ci_021                 1.354048e-02 3 1  ON 20
ci_022                 1.132014e-02 3 1  ON 21
ci_023                 1.121616e-02 3 1  ON 22
ci_024                 1.085045e-02 3 1  ON 23
ci_025                 1.164535e-02 3 1  ON 24
ci_026                 1.147281e-02 3 1  ON 25
ci_027                 1.110663e-02 3 1  ON 26
ci_028                -1.436250e-02 3 1  ON 27
ci_029                -1.441443e-02 3 1  ON 28
ci_030                -1.098426e-02 3 1  ON 29
ci_031                -1.106074e-02 3 1  ON 30
ci_032                -1.347017e-02 3 1  ON 31
ci_033                 1.058075e-02 3 1  ON 32
ci_034                 9.919296e-03 3 1  ON 33
ci_035                -4.638572e-03 3 1  ON 34
ci_036                -1.106190e-02 3 1  ON 35
ci_037                -1.057619e-02 3 1  ON 36
ci_038                 1.160641e-03 3 1  ON 37
ci_039                 1.295071e-03 3 1  ON 38
ci_040                -4.119802e-03 3 1  ON 39
ci_041                 9.873642e-03 3 1  ON 40
ci_042                 9.849312e-03 3 1  ON 41
ci_043                -3.014846e-03 3 1  ON 42
ci_044                -1.478939e-02 3 1  ON 43
ci_045                -1.414490e-03 3 1  ON 44
ci_046                 5.667536e-03 3 1  ON 45
ci_047                 5.447831e-03 3 1  ON 46
ci_048                -1.171994e-02 3 1  ON 47
ci_049                -1.209519e-02 3 1  ON 48
ci_050                 7.765166e-03 3 1  ON 49
ci_051                 7.493693e-03 3 1  ON 50
ci_052                -6.821295e-03 3 1  ON 51
ci_053                -6.966997e-03 3 1  ON 52
ci_054                -1.919972e-03 3 1  ON 53
ci_055                -2.055831e-03 3 1  ON 54
ci_056                 4.781042e-03 3 1  ON 55
ci_057                 5.109309e-03 3 1  ON 56
ci_058                -6.968614e-03 3 1  ON 57
ci_059                -6.683977e-03 3 1  ON 58
ci_060                 8.286630e-03 3 1  ON 59
ci_061                 8.924022e-03 3 1  ON 60
ci_062                -2.764464e-03 3 1  ON 61
ci_063                -2.542661e-03 3 1  ON 62
ci_064                -3.297023e-03 3 1  ON 63
ci_065                -4.309087e-03 3 1  ON 64
ci_066                 5.669761e-03 3 1  ON 65
ci_067                 6.040189e-03 3 1  ON 66
ci_068                -4.821958e-03 3 1  ON 67
ci_069                -4.896028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.281
    reference variance = 0.280087
====================================================
  Execution time = 1.4600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1331e-01
  Total weights = 1.956890822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300388540100
                                         uncertainty =       0.001808388178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300388540100
                                         uncertainty =       0.001808388178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387561213
  error estimate for blocks of size 2^( 2) =       0.000396966307
  error estimate for blocks of size 2^( 3) =       0.000405628231
  error estimate for blocks of size 2^( 4) =       0.000412209107
  error estimate for blocks of size 2^( 5) =       0.000415400051
  error estimate for blocks of size 2^( 6) =       0.000418623144
  error estimate for blocks of size 2^( 7) =       0.000419289300

      target function =                  N/A
              le_mean =     -17.216293488539
             les_mean =     296.714075430898
             stat err =       0.000416380401
             autocorr =       1.154250159825
              std dev =       0.548094324274
             le_variance =       0.300407388301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629348854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293488604       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216296718950       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298194545       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216298012383       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216298126511       residual = 4.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.267878e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293488604       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216295260301       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216295756406       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216295763533       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 6.150603e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293488604       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216294119958       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294188438       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216294205169       residual = 2.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.017092e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7151e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.029586e-02 3 1  ON 0
ci_002                -3.060879e-02 3 1  ON 1
ci_003                -2.535990e-02 3 1  ON 2
ci_004                 2.095634e-02 3 1  ON 3
ci_005                 2.066881e-02 3 1  ON 4
ci_006                -1.940188e-02 3 1  ON 5
ci_007                -1.965199e-02 3 1  ON 6
ci_008                -1.851553e-02 3 1  ON 7
ci_009                -1.797072e-02 3 1  ON 8
ci_010                -1.706514e-02 3 1  ON 9
ci_011                -1.629956e-02 3 1  ON 10
ci_012                -1.611231e-02 3 1  ON 11
ci_013                -1.892958e-02 3 1  ON 12
ci_014                 1.411388e-02 3 1  ON 13
ci_015                 1.394330e-02 3 1  ON 14
ci_016                 1.674528e-02 3 1  ON 15
ci_017                 1.669981e-02 3 1  ON 16
ci_018                 1.309860e-02 3 1  ON 17
ci_019                 1.308963e-02 3 1  ON 18
ci_020                 1.304949e-02 3 1  ON 19
ci_021                 1.320678e-02 3 1  ON 20
ci_022                 1.111534e-02 3 1  ON 21
ci_023                 1.089506e-02 3 1  ON 22
ci_024                 1.091012e-02 3 1  ON 23
ci_025                 1.146815e-02 3 1  ON 24
ci_026                 1.139359e-02 3 1  ON 25
ci_027                 1.123807e-02 3 1  ON 26
ci_028                -1.435043e-02 3 1  ON 27
ci_029                -1.416032e-02 3 1  ON 28
ci_030                -1.103283e-02 3 1  ON 29
ci_031                -1.124737e-02 3 1  ON 30
ci_032                -1.364572e-02 3 1  ON 31
ci_033                 1.002602e-02 3 1  ON 32
ci_034                 9.731404e-03 3 1  ON 33
ci_035                -4.648391e-03 3 1  ON 34
ci_036                -1.091785e-02 3 1  ON 35
ci_037                -1.080084e-02 3 1  ON 36
ci_038                 1.056589e-03 3 1  ON 37
ci_039                 1.097153e-03 3 1  ON 38
ci_040                -3.957068e-03 3 1  ON 39
ci_041                 9.909709e-03 3 1  ON 40
ci_042                 1.005410e-02 3 1  ON 41
ci_043                -2.962198e-03 3 1  ON 42
ci_044                -1.483397e-02 3 1  ON 43
ci_045                -1.278690e-03 3 1  ON 44
ci_046                 5.346268e-03 3 1  ON 45
ci_047                 5.677271e-03 3 1  ON 46
ci_048                -1.163083e-02 3 1  ON 47
ci_049                -1.232824e-02 3 1  ON 48
ci_050                 7.879747e-03 3 1  ON 49
ci_051                 7.730527e-03 3 1  ON 50
ci_052                -7.129329e-03 3 1  ON 51
ci_053                -6.778907e-03 3 1  ON 52
ci_054                -1.914680e-03 3 1  ON 53
ci_055                -2.211240e-03 3 1  ON 54
ci_056                 4.888756e-03 3 1  ON 55
ci_057                 5.108862e-03 3 1  ON 56
ci_058                -7.250067e-03 3 1  ON 57
ci_059                -6.624161e-03 3 1  ON 58
ci_060                 8.503214e-03 3 1  ON 59
ci_061                 8.872266e-03 3 1  ON 60
ci_062                -2.898261e-03 3 1  ON 61
ci_063                -2.659678e-03 3 1  ON 62
ci_064                -3.061261e-03 3 1  ON 63
ci_065                -4.154026e-03 3 1  ON 64
ci_066                 5.535366e-03 3 1  ON 65
ci_067                 6.156238e-03 3 1  ON 66
ci_068                -4.689355e-03 3 1  ON 67
ci_069                -4.330338e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.29
    reference variance = 0.378804
====================================================
  Execution time = 1.3744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1796e-01
  Total weights = 1.9568e+06
  Execution time = 1.8594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302398469000
                                         uncertainty =       0.002648954398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302398469000
                                         uncertainty =       0.002648954398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388929567
  error estimate for blocks of size 2^( 2) =       0.000398295637
  error estimate for blocks of size 2^( 3) =       0.000406666659
  error estimate for blocks of size 2^( 4) =       0.000413353896
  error estimate for blocks of size 2^( 5) =       0.000417700649
  error estimate for blocks of size 2^( 6) =       0.000419952987
  error estimate for blocks of size 2^( 7) =       0.000422354662

      target function =                  N/A
              le_mean =     -17.216567678330
             les_mean =     296.728833182534
             stat err =       0.000418340549
             autocorr =       1.156959090225
              std dev =       0.550029468635
             le_variance =       0.302532416367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302743892439
                                         uncertainty =       0.002690468715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302743892439
                                         uncertainty =       0.002690468715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389158090
  error estimate for blocks of size 2^( 2) =       0.000398541449
  error estimate for blocks of size 2^( 3) =       0.000406902053
  error estimate for blocks of size 2^( 4) =       0.000413595774
  error estimate for blocks of size 2^( 5) =       0.000417949226
  error estimate for blocks of size 2^( 6) =       0.000420166973
  error estimate for blocks of size 2^( 7) =       0.000422531514

      target function =                  N/A
              le_mean =     -17.216557489568
             les_mean =     296.729788234108
             stat err =       0.000418560872
             autocorr =       1.156818236750
              std dev =       0.550352649151
             le_variance =       0.302888038428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302800677433
                                         uncertainty =       0.002690548612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302800677433
                                         uncertainty =       0.002690548612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389195001
  error estimate for blocks of size 2^( 2) =       0.000398579661
  error estimate for blocks of size 2^( 3) =       0.000406942007
  error estimate for blocks of size 2^( 4) =       0.000413634752
  error estimate for blocks of size 2^( 5) =       0.000417991240
  error estimate for blocks of size 2^( 6) =       0.000420206239
  error estimate for blocks of size 2^( 7) =       0.000422571640

      target function =                  N/A
              le_mean =     -17.216558369309
             les_mean =     296.729558104696
             stat err =       0.000418600968
             autocorr =       1.156820425737
              std dev =       0.550404849293
             le_variance =       0.302945498126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302437999890
                                         uncertainty =       0.002655373204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302437999890
                                         uncertainty =       0.002655373204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388956152
  error estimate for blocks of size 2^( 2) =       0.000398324790
  error estimate for blocks of size 2^( 3) =       0.000406695500
  error estimate for blocks of size 2^( 4) =       0.000413383156
  error estimate for blocks of size 2^( 5) =       0.000417728586
  error estimate for blocks of size 2^( 6) =       0.000419970035
  error estimate for blocks of size 2^( 7) =       0.000422362888

      target function =                  N/A
              le_mean =     -17.216562377178
             les_mean =     296.730358159105
             stat err =       0.000418361166
             autocorr =       1.156914965916
              std dev =       0.550067065966
             le_variance =       0.302573777060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216567678330        initial  <--
     9.5367e-02     9.5367e-01             1.2679e-03       -17.216557489568
     3.8147e-01     3.8147e+00             6.1506e-04       -17.216558369309
     1.5259e+00     1.5259e+01             2.0171e-04       -17.216562377178

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1084
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.039154e-02 3 1  ON 0
ci_002                -3.033045e-02 3 1  ON 1
ci_003                -2.474484e-02 3 1  ON 2
ci_004                 2.091419e-02 3 1  ON 3
ci_005                 2.070355e-02 3 1  ON 4
ci_006                -1.939953e-02 3 1  ON 5
ci_007                -1.944556e-02 3 1  ON 6
ci_008                -1.838364e-02 3 1  ON 7
ci_009                -1.801954e-02 3 1  ON 8
ci_010                -1.700725e-02 3 1  ON 9
ci_011                -1.654876e-02 3 1  ON 10
ci_012                -1.610678e-02 3 1  ON 11
ci_013                -1.912200e-02 3 1  ON 12
ci_014                 1.399569e-02 3 1  ON 13
ci_015                 1.437483e-02 3 1  ON 14
ci_016                 1.666475e-02 3 1  ON 15
ci_017                 1.654662e-02 3 1  ON 16
ci_018                 1.297716e-02 3 1  ON 17
ci_019                 1.326607e-02 3 1  ON 18
ci_020                 1.292813e-02 3 1  ON 19
ci_021                 1.354048e-02 3 1  ON 20
ci_022                 1.132014e-02 3 1  ON 21
ci_023                 1.121616e-02 3 1  ON 22
ci_024                 1.085045e-02 3 1  ON 23
ci_025                 1.164535e-02 3 1  ON 24
ci_026                 1.147281e-02 3 1  ON 25
ci_027                 1.110663e-02 3 1  ON 26
ci_028                -1.436250e-02 3 1  ON 27
ci_029                -1.441443e-02 3 1  ON 28
ci_030                -1.098426e-02 3 1  ON 29
ci_031                -1.106074e-02 3 1  ON 30
ci_032                -1.347017e-02 3 1  ON 31
ci_033                 1.058075e-02 3 1  ON 32
ci_034                 9.919296e-03 3 1  ON 33
ci_035                -4.638572e-03 3 1  ON 34
ci_036                -1.106190e-02 3 1  ON 35
ci_037                -1.057619e-02 3 1  ON 36
ci_038                 1.160641e-03 3 1  ON 37
ci_039                 1.295071e-03 3 1  ON 38
ci_040                -4.119802e-03 3 1  ON 39
ci_041                 9.873642e-03 3 1  ON 40
ci_042                 9.849312e-03 3 1  ON 41
ci_043                -3.014846e-03 3 1  ON 42
ci_044                -1.478939e-02 3 1  ON 43
ci_045                -1.414490e-03 3 1  ON 44
ci_046                 5.667536e-03 3 1  ON 45
ci_047                 5.447831e-03 3 1  ON 46
ci_048                -1.171994e-02 3 1  ON 47
ci_049                -1.209519e-02 3 1  ON 48
ci_050                 7.765166e-03 3 1  ON 49
ci_051                 7.493693e-03 3 1  ON 50
ci_052                -6.821295e-03 3 1  ON 51
ci_053                -6.966997e-03 3 1  ON 52
ci_054                -1.919972e-03 3 1  ON 53
ci_055                -2.055831e-03 3 1  ON 54
ci_056                 4.781042e-03 3 1  ON 55
ci_057                 5.109309e-03 3 1  ON 56
ci_058                -6.968614e-03 3 1  ON 57
ci_059                -6.683977e-03 3 1  ON 58
ci_060                 8.286630e-03 3 1  ON 59
ci_061                 8.924022e-03 3 1  ON 60
ci_062                -2.764464e-03 3 1  ON 61
ci_063                -2.542661e-03 3 1  ON 62
ci_064                -3.297023e-03 3 1  ON 63
ci_065                -4.309087e-03 3 1  ON 64
ci_066                 5.669761e-03 3 1  ON 65
ci_067                 6.040189e-03 3 1  ON 66
ci_068                -4.821958e-03 3 1  ON 67
ci_069                -4.896028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2634
    reference variance = 0.291205
====================================================
  Execution time = 1.4294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1731e-01
  Total weights = 1.956779622e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302507202760
                                         uncertainty =       0.002474038300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302507202760
                                         uncertainty =       0.002474038300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388875650
  error estimate for blocks of size 2^( 2) =       0.000398541621
  error estimate for blocks of size 2^( 3) =       0.000406789508
  error estimate for blocks of size 2^( 4) =       0.000412679762
  error estimate for blocks of size 2^( 5) =       0.000416511760
  error estimate for blocks of size 2^( 6) =       0.000418561945
  error estimate for blocks of size 2^( 7) =       0.000419315823

      target function =                  N/A
              le_mean =     -17.216604939162
             les_mean =     296.728798512897
             stat err =       0.000416767322
             autocorr =       1.148592086764
              std dev =       0.549953217960
             le_variance =       0.302448541944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660493916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604939210       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216607739692       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607562338       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607564957       residual = 2.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.131680e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604939210       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605778146       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605792799       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605793534       residual = 2.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 9.851810e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604939210       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605159883       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605169403       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605170352       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.632560e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6822e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.039972e-02 3 1  ON 0
ci_002                -3.033704e-02 3 1  ON 1
ci_003                -2.475263e-02 3 1  ON 2
ci_004                 2.095831e-02 3 1  ON 3
ci_005                 2.070764e-02 3 1  ON 4
ci_006                -1.936177e-02 3 1  ON 5
ci_007                -1.945862e-02 3 1  ON 6
ci_008                -1.836350e-02 3 1  ON 7
ci_009                -1.801756e-02 3 1  ON 8
ci_010                -1.700888e-02 3 1  ON 9
ci_011                -1.651688e-02 3 1  ON 10
ci_012                -1.611869e-02 3 1  ON 11
ci_013                -1.914970e-02 3 1  ON 12
ci_014                 1.391713e-02 3 1  ON 13
ci_015                 1.431762e-02 3 1  ON 14
ci_016                 1.665348e-02 3 1  ON 15
ci_017                 1.660607e-02 3 1  ON 16
ci_018                 1.297440e-02 3 1  ON 17
ci_019                 1.323365e-02 3 1  ON 18
ci_020                 1.291405e-02 3 1  ON 19
ci_021                 1.353670e-02 3 1  ON 20
ci_022                 1.139936e-02 3 1  ON 21
ci_023                 1.122040e-02 3 1  ON 22
ci_024                 1.090259e-02 3 1  ON 23
ci_025                 1.155910e-02 3 1  ON 24
ci_026                 1.151535e-02 3 1  ON 25
ci_027                 1.114150e-02 3 1  ON 26
ci_028                -1.436027e-02 3 1  ON 27
ci_029                -1.443084e-02 3 1  ON 28
ci_030                -1.099653e-02 3 1  ON 29
ci_031                -1.106665e-02 3 1  ON 30
ci_032                -1.348139e-02 3 1  ON 31
ci_033                 1.051716e-02 3 1  ON 32
ci_034                 9.879320e-03 3 1  ON 33
ci_035                -4.652078e-03 3 1  ON 34
ci_036                -1.099842e-02 3 1  ON 35
ci_037                -1.056197e-02 3 1  ON 36
ci_038                 1.180868e-03 3 1  ON 37
ci_039                 1.286354e-03 3 1  ON 38
ci_040                -4.103840e-03 3 1  ON 39
ci_041                 9.890900e-03 3 1  ON 40
ci_042                 9.865083e-03 3 1  ON 41
ci_043                -3.022559e-03 3 1  ON 42
ci_044                -1.480239e-02 3 1  ON 43
ci_045                -1.416989e-03 3 1  ON 44
ci_046                 5.646460e-03 3 1  ON 45
ci_047                 5.476572e-03 3 1  ON 46
ci_048                -1.169042e-02 3 1  ON 47
ci_049                -1.210621e-02 3 1  ON 48
ci_050                 7.745630e-03 3 1  ON 49
ci_051                 7.395175e-03 3 1  ON 50
ci_052                -6.875586e-03 3 1  ON 51
ci_053                -6.936341e-03 3 1  ON 52
ci_054                -1.940792e-03 3 1  ON 53
ci_055                -2.138754e-03 3 1  ON 54
ci_056                 4.762047e-03 3 1  ON 55
ci_057                 5.034193e-03 3 1  ON 56
ci_058                -6.985478e-03 3 1  ON 57
ci_059                -6.696641e-03 3 1  ON 58
ci_060                 8.276465e-03 3 1  ON 59
ci_061                 8.997456e-03 3 1  ON 60
ci_062                -2.819990e-03 3 1  ON 61
ci_063                -2.600977e-03 3 1  ON 62
ci_064                -3.212770e-03 3 1  ON 63
ci_065                -4.311602e-03 3 1  ON 64
ci_066                 5.742242e-03 3 1  ON 65
ci_067                 5.995168e-03 3 1  ON 66
ci_068                -4.840076e-03 3 1  ON 67
ci_069                -4.905657e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1692
    reference variance = 0.156137
====================================================
  Execution time = 1.3934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1642e-01
  Total weights = 1.9566e+06
  Execution time = 1.8539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302081817756
                                         uncertainty =       0.002126381982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302081817756
                                         uncertainty =       0.002126381982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388646335
  error estimate for blocks of size 2^( 2) =       0.000398393679
  error estimate for blocks of size 2^( 3) =       0.000406893927
  error estimate for blocks of size 2^( 4) =       0.000413425963
  error estimate for blocks of size 2^( 5) =       0.000418429807
  error estimate for blocks of size 2^( 6) =       0.000421389734
  error estimate for blocks of size 2^( 7) =       0.000422419673

      target function =                  N/A
              le_mean =     -17.217396056812
             les_mean =     296.755506282815
             stat err =       0.000418916294
             autocorr =       1.161837402529
              std dev =       0.549628917299
             le_variance =       0.302091946731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938702117
                                         uncertainty =       0.002119189788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938702117
                                         uncertainty =       0.002119189788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388554597
  error estimate for blocks of size 2^( 2) =       0.000398312171
  error estimate for blocks of size 2^( 3) =       0.000406832740
  error estimate for blocks of size 2^( 4) =       0.000413373363
  error estimate for blocks of size 2^( 5) =       0.000418381096
  error estimate for blocks of size 2^( 6) =       0.000421341969
  error estimate for blocks of size 2^( 7) =       0.000422385981

      target function =                  N/A
              le_mean =     -17.217396672338
             les_mean =     296.755056076477
             stat err =       0.000418870602
             autocorr =       1.162132534176
              std dev =       0.549499180844
             le_variance =       0.301949349748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301990441335
                                         uncertainty =       0.002121822129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301990441335
                                         uncertainty =       0.002121822129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388587744
  error estimate for blocks of size 2^( 2) =       0.000398340850
  error estimate for blocks of size 2^( 3) =       0.000406853949
  error estimate for blocks of size 2^( 4) =       0.000413392528
  error estimate for blocks of size 2^( 5) =       0.000418399706
  error estimate for blocks of size 2^( 6) =       0.000421360027
  error estimate for blocks of size 2^( 7) =       0.000422392498

      target function =                  N/A
              le_mean =     -17.217395999753
             les_mean =     296.803641214275
             stat err =       0.000418886190
             autocorr =       1.162020758409
              std dev =       0.549546058125
             le_variance =       0.302000870000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302068905726
                                         uncertainty =       0.002125850727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302068905726
                                         uncertainty =       0.002125850727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388638052
  error estimate for blocks of size 2^( 2) =       0.000398385071
  error estimate for blocks of size 2^( 3) =       0.000406886496
  error estimate for blocks of size 2^( 4) =       0.000413418615
  error estimate for blocks of size 2^( 5) =       0.000418421625
  error estimate for blocks of size 2^( 6) =       0.000421381002
  error estimate for blocks of size 2^( 7) =       0.000422418210

      target function =                  N/A
              le_mean =     -17.217396718917
             les_mean =     296.797198310704
             stat err =       0.000418909863
             autocorr =       1.161851250837
              std dev =       0.549617204349
             le_variance =       0.302079071316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217396056812        initial
     9.5367e-01     9.5367e+00             3.1317e-04       -17.217396672338
     3.8147e+00     3.8147e+01             9.8518e-05       -17.217395999753
     1.5259e+01     1.5259e+02             2.6326e-05       -17.217396718917  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.3261e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.039375e-02 3 1  ON 0
ci_002                -3.033218e-02 3 1  ON 1
ci_003                -2.474689e-02 3 1  ON 2
ci_004                 2.092556e-02 3 1  ON 3
ci_005                 2.070457e-02 3 1  ON 4
ci_006                -1.938977e-02 3 1  ON 5
ci_007                -1.944899e-02 3 1  ON 6
ci_008                -1.837838e-02 3 1  ON 7
ci_009                -1.801904e-02 3 1  ON 8
ci_010                -1.700774e-02 3 1  ON 9
ci_011                -1.654044e-02 3 1  ON 10
ci_012                -1.610993e-02 3 1  ON 11
ci_013                -1.912917e-02 3 1  ON 12
ci_014                 1.397515e-02 3 1  ON 13
ci_015                 1.435980e-02 3 1  ON 14
ci_016                 1.666182e-02 3 1  ON 15
ci_017                 1.656207e-02 3 1  ON 16
ci_018                 1.297649e-02 3 1  ON 17
ci_019                 1.325758e-02 3 1  ON 18
ci_020                 1.292450e-02 3 1  ON 19
ci_021                 1.353953e-02 3 1  ON 20
ci_022                 1.134092e-02 3 1  ON 21
ci_023                 1.121730e-02 3 1  ON 22
ci_024                 1.086391e-02 3 1  ON 23
ci_025                 1.162314e-02 3 1  ON 24
ci_026                 1.148392e-02 3 1  ON 25
ci_027                 1.111570e-02 3 1  ON 26
ci_028                -1.436193e-02 3 1  ON 27
ci_029                -1.441870e-02 3 1  ON 28
ci_030                -1.098752e-02 3 1  ON 29
ci_031                -1.106227e-02 3 1  ON 30
ci_032                -1.347315e-02 3 1  ON 31
ci_033                 1.056412e-02 3 1  ON 32
ci_034                 9.908796e-03 3 1  ON 33
ci_035                -4.642183e-03 3 1  ON 34
ci_036                -1.104538e-02 3 1  ON 35
ci_037                -1.057247e-02 3 1  ON 36
ci_038                 1.166089e-03 3 1  ON 37
ci_039                 1.292743e-03 3 1  ON 38
ci_040                -4.115475e-03 3 1  ON 39
ci_041                 9.878132e-03 3 1  ON 40
ci_042                 9.853426e-03 3 1  ON 41
ci_043                -3.016927e-03 3 1  ON 42
ci_044                -1.479270e-02 3 1  ON 43
ci_045                -1.415118e-03 3 1  ON 44
ci_046                 5.662007e-03 3 1  ON 45
ci_047                 5.455419e-03 3 1  ON 46
ci_048                -1.171231e-02 3 1  ON 47
ci_049                -1.209805e-02 3 1  ON 48
ci_050                 7.759940e-03 3 1  ON 49
ci_051                 7.467368e-03 3 1  ON 50
ci_052                -6.835704e-03 3 1  ON 51
ci_053                -6.958879e-03 3 1  ON 52
ci_054                -1.925501e-03 3 1  ON 53
ci_055                -2.077761e-03 3 1  ON 54
ci_056                 4.775991e-03 3 1  ON 55
ci_057                 5.089361e-03 3 1  ON 56
ci_058                -6.973121e-03 3 1  ON 57
ci_059                -6.687289e-03 3 1  ON 58
ci_060                 8.283982e-03 3 1  ON 59
ci_061                 8.943248e-03 3 1  ON 60
ci_062                -2.779151e-03 3 1  ON 61
ci_063                -2.558028e-03 3 1  ON 62
ci_064                -3.273861e-03 3 1  ON 63
ci_065                -4.309769e-03 3 1  ON 64
ci_066                 5.689107e-03 3 1  ON 65
ci_067                 6.028217e-03 3 1  ON 66
ci_068                -4.826687e-03 3 1  ON 67
ci_069                -4.898554e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1395
    reference variance = 0.417051
====================================================
  Execution time = 1.4126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1088e-01
  Total weights = 1.957116043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298506621508
                                         uncertainty =       0.001891212393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298506621508
                                         uncertainty =       0.001891212393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386300259
  error estimate for blocks of size 2^( 2) =       0.000396369448
  error estimate for blocks of size 2^( 3) =       0.000405468315
  error estimate for blocks of size 2^( 4) =       0.000411996742
  error estimate for blocks of size 2^( 5) =       0.000417037622
  error estimate for blocks of size 2^( 6) =       0.000418994444
  error estimate for blocks of size 2^( 7) =       0.000418547152

      target function =                  N/A
              le_mean =     -17.216640119630
             les_mean =     296.723579764526
             stat err =       0.000416643990
             autocorr =       1.163269241276
              std dev =       0.546311065122
             le_variance =       0.298455779874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664011963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640119685       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640458516       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216640384705       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 8.326242e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640119685       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640208594       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216640190926       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.174489e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216640119685       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216640142192       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216640137834       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 5.497961e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6678e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.039473e-02 3 1  ON 0
ci_002                -3.034305e-02 3 1  ON 1
ci_003                -2.472797e-02 3 1  ON 2
ci_004                 2.093388e-02 3 1  ON 3
ci_005                 2.072123e-02 3 1  ON 4
ci_006                -1.938782e-02 3 1  ON 5
ci_007                -1.945253e-02 3 1  ON 6
ci_008                -1.836128e-02 3 1  ON 7
ci_009                -1.800667e-02 3 1  ON 8
ci_010                -1.700552e-02 3 1  ON 9
ci_011                -1.655966e-02 3 1  ON 10
ci_012                -1.612611e-02 3 1  ON 11
ci_013                -1.912302e-02 3 1  ON 12
ci_014                 1.397665e-02 3 1  ON 13
ci_015                 1.433806e-02 3 1  ON 14
ci_016                 1.664768e-02 3 1  ON 15
ci_017                 1.656367e-02 3 1  ON 16
ci_018                 1.297058e-02 3 1  ON 17
ci_019                 1.325613e-02 3 1  ON 18
ci_020                 1.293184e-02 3 1  ON 19
ci_021                 1.353832e-02 3 1  ON 20
ci_022                 1.133530e-02 3 1  ON 21
ci_023                 1.120893e-02 3 1  ON 22
ci_024                 1.087041e-02 3 1  ON 23
ci_025                 1.162455e-02 3 1  ON 24
ci_026                 1.149338e-02 3 1  ON 25
ci_027                 1.112273e-02 3 1  ON 26
ci_028                -1.435677e-02 3 1  ON 27
ci_029                -1.441924e-02 3 1  ON 28
ci_030                -1.098792e-02 3 1  ON 29
ci_031                -1.105616e-02 3 1  ON 30
ci_032                -1.346354e-02 3 1  ON 31
ci_033                 1.056533e-02 3 1  ON 32
ci_034                 9.912911e-03 3 1  ON 33
ci_035                -4.648524e-03 3 1  ON 34
ci_036                -1.104187e-02 3 1  ON 35
ci_037                -1.056009e-02 3 1  ON 36
ci_038                 1.171964e-03 3 1  ON 37
ci_039                 1.299525e-03 3 1  ON 38
ci_040                -4.126449e-03 3 1  ON 39
ci_041                 9.869114e-03 3 1  ON 40
ci_042                 9.849571e-03 3 1  ON 41
ci_043                -3.015394e-03 3 1  ON 42
ci_044                -1.480083e-02 3 1  ON 43
ci_045                -1.424447e-03 3 1  ON 44
ci_046                 5.652240e-03 3 1  ON 45
ci_047                 5.452171e-03 3 1  ON 46
ci_048                -1.172226e-02 3 1  ON 47
ci_049                -1.210277e-02 3 1  ON 48
ci_050                 7.745386e-03 3 1  ON 49
ci_051                 7.471605e-03 3 1  ON 50
ci_052                -6.832417e-03 3 1  ON 51
ci_053                -6.944168e-03 3 1  ON 52
ci_054                -1.931524e-03 3 1  ON 53
ci_055                -2.075808e-03 3 1  ON 54
ci_056                 4.785025e-03 3 1  ON 55
ci_057                 5.076815e-03 3 1  ON 56
ci_058                -6.974624e-03 3 1  ON 57
ci_059                -6.690916e-03 3 1  ON 58
ci_060                 8.292372e-03 3 1  ON 59
ci_061                 8.930925e-03 3 1  ON 60
ci_062                -2.775207e-03 3 1  ON 61
ci_063                -2.570134e-03 3 1  ON 62
ci_064                -3.267900e-03 3 1  ON 63
ci_065                -4.306431e-03 3 1  ON 64
ci_066                 5.685765e-03 3 1  ON 65
ci_067                 6.012896e-03 3 1  ON 66
ci_068                -4.821952e-03 3 1  ON 67
ci_069                -4.903019e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2525
    reference variance = 0.275756
====================================================
  Execution time = 1.8762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1559e-01
  Total weights = 1.9569e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414831508
                                         uncertainty =       0.002023123546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299414831508
                                         uncertainty =       0.002023123546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386924935
  error estimate for blocks of size 2^( 2) =       0.000396495986
  error estimate for blocks of size 2^( 3) =       0.000404951763
  error estimate for blocks of size 2^( 4) =       0.000411505427
  error estimate for blocks of size 2^( 5) =       0.000415176515
  error estimate for blocks of size 2^( 6) =       0.000418160051
  error estimate for blocks of size 2^( 7) =       0.000418542236

      target function =                  N/A
              le_mean =     -17.216714347371
             les_mean =     296.730915861896
             stat err =       0.000415846057
             autocorr =       1.155079140827
              std dev =       0.547194490038
             le_variance =       0.299421809928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299351538448
                                         uncertainty =       0.002021183490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299351538448
                                         uncertainty =       0.002021183490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386883742
  error estimate for blocks of size 2^( 2) =       0.000396457460
  error estimate for blocks of size 2^( 3) =       0.000404914021
  error estimate for blocks of size 2^( 4) =       0.000411468347
  error estimate for blocks of size 2^( 5) =       0.000415137249
  error estimate for blocks of size 2^( 6) =       0.000418121372
  error estimate for blocks of size 2^( 7) =       0.000418496379

      target function =                  N/A
              le_mean =     -17.216714894392
             les_mean =     296.730721564327
             stat err =       0.000415805837
             autocorr =       1.155101648550
              std dev =       0.547136234435
             le_variance =       0.299358059031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299380669475
                                         uncertainty =       0.002022083273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299380669475
                                         uncertainty =       0.002022083273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386902706
  error estimate for blocks of size 2^( 2) =       0.000396475187
  error estimate for blocks of size 2^( 3) =       0.000404931412
  error estimate for blocks of size 2^( 4) =       0.000411485428
  error estimate for blocks of size 2^( 5) =       0.000415155365
  error estimate for blocks of size 2^( 6) =       0.000418139310
  error estimate for blocks of size 2^( 7) =       0.000418517738

      target function =                  N/A
              le_mean =     -17.216714579279
             les_mean =     296.730953428605
             stat err =       0.000415824460
             autocorr =       1.155091880374
              std dev =       0.547163053872
             le_variance =       0.299387407523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299410436663
                                         uncertainty =       0.002022990403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299410436663
                                         uncertainty =       0.002022990403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386922075
  error estimate for blocks of size 2^( 2) =       0.000396493310
  error estimate for blocks of size 2^( 3) =       0.000404949142
  error estimate for blocks of size 2^( 4) =       0.000411502853
  error estimate for blocks of size 2^( 5) =       0.000415173792
  error estimate for blocks of size 2^( 6) =       0.000418157380
  error estimate for blocks of size 2^( 7) =       0.000418539094

      target function =                  N/A
              le_mean =     -17.216714369036
             les_mean =     296.730898167423
             stat err =       0.000415843280
             autocorr =       1.155080781544
              std dev =       0.547190446409
             le_variance =       0.299417384641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216714347371        initial
     3.8147e+00     3.8147e+01             8.3262e-05       -17.216714894392  <--
     1.5259e+01     1.5259e+02             2.1745e-05       -17.216714579279
     6.1035e+01     6.1035e+02             5.4980e-06       -17.216714369036

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.8097e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946252e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910558e-02 3 1  ON 12
ci_014                 1.398062e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656809e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162869e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442072e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056891e-02 3 1  ON 32
ci_034                 9.924617e-03 3 1  ON 33
ci_035                -4.665767e-03 3 1  ON 34
ci_036                -1.103192e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187972e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156067e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011292e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449710e-03 3 1  ON 44
ci_046                 5.624733e-03 3 1  ON 45
ci_047                 5.443145e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705341e-03 3 1  ON 49
ci_051                 7.483232e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903355e-03 3 1  ON 52
ci_054                -1.948240e-03 3 1  ON 53
ci_055                -2.070368e-03 3 1  ON 54
ci_056                 4.809998e-03 3 1  ON 55
ci_057                 5.042259e-03 3 1  ON 56
ci_058                -6.978921e-03 3 1  ON 57
ci_059                -6.701012e-03 3 1  ON 58
ci_060                 8.316098e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764342e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252299e-03 3 1  ON 63
ci_065                -4.297562e-03 3 1  ON 64
ci_066                 5.676597e-03 3 1  ON 65
ci_067                 5.970754e-03 3 1  ON 66
ci_068                -4.808719e-03 3 1  ON 67
ci_069                -4.915506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.307297
====================================================
  Execution time = 1.4161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1277e-01
  Total weights = 1.956759086e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299328542237
                                         uncertainty =       0.002302597881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299328542237
                                         uncertainty =       0.002302597881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386945485
  error estimate for blocks of size 2^( 2) =       0.000396608219
  error estimate for blocks of size 2^( 3) =       0.000405217650
  error estimate for blocks of size 2^( 4) =       0.000411793263
  error estimate for blocks of size 2^( 5) =       0.000415631642
  error estimate for blocks of size 2^( 6) =       0.000418117075
  error estimate for blocks of size 2^( 7) =       0.000420533842

      target function =                  N/A
              le_mean =     -17.215775574989
             les_mean =     296.695695022090
             stat err =       0.000416518956
             autocorr =       1.158697247032
              std dev =       0.547223552241
             le_variance =       0.299453616127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577557499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775575020       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215778583888       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215778694319       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215778677449       residual = 1.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.642365e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775575020       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215776461734       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215776480765       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215776478355       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.740291e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775575020       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215775807071       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215775811197       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215775810580       residual = 3.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.021699e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6765e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.037229e-02 3 1  ON 0
ci_002                -3.036565e-02 3 1  ON 1
ci_003                -2.471405e-02 3 1  ON 2
ci_004                 2.098894e-02 3 1  ON 3
ci_005                 2.080202e-02 3 1  ON 4
ci_006                -1.930835e-02 3 1  ON 5
ci_007                -1.945683e-02 3 1  ON 6
ci_008                -1.827833e-02 3 1  ON 7
ci_009                -1.797224e-02 3 1  ON 8
ci_010                -1.704532e-02 3 1  ON 9
ci_011                -1.653661e-02 3 1  ON 10
ci_012                -1.616966e-02 3 1  ON 11
ci_013                -1.911347e-02 3 1  ON 12
ci_014                 1.400619e-02 3 1  ON 13
ci_015                 1.427581e-02 3 1  ON 14
ci_016                 1.662660e-02 3 1  ON 15
ci_017                 1.654461e-02 3 1  ON 16
ci_018                 1.299273e-02 3 1  ON 17
ci_019                 1.325958e-02 3 1  ON 18
ci_020                 1.298126e-02 3 1  ON 19
ci_021                 1.353908e-02 3 1  ON 20
ci_022                 1.131345e-02 3 1  ON 21
ci_023                 1.117865e-02 3 1  ON 22
ci_024                 1.090325e-02 3 1  ON 23
ci_025                 1.160051e-02 3 1  ON 24
ci_026                 1.152958e-02 3 1  ON 25
ci_027                 1.117737e-02 3 1  ON 26
ci_028                -1.433494e-02 3 1  ON 27
ci_029                -1.442276e-02 3 1  ON 28
ci_030                -1.101577e-02 3 1  ON 29
ci_031                -1.106513e-02 3 1  ON 30
ci_032                -1.348036e-02 3 1  ON 31
ci_033                 1.053143e-02 3 1  ON 32
ci_034                 9.925147e-03 3 1  ON 33
ci_035                -4.644371e-03 3 1  ON 34
ci_036                -1.104859e-02 3 1  ON 35
ci_037                -1.051819e-02 3 1  ON 36
ci_038                 1.181858e-03 3 1  ON 37
ci_039                 1.329722e-03 3 1  ON 38
ci_040                -4.106766e-03 3 1  ON 39
ci_041                 9.859000e-03 3 1  ON 40
ci_042                 9.847249e-03 3 1  ON 41
ci_043                -3.019006e-03 3 1  ON 42
ci_044                -1.485778e-02 3 1  ON 43
ci_045                -1.453693e-03 3 1  ON 44
ci_046                 5.642711e-03 3 1  ON 45
ci_047                 5.407544e-03 3 1  ON 46
ci_048                -1.174857e-02 3 1  ON 47
ci_049                -1.211038e-02 3 1  ON 48
ci_050                 7.700104e-03 3 1  ON 49
ci_051                 7.481722e-03 3 1  ON 50
ci_052                -6.865527e-03 3 1  ON 51
ci_053                -6.928700e-03 3 1  ON 52
ci_054                -1.986794e-03 3 1  ON 53
ci_055                -2.076301e-03 3 1  ON 54
ci_056                 4.799057e-03 3 1  ON 55
ci_057                 5.009044e-03 3 1  ON 56
ci_058                -6.957171e-03 3 1  ON 57
ci_059                -6.699569e-03 3 1  ON 58
ci_060                 8.307616e-03 3 1  ON 59
ci_061                 8.857823e-03 3 1  ON 60
ci_062                -2.738162e-03 3 1  ON 61
ci_063                -2.578356e-03 3 1  ON 62
ci_064                -3.250062e-03 3 1  ON 63
ci_065                -4.266475e-03 3 1  ON 64
ci_066                 5.672594e-03 3 1  ON 65
ci_067                 5.990098e-03 3 1  ON 66
ci_068                -4.784091e-03 3 1  ON 67
ci_069                -4.891266e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2371
    reference variance = 0.196506
====================================================
  Execution time = 1.5877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2328e-01
  Total weights = 1.9567e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300722422782
                                         uncertainty =       0.002248790590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300722422782
                                         uncertainty =       0.002248790590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387690871
  error estimate for blocks of size 2^( 2) =       0.000397155871
  error estimate for blocks of size 2^( 3) =       0.000406126962
  error estimate for blocks of size 2^( 4) =       0.000412675530
  error estimate for blocks of size 2^( 5) =       0.000416689318
  error estimate for blocks of size 2^( 6) =       0.000419081095
  error estimate for blocks of size 2^( 7) =       0.000420560133

      target function =                  N/A
              le_mean =     -17.217047730935
             les_mean =     296.750038015741
             stat err =       0.000417251519
             autocorr =       1.158309728973
              std dev =       0.548277687562
             le_variance =       0.300608422678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300663369995
                                         uncertainty =       0.002236309996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300663369995
                                         uncertainty =       0.002236309996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387652741
  error estimate for blocks of size 2^( 2) =       0.000397119302
  error estimate for blocks of size 2^( 3) =       0.000406093752
  error estimate for blocks of size 2^( 4) =       0.000412642047
  error estimate for blocks of size 2^( 5) =       0.000416656757
  error estimate for blocks of size 2^( 6) =       0.000419053929
  error estimate for blocks of size 2^( 7) =       0.000420531319

      target function =                  N/A
              le_mean =     -17.217045850871
             les_mean =     296.754042212000
             stat err =       0.000417221013
             autocorr =       1.158368204253
              std dev =       0.548223764036
             le_variance =       0.300549295453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682758550
                                         uncertainty =       0.002242112036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682758550
                                         uncertainty =       0.002242112036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387665264
  error estimate for blocks of size 2^( 2) =       0.000397131460
  error estimate for blocks of size 2^( 3) =       0.000406104924
  error estimate for blocks of size 2^( 4) =       0.000412652748
  error estimate for blocks of size 2^( 5) =       0.000416666259
  error estimate for blocks of size 2^( 6) =       0.000419060413
  error estimate for blocks of size 2^( 7) =       0.000420538654

      target function =                  N/A
              le_mean =     -17.217046715372
             les_mean =     296.750504449869
             stat err =       0.000417229519
             autocorr =       1.158340592942
              std dev =       0.548241474097
             le_variance =       0.300568713920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300716668988
                                         uncertainty =       0.002247934972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300716668988
                                         uncertainty =       0.002247934972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387687157
  error estimate for blocks of size 2^( 2) =       0.000397152301
  error estimate for blocks of size 2^( 3) =       0.000406123715
  error estimate for blocks of size 2^( 4) =       0.000412672255
  error estimate for blocks of size 2^( 5) =       0.000416686027
  error estimate for blocks of size 2^( 6) =       0.000419078112
  error estimate for blocks of size 2^( 7) =       0.000420556929

      target function =                  N/A
              le_mean =     -17.217047562327
             les_mean =     296.749997841754
             stat err =       0.000417248331
             autocorr =       1.158314219380
              std dev =       0.548272434872
             le_variance =       0.300602662840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217047730935        initial  <--
     9.5367e-01     9.5367e+00             2.6424e-04       -17.217045850871
     3.8147e+00     3.8147e+01             7.7403e-05       -17.217046715372
     1.5259e+01     1.5259e+02             2.0217e-05       -17.217047562327

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.2729
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946252e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910558e-02 3 1  ON 12
ci_014                 1.398062e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656809e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162869e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442072e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056891e-02 3 1  ON 32
ci_034                 9.924617e-03 3 1  ON 33
ci_035                -4.665767e-03 3 1  ON 34
ci_036                -1.103192e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187972e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156067e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011292e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449710e-03 3 1  ON 44
ci_046                 5.624733e-03 3 1  ON 45
ci_047                 5.443145e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705341e-03 3 1  ON 49
ci_051                 7.483232e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903355e-03 3 1  ON 52
ci_054                -1.948240e-03 3 1  ON 53
ci_055                -2.070368e-03 3 1  ON 54
ci_056                 4.809998e-03 3 1  ON 55
ci_057                 5.042259e-03 3 1  ON 56
ci_058                -6.978921e-03 3 1  ON 57
ci_059                -6.701012e-03 3 1  ON 58
ci_060                 8.316098e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764342e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252299e-03 3 1  ON 63
ci_065                -4.297562e-03 3 1  ON 64
ci_066                 5.676597e-03 3 1  ON 65
ci_067                 5.970754e-03 3 1  ON 66
ci_068                -4.808719e-03 3 1  ON 67
ci_069                -4.915506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.161233
====================================================
  Execution time = 1.4192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1564e-01
  Total weights = 1.956901089e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300859189208
                                         uncertainty =       0.002045769424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300859189208
                                         uncertainty =       0.002045769424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387887837
  error estimate for blocks of size 2^( 2) =       0.000397850480
  error estimate for blocks of size 2^( 3) =       0.000406455037
  error estimate for blocks of size 2^( 4) =       0.000413053911
  error estimate for blocks of size 2^( 5) =       0.000416646868
  error estimate for blocks of size 2^( 6) =       0.000418740563
  error estimate for blocks of size 2^( 7) =       0.000420977745

      target function =                  N/A
              le_mean =     -17.216499951803
             les_mean =     296.723510376844
             stat err =       0.000417354772
             autocorr =       1.157706423507
              std dev =       0.548556239916
             le_variance =       0.300913948351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649995180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499951855       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499741514       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499737215       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499740691       residual = 3.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 3.531528e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499951855       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499898250       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499896741       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499897515       residual = 3.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 8.988063e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216499951855       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499938389       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499937983       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499938169       residual = 3.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 2.257198e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6705e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.040368e-02 3 1  ON 0
ci_002                -3.037345e-02 3 1  ON 1
ci_003                -2.467923e-02 3 1  ON 2
ci_004                 2.096237e-02 3 1  ON 3
ci_005                 2.076990e-02 3 1  ON 4
ci_006                -1.937863e-02 3 1  ON 5
ci_007                -1.946239e-02 3 1  ON 6
ci_008                -1.831208e-02 3 1  ON 7
ci_009                -1.797603e-02 3 1  ON 8
ci_010                -1.699617e-02 3 1  ON 9
ci_011                -1.660984e-02 3 1  ON 10
ci_012                -1.617100e-02 3 1  ON 11
ci_013                -1.910440e-02 3 1  ON 12
ci_014                 1.397163e-02 3 1  ON 13
ci_015                 1.427024e-02 3 1  ON 14
ci_016                 1.660588e-02 3 1  ON 15
ci_017                 1.656647e-02 3 1  ON 16
ci_018                 1.294909e-02 3 1  ON 17
ci_019                 1.325293e-02 3 1  ON 18
ci_020                 1.295575e-02 3 1  ON 19
ci_021                 1.353504e-02 3 1  ON 20
ci_022                 1.132216e-02 3 1  ON 21
ci_023                 1.118607e-02 3 1  ON 22
ci_024                 1.089044e-02 3 1  ON 23
ci_025                 1.162490e-02 3 1  ON 24
ci_026                 1.151859e-02 3 1  ON 25
ci_027                 1.114992e-02 3 1  ON 26
ci_028                -1.433791e-02 3 1  ON 27
ci_029                -1.442019e-02 3 1  ON 28
ci_030                -1.099209e-02 3 1  ON 29
ci_031                -1.104257e-02 3 1  ON 30
ci_032                -1.343957e-02 3 1  ON 31
ci_033                 1.056623e-02 3 1  ON 32
ci_034                 9.925140e-03 3 1  ON 33
ci_035                -4.668318e-03 3 1  ON 34
ci_036                -1.102521e-02 3 1  ON 35
ci_037                -1.052410e-02 3 1  ON 36
ci_038                 1.185282e-03 3 1  ON 37
ci_039                 1.318435e-03 3 1  ON 38
ci_040                -4.152792e-03 3 1  ON 39
ci_041                 9.849299e-03 3 1  ON 40
ci_042                 9.837002e-03 3 1  ON 41
ci_043                -3.008851e-03 3 1  ON 42
ci_044                -1.482667e-02 3 1  ON 43
ci_045                -1.449472e-03 3 1  ON 44
ci_046                 5.620003e-03 3 1  ON 45
ci_047                 5.441236e-03 3 1  ON 46
ci_048                -1.175405e-02 3 1  ON 47
ci_049                -1.211616e-02 3 1  ON 48
ci_050                 7.700819e-03 3 1  ON 49
ci_051                 7.488737e-03 3 1  ON 50
ci_052                -6.825199e-03 3 1  ON 51
ci_053                -6.900414e-03 3 1  ON 52
ci_054                -1.948566e-03 3 1  ON 53
ci_055                -2.067960e-03 3 1  ON 54
ci_056                 4.810416e-03 3 1  ON 55
ci_057                 5.042507e-03 3 1  ON 56
ci_058                -6.976089e-03 3 1  ON 57
ci_059                -6.705364e-03 3 1  ON 58
ci_060                 8.317335e-03 3 1  ON 59
ci_061                 8.900780e-03 3 1  ON 60
ci_062                -2.760699e-03 3 1  ON 61
ci_063                -2.607681e-03 3 1  ON 62
ci_064                -3.247393e-03 3 1  ON 63
ci_065                -4.293537e-03 3 1  ON 64
ci_066                 5.675750e-03 3 1  ON 65
ci_067                 5.967904e-03 3 1  ON 66
ci_068                -4.803871e-03 3 1  ON 67
ci_069                -4.913759e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.198
    reference variance = 0.235421
====================================================
  Execution time = 1.3629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1279e-01
  Total weights = 1.9568e+06
  Execution time = 1.8595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300565334152
                                         uncertainty =       0.001942378902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300565334152
                                         uncertainty =       0.001942378902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387675480
  error estimate for blocks of size 2^( 2) =       0.000397511393
  error estimate for blocks of size 2^( 3) =       0.000406014676
  error estimate for blocks of size 2^( 4) =       0.000411614974
  error estimate for blocks of size 2^( 5) =       0.000416163729
  error estimate for blocks of size 2^( 6) =       0.000417814877
  error estimate for blocks of size 2^( 7) =       0.000419502711

      target function =                  N/A
              le_mean =     -17.217171094807
             les_mean =     296.743771179040
             stat err =       0.000416274073
             autocorr =       1.152980755333
              std dev =       0.548255921067
             le_variance =       0.300584554986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300547612100
                                         uncertainty =       0.001940983604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300547612100
                                         uncertainty =       0.001940983604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387664103
  error estimate for blocks of size 2^( 2) =       0.000397500677
  error estimate for blocks of size 2^( 3) =       0.000406004158
  error estimate for blocks of size 2^( 4) =       0.000411605080
  error estimate for blocks of size 2^( 5) =       0.000416153951
  error estimate for blocks of size 2^( 6) =       0.000417805857
  error estimate for blocks of size 2^( 7) =       0.000419495590

      target function =                  N/A
              le_mean =     -17.217170924283
             les_mean =     296.743761519226
             stat err =       0.000416265119
             autocorr =       1.152998826628
              std dev =       0.548239832732
             le_variance =       0.300566914194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556182081
                                         uncertainty =       0.001941664825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556182081
                                         uncertainty =       0.001941664825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387669604
  error estimate for blocks of size 2^( 2) =       0.000397505855
  error estimate for blocks of size 2^( 3) =       0.000406009242
  error estimate for blocks of size 2^( 4) =       0.000411609858
  error estimate for blocks of size 2^( 5) =       0.000416158670
  error estimate for blocks of size 2^( 6) =       0.000417810203
  error estimate for blocks of size 2^( 7) =       0.000419499011

      target function =                  N/A
              le_mean =     -17.217170998766
             les_mean =     296.743761538267
             stat err =       0.000416269436
             autocorr =       1.152990015518
              std dev =       0.548247611993
             le_variance =       0.300575444056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300564174716
                                         uncertainty =       0.001942288907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300564174716
                                         uncertainty =       0.001942288907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387674735
  error estimate for blocks of size 2^( 2) =       0.000397510691
  error estimate for blocks of size 2^( 3) =       0.000406013987
  error estimate for blocks of size 2^( 4) =       0.000411614325
  error estimate for blocks of size 2^( 5) =       0.000416163087
  error estimate for blocks of size 2^( 6) =       0.000417814283
  error estimate for blocks of size 2^( 7) =       0.000419502240

      target function =                  N/A
              le_mean =     -17.217171081677
             les_mean =     296.743769517613
             stat err =       0.000416273484
             autocorr =       1.152981920335
              std dev =       0.548254868385
             le_variance =       0.300583400708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217171094807        initial  <--
     9.5367e+00     9.5367e+01             3.5315e-05       -17.217170924283
     3.8147e+01     3.8147e+02             8.9881e-06       -17.217170998766
     1.5259e+02     1.5259e+03             2.2572e-06       -17.217171081677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0837
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946252e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910558e-02 3 1  ON 12
ci_014                 1.398062e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656809e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162869e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442072e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056891e-02 3 1  ON 32
ci_034                 9.924617e-03 3 1  ON 33
ci_035                -4.665767e-03 3 1  ON 34
ci_036                -1.103192e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187972e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156067e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011292e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449710e-03 3 1  ON 44
ci_046                 5.624733e-03 3 1  ON 45
ci_047                 5.443145e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705341e-03 3 1  ON 49
ci_051                 7.483232e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903355e-03 3 1  ON 52
ci_054                -1.948240e-03 3 1  ON 53
ci_055                -2.070368e-03 3 1  ON 54
ci_056                 4.809998e-03 3 1  ON 55
ci_057                 5.042259e-03 3 1  ON 56
ci_058                -6.978921e-03 3 1  ON 57
ci_059                -6.701012e-03 3 1  ON 58
ci_060                 8.316098e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764342e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252299e-03 3 1  ON 63
ci_065                -4.297562e-03 3 1  ON 64
ci_066                 5.676597e-03 3 1  ON 65
ci_067                 5.970754e-03 3 1  ON 66
ci_068                -4.808719e-03 3 1  ON 67
ci_069                -4.915506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.129221
====================================================
  Execution time = 1.4077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1751e-01
  Total weights = 1.956961870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303623818615
                                         uncertainty =       0.002527822196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303623818615
                                         uncertainty =       0.002527822196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389590681
  error estimate for blocks of size 2^( 2) =       0.000399237318
  error estimate for blocks of size 2^( 3) =       0.000408132679
  error estimate for blocks of size 2^( 4) =       0.000414070265
  error estimate for blocks of size 2^( 5) =       0.000418071024
  error estimate for blocks of size 2^( 6) =       0.000419037181
  error estimate for blocks of size 2^( 7) =       0.000418789483

      target function =                  N/A
              le_mean =     -17.216566710767
             les_mean =     296.727681382567
             stat err =       0.000417491988
             autocorr =       1.148362949152
              std dev =       0.550964424666
             le_variance =       0.303561797247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656671077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566710810       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566727519       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566725363       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566725057       residual = 5.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 4.801216e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566710810       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566714996       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566714456       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566714377       residual = 5.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 1.202622e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566710810       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566711857       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566711722       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566711702       residual = 5.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 3.008008e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6604e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.039754e-02 3 1  ON 0
ci_002                -3.037435e-02 3 1  ON 1
ci_003                -2.467440e-02 3 1  ON 2
ci_004                 2.095829e-02 3 1  ON 3
ci_005                 2.076885e-02 3 1  ON 4
ci_006                -1.938263e-02 3 1  ON 5
ci_007                -1.946323e-02 3 1  ON 6
ci_008                -1.831380e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699946e-02 3 1  ON 9
ci_011                -1.661332e-02 3 1  ON 10
ci_012                -1.617140e-02 3 1  ON 11
ci_013                -1.910530e-02 3 1  ON 12
ci_014                 1.398109e-02 3 1  ON 13
ci_015                 1.427557e-02 3 1  ON 14
ci_016                 1.660724e-02 3 1  ON 15
ci_017                 1.656787e-02 3 1  ON 16
ci_018                 1.295459e-02 3 1  ON 17
ci_019                 1.325140e-02 3 1  ON 18
ci_020                 1.295355e-02 3 1  ON 19
ci_021                 1.353452e-02 3 1  ON 20
ci_022                 1.131985e-02 3 1  ON 21
ci_023                 1.118505e-02 3 1  ON 22
ci_024                 1.088934e-02 3 1  ON 23
ci_025                 1.162898e-02 3 1  ON 24
ci_026                 1.152000e-02 3 1  ON 25
ci_027                 1.114336e-02 3 1  ON 26
ci_028                -1.434239e-02 3 1  ON 27
ci_029                -1.442059e-02 3 1  ON 28
ci_030                -1.098879e-02 3 1  ON 29
ci_031                -1.103879e-02 3 1  ON 30
ci_032                -1.343791e-02 3 1  ON 31
ci_033                 1.056877e-02 3 1  ON 32
ci_034                 9.924862e-03 3 1  ON 33
ci_035                -4.665887e-03 3 1  ON 34
ci_036                -1.103160e-02 3 1  ON 35
ci_037                -1.052502e-02 3 1  ON 36
ci_038                 1.187921e-03 3 1  ON 37
ci_039                 1.317925e-03 3 1  ON 38
ci_040                -4.155734e-03 3 1  ON 39
ci_041                 9.843653e-03 3 1  ON 40
ci_042                 9.838548e-03 3 1  ON 41
ci_043                -3.011751e-03 3 1  ON 42
ci_044                -1.482497e-02 3 1  ON 43
ci_045                -1.449679e-03 3 1  ON 44
ci_046                 5.624969e-03 3 1  ON 45
ci_047                 5.442883e-03 3 1  ON 46
ci_048                -1.175111e-02 3 1  ON 47
ci_049                -1.211621e-02 3 1  ON 48
ci_050                 7.705057e-03 3 1  ON 49
ci_051                 7.483415e-03 3 1  ON 50
ci_052                -6.823332e-03 3 1  ON 51
ci_053                -6.902899e-03 3 1  ON 52
ci_054                -1.948566e-03 3 1  ON 53
ci_055                -2.070671e-03 3 1  ON 54
ci_056                 4.809714e-03 3 1  ON 55
ci_057                 5.042459e-03 3 1  ON 56
ci_058                -6.979051e-03 3 1  ON 57
ci_059                -6.701084e-03 3 1  ON 58
ci_060                 8.316201e-03 3 1  ON 59
ci_061                 8.895015e-03 3 1  ON 60
ci_062                -2.764335e-03 3 1  ON 61
ci_063                -2.603842e-03 3 1  ON 62
ci_064                -3.251787e-03 3 1  ON 63
ci_065                -4.297932e-03 3 1  ON 64
ci_066                 5.676755e-03 3 1  ON 65
ci_067                 5.970324e-03 3 1  ON 66
ci_068                -4.808849e-03 3 1  ON 67
ci_069                -4.916044e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.211
    reference variance = 0.260351
====================================================
  Execution time = 1.3565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1290e-01
  Total weights = 1.9564e+06
  Execution time = 1.8608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298045355759
                                         uncertainty =       0.002067589297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298045355759
                                         uncertainty =       0.002067589297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386123680
  error estimate for blocks of size 2^( 2) =       0.000396283166
  error estimate for blocks of size 2^( 3) =       0.000405019393
  error estimate for blocks of size 2^( 4) =       0.000411826189
  error estimate for blocks of size 2^( 5) =       0.000415443742
  error estimate for blocks of size 2^( 6) =       0.000416766541
  error estimate for blocks of size 2^( 7) =       0.000417819423

      target function =                  N/A
              le_mean =     -17.216563695421
             les_mean =     296.722960121635
             stat err =       0.000415463974
             autocorr =       1.157747543669
              std dev =       0.546061344958
             le_variance =       0.298182992457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298043915274
                                         uncertainty =       0.002067506694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298043915274
                                         uncertainty =       0.002067506694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386122755
  error estimate for blocks of size 2^( 2) =       0.000396282227
  error estimate for blocks of size 2^( 3) =       0.000405018472
  error estimate for blocks of size 2^( 4) =       0.000411825348
  error estimate for blocks of size 2^( 5) =       0.000415442822
  error estimate for blocks of size 2^( 6) =       0.000416765471
  error estimate for blocks of size 2^( 7) =       0.000417818101

      target function =                  N/A
              le_mean =     -17.216563650873
             les_mean =     296.722964479593
             stat err =       0.000415462935
             autocorr =       1.157747305316
              std dev =       0.546060036457
             le_variance =       0.298181563415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298044632800
                                         uncertainty =       0.002067547920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298044632800
                                         uncertainty =       0.002067547920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386123216
  error estimate for blocks of size 2^( 2) =       0.000396282695
  error estimate for blocks of size 2^( 3) =       0.000405018931
  error estimate for blocks of size 2^( 4) =       0.000411825767
  error estimate for blocks of size 2^( 5) =       0.000415443280
  error estimate for blocks of size 2^( 6) =       0.000416766004
  error estimate for blocks of size 2^( 7) =       0.000417818760

      target function =                  N/A
              le_mean =     -17.216563672983
             les_mean =     296.722961998961
             stat err =       0.000415463453
             autocorr =       1.157747424888
              std dev =       0.546060688241
             le_variance =       0.298182275243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298045265232
                                         uncertainty =       0.002067584122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298045265232
                                         uncertainty =       0.002067584122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386123622
  error estimate for blocks of size 2^( 2) =       0.000396283107
  error estimate for blocks of size 2^( 3) =       0.000405019335
  error estimate for blocks of size 2^( 4) =       0.000411826137
  error estimate for blocks of size 2^( 5) =       0.000415443684
  error estimate for blocks of size 2^( 6) =       0.000416766474
  error estimate for blocks of size 2^( 7) =       0.000417819340

      target function =                  N/A
              le_mean =     -17.216563692602
             les_mean =     296.722960335698
             stat err =       0.000415463909
             autocorr =       1.157747528867
              std dev =       0.546061262725
             le_variance =       0.298182902649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216563695421        initial  <--
     9.5367e+01     9.5367e+02             4.8012e-06       -17.216563650873
     3.8147e+02     3.8147e+03             1.2026e-06       -17.216563672983
     1.5259e+03     1.5259e+04             3.0080e-07       -17.216563692602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9297
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946252e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910558e-02 3 1  ON 12
ci_014                 1.398062e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656809e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162869e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442072e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056891e-02 3 1  ON 32
ci_034                 9.924617e-03 3 1  ON 33
ci_035                -4.665767e-03 3 1  ON 34
ci_036                -1.103192e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187972e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156067e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011292e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449710e-03 3 1  ON 44
ci_046                 5.624733e-03 3 1  ON 45
ci_047                 5.443145e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705341e-03 3 1  ON 49
ci_051                 7.483232e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903355e-03 3 1  ON 52
ci_054                -1.948240e-03 3 1  ON 53
ci_055                -2.070368e-03 3 1  ON 54
ci_056                 4.809998e-03 3 1  ON 55
ci_057                 5.042259e-03 3 1  ON 56
ci_058                -6.978921e-03 3 1  ON 57
ci_059                -6.701012e-03 3 1  ON 58
ci_060                 8.316098e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764342e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252299e-03 3 1  ON 63
ci_065                -4.297562e-03 3 1  ON 64
ci_066                 5.676597e-03 3 1  ON 65
ci_067                 5.970754e-03 3 1  ON 66
ci_068                -4.808719e-03 3 1  ON 67
ci_069                -4.915506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.366738
====================================================
  Execution time = 1.4304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1184e-01
  Total weights = 1.956603755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298236879420
                                         uncertainty =       0.002188848315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298236879420
                                         uncertainty =       0.002188848315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386181430
  error estimate for blocks of size 2^( 2) =       0.000396041064
  error estimate for blocks of size 2^( 3) =       0.000404567071
  error estimate for blocks of size 2^( 4) =       0.000410631705
  error estimate for blocks of size 2^( 5) =       0.000414535373
  error estimate for blocks of size 2^( 6) =       0.000415531270
  error estimate for blocks of size 2^( 7) =       0.000417431839

      target function =                  N/A
              le_mean =     -17.217230667616
             les_mean =     296.744875573506
             stat err =       0.000414532547
             autocorr =       1.152217581129
              std dev =       0.546143015289
             le_variance =       0.298272193149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721723066762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217230667654       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217230668518       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230668500       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 2.375758e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217230667654       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217230667870       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230667865       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 5.941203e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217230667654       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217230667708       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217230667706       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.485414e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6823e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.039748e-02 3 1  ON 0
ci_002                -3.037396e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076900e-02 3 1  ON 4
ci_006                -1.938232e-02 3 1  ON 5
ci_007                -1.946253e-02 3 1  ON 6
ci_008                -1.831369e-02 3 1  ON 7
ci_009                -1.797221e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661397e-02 3 1  ON 10
ci_012                -1.617185e-02 3 1  ON 11
ci_013                -1.910557e-02 3 1  ON 12
ci_014                 1.398058e-02 3 1  ON 13
ci_015                 1.427652e-02 3 1  ON 14
ci_016                 1.660720e-02 3 1  ON 15
ci_017                 1.656808e-02 3 1  ON 16
ci_018                 1.295413e-02 3 1  ON 17
ci_019                 1.325210e-02 3 1  ON 18
ci_020                 1.295299e-02 3 1  ON 19
ci_021                 1.353478e-02 3 1  ON 20
ci_022                 1.131965e-02 3 1  ON 21
ci_023                 1.118544e-02 3 1  ON 22
ci_024                 1.088929e-02 3 1  ON 23
ci_025                 1.162870e-02 3 1  ON 24
ci_026                 1.152017e-02 3 1  ON 25
ci_027                 1.114291e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442073e-02 3 1  ON 28
ci_030                -1.098895e-02 3 1  ON 29
ci_031                -1.103892e-02 3 1  ON 30
ci_032                -1.343676e-02 3 1  ON 31
ci_033                 1.056887e-02 3 1  ON 32
ci_034                 9.924612e-03 3 1  ON 33
ci_035                -4.665784e-03 3 1  ON 34
ci_036                -1.103191e-02 3 1  ON 35
ci_037                -1.052487e-02 3 1  ON 36
ci_038                 1.188032e-03 3 1  ON 37
ci_039                 1.318029e-03 3 1  ON 38
ci_040                -4.156037e-03 3 1  ON 39
ci_041                 9.843815e-03 3 1  ON 40
ci_042                 9.838804e-03 3 1  ON 41
ci_043                -3.011313e-03 3 1  ON 42
ci_044                -1.482442e-02 3 1  ON 43
ci_045                -1.449750e-03 3 1  ON 44
ci_046                 5.624696e-03 3 1  ON 45
ci_047                 5.443171e-03 3 1  ON 46
ci_048                -1.175066e-02 3 1  ON 47
ci_049                -1.211628e-02 3 1  ON 48
ci_050                 7.705382e-03 3 1  ON 49
ci_051                 7.483251e-03 3 1  ON 50
ci_052                -6.823308e-03 3 1  ON 51
ci_053                -6.903307e-03 3 1  ON 52
ci_054                -1.948202e-03 3 1  ON 53
ci_055                -2.070393e-03 3 1  ON 54
ci_056                 4.809951e-03 3 1  ON 55
ci_057                 5.042290e-03 3 1  ON 56
ci_058                -6.978916e-03 3 1  ON 57
ci_059                -6.701047e-03 3 1  ON 58
ci_060                 8.316102e-03 3 1  ON 59
ci_061                 8.896187e-03 3 1  ON 60
ci_062                -2.764335e-03 3 1  ON 61
ci_063                -2.603932e-03 3 1  ON 62
ci_064                -3.252309e-03 3 1  ON 63
ci_065                -4.297567e-03 3 1  ON 64
ci_066                 5.676609e-03 3 1  ON 65
ci_067                 5.970743e-03 3 1  ON 66
ci_068                -4.808715e-03 3 1  ON 67
ci_069                -4.915523e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.324304
====================================================
  Execution time = 1.3544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1394e-01
  Total weights = 1.9570e+06
  Execution time = 1.8569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057182470
                                         uncertainty =       0.002312305534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057182470
                                         uncertainty =       0.002312305534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388020925
  error estimate for blocks of size 2^( 2) =       0.000397583465
  error estimate for blocks of size 2^( 3) =       0.000406084664
  error estimate for blocks of size 2^( 4) =       0.000412450843
  error estimate for blocks of size 2^( 5) =       0.000416517034
  error estimate for blocks of size 2^( 6) =       0.000417700424
  error estimate for blocks of size 2^( 7) =       0.000418504296

      target function =                  N/A
              le_mean =     -17.215923084625
             les_mean =     296.701945235475
             stat err =       0.000416293149
             autocorr =       1.151034217934
              std dev =       0.548744454707
             le_variance =       0.301120476572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057108729
                                         uncertainty =       0.002312314516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057108729
                                         uncertainty =       0.002312314516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388020877
  error estimate for blocks of size 2^( 2) =       0.000397583424
  error estimate for blocks of size 2^( 3) =       0.000406084627
  error estimate for blocks of size 2^( 4) =       0.000412450812
  error estimate for blocks of size 2^( 5) =       0.000416517000
  error estimate for blocks of size 2^( 6) =       0.000417700394
  error estimate for blocks of size 2^( 7) =       0.000418504292

      target function =                  N/A
              le_mean =     -17.215923079226
             les_mean =     296.701945003879
             stat err =       0.000416293124
             autocorr =       1.151034362989
              std dev =       0.548744387212
             le_variance =       0.301120402497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057145591
                                         uncertainty =       0.002312310027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057145591
                                         uncertainty =       0.002312310027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388020901
  error estimate for blocks of size 2^( 2) =       0.000397583445
  error estimate for blocks of size 2^( 3) =       0.000406084646
  error estimate for blocks of size 2^( 4) =       0.000412450828
  error estimate for blocks of size 2^( 5) =       0.000416517017
  error estimate for blocks of size 2^( 6) =       0.000417700409
  error estimate for blocks of size 2^( 7) =       0.000418504294

      target function =                  N/A
              le_mean =     -17.215923081924
             les_mean =     296.701945119563
             stat err =       0.000416293137
             autocorr =       1.151034290477
              std dev =       0.548744420952
             le_variance =       0.301120439526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057177859
                                         uncertainty =       0.002312306096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301057177859
                                         uncertainty =       0.002312306096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388020922
  error estimate for blocks of size 2^( 2) =       0.000397583463
  error estimate for blocks of size 2^( 3) =       0.000406084662
  error estimate for blocks of size 2^( 4) =       0.000412450841
  error estimate for blocks of size 2^( 5) =       0.000416517032
  error estimate for blocks of size 2^( 6) =       0.000417700422
  error estimate for blocks of size 2^( 7) =       0.000418504295

      target function =                  N/A
              le_mean =     -17.215923084288
             les_mean =     296.701945220975
             stat err =       0.000416293148
             autocorr =       1.151034226991
              std dev =       0.548744450488
             le_variance =       0.301120471941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215923084625        initial  <--
     9.5367e+02     9.5367e+03             2.3758e-07       -17.215923079226
     3.8147e+03     3.8147e+04             5.9412e-08       -17.215923081924
     1.5259e+04     1.5259e+05             1.4854e-08       -17.215923084288

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8884
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467398e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946252e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910558e-02 3 1  ON 12
ci_014                 1.398062e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656809e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162869e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442072e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056891e-02 3 1  ON 32
ci_034                 9.924617e-03 3 1  ON 33
ci_035                -4.665767e-03 3 1  ON 34
ci_036                -1.103192e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187972e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156067e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011292e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449710e-03 3 1  ON 44
ci_046                 5.624733e-03 3 1  ON 45
ci_047                 5.443145e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705341e-03 3 1  ON 49
ci_051                 7.483232e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903355e-03 3 1  ON 52
ci_054                -1.948240e-03 3 1  ON 53
ci_055                -2.070368e-03 3 1  ON 54
ci_056                 4.809998e-03 3 1  ON 55
ci_057                 5.042259e-03 3 1  ON 56
ci_058                -6.978921e-03 3 1  ON 57
ci_059                -6.701012e-03 3 1  ON 58
ci_060                 8.316098e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764342e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252299e-03 3 1  ON 63
ci_065                -4.297562e-03 3 1  ON 64
ci_066                 5.676597e-03 3 1  ON 65
ci_067                 5.970754e-03 3 1  ON 66
ci_068                -4.808719e-03 3 1  ON 67
ci_069                -4.915506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1724
    reference variance = 0.167905
====================================================
  Execution time = 1.4244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1514e-01
  Total weights = 1.956945798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300784975441
                                         uncertainty =       0.002415853770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300784975441
                                         uncertainty =       0.002415853770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387765777
  error estimate for blocks of size 2^( 2) =       0.000397438322
  error estimate for blocks of size 2^( 3) =       0.000406005246
  error estimate for blocks of size 2^( 4) =       0.000412230097
  error estimate for blocks of size 2^( 5) =       0.000417196945
  error estimate for blocks of size 2^( 6) =       0.000419134279
  error estimate for blocks of size 2^( 7) =       0.000420265151

      target function =                  N/A
              le_mean =     -17.217041376342
             les_mean =     296.741652498469
             stat err =       0.000417206618
             autocorr =       1.157613077683
              std dev =       0.548383620157
             le_variance =       0.300724594857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704137634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041376403       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041375603       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041375612       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 4.042517e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041376403       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041376203       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041376205       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 1.010656e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041376403       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041376353       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041376353       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 2.526657e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6772e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467399e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938238e-02 3 1  ON 5
ci_007                -1.946251e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797218e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398063e-02 3 1  ON 13
ci_015                 1.427654e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656808e-02 3 1  ON 16
ci_018                 1.295412e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162868e-02 3 1  ON 24
ci_026                 1.152016e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442073e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056890e-02 3 1  ON 32
ci_034                 9.924618e-03 3 1  ON 33
ci_035                -4.665768e-03 3 1  ON 34
ci_036                -1.103193e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318032e-03 3 1  ON 38
ci_040                -4.156065e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838796e-03 3 1  ON 41
ci_043                -3.011288e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449706e-03 3 1  ON 44
ci_046                 5.624734e-03 3 1  ON 45
ci_047                 5.443143e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705331e-03 3 1  ON 49
ci_051                 7.483229e-03 3 1  ON 50
ci_052                -6.823319e-03 3 1  ON 51
ci_053                -6.903354e-03 3 1  ON 52
ci_054                -1.948241e-03 3 1  ON 53
ci_055                -2.070372e-03 3 1  ON 54
ci_056                 4.809991e-03 3 1  ON 55
ci_057                 5.042256e-03 3 1  ON 56
ci_058                -6.978925e-03 3 1  ON 57
ci_059                -6.701016e-03 3 1  ON 58
ci_060                 8.316099e-03 3 1  ON 59
ci_061                 8.896218e-03 3 1  ON 60
ci_062                -2.764344e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252297e-03 3 1  ON 63
ci_065                -4.297566e-03 3 1  ON 64
ci_066                 5.676596e-03 3 1  ON 65
ci_067                 5.970755e-03 3 1  ON 66
ci_068                -4.808718e-03 3 1  ON 67
ci_069                -4.915505e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.256232
====================================================
  Execution time = 1.3571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1828e-01
  Total weights = 1.9565e+06
  Execution time = 1.8445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427868267
                                         uncertainty =       0.002690676631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427868267
                                         uncertainty =       0.002690676631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390107923
  error estimate for blocks of size 2^( 2) =       0.000400158264
  error estimate for blocks of size 2^( 3) =       0.000408763358
  error estimate for blocks of size 2^( 4) =       0.000415093303
  error estimate for blocks of size 2^( 5) =       0.000419560795
  error estimate for blocks of size 2^( 6) =       0.000423378343
  error estimate for blocks of size 2^( 7) =       0.000424730464

      target function =                  N/A
              le_mean =     -17.216428325071
             les_mean =     296.723686986585
             stat err =       0.000420690726
             autocorr =       1.162937394231
              std dev =       0.551695915166
             le_variance =       0.304368382811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427852354
                                         uncertainty =       0.002690676216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427852354
                                         uncertainty =       0.002690676216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390107913
  error estimate for blocks of size 2^( 2) =       0.000400158254
  error estimate for blocks of size 2^( 3) =       0.000408763349
  error estimate for blocks of size 2^( 4) =       0.000415093293
  error estimate for blocks of size 2^( 5) =       0.000419560785
  error estimate for blocks of size 2^( 6) =       0.000423378333
  error estimate for blocks of size 2^( 7) =       0.000424730456

      target function =                  N/A
              le_mean =     -17.216428325087
             les_mean =     296.723686976707
             stat err =       0.000420690717
             autocorr =       1.162937402722
              std dev =       0.551695900786
             le_variance =       0.304368366944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427860311
                                         uncertainty =       0.002690676423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427860311
                                         uncertainty =       0.002690676423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390107918
  error estimate for blocks of size 2^( 2) =       0.000400158259
  error estimate for blocks of size 2^( 3) =       0.000408763354
  error estimate for blocks of size 2^( 4) =       0.000415093298
  error estimate for blocks of size 2^( 5) =       0.000419560790
  error estimate for blocks of size 2^( 6) =       0.000423378338
  error estimate for blocks of size 2^( 7) =       0.000424730460

      target function =                  N/A
              le_mean =     -17.216428325079
             les_mean =     296.723686981638
             stat err =       0.000420690721
             autocorr =       1.162937398489
              std dev =       0.551695907975
             le_variance =       0.304368374877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427867273
                                         uncertainty =       0.002690676605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304427867273
                                         uncertainty =       0.002690676605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390107922
  error estimate for blocks of size 2^( 2) =       0.000400158263
  error estimate for blocks of size 2^( 3) =       0.000408763358
  error estimate for blocks of size 2^( 4) =       0.000415093302
  error estimate for blocks of size 2^( 5) =       0.000419560794
  error estimate for blocks of size 2^( 6) =       0.000423378342
  error estimate for blocks of size 2^( 7) =       0.000424730464

      target function =                  N/A
              le_mean =     -17.216428325072
             les_mean =     296.723686985966
             stat err =       0.000420690725
             autocorr =       1.162937394771
              std dev =       0.551695914267
             le_variance =       0.304368381819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216428325071        initial
     9.5367e+03     9.5367e+04             4.0425e-08       -17.216428325087  <--
     3.8147e+04     3.8147e+05             1.0107e-08       -17.216428325079
     1.5259e+05     1.5259e+06             2.5267e-09       -17.216428325072

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.2892e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946250e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797217e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910560e-02 3 1  ON 12
ci_014                 1.398063e-02 3 1  ON 13
ci_015                 1.427653e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325213e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162867e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434183e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056890e-02 3 1  ON 32
ci_034                 9.924621e-03 3 1  ON 33
ci_035                -4.665774e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187975e-03 3 1  ON 37
ci_039                 1.318037e-03 3 1  ON 38
ci_040                -4.156058e-03 3 1  ON 39
ci_041                 9.843821e-03 3 1  ON 40
ci_042                 9.838795e-03 3 1  ON 41
ci_043                -3.011274e-03 3 1  ON 42
ci_044                -1.482444e-02 3 1  ON 43
ci_045                -1.449692e-03 3 1  ON 44
ci_046                 5.624737e-03 3 1  ON 45
ci_047                 5.443135e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705301e-03 3 1  ON 49
ci_051                 7.483218e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903352e-03 3 1  ON 52
ci_054                -1.948245e-03 3 1  ON 53
ci_055                -2.070383e-03 3 1  ON 54
ci_056                 4.809969e-03 3 1  ON 55
ci_057                 5.042248e-03 3 1  ON 56
ci_058                -6.978937e-03 3 1  ON 57
ci_059                -6.701027e-03 3 1  ON 58
ci_060                 8.316099e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764351e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252293e-03 3 1  ON 63
ci_065                -4.297576e-03 3 1  ON 64
ci_066                 5.676593e-03 3 1  ON 65
ci_067                 5.970758e-03 3 1  ON 66
ci_068                -4.808716e-03 3 1  ON 67
ci_069                -4.915500e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.3503
    reference variance = 0.337615
====================================================
  Execution time = 1.4191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1417e-01
  Total weights = 1.956605235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299853738644
                                         uncertainty =       0.002018180167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299853738644
                                         uncertainty =       0.002018180167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387157690
  error estimate for blocks of size 2^( 2) =       0.000397128458
  error estimate for blocks of size 2^( 3) =       0.000406080976
  error estimate for blocks of size 2^( 4) =       0.000412854862
  error estimate for blocks of size 2^( 5) =       0.000416425658
  error estimate for blocks of size 2^( 6) =       0.000418503839
  error estimate for blocks of size 2^( 7) =       0.000421454565

      target function =                  N/A
              le_mean =     -17.217127313063
             les_mean =     296.743641506066
             stat err =       0.000417309731
             autocorr =       1.161826408405
              std dev =       0.547523655942
             le_variance =       0.299782153816


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712731306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127313142       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127315237       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127315209       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127315192       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.518166e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127313142       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127313666       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127313659       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127313655       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 3.795828e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217127313142       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127313273       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217127313271       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217127313270       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 9.489829e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6710e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.039752e-02 3 1  ON 0
ci_002                -3.037399e-02 3 1  ON 1
ci_003                -2.467403e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661401e-02 3 1  ON 10
ci_012                -1.617187e-02 3 1  ON 11
ci_013                -1.910561e-02 3 1  ON 12
ci_014                 1.398063e-02 3 1  ON 13
ci_015                 1.427652e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295413e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131959e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162867e-02 3 1  ON 24
ci_026                 1.152014e-02 3 1  ON 25
ci_027                 1.114287e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098895e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056887e-02 3 1  ON 32
ci_034                 9.924632e-03 3 1  ON 33
ci_035                -4.665779e-03 3 1  ON 34
ci_036                -1.103195e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187974e-03 3 1  ON 37
ci_039                 1.318030e-03 3 1  ON 38
ci_040                -4.156061e-03 3 1  ON 39
ci_041                 9.843822e-03 3 1  ON 40
ci_042                 9.838794e-03 3 1  ON 41
ci_043                -3.011286e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449696e-03 3 1  ON 44
ci_046                 5.624718e-03 3 1  ON 45
ci_047                 5.443136e-03 3 1  ON 46
ci_048                -1.175066e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705339e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823324e-03 3 1  ON 51
ci_053                -6.903372e-03 3 1  ON 52
ci_054                -1.948246e-03 3 1  ON 53
ci_055                -2.070395e-03 3 1  ON 54
ci_056                 4.809945e-03 3 1  ON 55
ci_057                 5.042248e-03 3 1  ON 56
ci_058                -6.978961e-03 3 1  ON 57
ci_059                -6.701023e-03 3 1  ON 58
ci_060                 8.316100e-03 3 1  ON 59
ci_061                 8.896190e-03 3 1  ON 60
ci_062                -2.764347e-03 3 1  ON 61
ci_063                -2.603952e-03 3 1  ON 62
ci_064                -3.252259e-03 3 1  ON 63
ci_065                -4.297557e-03 3 1  ON 64
ci_066                 5.676583e-03 3 1  ON 65
ci_067                 5.970753e-03 3 1  ON 66
ci_068                -4.808724e-03 3 1  ON 67
ci_069                -4.915486e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.227
    reference variance = 0.12058
====================================================
  Execution time = 1.3771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1790e-01
  Total weights = 1.9568e+06
  Execution time = 1.8572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036262783
                                         uncertainty =       0.002238290935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036262783
                                         uncertainty =       0.002238290935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387967810
  error estimate for blocks of size 2^( 2) =       0.000397932289
  error estimate for blocks of size 2^( 3) =       0.000406990890
  error estimate for blocks of size 2^( 4) =       0.000413820627
  error estimate for blocks of size 2^( 5) =       0.000418659008
  error estimate for blocks of size 2^( 6) =       0.000421149077
  error estimate for blocks of size 2^( 7) =       0.000420595768

      target function =                  N/A
              le_mean =     -17.216437650050
             les_mean =     296.723624848383
             stat err =       0.000418556120
             autocorr =       1.163900908324
              std dev =       0.548669338089
             le_variance =       0.301038042559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036235491
                                         uncertainty =       0.002238284147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036235491
                                         uncertainty =       0.002238284147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387967792
  error estimate for blocks of size 2^( 2) =       0.000397932275
  error estimate for blocks of size 2^( 3) =       0.000406990879
  error estimate for blocks of size 2^( 4) =       0.000413820617
  error estimate for blocks of size 2^( 5) =       0.000418659001
  error estimate for blocks of size 2^( 6) =       0.000421149068
  error estimate for blocks of size 2^( 7) =       0.000420595760

      target function =                  N/A
              le_mean =     -17.216437647851
             les_mean =     296.723624794492
             stat err =       0.000418556111
             autocorr =       1.163900964018
              std dev =       0.548669313704
             le_variance =       0.301038015800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036249134
                                         uncertainty =       0.002238287541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036249134
                                         uncertainty =       0.002238287541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387967801
  error estimate for blocks of size 2^( 2) =       0.000397932282
  error estimate for blocks of size 2^( 3) =       0.000406990884
  error estimate for blocks of size 2^( 4) =       0.000413820622
  error estimate for blocks of size 2^( 5) =       0.000418659004
  error estimate for blocks of size 2^( 6) =       0.000421149073
  error estimate for blocks of size 2^( 7) =       0.000420595764

      target function =                  N/A
              le_mean =     -17.216437648950
             les_mean =     296.723624821378
             stat err =       0.000418556116
             autocorr =       1.163900936169
              std dev =       0.548669325893
             le_variance =       0.301038029176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036261077
                                         uncertainty =       0.002238290511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301036261077
                                         uncertainty =       0.002238290511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387967809
  error estimate for blocks of size 2^( 2) =       0.000397932288
  error estimate for blocks of size 2^( 3) =       0.000406990889
  error estimate for blocks of size 2^( 4) =       0.000413820626
  error estimate for blocks of size 2^( 5) =       0.000418659008
  error estimate for blocks of size 2^( 6) =       0.000421149076
  error estimate for blocks of size 2^( 7) =       0.000420595768

      target function =                  N/A
              le_mean =     -17.216437649912
             les_mean =     296.723624845001
             stat err =       0.000418556119
             autocorr =       1.163900911805
              std dev =       0.548669336564
             le_variance =       0.301038040886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216437650050        initial  <--
     2.3842e+03     2.3842e+04             1.5182e-07       -17.216437647851
     9.5367e+03     9.5367e+04             3.7958e-08       -17.216437648950
     3.8147e+04     3.8147e+05             9.4898e-09       -17.216437649912

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1167
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076898e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946250e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797217e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910560e-02 3 1  ON 12
ci_014                 1.398063e-02 3 1  ON 13
ci_015                 1.427653e-02 3 1  ON 14
ci_016                 1.660722e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325213e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131960e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088924e-02 3 1  ON 23
ci_025                 1.162867e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434183e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056890e-02 3 1  ON 32
ci_034                 9.924621e-03 3 1  ON 33
ci_035                -4.665774e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052484e-02 3 1  ON 36
ci_038                 1.187975e-03 3 1  ON 37
ci_039                 1.318037e-03 3 1  ON 38
ci_040                -4.156058e-03 3 1  ON 39
ci_041                 9.843821e-03 3 1  ON 40
ci_042                 9.838795e-03 3 1  ON 41
ci_043                -3.011274e-03 3 1  ON 42
ci_044                -1.482444e-02 3 1  ON 43
ci_045                -1.449692e-03 3 1  ON 44
ci_046                 5.624737e-03 3 1  ON 45
ci_047                 5.443135e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705301e-03 3 1  ON 49
ci_051                 7.483218e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903352e-03 3 1  ON 52
ci_054                -1.948245e-03 3 1  ON 53
ci_055                -2.070383e-03 3 1  ON 54
ci_056                 4.809969e-03 3 1  ON 55
ci_057                 5.042248e-03 3 1  ON 56
ci_058                -6.978937e-03 3 1  ON 57
ci_059                -6.701027e-03 3 1  ON 58
ci_060                 8.316099e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764351e-03 3 1  ON 61
ci_063                -2.603937e-03 3 1  ON 62
ci_064                -3.252293e-03 3 1  ON 63
ci_065                -4.297576e-03 3 1  ON 64
ci_066                 5.676593e-03 3 1  ON 65
ci_067                 5.970758e-03 3 1  ON 66
ci_068                -4.808716e-03 3 1  ON 67
ci_069                -4.915500e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.235795
====================================================
  Execution time = 1.4112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1609e-01
  Total weights = 1.956779433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301104946651
                                         uncertainty =       0.001901695793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301104946651
                                         uncertainty =       0.001901695793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388012575
  error estimate for blocks of size 2^( 2) =       0.000397684128
  error estimate for blocks of size 2^( 3) =       0.000406474847
  error estimate for blocks of size 2^( 4) =       0.000412312841
  error estimate for blocks of size 2^( 5) =       0.000416428823
  error estimate for blocks of size 2^( 6) =       0.000418910884
  error estimate for blocks of size 2^( 7) =       0.000422275181

      target function =                  N/A
              le_mean =     -17.216801354139
             les_mean =     296.734341288007
             stat err =       0.000417481932
             autocorr =       1.157667307668
              std dev =       0.548732645506
             le_variance =       0.301107516244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680135414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801354200       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801354343       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801354342       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801354342       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 1.589138e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801354200       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801354235       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801354235       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801354235       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 3.972873e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801354200       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801354208       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801354208       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801354208       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 9.932201e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6644e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946250e-02 3 1  ON 6
ci_008                -1.831371e-02 3 1  ON 7
ci_009                -1.797217e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398063e-02 3 1  ON 13
ci_015                 1.427652e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325212e-02 3 1  ON 18
ci_020                 1.295296e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162867e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434183e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924622e-03 3 1  ON 33
ci_035                -4.665773e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187974e-03 3 1  ON 37
ci_039                 1.318036e-03 3 1  ON 38
ci_040                -4.156059e-03 3 1  ON 39
ci_041                 9.843820e-03 3 1  ON 40
ci_042                 9.838794e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482444e-02 3 1  ON 43
ci_045                -1.449692e-03 3 1  ON 44
ci_046                 5.624738e-03 3 1  ON 45
ci_047                 5.443134e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705299e-03 3 1  ON 49
ci_051                 7.483217e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903351e-03 3 1  ON 52
ci_054                -1.948245e-03 3 1  ON 53
ci_055                -2.070385e-03 3 1  ON 54
ci_056                 4.809969e-03 3 1  ON 55
ci_057                 5.042246e-03 3 1  ON 56
ci_058                -6.978941e-03 3 1  ON 57
ci_059                -6.701029e-03 3 1  ON 58
ci_060                 8.316100e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764350e-03 3 1  ON 61
ci_063                -2.603940e-03 3 1  ON 62
ci_064                -3.252292e-03 3 1  ON 63
ci_065                -4.297574e-03 3 1  ON 64
ci_066                 5.676593e-03 3 1  ON 65
ci_067                 5.970757e-03 3 1  ON 66
ci_068                -4.808717e-03 3 1  ON 67
ci_069                -4.915501e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.19265
====================================================
  Execution time = 1.3774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1766e-01
  Total weights = 1.9568e+06
  Execution time = 1.8658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249225549
                                         uncertainty =       0.002866337181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249225549
                                         uncertainty =       0.002866337181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389377127
  error estimate for blocks of size 2^( 2) =       0.000399088579
  error estimate for blocks of size 2^( 3) =       0.000408179411
  error estimate for blocks of size 2^( 4) =       0.000414191193
  error estimate for blocks of size 2^( 5) =       0.000419077349
  error estimate for blocks of size 2^( 6) =       0.000421573493
  error estimate for blocks of size 2^( 7) =       0.000424664431

      target function =                  N/A
              le_mean =     -17.217097436317
             les_mean =     296.746107996035
             stat err =       0.000419876617
             autocorr =       1.162793255367
              std dev =       0.550662414557
             le_variance =       0.303229094806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249221190
                                         uncertainty =       0.002866338211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249221190
                                         uncertainty =       0.002866338211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389377125
  error estimate for blocks of size 2^( 2) =       0.000399088576
  error estimate for blocks of size 2^( 3) =       0.000408179409
  error estimate for blocks of size 2^( 4) =       0.000414191191
  error estimate for blocks of size 2^( 5) =       0.000419077348
  error estimate for blocks of size 2^( 6) =       0.000421573491
  error estimate for blocks of size 2^( 7) =       0.000424664429

      target function =                  N/A
              le_mean =     -17.217097436421
             les_mean =     296.746107932935
             stat err =       0.000419876615
             autocorr =       1.162793262069
              std dev =       0.550662410601
             le_variance =       0.303229090449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249223370
                                         uncertainty =       0.002866337696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249223370
                                         uncertainty =       0.002866337696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389377126
  error estimate for blocks of size 2^( 2) =       0.000399088578
  error estimate for blocks of size 2^( 3) =       0.000408179410
  error estimate for blocks of size 2^( 4) =       0.000414191192
  error estimate for blocks of size 2^( 5) =       0.000419077349
  error estimate for blocks of size 2^( 6) =       0.000421573492
  error estimate for blocks of size 2^( 7) =       0.000424664430

      target function =                  N/A
              le_mean =     -17.217097436369
             les_mean =     296.746107964479
             stat err =       0.000419876616
             autocorr =       1.162793258724
              std dev =       0.550662412579
             le_variance =       0.303229092627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249225277
                                         uncertainty =       0.002866337246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303249225277
                                         uncertainty =       0.002866337246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389377127
  error estimate for blocks of size 2^( 2) =       0.000399088579
  error estimate for blocks of size 2^( 3) =       0.000408179411
  error estimate for blocks of size 2^( 4) =       0.000414191193
  error estimate for blocks of size 2^( 5) =       0.000419077349
  error estimate for blocks of size 2^( 6) =       0.000421573493
  error estimate for blocks of size 2^( 7) =       0.000424664431

      target function =                  N/A
              le_mean =     -17.217097436323
             les_mean =     296.746107992090
             stat err =       0.000419876616
             autocorr =       1.162793255788
              std dev =       0.550662414310
             le_variance =       0.303229094533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217097436317        initial
     2.3842e+04     2.3842e+05             1.5891e-08       -17.217097436421  <--
     9.5367e+04     9.5367e+05             3.9729e-09       -17.217097436369
     3.8147e+05     3.8147e+06             9.9322e-10       -17.217097436323

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.3171e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.31
    reference variance = 0.610059
====================================================
  Execution time = 1.4211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1887e-01
  Total weights = 1.956980679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302704249580
                                         uncertainty =       0.002003720446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302704249580
                                         uncertainty =       0.002003720446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389038012
  error estimate for blocks of size 2^( 2) =       0.000399000806
  error estimate for blocks of size 2^( 3) =       0.000407662663
  error estimate for blocks of size 2^( 4) =       0.000414585856
  error estimate for blocks of size 2^( 5) =       0.000418376293
  error estimate for blocks of size 2^( 6) =       0.000420377378
  error estimate for blocks of size 2^( 7) =       0.000421056222

      target function =                  N/A
              le_mean =     -17.217504316372
             les_mean =     296.761325916614
             stat err =       0.000418598937
             autocorr =       1.157743007906
              std dev =       0.550182833536
             le_variance =       0.302701150317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721750431637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217504316451       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217504316549       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217504316451       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217504316458       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 7.791252e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217504316451       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217504316475       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217504316451       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217504316451       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 1.947883e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217504316451       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217504316457       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217504316451       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217504316451       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 4.869750e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6801e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467403e-02 3 1  ON 2
ci_004                 2.095767e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938236e-02 3 1  ON 5
ci_007                -1.946250e-02 3 1  ON 6
ci_008                -1.831369e-02 3 1  ON 7
ci_009                -1.797217e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661399e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427650e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325210e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353482e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162865e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114289e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442074e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103889e-02 3 1  ON 30
ci_032                -1.343682e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924615e-03 3 1  ON 33
ci_035                -4.665770e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187970e-03 3 1  ON 37
ci_039                 1.318032e-03 3 1  ON 38
ci_040                -4.156059e-03 3 1  ON 39
ci_041                 9.843818e-03 3 1  ON 40
ci_042                 9.838788e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482446e-02 3 1  ON 43
ci_045                -1.449689e-03 3 1  ON 44
ci_046                 5.624745e-03 3 1  ON 45
ci_047                 5.443126e-03 3 1  ON 46
ci_048                -1.175068e-02 3 1  ON 47
ci_049                -1.211631e-02 3 1  ON 48
ci_050                 7.705291e-03 3 1  ON 49
ci_051                 7.483220e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903344e-03 3 1  ON 52
ci_054                -1.948256e-03 3 1  ON 53
ci_055                -2.070399e-03 3 1  ON 54
ci_056                 4.809978e-03 3 1  ON 55
ci_057                 5.042240e-03 3 1  ON 56
ci_058                -6.978954e-03 3 1  ON 57
ci_059                -6.701035e-03 3 1  ON 58
ci_060                 8.316107e-03 3 1  ON 59
ci_061                 8.896222e-03 3 1  ON 60
ci_062                -2.764351e-03 3 1  ON 61
ci_063                -2.603949e-03 3 1  ON 62
ci_064                -3.252287e-03 3 1  ON 63
ci_065                -4.297568e-03 3 1  ON 64
ci_066                 5.676595e-03 3 1  ON 65
ci_067                 5.970751e-03 3 1  ON 66
ci_068                -4.808727e-03 3 1  ON 67
ci_069                -4.915512e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.134244
====================================================
  Execution time = 1.3901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1509e-01
  Total weights = 1.9567e+06
  Execution time = 1.8574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861167969
                                         uncertainty =       0.001775497062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861167969
                                         uncertainty =       0.001775497062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388503593
  error estimate for blocks of size 2^( 2) =       0.000398107083
  error estimate for blocks of size 2^( 3) =       0.000406461832
  error estimate for blocks of size 2^( 4) =       0.000413142576
  error estimate for blocks of size 2^( 5) =       0.000415255940
  error estimate for blocks of size 2^( 6) =       0.000417953292
  error estimate for blocks of size 2^( 7) =       0.000418436510

      target function =                  N/A
              le_mean =     -17.216972552225
             les_mean =     296.739234100179
             stat err =       0.000416197079
             autocorr =       1.147646076987
              std dev =       0.549427050658
             le_variance =       0.301870083995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861128584
                                         uncertainty =       0.001775496967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861128584
                                         uncertainty =       0.001775496967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388503568
  error estimate for blocks of size 2^( 2) =       0.000398107059
  error estimate for blocks of size 2^( 3) =       0.000406461810
  error estimate for blocks of size 2^( 4) =       0.000413142555
  error estimate for blocks of size 2^( 5) =       0.000415255918
  error estimate for blocks of size 2^( 6) =       0.000417953269
  error estimate for blocks of size 2^( 7) =       0.000418436487

      target function =                  N/A
              le_mean =     -17.216972552102
             les_mean =     296.739234011869
             stat err =       0.000416197057
             autocorr =       1.147646103189
              std dev =       0.549427014793
             le_variance =       0.301870044584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861148276
                                         uncertainty =       0.001775497015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861148276
                                         uncertainty =       0.001775497015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388503581
  error estimate for blocks of size 2^( 2) =       0.000398107071
  error estimate for blocks of size 2^( 3) =       0.000406461821
  error estimate for blocks of size 2^( 4) =       0.000413142565
  error estimate for blocks of size 2^( 5) =       0.000415255929
  error estimate for blocks of size 2^( 6) =       0.000417953281
  error estimate for blocks of size 2^( 7) =       0.000418436498

      target function =                  N/A
              le_mean =     -17.216972552163
             les_mean =     296.739234055754
             stat err =       0.000416197068
             autocorr =       1.147646090084
              std dev =       0.549427032725
             le_variance =       0.301870064289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861165507
                                         uncertainty =       0.001775497056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301861165507
                                         uncertainty =       0.001775497056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388503592
  error estimate for blocks of size 2^( 2) =       0.000398107082
  error estimate for blocks of size 2^( 3) =       0.000406461830
  error estimate for blocks of size 2^( 4) =       0.000413142574
  error estimate for blocks of size 2^( 5) =       0.000415255938
  error estimate for blocks of size 2^( 6) =       0.000417953291
  error estimate for blocks of size 2^( 7) =       0.000418436508

      target function =                  N/A
              le_mean =     -17.216972552217
             les_mean =     296.739234094596
             stat err =       0.000416197078
             autocorr =       1.147646078622
              std dev =       0.549427048416
             le_variance =       0.301870081531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216972552225        initial  <--
     5.9605e+03     5.9605e+04             7.7913e-08       -17.216972552102
     2.3842e+04     2.3842e+05             1.9479e-08       -17.216972552163
     9.5367e+04     9.5367e+05             4.8697e-09       -17.216972552217

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2471
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2185
    reference variance = 0.37075
====================================================
  Execution time = 1.6123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1407e-01
  Total weights = 1.956735058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389848076
                                         uncertainty =       0.002368089130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389848076
                                         uncertainty =       0.002368089130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388224750
  error estimate for blocks of size 2^( 2) =       0.000397952657
  error estimate for blocks of size 2^( 3) =       0.000406695852
  error estimate for blocks of size 2^( 4) =       0.000413208764
  error estimate for blocks of size 2^( 5) =       0.000417008231
  error estimate for blocks of size 2^( 6) =       0.000417599618
  error estimate for blocks of size 2^( 7) =       0.000419331850

      target function =                  N/A
              le_mean =     -17.216930947199
             les_mean =     296.736781149162
             stat err =       0.000416787116
             autocorr =       1.152556255985
              std dev =       0.549032706420
             le_variance =       0.301436912719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693094720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930947241       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930947288       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930947290       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 5.174748e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930947241       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930947252       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930947253       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 1.293692e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216930947241       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216930947243       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216930947244       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 3.234235e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8624e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924625e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843815e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011272e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624741e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705295e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948249e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042240e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701033e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764349e-03 3 1  ON 61
ci_063                -2.603948e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297569e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970751e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915503e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.24671
====================================================
  Execution time = 1.3578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1150e-01
  Total weights = 1.9568e+06
  Execution time = 1.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033436
                                         uncertainty =       0.002106510456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033436
                                         uncertainty =       0.002106510456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385689185
  error estimate for blocks of size 2^( 2) =       0.000395482212
  error estimate for blocks of size 2^( 3) =       0.000403936542
  error estimate for blocks of size 2^( 4) =       0.000410132146
  error estimate for blocks of size 2^( 5) =       0.000414805228
  error estimate for blocks of size 2^( 6) =       0.000417727824
  error estimate for blocks of size 2^( 7) =       0.000418919587

      target function =                  N/A
              le_mean =     -17.216211327183
             les_mean =     296.709430770671
             stat err =       0.000415396196
             autocorr =       1.159978948941
              std dev =       0.545446876597
             le_variance =       0.297512295189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504032947
                                         uncertainty =       0.002106510268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504032947
                                         uncertainty =       0.002106510268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385689185
  error estimate for blocks of size 2^( 2) =       0.000395482212
  error estimate for blocks of size 2^( 3) =       0.000403936542
  error estimate for blocks of size 2^( 4) =       0.000410132146
  error estimate for blocks of size 2^( 5) =       0.000414805227
  error estimate for blocks of size 2^( 6) =       0.000417727823
  error estimate for blocks of size 2^( 7) =       0.000418919587

      target function =                  N/A
              le_mean =     -17.216211327098
             les_mean =     296.709430755151
             stat err =       0.000415396196
             autocorr =       1.159978949846
              std dev =       0.545446876158
             le_variance =       0.297512294710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033192
                                         uncertainty =       0.002106510362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033192
                                         uncertainty =       0.002106510362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385689185
  error estimate for blocks of size 2^( 2) =       0.000395482212
  error estimate for blocks of size 2^( 3) =       0.000403936542
  error estimate for blocks of size 2^( 4) =       0.000410132146
  error estimate for blocks of size 2^( 5) =       0.000414805228
  error estimate for blocks of size 2^( 6) =       0.000417727824
  error estimate for blocks of size 2^( 7) =       0.000418919587

      target function =                  N/A
              le_mean =     -17.216211327141
             les_mean =     296.709430762911
             stat err =       0.000415396196
             autocorr =       1.159978949391
              std dev =       0.545446876377
             le_variance =       0.297512294950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033406
                                         uncertainty =       0.002106510444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297504033406
                                         uncertainty =       0.002106510444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385689185
  error estimate for blocks of size 2^( 2) =       0.000395482212
  error estimate for blocks of size 2^( 3) =       0.000403936542
  error estimate for blocks of size 2^( 4) =       0.000410132146
  error estimate for blocks of size 2^( 5) =       0.000414805228
  error estimate for blocks of size 2^( 6) =       0.000417727824
  error estimate for blocks of size 2^( 7) =       0.000418919587

      target function =                  N/A
              le_mean =     -17.216211327178
             les_mean =     296.709430769701
             stat err =       0.000415396196
             autocorr =       1.159978948990
              std dev =       0.545446876569
             le_variance =       0.297512295159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216211327183        initial  <--
     5.9605e+04     5.9605e+05             5.1747e-09       -17.216211327098
     2.3842e+05     2.3842e+06             1.2937e-09       -17.216211327141
     9.5367e+05     9.5367e+06             3.2342e-10       -17.216211327178

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8952
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2197
    reference variance = 0.420888
====================================================
  Execution time = 1.4079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1353e-01
  Total weights = 1.956862628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299993012454
                                         uncertainty =       0.002717358837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299993012454
                                         uncertainty =       0.002717358837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387262049
  error estimate for blocks of size 2^( 2) =       0.000396804617
  error estimate for blocks of size 2^( 3) =       0.000405520441
  error estimate for blocks of size 2^( 4) =       0.000412040015
  error estimate for blocks of size 2^( 5) =       0.000415548854
  error estimate for blocks of size 2^( 6) =       0.000417730335
  error estimate for blocks of size 2^( 7) =       0.000419397790

      target function =                  N/A
              le_mean =     -17.217079938522
             les_mean =     296.741375933239
             stat err =       0.000416179249
             autocorr =       1.154917511634
              std dev =       0.547671241215
             le_variance =       0.299943788454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707993852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217079938584       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217079938593       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217079938593       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217079938593       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 7.029116e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217079938584       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217079938587       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217079938587       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217079938587       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 1.757280e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217079938584       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217079938585       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217079938585       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217079937832       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 4.393200e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6606e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924625e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297569e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2401
    reference variance = 0.232781
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1964e-01
  Total weights = 1.9571e+06
  Execution time = 1.8533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355267
                                         uncertainty =       0.002522803279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355267
                                         uncertainty =       0.002522803279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389073769
  error estimate for blocks of size 2^( 2) =       0.000398428386
  error estimate for blocks of size 2^( 3) =       0.000407320778
  error estimate for blocks of size 2^( 4) =       0.000413284279
  error estimate for blocks of size 2^( 5) =       0.000418432294
  error estimate for blocks of size 2^( 6) =       0.000419279618
  error estimate for blocks of size 2^( 7) =       0.000421900973

      target function =                  N/A
              le_mean =     -17.217262519938
             les_mean =     296.753766778482
             stat err =       0.000418224291
             autocorr =       1.155459169144
              std dev =       0.550233400867
             le_variance =       0.302756795430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355101
                                         uncertainty =       0.002522803284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355101
                                         uncertainty =       0.002522803284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389073769
  error estimate for blocks of size 2^( 2) =       0.000398428386
  error estimate for blocks of size 2^( 3) =       0.000407320778
  error estimate for blocks of size 2^( 4) =       0.000413284279
  error estimate for blocks of size 2^( 5) =       0.000418432294
  error estimate for blocks of size 2^( 6) =       0.000419279618
  error estimate for blocks of size 2^( 7) =       0.000421900973

      target function =                  N/A
              le_mean =     -17.217262519936
             les_mean =     296.753766779283
             stat err =       0.000418224291
             autocorr =       1.155459169378
              std dev =       0.550233400713
             le_variance =       0.302756795261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355184
                                         uncertainty =       0.002522803281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355184
                                         uncertainty =       0.002522803281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389073769
  error estimate for blocks of size 2^( 2) =       0.000398428386
  error estimate for blocks of size 2^( 3) =       0.000407320778
  error estimate for blocks of size 2^( 4) =       0.000413284279
  error estimate for blocks of size 2^( 5) =       0.000418432294
  error estimate for blocks of size 2^( 6) =       0.000419279618
  error estimate for blocks of size 2^( 7) =       0.000421900973

      target function =                  N/A
              le_mean =     -17.217262519937
             les_mean =     296.753766778883
             stat err =       0.000418224291
             autocorr =       1.155459169249
              std dev =       0.550233400790
             le_variance =       0.302756795345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355256
                                         uncertainty =       0.002522803279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302414355256
                                         uncertainty =       0.002522803279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389073769
  error estimate for blocks of size 2^( 2) =       0.000398428386
  error estimate for blocks of size 2^( 3) =       0.000407320778
  error estimate for blocks of size 2^( 4) =       0.000413284279
  error estimate for blocks of size 2^( 5) =       0.000418432294
  error estimate for blocks of size 2^( 6) =       0.000419279618
  error estimate for blocks of size 2^( 7) =       0.000421900973

      target function =                  N/A
              le_mean =     -17.217262519938
             les_mean =     296.753766778532
             stat err =       0.000418224291
             autocorr =       1.155459169159
              std dev =       0.550233400857
             le_variance =       0.302756795419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217262519938        initial  <--
     5.9605e+05     5.9605e+06             7.0291e-10       -17.217262519936
     2.3842e+06     2.3842e+07             1.7573e-10       -17.217262519937
     9.5367e+06     9.5367e+07             4.3932e-11       -17.217262519938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9635
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.134
    reference variance = 0.205428
====================================================
  Execution time = 1.4063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1411e-01
  Total weights = 1.956697252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300363097663
                                         uncertainty =       0.002146503329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300363097663
                                         uncertainty =       0.002146503329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387633001
  error estimate for blocks of size 2^( 2) =       0.000397357812
  error estimate for blocks of size 2^( 3) =       0.000405949846
  error estimate for blocks of size 2^( 4) =       0.000412952787
  error estimate for blocks of size 2^( 5) =       0.000416173751
  error estimate for blocks of size 2^( 6) =       0.000418287146
  error estimate for blocks of size 2^( 7) =       0.000418651024

      target function =                  N/A
              le_mean =     -17.216538011283
             les_mean =     296.723287679531
             stat err =       0.000416516177
             autocorr =       1.154575291456
              std dev =       0.548195847767
             le_variance =       0.300518687509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653801128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538011335       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538011335       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538011335       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538011335       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 5.173766e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538011335       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538011335       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538011335       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538011335       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 1.293438e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538011335       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538011335       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538011335       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538011335       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 3.233591e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6584e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2967
    reference variance = 0.340159
====================================================
  Execution time = 1.3767e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1738e-01
  Total weights = 1.9567e+06
  Execution time = 1.8493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738465
                                         uncertainty =       0.001952003630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738465
                                         uncertainty =       0.001952003630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388294875
  error estimate for blocks of size 2^( 2) =       0.000398145855
  error estimate for blocks of size 2^( 3) =       0.000407020528
  error estimate for blocks of size 2^( 4) =       0.000413488107
  error estimate for blocks of size 2^( 5) =       0.000417478535
  error estimate for blocks of size 2^( 6) =       0.000420664838
  error estimate for blocks of size 2^( 7) =       0.000419987873

      target function =                  N/A
              le_mean =     -17.216648800397
             les_mean =     296.730373467010
             stat err =       0.000417904838
             autocorr =       1.158327805104
              std dev =       0.549131878483
             le_variance =       0.301545819967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738463
                                         uncertainty =       0.001952003629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738463
                                         uncertainty =       0.001952003629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388294875
  error estimate for blocks of size 2^( 2) =       0.000398145855
  error estimate for blocks of size 2^( 3) =       0.000407020528
  error estimate for blocks of size 2^( 4) =       0.000413488107
  error estimate for blocks of size 2^( 5) =       0.000417478535
  error estimate for blocks of size 2^( 6) =       0.000420664838
  error estimate for blocks of size 2^( 7) =       0.000419987873

      target function =                  N/A
              le_mean =     -17.216648800397
             les_mean =     296.730373466991
             stat err =       0.000417904838
             autocorr =       1.158327805116
              std dev =       0.549131878482
             le_variance =       0.301545819965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738464
                                         uncertainty =       0.001952003629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738464
                                         uncertainty =       0.001952003629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388294875
  error estimate for blocks of size 2^( 2) =       0.000398145855
  error estimate for blocks of size 2^( 3) =       0.000407020528
  error estimate for blocks of size 2^( 4) =       0.000413488107
  error estimate for blocks of size 2^( 5) =       0.000417478535
  error estimate for blocks of size 2^( 6) =       0.000420664838
  error estimate for blocks of size 2^( 7) =       0.000419987873

      target function =                  N/A
              le_mean =     -17.216648800397
             les_mean =     296.730373467001
             stat err =       0.000417904838
             autocorr =       1.158327805124
              std dev =       0.549131878483
             le_variance =       0.301545819966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738465
                                         uncertainty =       0.001952003630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301393738465
                                         uncertainty =       0.001952003630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388294875
  error estimate for blocks of size 2^( 2) =       0.000398145855
  error estimate for blocks of size 2^( 3) =       0.000407020528
  error estimate for blocks of size 2^( 4) =       0.000413488107
  error estimate for blocks of size 2^( 5) =       0.000417478535
  error estimate for blocks of size 2^( 6) =       0.000420664838
  error estimate for blocks of size 2^( 7) =       0.000419987873

      target function =                  N/A
              le_mean =     -17.216648800397
             les_mean =     296.730373467009
             stat err =       0.000417904838
             autocorr =       1.158327805109
              std dev =       0.549131878483
             le_variance =       0.301545819967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216648800397        initial  <--
     5.9605e+06     5.9605e+07             5.1738e-11       -17.216648800397
     2.3842e+07     2.3842e+08             1.2934e-11       -17.216648800397
     9.5367e+07     9.5367e+08             3.2336e-12       -17.216648800397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0766
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.183
    reference variance = 0.154713
====================================================
  Execution time = 1.4165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1124e-01
  Total weights = 1.956732791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297539847802
                                         uncertainty =       0.002121513683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297539847802
                                         uncertainty =       0.002121513683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385714571
  error estimate for blocks of size 2^( 2) =       0.000395443509
  error estimate for blocks of size 2^( 3) =       0.000404199151
  error estimate for blocks of size 2^( 4) =       0.000411217480
  error estimate for blocks of size 2^( 5) =       0.000416430662
  error estimate for blocks of size 2^( 6) =       0.000418705455
  error estimate for blocks of size 2^( 7) =       0.000417945003

      target function =                  N/A
              le_mean =     -17.216451911547
             les_mean =     296.717453144850
             stat err =       0.000416074650
             autocorr =       1.163617978301
              std dev =       0.545482777362
             le_variance =       0.297551460398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645191155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451911617       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216451911617       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216451911617       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216451911617       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 4.624825e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451911617       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216451911617       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216451911617       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216451911617       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 1.156207e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216451911617       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216451911617       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216451911617       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216451911617       residual = 2.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+08 is 2.890496e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6676e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.340318
====================================================
  Execution time = 1.3581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1655e-01
  Total weights = 1.9570e+06
  Execution time = 1.8609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389293930
  error estimate for blocks of size 2^( 2) =       0.000399062751
  error estimate for blocks of size 2^( 3) =       0.000408100244
  error estimate for blocks of size 2^( 4) =       0.000414148340
  error estimate for blocks of size 2^( 5) =       0.000417262101
  error estimate for blocks of size 2^( 6) =       0.000418986346
  error estimate for blocks of size 2^( 7) =       0.000419663253

      target function =                  N/A
              le_mean =     -17.216972521685
             les_mean =     296.740689201562
             stat err =       0.000417515010
             autocorr =       1.150241206874
              std dev =       0.550544755974
             le_variance =       0.303099528330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506970
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506970
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389293930
  error estimate for blocks of size 2^( 2) =       0.000399062751
  error estimate for blocks of size 2^( 3) =       0.000408100244
  error estimate for blocks of size 2^( 4) =       0.000414148340
  error estimate for blocks of size 2^( 5) =       0.000417262101
  error estimate for blocks of size 2^( 6) =       0.000418986346
  error estimate for blocks of size 2^( 7) =       0.000419663253

      target function =                  N/A
              le_mean =     -17.216972521685
             les_mean =     296.740689201561
             stat err =       0.000417515010
             autocorr =       1.150241206875
              std dev =       0.550544755975
             le_variance =       0.303099528332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389293930
  error estimate for blocks of size 2^( 2) =       0.000399062751
  error estimate for blocks of size 2^( 3) =       0.000408100244
  error estimate for blocks of size 2^( 4) =       0.000414148340
  error estimate for blocks of size 2^( 5) =       0.000417262101
  error estimate for blocks of size 2^( 6) =       0.000418986346
  error estimate for blocks of size 2^( 7) =       0.000419663253

      target function =                  N/A
              le_mean =     -17.216972521685
             les_mean =     296.740689201562
             stat err =       0.000417515010
             autocorr =       1.150241206879
              std dev =       0.550544755975
             le_variance =       0.303099528331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303080506969
                                         uncertainty =       0.002481392758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389293930
  error estimate for blocks of size 2^( 2) =       0.000399062751
  error estimate for blocks of size 2^( 3) =       0.000408100244
  error estimate for blocks of size 2^( 4) =       0.000414148340
  error estimate for blocks of size 2^( 5) =       0.000417262101
  error estimate for blocks of size 2^( 6) =       0.000418986346
  error estimate for blocks of size 2^( 7) =       0.000419663253

      target function =                  N/A
              le_mean =     -17.216972521685
             les_mean =     296.740689201562
             stat err =       0.000417515010
             autocorr =       1.150241206879
              std dev =       0.550544755974
             le_variance =       0.303099528330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216972521685        initial  <--
     5.9605e+07     5.9605e+08             4.6248e-12       -17.216972521685
     2.3842e+08     2.3842e+09             1.1562e-12       -17.216972521685
     9.5367e+08     9.5367e+09             2.8905e-13       -17.216972521685

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9543
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1378
    reference variance = 0.327629
====================================================
  Execution time = 1.4025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1406e-01
  Total weights = 1.956743475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299990299166
                                         uncertainty =       0.001854618224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299990299166
                                         uncertainty =       0.001854618224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387303488
  error estimate for blocks of size 2^( 2) =       0.000396769407
  error estimate for blocks of size 2^( 3) =       0.000405060242
  error estimate for blocks of size 2^( 4) =       0.000411524674
  error estimate for blocks of size 2^( 5) =       0.000415889496
  error estimate for blocks of size 2^( 6) =       0.000417762530
  error estimate for blocks of size 2^( 7) =       0.000417199019

      target function =                  N/A
              le_mean =     -17.216928920289
             les_mean =     296.736701869528
             stat err =       0.000415593930
             autocorr =       1.151424786333
              std dev =       0.547729846025
             le_variance =       0.300007984226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692892029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928920338       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928920338       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928920338       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216928921896       residual = 5.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+08 is 6.071850e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928920338       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928920338       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928920338       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216928920338       residual = 5.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+09 is 1.517786e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928920338       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928920338       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928920338       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216932938554       residual = 5.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+09 is 3.794706e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6554e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2922
    reference variance = 0.217145
====================================================
  Execution time = 1.3640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1400e-01
  Total weights = 1.9567e+06
  Execution time = 1.8558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388117913
  error estimate for blocks of size 2^( 2) =       0.000397611772
  error estimate for blocks of size 2^( 3) =       0.000406557337
  error estimate for blocks of size 2^( 4) =       0.000412736406
  error estimate for blocks of size 2^( 5) =       0.000416842480
  error estimate for blocks of size 2^( 6) =       0.000419367135
  error estimate for blocks of size 2^( 7) =       0.000419446441

      target function =                  N/A
              le_mean =     -17.216069568373
             les_mean =     296.707047437133
             stat err =       0.000417098116
             autocorr =       1.154912497122
              std dev =       0.548881616332
             le_variance =       0.301271028748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388117913
  error estimate for blocks of size 2^( 2) =       0.000397611772
  error estimate for blocks of size 2^( 3) =       0.000406557337
  error estimate for blocks of size 2^( 4) =       0.000412736406
  error estimate for blocks of size 2^( 5) =       0.000416842480
  error estimate for blocks of size 2^( 6) =       0.000419367135
  error estimate for blocks of size 2^( 7) =       0.000419446441

      target function =                  N/A
              le_mean =     -17.216069568373
             les_mean =     296.707047437133
             stat err =       0.000417098116
             autocorr =       1.154912497121
              std dev =       0.548881616332
             le_variance =       0.301271028748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388117913
  error estimate for blocks of size 2^( 2) =       0.000397611772
  error estimate for blocks of size 2^( 3) =       0.000406557337
  error estimate for blocks of size 2^( 4) =       0.000412736406
  error estimate for blocks of size 2^( 5) =       0.000416842480
  error estimate for blocks of size 2^( 6) =       0.000419367135
  error estimate for blocks of size 2^( 7) =       0.000419446441

      target function =                  N/A
              le_mean =     -17.216069568373
             les_mean =     296.707047437133
             stat err =       0.000417098116
             autocorr =       1.154912497122
              std dev =       0.548881616332
             le_variance =       0.301271028748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223306253
                                         uncertainty =       0.001797555746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388117913
  error estimate for blocks of size 2^( 2) =       0.000397611772
  error estimate for blocks of size 2^( 3) =       0.000406557337
  error estimate for blocks of size 2^( 4) =       0.000412736406
  error estimate for blocks of size 2^( 5) =       0.000416842480
  error estimate for blocks of size 2^( 6) =       0.000419367135
  error estimate for blocks of size 2^( 7) =       0.000419446441

      target function =                  N/A
              le_mean =     -17.216069568373
             les_mean =     296.707047437133
             stat err =       0.000417098116
             autocorr =       1.154912497126
              std dev =       0.548881616332
             le_variance =       0.301271028748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216069568373        initial  <--
     5.9605e+08     5.9605e+09             6.0718e-13       -17.216069568373
     2.3842e+09     2.3842e+10             1.5178e-13       -17.216069568373
     9.5367e+09     9.5367e+10             3.7947e-14       -17.216069568373

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9775
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1404
    reference variance = 0.280194
====================================================
  Execution time = 1.3953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1324e-01
  Total weights = 1.956926188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297059220183
                                         uncertainty =       0.002021822228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297059220183
                                         uncertainty =       0.002021822228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385372958
  error estimate for blocks of size 2^( 2) =       0.000395407428
  error estimate for blocks of size 2^( 3) =       0.000404880995
  error estimate for blocks of size 2^( 4) =       0.000411184451
  error estimate for blocks of size 2^( 5) =       0.000415851560
  error estimate for blocks of size 2^( 6) =       0.000417438092
  error estimate for blocks of size 2^( 7) =       0.000418404575

      target function =                  N/A
              le_mean =     -17.217115705270
             les_mean =     296.742312642846
             stat err =       0.000415719670
             autocorr =       1.163693674199
              std dev =       0.544999664120
             le_variance =       0.297024633890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711570527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217115705335       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217115705335       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217115705335       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+09 is 5.815374e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217115705335       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217115705335       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217115705335       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+10 is 1.453843e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217115705335       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217115705335       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217115705335       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+10 is 3.621295e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6470e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.233422
====================================================
  Execution time = 1.3917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1642e-01
  Total weights = 1.9570e+06
  Execution time = 1.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389090292
  error estimate for blocks of size 2^( 2) =       0.000398814989
  error estimate for blocks of size 2^( 3) =       0.000408124407
  error estimate for blocks of size 2^( 4) =       0.000415141857
  error estimate for blocks of size 2^( 5) =       0.000420680227
  error estimate for blocks of size 2^( 6) =       0.000422305231
  error estimate for blocks of size 2^( 7) =       0.000425082787

      target function =                  N/A
              le_mean =     -17.217180716518
             les_mean =     296.747731139148
             stat err =       0.000420802525
             autocorr =       1.169649888544
              std dev =       0.550256768576
             le_variance =       0.302782511363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389090292
  error estimate for blocks of size 2^( 2) =       0.000398814989
  error estimate for blocks of size 2^( 3) =       0.000408124407
  error estimate for blocks of size 2^( 4) =       0.000415141857
  error estimate for blocks of size 2^( 5) =       0.000420680227
  error estimate for blocks of size 2^( 6) =       0.000422305231
  error estimate for blocks of size 2^( 7) =       0.000425082787

      target function =                  N/A
              le_mean =     -17.217180716518
             les_mean =     296.747731139148
             stat err =       0.000420802525
             autocorr =       1.169649888546
              std dev =       0.550256768575
             le_variance =       0.302782511363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389090292
  error estimate for blocks of size 2^( 2) =       0.000398814989
  error estimate for blocks of size 2^( 3) =       0.000408124407
  error estimate for blocks of size 2^( 4) =       0.000415141857
  error estimate for blocks of size 2^( 5) =       0.000420680227
  error estimate for blocks of size 2^( 6) =       0.000422305231
  error estimate for blocks of size 2^( 7) =       0.000425082787

      target function =                  N/A
              le_mean =     -17.217180716518
             les_mean =     296.747731139148
             stat err =       0.000420802525
             autocorr =       1.169649888551
              std dev =       0.550256768576
             le_variance =       0.302782511363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302803226233
                                         uncertainty =       0.001642885074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389090292
  error estimate for blocks of size 2^( 2) =       0.000398814989
  error estimate for blocks of size 2^( 3) =       0.000408124407
  error estimate for blocks of size 2^( 4) =       0.000415141857
  error estimate for blocks of size 2^( 5) =       0.000420680227
  error estimate for blocks of size 2^( 6) =       0.000422305231
  error estimate for blocks of size 2^( 7) =       0.000425082787

      target function =                  N/A
              le_mean =     -17.217180716518
             les_mean =     296.747731139148
             stat err =       0.000420802525
             autocorr =       1.169649888543
              std dev =       0.550256768576
             le_variance =       0.302782511363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217180716518        initial  <--
     5.9605e+09     5.9605e+10             5.8154e-14       -17.217180716518
     2.3842e+10     2.3842e+11             1.4538e-14       -17.217180716518
     9.5367e+10     9.5367e+11             3.6213e-15       -17.217180716518

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2525
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2345
    reference variance = 0.992687
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1301e-01
  Total weights = 1.956506190e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299172047798
                                         uncertainty =       0.001628804088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299172047798
                                         uncertainty =       0.001628804088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386762031
  error estimate for blocks of size 2^( 2) =       0.000396616468
  error estimate for blocks of size 2^( 3) =       0.000405231449
  error estimate for blocks of size 2^( 4) =       0.000411150120
  error estimate for blocks of size 2^( 5) =       0.000414553783
  error estimate for blocks of size 2^( 6) =       0.000416888702
  error estimate for blocks of size 2^( 7) =       0.000419670404

      target function =                  N/A
              le_mean =     -17.216423332933
             les_mean =     296.718237371396
             stat err =       0.000415565752
             autocorr =       1.154494409640
              std dev =       0.546964109462
             le_variance =       0.299169737040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642333293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423332967       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423332967       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423332967       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216423332967       residual = 9.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+10 is 5.308875e-15

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423332967       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423332967       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423332967       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216385415295       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216423332967       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216349339760       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216521449556       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216690176797       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216406898020       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216440127300       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216421094841       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216147809222       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216535844979       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216386719309       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216556495575       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216134493506       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216614561869       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216533107555       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216188033853       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216171621089       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216785828172       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216745556818       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217287911746       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216465537614       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216625054637       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215981180698       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216457879740       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216486136816       residual = 1.76e-04           smallest_sin_value = 9.95e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+11 is 1.320677e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216423332967       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423332967       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423332967       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216423332967       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216423332965       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216769955999       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217526908473       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216429517088       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217186899882       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216784401956       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216697180627       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217337690693       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217522504182       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216159381669       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216312174836       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216226859765       residual = 6.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217215939452       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215866582512       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217573861959       residual = 9.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217421305533       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216023185951       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215130021549       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216252377424       residual = 2.77e-03           smallest_sin_value = 9.98e-01
davidson iteration   23 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+11 is 3.285942e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6777e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.183652
====================================================
  Execution time = 1.3641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1314e-01
  Total weights = 1.9567e+06
  Execution time = 1.8587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387005087
  error estimate for blocks of size 2^( 2) =       0.000396710562
  error estimate for blocks of size 2^( 3) =       0.000405698194
  error estimate for blocks of size 2^( 4) =       0.000412322486
  error estimate for blocks of size 2^( 5) =       0.000415938789
  error estimate for blocks of size 2^( 6) =       0.000418008248
  error estimate for blocks of size 2^( 7) =       0.000419439020

      target function =                  N/A
              le_mean =     -17.216821901997
             les_mean =     296.732094606254
             stat err =       0.000416427136
             autocorr =       1.157829729812
              std dev =       0.547307842699
             le_variance =       0.299545874680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387005087
  error estimate for blocks of size 2^( 2) =       0.000396710562
  error estimate for blocks of size 2^( 3) =       0.000405698194
  error estimate for blocks of size 2^( 4) =       0.000412322486
  error estimate for blocks of size 2^( 5) =       0.000415938789
  error estimate for blocks of size 2^( 6) =       0.000418008248
  error estimate for blocks of size 2^( 7) =       0.000419439020

      target function =                  N/A
              le_mean =     -17.216821901997
             les_mean =     296.732094606254
             stat err =       0.000416427136
             autocorr =       1.157829729814
              std dev =       0.547307842699
             le_variance =       0.299545874680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387005087
  error estimate for blocks of size 2^( 2) =       0.000396710562
  error estimate for blocks of size 2^( 3) =       0.000405698194
  error estimate for blocks of size 2^( 4) =       0.000412322486
  error estimate for blocks of size 2^( 5) =       0.000415938789
  error estimate for blocks of size 2^( 6) =       0.000418008248
  error estimate for blocks of size 2^( 7) =       0.000419439020

      target function =                  N/A
              le_mean =     -17.216821901997
             les_mean =     296.732094606254
             stat err =       0.000416427136
             autocorr =       1.157829729811
              std dev =       0.547307842699
             le_variance =       0.299545874680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299517150307
                                         uncertainty =       0.001946126263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387005087
  error estimate for blocks of size 2^( 2) =       0.000396710562
  error estimate for blocks of size 2^( 3) =       0.000405698194
  error estimate for blocks of size 2^( 4) =       0.000412322486
  error estimate for blocks of size 2^( 5) =       0.000415938789
  error estimate for blocks of size 2^( 6) =       0.000418008248
  error estimate for blocks of size 2^( 7) =       0.000419439020

      target function =                  N/A
              le_mean =     -17.216821901997
             les_mean =     296.732094606254
             stat err =       0.000416427136
             autocorr =       1.157829729811
              std dev =       0.547307842699
             le_variance =       0.299545874680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216821901997        initial  <--
     5.9605e+10     5.9605e+11             5.3089e-15       -17.216821901997
     2.3842e+11     2.3842e+12             1.3207e-15       -17.216821901997
     9.5367e+11     9.5367e+12             3.2859e-16       -17.216821901997

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0244
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2241
    reference variance = 0.213947
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1674e-01
  Total weights = 1.956704477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300803499449
                                         uncertainty =       0.002028647428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300803499449
                                         uncertainty =       0.002028647428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387895239
  error estimate for blocks of size 2^( 2) =       0.000398011214
  error estimate for blocks of size 2^( 3) =       0.000406727293
  error estimate for blocks of size 2^( 4) =       0.000413050926
  error estimate for blocks of size 2^( 5) =       0.000416392247
  error estimate for blocks of size 2^( 6) =       0.000419084160
  error estimate for blocks of size 2^( 7) =       0.000418498005

      target function =                  N/A
              le_mean =     -17.216868834850
             les_mean =     296.737315850641
             stat err =       0.000416756335
             autocorr =       1.154344722733
              std dev =       0.548566707567
             le_variance =       0.300925432651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686883485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868834927       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868834927       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868834927       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216868834927       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216218365443       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216951665245       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217403835919       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217894523499       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217120315438       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216743131207       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216606627718       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217084768300       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216981258665       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216610976379       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217521265724       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216589406899       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217433224440       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216294763215       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215749295532       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217012853022       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217555731253       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217086167024       residual = 5.01e-05           smallest_sin_value = 9.98e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+11 is 6.599703e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868834927       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868834927       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216868834927       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217747398604       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.218049040604       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217119734253       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216150743276       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216612196732       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217360890829       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215999512440       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216375924341       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215866848864       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219263444496       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216265625735       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216995540125       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218529920432       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217116390908       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217407158715       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216382106182       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217325825335       residual = 9.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216044711911       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214409238847       residual = 6.71e-03           smallest_sin_value = 9.97e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+12 is 1.690751e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216868834927       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216868834927       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.59e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6906e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2345
    reference variance = 0.532889
====================================================
  Execution time = 1.5962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1788e-01
  Total weights = 1.9567e+06
  Execution time = 1.8666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388381802
  error estimate for blocks of size 2^( 2) =       0.000398674993
  error estimate for blocks of size 2^( 3) =       0.000407370107
  error estimate for blocks of size 2^( 4) =       0.000412929830
  error estimate for blocks of size 2^( 5) =       0.000417921443
  error estimate for blocks of size 2^( 6) =       0.000421157599
  error estimate for blocks of size 2^( 7) =       0.000422168925

      target function =                  N/A
              le_mean =     -17.216626790428
             les_mean =     296.730114515241
             stat err =       0.000418544449
             autocorr =       1.161356164415
              std dev =       0.549254811112
             le_variance =       0.301680847530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388381802
  error estimate for blocks of size 2^( 2) =       0.000398674993
  error estimate for blocks of size 2^( 3) =       0.000407370107
  error estimate for blocks of size 2^( 4) =       0.000412929830
  error estimate for blocks of size 2^( 5) =       0.000417921443
  error estimate for blocks of size 2^( 6) =       0.000421157599
  error estimate for blocks of size 2^( 7) =       0.000422168925

      target function =                  N/A
              le_mean =     -17.216626790428
             les_mean =     296.730114515241
             stat err =       0.000418544449
             autocorr =       1.161356164414
              std dev =       0.549254811112
             le_variance =       0.301680847530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388381802
  error estimate for blocks of size 2^( 2) =       0.000398674993
  error estimate for blocks of size 2^( 3) =       0.000407370107
  error estimate for blocks of size 2^( 4) =       0.000412929830
  error estimate for blocks of size 2^( 5) =       0.000417921443
  error estimate for blocks of size 2^( 6) =       0.000421157599
  error estimate for blocks of size 2^( 7) =       0.000422168925

      target function =                  N/A
              le_mean =     -17.216626790428
             les_mean =     296.730114515241
             stat err =       0.000418544449
             autocorr =       1.161356164415
              std dev =       0.549254811112
             le_variance =       0.301680847530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301661686275
                                         uncertainty =       0.002081036849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388381802
  error estimate for blocks of size 2^( 2) =       0.000398674993
  error estimate for blocks of size 2^( 3) =       0.000407370107
  error estimate for blocks of size 2^( 4) =       0.000412929830
  error estimate for blocks of size 2^( 5) =       0.000417921443
  error estimate for blocks of size 2^( 6) =       0.000421157599
  error estimate for blocks of size 2^( 7) =       0.000422168925

      target function =                  N/A
              le_mean =     -17.216626790428
             les_mean =     296.730114515241
             stat err =       0.000418544449
             autocorr =       1.161356164415
              std dev =       0.549254811112
             le_variance =       0.301680847530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216626790428        initial
     5.9605e+11     5.9605e+12             6.5997e-16       -17.216626790428
     2.3842e+12     2.3842e+13             1.6908e-16       -17.216626790428  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216626790428

*****************************************************************************
Applying the update for shift_i =   2.3842e+12     and shift_s =   2.3842e+13
*****************************************************************************

  Execution time = 2.5346e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2601
    reference variance = 0.201994
====================================================
  Execution time = 1.3987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1487e-01
  Total weights = 1.956388357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300850449132
                                         uncertainty =       0.002090720442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300850449132
                                         uncertainty =       0.002090720442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387852038
  error estimate for blocks of size 2^( 2) =       0.000397682005
  error estimate for blocks of size 2^( 3) =       0.000406777475
  error estimate for blocks of size 2^( 4) =       0.000413159641
  error estimate for blocks of size 2^( 5) =       0.000416207825
  error estimate for blocks of size 2^( 6) =       0.000417161710
  error estimate for blocks of size 2^( 7) =       0.000419097084

      target function =                  N/A
              le_mean =     -17.216510349148
             les_mean =     296.723094601295
             stat err =       0.000416406565
             autocorr =       1.152664667837
              std dev =       0.548505611889
             le_variance =       0.300858406274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651034915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216510349201       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216510349201       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216510349201       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216510349201       residual = 8.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+11 is 4.871985e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216510349201       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216510349201       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216510349201       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216510349201       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217285575680       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215614684778       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216266813186       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214266160987       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212661195641       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213144404959       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212445860022       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213513454146       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214988139006       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215667281493       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215227577172       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217462188018       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215993710463       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217344724616       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214169298017       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.219612837317       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216325619163       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215532935945       residual = 2.29e-03           smallest_sin_value = 9.99e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+12 is 1.235759e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216510349201       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216510349201       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216510349201       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216020044756       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216510349202       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216347690209       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.221103701006       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217727866247       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.231096359254       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215858141629       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.240926549126       residual = 4.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214559557864       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211077916474       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.222439263691       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.225234346273       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.207568439456       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.219990171354       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213928598387       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.201709632884       residual = 1.33e-03           smallest_sin_value = 9.98e-01
davidson iteration   19:   krylov dim =  20   energy =     -17.201249915787       residual = 2.92e-03           smallest_sin_value = 9.93e-01
davidson iteration   20: stopping due to imaginary component in cost function
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+12 is 3.029905e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6531e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1441
    reference variance = 0.508753
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1322e-01
  Total weights = 1.9569e+06
  Execution time = 1.8568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386618153
  error estimate for blocks of size 2^( 2) =       0.000396394259
  error estimate for blocks of size 2^( 3) =       0.000405292235
  error estimate for blocks of size 2^( 4) =       0.000411357997
  error estimate for blocks of size 2^( 5) =       0.000415614374
  error estimate for blocks of size 2^( 6) =       0.000417775525
  error estimate for blocks of size 2^( 7) =       0.000417387908

      target function =                  N/A
              le_mean =     -17.217002278484
             les_mean =     296.738387862019
             stat err =       0.000415533951
             autocorr =       1.155177029471
              std dev =       0.546760634745
             le_variance =       0.298947191706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386618153
  error estimate for blocks of size 2^( 2) =       0.000396394259
  error estimate for blocks of size 2^( 3) =       0.000405292235
  error estimate for blocks of size 2^( 4) =       0.000411357997
  error estimate for blocks of size 2^( 5) =       0.000415614374
  error estimate for blocks of size 2^( 6) =       0.000417775525
  error estimate for blocks of size 2^( 7) =       0.000417387908

      target function =                  N/A
              le_mean =     -17.217002278484
             les_mean =     296.738387862019
             stat err =       0.000415533951
             autocorr =       1.155177029471
              std dev =       0.546760634745
             le_variance =       0.298947191707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386618153
  error estimate for blocks of size 2^( 2) =       0.000396394259
  error estimate for blocks of size 2^( 3) =       0.000405292235
  error estimate for blocks of size 2^( 4) =       0.000411357997
  error estimate for blocks of size 2^( 5) =       0.000415614374
  error estimate for blocks of size 2^( 6) =       0.000417775525
  error estimate for blocks of size 2^( 7) =       0.000417387908

      target function =                  N/A
              le_mean =     -17.217002278484
             les_mean =     296.738387862019
             stat err =       0.000415533951
             autocorr =       1.155177029471
              std dev =       0.546760634745
             le_variance =       0.298947191707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870804612
                                         uncertainty =       0.001763362164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386618153
  error estimate for blocks of size 2^( 2) =       0.000396394259
  error estimate for blocks of size 2^( 3) =       0.000405292235
  error estimate for blocks of size 2^( 4) =       0.000411357997
  error estimate for blocks of size 2^( 5) =       0.000415614374
  error estimate for blocks of size 2^( 6) =       0.000417775525
  error estimate for blocks of size 2^( 7) =       0.000417387908

      target function =                  N/A
              le_mean =     -17.217002278484
             les_mean =     296.738387862019
             stat err =       0.000415533951
             autocorr =       1.155177029471
              std dev =       0.546760634745
             le_variance =       0.298947191706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217002278484        initial  <--
     5.9605e+11     5.9605e+12             4.8720e-16       -17.217002278484
     2.3842e+12     2.3842e+13             1.2358e-16       -17.217002278484
     9.5367e+12     9.5367e+13             3.0299e-17       -17.217002278484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1356
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2867
    reference variance = 0.321733
====================================================
  Execution time = 1.4168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1375e-01
  Total weights = 1.956645009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299416091334
                                         uncertainty =       0.001979361369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299416091334
                                         uncertainty =       0.001979361369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386893383
  error estimate for blocks of size 2^( 2) =       0.000396628492
  error estimate for blocks of size 2^( 3) =       0.000404891384
  error estimate for blocks of size 2^( 4) =       0.000410574225
  error estimate for blocks of size 2^( 5) =       0.000414698673
  error estimate for blocks of size 2^( 6) =       0.000416490434
  error estimate for blocks of size 2^( 7) =       0.000418754562

      target function =                  N/A
              le_mean =     -17.216522629526
             les_mean =     296.722403679481
             stat err =       0.000415129474
             autocorr =       1.151289474626
              std dev =       0.547149868963
             le_variance =       0.299372979106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652262953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216522629612       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.55e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6695e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.127849
====================================================
  Execution time = 1.3738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1405e-01
  Total weights = 1.9569e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387170005
  error estimate for blocks of size 2^( 2) =       0.000396901098
  error estimate for blocks of size 2^( 3) =       0.000405765193
  error estimate for blocks of size 2^( 4) =       0.000411487372
  error estimate for blocks of size 2^( 5) =       0.000414758197
  error estimate for blocks of size 2^( 6) =       0.000416175098
  error estimate for blocks of size 2^( 7) =       0.000417287286

      target function =                  N/A
              le_mean =     -17.216529786847
             les_mean =     296.722945036543
             stat err =       0.000414926988
             autocorr =       1.148523694767
              std dev =       0.547541071658
             le_variance =       0.299801225153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387170005
  error estimate for blocks of size 2^( 2) =       0.000396901098
  error estimate for blocks of size 2^( 3) =       0.000405765193
  error estimate for blocks of size 2^( 4) =       0.000411487372
  error estimate for blocks of size 2^( 5) =       0.000414758197
  error estimate for blocks of size 2^( 6) =       0.000416175098
  error estimate for blocks of size 2^( 7) =       0.000417287286

      target function =                  N/A
              le_mean =     -17.216529786847
             les_mean =     296.722945036543
             stat err =       0.000414926988
             autocorr =       1.148523694767
              std dev =       0.547541071658
             le_variance =       0.299801225153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387170005
  error estimate for blocks of size 2^( 2) =       0.000396901098
  error estimate for blocks of size 2^( 3) =       0.000405765193
  error estimate for blocks of size 2^( 4) =       0.000411487372
  error estimate for blocks of size 2^( 5) =       0.000414758197
  error estimate for blocks of size 2^( 6) =       0.000416175098
  error estimate for blocks of size 2^( 7) =       0.000417287286

      target function =                  N/A
              le_mean =     -17.216529786847
             les_mean =     296.722945036543
             stat err =       0.000414926988
             autocorr =       1.148523694767
              std dev =       0.547541071658
             le_variance =       0.299801225153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299520470607
                                         uncertainty =       0.001803390277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387170005
  error estimate for blocks of size 2^( 2) =       0.000396901098
  error estimate for blocks of size 2^( 3) =       0.000405765193
  error estimate for blocks of size 2^( 4) =       0.000411487372
  error estimate for blocks of size 2^( 5) =       0.000414758197
  error estimate for blocks of size 2^( 6) =       0.000416175098
  error estimate for blocks of size 2^( 7) =       0.000417287286

      target function =                  N/A
              le_mean =     -17.216529786847
             les_mean =     296.722945036543
             stat err =       0.000414926988
             autocorr =       1.148523694767
              std dev =       0.547541071658
             le_variance =       0.299801225153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216529786847        initial  <--
     5.9605e+12     5.9605e+13             0.0000e+00       -17.216529786847
     2.3842e+13     2.3842e+14             0.0000e+00       -17.216529786847
     9.5367e+13     9.5367e+14             0.0000e+00       -17.216529786847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1353
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2286
    reference variance = 0.244288
====================================================
  Execution time = 1.4158e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1450e-01
  Total weights = 1.956634003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299163767856
                                         uncertainty =       0.001922520318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299163767856
                                         uncertainty =       0.001922520318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386696024
  error estimate for blocks of size 2^( 2) =       0.000396249276
  error estimate for blocks of size 2^( 3) =       0.000405020768
  error estimate for blocks of size 2^( 4) =       0.000411007094
  error estimate for blocks of size 2^( 5) =       0.000415472331
  error estimate for blocks of size 2^( 6) =       0.000417556974
  error estimate for blocks of size 2^( 7) =       0.000418958809

      target function =                  N/A
              le_mean =     -17.217217982395
             les_mean =     296.747097267635
             stat err =       0.000415748802
             autocorr =       1.155906218743
              std dev =       0.546870761487
             le_variance =       0.299067629769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721798239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.14e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.14e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217217982487       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.14e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6695e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2582
    reference variance = 0.193653
====================================================
  Execution time = 1.3601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0996e-01
  Total weights = 1.9568e+06
  Execution time = 1.8661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385801499
  error estimate for blocks of size 2^( 2) =       0.000395893470
  error estimate for blocks of size 2^( 3) =       0.000404551404
  error estimate for blocks of size 2^( 4) =       0.000411098359
  error estimate for blocks of size 2^( 5) =       0.000414609987
  error estimate for blocks of size 2^( 6) =       0.000415615808
  error estimate for blocks of size 2^( 7) =       0.000417505311

      target function =                  N/A
              le_mean =     -17.217162625224
             les_mean =     296.740651097392
             stat err =       0.000414707366
             autocorr =       1.155462030781
              std dev =       0.545605711754
             le_variance =       0.297685592699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385801499
  error estimate for blocks of size 2^( 2) =       0.000395893470
  error estimate for blocks of size 2^( 3) =       0.000404551404
  error estimate for blocks of size 2^( 4) =       0.000411098359
  error estimate for blocks of size 2^( 5) =       0.000414609987
  error estimate for blocks of size 2^( 6) =       0.000415615808
  error estimate for blocks of size 2^( 7) =       0.000417505311

      target function =                  N/A
              le_mean =     -17.217162625224
             les_mean =     296.740651097392
             stat err =       0.000414707366
             autocorr =       1.155462030781
              std dev =       0.545605711754
             le_variance =       0.297685592699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385801499
  error estimate for blocks of size 2^( 2) =       0.000395893470
  error estimate for blocks of size 2^( 3) =       0.000404551404
  error estimate for blocks of size 2^( 4) =       0.000411098359
  error estimate for blocks of size 2^( 5) =       0.000414609987
  error estimate for blocks of size 2^( 6) =       0.000415615808
  error estimate for blocks of size 2^( 7) =       0.000417505311

      target function =                  N/A
              le_mean =     -17.217162625224
             les_mean =     296.740651097392
             stat err =       0.000414707366
             autocorr =       1.155462030781
              std dev =       0.545605711754
             le_variance =       0.297685592699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297639006593
                                         uncertainty =       0.001752102485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385801499
  error estimate for blocks of size 2^( 2) =       0.000395893470
  error estimate for blocks of size 2^( 3) =       0.000404551404
  error estimate for blocks of size 2^( 4) =       0.000411098359
  error estimate for blocks of size 2^( 5) =       0.000414609987
  error estimate for blocks of size 2^( 6) =       0.000415615808
  error estimate for blocks of size 2^( 7) =       0.000417505311

      target function =                  N/A
              le_mean =     -17.217162625224
             les_mean =     296.740651097392
             stat err =       0.000414707366
             autocorr =       1.155462030781
              std dev =       0.545605711754
             le_variance =       0.297685592699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217162625224        initial  <--
     5.9605e+13     5.9605e+14             0.0000e+00       -17.217162625224
     2.3842e+14     2.3842e+15             0.0000e+00       -17.217162625224
     9.5367e+14     9.5367e+15             0.0000e+00       -17.217162625224

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0083
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.174047
====================================================
  Execution time = 1.4170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1155e-01
  Total weights = 1.956810930e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298616435151
                                         uncertainty =       0.001546518077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298616435151
                                         uncertainty =       0.001546518077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386391870
  error estimate for blocks of size 2^( 2) =       0.000396535479
  error estimate for blocks of size 2^( 3) =       0.000405478030
  error estimate for blocks of size 2^( 4) =       0.000411915574
  error estimate for blocks of size 2^( 5) =       0.000417123216
  error estimate for blocks of size 2^( 6) =       0.000418290390
  error estimate for blocks of size 2^( 7) =       0.000420258665

      target function =                  N/A
              le_mean =     -17.216404255553
             les_mean =     296.716128319419
             stat err =       0.000416896961
             autocorr =       1.164130046392
              std dev =       0.546440623242
             le_variance =       0.298597354729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640425555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216404255609       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.45e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+14 is 6.713111e-19

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216404255609       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.43e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+15 is 1.678278e-19

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216404255609       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404255609       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+15 is 4.195695e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6674e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.156009
====================================================
  Execution time = 1.3537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1998e-01
  Total weights = 1.9571e+06
  Execution time = 1.8460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388768938
  error estimate for blocks of size 2^( 2) =       0.000398460043
  error estimate for blocks of size 2^( 3) =       0.000406974055
  error estimate for blocks of size 2^( 4) =       0.000413910501
  error estimate for blocks of size 2^( 5) =       0.000417374292
  error estimate for blocks of size 2^( 6) =       0.000420067113
  error estimate for blocks of size 2^( 7) =       0.000420614015

      target function =                  N/A
              le_mean =     -17.216967423824
             les_mean =     296.743944482141
             stat err =       0.000417991480
             autocorr =       1.155983789758
              std dev =       0.549802304135
             le_variance =       0.302282573632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388768938
  error estimate for blocks of size 2^( 2) =       0.000398460043
  error estimate for blocks of size 2^( 3) =       0.000406974055
  error estimate for blocks of size 2^( 4) =       0.000413910501
  error estimate for blocks of size 2^( 5) =       0.000417374292
  error estimate for blocks of size 2^( 6) =       0.000420067113
  error estimate for blocks of size 2^( 7) =       0.000420614015

      target function =                  N/A
              le_mean =     -17.216967423824
             les_mean =     296.743944482141
             stat err =       0.000417991480
             autocorr =       1.155983789759
              std dev =       0.549802304135
             le_variance =       0.302282573632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388768938
  error estimate for blocks of size 2^( 2) =       0.000398460043
  error estimate for blocks of size 2^( 3) =       0.000406974055
  error estimate for blocks of size 2^( 4) =       0.000413910501
  error estimate for blocks of size 2^( 5) =       0.000417374292
  error estimate for blocks of size 2^( 6) =       0.000420067113
  error estimate for blocks of size 2^( 7) =       0.000420614015

      target function =                  N/A
              le_mean =     -17.216967423824
             les_mean =     296.743944482141
             stat err =       0.000417991480
             autocorr =       1.155983789758
              std dev =       0.549802304135
             le_variance =       0.302282573632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302344842634
                                         uncertainty =       0.002071124029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388768938
  error estimate for blocks of size 2^( 2) =       0.000398460043
  error estimate for blocks of size 2^( 3) =       0.000406974055
  error estimate for blocks of size 2^( 4) =       0.000413910501
  error estimate for blocks of size 2^( 5) =       0.000417374292
  error estimate for blocks of size 2^( 6) =       0.000420067113
  error estimate for blocks of size 2^( 7) =       0.000420614015

      target function =                  N/A
              le_mean =     -17.216967423824
             les_mean =     296.743944482141
             stat err =       0.000417991480
             autocorr =       1.155983789758
              std dev =       0.549802304135
             le_variance =       0.302282573632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216967423824        initial  <--
     5.9605e+14     5.9605e+15             6.7131e-19       -17.216967423824
     2.3842e+15     2.3842e+16             1.6783e-19       -17.216967423824
     9.5367e+15     9.5367e+16             4.1957e-20       -17.216967423824

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8117
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2924
    reference variance = 0.586693
====================================================
  Execution time = 1.4130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1304e-01
  Total weights = 1.957261607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298067838950
                                         uncertainty =       0.002166513127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298067838950
                                         uncertainty =       0.002166513127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386070735
  error estimate for blocks of size 2^( 2) =       0.000395680038
  error estimate for blocks of size 2^( 3) =       0.000404235989
  error estimate for blocks of size 2^( 4) =       0.000411050584
  error estimate for blocks of size 2^( 5) =       0.000414519430
  error estimate for blocks of size 2^( 6) =       0.000416400642
  error estimate for blocks of size 2^( 7) =       0.000418576945

      target function =                  N/A
              le_mean =     -17.215706816942
             les_mean =     296.693599216025
             stat err =       0.000415136900
             autocorr =       1.156242452745
              std dev =       0.545986469983
             le_variance =       0.298101225404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570681694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215706816976       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6632e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3436
    reference variance = 0.513765
====================================================
  Execution time = 1.3757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2049e-01
  Total weights = 1.9569e+06
  Execution time = 1.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390133124
  error estimate for blocks of size 2^( 2) =       0.000399685970
  error estimate for blocks of size 2^( 3) =       0.000408028547
  error estimate for blocks of size 2^( 4) =       0.000414922910
  error estimate for blocks of size 2^( 5) =       0.000418465794
  error estimate for blocks of size 2^( 6) =       0.000421594087
  error estimate for blocks of size 2^( 7) =       0.000421856058

      target function =                  N/A
              le_mean =     -17.217111166173
             les_mean =     296.749411140096
             stat err =       0.000419209712
             autocorr =       1.154614540668
              std dev =       0.551731554392
             le_variance =       0.304407708111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390133124
  error estimate for blocks of size 2^( 2) =       0.000399685970
  error estimate for blocks of size 2^( 3) =       0.000408028547
  error estimate for blocks of size 2^( 4) =       0.000414922910
  error estimate for blocks of size 2^( 5) =       0.000418465794
  error estimate for blocks of size 2^( 6) =       0.000421594087
  error estimate for blocks of size 2^( 7) =       0.000421856058

      target function =                  N/A
              le_mean =     -17.217111166173
             les_mean =     296.749411140096
             stat err =       0.000419209712
             autocorr =       1.154614540668
              std dev =       0.551731554392
             le_variance =       0.304407708111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390133124
  error estimate for blocks of size 2^( 2) =       0.000399685970
  error estimate for blocks of size 2^( 3) =       0.000408028547
  error estimate for blocks of size 2^( 4) =       0.000414922910
  error estimate for blocks of size 2^( 5) =       0.000418465794
  error estimate for blocks of size 2^( 6) =       0.000421594087
  error estimate for blocks of size 2^( 7) =       0.000421856058

      target function =                  N/A
              le_mean =     -17.217111166173
             les_mean =     296.749411140096
             stat err =       0.000419209712
             autocorr =       1.154614540668
              std dev =       0.551731554392
             le_variance =       0.304407708111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304415188049
                                         uncertainty =       0.002439157235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390133124
  error estimate for blocks of size 2^( 2) =       0.000399685970
  error estimate for blocks of size 2^( 3) =       0.000408028547
  error estimate for blocks of size 2^( 4) =       0.000414922910
  error estimate for blocks of size 2^( 5) =       0.000418465794
  error estimate for blocks of size 2^( 6) =       0.000421594087
  error estimate for blocks of size 2^( 7) =       0.000421856058

      target function =                  N/A
              le_mean =     -17.217111166173
             les_mean =     296.749411140096
             stat err =       0.000419209712
             autocorr =       1.154614540668
              std dev =       0.551731554392
             le_variance =       0.304407708111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217111166173        initial  <--
     5.9605e+15     5.9605e+16             0.0000e+00       -17.217111166173
     2.3842e+16     2.3842e+17             0.0000e+00       -17.217111166173
     9.5367e+16     9.5367e+17             0.0000e+00       -17.217111166173

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0642
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1942
    reference variance = 0.215466
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1262e-01
  Total weights = 1.956549498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299782257450
                                         uncertainty =       0.001871331839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299782257450
                                         uncertainty =       0.001871331839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387194567
  error estimate for blocks of size 2^( 2) =       0.000396923115
  error estimate for blocks of size 2^( 3) =       0.000405849111
  error estimate for blocks of size 2^( 4) =       0.000412572269
  error estimate for blocks of size 2^( 5) =       0.000416907240
  error estimate for blocks of size 2^( 6) =       0.000419368467
  error estimate for blocks of size 2^( 7) =       0.000421937942

      target function =                  N/A
              le_mean =     -17.217056976278
             les_mean =     296.739673776343
             stat err =       0.000417696479
             autocorr =       1.163759177868
              std dev =       0.547575808635
             le_variance =       0.299839266202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721705697628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217056976346       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6691e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.226964
====================================================
  Execution time = 1.3606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1793e-01
  Total weights = 1.9566e+06
  Execution time = 1.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388943820
  error estimate for blocks of size 2^( 2) =       0.000398652240
  error estimate for blocks of size 2^( 3) =       0.000407573855
  error estimate for blocks of size 2^( 4) =       0.000414039483
  error estimate for blocks of size 2^( 5) =       0.000417869619
  error estimate for blocks of size 2^( 6) =       0.000419466932
  error estimate for blocks of size 2^( 7) =       0.000418918465

      target function =                  N/A
              le_mean =     -17.216565361040
             les_mean =     296.728049030139
             stat err =       0.000417573625
             autocorr =       1.152636499997
              std dev =       0.550049625493
             le_variance =       0.302554590505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388943820
  error estimate for blocks of size 2^( 2) =       0.000398652240
  error estimate for blocks of size 2^( 3) =       0.000407573855
  error estimate for blocks of size 2^( 4) =       0.000414039483
  error estimate for blocks of size 2^( 5) =       0.000417869619
  error estimate for blocks of size 2^( 6) =       0.000419466932
  error estimate for blocks of size 2^( 7) =       0.000418918465

      target function =                  N/A
              le_mean =     -17.216565361040
             les_mean =     296.728049030139
             stat err =       0.000417573625
             autocorr =       1.152636499997
              std dev =       0.550049625493
             le_variance =       0.302554590505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388943820
  error estimate for blocks of size 2^( 2) =       0.000398652240
  error estimate for blocks of size 2^( 3) =       0.000407573855
  error estimate for blocks of size 2^( 4) =       0.000414039483
  error estimate for blocks of size 2^( 5) =       0.000417869619
  error estimate for blocks of size 2^( 6) =       0.000419466932
  error estimate for blocks of size 2^( 7) =       0.000418918465

      target function =                  N/A
              le_mean =     -17.216565361040
             les_mean =     296.728049030139
             stat err =       0.000417573625
             autocorr =       1.152636499997
              std dev =       0.550049625493
             le_variance =       0.302554590505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302659925725
                                         uncertainty =       0.003415408144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388943820
  error estimate for blocks of size 2^( 2) =       0.000398652240
  error estimate for blocks of size 2^( 3) =       0.000407573855
  error estimate for blocks of size 2^( 4) =       0.000414039483
  error estimate for blocks of size 2^( 5) =       0.000417869619
  error estimate for blocks of size 2^( 6) =       0.000419466932
  error estimate for blocks of size 2^( 7) =       0.000418918465

      target function =                  N/A
              le_mean =     -17.216565361040
             les_mean =     296.728049030139
             stat err =       0.000417573625
             autocorr =       1.152636499997
              std dev =       0.550049625493
             le_variance =       0.302554590505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216565361040        initial  <--
     5.9605e+16     5.9605e+17             0.0000e+00       -17.216565361040
     2.3842e+17     2.3842e+18             0.0000e+00       -17.216565361040
     9.5367e+17     9.5367e+18             0.0000e+00       -17.216565361040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9358
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.233663
====================================================
  Execution time = 1.4093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2571e-01
  Total weights = 1.956652583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307128504290
                                         uncertainty =       0.007373746127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307128504290
                                         uncertainty =       0.007373746127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391882263
  error estimate for blocks of size 2^( 2) =       0.000401456410
  error estimate for blocks of size 2^( 3) =       0.000410234334
  error estimate for blocks of size 2^( 4) =       0.000416046137
  error estimate for blocks of size 2^( 5) =       0.000419584185
  error estimate for blocks of size 2^( 6) =       0.000423149653
  error estimate for blocks of size 2^( 7) =       0.000423616925

      target function =                  N/A
              le_mean =     -17.216661547160
             les_mean =     296.739144062813
             stat err =       0.000420599225
             autocorr =       1.151929027350
              std dev =       0.554205210941
             le_variance =       0.307143415834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666154716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661547202       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6612e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2543
    reference variance = 0.630645
====================================================
  Execution time = 1.3540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1332e-01
  Total weights = 1.9567e+06
  Execution time = 1.8480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387119215
  error estimate for blocks of size 2^( 2) =       0.000396953893
  error estimate for blocks of size 2^( 3) =       0.000405454095
  error estimate for blocks of size 2^( 4) =       0.000411856133
  error estimate for blocks of size 2^( 5) =       0.000416150610
  error estimate for blocks of size 2^( 6) =       0.000417670707
  error estimate for blocks of size 2^( 7) =       0.000418965198

      target function =                  N/A
              le_mean =     -17.217719319574
             les_mean =     296.763176260549
             stat err =       0.000416160662
             autocorr =       1.155666689554
              std dev =       0.547469243564
             le_variance =       0.299722572649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387119215
  error estimate for blocks of size 2^( 2) =       0.000396953893
  error estimate for blocks of size 2^( 3) =       0.000405454095
  error estimate for blocks of size 2^( 4) =       0.000411856133
  error estimate for blocks of size 2^( 5) =       0.000416150610
  error estimate for blocks of size 2^( 6) =       0.000417670707
  error estimate for blocks of size 2^( 7) =       0.000418965198

      target function =                  N/A
              le_mean =     -17.217719319574
             les_mean =     296.763176260549
             stat err =       0.000416160662
             autocorr =       1.155666689554
              std dev =       0.547469243564
             le_variance =       0.299722572649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387119215
  error estimate for blocks of size 2^( 2) =       0.000396953893
  error estimate for blocks of size 2^( 3) =       0.000405454095
  error estimate for blocks of size 2^( 4) =       0.000411856133
  error estimate for blocks of size 2^( 5) =       0.000416150610
  error estimate for blocks of size 2^( 6) =       0.000417670707
  error estimate for blocks of size 2^( 7) =       0.000418965198

      target function =                  N/A
              le_mean =     -17.217719319574
             les_mean =     296.763176260549
             stat err =       0.000416160662
             autocorr =       1.155666689554
              std dev =       0.547469243564
             le_variance =       0.299722572649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747150295
                                         uncertainty =       0.002047772709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387119215
  error estimate for blocks of size 2^( 2) =       0.000396953893
  error estimate for blocks of size 2^( 3) =       0.000405454095
  error estimate for blocks of size 2^( 4) =       0.000411856133
  error estimate for blocks of size 2^( 5) =       0.000416150610
  error estimate for blocks of size 2^( 6) =       0.000417670707
  error estimate for blocks of size 2^( 7) =       0.000418965198

      target function =                  N/A
              le_mean =     -17.217719319574
             les_mean =     296.763176260549
             stat err =       0.000416160662
             autocorr =       1.155666689554
              std dev =       0.547469243564
             le_variance =       0.299722572649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217719319574        initial  <--
     5.9605e+17     5.9605e+18             0.0000e+00       -17.217719319574
     2.3842e+18     2.3842e+19             0.0000e+00       -17.217719319574
     9.5367e+18     9.5367e+19             0.0000e+00       -17.217719319574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8277
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2363
    reference variance = 0.141946
====================================================
  Execution time = 1.6017e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1765e-01
  Total weights = 1.956739743e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302146763928
                                         uncertainty =       0.001879909938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302146763928
                                         uncertainty =       0.001879909938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388652472
  error estimate for blocks of size 2^( 2) =       0.000398462943
  error estimate for blocks of size 2^( 3) =       0.000407152682
  error estimate for blocks of size 2^( 4) =       0.000413471314
  error estimate for blocks of size 2^( 5) =       0.000417704505
  error estimate for blocks of size 2^( 6) =       0.000419630216
  error estimate for blocks of size 2^( 7) =       0.000423861597

      target function =                  N/A
              le_mean =     -17.216556100254
             les_mean =     296.727455994579
             stat err =       0.000418666908
             autocorr =       1.160417853885
              std dev =       0.549637596420
             le_variance =       0.302101487399


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655610025e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216556100270       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8522e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.239378
====================================================
  Execution time = 1.3552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1712e-01
  Total weights = 1.9567e+06
  Execution time = 1.8582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388357741
  error estimate for blocks of size 2^( 2) =       0.000397977736
  error estimate for blocks of size 2^( 3) =       0.000406526229
  error estimate for blocks of size 2^( 4) =       0.000412307749
  error estimate for blocks of size 2^( 5) =       0.000415409832
  error estimate for blocks of size 2^( 6) =       0.000416602822
  error estimate for blocks of size 2^( 7) =       0.000417621748

      target function =                  N/A
              le_mean =     -17.216968992726
             les_mean =     296.741146039002
             stat err =       0.000415485538
             autocorr =       1.144584576101
              std dev =       0.549220785009
             le_variance =       0.301643470686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388357741
  error estimate for blocks of size 2^( 2) =       0.000397977736
  error estimate for blocks of size 2^( 3) =       0.000406526229
  error estimate for blocks of size 2^( 4) =       0.000412307749
  error estimate for blocks of size 2^( 5) =       0.000415409832
  error estimate for blocks of size 2^( 6) =       0.000416602822
  error estimate for blocks of size 2^( 7) =       0.000417621748

      target function =                  N/A
              le_mean =     -17.216968992726
             les_mean =     296.741146039002
             stat err =       0.000415485538
             autocorr =       1.144584576101
              std dev =       0.549220785009
             le_variance =       0.301643470686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388357741
  error estimate for blocks of size 2^( 2) =       0.000397977736
  error estimate for blocks of size 2^( 3) =       0.000406526229
  error estimate for blocks of size 2^( 4) =       0.000412307749
  error estimate for blocks of size 2^( 5) =       0.000415409832
  error estimate for blocks of size 2^( 6) =       0.000416602822
  error estimate for blocks of size 2^( 7) =       0.000417621748

      target function =                  N/A
              le_mean =     -17.216968992726
             les_mean =     296.741146039002
             stat err =       0.000415485538
             autocorr =       1.144584576101
              std dev =       0.549220785009
             le_variance =       0.301643470686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301682467388
                                         uncertainty =       0.001936539334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388357741
  error estimate for blocks of size 2^( 2) =       0.000397977736
  error estimate for blocks of size 2^( 3) =       0.000406526229
  error estimate for blocks of size 2^( 4) =       0.000412307749
  error estimate for blocks of size 2^( 5) =       0.000415409832
  error estimate for blocks of size 2^( 6) =       0.000416602822
  error estimate for blocks of size 2^( 7) =       0.000417621748

      target function =                  N/A
              le_mean =     -17.216968992726
             les_mean =     296.741146039002
             stat err =       0.000415485538
             autocorr =       1.144584576101
              std dev =       0.549220785009
             le_variance =       0.301643470686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216968992726        initial  <--
     5.9605e+18     5.9605e+19             0.0000e+00       -17.216968992726
     2.3842e+19     2.3842e+20             0.0000e+00       -17.216968992726
     9.5367e+19     9.5367e+20             0.0000e+00       -17.216968992726

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8929
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.537004
====================================================
  Execution time = 1.3865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2135e-01
  Total weights = 1.956791683e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302516443375
                                         uncertainty =       0.002005303071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302516443375
                                         uncertainty =       0.002005303071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388903445
  error estimate for blocks of size 2^( 2) =       0.000398686691
  error estimate for blocks of size 2^( 3) =       0.000406688165
  error estimate for blocks of size 2^( 4) =       0.000413302593
  error estimate for blocks of size 2^( 5) =       0.000416764501
  error estimate for blocks of size 2^( 6) =       0.000418884488
  error estimate for blocks of size 2^( 7) =       0.000420650813

      target function =                  N/A
              le_mean =     -17.217172054239
             les_mean =     296.752364933698
             stat err =       0.000417400599
             autocorr =       1.151920624741
              std dev =       0.549992526822
             le_variance =       0.302491779560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717205424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217172054255       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217172054255       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217172054265       residual = 1.24e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217172054255       residual = 4.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+19 is 7.137190e-24

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217172054255       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217172054255       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217172054255       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+20 is 1.784439e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217172054255       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217172054255       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217172054293       residual = 4.96e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217172054255       residual = 4.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+20 is 4.460744e-25

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6370e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.209683
====================================================
  Execution time = 1.3665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3121e-01
  Total weights = 1.9570e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394518746
  error estimate for blocks of size 2^( 2) =       0.000404044394
  error estimate for blocks of size 2^( 3) =       0.000412461633
  error estimate for blocks of size 2^( 4) =       0.000418743978
  error estimate for blocks of size 2^( 5) =       0.000422620348
  error estimate for blocks of size 2^( 6) =       0.000423538751
  error estimate for blocks of size 2^( 7) =       0.000423889803

      target function =                  N/A
              le_mean =     -17.216821533823
             les_mean =     296.750156981857
             stat err =       0.000422198220
             autocorr =       1.145242636151
              std dev =       0.557933760932
             le_variance =       0.311290081588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394518746
  error estimate for blocks of size 2^( 2) =       0.000404044394
  error estimate for blocks of size 2^( 3) =       0.000412461633
  error estimate for blocks of size 2^( 4) =       0.000418743978
  error estimate for blocks of size 2^( 5) =       0.000422620348
  error estimate for blocks of size 2^( 6) =       0.000423538751
  error estimate for blocks of size 2^( 7) =       0.000423889803

      target function =                  N/A
              le_mean =     -17.216821533823
             les_mean =     296.750156981857
             stat err =       0.000422198220
             autocorr =       1.145242636151
              std dev =       0.557933760932
             le_variance =       0.311290081588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394518746
  error estimate for blocks of size 2^( 2) =       0.000404044394
  error estimate for blocks of size 2^( 3) =       0.000412461633
  error estimate for blocks of size 2^( 4) =       0.000418743978
  error estimate for blocks of size 2^( 5) =       0.000422620348
  error estimate for blocks of size 2^( 6) =       0.000423538751
  error estimate for blocks of size 2^( 7) =       0.000423889803

      target function =                  N/A
              le_mean =     -17.216821533823
             les_mean =     296.750156981857
             stat err =       0.000422198220
             autocorr =       1.145242636151
              std dev =       0.557933760932
             le_variance =       0.311290081588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311323305893
                                         uncertainty =       0.006639248434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394518746
  error estimate for blocks of size 2^( 2) =       0.000404044394
  error estimate for blocks of size 2^( 3) =       0.000412461633
  error estimate for blocks of size 2^( 4) =       0.000418743978
  error estimate for blocks of size 2^( 5) =       0.000422620348
  error estimate for blocks of size 2^( 6) =       0.000423538751
  error estimate for blocks of size 2^( 7) =       0.000423889803

      target function =                  N/A
              le_mean =     -17.216821533823
             les_mean =     296.750156981857
             stat err =       0.000422198220
             autocorr =       1.145242636151
              std dev =       0.557933760932
             le_variance =       0.311290081588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216821533823        initial  <--
     5.9605e+19     5.9605e+20             7.1372e-24       -17.216821533823
     2.3842e+20     2.3842e+21             1.7844e-24       -17.216821533823
     9.5367e+20     9.5367e+21             4.4607e-25       -17.216821533823

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0138
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1544
    reference variance = 0.246417
====================================================
  Execution time = 1.3980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1468e-01
  Total weights = 1.956929024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298373458647
                                         uncertainty =       0.001850428191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298373458647
                                         uncertainty =       0.001850428191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386197821
  error estimate for blocks of size 2^( 2) =       0.000395824339
  error estimate for blocks of size 2^( 3) =       0.000404214739
  error estimate for blocks of size 2^( 4) =       0.000410557764
  error estimate for blocks of size 2^( 5) =       0.000414592981
  error estimate for blocks of size 2^( 6) =       0.000416992701
  error estimate for blocks of size 2^( 7) =       0.000418881723

      target function =                  N/A
              le_mean =     -17.217219858498
             les_mean =     296.747342565284
             stat err =       0.000415256292
             autocorr =       1.156146327671
              std dev =       0.546166196811
             le_variance =       0.298297514539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721985850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+20, overlap shift 5.9605e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217219858563       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6489e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1969
    reference variance = 0.205399
====================================================
  Execution time = 1.3518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1432e-01
  Total weights = 1.9565e+06
  Execution time = 1.8481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386416506
  error estimate for blocks of size 2^( 2) =       0.000396034974
  error estimate for blocks of size 2^( 3) =       0.000404624425
  error estimate for blocks of size 2^( 4) =       0.000411255400
  error estimate for blocks of size 2^( 5) =       0.000414991202
  error estimate for blocks of size 2^( 6) =       0.000417983805
  error estimate for blocks of size 2^( 7) =       0.000417020119

      target function =                  N/A
              le_mean =     -17.217197224322
             les_mean =     296.746197551431
             stat err =       0.000415312631
             autocorr =       1.155151483712
              std dev =       0.546475464118
             le_variance =       0.298635432883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386416506
  error estimate for blocks of size 2^( 2) =       0.000396034974
  error estimate for blocks of size 2^( 3) =       0.000404624425
  error estimate for blocks of size 2^( 4) =       0.000411255400
  error estimate for blocks of size 2^( 5) =       0.000414991202
  error estimate for blocks of size 2^( 6) =       0.000417983805
  error estimate for blocks of size 2^( 7) =       0.000417020119

      target function =                  N/A
              le_mean =     -17.217197224322
             les_mean =     296.746197551431
             stat err =       0.000415312631
             autocorr =       1.155151483712
              std dev =       0.546475464118
             le_variance =       0.298635432883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386416506
  error estimate for blocks of size 2^( 2) =       0.000396034974
  error estimate for blocks of size 2^( 3) =       0.000404624425
  error estimate for blocks of size 2^( 4) =       0.000411255400
  error estimate for blocks of size 2^( 5) =       0.000414991202
  error estimate for blocks of size 2^( 6) =       0.000417983805
  error estimate for blocks of size 2^( 7) =       0.000417020119

      target function =                  N/A
              le_mean =     -17.217197224322
             les_mean =     296.746197551431
             stat err =       0.000415312631
             autocorr =       1.155151483712
              std dev =       0.546475464118
             le_variance =       0.298635432883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298566804429
                                         uncertainty =       0.001971458195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386416506
  error estimate for blocks of size 2^( 2) =       0.000396034974
  error estimate for blocks of size 2^( 3) =       0.000404624425
  error estimate for blocks of size 2^( 4) =       0.000411255400
  error estimate for blocks of size 2^( 5) =       0.000414991202
  error estimate for blocks of size 2^( 6) =       0.000417983805
  error estimate for blocks of size 2^( 7) =       0.000417020119

      target function =                  N/A
              le_mean =     -17.217197224322
             les_mean =     296.746197551431
             stat err =       0.000415312631
             autocorr =       1.155151483712
              std dev =       0.546475464118
             le_variance =       0.298635432883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217197224322        initial  <--
     5.9605e+20     5.9605e+21             0.0000e+00       -17.217197224322
     2.3842e+21     2.3842e+22             0.0000e+00       -17.217197224322
     9.5367e+21     9.5367e+22             0.0000e+00       -17.217197224322

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8052
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9300e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.12
    reference variance = 0.304162
====================================================
  Execution time = 1.4010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.956651618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300131103137
                                         uncertainty =       0.001932195928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300131103137
                                         uncertainty =       0.001932195928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387396225
  error estimate for blocks of size 2^( 2) =       0.000397464693
  error estimate for blocks of size 2^( 3) =       0.000406191272
  error estimate for blocks of size 2^( 4) =       0.000412817769
  error estimate for blocks of size 2^( 5) =       0.000416009472
  error estimate for blocks of size 2^( 6) =       0.000418395964
  error estimate for blocks of size 2^( 7) =       0.000420482027

      target function =                  N/A
              le_mean =     -17.216519251903
             les_mean =     296.721031754619
             stat err =       0.000416926308
             autocorr =       1.158264726476
              std dev =       0.547860995820
             le_variance =       0.300151670740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651925190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+21, overlap shift 5.9605e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519251914       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172339 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6510e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1635
    reference variance = 0.127955
====================================================
  Execution time = 1.3620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1538e-01
  Total weights = 1.9566e+06
  Execution time = 1.8498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387382757
  error estimate for blocks of size 2^( 2) =       0.000397194948
  error estimate for blocks of size 2^( 3) =       0.000405783684
  error estimate for blocks of size 2^( 4) =       0.000412255250
  error estimate for blocks of size 2^( 5) =       0.000416108476
  error estimate for blocks of size 2^( 6) =       0.000418879312
  error estimate for blocks of size 2^( 7) =       0.000418714036

      target function =                  N/A
              le_mean =     -17.216641052169
             les_mean =     296.728110384976
             stat err =       0.000416489269
             autocorr =       1.155918087204
              std dev =       0.547841949148
             le_variance =       0.300130801246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387382757
  error estimate for blocks of size 2^( 2) =       0.000397194948
  error estimate for blocks of size 2^( 3) =       0.000405783684
  error estimate for blocks of size 2^( 4) =       0.000412255250
  error estimate for blocks of size 2^( 5) =       0.000416108476
  error estimate for blocks of size 2^( 6) =       0.000418879312
  error estimate for blocks of size 2^( 7) =       0.000418714036

      target function =                  N/A
              le_mean =     -17.216641052169
             les_mean =     296.728110384976
             stat err =       0.000416489269
             autocorr =       1.155918087204
              std dev =       0.547841949148
             le_variance =       0.300130801246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387382757
  error estimate for blocks of size 2^( 2) =       0.000397194948
  error estimate for blocks of size 2^( 3) =       0.000405783684
  error estimate for blocks of size 2^( 4) =       0.000412255250
  error estimate for blocks of size 2^( 5) =       0.000416108476
  error estimate for blocks of size 2^( 6) =       0.000418879312
  error estimate for blocks of size 2^( 7) =       0.000418714036

      target function =                  N/A
              le_mean =     -17.216641052169
             les_mean =     296.728110384976
             stat err =       0.000416489269
             autocorr =       1.155918087204
              std dev =       0.547841949148
             le_variance =       0.300130801246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300124114838
                                         uncertainty =       0.002206632910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387382757
  error estimate for blocks of size 2^( 2) =       0.000397194948
  error estimate for blocks of size 2^( 3) =       0.000405783684
  error estimate for blocks of size 2^( 4) =       0.000412255250
  error estimate for blocks of size 2^( 5) =       0.000416108476
  error estimate for blocks of size 2^( 6) =       0.000418879312
  error estimate for blocks of size 2^( 7) =       0.000418714036

      target function =                  N/A
              le_mean =     -17.216641052169
             les_mean =     296.728110384976
             stat err =       0.000416489269
             autocorr =       1.155918087204
              std dev =       0.547841949148
             le_variance =       0.300130801246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216641052169        initial  <--
     5.9605e+21     5.9605e+22             0.0000e+00       -17.216641052169
     2.3842e+22     2.3842e+23             0.0000e+00       -17.216641052169
     9.5367e+22     9.5367e+23             0.0000e+00       -17.216641052169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9157
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.3131
    reference variance = 0.452867
====================================================
  Execution time = 1.4054e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1134e-01
  Total weights = 1.957032148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298409272717
                                         uncertainty =       0.002040715578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298409272717
                                         uncertainty =       0.002040715578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386260011
  error estimate for blocks of size 2^( 2) =       0.000395748266
  error estimate for blocks of size 2^( 3) =       0.000404494879
  error estimate for blocks of size 2^( 4) =       0.000410791610
  error estimate for blocks of size 2^( 5) =       0.000416075827
  error estimate for blocks of size 2^( 6) =       0.000417495529
  error estimate for blocks of size 2^( 7) =       0.000417304839

      target function =                  N/A
              le_mean =     -17.216873858646
             les_mean =     296.732090213435
             stat err =       0.000415416951
             autocorr =       1.156668559427
              std dev =       0.546254146228
             le_variance =       0.298393592272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687385865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+22, overlap shift 5.9605e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216873858709       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+22 is 5.876354e-27

solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216873858709       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+23 is 1.469089e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216873858709       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216873858709       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+23 is 3.672721e-28

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6564e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1805
    reference variance = 0.543155
====================================================
  Execution time = 1.3607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1350e-01
  Total weights = 1.9568e+06
  Execution time = 1.8515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387081626
  error estimate for blocks of size 2^( 2) =       0.000396639775
  error estimate for blocks of size 2^( 3) =       0.000405056994
  error estimate for blocks of size 2^( 4) =       0.000412589463
  error estimate for blocks of size 2^( 5) =       0.000415951127
  error estimate for blocks of size 2^( 6) =       0.000418405082
  error estimate for blocks of size 2^( 7) =       0.000419791867

      target function =                  N/A
              le_mean =     -17.216315703159
             les_mean =     296.715030951560
             stat err =       0.000416684385
             autocorr =       1.158802269403
              std dev =       0.547416085469
             le_variance =       0.299664370630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387081626
  error estimate for blocks of size 2^( 2) =       0.000396639775
  error estimate for blocks of size 2^( 3) =       0.000405056994
  error estimate for blocks of size 2^( 4) =       0.000412589463
  error estimate for blocks of size 2^( 5) =       0.000415951127
  error estimate for blocks of size 2^( 6) =       0.000418405082
  error estimate for blocks of size 2^( 7) =       0.000419791867

      target function =                  N/A
              le_mean =     -17.216315703159
             les_mean =     296.715030951560
             stat err =       0.000416684385
             autocorr =       1.158802269403
              std dev =       0.547416085469
             le_variance =       0.299664370630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387081626
  error estimate for blocks of size 2^( 2) =       0.000396639775
  error estimate for blocks of size 2^( 3) =       0.000405056994
  error estimate for blocks of size 2^( 4) =       0.000412589463
  error estimate for blocks of size 2^( 5) =       0.000415951127
  error estimate for blocks of size 2^( 6) =       0.000418405082
  error estimate for blocks of size 2^( 7) =       0.000419791867

      target function =                  N/A
              le_mean =     -17.216315703159
             les_mean =     296.715030951560
             stat err =       0.000416684385
             autocorr =       1.158802269403
              std dev =       0.547416085469
             le_variance =       0.299664370630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299604734707
                                         uncertainty =       0.001902407177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387081626
  error estimate for blocks of size 2^( 2) =       0.000396639775
  error estimate for blocks of size 2^( 3) =       0.000405056994
  error estimate for blocks of size 2^( 4) =       0.000412589463
  error estimate for blocks of size 2^( 5) =       0.000415951127
  error estimate for blocks of size 2^( 6) =       0.000418405082
  error estimate for blocks of size 2^( 7) =       0.000419791867

      target function =                  N/A
              le_mean =     -17.216315703159
             les_mean =     296.715030951560
             stat err =       0.000416684385
             autocorr =       1.158802269403
              std dev =       0.547416085469
             le_variance =       0.299664370630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216315703159        initial  <--
     5.9605e+22     5.9605e+23             5.8764e-27       -17.216315703159
     2.3842e+23     2.3842e+24             1.4691e-27       -17.216315703159
     9.5367e+23     9.5367e+24             3.6727e-28       -17.216315703159

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0116
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2048
    reference variance = 0.334733
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1998e-01
  Total weights = 1.956705948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302703308786
                                         uncertainty =       0.002601116073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302703308786
                                         uncertainty =       0.002601116073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389028145
  error estimate for blocks of size 2^( 2) =       0.000398909804
  error estimate for blocks of size 2^( 3) =       0.000407805318
  error estimate for blocks of size 2^( 4) =       0.000414171270
  error estimate for blocks of size 2^( 5) =       0.000418532747
  error estimate for blocks of size 2^( 6) =       0.000421030922
  error estimate for blocks of size 2^( 7) =       0.000423183609

      target function =                  N/A
              le_mean =     -17.216564367718
             les_mean =     296.730068735772
             stat err =       0.000419229637
             autocorr =       1.161293267848
              std dev =       0.550168879438
             le_variance =       0.302685795903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656436772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+23, overlap shift 5.9605e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564367785       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6628e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2592
    reference variance = 0.22542
====================================================
  Execution time = 1.3656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1862e-01
  Total weights = 1.9570e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389596767
  error estimate for blocks of size 2^( 2) =       0.000399086289
  error estimate for blocks of size 2^( 3) =       0.000407692024
  error estimate for blocks of size 2^( 4) =       0.000414038932
  error estimate for blocks of size 2^( 5) =       0.000417685409
  error estimate for blocks of size 2^( 6) =       0.000420664385
  error estimate for blocks of size 2^( 7) =       0.000422874369

      target function =                  N/A
              le_mean =     -17.216298152749
             les_mean =     296.719545413114
             stat err =       0.000418815774
             autocorr =       1.155620857387
              std dev =       0.550973032025
             le_variance =       0.303571282019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389596767
  error estimate for blocks of size 2^( 2) =       0.000399086289
  error estimate for blocks of size 2^( 3) =       0.000407692024
  error estimate for blocks of size 2^( 4) =       0.000414038932
  error estimate for blocks of size 2^( 5) =       0.000417685409
  error estimate for blocks of size 2^( 6) =       0.000420664385
  error estimate for blocks of size 2^( 7) =       0.000422874369

      target function =                  N/A
              le_mean =     -17.216298152749
             les_mean =     296.719545413114
             stat err =       0.000418815774
             autocorr =       1.155620857387
              std dev =       0.550973032025
             le_variance =       0.303571282019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389596767
  error estimate for blocks of size 2^( 2) =       0.000399086289
  error estimate for blocks of size 2^( 3) =       0.000407692024
  error estimate for blocks of size 2^( 4) =       0.000414038932
  error estimate for blocks of size 2^( 5) =       0.000417685409
  error estimate for blocks of size 2^( 6) =       0.000420664385
  error estimate for blocks of size 2^( 7) =       0.000422874369

      target function =                  N/A
              le_mean =     -17.216298152749
             les_mean =     296.719545413114
             stat err =       0.000418815774
             autocorr =       1.155620857387
              std dev =       0.550973032025
             le_variance =       0.303571282019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303593659762
                                         uncertainty =       0.002233503641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389596767
  error estimate for blocks of size 2^( 2) =       0.000399086289
  error estimate for blocks of size 2^( 3) =       0.000407692024
  error estimate for blocks of size 2^( 4) =       0.000414038932
  error estimate for blocks of size 2^( 5) =       0.000417685409
  error estimate for blocks of size 2^( 6) =       0.000420664385
  error estimate for blocks of size 2^( 7) =       0.000422874369

      target function =                  N/A
              le_mean =     -17.216298152749
             les_mean =     296.719545413114
             stat err =       0.000418815774
             autocorr =       1.155620857387
              std dev =       0.550973032025
             le_variance =       0.303571282019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216298152749        initial  <--
     5.9605e+23     5.9605e+24             0.0000e+00       -17.216298152749
     2.3842e+24     2.3842e+25             0.0000e+00       -17.216298152749
     9.5367e+24     9.5367e+25             0.0000e+00       -17.216298152749

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9998
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1922
    reference variance = 0.221424
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1520e-01
  Total weights = 1.956536167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302815525877
                                         uncertainty =       0.001986338584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302815525877
                                         uncertainty =       0.001986338584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389110363
  error estimate for blocks of size 2^( 2) =       0.000398545652
  error estimate for blocks of size 2^( 3) =       0.000407742502
  error estimate for blocks of size 2^( 4) =       0.000414246218
  error estimate for blocks of size 2^( 5) =       0.000418389186
  error estimate for blocks of size 2^( 6) =       0.000420626360
  error estimate for blocks of size 2^( 7) =       0.000421270893

      target function =                  N/A
              le_mean =     -17.217208647169
             les_mean =     296.747474059516
             stat err =       0.000418633164
             autocorr =       1.157501778495
              std dev =       0.550285152114
             le_variance =       0.302813748638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721720864717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+24, overlap shift 5.9605e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217208647233       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6552e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2469
    reference variance = 0.198441
====================================================
  Execution time = 1.3557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1803e-01
  Total weights = 1.9567e+06
  Execution time = 1.8499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211541
  error estimate for blocks of size 2^( 2) =       0.000397860245
  error estimate for blocks of size 2^( 3) =       0.000406825662
  error estimate for blocks of size 2^( 4) =       0.000412649480
  error estimate for blocks of size 2^( 5) =       0.000415891794
  error estimate for blocks of size 2^( 6) =       0.000419044485
  error estimate for blocks of size 2^( 7) =       0.000419395896

      target function =                  N/A
              le_mean =     -17.216301114390
             les_mean =     296.719053875511
             stat err =       0.000416745414
             autocorr =       1.152404046760
              std dev =       0.549014026070
             le_variance =       0.301416400821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211541
  error estimate for blocks of size 2^( 2) =       0.000397860245
  error estimate for blocks of size 2^( 3) =       0.000406825662
  error estimate for blocks of size 2^( 4) =       0.000412649480
  error estimate for blocks of size 2^( 5) =       0.000415891794
  error estimate for blocks of size 2^( 6) =       0.000419044485
  error estimate for blocks of size 2^( 7) =       0.000419395896

      target function =                  N/A
              le_mean =     -17.216301114390
             les_mean =     296.719053875511
             stat err =       0.000416745414
             autocorr =       1.152404046760
              std dev =       0.549014026070
             le_variance =       0.301416400821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211541
  error estimate for blocks of size 2^( 2) =       0.000397860245
  error estimate for blocks of size 2^( 3) =       0.000406825662
  error estimate for blocks of size 2^( 4) =       0.000412649480
  error estimate for blocks of size 2^( 5) =       0.000415891794
  error estimate for blocks of size 2^( 6) =       0.000419044485
  error estimate for blocks of size 2^( 7) =       0.000419395896

      target function =                  N/A
              le_mean =     -17.216301114390
             les_mean =     296.719053875511
             stat err =       0.000416745414
             autocorr =       1.152404046760
              std dev =       0.549014026070
             le_variance =       0.301416400821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479927788
                                         uncertainty =       0.001693372113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211541
  error estimate for blocks of size 2^( 2) =       0.000397860245
  error estimate for blocks of size 2^( 3) =       0.000406825662
  error estimate for blocks of size 2^( 4) =       0.000412649480
  error estimate for blocks of size 2^( 5) =       0.000415891794
  error estimate for blocks of size 2^( 6) =       0.000419044485
  error estimate for blocks of size 2^( 7) =       0.000419395896

      target function =                  N/A
              le_mean =     -17.216301114390
             les_mean =     296.719053875511
             stat err =       0.000416745414
             autocorr =       1.152404046760
              std dev =       0.549014026070
             le_variance =       0.301416400821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216301114390        initial  <--
     5.9605e+24     5.9605e+25             0.0000e+00       -17.216301114390
     2.3842e+25     2.3842e+26             0.0000e+00       -17.216301114390
     9.5367e+25     9.5367e+26             0.0000e+00       -17.216301114390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8516
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.157121
====================================================
  Execution time = 1.4081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1344e-01
  Total weights = 1.956620719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300116021176
                                         uncertainty =       0.001908342686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300116021176
                                         uncertainty =       0.001908342686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387350136
  error estimate for blocks of size 2^( 2) =       0.000397041526
  error estimate for blocks of size 2^( 3) =       0.000405187643
  error estimate for blocks of size 2^( 4) =       0.000411245488
  error estimate for blocks of size 2^( 5) =       0.000415299744
  error estimate for blocks of size 2^( 6) =       0.000416696465
  error estimate for blocks of size 2^( 7) =       0.000417221326

      target function =                  N/A
              le_mean =     -17.216718356325
             les_mean =     296.728833207380
             stat err =       0.000415115756
             autocorr =       1.148500023173
              std dev =       0.547795816154
             le_variance =       0.300080256196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671835633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+25, overlap shift 5.9605e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718356386       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+25 is 7.420898e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718356386       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+26 is 1.855225e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718356386       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216718356386       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+26 is 4.638062e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6596e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1791
    reference variance = 0.132037
====================================================
  Execution time = 1.6066e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1609e-01
  Total weights = 1.9569e+06
  Execution time = 1.8511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387836381
  error estimate for blocks of size 2^( 2) =       0.000397648912
  error estimate for blocks of size 2^( 3) =       0.000405805585
  error estimate for blocks of size 2^( 4) =       0.000412647727
  error estimate for blocks of size 2^( 5) =       0.000417072596
  error estimate for blocks of size 2^( 6) =       0.000418423713
  error estimate for blocks of size 2^( 7) =       0.000420943664

      target function =                  N/A
              le_mean =     -17.217179767695
             les_mean =     296.747369059229
             stat err =       0.000417271925
             autocorr =       1.157553945849
              std dev =       0.548483470057
             le_variance =       0.300834116926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387836381
  error estimate for blocks of size 2^( 2) =       0.000397648912
  error estimate for blocks of size 2^( 3) =       0.000405805585
  error estimate for blocks of size 2^( 4) =       0.000412647727
  error estimate for blocks of size 2^( 5) =       0.000417072596
  error estimate for blocks of size 2^( 6) =       0.000418423713
  error estimate for blocks of size 2^( 7) =       0.000420943664

      target function =                  N/A
              le_mean =     -17.217179767695
             les_mean =     296.747369059229
             stat err =       0.000417271925
             autocorr =       1.157553945849
              std dev =       0.548483470057
             le_variance =       0.300834116926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387836381
  error estimate for blocks of size 2^( 2) =       0.000397648912
  error estimate for blocks of size 2^( 3) =       0.000405805585
  error estimate for blocks of size 2^( 4) =       0.000412647727
  error estimate for blocks of size 2^( 5) =       0.000417072596
  error estimate for blocks of size 2^( 6) =       0.000418423713
  error estimate for blocks of size 2^( 7) =       0.000420943664

      target function =                  N/A
              le_mean =     -17.217179767695
             les_mean =     296.747369059229
             stat err =       0.000417271925
             autocorr =       1.157553945849
              std dev =       0.548483470057
             le_variance =       0.300834116926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300792446251
                                         uncertainty =       0.002062431444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387836381
  error estimate for blocks of size 2^( 2) =       0.000397648912
  error estimate for blocks of size 2^( 3) =       0.000405805585
  error estimate for blocks of size 2^( 4) =       0.000412647727
  error estimate for blocks of size 2^( 5) =       0.000417072596
  error estimate for blocks of size 2^( 6) =       0.000418423713
  error estimate for blocks of size 2^( 7) =       0.000420943664

      target function =                  N/A
              le_mean =     -17.217179767695
             les_mean =     296.747369059229
             stat err =       0.000417271925
             autocorr =       1.157553945849
              std dev =       0.548483470057
             le_variance =       0.300834116926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217179767695        initial  <--
     5.9605e+25     5.9605e+26             7.4209e-30       -17.217179767695
     2.3842e+26     2.3842e+27             1.8552e-30       -17.217179767695
     9.5367e+26     9.5367e+27             4.6381e-31       -17.217179767695

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.3790
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.322183
====================================================
  Execution time = 1.4246e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1456e-01
  Total weights = 1.956554464e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300801971527
                                         uncertainty =       0.002025687861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300801971527
                                         uncertainty =       0.002025687861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387777736
  error estimate for blocks of size 2^( 2) =       0.000397166738
  error estimate for blocks of size 2^( 3) =       0.000405272562
  error estimate for blocks of size 2^( 4) =       0.000412007460
  error estimate for blocks of size 2^( 5) =       0.000416065200
  error estimate for blocks of size 2^( 6) =       0.000418499048
  error estimate for blocks of size 2^( 7) =       0.000419883720

      target function =                  N/A
              le_mean =     -17.216916965751
             les_mean =     296.736788036610
             stat err =       0.000416613857
             autocorr =       1.154254777225
              std dev =       0.548400533438
             le_variance =       0.300743145075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691696575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+26, overlap shift 5.9605e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916965808       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+26 is 5.528920e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916965808       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+27 is 1.382230e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216916965808       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216916965808       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+27 is 3.455575e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6763e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2809
    reference variance = 0.402882
====================================================
  Execution time = 1.3612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1482e-01
  Total weights = 1.9566e+06
  Execution time = 1.8485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388592525
  error estimate for blocks of size 2^( 2) =       0.000398541493
  error estimate for blocks of size 2^( 3) =       0.000407436336
  error estimate for blocks of size 2^( 4) =       0.000413657721
  error estimate for blocks of size 2^( 5) =       0.000417784155
  error estimate for blocks of size 2^( 6) =       0.000420266903
  error estimate for blocks of size 2^( 7) =       0.000422098318

      target function =                  N/A
              le_mean =     -17.217636456993
             les_mean =     296.761820331056
             stat err =       0.000418451774
             autocorr =       1.159583272669
              std dev =       0.549552819382
             le_variance =       0.302008301291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388592525
  error estimate for blocks of size 2^( 2) =       0.000398541493
  error estimate for blocks of size 2^( 3) =       0.000407436336
  error estimate for blocks of size 2^( 4) =       0.000413657721
  error estimate for blocks of size 2^( 5) =       0.000417784155
  error estimate for blocks of size 2^( 6) =       0.000420266903
  error estimate for blocks of size 2^( 7) =       0.000422098318

      target function =                  N/A
              le_mean =     -17.217636456993
             les_mean =     296.761820331056
             stat err =       0.000418451774
             autocorr =       1.159583272669
              std dev =       0.549552819382
             le_variance =       0.302008301291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388592525
  error estimate for blocks of size 2^( 2) =       0.000398541493
  error estimate for blocks of size 2^( 3) =       0.000407436336
  error estimate for blocks of size 2^( 4) =       0.000413657721
  error estimate for blocks of size 2^( 5) =       0.000417784155
  error estimate for blocks of size 2^( 6) =       0.000420266903
  error estimate for blocks of size 2^( 7) =       0.000422098318

      target function =                  N/A
              le_mean =     -17.217636456993
             les_mean =     296.761820331056
             stat err =       0.000418451774
             autocorr =       1.159583272669
              std dev =       0.549552819382
             le_variance =       0.302008301291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301938303587
                                         uncertainty =       0.001932337786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388592525
  error estimate for blocks of size 2^( 2) =       0.000398541493
  error estimate for blocks of size 2^( 3) =       0.000407436336
  error estimate for blocks of size 2^( 4) =       0.000413657721
  error estimate for blocks of size 2^( 5) =       0.000417784155
  error estimate for blocks of size 2^( 6) =       0.000420266903
  error estimate for blocks of size 2^( 7) =       0.000422098318

      target function =                  N/A
              le_mean =     -17.217636456993
             les_mean =     296.761820331056
             stat err =       0.000418451774
             autocorr =       1.159583272669
              std dev =       0.549552819382
             le_variance =       0.302008301291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217636456993        initial  <--
     5.9605e+26     5.9605e+27             5.5289e-31       -17.217636456993
     2.3842e+27     2.3842e+28             1.3822e-31       -17.217636456993
     9.5367e+27     9.5367e+28             3.4556e-32       -17.217636456993

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9039
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9673e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.472218
====================================================
  Execution time = 1.4260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1955e-01
  Total weights = 1.956516749e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304715626935
                                         uncertainty =       0.002355462264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304715626935
                                         uncertainty =       0.002355462264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390277112
  error estimate for blocks of size 2^( 2) =       0.000400029761
  error estimate for blocks of size 2^( 3) =       0.000408899154
  error estimate for blocks of size 2^( 4) =       0.000415246631
  error estimate for blocks of size 2^( 5) =       0.000418843799
  error estimate for blocks of size 2^( 6) =       0.000419985212
  error estimate for blocks of size 2^( 7) =       0.000420357661

      target function =                  N/A
              le_mean =     -17.217188882959
             les_mean =     296.751141497559
             stat err =       0.000418608326
             autocorr =       1.150454797347
              std dev =       0.551935184392
             le_variance =       0.304632447770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718888296e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+27, overlap shift 5.9605e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217188883012       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6773e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.381
    reference variance = 2.10282
====================================================
  Execution time = 1.3603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1480e-01
  Total weights = 1.9565e+06
  Execution time = 1.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386900102
  error estimate for blocks of size 2^( 2) =       0.000396546266
  error estimate for blocks of size 2^( 3) =       0.000404689802
  error estimate for blocks of size 2^( 4) =       0.000411513769
  error estimate for blocks of size 2^( 5) =       0.000415015108
  error estimate for blocks of size 2^( 6) =       0.000416501073
  error estimate for blocks of size 2^( 7) =       0.000416576514

      target function =                  N/A
              le_mean =     -17.216904416667
             les_mean =     296.736602611076
             stat err =       0.000414901616
             autocorr =       1.149986028938
              std dev =       0.547159371492
             le_variance =       0.299383377812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386900102
  error estimate for blocks of size 2^( 2) =       0.000396546266
  error estimate for blocks of size 2^( 3) =       0.000404689802
  error estimate for blocks of size 2^( 4) =       0.000411513769
  error estimate for blocks of size 2^( 5) =       0.000415015108
  error estimate for blocks of size 2^( 6) =       0.000416501073
  error estimate for blocks of size 2^( 7) =       0.000416576514

      target function =                  N/A
              le_mean =     -17.216904416667
             les_mean =     296.736602611076
             stat err =       0.000414901616
             autocorr =       1.149986028938
              std dev =       0.547159371492
             le_variance =       0.299383377812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386900102
  error estimate for blocks of size 2^( 2) =       0.000396546266
  error estimate for blocks of size 2^( 3) =       0.000404689802
  error estimate for blocks of size 2^( 4) =       0.000411513769
  error estimate for blocks of size 2^( 5) =       0.000415015108
  error estimate for blocks of size 2^( 6) =       0.000416501073
  error estimate for blocks of size 2^( 7) =       0.000416576514

      target function =                  N/A
              le_mean =     -17.216904416667
             les_mean =     296.736602611076
             stat err =       0.000414901616
             autocorr =       1.149986028938
              std dev =       0.547159371492
             le_variance =       0.299383377812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299337277415
                                         uncertainty =       0.001882341544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386900102
  error estimate for blocks of size 2^( 2) =       0.000396546266
  error estimate for blocks of size 2^( 3) =       0.000404689802
  error estimate for blocks of size 2^( 4) =       0.000411513769
  error estimate for blocks of size 2^( 5) =       0.000415015108
  error estimate for blocks of size 2^( 6) =       0.000416501073
  error estimate for blocks of size 2^( 7) =       0.000416576514

      target function =                  N/A
              le_mean =     -17.216904416667
             les_mean =     296.736602611076
             stat err =       0.000414901616
             autocorr =       1.149986028938
              std dev =       0.547159371492
             le_variance =       0.299383377812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216904416667        initial  <--
     5.9605e+27     5.9605e+28             0.0000e+00       -17.216904416667
     2.3842e+28     2.3842e+29             0.0000e+00       -17.216904416667
     9.5367e+28     9.5367e+29             0.0000e+00       -17.216904416667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8794
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9674e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.945558
====================================================
  Execution time = 1.4245e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1272e-01
  Total weights = 1.956738846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299758071484
                                         uncertainty =       0.002023792450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299758071484
                                         uncertainty =       0.002023792450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387179668
  error estimate for blocks of size 2^( 2) =       0.000396718284
  error estimate for blocks of size 2^( 3) =       0.000405165821
  error estimate for blocks of size 2^( 4) =       0.000411485841
  error estimate for blocks of size 2^( 5) =       0.000415913987
  error estimate for blocks of size 2^( 6) =       0.000418237359
  error estimate for blocks of size 2^( 7) =       0.000420516253

      target function =                  N/A
              le_mean =     -17.216072855034
             les_mean =     296.705885788699
             stat err =       0.000416538360
             autocorr =       1.157403843162
              std dev =       0.547554737237
             le_variance =       0.299816190271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721607285503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+28, overlap shift 5.9605e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216072855045       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180658 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6755e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.237348
====================================================
  Execution time = 1.3802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1597e-01
  Total weights = 1.9566e+06
  Execution time = 1.8533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387591649
  error estimate for blocks of size 2^( 2) =       0.000397477376
  error estimate for blocks of size 2^( 3) =       0.000405894818
  error estimate for blocks of size 2^( 4) =       0.000411810316
  error estimate for blocks of size 2^( 5) =       0.000415601626
  error estimate for blocks of size 2^( 6) =       0.000417804738
  error estimate for blocks of size 2^( 7) =       0.000418663132

      target function =                  N/A
              le_mean =     -17.216504677346
             les_mean =     296.724001997529
             stat err =       0.000415969953
             autocorr =       1.151794762134
              std dev =       0.548137366872
             le_variance =       0.300454572962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387591649
  error estimate for blocks of size 2^( 2) =       0.000397477376
  error estimate for blocks of size 2^( 3) =       0.000405894818
  error estimate for blocks of size 2^( 4) =       0.000411810316
  error estimate for blocks of size 2^( 5) =       0.000415601626
  error estimate for blocks of size 2^( 6) =       0.000417804738
  error estimate for blocks of size 2^( 7) =       0.000418663132

      target function =                  N/A
              le_mean =     -17.216504677346
             les_mean =     296.724001997529
             stat err =       0.000415969953
             autocorr =       1.151794762134
              std dev =       0.548137366872
             le_variance =       0.300454572962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387591649
  error estimate for blocks of size 2^( 2) =       0.000397477376
  error estimate for blocks of size 2^( 3) =       0.000405894818
  error estimate for blocks of size 2^( 4) =       0.000411810316
  error estimate for blocks of size 2^( 5) =       0.000415601626
  error estimate for blocks of size 2^( 6) =       0.000417804738
  error estimate for blocks of size 2^( 7) =       0.000418663132

      target function =                  N/A
              le_mean =     -17.216504677346
             les_mean =     296.724001997529
             stat err =       0.000415969953
             autocorr =       1.151794762134
              std dev =       0.548137366872
             le_variance =       0.300454572962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300312151522
                                         uncertainty =       0.001969273654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387591649
  error estimate for blocks of size 2^( 2) =       0.000397477376
  error estimate for blocks of size 2^( 3) =       0.000405894818
  error estimate for blocks of size 2^( 4) =       0.000411810316
  error estimate for blocks of size 2^( 5) =       0.000415601626
  error estimate for blocks of size 2^( 6) =       0.000417804738
  error estimate for blocks of size 2^( 7) =       0.000418663132

      target function =                  N/A
              le_mean =     -17.216504677346
             les_mean =     296.724001997529
             stat err =       0.000415969953
             autocorr =       1.151794762134
              std dev =       0.548137366872
             le_variance =       0.300454572962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216504677346        initial  <--
     5.9605e+28     5.9605e+29             0.0000e+00       -17.216504677346
     2.3842e+29     2.3842e+30             0.0000e+00       -17.216504677346
     9.5367e+29     9.5367e+30             0.0000e+00       -17.216504677346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1392
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.257271
====================================================
  Execution time = 1.4192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1718e-01
  Total weights = 1.956872389e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302001775474
                                         uncertainty =       0.002549737500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302001775474
                                         uncertainty =       0.002549737500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388601396
  error estimate for blocks of size 2^( 2) =       0.000398379132
  error estimate for blocks of size 2^( 3) =       0.000407002245
  error estimate for blocks of size 2^( 4) =       0.000413161052
  error estimate for blocks of size 2^( 5) =       0.000417082591
  error estimate for blocks of size 2^( 6) =       0.000420775867
  error estimate for blocks of size 2^( 7) =       0.000423282765

      target function =                  N/A
              le_mean =     -17.216753169144
             les_mean =     296.733773305217
             stat err =       0.000418575569
             autocorr =       1.160216504390
              std dev =       0.549565364631
             le_variance =       0.302022090001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675316914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+29, overlap shift 5.9605e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216753169190       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6698e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.462795
====================================================
  Execution time = 1.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1488e-01
  Total weights = 1.9569e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387723351
  error estimate for blocks of size 2^( 2) =       0.000397352562
  error estimate for blocks of size 2^( 3) =       0.000406263359
  error estimate for blocks of size 2^( 4) =       0.000412336988
  error estimate for blocks of size 2^( 5) =       0.000416599484
  error estimate for blocks of size 2^( 6) =       0.000420095600
  error estimate for blocks of size 2^( 7) =       0.000421061653

      target function =                  N/A
              le_mean =     -17.216472573711
             les_mean =     296.721809879208
             stat err =       0.000417523431
             autocorr =       1.159625588758
              std dev =       0.548323621657
             le_variance =       0.300658794067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387723351
  error estimate for blocks of size 2^( 2) =       0.000397352562
  error estimate for blocks of size 2^( 3) =       0.000406263359
  error estimate for blocks of size 2^( 4) =       0.000412336988
  error estimate for blocks of size 2^( 5) =       0.000416599484
  error estimate for blocks of size 2^( 6) =       0.000420095600
  error estimate for blocks of size 2^( 7) =       0.000421061653

      target function =                  N/A
              le_mean =     -17.216472573711
             les_mean =     296.721809879208
             stat err =       0.000417523431
             autocorr =       1.159625588758
              std dev =       0.548323621657
             le_variance =       0.300658794067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387723351
  error estimate for blocks of size 2^( 2) =       0.000397352562
  error estimate for blocks of size 2^( 3) =       0.000406263359
  error estimate for blocks of size 2^( 4) =       0.000412336988
  error estimate for blocks of size 2^( 5) =       0.000416599484
  error estimate for blocks of size 2^( 6) =       0.000420095600
  error estimate for blocks of size 2^( 7) =       0.000421061653

      target function =                  N/A
              le_mean =     -17.216472573711
             les_mean =     296.721809879208
             stat err =       0.000417523431
             autocorr =       1.159625588758
              std dev =       0.548323621657
             le_variance =       0.300658794067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300696268268
                                         uncertainty =       0.002356681443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387723351
  error estimate for blocks of size 2^( 2) =       0.000397352562
  error estimate for blocks of size 2^( 3) =       0.000406263359
  error estimate for blocks of size 2^( 4) =       0.000412336988
  error estimate for blocks of size 2^( 5) =       0.000416599484
  error estimate for blocks of size 2^( 6) =       0.000420095600
  error estimate for blocks of size 2^( 7) =       0.000421061653

      target function =                  N/A
              le_mean =     -17.216472573711
             les_mean =     296.721809879208
             stat err =       0.000417523431
             autocorr =       1.159625588758
              std dev =       0.548323621657
             le_variance =       0.300658794067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216472573711        initial  <--
     5.9605e+29     5.9605e+30             0.0000e+00       -17.216472573711
     2.3842e+30     2.3842e+31             0.0000e+00       -17.216472573711
     9.5367e+30     9.5367e+31             0.0000e+00       -17.216472573711

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0248
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9746e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.213
    reference variance = 0.166989
====================================================
  Execution time = 1.3981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2416e-01
  Total weights = 1.956967025e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893108756
                                         uncertainty =       0.003046865949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893108756
                                         uncertainty =       0.003046865949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391216674
  error estimate for blocks of size 2^( 2) =       0.000401383873
  error estimate for blocks of size 2^( 3) =       0.000410256564
  error estimate for blocks of size 2^( 4) =       0.000416780492
  error estimate for blocks of size 2^( 5) =       0.000421533473
  error estimate for blocks of size 2^( 6) =       0.000423282873
  error estimate for blocks of size 2^( 7) =       0.000425894201

      target function =                  N/A
              le_mean =     -17.216731161222
             les_mean =     296.739988618762
             stat err =       0.000421872760
             autocorr =       1.162862205507
              std dev =       0.553263925618
             le_variance =       0.306100971390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673116122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+30, overlap shift 5.9605e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731161288       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6490e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.235037
====================================================
  Execution time = 1.3960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1792e-01
  Total weights = 1.9572e+06
  Execution time = 1.8493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389890051
  error estimate for blocks of size 2^( 2) =       0.000399716917
  error estimate for blocks of size 2^( 3) =       0.000408067255
  error estimate for blocks of size 2^( 4) =       0.000414651548
  error estimate for blocks of size 2^( 5) =       0.000418889596
  error estimate for blocks of size 2^( 6) =       0.000421477707
  error estimate for blocks of size 2^( 7) =       0.000423724828

      target function =                  N/A
              le_mean =     -17.215957364573
             les_mean =     296.707105678788
             stat err =       0.000419685920
             autocorr =       1.158682620988
              std dev =       0.551387797372
             le_variance =       0.304028503090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389890051
  error estimate for blocks of size 2^( 2) =       0.000399716917
  error estimate for blocks of size 2^( 3) =       0.000408067255
  error estimate for blocks of size 2^( 4) =       0.000414651548
  error estimate for blocks of size 2^( 5) =       0.000418889596
  error estimate for blocks of size 2^( 6) =       0.000421477707
  error estimate for blocks of size 2^( 7) =       0.000423724828

      target function =                  N/A
              le_mean =     -17.215957364573
             les_mean =     296.707105678788
             stat err =       0.000419685920
             autocorr =       1.158682620988
              std dev =       0.551387797372
             le_variance =       0.304028503090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389890051
  error estimate for blocks of size 2^( 2) =       0.000399716917
  error estimate for blocks of size 2^( 3) =       0.000408067255
  error estimate for blocks of size 2^( 4) =       0.000414651548
  error estimate for blocks of size 2^( 5) =       0.000418889596
  error estimate for blocks of size 2^( 6) =       0.000421477707
  error estimate for blocks of size 2^( 7) =       0.000423724828

      target function =                  N/A
              le_mean =     -17.215957364573
             les_mean =     296.707105678788
             stat err =       0.000419685920
             autocorr =       1.158682620988
              std dev =       0.551387797372
             le_variance =       0.304028503090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303965266819
                                         uncertainty =       0.002245071840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389890051
  error estimate for blocks of size 2^( 2) =       0.000399716917
  error estimate for blocks of size 2^( 3) =       0.000408067255
  error estimate for blocks of size 2^( 4) =       0.000414651548
  error estimate for blocks of size 2^( 5) =       0.000418889596
  error estimate for blocks of size 2^( 6) =       0.000421477707
  error estimate for blocks of size 2^( 7) =       0.000423724828

      target function =                  N/A
              le_mean =     -17.215957364573
             les_mean =     296.707105678788
             stat err =       0.000419685920
             autocorr =       1.158682620988
              std dev =       0.551387797372
             le_variance =       0.304028503090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215957364573        initial  <--
     5.9605e+30     5.9605e+31             0.0000e+00       -17.215957364573
     2.3842e+31     2.3842e+32             0.0000e+00       -17.215957364573
     9.5367e+31     9.5367e+32             0.0000e+00       -17.215957364573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3747
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.293302
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1198e-01
  Total weights = 1.956681878e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299475845050
                                         uncertainty =       0.001943335196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299475845050
                                         uncertainty =       0.001943335196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386951965
  error estimate for blocks of size 2^( 2) =       0.000396803932
  error estimate for blocks of size 2^( 3) =       0.000405870142
  error estimate for blocks of size 2^( 4) =       0.000412349216
  error estimate for blocks of size 2^( 5) =       0.000416421466
  error estimate for blocks of size 2^( 6) =       0.000417953552
  error estimate for blocks of size 2^( 7) =       0.000418128522

      target function =                  N/A
              le_mean =     -17.217912638662
             les_mean =     296.768500263664
             stat err =       0.000416213189
             autocorr =       1.156957917203
              std dev =       0.547232717548
             le_variance =       0.299463647154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721791263866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+31, overlap shift 5.9605e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217912638738       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6472e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.186361
====================================================
  Execution time = 1.3821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3042e-01
  Total weights = 1.9568e+06
  Execution time = 1.8491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391554514
  error estimate for blocks of size 2^( 2) =       0.000401445957
  error estimate for blocks of size 2^( 3) =       0.000410074136
  error estimate for blocks of size 2^( 4) =       0.000417250803
  error estimate for blocks of size 2^( 5) =       0.000420794438
  error estimate for blocks of size 2^( 6) =       0.000424082926
  error estimate for blocks of size 2^( 7) =       0.000426408574

      target function =                  N/A
              le_mean =     -17.217365051492
             les_mean =     296.768079806750
             stat err =       0.000422134185
             autocorr =       1.162295559349
              std dev =       0.553741703477
             le_variance =       0.306629874170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391554514
  error estimate for blocks of size 2^( 2) =       0.000401445957
  error estimate for blocks of size 2^( 3) =       0.000410074136
  error estimate for blocks of size 2^( 4) =       0.000417250803
  error estimate for blocks of size 2^( 5) =       0.000420794438
  error estimate for blocks of size 2^( 6) =       0.000424082926
  error estimate for blocks of size 2^( 7) =       0.000426408574

      target function =                  N/A
              le_mean =     -17.217365051492
             les_mean =     296.768079806750
             stat err =       0.000422134185
             autocorr =       1.162295559349
              std dev =       0.553741703477
             le_variance =       0.306629874170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391554514
  error estimate for blocks of size 2^( 2) =       0.000401445957
  error estimate for blocks of size 2^( 3) =       0.000410074136
  error estimate for blocks of size 2^( 4) =       0.000417250803
  error estimate for blocks of size 2^( 5) =       0.000420794438
  error estimate for blocks of size 2^( 6) =       0.000424082926
  error estimate for blocks of size 2^( 7) =       0.000426408574

      target function =                  N/A
              le_mean =     -17.217365051492
             les_mean =     296.768079806750
             stat err =       0.000422134185
             autocorr =       1.162295559349
              std dev =       0.553741703477
             le_variance =       0.306629874170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306559979379
                                         uncertainty =       0.003514211727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391554514
  error estimate for blocks of size 2^( 2) =       0.000401445957
  error estimate for blocks of size 2^( 3) =       0.000410074136
  error estimate for blocks of size 2^( 4) =       0.000417250803
  error estimate for blocks of size 2^( 5) =       0.000420794438
  error estimate for blocks of size 2^( 6) =       0.000424082926
  error estimate for blocks of size 2^( 7) =       0.000426408574

      target function =                  N/A
              le_mean =     -17.217365051492
             les_mean =     296.768079806750
             stat err =       0.000422134185
             autocorr =       1.162295559349
              std dev =       0.553741703477
             le_variance =       0.306629874170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217365051492        initial  <--
     5.9605e+31     5.9605e+32             0.0000e+00       -17.217365051492
     2.3842e+32     2.3842e+33             0.0000e+00       -17.217365051492
     9.5367e+32     9.5367e+33             0.0000e+00       -17.217365051492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1217
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.173023
====================================================
  Execution time = 1.4009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1150e-01
  Total weights = 1.956602448e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297159348664
                                         uncertainty =       0.001704137366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297159348664
                                         uncertainty =       0.001704137366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385419392
  error estimate for blocks of size 2^( 2) =       0.000395148231
  error estimate for blocks of size 2^( 3) =       0.000403892746
  error estimate for blocks of size 2^( 4) =       0.000410702148
  error estimate for blocks of size 2^( 5) =       0.000414348860
  error estimate for blocks of size 2^( 6) =       0.000414548288
  error estimate for blocks of size 2^( 7) =       0.000414920599

      target function =                  N/A
              le_mean =     -17.217099409289
             les_mean =     296.740008740461
             stat err =       0.000413629974
             autocorr =       1.151746447589
              std dev =       0.545065331058
             le_variance =       0.297096215122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709940929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+32, overlap shift 5.9605e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099409331       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6502e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.651846
====================================================
  Execution time = 1.4002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1864e-01
  Total weights = 1.9569e+06
  Execution time = 1.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387321742
  error estimate for blocks of size 2^( 2) =       0.000396875964
  error estimate for blocks of size 2^( 3) =       0.000405454062
  error estimate for blocks of size 2^( 4) =       0.000411438695
  error estimate for blocks of size 2^( 5) =       0.000415245561
  error estimate for blocks of size 2^( 6) =       0.000417400267
  error estimate for blocks of size 2^( 7) =       0.000419378343

      target function =                  N/A
              le_mean =     -17.216552307444
             les_mean =     296.728317321174
             stat err =       0.000415865717
             autocorr =       1.152822611103
              std dev =       0.547755660376
             le_variance =       0.300036263473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387321742
  error estimate for blocks of size 2^( 2) =       0.000396875964
  error estimate for blocks of size 2^( 3) =       0.000405454062
  error estimate for blocks of size 2^( 4) =       0.000411438695
  error estimate for blocks of size 2^( 5) =       0.000415245561
  error estimate for blocks of size 2^( 6) =       0.000417400267
  error estimate for blocks of size 2^( 7) =       0.000419378343

      target function =                  N/A
              le_mean =     -17.216552307444
             les_mean =     296.728317321174
             stat err =       0.000415865717
             autocorr =       1.152822611103
              std dev =       0.547755660376
             le_variance =       0.300036263473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387321742
  error estimate for blocks of size 2^( 2) =       0.000396875964
  error estimate for blocks of size 2^( 3) =       0.000405454062
  error estimate for blocks of size 2^( 4) =       0.000411438695
  error estimate for blocks of size 2^( 5) =       0.000415245561
  error estimate for blocks of size 2^( 6) =       0.000417400267
  error estimate for blocks of size 2^( 7) =       0.000419378343

      target function =                  N/A
              le_mean =     -17.216552307444
             les_mean =     296.728317321174
             stat err =       0.000415865717
             autocorr =       1.152822611103
              std dev =       0.547755660376
             le_variance =       0.300036263473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299966648029
                                         uncertainty =       0.001805504640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387321742
  error estimate for blocks of size 2^( 2) =       0.000396875964
  error estimate for blocks of size 2^( 3) =       0.000405454062
  error estimate for blocks of size 2^( 4) =       0.000411438695
  error estimate for blocks of size 2^( 5) =       0.000415245561
  error estimate for blocks of size 2^( 6) =       0.000417400267
  error estimate for blocks of size 2^( 7) =       0.000419378343

      target function =                  N/A
              le_mean =     -17.216552307444
             les_mean =     296.728317321174
             stat err =       0.000415865717
             autocorr =       1.152822611103
              std dev =       0.547755660376
             le_variance =       0.300036263473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216552307444        initial  <--
     5.9605e+32     5.9605e+33             0.0000e+00       -17.216552307444
     2.3842e+33     2.3842e+34             0.0000e+00       -17.216552307444
     9.5367e+33     9.5367e+34             0.0000e+00       -17.216552307444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2990
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1467
    reference variance = 0.252854
====================================================
  Execution time = 1.6382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1775e-01
  Total weights = 1.956481191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301515516072
                                         uncertainty =       0.002204088778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301515516072
                                         uncertainty =       0.002204088778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388267988
  error estimate for blocks of size 2^( 2) =       0.000397884761
  error estimate for blocks of size 2^( 3) =       0.000406622358
  error estimate for blocks of size 2^( 4) =       0.000413372212
  error estimate for blocks of size 2^( 5) =       0.000417334114
  error estimate for blocks of size 2^( 6) =       0.000419530279
  error estimate for blocks of size 2^( 7) =       0.000419756599

      target function =                  N/A
              le_mean =     -17.216313057234
             les_mean =     296.719188363593
             stat err =       0.000417498301
             autocorr =       1.156235382588
              std dev =       0.549093853911
             le_variance =       0.301504060403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631305723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+33, overlap shift 5.9605e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313057287       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313057287       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216313057287       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216313056648       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+33 is 6.239862e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313057287       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313057287       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216313057287       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216313064098       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216313056648       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+34 is 1.559965e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313057287       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313057287       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216313057287       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216313064098       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+34 is 3.899914e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8889e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2138
    reference variance = 0.131003
====================================================
  Execution time = 1.3836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1304e-01
  Total weights = 1.9570e+06
  Execution time = 1.8429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387130303
  error estimate for blocks of size 2^( 2) =       0.000396930071
  error estimate for blocks of size 2^( 3) =       0.000405588084
  error estimate for blocks of size 2^( 4) =       0.000411744363
  error estimate for blocks of size 2^( 5) =       0.000414638672
  error estimate for blocks of size 2^( 6) =       0.000417466971
  error estimate for blocks of size 2^( 7) =       0.000419925563

      target function =                  N/A
              le_mean =     -17.216896522763
             les_mean =     296.734567305600
             stat err =       0.000415943892
             autocorr =       1.154396945172
              std dev =       0.547484924375
             le_variance =       0.299739742418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387130303
  error estimate for blocks of size 2^( 2) =       0.000396930071
  error estimate for blocks of size 2^( 3) =       0.000405588084
  error estimate for blocks of size 2^( 4) =       0.000411744363
  error estimate for blocks of size 2^( 5) =       0.000414638672
  error estimate for blocks of size 2^( 6) =       0.000417466971
  error estimate for blocks of size 2^( 7) =       0.000419925563

      target function =                  N/A
              le_mean =     -17.216896522763
             les_mean =     296.734567305600
             stat err =       0.000415943892
             autocorr =       1.154396945172
              std dev =       0.547484924375
             le_variance =       0.299739742418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387130303
  error estimate for blocks of size 2^( 2) =       0.000396930071
  error estimate for blocks of size 2^( 3) =       0.000405588084
  error estimate for blocks of size 2^( 4) =       0.000411744363
  error estimate for blocks of size 2^( 5) =       0.000414638672
  error estimate for blocks of size 2^( 6) =       0.000417466971
  error estimate for blocks of size 2^( 7) =       0.000419925563

      target function =                  N/A
              le_mean =     -17.216896522763
             les_mean =     296.734567305600
             stat err =       0.000415943892
             autocorr =       1.154396945172
              std dev =       0.547484924375
             le_variance =       0.299739742418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299379491520
                                         uncertainty =       0.001779708671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387130303
  error estimate for blocks of size 2^( 2) =       0.000396930071
  error estimate for blocks of size 2^( 3) =       0.000405588084
  error estimate for blocks of size 2^( 4) =       0.000411744363
  error estimate for blocks of size 2^( 5) =       0.000414638672
  error estimate for blocks of size 2^( 6) =       0.000417466971
  error estimate for blocks of size 2^( 7) =       0.000419925563

      target function =                  N/A
              le_mean =     -17.216896522763
             les_mean =     296.734567305600
             stat err =       0.000415943892
             autocorr =       1.154396945172
              std dev =       0.547484924375
             le_variance =       0.299739742418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216896522763        initial  <--
     5.9605e+33     5.9605e+34             6.2399e-38       -17.216896522763
     2.3842e+34     2.3842e+35             1.5600e-38       -17.216896522763
     9.5367e+34     9.5367e+35             3.8999e-39       -17.216896522763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1036
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1998e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.277
    reference variance = 0.29568
====================================================
  Execution time = 1.4108e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1809e-01
  Total weights = 1.956682498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302795530897
                                         uncertainty =       0.002295202655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302795530897
                                         uncertainty =       0.002295202655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389082573
  error estimate for blocks of size 2^( 2) =       0.000399155125
  error estimate for blocks of size 2^( 3) =       0.000407990984
  error estimate for blocks of size 2^( 4) =       0.000415070345
  error estimate for blocks of size 2^( 5) =       0.000418815554
  error estimate for blocks of size 2^( 6) =       0.000421044959
  error estimate for blocks of size 2^( 7) =       0.000422736914

      target function =                  N/A
              le_mean =     -17.216823595891
             les_mean =     296.737107787931
             stat err =       0.000419416943
             autocorr =       1.162006032294
              std dev =       0.550245851668
             le_variance =       0.302770497277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682359589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+34, overlap shift 5.9605e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823595919       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6618e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.167095
====================================================
  Execution time = 1.3653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 1.9567e+06
  Execution time = 1.8573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387044949
  error estimate for blocks of size 2^( 2) =       0.000396531310
  error estimate for blocks of size 2^( 3) =       0.000405431686
  error estimate for blocks of size 2^( 4) =       0.000411851408
  error estimate for blocks of size 2^( 5) =       0.000416396014
  error estimate for blocks of size 2^( 6) =       0.000419358418
  error estimate for blocks of size 2^( 7) =       0.000419632015

      target function =                  N/A
              le_mean =     -17.216373779768
             les_mean =     296.718949114885
             stat err =       0.000416809464
             autocorr =       1.159717828647
              std dev =       0.547364216171
             le_variance =       0.299607585144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387044949
  error estimate for blocks of size 2^( 2) =       0.000396531310
  error estimate for blocks of size 2^( 3) =       0.000405431686
  error estimate for blocks of size 2^( 4) =       0.000411851408
  error estimate for blocks of size 2^( 5) =       0.000416396014
  error estimate for blocks of size 2^( 6) =       0.000419358418
  error estimate for blocks of size 2^( 7) =       0.000419632015

      target function =                  N/A
              le_mean =     -17.216373779768
             les_mean =     296.718949114885
             stat err =       0.000416809464
             autocorr =       1.159717828647
              std dev =       0.547364216171
             le_variance =       0.299607585144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387044949
  error estimate for blocks of size 2^( 2) =       0.000396531310
  error estimate for blocks of size 2^( 3) =       0.000405431686
  error estimate for blocks of size 2^( 4) =       0.000411851408
  error estimate for blocks of size 2^( 5) =       0.000416396014
  error estimate for blocks of size 2^( 6) =       0.000419358418
  error estimate for blocks of size 2^( 7) =       0.000419632015

      target function =                  N/A
              le_mean =     -17.216373779768
             les_mean =     296.718949114885
             stat err =       0.000416809464
             autocorr =       1.159717828647
              std dev =       0.547364216171
             le_variance =       0.299607585144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299671594127
                                         uncertainty =       0.002877109522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387044949
  error estimate for blocks of size 2^( 2) =       0.000396531310
  error estimate for blocks of size 2^( 3) =       0.000405431686
  error estimate for blocks of size 2^( 4) =       0.000411851408
  error estimate for blocks of size 2^( 5) =       0.000416396014
  error estimate for blocks of size 2^( 6) =       0.000419358418
  error estimate for blocks of size 2^( 7) =       0.000419632015

      target function =                  N/A
              le_mean =     -17.216373779768
             les_mean =     296.718949114885
             stat err =       0.000416809464
             autocorr =       1.159717828647
              std dev =       0.547364216171
             le_variance =       0.299607585144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216373779768        initial  <--
     5.9605e+34     5.9605e+35             0.0000e+00       -17.216373779768
     2.3842e+35     2.3842e+36             0.0000e+00       -17.216373779768
     9.5367e+35     9.5367e+36             0.0000e+00       -17.216373779768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9962
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.329434
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1663e-01
  Total weights = 1.956795569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301846598852
                                         uncertainty =       0.002198980314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301846598852
                                         uncertainty =       0.002198980314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388439325
  error estimate for blocks of size 2^( 2) =       0.000398394027
  error estimate for blocks of size 2^( 3) =       0.000407577702
  error estimate for blocks of size 2^( 4) =       0.000413955060
  error estimate for blocks of size 2^( 5) =       0.000417800838
  error estimate for blocks of size 2^( 6) =       0.000420209590
  error estimate for blocks of size 2^( 7) =       0.000420864119

      target function =                  N/A
              le_mean =     -17.215899124834
             les_mean =     296.703815160691
             stat err =       0.000418207402
             autocorr =       1.159143086422
              std dev =       0.549336161058
             le_variance =       0.301770217846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589912483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+35, overlap shift 5.9605e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215899124893       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6773e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.129
    reference variance = 0.41396
====================================================
  Execution time = 1.3555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1455e-01
  Total weights = 1.9566e+06
  Execution time = 1.8435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226398
  error estimate for blocks of size 2^( 2) =       0.000397947433
  error estimate for blocks of size 2^( 3) =       0.000406562220
  error estimate for blocks of size 2^( 4) =       0.000412316919
  error estimate for blocks of size 2^( 5) =       0.000416449110
  error estimate for blocks of size 2^( 6) =       0.000417827483
  error estimate for blocks of size 2^( 7) =       0.000420274463

      target function =                  N/A
              le_mean =     -17.216368017239
             les_mean =     296.717877640962
             stat err =       0.000416716994
             autocorr =       1.152158683252
              std dev =       0.549035037727
             le_variance =       0.301439472652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226398
  error estimate for blocks of size 2^( 2) =       0.000397947433
  error estimate for blocks of size 2^( 3) =       0.000406562220
  error estimate for blocks of size 2^( 4) =       0.000412316919
  error estimate for blocks of size 2^( 5) =       0.000416449110
  error estimate for blocks of size 2^( 6) =       0.000417827483
  error estimate for blocks of size 2^( 7) =       0.000420274463

      target function =                  N/A
              le_mean =     -17.216368017239
             les_mean =     296.717877640962
             stat err =       0.000416716994
             autocorr =       1.152158683252
              std dev =       0.549035037727
             le_variance =       0.301439472652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226398
  error estimate for blocks of size 2^( 2) =       0.000397947433
  error estimate for blocks of size 2^( 3) =       0.000406562220
  error estimate for blocks of size 2^( 4) =       0.000412316919
  error estimate for blocks of size 2^( 5) =       0.000416449110
  error estimate for blocks of size 2^( 6) =       0.000417827483
  error estimate for blocks of size 2^( 7) =       0.000420274463

      target function =                  N/A
              le_mean =     -17.216368017239
             les_mean =     296.717877640962
             stat err =       0.000416716994
             autocorr =       1.152158683252
              std dev =       0.549035037727
             le_variance =       0.301439472652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301468984230
                                         uncertainty =       0.001975863314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388226398
  error estimate for blocks of size 2^( 2) =       0.000397947433
  error estimate for blocks of size 2^( 3) =       0.000406562220
  error estimate for blocks of size 2^( 4) =       0.000412316919
  error estimate for blocks of size 2^( 5) =       0.000416449110
  error estimate for blocks of size 2^( 6) =       0.000417827483
  error estimate for blocks of size 2^( 7) =       0.000420274463

      target function =                  N/A
              le_mean =     -17.216368017239
             les_mean =     296.717877640962
             stat err =       0.000416716994
             autocorr =       1.152158683252
              std dev =       0.549035037727
             le_variance =       0.301439472652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216368017239        initial  <--
     5.9605e+35     5.9605e+36             0.0000e+00       -17.216368017239
     2.3842e+36     2.3842e+37             0.0000e+00       -17.216368017239
     9.5367e+36     9.5367e+37             0.0000e+00       -17.216368017239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0614
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.039749e-02 3 1  ON 0
ci_002                -3.037400e-02 3 1  ON 1
ci_003                -2.467402e-02 3 1  ON 2
ci_004                 2.095768e-02 3 1  ON 3
ci_005                 2.076899e-02 3 1  ON 4
ci_006                -1.938237e-02 3 1  ON 5
ci_007                -1.946249e-02 3 1  ON 6
ci_008                -1.831370e-02 3 1  ON 7
ci_009                -1.797216e-02 3 1  ON 8
ci_010                -1.699927e-02 3 1  ON 9
ci_011                -1.661400e-02 3 1  ON 10
ci_012                -1.617188e-02 3 1  ON 11
ci_013                -1.910559e-02 3 1  ON 12
ci_014                 1.398064e-02 3 1  ON 13
ci_015                 1.427651e-02 3 1  ON 14
ci_016                 1.660721e-02 3 1  ON 15
ci_017                 1.656807e-02 3 1  ON 16
ci_018                 1.295414e-02 3 1  ON 17
ci_019                 1.325211e-02 3 1  ON 18
ci_020                 1.295295e-02 3 1  ON 19
ci_021                 1.353481e-02 3 1  ON 20
ci_022                 1.131961e-02 3 1  ON 21
ci_023                 1.118546e-02 3 1  ON 22
ci_024                 1.088923e-02 3 1  ON 23
ci_025                 1.162866e-02 3 1  ON 24
ci_026                 1.152015e-02 3 1  ON 25
ci_027                 1.114288e-02 3 1  ON 26
ci_028                -1.434182e-02 3 1  ON 27
ci_029                -1.442075e-02 3 1  ON 28
ci_030                -1.098896e-02 3 1  ON 29
ci_031                -1.103890e-02 3 1  ON 30
ci_032                -1.343680e-02 3 1  ON 31
ci_033                 1.056889e-02 3 1  ON 32
ci_034                 9.924624e-03 3 1  ON 33
ci_035                -4.665771e-03 3 1  ON 34
ci_036                -1.103194e-02 3 1  ON 35
ci_037                -1.052483e-02 3 1  ON 36
ci_038                 1.187973e-03 3 1  ON 37
ci_039                 1.318033e-03 3 1  ON 38
ci_040                -4.156062e-03 3 1  ON 39
ci_041                 9.843816e-03 3 1  ON 40
ci_042                 9.838791e-03 3 1  ON 41
ci_043                -3.011273e-03 3 1  ON 42
ci_044                -1.482445e-02 3 1  ON 43
ci_045                -1.449690e-03 3 1  ON 44
ci_046                 5.624742e-03 3 1  ON 45
ci_047                 5.443131e-03 3 1  ON 46
ci_048                -1.175067e-02 3 1  ON 47
ci_049                -1.211630e-02 3 1  ON 48
ci_050                 7.705294e-03 3 1  ON 49
ci_051                 7.483216e-03 3 1  ON 50
ci_052                -6.823320e-03 3 1  ON 51
ci_053                -6.903347e-03 3 1  ON 52
ci_054                -1.948248e-03 3 1  ON 53
ci_055                -2.070389e-03 3 1  ON 54
ci_056                 4.809970e-03 3 1  ON 55
ci_057                 5.042242e-03 3 1  ON 56
ci_058                -6.978951e-03 3 1  ON 57
ci_059                -6.701032e-03 3 1  ON 58
ci_060                 8.316101e-03 3 1  ON 59
ci_061                 8.896219e-03 3 1  ON 60
ci_062                -2.764348e-03 3 1  ON 61
ci_063                -2.603947e-03 3 1  ON 62
ci_064                -3.252288e-03 3 1  ON 63
ci_065                -4.297570e-03 3 1  ON 64
ci_066                 5.676590e-03 3 1  ON 65
ci_067                 5.970752e-03 3 1  ON 66
ci_068                -4.808720e-03 3 1  ON 67
ci_069                -4.915502e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9840e+01 secs
  Total Execution time = 2.4124e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
