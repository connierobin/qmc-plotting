Rank =    0  Free Memory = 71072 MB
Rank =    1  Free Memory = 71065 MB
Rank =    2  Free Memory = 71065 MB
Rank =    3  Free Memory = 71065 MB
Rank =    4  Free Memory = 71065 MB
Rank =    5  Free Memory = 71065 MB
Rank =    6  Free Memory = 71065 MB
Rank =    7  Free Memory = 71065 MB
Rank =    8  Free Memory = 71065 MB
Rank =    9  Free Memory = 71065 MB
Rank =   10  Free Memory = 71065 MB
Rank =   11  Free Memory = 71065 MB
Rank =   12  Free Memory = 71065 MB
Rank =   13  Free Memory = 71065 MB
Rank =   14  Free Memory = 71064 MB
Rank =   15  Free Memory = 71056 MB
Rank =   16  Free Memory = 71056 MB
Rank =   17  Free Memory = 71056 MB
Rank =   18  Free Memory = 71055 MB
Rank =   19  Free Memory = 71055 MB
Rank =   20  Free Memory = 71055 MB
Rank =   21  Free Memory = 71055 MB
Rank =   22  Free Memory = 71055 MB
Rank =   23  Free Memory = 71055 MB
Rank =   24  Free Memory = 71055 MB
Rank =   25  Free Memory = 71055 MB
Rank =   26  Free Memory = 71055 MB
Rank =   27  Free Memory = 71055 MB
Rank =   28  Free Memory = 71055 MB
Rank =   29  Free Memory = 71055 MB
Rank =   30  Free Memory = 71055 MB
Rank =   31  Free Memory = 71055 MB
Rank =   32  Free Memory = 73103 MB
Rank =   33  Free Memory = 73103 MB
Rank =   34  Free Memory = 73103 MB
Rank =   35  Free Memory = 73103 MB
Rank =   36  Free Memory = 73103 MB
Rank =   37  Free Memory = 73103 MB
Rank =   38  Free Memory = 73103 MB
Rank =   39  Free Memory = 73103 MB
Rank =   40  Free Memory = 73103 MB
Rank =   41  Free Memory = 73103 MB
Rank =   42  Free Memory = 73103 MB
Rank =   43  Free Memory = 73103 MB
Rank =   44  Free Memory = 73103 MB
Rank =   45  Free Memory = 73103 MB
Rank =   46  Free Memory = 73103 MB
Rank =   47  Free Memory = 73103 MB
Rank =   48  Free Memory = 73103 MB
Rank =   49  Free Memory = 73103 MB
Rank =   50  Free Memory = 73103 MB
Rank =   51  Free Memory = 73103 MB
Rank =   52  Free Memory = 73103 MB
Rank =   53  Free Memory = 73103 MB
Rank =   54  Free Memory = 73103 MB
Rank =   55  Free Memory = 73103 MB
Rank =   56  Free Memory = 73103 MB
Rank =   57  Free Memory = 73102 MB
Rank =   58  Free Memory = 73102 MB
Rank =   59  Free Memory = 73102 MB
Rank =   60  Free Memory = 73102 MB
Rank =   61  Free Memory = 73102 MB
Rank =   62  Free Memory = 73102 MB
Rank =   63  Free Memory = 73102 MB
Rank =   64  Free Memory = 89734 MB
Rank =   65  Free Memory = 89734 MB
Rank =   66  Free Memory = 89734 MB
Rank =   67  Free Memory = 89734 MB
Rank =   68  Free Memory = 89733 MB
Rank =   69  Free Memory = 89733 MB
Rank =   70  Free Memory = 89733 MB
Rank =   71  Free Memory = 89733 MB
Rank =   72  Free Memory = 89733 MB
Rank =   73  Free Memory = 89733 MB
Rank =   74  Free Memory = 89733 MB
Rank =   75  Free Memory = 89733 MB
Rank =   76  Free Memory = 89733 MB
Rank =   77  Free Memory = 89733 MB
Rank =   78  Free Memory = 89733 MB
Rank =   79  Free Memory = 89733 MB
Rank =   80  Free Memory = 89733 MB
Rank =   81  Free Memory = 89733 MB
Rank =   82  Free Memory = 89733 MB
Rank =   83  Free Memory = 89733 MB
Rank =   84  Free Memory = 89733 MB
Rank =   85  Free Memory = 89733 MB
Rank =   86  Free Memory = 89733 MB
Rank =   87  Free Memory = 89733 MB
Rank =   88  Free Memory = 89733 MB
Rank =   89  Free Memory = 89733 MB
Rank =   90  Free Memory = 89733 MB
Rank =   91  Free Memory = 89733 MB
Rank =   92  Free Memory = 89733 MB
Rank =   93  Free Memory = 89733 MB
Rank =   94  Free Memory = 89733 MB
Rank =   95  Free Memory = 89733 MB
Rank =   96  Free Memory = 62923 MB
Rank =   97  Free Memory = 62923 MB
Rank =   98  Free Memory = 62923 MB
Rank =   99  Free Memory = 62923 MB
Rank =  100  Free Memory = 62923 MB
Rank =  101  Free Memory = 62923 MB
Rank =  102  Free Memory = 62923 MB
Rank =  103  Free Memory = 62923 MB
Rank =  104  Free Memory = 62923 MB
Rank =  105  Free Memory = 62923 MB
Rank =  106  Free Memory = 62923 MB
Rank =  107  Free Memory = 62923 MB
Rank =  108  Free Memory = 62923 MB
Rank =  109  Free Memory = 62923 MB
Rank =  110  Free Memory = 62922 MB
Rank =  111  Free Memory = 62922 MB
Rank =  112  Free Memory = 62922 MB
Rank =  113  Free Memory = 62922 MB
Rank =  114  Free Memory = 62922 MB
Rank =  115  Free Memory = 62922 MB
Rank =  116  Free Memory = 62922 MB
Rank =  117  Free Memory = 62922 MB
Rank =  118  Free Memory = 62922 MB
Rank =  119  Free Memory = 62922 MB
Rank =  120  Free Memory = 62922 MB
Rank =  121  Free Memory = 62922 MB
Rank =  122  Free Memory = 62922 MB
Rank =  123  Free Memory = 62922 MB
Rank =  124  Free Memory = 62922 MB
Rank =  125  Free Memory = 62922 MB
Rank =  126  Free Memory = 62922 MB
Rank =  127  Free Memory = 62922 MB
  Input file(s): opt_h2o_gs_lmtt_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001c.xml

  Project = H2O
  date    = 2023-03-02 18:01:47 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 267

  Range of prime numbers to use as seeds over processors and threads = 1723-2719


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.906895e-01    1         1 OFF
     uu_1                 2.901761e-02    1         1 OFF
     uu_2                -6.453992e-02    1         1 OFF
     uu_3                -1.201449e-01    1         1 OFF
     uu_4                -1.562723e-01    1         1 OFF
     uu_5                -1.683375e-01    1         1 OFF
     uu_6                -1.559905e-01    1         1 OFF
     uu_7                -1.088719e-01    1         1 OFF
     uu_8                -3.891836e-02    1         1 OFF
     uu_9                 2.015996e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.486549e-01    1         1 OFF
     ud_1                 9.358715e-02    1         1 OFF
     ud_2                -1.121615e-02    1         1 OFF
     ud_3                -7.116190e-02    1         1 OFF
     ud_4                -1.230197e-01    1         1 OFF
     ud_5                -1.633831e-01    1         1 OFF
     ud_6                -1.786205e-01    1         1 OFF
     ud_7                -1.585333e-01    1         1 OFF
     ud_8                -1.109298e-01    1         1 OFF
     ud_9                 3.267570e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.078755e-01    1         1 OFF
     eO_1                -5.925756e-01    1         1 OFF
     eO_2                -1.894135e-01    1         1 OFF
     eO_3                 7.676001e-02    1         1 OFF
     eO_4                 2.047135e-01    1         1 OFF
     eO_5                 2.984119e-01    1         1 OFF
     eO_6                 3.262834e-01    1         1 OFF
     eO_7                 5.333091e-01    1         1 OFF
     eO_8                 1.579161e-01    1         1 OFF
     eO_9                 5.325131e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.212969e-01    1         1 OFF
     eH1_1                -1.428992e-01    1         1 OFF
     eH1_2                -1.020656e-01    1         1 OFF
     eH1_3                -6.514821e-02    1         1 OFF
     eH1_4                -1.850932e-02    1         1 OFF
     eH1_5                -5.103686e-03    1         1 OFF
     eH1_6                 3.556808e-02    1         1 OFF
     eH1_7                 7.987248e-02    1         1 OFF
     eH1_8                 2.645728e-01    1         1 OFF
     eH1_9                 1.134826e-01    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.099891e-01    1         1 OFF
     eH2_1                -1.315924e-01    1         1 OFF
     eH2_2                -9.070219e-02    1         1 OFF
     eH2_3                -5.365062e-02    1         1 OFF
     eH2_4                -7.142172e-03    1         1 OFF
     eH2_5                 5.466077e-03    1         1 OFF
     eH2_6                 4.814681e-02    1         1 OFF
     eH2_7                 3.881478e-02    1         1 OFF
     eH2_8                 2.481921e-01    1         1 OFF
     eH2_9                 1.153591e-01    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.738145e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4960e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.405713
====================================================
  Execution time = 1.4691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1783e-01
  Total weights = 1.956470354e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303394819162
                                         uncertainty =       0.002249270184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303394819162
                                         uncertainty =       0.002249270184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389445149
  error estimate for blocks of size 2^( 2) =       0.000399091971
  error estimate for blocks of size 2^( 3) =       0.000408199901
  error estimate for blocks of size 2^( 4) =       0.000414910035
  error estimate for blocks of size 2^( 5) =       0.000419580974
  error estimate for blocks of size 2^( 6) =       0.000422251249
  error estimate for blocks of size 2^( 7) =       0.000426608755

      target function =                  N/A
              le_mean =     -17.215395719029
             les_mean =     296.687674811490
             stat err =       0.000420837753
             autocorr =       1.167714814097
              std dev =       0.550758611211
             le_variance =       0.303335047823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721539571903e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215395719108       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215615835788       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215622162734       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215622356120       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215622437046       residual = 5.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.697076e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215395719108       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215488734292       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215490752211       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215490984177       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.848257e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215395719108       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215423822566       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215424474797       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215424587977       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.024996e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7307e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.381167e-02                3 1 ON  0
ci_002 -3.332482e-02                3 1 ON  1
ci_003 -2.683987e-02                3 1 ON  2
ci_004 2.355765e-02                 3 1 ON  3
ci_005 2.365721e-02                 3 1 ON  4
ci_006 -2.215124e-02                3 1 ON  5
ci_007 -2.220479e-02                3 1 ON  6
ci_008 -1.965569e-02                3 1 ON  7
ci_009 -1.950549e-02                3 1 ON  8
ci_010 -1.838513e-02                3 1 ON  9
ci_011 -1.824953e-02                3 1 ON  10
ci_012 -1.812775e-02                3 1 ON  11
ci_013 -1.991208e-02                3 1 ON  12
ci_014 1.657504e-02                 3 1 ON  13
ci_015 1.592027e-02                 3 1 ON  14
ci_016 1.679826e-02                 3 1 ON  15
ci_017 1.705350e-02                 3 1 ON  16
ci_018 1.506076e-02                 3 1 ON  17
ci_019 1.497320e-02                 3 1 ON  18
ci_020 1.528107e-02                 3 1 ON  19
ci_021 1.524317e-02                 3 1 ON  20
ci_022 1.390267e-02                 3 1 ON  21
ci_023 1.325983e-02                 3 1 ON  22
ci_024 1.218800e-02                 3 1 ON  23
ci_025 1.205472e-02                 3 1 ON  24
ci_026 1.338725e-02                 3 1 ON  25
ci_027 1.366356e-02                 3 1 ON  26
ci_028 -1.510353e-02                3 1 ON  27
ci_029 -1.505461e-02                3 1 ON  28
ci_030 -1.135974e-02                3 1 ON  29
ci_031 -1.152038e-02                3 1 ON  30
ci_032 -1.383393e-02                3 1 ON  31
ci_033 1.078148e-02                 3 1 ON  32
ci_034 1.070742e-02                 3 1 ON  33
ci_035 -6.235621e-03                3 1 ON  34
ci_036 -1.189795e-02                3 1 ON  35
ci_037 -1.184112e-02                3 1 ON  36
ci_038 2.256837e-03                 3 1 ON  37
ci_039 2.548051e-03                 3 1 ON  38
ci_040 -5.638290e-03                3 1 ON  39
ci_041 1.029214e-02                 3 1 ON  40
ci_042 1.041897e-02                 3 1 ON  41
ci_043 -4.807958e-03                3 1 ON  42
ci_044 -1.505984e-02                3 1 ON  43
ci_045 -3.159164e-03                3 1 ON  44
ci_046 6.425529e-03                 3 1 ON  45
ci_047 6.617656e-03                 3 1 ON  46
ci_048 -1.200374e-02                3 1 ON  47
ci_049 -1.187824e-02                3 1 ON  48
ci_050 8.416440e-03                 3 1 ON  49
ci_051 8.388860e-03                 3 1 ON  50
ci_052 -7.695570e-03                3 1 ON  51
ci_053 -8.020571e-03                3 1 ON  52
ci_054 -2.968007e-03                3 1 ON  53
ci_055 -3.385331e-03                3 1 ON  54
ci_056 6.055962e-03                 3 1 ON  55
ci_057 6.150379e-03                 3 1 ON  56
ci_058 -7.958087e-03                3 1 ON  57
ci_059 -7.844135e-03                3 1 ON  58
ci_060 8.492338e-03                 3 1 ON  59
ci_061 8.819392e-03                 3 1 ON  60
ci_062 -4.002710e-03                3 1 ON  61
ci_063 -4.163961e-03                3 1 ON  62
ci_064 -3.899472e-03                3 1 ON  63
ci_065 -5.015166e-03                3 1 ON  64
ci_066 6.357722e-03                 3 1 ON  65
ci_067 6.126733e-03                 3 1 ON  66
ci_068 -5.247786e-03                3 1 ON  67
ci_069 -4.984958e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.259411
====================================================
  Execution time = 1.4229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2081e-01
  Total weights = 1.9566e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306606864376
                                         uncertainty =       0.001729824406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306606864376
                                         uncertainty =       0.001729824406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391476633
  error estimate for blocks of size 2^( 2) =       0.000400907102
  error estimate for blocks of size 2^( 3) =       0.000409294368
  error estimate for blocks of size 2^( 4) =       0.000414879838
  error estimate for blocks of size 2^( 5) =       0.000417134454
  error estimate for blocks of size 2^( 6) =       0.000417759755
  error estimate for blocks of size 2^( 7) =       0.000419848920

      target function =                  N/A
              le_mean =     -17.216271730584
             les_mean =     296.770629229883
             stat err =       0.000417405742
             autocorr =       1.136855189491
              std dev =       0.553631563794
             le_variance =       0.306507908429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301749237697
                                         uncertainty =       0.001848438755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301749237697
                                         uncertainty =       0.001848438755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388360202
  error estimate for blocks of size 2^( 2) =       0.000397849143
  error estimate for blocks of size 2^( 3) =       0.000406370147
  error estimate for blocks of size 2^( 4) =       0.000412029455
  error estimate for blocks of size 2^( 5) =       0.000414386884
  error estimate for blocks of size 2^( 6) =       0.000415181214
  error estimate for blocks of size 2^( 7) =       0.000417369836

      target function =                  N/A
              le_mean =     -17.216311575126
             les_mean =     296.778973569532
             stat err =       0.000414741847
             autocorr =       1.140476338029
              std dev =       0.549224264633
             le_variance =       0.301647292862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301739737910
                                         uncertainty =       0.001641108679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301739737910
                                         uncertainty =       0.001641108679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388355568
  error estimate for blocks of size 2^( 2) =       0.000397837724
  error estimate for blocks of size 2^( 3) =       0.000406332267
  error estimate for blocks of size 2^( 4) =       0.000411978124
  error estimate for blocks of size 2^( 5) =       0.000414316142
  error estimate for blocks of size 2^( 6) =       0.000415050569
  error estimate for blocks of size 2^( 7) =       0.000417219183

      target function =                  N/A
              le_mean =     -17.216258813381
             les_mean =     296.719965585919
             stat err =       0.000414641004
             autocorr =       1.139949002654
              std dev =       0.549217711259
             le_variance =       0.301640094361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305739320562
                                         uncertainty =       0.001715991316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305739320562
                                         uncertainty =       0.001715991316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390922200
  error estimate for blocks of size 2^( 2) =       0.000400357525
  error estimate for blocks of size 2^( 3) =       0.000408758367
  error estimate for blocks of size 2^( 4) =       0.000414347685
  error estimate for blocks of size 2^( 5) =       0.000416610131
  error estimate for blocks of size 2^( 6) =       0.000417259208
  error estimate for blocks of size 2^( 7) =       0.000419363407

      target function =                  N/A
              le_mean =     -17.216256125439
             les_mean =     296.729223442619
             stat err =       0.000416895108
             autocorr =       1.137294474136
              std dev =       0.552847477312
             le_variance =       0.305640333171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216271730584        initial
     2.5000e-01     2.5000e+00             1.6971e-03       -17.216311575126  <--
     1.0000e+00     1.0000e+01             6.8483e-04       -17.216258813381
     4.0000e+00     4.0000e+01             2.0250e-04       -17.216256125439

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.7201e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.288537e-02 3 1  ON 0
ci_002                -3.231257e-02 3 1  ON 1
ci_003                -2.637213e-02 3 1  ON 2
ci_004                 2.273205e-02 3 1  ON 3
ci_005                 2.297600e-02 3 1  ON 4
ci_006                -2.143310e-02 3 1  ON 5
ci_007                -2.134617e-02 3 1  ON 6
ci_008                -1.912100e-02 3 1  ON 7
ci_009                -1.892749e-02 3 1  ON 8
ci_010                -1.804638e-02 3 1  ON 9
ci_011                -1.791012e-02 3 1  ON 10
ci_012                -1.747696e-02 3 1  ON 11
ci_013                -1.949031e-02 3 1  ON 12
ci_014                 1.613585e-02 3 1  ON 13
ci_015                 1.516920e-02 3 1  ON 14
ci_016                 1.677039e-02 3 1  ON 15
ci_017                 1.672578e-02 3 1  ON 16
ci_018                 1.455909e-02 3 1  ON 17
ci_019                 1.465207e-02 3 1  ON 18
ci_020                 1.462783e-02 3 1  ON 19
ci_021                 1.461272e-02 3 1  ON 20
ci_022                 1.325504e-02 3 1  ON 21
ci_023                 1.261320e-02 3 1  ON 22
ci_024                 1.187050e-02 3 1  ON 23
ci_025                 1.133865e-02 3 1  ON 24
ci_026                 1.300478e-02 3 1  ON 25
ci_027                 1.305365e-02 3 1  ON 26
ci_028                -1.459951e-02 3 1  ON 27
ci_029                -1.467243e-02 3 1  ON 28
ci_030                -1.103627e-02 3 1  ON 29
ci_031                -1.122388e-02 3 1  ON 30
ci_032                -1.360920e-02 3 1  ON 31
ci_033                 1.076136e-02 3 1  ON 32
ci_034                 1.066033e-02 3 1  ON 33
ci_035                -5.556002e-03 3 1  ON 34
ci_036                -1.170622e-02 3 1  ON 35
ci_037                -1.133484e-02 3 1  ON 36
ci_038                 1.778983e-03 3 1  ON 37
ci_039                 1.854489e-03 3 1  ON 38
ci_040                -5.287404e-03 3 1  ON 39
ci_041                 1.002397e-02 3 1  ON 40
ci_042                 1.019582e-02 3 1  ON 41
ci_043                -4.303662e-03 3 1  ON 42
ci_044                -1.467467e-02 3 1  ON 43
ci_045                -2.494440e-03 3 1  ON 44
ci_046                 6.142810e-03 3 1  ON 45
ci_047                 6.187188e-03 3 1  ON 46
ci_048                -1.174728e-02 3 1  ON 47
ci_049                -1.189848e-02 3 1  ON 48
ci_050                 8.364079e-03 3 1  ON 49
ci_051                 8.115606e-03 3 1  ON 50
ci_052                -7.295404e-03 3 1  ON 51
ci_053                -7.560218e-03 3 1  ON 52
ci_054                -2.578296e-03 3 1  ON 53
ci_055                -3.110261e-03 3 1  ON 54
ci_056                 5.757215e-03 3 1  ON 55
ci_057                 5.851571e-03 3 1  ON 56
ci_058                -7.828584e-03 3 1  ON 57
ci_059                -7.089891e-03 3 1  ON 58
ci_060                 8.687925e-03 3 1  ON 59
ci_061                 8.797216e-03 3 1  ON 60
ci_062                -3.554507e-03 3 1  ON 61
ci_063                -3.775314e-03 3 1  ON 62
ci_064                -3.622577e-03 3 1  ON 63
ci_065                -4.785812e-03 3 1  ON 64
ci_066                 6.164660e-03 3 1  ON 65
ci_067                 5.747983e-03 3 1  ON 66
ci_068                -5.270235e-03 3 1  ON 67
ci_069                -4.417865e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.35769
====================================================
  Execution time = 1.4546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2901e-01
  Total weights = 1.956569471e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303480660073
                                         uncertainty =       0.003492162554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303480660073
                                         uncertainty =       0.003492162554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389515334
  error estimate for blocks of size 2^( 2) =       0.000399229132
  error estimate for blocks of size 2^( 3) =       0.000407408751
  error estimate for blocks of size 2^( 4) =       0.000414286435
  error estimate for blocks of size 2^( 5) =       0.000418169562
  error estimate for blocks of size 2^( 6) =       0.000420722593
  error estimate for blocks of size 2^( 7) =       0.000422175329

      target function =                  N/A
              le_mean =     -17.216284577280
             les_mean =     296.729461405299
             stat err =       0.000418838480
             autocorr =       1.156229461839
              std dev =       0.550857867700
             le_variance =       0.303444390407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628457728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216284577321       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216316675702       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319623825       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216321820109       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216322299987       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 3.998759e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216284577321       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216304933220       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307929796       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216308586203       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216308692595       residual = 4.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.601002e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216284577321       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292840932       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294758253       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216294790137       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.084238e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7179e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.163202e-02 3 1  ON 0
ci_002                -3.055935e-02 3 1  ON 1
ci_003                -2.610729e-02 3 1  ON 2
ci_004                 2.232241e-02 3 1  ON 3
ci_005                 2.211603e-02 3 1  ON 4
ci_006                -2.116206e-02 3 1  ON 5
ci_007                -2.105166e-02 3 1  ON 6
ci_008                -1.888329e-02 3 1  ON 7
ci_009                -1.929644e-02 3 1  ON 8
ci_010                -1.720308e-02 3 1  ON 9
ci_011                -1.636817e-02 3 1  ON 10
ci_012                -1.699897e-02 3 1  ON 11
ci_013                -1.925316e-02 3 1  ON 12
ci_014                 1.492497e-02 3 1  ON 13
ci_015                 1.476826e-02 3 1  ON 14
ci_016                 1.645211e-02 3 1  ON 15
ci_017                 1.636084e-02 3 1  ON 16
ci_018                 1.322912e-02 3 1  ON 17
ci_019                 1.418496e-02 3 1  ON 18
ci_020                 1.482669e-02 3 1  ON 19
ci_021                 1.405102e-02 3 1  ON 20
ci_022                 1.328659e-02 3 1  ON 21
ci_023                 1.153759e-02 3 1  ON 22
ci_024                 1.108318e-02 3 1  ON 23
ci_025                 1.123498e-02 3 1  ON 24
ci_026                 1.275701e-02 3 1  ON 25
ci_027                 1.266489e-02 3 1  ON 26
ci_028                -1.436909e-02 3 1  ON 27
ci_029                -1.394362e-02 3 1  ON 28
ci_030                -1.024735e-02 3 1  ON 29
ci_031                -1.080908e-02 3 1  ON 30
ci_032                -1.621020e-02 3 1  ON 31
ci_033                 1.019589e-02 3 1  ON 32
ci_034                 1.201222e-02 3 1  ON 33
ci_035                -5.183360e-03 3 1  ON 34
ci_036                -1.141692e-02 3 1  ON 35
ci_037                -1.080460e-02 3 1  ON 36
ci_038                 1.475482e-03 3 1  ON 37
ci_039                 1.566152e-03 3 1  ON 38
ci_040                -4.570187e-03 3 1  ON 39
ci_041                 1.102757e-02 3 1  ON 40
ci_042                 1.006738e-02 3 1  ON 41
ci_043                -4.024960e-03 3 1  ON 42
ci_044                -1.426301e-02 3 1  ON 43
ci_045                -1.843401e-03 3 1  ON 44
ci_046                 5.624730e-03 3 1  ON 45
ci_047                 6.191892e-03 3 1  ON 46
ci_048                -1.136686e-02 3 1  ON 47
ci_049                -1.218995e-02 3 1  ON 48
ci_050                 8.138038e-03 3 1  ON 49
ci_051                 8.021575e-03 3 1  ON 50
ci_052                -7.156887e-03 3 1  ON 51
ci_053                -6.850183e-03 3 1  ON 52
ci_054                -2.438909e-03 3 1  ON 53
ci_055                -2.522442e-03 3 1  ON 54
ci_056                 5.651424e-03 3 1  ON 55
ci_057                 5.487891e-03 3 1  ON 56
ci_058                -7.612168e-03 3 1  ON 57
ci_059                -7.297445e-03 3 1  ON 58
ci_060                 8.474862e-03 3 1  ON 59
ci_061                 8.860512e-03 3 1  ON 60
ci_062                -3.490372e-03 3 1  ON 61
ci_063                -3.476949e-03 3 1  ON 62
ci_064                -3.641545e-03 3 1  ON 63
ci_065                -4.209016e-03 3 1  ON 64
ci_066                 6.216553e-03 3 1  ON 65
ci_067                 6.086768e-03 3 1  ON 66
ci_068                -5.190542e-03 3 1  ON 67
ci_069                -4.897443e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1963
    reference variance = 0.221407
====================================================
  Execution time = 1.4449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1226e-01
  Total weights = 1.9569e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000827425
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302391505469
                                         uncertainty =       0.002106860606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302391505469
                                         uncertainty =       0.002106860606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388840788
  error estimate for blocks of size 2^( 2) =       0.000398777930
  error estimate for blocks of size 2^( 3) =       0.000407837979
  error estimate for blocks of size 2^( 4) =       0.000414113702
  error estimate for blocks of size 2^( 5) =       0.000417181415
  error estimate for blocks of size 2^( 6) =       0.000418260245
  error estimate for blocks of size 2^( 7) =       0.000421216511

      target function =                  N/A
              le_mean =     -17.216652553293
             les_mean =     296.736426551026
             stat err =       0.000417692968
             autocorr =       1.153906709614
              std dev =       0.549903916329
             le_variance =       0.302394317194

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0247868
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299305722558
                                         uncertainty =       0.002020648488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299305722558
                                         uncertainty =       0.002020648488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386849717
  error estimate for blocks of size 2^( 2) =       0.000396881787
  error estimate for blocks of size 2^( 3) =       0.000406055200
  error estimate for blocks of size 2^( 4) =       0.000412454969
  error estimate for blocks of size 2^( 5) =       0.000415679610
  error estimate for blocks of size 2^( 6) =       0.000416713660
  error estimate for blocks of size 2^( 7) =       0.000419518048

      target function =                  N/A
              le_mean =     -17.216652207176
             les_mean =     296.741579376347
             stat err =       0.000416091572
             autocorr =       1.156893203388
              std dev =       0.547088116846
             le_variance =       0.299305407594

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00081875
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298902312323
                                         uncertainty =       0.002008430379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298902312323
                                         uncertainty =       0.002008430379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386588322
  error estimate for blocks of size 2^( 2) =       0.000396650440
  error estimate for blocks of size 2^( 3) =       0.000405867067
  error estimate for blocks of size 2^( 4) =       0.000412340969
  error estimate for blocks of size 2^( 5) =       0.000415589260
  error estimate for blocks of size 2^( 6) =       0.000416598492
  error estimate for blocks of size 2^( 7) =       0.000419329829

      target function =                  N/A
              le_mean =     -17.216692850853
             les_mean =     296.741551222980
             stat err =       0.000415964638
             autocorr =       1.157751528064
              std dev =       0.546718447369
             le_variance =       0.298901060694

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00677433
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223640482
                                         uncertainty =       0.002082888698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301223640482
                                         uncertainty =       0.002082888698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388088835
  error estimate for blocks of size 2^( 2) =       0.000398043827
  error estimate for blocks of size 2^( 3) =       0.000407134324
  error estimate for blocks of size 2^( 4) =       0.000413457903
  error estimate for blocks of size 2^( 5) =       0.000416572428
  error estimate for blocks of size 2^( 6) =       0.000417615020
  error estimate for blocks of size 2^( 7) =       0.000420508430

      target function =                  N/A
              le_mean =     -17.216606597529
             les_mean =     296.726391428591
             stat err =       0.000417038446
             autocorr =       1.154755097397
              std dev =       0.548840494461
             le_variance =       0.301225888360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216652553293        initial
     6.2500e-02     6.2500e-01             3.9988e-03       -17.216652207176
     2.5000e-01     2.5000e+00             2.6010e-03       -17.216692850853  <--
     1.0000e+00     1.0000e+01             1.0842e-03       -17.216606597529

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3874e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.163202e-02 3 1  ON 0
ci_002                -3.055935e-02 3 1  ON 1
ci_003                -2.610729e-02 3 1  ON 2
ci_004                 2.232241e-02 3 1  ON 3
ci_005                 2.211603e-02 3 1  ON 4
ci_006                -2.116206e-02 3 1  ON 5
ci_007                -2.105166e-02 3 1  ON 6
ci_008                -1.888329e-02 3 1  ON 7
ci_009                -1.929644e-02 3 1  ON 8
ci_010                -1.720308e-02 3 1  ON 9
ci_011                -1.636817e-02 3 1  ON 10
ci_012                -1.699897e-02 3 1  ON 11
ci_013                -1.925316e-02 3 1  ON 12
ci_014                 1.492497e-02 3 1  ON 13
ci_015                 1.476826e-02 3 1  ON 14
ci_016                 1.645211e-02 3 1  ON 15
ci_017                 1.636084e-02 3 1  ON 16
ci_018                 1.322912e-02 3 1  ON 17
ci_019                 1.418496e-02 3 1  ON 18
ci_020                 1.482669e-02 3 1  ON 19
ci_021                 1.405102e-02 3 1  ON 20
ci_022                 1.328659e-02 3 1  ON 21
ci_023                 1.153759e-02 3 1  ON 22
ci_024                 1.108318e-02 3 1  ON 23
ci_025                 1.123498e-02 3 1  ON 24
ci_026                 1.275701e-02 3 1  ON 25
ci_027                 1.266489e-02 3 1  ON 26
ci_028                -1.436909e-02 3 1  ON 27
ci_029                -1.394362e-02 3 1  ON 28
ci_030                -1.024735e-02 3 1  ON 29
ci_031                -1.080908e-02 3 1  ON 30
ci_032                -1.621020e-02 3 1  ON 31
ci_033                 1.019589e-02 3 1  ON 32
ci_034                 1.201222e-02 3 1  ON 33
ci_035                -5.183360e-03 3 1  ON 34
ci_036                -1.141692e-02 3 1  ON 35
ci_037                -1.080460e-02 3 1  ON 36
ci_038                 1.475482e-03 3 1  ON 37
ci_039                 1.566152e-03 3 1  ON 38
ci_040                -4.570187e-03 3 1  ON 39
ci_041                 1.102757e-02 3 1  ON 40
ci_042                 1.006738e-02 3 1  ON 41
ci_043                -4.024960e-03 3 1  ON 42
ci_044                -1.426301e-02 3 1  ON 43
ci_045                -1.843401e-03 3 1  ON 44
ci_046                 5.624730e-03 3 1  ON 45
ci_047                 6.191892e-03 3 1  ON 46
ci_048                -1.136686e-02 3 1  ON 47
ci_049                -1.218995e-02 3 1  ON 48
ci_050                 8.138038e-03 3 1  ON 49
ci_051                 8.021575e-03 3 1  ON 50
ci_052                -7.156887e-03 3 1  ON 51
ci_053                -6.850183e-03 3 1  ON 52
ci_054                -2.438909e-03 3 1  ON 53
ci_055                -2.522442e-03 3 1  ON 54
ci_056                 5.651424e-03 3 1  ON 55
ci_057                 5.487891e-03 3 1  ON 56
ci_058                -7.612168e-03 3 1  ON 57
ci_059                -7.297445e-03 3 1  ON 58
ci_060                 8.474862e-03 3 1  ON 59
ci_061                 8.860512e-03 3 1  ON 60
ci_062                -3.490372e-03 3 1  ON 61
ci_063                -3.476949e-03 3 1  ON 62
ci_064                -3.641545e-03 3 1  ON 63
ci_065                -4.209016e-03 3 1  ON 64
ci_066                 6.216553e-03 3 1  ON 65
ci_067                 6.086768e-03 3 1  ON 66
ci_068                -5.190542e-03 3 1  ON 67
ci_069                -4.897443e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1818
    reference variance = 0.210981
====================================================
  Execution time = 1.4454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1077e-01
  Total weights = 1.956794899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297294271182
                                         uncertainty =       0.001894892759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297294271182
                                         uncertainty =       0.001894892759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385559826
  error estimate for blocks of size 2^( 2) =       0.000395294222
  error estimate for blocks of size 2^( 3) =       0.000404294364
  error estimate for blocks of size 2^( 4) =       0.000411214921
  error estimate for blocks of size 2^( 5) =       0.000414916699
  error estimate for blocks of size 2^( 6) =       0.000417332933
  error estimate for blocks of size 2^( 7) =       0.000418692300

      target function =                  N/A
              le_mean =     -17.216621328588
             les_mean =     296.722819318185
             stat err =       0.000415539213
             autocorr =       1.161556863634
              std dev =       0.545263934677
             le_variance =       0.297312758460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662132859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621328650       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216695799579       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216696674364       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216695625894       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216695416147       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.668012e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621328650       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665871613       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216667668799       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216667380915       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.478509e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621328650       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216638411177       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216639823537       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216639715651       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.678427e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7081e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.089324e-02 3 1  ON 0
ci_002                -3.088584e-02 3 1  ON 1
ci_003                -2.532439e-02 3 1  ON 2
ci_004                 2.260417e-02 3 1  ON 3
ci_005                 2.258419e-02 3 1  ON 4
ci_006                -2.112119e-02 3 1  ON 5
ci_007                -2.130239e-02 3 1  ON 6
ci_008                -1.874996e-02 3 1  ON 7
ci_009                -1.854152e-02 3 1  ON 8
ci_010                -1.704749e-02 3 1  ON 9
ci_011                -1.638147e-02 3 1  ON 10
ci_012                -1.640591e-02 3 1  ON 11
ci_013                -2.066224e-02 3 1  ON 12
ci_014                 1.433248e-02 3 1  ON 13
ci_015                 1.476185e-02 3 1  ON 14
ci_016                 1.646103e-02 3 1  ON 15
ci_017                 1.608350e-02 3 1  ON 16
ci_018                 1.277252e-02 3 1  ON 17
ci_019                 1.358205e-02 3 1  ON 18
ci_020                 1.429386e-02 3 1  ON 19
ci_021                 1.333472e-02 3 1  ON 20
ci_022                 1.277032e-02 3 1  ON 21
ci_023                 1.155177e-02 3 1  ON 22
ci_024                 1.073360e-02 3 1  ON 23
ci_025                 1.089834e-02 3 1  ON 24
ci_026                 1.259956e-02 3 1  ON 25
ci_027                 1.272109e-02 3 1  ON 26
ci_028                -1.368756e-02 3 1  ON 27
ci_029                -1.439800e-02 3 1  ON 28
ci_030                -1.056455e-02 3 1  ON 29
ci_031                -1.049844e-02 3 1  ON 30
ci_032                -1.488400e-02 3 1  ON 31
ci_033                 1.000489e-02 3 1  ON 32
ci_034                 1.053371e-02 3 1  ON 33
ci_035                -5.053410e-03 3 1  ON 34
ci_036                -1.121024e-02 3 1  ON 35
ci_037                -1.076659e-02 3 1  ON 36
ci_038                 1.075535e-03 3 1  ON 37
ci_039                 1.496407e-03 3 1  ON 38
ci_040                -4.308528e-03 3 1  ON 39
ci_041                 1.044605e-02 3 1  ON 40
ci_042                 9.950634e-03 3 1  ON 41
ci_043                -3.934957e-03 3 1  ON 42
ci_044                -1.451295e-02 3 1  ON 43
ci_045                -1.807138e-03 3 1  ON 44
ci_046                 5.226249e-03 3 1  ON 45
ci_047                 5.748793e-03 3 1  ON 46
ci_048                -1.164266e-02 3 1  ON 47
ci_049                -1.189605e-02 3 1  ON 48
ci_050                 7.775366e-03 3 1  ON 49
ci_051                 7.990785e-03 3 1  ON 50
ci_052                -7.107995e-03 3 1  ON 51
ci_053                -6.761275e-03 3 1  ON 52
ci_054                -2.273253e-03 3 1  ON 53
ci_055                -2.265802e-03 3 1  ON 54
ci_056                 5.358419e-03 3 1  ON 55
ci_057                 5.647279e-03 3 1  ON 56
ci_058                -7.224595e-03 3 1  ON 57
ci_059                -7.343240e-03 3 1  ON 58
ci_060                 8.451749e-03 3 1  ON 59
ci_061                 9.135459e-03 3 1  ON 60
ci_062                -3.611866e-03 3 1  ON 61
ci_063                -3.710971e-03 3 1  ON 62
ci_064                -3.586780e-03 3 1  ON 63
ci_065                -4.497163e-03 3 1  ON 64
ci_066                 6.171522e-03 3 1  ON 65
ci_067                 5.893386e-03 3 1  ON 66
ci_068                -5.151305e-03 3 1  ON 67
ci_069                -4.901948e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.231967
====================================================
  Execution time = 1.4512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1929e-01
  Total weights = 1.9565e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302165975565
                                         uncertainty =       0.002577057471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302165975565
                                         uncertainty =       0.002577057471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388726295
  error estimate for blocks of size 2^( 2) =       0.000398735554
  error estimate for blocks of size 2^( 3) =       0.000407383928
  error estimate for blocks of size 2^( 4) =       0.000413166141
  error estimate for blocks of size 2^( 5) =       0.000416729367
  error estimate for blocks of size 2^( 6) =       0.000420232976
  error estimate for blocks of size 2^( 7) =       0.000419706408

      target function =                  N/A
              le_mean =     -17.216726547369
             les_mean =     296.746417279934
             stat err =       0.000417458723
             autocorr =       1.153291902607
              std dev =       0.549741998320
             le_variance =       0.302216264717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300579186439
                                         uncertainty =       0.002492870839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300579186439
                                         uncertainty =       0.002492870839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387701865
  error estimate for blocks of size 2^( 2) =       0.000397793824
  error estimate for blocks of size 2^( 3) =       0.000406542190
  error estimate for blocks of size 2^( 4) =       0.000412422613
  error estimate for blocks of size 2^( 5) =       0.000416056830
  error estimate for blocks of size 2^( 6) =       0.000419544846
  error estimate for blocks of size 2^( 7) =       0.000419118020

      target function =                  N/A
              le_mean =     -17.216743688944
             les_mean =     296.739609673103
             stat err =       0.000416785577
             autocorr =       1.155658674364
              std dev =       0.548293235562
             le_variance =       0.300625472163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301053237537
                                         uncertainty =       0.002678660784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301053237537
                                         uncertainty =       0.002678660784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388005577
  error estimate for blocks of size 2^( 2) =       0.000398110120
  error estimate for blocks of size 2^( 3) =       0.000406872224
  error estimate for blocks of size 2^( 4) =       0.000412776205
  error estimate for blocks of size 2^( 5) =       0.000416470823
  error estimate for blocks of size 2^( 6) =       0.000419936515
  error estimate for blocks of size 2^( 7) =       0.000419526243

      target function =                  N/A
              le_mean =     -17.216770703454
             les_mean =     296.825783620743
             stat err =       0.000417177447
             autocorr =       1.156020959142
              std dev =       0.548722748692
             le_variance =       0.301096654932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656586119
                                         uncertainty =       0.002541459702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656586119
                                         uncertainty =       0.002541459702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388397904
  error estimate for blocks of size 2^( 2) =       0.000398433014
  error estimate for blocks of size 2^( 3) =       0.000407106381
  error estimate for blocks of size 2^( 4) =       0.000412917311
  error estimate for blocks of size 2^( 5) =       0.000416492562
  error estimate for blocks of size 2^( 6) =       0.000419990379
  error estimate for blocks of size 2^( 7) =       0.000419504924

      target function =                  N/A
              le_mean =     -17.216724449470
             les_mean =     296.818370104671
             stat err =       0.000417226294
             autocorr =       1.153956893204
              std dev =       0.549277582817
             le_variance =       0.301705862985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216726547369        initial
     6.2500e-02     6.2500e-01             2.6680e-03       -17.216743688944
     2.5000e-01     2.5000e+00             1.4785e-03       -17.216770703454  <--
     1.0000e+00     1.0000e+01             5.6784e-04       -17.216724449470

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4032e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.089324e-02 3 1  ON 0
ci_002                -3.088584e-02 3 1  ON 1
ci_003                -2.532439e-02 3 1  ON 2
ci_004                 2.260417e-02 3 1  ON 3
ci_005                 2.258419e-02 3 1  ON 4
ci_006                -2.112119e-02 3 1  ON 5
ci_007                -2.130239e-02 3 1  ON 6
ci_008                -1.874996e-02 3 1  ON 7
ci_009                -1.854152e-02 3 1  ON 8
ci_010                -1.704749e-02 3 1  ON 9
ci_011                -1.638147e-02 3 1  ON 10
ci_012                -1.640591e-02 3 1  ON 11
ci_013                -2.066224e-02 3 1  ON 12
ci_014                 1.433248e-02 3 1  ON 13
ci_015                 1.476185e-02 3 1  ON 14
ci_016                 1.646103e-02 3 1  ON 15
ci_017                 1.608350e-02 3 1  ON 16
ci_018                 1.277252e-02 3 1  ON 17
ci_019                 1.358205e-02 3 1  ON 18
ci_020                 1.429386e-02 3 1  ON 19
ci_021                 1.333472e-02 3 1  ON 20
ci_022                 1.277032e-02 3 1  ON 21
ci_023                 1.155177e-02 3 1  ON 22
ci_024                 1.073360e-02 3 1  ON 23
ci_025                 1.089834e-02 3 1  ON 24
ci_026                 1.259956e-02 3 1  ON 25
ci_027                 1.272109e-02 3 1  ON 26
ci_028                -1.368756e-02 3 1  ON 27
ci_029                -1.439800e-02 3 1  ON 28
ci_030                -1.056455e-02 3 1  ON 29
ci_031                -1.049844e-02 3 1  ON 30
ci_032                -1.488400e-02 3 1  ON 31
ci_033                 1.000489e-02 3 1  ON 32
ci_034                 1.053371e-02 3 1  ON 33
ci_035                -5.053410e-03 3 1  ON 34
ci_036                -1.121024e-02 3 1  ON 35
ci_037                -1.076659e-02 3 1  ON 36
ci_038                 1.075535e-03 3 1  ON 37
ci_039                 1.496407e-03 3 1  ON 38
ci_040                -4.308528e-03 3 1  ON 39
ci_041                 1.044605e-02 3 1  ON 40
ci_042                 9.950634e-03 3 1  ON 41
ci_043                -3.934957e-03 3 1  ON 42
ci_044                -1.451295e-02 3 1  ON 43
ci_045                -1.807138e-03 3 1  ON 44
ci_046                 5.226249e-03 3 1  ON 45
ci_047                 5.748793e-03 3 1  ON 46
ci_048                -1.164266e-02 3 1  ON 47
ci_049                -1.189605e-02 3 1  ON 48
ci_050                 7.775366e-03 3 1  ON 49
ci_051                 7.990785e-03 3 1  ON 50
ci_052                -7.107995e-03 3 1  ON 51
ci_053                -6.761275e-03 3 1  ON 52
ci_054                -2.273253e-03 3 1  ON 53
ci_055                -2.265802e-03 3 1  ON 54
ci_056                 5.358419e-03 3 1  ON 55
ci_057                 5.647279e-03 3 1  ON 56
ci_058                -7.224595e-03 3 1  ON 57
ci_059                -7.343240e-03 3 1  ON 58
ci_060                 8.451749e-03 3 1  ON 59
ci_061                 9.135459e-03 3 1  ON 60
ci_062                -3.611866e-03 3 1  ON 61
ci_063                -3.710971e-03 3 1  ON 62
ci_064                -3.586780e-03 3 1  ON 63
ci_065                -4.497163e-03 3 1  ON 64
ci_066                 6.171522e-03 3 1  ON 65
ci_067                 5.893386e-03 3 1  ON 66
ci_068                -5.151305e-03 3 1  ON 67
ci_069                -4.901948e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2136
    reference variance = 0.190046
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.0950e-01
  Total weights = 1.956684846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295619228479
                                         uncertainty =       0.001863404477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295619228479
                                         uncertainty =       0.001863404477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384439472
  error estimate for blocks of size 2^( 2) =       0.000394159548
  error estimate for blocks of size 2^( 3) =       0.000403181056
  error estimate for blocks of size 2^( 4) =       0.000409773858
  error estimate for blocks of size 2^( 5) =       0.000413780815
  error estimate for blocks of size 2^( 6) =       0.000416180631
  error estimate for blocks of size 2^( 7) =       0.000415802674

      target function =                  N/A
              le_mean =     -17.217503689755
             les_mean =     296.751933967324
             stat err =       0.000413884494
             autocorr =       1.159050528835
              std dev =       0.543679514807
             le_variance =       0.295587414821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721750368976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217503689796       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217547133458       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217552745311       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217552936634       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217552651774       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.894210e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217503689796       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217530508988       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217532877092       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217532937062       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.108820e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217503689796       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217514287425       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217514900480       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217514964473       residual = 5.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.192228e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7247e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.117512e-02 3 1  ON 0
ci_002                -3.045103e-02 3 1  ON 1
ci_003                -2.578148e-02 3 1  ON 2
ci_004                 2.203990e-02 3 1  ON 3
ci_005                 2.175146e-02 3 1  ON 4
ci_006                -2.001237e-02 3 1  ON 5
ci_007                -2.059879e-02 3 1  ON 6
ci_008                -1.852112e-02 3 1  ON 7
ci_009                -1.846921e-02 3 1  ON 8
ci_010                -1.660941e-02 3 1  ON 9
ci_011                -1.642904e-02 3 1  ON 10
ci_012                -1.666421e-02 3 1  ON 11
ci_013                -2.052829e-02 3 1  ON 12
ci_014                 1.401813e-02 3 1  ON 13
ci_015                 1.443729e-02 3 1  ON 14
ci_016                 1.644519e-02 3 1  ON 15
ci_017                 1.642722e-02 3 1  ON 16
ci_018                 1.337614e-02 3 1  ON 17
ci_019                 1.364203e-02 3 1  ON 18
ci_020                 1.382743e-02 3 1  ON 19
ci_021                 1.357110e-02 3 1  ON 20
ci_022                 1.256249e-02 3 1  ON 21
ci_023                 1.177469e-02 3 1  ON 22
ci_024                 1.105227e-02 3 1  ON 23
ci_025                 1.059486e-02 3 1  ON 24
ci_026                 1.267075e-02 3 1  ON 25
ci_027                 1.198521e-02 3 1  ON 26
ci_028                -1.368342e-02 3 1  ON 27
ci_029                -1.464682e-02 3 1  ON 28
ci_030                -1.093506e-02 3 1  ON 29
ci_031                -1.025286e-02 3 1  ON 30
ci_032                -1.432595e-02 3 1  ON 31
ci_033                 9.847666e-03 3 1  ON 32
ci_034                 1.038518e-02 3 1  ON 33
ci_035                -4.970605e-03 3 1  ON 34
ci_036                -1.120785e-02 3 1  ON 35
ci_037                -1.053348e-02 3 1  ON 36
ci_038                 1.404133e-03 3 1  ON 37
ci_039                 1.402621e-03 3 1  ON 38
ci_040                -4.190805e-03 3 1  ON 39
ci_041                 1.003644e-02 3 1  ON 40
ci_042                 9.629758e-03 3 1  ON 41
ci_043                -3.669103e-03 3 1  ON 42
ci_044                -1.426609e-02 3 1  ON 43
ci_045                -1.932889e-03 3 1  ON 44
ci_046                 5.482326e-03 3 1  ON 45
ci_047                 5.544847e-03 3 1  ON 46
ci_048                -1.170596e-02 3 1  ON 47
ci_049                -1.139601e-02 3 1  ON 48
ci_050                 7.831422e-03 3 1  ON 49
ci_051                 7.783118e-03 3 1  ON 50
ci_052                -7.011811e-03 3 1  ON 51
ci_053                -7.385419e-03 3 1  ON 52
ci_054                -2.462024e-03 3 1  ON 53
ci_055                -2.501078e-03 3 1  ON 54
ci_056                 4.991948e-03 3 1  ON 55
ci_057                 5.011208e-03 3 1  ON 56
ci_058                -7.493811e-03 3 1  ON 57
ci_059                -6.821082e-03 3 1  ON 58
ci_060                 8.609643e-03 3 1  ON 59
ci_061                 8.543842e-03 3 1  ON 60
ci_062                -3.184044e-03 3 1  ON 61
ci_063                -3.564074e-03 3 1  ON 62
ci_064                -3.537115e-03 3 1  ON 63
ci_065                -4.153661e-03 3 1  ON 64
ci_066                 6.038621e-03 3 1  ON 65
ci_067                 5.903398e-03 3 1  ON 66
ci_068                -4.695948e-03 3 1  ON 67
ci_069                -4.715407e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1748
    reference variance = 0.14392
====================================================
  Execution time = 1.4206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1170e-01
  Total weights = 1.9568e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296723670862
                                         uncertainty =       0.002586642663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296723670862
                                         uncertainty =       0.002586642663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385131781
  error estimate for blocks of size 2^( 2) =       0.000395183271
  error estimate for blocks of size 2^( 3) =       0.000404266869
  error estimate for blocks of size 2^( 4) =       0.000411551035
  error estimate for blocks of size 2^( 5) =       0.000415949832
  error estimate for blocks of size 2^( 6) =       0.000418790595
  error estimate for blocks of size 2^( 7) =       0.000419121066

      target function =                  N/A
              le_mean =     -17.216660202501
             les_mean =     296.743604516539
             stat err =       0.000416353132
             autocorr =       1.168705143430
              std dev =       0.544658588414
             le_variance =       0.296652977933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263755661
                                         uncertainty =       0.002578873107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263755661
                                         uncertainty =       0.002578873107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384830092
  error estimate for blocks of size 2^( 2) =       0.000394943119
  error estimate for blocks of size 2^( 3) =       0.000404092014
  error estimate for blocks of size 2^( 4) =       0.000411417059
  error estimate for blocks of size 2^( 5) =       0.000415810557
  error estimate for blocks of size 2^( 6) =       0.000418695201
  error estimate for blocks of size 2^( 7) =       0.000418999161

      target function =                  N/A
              le_mean =     -17.216674165825
             les_mean =     296.729842310711
             stat err =       0.000416230494
             autocorr =       1.169848817995
              std dev =       0.544231935330
             le_variance =       0.296188399433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296371184853
                                         uncertainty =       0.002573725051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296371184853
                                         uncertainty =       0.002573725051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384899128
  error estimate for blocks of size 2^( 2) =       0.000395031255
  error estimate for blocks of size 2^( 3) =       0.000404198627
  error estimate for blocks of size 2^( 4) =       0.000411522760
  error estimate for blocks of size 2^( 5) =       0.000415912150
  error estimate for blocks of size 2^( 6) =       0.000418800262
  error estimate for blocks of size 2^( 7) =       0.000419097021

      target function =                  N/A
              le_mean =     -17.216698804606
             les_mean =     296.734932655550
             stat err =       0.000416333048
             autocorr =       1.170005539127
              std dev =       0.544329567475
             le_variance =       0.296294678027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296605607774
                                         uncertainty =       0.002598383130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296605607774
                                         uncertainty =       0.002598383130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385054278
  error estimate for blocks of size 2^( 2) =       0.000395129084
  error estimate for blocks of size 2^( 3) =       0.000404226475
  error estimate for blocks of size 2^( 4) =       0.000411528128
  error estimate for blocks of size 2^( 5) =       0.000415925777
  error estimate for blocks of size 2^( 6) =       0.000418770699
  error estimate for blocks of size 2^( 7) =       0.000419113982

      target function =                  N/A
              le_mean =     -17.216647247943
             les_mean =     296.738163145534
             stat err =       0.000416334646
             autocorr =       1.169071841529
              std dev =       0.544548982847
             le_variance =       0.296533594720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216660202501        initial
     6.2500e-02     6.2500e-01             1.8942e-03       -17.216674165825
     2.5000e-01     2.5000e+00             1.1088e-03       -17.216698804606  <--
     1.0000e+00     1.0000e+01             4.1922e-04       -17.216647247943

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3676e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.117512e-02 3 1  ON 0
ci_002                -3.045103e-02 3 1  ON 1
ci_003                -2.578148e-02 3 1  ON 2
ci_004                 2.203990e-02 3 1  ON 3
ci_005                 2.175146e-02 3 1  ON 4
ci_006                -2.001237e-02 3 1  ON 5
ci_007                -2.059879e-02 3 1  ON 6
ci_008                -1.852112e-02 3 1  ON 7
ci_009                -1.846921e-02 3 1  ON 8
ci_010                -1.660941e-02 3 1  ON 9
ci_011                -1.642904e-02 3 1  ON 10
ci_012                -1.666421e-02 3 1  ON 11
ci_013                -2.052829e-02 3 1  ON 12
ci_014                 1.401813e-02 3 1  ON 13
ci_015                 1.443729e-02 3 1  ON 14
ci_016                 1.644519e-02 3 1  ON 15
ci_017                 1.642722e-02 3 1  ON 16
ci_018                 1.337614e-02 3 1  ON 17
ci_019                 1.364203e-02 3 1  ON 18
ci_020                 1.382743e-02 3 1  ON 19
ci_021                 1.357110e-02 3 1  ON 20
ci_022                 1.256249e-02 3 1  ON 21
ci_023                 1.177469e-02 3 1  ON 22
ci_024                 1.105227e-02 3 1  ON 23
ci_025                 1.059486e-02 3 1  ON 24
ci_026                 1.267075e-02 3 1  ON 25
ci_027                 1.198521e-02 3 1  ON 26
ci_028                -1.368342e-02 3 1  ON 27
ci_029                -1.464682e-02 3 1  ON 28
ci_030                -1.093506e-02 3 1  ON 29
ci_031                -1.025286e-02 3 1  ON 30
ci_032                -1.432595e-02 3 1  ON 31
ci_033                 9.847666e-03 3 1  ON 32
ci_034                 1.038518e-02 3 1  ON 33
ci_035                -4.970605e-03 3 1  ON 34
ci_036                -1.120785e-02 3 1  ON 35
ci_037                -1.053348e-02 3 1  ON 36
ci_038                 1.404133e-03 3 1  ON 37
ci_039                 1.402621e-03 3 1  ON 38
ci_040                -4.190805e-03 3 1  ON 39
ci_041                 1.003644e-02 3 1  ON 40
ci_042                 9.629758e-03 3 1  ON 41
ci_043                -3.669103e-03 3 1  ON 42
ci_044                -1.426609e-02 3 1  ON 43
ci_045                -1.932889e-03 3 1  ON 44
ci_046                 5.482326e-03 3 1  ON 45
ci_047                 5.544847e-03 3 1  ON 46
ci_048                -1.170596e-02 3 1  ON 47
ci_049                -1.139601e-02 3 1  ON 48
ci_050                 7.831422e-03 3 1  ON 49
ci_051                 7.783118e-03 3 1  ON 50
ci_052                -7.011811e-03 3 1  ON 51
ci_053                -7.385419e-03 3 1  ON 52
ci_054                -2.462024e-03 3 1  ON 53
ci_055                -2.501078e-03 3 1  ON 54
ci_056                 4.991948e-03 3 1  ON 55
ci_057                 5.011208e-03 3 1  ON 56
ci_058                -7.493811e-03 3 1  ON 57
ci_059                -6.821082e-03 3 1  ON 58
ci_060                 8.609643e-03 3 1  ON 59
ci_061                 8.543842e-03 3 1  ON 60
ci_062                -3.184044e-03 3 1  ON 61
ci_063                -3.564074e-03 3 1  ON 62
ci_064                -3.537115e-03 3 1  ON 63
ci_065                -4.153661e-03 3 1  ON 64
ci_066                 6.038621e-03 3 1  ON 65
ci_067                 5.903398e-03 3 1  ON 66
ci_068                -4.695948e-03 3 1  ON 67
ci_069                -4.715407e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1601
    reference variance = 0.166237
====================================================
  Execution time = 1.5124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1697e-01
  Total weights = 1.956584235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300113534548
                                         uncertainty =       0.003165327631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300113534548
                                         uncertainty =       0.003165327631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387350406
  error estimate for blocks of size 2^( 2) =       0.000397354057
  error estimate for blocks of size 2^( 3) =       0.000406079032
  error estimate for blocks of size 2^( 4) =       0.000412724492
  error estimate for blocks of size 2^( 5) =       0.000416564226
  error estimate for blocks of size 2^( 6) =       0.000418195285
  error estimate for blocks of size 2^( 7) =       0.000419247501

      target function =                  N/A
              le_mean =     -17.216574755095
             les_mean =     296.727414122649
             stat err =       0.000416682876
             autocorr =       1.157186280681
              std dev =       0.547796196982
             le_variance =       0.300080673428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657475509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574755165       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216583105006       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216585595992       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216585662527       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216585650598       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.303952e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574755165       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579847284       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581141185       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216581103608       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.197064e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574755165       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216576743795       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577180728       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.588980e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7753e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.094223e-02 3 1  ON 0
ci_002                -3.067755e-02 3 1  ON 1
ci_003                -2.556688e-02 3 1  ON 2
ci_004                 2.209572e-02 3 1  ON 3
ci_005                 2.160518e-02 3 1  ON 4
ci_006                -1.960637e-02 3 1  ON 5
ci_007                -2.056891e-02 3 1  ON 6
ci_008                -1.833122e-02 3 1  ON 7
ci_009                -1.825933e-02 3 1  ON 8
ci_010                -1.654973e-02 3 1  ON 9
ci_011                -1.670047e-02 3 1  ON 10
ci_012                -1.634323e-02 3 1  ON 11
ci_013                -1.980859e-02 3 1  ON 12
ci_014                 1.395800e-02 3 1  ON 13
ci_015                 1.422478e-02 3 1  ON 14
ci_016                 1.610426e-02 3 1  ON 15
ci_017                 1.666412e-02 3 1  ON 16
ci_018                 1.365091e-02 3 1  ON 17
ci_019                 1.377995e-02 3 1  ON 18
ci_020                 1.330886e-02 3 1  ON 19
ci_021                 1.382021e-02 3 1  ON 20
ci_022                 1.224965e-02 3 1  ON 21
ci_023                 1.182092e-02 3 1  ON 22
ci_024                 1.106877e-02 3 1  ON 23
ci_025                 1.081231e-02 3 1  ON 24
ci_026                 1.199795e-02 3 1  ON 25
ci_027                 1.181899e-02 3 1  ON 26
ci_028                -1.417429e-02 3 1  ON 27
ci_029                -1.431550e-02 3 1  ON 28
ci_030                -1.136452e-02 3 1  ON 29
ci_031                -1.061903e-02 3 1  ON 30
ci_032                -1.402683e-02 3 1  ON 31
ci_033                 1.029065e-02 3 1  ON 32
ci_034                 1.038450e-02 3 1  ON 33
ci_035                -5.071673e-03 3 1  ON 34
ci_036                -1.087380e-02 3 1  ON 35
ci_037                -1.087143e-02 3 1  ON 36
ci_038                 1.460992e-03 3 1  ON 37
ci_039                 1.325963e-03 3 1  ON 38
ci_040                -4.014174e-03 3 1  ON 39
ci_041                 1.013893e-02 3 1  ON 40
ci_042                 9.466234e-03 3 1  ON 41
ci_043                -3.560248e-03 3 1  ON 42
ci_044                -1.482812e-02 3 1  ON 43
ci_045                -1.922952e-03 3 1  ON 44
ci_046                 5.827701e-03 3 1  ON 45
ci_047                 5.656357e-03 3 1  ON 46
ci_048                -1.157327e-02 3 1  ON 47
ci_049                -1.187103e-02 3 1  ON 48
ci_050                 7.819110e-03 3 1  ON 49
ci_051                 7.596336e-03 3 1  ON 50
ci_052                -7.145956e-03 3 1  ON 51
ci_053                -7.436307e-03 3 1  ON 52
ci_054                -2.094650e-03 3 1  ON 53
ci_055                -2.038608e-03 3 1  ON 54
ci_056                 4.948382e-03 3 1  ON 55
ci_057                 4.826686e-03 3 1  ON 56
ci_058                -7.694417e-03 3 1  ON 57
ci_059                -7.090289e-03 3 1  ON 58
ci_060                 8.386063e-03 3 1  ON 59
ci_061                 8.015920e-03 3 1  ON 60
ci_062                -3.261216e-03 3 1  ON 61
ci_063                -3.216871e-03 3 1  ON 62
ci_064                -3.398993e-03 3 1  ON 63
ci_065                -4.311875e-03 3 1  ON 64
ci_066                 5.973874e-03 3 1  ON 65
ci_067                 6.108412e-03 3 1  ON 66
ci_068                -4.742640e-03 3 1  ON 67
ci_069                -4.908283e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.425193
====================================================
  Execution time = 1.4211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0780e-01
  Total weights = 1.9570e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295040781042
                                         uncertainty =       0.001747038475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295040781042
                                         uncertainty =       0.001747038475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384122963
  error estimate for blocks of size 2^( 2) =       0.000394105128
  error estimate for blocks of size 2^( 3) =       0.000402599801
  error estimate for blocks of size 2^( 4) =       0.000408716978
  error estimate for blocks of size 2^( 5) =       0.000412344259
  error estimate for blocks of size 2^( 6) =       0.000415272443
  error estimate for blocks of size 2^( 7) =       0.000417701332

      target function =                  N/A
              le_mean =     -17.216258005040
             les_mean =     296.712127478171
             stat err =       0.000413508753
             autocorr =       1.158854397924
              std dev =       0.543231904220
             le_variance =       0.295100901763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295109539317
                                         uncertainty =       0.001735389513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295109539317
                                         uncertainty =       0.001735389513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384167587
  error estimate for blocks of size 2^( 2) =       0.000394139346
  error estimate for blocks of size 2^( 3) =       0.000402620061
  error estimate for blocks of size 2^( 4) =       0.000408725359
  error estimate for blocks of size 2^( 5) =       0.000412309470
  error estimate for blocks of size 2^( 6) =       0.000415177021
  error estimate for blocks of size 2^( 7) =       0.000417552982

      target function =                  N/A
              le_mean =     -17.216264808352
             les_mean =     296.716551304732
             stat err =       0.000413441208
             autocorr =       1.158206722518
              std dev =       0.543295012320
             le_variance =       0.295169470411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296042186757
                                         uncertainty =       0.001932514287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296042186757
                                         uncertainty =       0.001932514287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384772793
  error estimate for blocks of size 2^( 2) =       0.000394731501
  error estimate for blocks of size 2^( 3) =       0.000403208555
  error estimate for blocks of size 2^( 4) =       0.000409319159
  error estimate for blocks of size 2^( 5) =       0.000412851400
  error estimate for blocks of size 2^( 6) =       0.000415655155
  error estimate for blocks of size 2^( 7) =       0.000418068880

      target function =                  N/A
              le_mean =     -17.216285044520
             les_mean =     296.759105747270
             stat err =       0.000413973649
             autocorr =       1.157541799924
              std dev =       0.544150902221
             le_variance =       0.296100204388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294969330395
                                         uncertainty =       0.001743425749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294969330395
                                         uncertainty =       0.001743425749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384076553
  error estimate for blocks of size 2^( 2) =       0.000394055804
  error estimate for blocks of size 2^( 3) =       0.000402549845
  error estimate for blocks of size 2^( 4) =       0.000408664415
  error estimate for blocks of size 2^( 5) =       0.000412290279
  error estimate for blocks of size 2^( 6) =       0.000415203995
  error estimate for blocks of size 2^( 7) =       0.000417616229

      target function =                  N/A
              le_mean =     -17.216248347537
             les_mean =     296.709894904411
             stat err =       0.000413443730
             autocorr =       1.158769961075
              std dev =       0.543166270679
             le_variance =       0.295029597603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216258005040        initial
     6.2500e-02     6.2500e-01             1.3040e-03       -17.216264808352
     2.5000e-01     2.5000e+00             7.1971e-04       -17.216285044520  <--
     1.0000e+00     1.0000e+01             2.5890e-04       -17.216248347537

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3646e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.094223e-02 3 1  ON 0
ci_002                -3.067755e-02 3 1  ON 1
ci_003                -2.556688e-02 3 1  ON 2
ci_004                 2.209572e-02 3 1  ON 3
ci_005                 2.160518e-02 3 1  ON 4
ci_006                -1.960637e-02 3 1  ON 5
ci_007                -2.056891e-02 3 1  ON 6
ci_008                -1.833122e-02 3 1  ON 7
ci_009                -1.825933e-02 3 1  ON 8
ci_010                -1.654973e-02 3 1  ON 9
ci_011                -1.670047e-02 3 1  ON 10
ci_012                -1.634323e-02 3 1  ON 11
ci_013                -1.980859e-02 3 1  ON 12
ci_014                 1.395800e-02 3 1  ON 13
ci_015                 1.422478e-02 3 1  ON 14
ci_016                 1.610426e-02 3 1  ON 15
ci_017                 1.666412e-02 3 1  ON 16
ci_018                 1.365091e-02 3 1  ON 17
ci_019                 1.377995e-02 3 1  ON 18
ci_020                 1.330886e-02 3 1  ON 19
ci_021                 1.382021e-02 3 1  ON 20
ci_022                 1.224965e-02 3 1  ON 21
ci_023                 1.182092e-02 3 1  ON 22
ci_024                 1.106877e-02 3 1  ON 23
ci_025                 1.081231e-02 3 1  ON 24
ci_026                 1.199795e-02 3 1  ON 25
ci_027                 1.181899e-02 3 1  ON 26
ci_028                -1.417429e-02 3 1  ON 27
ci_029                -1.431550e-02 3 1  ON 28
ci_030                -1.136452e-02 3 1  ON 29
ci_031                -1.061903e-02 3 1  ON 30
ci_032                -1.402683e-02 3 1  ON 31
ci_033                 1.029065e-02 3 1  ON 32
ci_034                 1.038450e-02 3 1  ON 33
ci_035                -5.071673e-03 3 1  ON 34
ci_036                -1.087380e-02 3 1  ON 35
ci_037                -1.087143e-02 3 1  ON 36
ci_038                 1.460992e-03 3 1  ON 37
ci_039                 1.325963e-03 3 1  ON 38
ci_040                -4.014174e-03 3 1  ON 39
ci_041                 1.013893e-02 3 1  ON 40
ci_042                 9.466234e-03 3 1  ON 41
ci_043                -3.560248e-03 3 1  ON 42
ci_044                -1.482812e-02 3 1  ON 43
ci_045                -1.922952e-03 3 1  ON 44
ci_046                 5.827701e-03 3 1  ON 45
ci_047                 5.656357e-03 3 1  ON 46
ci_048                -1.157327e-02 3 1  ON 47
ci_049                -1.187103e-02 3 1  ON 48
ci_050                 7.819110e-03 3 1  ON 49
ci_051                 7.596336e-03 3 1  ON 50
ci_052                -7.145956e-03 3 1  ON 51
ci_053                -7.436307e-03 3 1  ON 52
ci_054                -2.094650e-03 3 1  ON 53
ci_055                -2.038608e-03 3 1  ON 54
ci_056                 4.948382e-03 3 1  ON 55
ci_057                 4.826686e-03 3 1  ON 56
ci_058                -7.694417e-03 3 1  ON 57
ci_059                -7.090289e-03 3 1  ON 58
ci_060                 8.386063e-03 3 1  ON 59
ci_061                 8.015920e-03 3 1  ON 60
ci_062                -3.261216e-03 3 1  ON 61
ci_063                -3.216871e-03 3 1  ON 62
ci_064                -3.398993e-03 3 1  ON 63
ci_065                -4.311875e-03 3 1  ON 64
ci_066                 5.973874e-03 3 1  ON 65
ci_067                 6.108412e-03 3 1  ON 66
ci_068                -4.742640e-03 3 1  ON 67
ci_069                -4.908283e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.303379
====================================================
  Execution time = 1.4497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1453e-01
  Total weights = 1.956746272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297972627360
                                         uncertainty =       0.002032437853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297972627360
                                         uncertainty =       0.002032437853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386072859
  error estimate for blocks of size 2^( 2) =       0.000395765513
  error estimate for blocks of size 2^( 3) =       0.000404408964
  error estimate for blocks of size 2^( 4) =       0.000410497327
  error estimate for blocks of size 2^( 5) =       0.000414037400
  error estimate for blocks of size 2^( 6) =       0.000416120070
  error estimate for blocks of size 2^( 7) =       0.000415643968

      target function =                  N/A
              le_mean =     -17.215869321751
             les_mean =     296.700690156763
             stat err =       0.000414074691
             autocorr =       1.150320423756
              std dev =       0.545989472845
             le_variance =       0.298104504458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586932175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869321770       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215871051040       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872613128       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872342266       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215872385089       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.306160e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869321770       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215870373564       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215871200803       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215871169754       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.186429e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869321770       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215869731494       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215870016240       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.569899e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7138e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.059382e-02 3 1  ON 0
ci_002                -3.066580e-02 3 1  ON 1
ci_003                -2.526442e-02 3 1  ON 2
ci_004                 2.222595e-02 3 1  ON 3
ci_005                 2.139821e-02 3 1  ON 4
ci_006                -1.982842e-02 3 1  ON 5
ci_007                -2.008300e-02 3 1  ON 6
ci_008                -1.837561e-02 3 1  ON 7
ci_009                -1.802495e-02 3 1  ON 8
ci_010                -1.726837e-02 3 1  ON 9
ci_011                -1.651235e-02 3 1  ON 10
ci_012                -1.671777e-02 3 1  ON 11
ci_013                -1.983818e-02 3 1  ON 12
ci_014                 1.457310e-02 3 1  ON 13
ci_015                 1.463783e-02 3 1  ON 14
ci_016                 1.651747e-02 3 1  ON 15
ci_017                 1.682141e-02 3 1  ON 16
ci_018                 1.368657e-02 3 1  ON 17
ci_019                 1.348842e-02 3 1  ON 18
ci_020                 1.311671e-02 3 1  ON 19
ci_021                 1.392933e-02 3 1  ON 20
ci_022                 1.218457e-02 3 1  ON 21
ci_023                 1.230186e-02 3 1  ON 22
ci_024                 1.114345e-02 3 1  ON 23
ci_025                 1.124863e-02 3 1  ON 24
ci_026                 1.180187e-02 3 1  ON 25
ci_027                 1.199575e-02 3 1  ON 26
ci_028                -1.390668e-02 3 1  ON 27
ci_029                -1.410987e-02 3 1  ON 28
ci_030                -1.137541e-02 3 1  ON 29
ci_031                -1.070592e-02 3 1  ON 30
ci_032                -1.356320e-02 3 1  ON 31
ci_033                 1.011107e-02 3 1  ON 32
ci_034                 1.041697e-02 3 1  ON 33
ci_035                -5.071538e-03 3 1  ON 34
ci_036                -1.114793e-02 3 1  ON 35
ci_037                -1.103827e-02 3 1  ON 36
ci_038                 1.459600e-03 3 1  ON 37
ci_039                 1.287056e-03 3 1  ON 38
ci_040                -4.279178e-03 3 1  ON 39
ci_041                 1.016031e-02 3 1  ON 40
ci_042                 9.716609e-03 3 1  ON 41
ci_043                -3.547757e-03 3 1  ON 42
ci_044                -1.548016e-02 3 1  ON 43
ci_045                -1.794443e-03 3 1  ON 44
ci_046                 5.513806e-03 3 1  ON 45
ci_047                 5.638376e-03 3 1  ON 46
ci_048                -1.154615e-02 3 1  ON 47
ci_049                -1.169807e-02 3 1  ON 48
ci_050                 7.624546e-03 3 1  ON 49
ci_051                 7.477841e-03 3 1  ON 50
ci_052                -7.287656e-03 3 1  ON 51
ci_053                -7.372113e-03 3 1  ON 52
ci_054                -2.257288e-03 3 1  ON 53
ci_055                -2.220126e-03 3 1  ON 54
ci_056                 5.153730e-03 3 1  ON 55
ci_057                 5.021292e-03 3 1  ON 56
ci_058                -7.700732e-03 3 1  ON 57
ci_059                -7.061126e-03 3 1  ON 58
ci_060                 8.858452e-03 3 1  ON 59
ci_061                 8.407378e-03 3 1  ON 60
ci_062                -3.194121e-03 3 1  ON 61
ci_063                -3.296339e-03 3 1  ON 62
ci_064                -3.272808e-03 3 1  ON 63
ci_065                -4.411057e-03 3 1  ON 64
ci_066                 6.014365e-03 3 1  ON 65
ci_067                 5.851663e-03 3 1  ON 66
ci_068                -4.663754e-03 3 1  ON 67
ci_069                -5.036593e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2559
    reference variance = 0.260451
====================================================
  Execution time = 1.4355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1362e-01
  Total weights = 1.9568e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298828377640
                                         uncertainty =       0.001736586205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298828377640
                                         uncertainty =       0.001736586205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386584098
  error estimate for blocks of size 2^( 2) =       0.000396802559
  error estimate for blocks of size 2^( 3) =       0.000405693193
  error estimate for blocks of size 2^( 4) =       0.000412151521
  error estimate for blocks of size 2^( 5) =       0.000415651213
  error estimate for blocks of size 2^( 6) =       0.000416004519
  error estimate for blocks of size 2^( 7) =       0.000415753085

      target function =                  N/A
              le_mean =     -17.216741451189
             les_mean =     296.730259881722
             stat err =       0.000414890084
             autocorr =       1.151802829141
              std dev =       0.546712473980
             le_variance =       0.298894529206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299271017247
                                         uncertainty =       0.001737370434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299271017247
                                         uncertainty =       0.001737370434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386867905
  error estimate for blocks of size 2^( 2) =       0.000397056796
  error estimate for blocks of size 2^( 3) =       0.000405913669
  error estimate for blocks of size 2^( 4) =       0.000412340718
  error estimate for blocks of size 2^( 5) =       0.000415847508
  error estimate for blocks of size 2^( 6) =       0.000416193367
  error estimate for blocks of size 2^( 7) =       0.000415951723

      target function =                  N/A
              le_mean =     -17.216728288224
             les_mean =     296.741064498129
             stat err =       0.000415083329
             autocorr =       1.151185151700
              std dev =       0.547113838083
             le_variance =       0.299333551822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299557110041
                                         uncertainty =       0.001764588070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299557110041
                                         uncertainty =       0.001764588070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387051916
  error estimate for blocks of size 2^( 2) =       0.000397235179
  error estimate for blocks of size 2^( 3) =       0.000406083670
  error estimate for blocks of size 2^( 4) =       0.000412499570
  error estimate for blocks of size 2^( 5) =       0.000416009069
  error estimate for blocks of size 2^( 6) =       0.000416354725
  error estimate for blocks of size 2^( 7) =       0.000416077197

      target function =                  N/A
              le_mean =     -17.216739805630
             les_mean =     296.838698433631
             stat err =       0.000415235140
             autocorr =       1.150932241258
              std dev =       0.547374068960
             le_variance =       0.299618371370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877565433
                                         uncertainty =       0.001736351579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298877565433
                                         uncertainty =       0.001736351579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386615276
  error estimate for blocks of size 2^( 2) =       0.000396826551
  error estimate for blocks of size 2^( 3) =       0.000405709833
  error estimate for blocks of size 2^( 4) =       0.000412157778
  error estimate for blocks of size 2^( 5) =       0.000415659426
  error estimate for blocks of size 2^( 6) =       0.000416012299
  error estimate for blocks of size 2^( 7) =       0.000415759280

      target function =                  N/A
              le_mean =     -17.216735012969
             les_mean =     296.731981408211
             stat err =       0.000414897196
             autocorr =       1.151656539895
              std dev =       0.546756567359
             le_variance =       0.298942743951


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216741451189        initial  <--
     6.2500e-02     6.2500e-01             1.3062e-03       -17.216728288224
     2.5000e-01     2.5000e+00             7.1864e-04       -17.216739805630
     1.0000e+00     1.0000e+01             2.5699e-04       -17.216735012969

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8474
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.094223e-02 3 1  ON 0
ci_002                -3.067755e-02 3 1  ON 1
ci_003                -2.556688e-02 3 1  ON 2
ci_004                 2.209572e-02 3 1  ON 3
ci_005                 2.160518e-02 3 1  ON 4
ci_006                -1.960637e-02 3 1  ON 5
ci_007                -2.056891e-02 3 1  ON 6
ci_008                -1.833122e-02 3 1  ON 7
ci_009                -1.825933e-02 3 1  ON 8
ci_010                -1.654973e-02 3 1  ON 9
ci_011                -1.670047e-02 3 1  ON 10
ci_012                -1.634323e-02 3 1  ON 11
ci_013                -1.980859e-02 3 1  ON 12
ci_014                 1.395800e-02 3 1  ON 13
ci_015                 1.422478e-02 3 1  ON 14
ci_016                 1.610426e-02 3 1  ON 15
ci_017                 1.666412e-02 3 1  ON 16
ci_018                 1.365091e-02 3 1  ON 17
ci_019                 1.377995e-02 3 1  ON 18
ci_020                 1.330886e-02 3 1  ON 19
ci_021                 1.382021e-02 3 1  ON 20
ci_022                 1.224965e-02 3 1  ON 21
ci_023                 1.182092e-02 3 1  ON 22
ci_024                 1.106877e-02 3 1  ON 23
ci_025                 1.081231e-02 3 1  ON 24
ci_026                 1.199795e-02 3 1  ON 25
ci_027                 1.181899e-02 3 1  ON 26
ci_028                -1.417429e-02 3 1  ON 27
ci_029                -1.431550e-02 3 1  ON 28
ci_030                -1.136452e-02 3 1  ON 29
ci_031                -1.061903e-02 3 1  ON 30
ci_032                -1.402683e-02 3 1  ON 31
ci_033                 1.029065e-02 3 1  ON 32
ci_034                 1.038450e-02 3 1  ON 33
ci_035                -5.071673e-03 3 1  ON 34
ci_036                -1.087380e-02 3 1  ON 35
ci_037                -1.087143e-02 3 1  ON 36
ci_038                 1.460992e-03 3 1  ON 37
ci_039                 1.325963e-03 3 1  ON 38
ci_040                -4.014174e-03 3 1  ON 39
ci_041                 1.013893e-02 3 1  ON 40
ci_042                 9.466234e-03 3 1  ON 41
ci_043                -3.560248e-03 3 1  ON 42
ci_044                -1.482812e-02 3 1  ON 43
ci_045                -1.922952e-03 3 1  ON 44
ci_046                 5.827701e-03 3 1  ON 45
ci_047                 5.656357e-03 3 1  ON 46
ci_048                -1.157327e-02 3 1  ON 47
ci_049                -1.187103e-02 3 1  ON 48
ci_050                 7.819110e-03 3 1  ON 49
ci_051                 7.596336e-03 3 1  ON 50
ci_052                -7.145956e-03 3 1  ON 51
ci_053                -7.436307e-03 3 1  ON 52
ci_054                -2.094650e-03 3 1  ON 53
ci_055                -2.038608e-03 3 1  ON 54
ci_056                 4.948382e-03 3 1  ON 55
ci_057                 4.826686e-03 3 1  ON 56
ci_058                -7.694417e-03 3 1  ON 57
ci_059                -7.090289e-03 3 1  ON 58
ci_060                 8.386063e-03 3 1  ON 59
ci_061                 8.015920e-03 3 1  ON 60
ci_062                -3.261216e-03 3 1  ON 61
ci_063                -3.216871e-03 3 1  ON 62
ci_064                -3.398993e-03 3 1  ON 63
ci_065                -4.311875e-03 3 1  ON 64
ci_066                 5.973874e-03 3 1  ON 65
ci_067                 6.108412e-03 3 1  ON 66
ci_068                -4.742640e-03 3 1  ON 67
ci_069                -4.908283e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0992e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.183781
====================================================
  Execution time = 1.4594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2223e-01
  Total weights = 1.956634881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302483732798
                                         uncertainty =       0.003013754653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302483732798
                                         uncertainty =       0.003013754653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389121033
  error estimate for blocks of size 2^( 2) =       0.000399124053
  error estimate for blocks of size 2^( 3) =       0.000407965512
  error estimate for blocks of size 2^( 4) =       0.000414503100
  error estimate for blocks of size 2^( 5) =       0.000417244464
  error estimate for blocks of size 2^( 6) =       0.000418768804
  error estimate for blocks of size 2^( 7) =       0.000420436975

      target function =                  N/A
              le_mean =     -17.216376189860
             les_mean =     296.725834874832
             stat err =       0.000417738336
             autocorr =       1.152495537498
              std dev =       0.550300242172
             le_variance =       0.302830356535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637618986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376189926       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216378682183       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216378272091       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216378307271       residual = 1.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 5.643683e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376189926       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216376973444       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216376846436       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.658671e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216376189926       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216376399285       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216376366735       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 4.339095e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7225e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.090396e-02 3 1  ON 0
ci_002                -3.081621e-02 3 1  ON 1
ci_003                -2.555981e-02 3 1  ON 2
ci_004                 2.204008e-02 3 1  ON 3
ci_005                 2.153225e-02 3 1  ON 4
ci_006                -1.962801e-02 3 1  ON 5
ci_007                -2.050327e-02 3 1  ON 6
ci_008                -1.828763e-02 3 1  ON 7
ci_009                -1.828416e-02 3 1  ON 8
ci_010                -1.659851e-02 3 1  ON 9
ci_011                -1.666692e-02 3 1  ON 10
ci_012                -1.631806e-02 3 1  ON 11
ci_013                -1.964272e-02 3 1  ON 12
ci_014                 1.396976e-02 3 1  ON 13
ci_015                 1.420026e-02 3 1  ON 14
ci_016                 1.618526e-02 3 1  ON 15
ci_017                 1.659155e-02 3 1  ON 16
ci_018                 1.364947e-02 3 1  ON 17
ci_019                 1.372771e-02 3 1  ON 18
ci_020                 1.333743e-02 3 1  ON 19
ci_021                 1.384767e-02 3 1  ON 20
ci_022                 1.227020e-02 3 1  ON 21
ci_023                 1.170756e-02 3 1  ON 22
ci_024                 1.100893e-02 3 1  ON 23
ci_025                 1.089806e-02 3 1  ON 24
ci_026                 1.197490e-02 3 1  ON 25
ci_027                 1.184891e-02 3 1  ON 26
ci_028                -1.429161e-02 3 1  ON 27
ci_029                -1.430983e-02 3 1  ON 28
ci_030                -1.131180e-02 3 1  ON 29
ci_031                -1.067797e-02 3 1  ON 30
ci_032                -1.404177e-02 3 1  ON 31
ci_033                 1.032253e-02 3 1  ON 32
ci_034                 1.039117e-02 3 1  ON 33
ci_035                -5.011293e-03 3 1  ON 34
ci_036                -1.085788e-02 3 1  ON 35
ci_037                -1.092365e-02 3 1  ON 36
ci_038                 1.496211e-03 3 1  ON 37
ci_039                 1.280143e-03 3 1  ON 38
ci_040                -4.088657e-03 3 1  ON 39
ci_041                 1.014728e-02 3 1  ON 40
ci_042                 9.523346e-03 3 1  ON 41
ci_043                -3.524350e-03 3 1  ON 42
ci_044                -1.493870e-02 3 1  ON 43
ci_045                -1.916507e-03 3 1  ON 44
ci_046                 5.797418e-03 3 1  ON 45
ci_047                 5.637866e-03 3 1  ON 46
ci_048                -1.160774e-02 3 1  ON 47
ci_049                -1.186590e-02 3 1  ON 48
ci_050                 7.842608e-03 3 1  ON 49
ci_051                 7.617081e-03 3 1  ON 50
ci_052                -7.054938e-03 3 1  ON 51
ci_053                -7.306221e-03 3 1  ON 52
ci_054                -2.141854e-03 3 1  ON 53
ci_055                -2.060875e-03 3 1  ON 54
ci_056                 4.859530e-03 3 1  ON 55
ci_057                 4.794366e-03 3 1  ON 56
ci_058                -7.627548e-03 3 1  ON 57
ci_059                -7.125622e-03 3 1  ON 58
ci_060                 8.461716e-03 3 1  ON 59
ci_061                 8.120398e-03 3 1  ON 60
ci_062                -3.303472e-03 3 1  ON 61
ci_063                -3.235028e-03 3 1  ON 62
ci_064                -3.355882e-03 3 1  ON 63
ci_065                -4.281037e-03 3 1  ON 64
ci_066                 6.035436e-03 3 1  ON 65
ci_067                 6.098387e-03 3 1  ON 66
ci_068                -4.682082e-03 3 1  ON 67
ci_069                -4.831131e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2268
    reference variance = 0.47819
====================================================
  Execution time = 1.4417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0884e-01
  Total weights = 1.9566e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296213640823
                                         uncertainty =       0.001694459868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296213640823
                                         uncertainty =       0.001694459868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384873529
  error estimate for blocks of size 2^( 2) =       0.000394615692
  error estimate for blocks of size 2^( 3) =       0.000403822377
  error estimate for blocks of size 2^( 4) =       0.000410432388
  error estimate for blocks of size 2^( 5) =       0.000414731712
  error estimate for blocks of size 2^( 6) =       0.000417722973
  error estimate for blocks of size 2^( 7) =       0.000420224945

      target function =                  N/A
              le_mean =     -17.217089296653
             les_mean =     296.737419850436
             stat err =       0.000415778004
             autocorr =       1.167043213349
              std dev =       0.544293363877
             le_variance =       0.296255265960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295992297240
                                         uncertainty =       0.001686126720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295992297240
                                         uncertainty =       0.001686126720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384730071
  error estimate for blocks of size 2^( 2) =       0.000394479883
  error estimate for blocks of size 2^( 3) =       0.000403693678
  error estimate for blocks of size 2^( 4) =       0.000410310154
  error estimate for blocks of size 2^( 5) =       0.000414628572
  error estimate for blocks of size 2^( 6) =       0.000417639426
  error estimate for blocks of size 2^( 7) =       0.000420148636

      target function =                  N/A
              le_mean =     -17.217092589745
             les_mean =     296.737663735559
             stat err =       0.000415681697
             autocorr =       1.167372721047
              std dev =       0.544090483797
             le_variance =       0.296034454559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296054937991
                                         uncertainty =       0.001688955610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296054937991
                                         uncertainty =       0.001688955610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384770657
  error estimate for blocks of size 2^( 2) =       0.000394518215
  error estimate for blocks of size 2^( 3) =       0.000403729854
  error estimate for blocks of size 2^( 4) =       0.000410344818
  error estimate for blocks of size 2^( 5) =       0.000414657108
  error estimate for blocks of size 2^( 6) =       0.000417660151
  error estimate for blocks of size 2^( 7) =       0.000420169206

      target function =                  N/A
              le_mean =     -17.217090323128
             les_mean =     296.736842472166
             stat err =       0.000415707821
             autocorr =       1.167273161134
              std dev =       0.544147881433
             le_variance =       0.296096916868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296189881106
                                         uncertainty =       0.001693684559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296189881106
                                         uncertainty =       0.001693684559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384858127
  error estimate for blocks of size 2^( 2) =       0.000394600984
  error estimate for blocks of size 2^( 3) =       0.000403808440
  error estimate for blocks of size 2^( 4) =       0.000410419167
  error estimate for blocks of size 2^( 5) =       0.000414720341
  error estimate for blocks of size 2^( 6) =       0.000417713260
  error estimate for blocks of size 2^( 7) =       0.000420216406

      target function =                  N/A
              le_mean =     -17.217089193321
             les_mean =     296.737313997210
             stat err =       0.000415767293
             autocorr =       1.167076490446
              std dev =       0.544271582733
             le_variance =       0.296231555771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217089296653        initial
     6.2500e-01     6.2500e+00             5.6437e-04       -17.217092589745  <--
     2.5000e+00     2.5000e+01             1.6587e-04       -17.217090323128
     1.0000e+01     1.0000e+02             4.3391e-05       -17.217089193321

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.3906e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.081758e-02 3 1  ON 0
ci_002                -3.112591e-02 3 1  ON 1
ci_003                -2.554424e-02 3 1  ON 2
ci_004                 2.190478e-02 3 1  ON 3
ci_005                 2.135067e-02 3 1  ON 4
ci_006                -1.967449e-02 3 1  ON 5
ci_007                -2.035565e-02 3 1  ON 6
ci_008                -1.819854e-02 3 1  ON 7
ci_009                -1.833657e-02 3 1  ON 8
ci_010                -1.671147e-02 3 1  ON 9
ci_011                -1.659243e-02 3 1  ON 10
ci_012                -1.626942e-02 3 1  ON 11
ci_013                -1.924422e-02 3 1  ON 12
ci_014                 1.399749e-02 3 1  ON 13
ci_015                 1.414987e-02 3 1  ON 14
ci_016                 1.637199e-02 3 1  ON 15
ci_017                 1.642748e-02 3 1  ON 16
ci_018                 1.364306e-02 3 1  ON 17
ci_019                 1.361507e-02 3 1  ON 18
ci_020                 1.339444e-02 3 1  ON 19
ci_021                 1.391265e-02 3 1  ON 20
ci_022                 1.231205e-02 3 1  ON 21
ci_023                 1.146679e-02 3 1  ON 22
ci_024                 1.087061e-02 3 1  ON 23
ci_025                 1.110442e-02 3 1  ON 24
ci_026                 1.192576e-02 3 1  ON 25
ci_027                 1.191328e-02 3 1  ON 26
ci_028                -1.456049e-02 3 1  ON 27
ci_029                -1.429970e-02 3 1  ON 28
ci_030                -1.119939e-02 3 1  ON 29
ci_031                -1.080622e-02 3 1  ON 30
ci_032                -1.407780e-02 3 1  ON 31
ci_033                 1.039693e-02 3 1  ON 32
ci_034                 1.040660e-02 3 1  ON 33
ci_035                -4.900441e-03 3 1  ON 34
ci_036                -1.082070e-02 3 1  ON 35
ci_037                -1.103651e-02 3 1  ON 36
ci_038                 1.559624e-03 3 1  ON 37
ci_039                 1.196962e-03 3 1  ON 38
ci_040                -4.220354e-03 3 1  ON 39
ci_041                 1.016814e-02 3 1  ON 40
ci_042                 9.646770e-03 3 1  ON 41
ci_043                -3.458532e-03 3 1  ON 42
ci_044                -1.520001e-02 3 1  ON 43
ci_045                -1.906753e-03 3 1  ON 44
ci_046                 5.731887e-03 3 1  ON 45
ci_047                 5.598394e-03 3 1  ON 46
ci_048                -1.169369e-02 3 1  ON 47
ci_049                -1.185794e-02 3 1  ON 48
ci_050                 7.888500e-03 3 1  ON 49
ci_051                 7.660295e-03 3 1  ON 50
ci_052                -6.872814e-03 3 1  ON 51
ci_053                -7.044730e-03 3 1  ON 52
ci_054                -2.237242e-03 3 1  ON 53
ci_055                -2.106530e-03 3 1  ON 54
ci_056                 4.685831e-03 3 1  ON 55
ci_057                 4.732006e-03 3 1  ON 56
ci_058                -7.491278e-03 3 1  ON 57
ci_059                -7.199593e-03 3 1  ON 58
ci_060                 8.631549e-03 3 1  ON 59
ci_061                 8.347850e-03 3 1  ON 60
ci_062                -3.388988e-03 3 1  ON 61
ci_063                -3.271896e-03 3 1  ON 62
ci_064                -3.285810e-03 3 1  ON 63
ci_065                -4.229845e-03 3 1  ON 64
ci_066                 6.151997e-03 3 1  ON 65
ci_067                 6.079158e-03 3 1  ON 66
ci_068                -4.553936e-03 3 1  ON 67
ci_069                -4.670342e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.296
    reference variance = 0.287367
====================================================
  Execution time = 1.4607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0911e-01
  Total weights = 1.956876229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297521921940
                                         uncertainty =       0.002109028941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297521921940
                                         uncertainty =       0.002109028941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385648783
  error estimate for blocks of size 2^( 2) =       0.000395688157
  error estimate for blocks of size 2^( 3) =       0.000404581386
  error estimate for blocks of size 2^( 4) =       0.000411026615
  error estimate for blocks of size 2^( 5) =       0.000416056101
  error estimate for blocks of size 2^( 6) =       0.000417783413
  error estimate for blocks of size 2^( 7) =       0.000418256406

      target function =                  N/A
              le_mean =     -17.216878799344
             les_mean =     296.730021031723
             stat err =       0.000415780634
             autocorr =       1.162370512979
              std dev =       0.545389738939
             le_variance =       0.297449967340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687879934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878799397       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216889232680       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216891321046       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216891213778       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 7.098120e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878799397       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216883805956       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216884233133       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216884176496       residual = 1.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.705714e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878799397       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216880424616       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216880445929       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.264504e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7245e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.082922e-02 3 1  ON 0
ci_002                -3.081902e-02 3 1  ON 1
ci_003                -2.555096e-02 3 1  ON 2
ci_004                 2.177426e-02 3 1  ON 3
ci_005                 2.138470e-02 3 1  ON 4
ci_006                -1.967685e-02 3 1  ON 5
ci_007                -2.018686e-02 3 1  ON 6
ci_008                -1.825178e-02 3 1  ON 7
ci_009                -1.813172e-02 3 1  ON 8
ci_010                -1.675521e-02 3 1  ON 9
ci_011                -1.664466e-02 3 1  ON 10
ci_012                -1.633724e-02 3 1  ON 11
ci_013                -1.947161e-02 3 1  ON 12
ci_014                 1.394321e-02 3 1  ON 13
ci_015                 1.434508e-02 3 1  ON 14
ci_016                 1.635420e-02 3 1  ON 15
ci_017                 1.633717e-02 3 1  ON 16
ci_018                 1.370213e-02 3 1  ON 17
ci_019                 1.380419e-02 3 1  ON 18
ci_020                 1.366507e-02 3 1  ON 19
ci_021                 1.405573e-02 3 1  ON 20
ci_022                 1.232401e-02 3 1  ON 21
ci_023                 1.158931e-02 3 1  ON 22
ci_024                 1.083276e-02 3 1  ON 23
ci_025                 1.118278e-02 3 1  ON 24
ci_026                 1.193671e-02 3 1  ON 25
ci_027                 1.219456e-02 3 1  ON 26
ci_028                -1.442424e-02 3 1  ON 27
ci_029                -1.444338e-02 3 1  ON 28
ci_030                -1.106770e-02 3 1  ON 29
ci_031                -1.093936e-02 3 1  ON 30
ci_032                -1.386512e-02 3 1  ON 31
ci_033                 1.040318e-02 3 1  ON 32
ci_034                 1.020811e-02 3 1  ON 33
ci_035                -4.930087e-03 3 1  ON 34
ci_036                -1.098512e-02 3 1  ON 35
ci_037                -1.089216e-02 3 1  ON 36
ci_038                 1.581819e-03 3 1  ON 37
ci_039                 1.327585e-03 3 1  ON 38
ci_040                -4.229607e-03 3 1  ON 39
ci_041                 1.012949e-02 3 1  ON 40
ci_042                 9.598708e-03 3 1  ON 41
ci_043                -3.352578e-03 3 1  ON 42
ci_044                -1.513083e-02 3 1  ON 43
ci_045                -1.902731e-03 3 1  ON 44
ci_046                 5.608518e-03 3 1  ON 45
ci_047                 5.576755e-03 3 1  ON 46
ci_048                -1.173227e-02 3 1  ON 47
ci_049                -1.186848e-02 3 1  ON 48
ci_050                 7.517929e-03 3 1  ON 49
ci_051                 7.630671e-03 3 1  ON 50
ci_052                -6.972842e-03 3 1  ON 51
ci_053                -7.071656e-03 3 1  ON 52
ci_054                -2.283219e-03 3 1  ON 53
ci_055                -2.319728e-03 3 1  ON 54
ci_056                 4.776044e-03 3 1  ON 55
ci_057                 4.898727e-03 3 1  ON 56
ci_058                -7.415129e-03 3 1  ON 57
ci_059                -7.371587e-03 3 1  ON 58
ci_060                 8.677604e-03 3 1  ON 59
ci_061                 8.111467e-03 3 1  ON 60
ci_062                -3.194551e-03 3 1  ON 61
ci_063                -3.129824e-03 3 1  ON 62
ci_064                -3.265825e-03 3 1  ON 63
ci_065                -4.516201e-03 3 1  ON 64
ci_066                 6.144891e-03 3 1  ON 65
ci_067                 5.779809e-03 3 1  ON 66
ci_068                -4.736296e-03 3 1  ON 67
ci_069                -4.759042e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.3075
    reference variance = 0.299639
====================================================
  Execution time = 1.4319e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1185e-01
  Total weights = 1.9566e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296257621684
                                         uncertainty =       0.002034104611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296257621684
                                         uncertainty =       0.002034104611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384846563
  error estimate for blocks of size 2^( 2) =       0.000394910535
  error estimate for blocks of size 2^( 3) =       0.000404285503
  error estimate for blocks of size 2^( 4) =       0.000410898495
  error estimate for blocks of size 2^( 5) =       0.000415169265
  error estimate for blocks of size 2^( 6) =       0.000418417491
  error estimate for blocks of size 2^( 7) =       0.000418754278

      target function =                  N/A
              le_mean =     -17.216990929660
             les_mean =     296.739726479343
             stat err =       0.000415809882
             autocorr =       1.167385753184
              std dev =       0.544255228368
             le_variance =       0.296213753606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296212073882
                                         uncertainty =       0.002017560005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296212073882
                                         uncertainty =       0.002017560005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384816850
  error estimate for blocks of size 2^( 2) =       0.000394892659
  error estimate for blocks of size 2^( 3) =       0.000404275021
  error estimate for blocks of size 2^( 4) =       0.000410890714
  error estimate for blocks of size 2^( 5) =       0.000415172805
  error estimate for blocks of size 2^( 6) =       0.000418448325
  error estimate for blocks of size 2^( 7) =       0.000418743303

      target function =                  N/A
              le_mean =     -17.216988421717
             les_mean =     296.741033499787
             stat err =       0.000415813787
             autocorr =       1.167587960398
              std dev =       0.544213208689
             le_variance =       0.296168016511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296197333567
                                         uncertainty =       0.002017772255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296197333567
                                         uncertainty =       0.002017772255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384807270
  error estimate for blocks of size 2^( 2) =       0.000394883572
  error estimate for blocks of size 2^( 3) =       0.000404265845
  error estimate for blocks of size 2^( 4) =       0.000410878814
  error estimate for blocks of size 2^( 5) =       0.000415158847
  error estimate for blocks of size 2^( 6) =       0.000418432528
  error estimate for blocks of size 2^( 7) =       0.000418722854

      target function =                  N/A
              le_mean =     -17.216988509286
             les_mean =     296.736416784163
             stat err =       0.000415798261
             autocorr =       1.167558902699
              std dev =       0.544199660189
             le_variance =       0.296153270150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296228367056
                                         uncertainty =       0.002031201883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296228367056
                                         uncertainty =       0.002031201883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384827543
  error estimate for blocks of size 2^( 2) =       0.000394894382
  error estimate for blocks of size 2^( 3) =       0.000404272258
  error estimate for blocks of size 2^( 4) =       0.000410887009
  error estimate for blocks of size 2^( 5) =       0.000415158613
  error estimate for blocks of size 2^( 6) =       0.000418412880
  error estimate for blocks of size 2^( 7) =       0.000418742456

      target function =                  N/A
              le_mean =     -17.216989567844
             les_mean =     296.740475618563
             stat err =       0.000415800239
             autocorr =       1.167447002062
              std dev =       0.544228330507
             le_variance =       0.296184475727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216990929660        initial  <--
     1.5625e-01     1.5625e+00             7.0981e-04       -17.216988421717
     6.2500e-01     6.2500e+00             3.7057e-04       -17.216988509286
     2.5000e+00     2.5000e+01             1.2645e-04       -17.216989567844

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7086
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.081758e-02 3 1  ON 0
ci_002                -3.112591e-02 3 1  ON 1
ci_003                -2.554424e-02 3 1  ON 2
ci_004                 2.190478e-02 3 1  ON 3
ci_005                 2.135067e-02 3 1  ON 4
ci_006                -1.967449e-02 3 1  ON 5
ci_007                -2.035565e-02 3 1  ON 6
ci_008                -1.819854e-02 3 1  ON 7
ci_009                -1.833657e-02 3 1  ON 8
ci_010                -1.671147e-02 3 1  ON 9
ci_011                -1.659243e-02 3 1  ON 10
ci_012                -1.626942e-02 3 1  ON 11
ci_013                -1.924422e-02 3 1  ON 12
ci_014                 1.399749e-02 3 1  ON 13
ci_015                 1.414987e-02 3 1  ON 14
ci_016                 1.637199e-02 3 1  ON 15
ci_017                 1.642748e-02 3 1  ON 16
ci_018                 1.364306e-02 3 1  ON 17
ci_019                 1.361507e-02 3 1  ON 18
ci_020                 1.339444e-02 3 1  ON 19
ci_021                 1.391265e-02 3 1  ON 20
ci_022                 1.231205e-02 3 1  ON 21
ci_023                 1.146679e-02 3 1  ON 22
ci_024                 1.087061e-02 3 1  ON 23
ci_025                 1.110442e-02 3 1  ON 24
ci_026                 1.192576e-02 3 1  ON 25
ci_027                 1.191328e-02 3 1  ON 26
ci_028                -1.456049e-02 3 1  ON 27
ci_029                -1.429970e-02 3 1  ON 28
ci_030                -1.119939e-02 3 1  ON 29
ci_031                -1.080622e-02 3 1  ON 30
ci_032                -1.407780e-02 3 1  ON 31
ci_033                 1.039693e-02 3 1  ON 32
ci_034                 1.040660e-02 3 1  ON 33
ci_035                -4.900441e-03 3 1  ON 34
ci_036                -1.082070e-02 3 1  ON 35
ci_037                -1.103651e-02 3 1  ON 36
ci_038                 1.559624e-03 3 1  ON 37
ci_039                 1.196962e-03 3 1  ON 38
ci_040                -4.220354e-03 3 1  ON 39
ci_041                 1.016814e-02 3 1  ON 40
ci_042                 9.646770e-03 3 1  ON 41
ci_043                -3.458532e-03 3 1  ON 42
ci_044                -1.520001e-02 3 1  ON 43
ci_045                -1.906753e-03 3 1  ON 44
ci_046                 5.731887e-03 3 1  ON 45
ci_047                 5.598394e-03 3 1  ON 46
ci_048                -1.169369e-02 3 1  ON 47
ci_049                -1.185794e-02 3 1  ON 48
ci_050                 7.888500e-03 3 1  ON 49
ci_051                 7.660295e-03 3 1  ON 50
ci_052                -6.872814e-03 3 1  ON 51
ci_053                -7.044730e-03 3 1  ON 52
ci_054                -2.237242e-03 3 1  ON 53
ci_055                -2.106530e-03 3 1  ON 54
ci_056                 4.685831e-03 3 1  ON 55
ci_057                 4.732006e-03 3 1  ON 56
ci_058                -7.491278e-03 3 1  ON 57
ci_059                -7.199593e-03 3 1  ON 58
ci_060                 8.631549e-03 3 1  ON 59
ci_061                 8.347850e-03 3 1  ON 60
ci_062                -3.388988e-03 3 1  ON 61
ci_063                -3.271896e-03 3 1  ON 62
ci_064                -3.285810e-03 3 1  ON 63
ci_065                -4.229845e-03 3 1  ON 64
ci_066                 6.151997e-03 3 1  ON 65
ci_067                 6.079158e-03 3 1  ON 66
ci_068                -4.553936e-03 3 1  ON 67
ci_069                -4.670342e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1703
    reference variance = 0.191216
====================================================
  Execution time = 1.6358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1339e-01
  Total weights = 1.956376003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298632819781
                                         uncertainty =       0.001854768852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298632819781
                                         uncertainty =       0.001854768852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386391239
  error estimate for blocks of size 2^( 2) =       0.000396713473
  error estimate for blocks of size 2^( 3) =       0.000405929452
  error estimate for blocks of size 2^( 4) =       0.000413312659
  error estimate for blocks of size 2^( 5) =       0.000418241648
  error estimate for blocks of size 2^( 6) =       0.000421312161
  error estimate for blocks of size 2^( 7) =       0.000421913823

      target function =                  N/A
              le_mean =     -17.217170428160
             les_mean =     296.744351802997
             stat err =       0.000418695073
             autocorr =       1.174197521881
              std dev =       0.546439730334
             le_variance =       0.298596378888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717042816e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170428250       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217171858810       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217171790869       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.680437e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170428250       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170826798       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217170805312       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 4.573536e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170428250       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170530820       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217170525139       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.169669e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9011e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.085235e-02 3 1  ON 0
ci_002                -3.113343e-02 3 1  ON 1
ci_003                -2.554794e-02 3 1  ON 2
ci_004                 2.190364e-02 3 1  ON 3
ci_005                 2.134112e-02 3 1  ON 4
ci_006                -1.966393e-02 3 1  ON 5
ci_007                -2.030991e-02 3 1  ON 6
ci_008                -1.819864e-02 3 1  ON 7
ci_009                -1.834400e-02 3 1  ON 8
ci_010                -1.672330e-02 3 1  ON 9
ci_011                -1.659537e-02 3 1  ON 10
ci_012                -1.626567e-02 3 1  ON 11
ci_013                -1.921617e-02 3 1  ON 12
ci_014                 1.400883e-02 3 1  ON 13
ci_015                 1.416536e-02 3 1  ON 14
ci_016                 1.639188e-02 3 1  ON 15
ci_017                 1.642972e-02 3 1  ON 16
ci_018                 1.364213e-02 3 1  ON 17
ci_019                 1.358281e-02 3 1  ON 18
ci_020                 1.337558e-02 3 1  ON 19
ci_021                 1.392069e-02 3 1  ON 20
ci_022                 1.231100e-02 3 1  ON 21
ci_023                 1.144632e-02 3 1  ON 22
ci_024                 1.088573e-02 3 1  ON 23
ci_025                 1.111919e-02 3 1  ON 24
ci_026                 1.193191e-02 3 1  ON 25
ci_027                 1.191768e-02 3 1  ON 26
ci_028                -1.453580e-02 3 1  ON 27
ci_029                -1.430426e-02 3 1  ON 28
ci_030                -1.119544e-02 3 1  ON 29
ci_031                -1.083667e-02 3 1  ON 30
ci_032                -1.406826e-02 3 1  ON 31
ci_033                 1.037618e-02 3 1  ON 32
ci_034                 1.040724e-02 3 1  ON 33
ci_035                -4.890214e-03 3 1  ON 34
ci_036                -1.081962e-02 3 1  ON 35
ci_037                -1.102178e-02 3 1  ON 36
ci_038                 1.536610e-03 3 1  ON 37
ci_039                 1.197856e-03 3 1  ON 38
ci_040                -4.220619e-03 3 1  ON 39
ci_041                 1.015342e-02 3 1  ON 40
ci_042                 9.628505e-03 3 1  ON 41
ci_043                -3.443240e-03 3 1  ON 42
ci_044                -1.520000e-02 3 1  ON 43
ci_045                -1.887990e-03 3 1  ON 44
ci_046                 5.747747e-03 3 1  ON 45
ci_047                 5.602455e-03 3 1  ON 46
ci_048                -1.168768e-02 3 1  ON 47
ci_049                -1.183123e-02 3 1  ON 48
ci_050                 7.880934e-03 3 1  ON 49
ci_051                 7.705197e-03 3 1  ON 50
ci_052                -6.903954e-03 3 1  ON 51
ci_053                -7.025016e-03 3 1  ON 52
ci_054                -2.241804e-03 3 1  ON 53
ci_055                -2.144565e-03 3 1  ON 54
ci_056                 4.711781e-03 3 1  ON 55
ci_057                 4.720051e-03 3 1  ON 56
ci_058                -7.470214e-03 3 1  ON 57
ci_059                -7.211371e-03 3 1  ON 58
ci_060                 8.629260e-03 3 1  ON 59
ci_061                 8.366844e-03 3 1  ON 60
ci_062                -3.396534e-03 3 1  ON 61
ci_063                -3.272584e-03 3 1  ON 62
ci_064                -3.274482e-03 3 1  ON 63
ci_065                -4.242814e-03 3 1  ON 64
ci_066                 6.132894e-03 3 1  ON 65
ci_067                 6.082467e-03 3 1  ON 66
ci_068                -4.562980e-03 3 1  ON 67
ci_069                -4.696031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2007
    reference variance = 0.514994
====================================================
  Execution time = 1.4122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1066e-01
  Total weights = 1.9564e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297130103531
                                         uncertainty =       0.002013061128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297130103531
                                         uncertainty =       0.002013061128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385433342
  error estimate for blocks of size 2^( 2) =       0.000395596803
  error estimate for blocks of size 2^( 3) =       0.000404442589
  error estimate for blocks of size 2^( 4) =       0.000411005204
  error estimate for blocks of size 2^( 5) =       0.000414482079
  error estimate for blocks of size 2^( 6) =       0.000417842102
  error estimate for blocks of size 2^( 7) =       0.000416761994

      target function =                  N/A
              le_mean =     -17.215678616965
             les_mean =     296.690186258923
             stat err =       0.000415022845
             autocorr =       1.159432431846
              std dev =       0.545085059675
             le_variance =       0.297117722281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297158137282
                                         uncertainty =       0.002012405809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297158137282
                                         uncertainty =       0.002012405809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385451617
  error estimate for blocks of size 2^( 2) =       0.000395614243
  error estimate for blocks of size 2^( 3) =       0.000404461745
  error estimate for blocks of size 2^( 4) =       0.000411023282
  error estimate for blocks of size 2^( 5) =       0.000414498759
  error estimate for blocks of size 2^( 6) =       0.000417862460
  error estimate for blocks of size 2^( 7) =       0.000416781568

      target function =                  N/A
              le_mean =     -17.215678442763
             les_mean =     296.690511479052
             stat err =       0.000415041517
             autocorr =       1.159426814177
              std dev =       0.545110904302
             le_variance =       0.297145897989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297143658447
                                         uncertainty =       0.002012674025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297143658447
                                         uncertainty =       0.002012674025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385442191
  error estimate for blocks of size 2^( 2) =       0.000395605164
  error estimate for blocks of size 2^( 3) =       0.000404451919
  error estimate for blocks of size 2^( 4) =       0.000411013968
  error estimate for blocks of size 2^( 5) =       0.000414489955
  error estimate for blocks of size 2^( 6) =       0.000417852220
  error estimate for blocks of size 2^( 7) =       0.000416771745

      target function =                  N/A
              le_mean =     -17.215678375513
             les_mean =     296.690318353808
             stat err =       0.000415031972
             autocorr =       1.159430191785
              std dev =       0.545097573692
             le_variance =       0.297131364845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297131593228
                                         uncertainty =       0.002013011023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297131593228
                                         uncertainty =       0.002013011023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385434316
  error estimate for blocks of size 2^( 2) =       0.000395597712
  error estimate for blocks of size 2^( 3) =       0.000404443621
  error estimate for blocks of size 2^( 4) =       0.000411006166
  error estimate for blocks of size 2^( 5) =       0.000414482918
  error estimate for blocks of size 2^( 6) =       0.000417843256
  error estimate for blocks of size 2^( 7) =       0.000416763109

      target function =                  N/A
              le_mean =     -17.215678563979
             les_mean =     296.690197859298
             stat err =       0.000415023862
             autocorr =       1.159432257842
              std dev =       0.545086436928
             le_variance =       0.297119223722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215678616965        initial  <--
     1.5625e+00     1.5625e+01             1.6804e-04       -17.215678442763
     6.2500e+00     6.2500e+01             4.5735e-05       -17.215678375513
     2.5000e+01     2.5000e+02             1.1697e-05       -17.215678563979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5240
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.081758e-02 3 1  ON 0
ci_002                -3.112591e-02 3 1  ON 1
ci_003                -2.554424e-02 3 1  ON 2
ci_004                 2.190478e-02 3 1  ON 3
ci_005                 2.135067e-02 3 1  ON 4
ci_006                -1.967449e-02 3 1  ON 5
ci_007                -2.035565e-02 3 1  ON 6
ci_008                -1.819854e-02 3 1  ON 7
ci_009                -1.833657e-02 3 1  ON 8
ci_010                -1.671147e-02 3 1  ON 9
ci_011                -1.659243e-02 3 1  ON 10
ci_012                -1.626942e-02 3 1  ON 11
ci_013                -1.924422e-02 3 1  ON 12
ci_014                 1.399749e-02 3 1  ON 13
ci_015                 1.414987e-02 3 1  ON 14
ci_016                 1.637199e-02 3 1  ON 15
ci_017                 1.642748e-02 3 1  ON 16
ci_018                 1.364306e-02 3 1  ON 17
ci_019                 1.361507e-02 3 1  ON 18
ci_020                 1.339444e-02 3 1  ON 19
ci_021                 1.391265e-02 3 1  ON 20
ci_022                 1.231205e-02 3 1  ON 21
ci_023                 1.146679e-02 3 1  ON 22
ci_024                 1.087061e-02 3 1  ON 23
ci_025                 1.110442e-02 3 1  ON 24
ci_026                 1.192576e-02 3 1  ON 25
ci_027                 1.191328e-02 3 1  ON 26
ci_028                -1.456049e-02 3 1  ON 27
ci_029                -1.429970e-02 3 1  ON 28
ci_030                -1.119939e-02 3 1  ON 29
ci_031                -1.080622e-02 3 1  ON 30
ci_032                -1.407780e-02 3 1  ON 31
ci_033                 1.039693e-02 3 1  ON 32
ci_034                 1.040660e-02 3 1  ON 33
ci_035                -4.900441e-03 3 1  ON 34
ci_036                -1.082070e-02 3 1  ON 35
ci_037                -1.103651e-02 3 1  ON 36
ci_038                 1.559624e-03 3 1  ON 37
ci_039                 1.196962e-03 3 1  ON 38
ci_040                -4.220354e-03 3 1  ON 39
ci_041                 1.016814e-02 3 1  ON 40
ci_042                 9.646770e-03 3 1  ON 41
ci_043                -3.458532e-03 3 1  ON 42
ci_044                -1.520001e-02 3 1  ON 43
ci_045                -1.906753e-03 3 1  ON 44
ci_046                 5.731887e-03 3 1  ON 45
ci_047                 5.598394e-03 3 1  ON 46
ci_048                -1.169369e-02 3 1  ON 47
ci_049                -1.185794e-02 3 1  ON 48
ci_050                 7.888500e-03 3 1  ON 49
ci_051                 7.660295e-03 3 1  ON 50
ci_052                -6.872814e-03 3 1  ON 51
ci_053                -7.044730e-03 3 1  ON 52
ci_054                -2.237242e-03 3 1  ON 53
ci_055                -2.106530e-03 3 1  ON 54
ci_056                 4.685831e-03 3 1  ON 55
ci_057                 4.732006e-03 3 1  ON 56
ci_058                -7.491278e-03 3 1  ON 57
ci_059                -7.199593e-03 3 1  ON 58
ci_060                 8.631549e-03 3 1  ON 59
ci_061                 8.347850e-03 3 1  ON 60
ci_062                -3.388988e-03 3 1  ON 61
ci_063                -3.271896e-03 3 1  ON 62
ci_064                -3.285810e-03 3 1  ON 63
ci_065                -4.229845e-03 3 1  ON 64
ci_066                 6.151997e-03 3 1  ON 65
ci_067                 6.079158e-03 3 1  ON 66
ci_068                -4.553936e-03 3 1  ON 67
ci_069                -4.670342e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2541e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.208434
====================================================
  Execution time = 1.4445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1107e-01
  Total weights = 1.956948577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296530326560
                                         uncertainty =       0.003330734162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296530326560
                                         uncertainty =       0.003330734162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385056139
  error estimate for blocks of size 2^( 2) =       0.000395137876
  error estimate for blocks of size 2^( 3) =       0.000404595111
  error estimate for blocks of size 2^( 4) =       0.000411541293
  error estimate for blocks of size 2^( 5) =       0.000414959923
  error estimate for blocks of size 2^( 6) =       0.000416665142
  error estimate for blocks of size 2^( 7) =       0.000419322347

      target function =                  N/A
              le_mean =     -17.216410394330
             les_mean =     296.715856887680
             stat err =       0.000415622176
             autocorr =       1.165062760516
              std dev =       0.544551614079
             le_variance =       0.296536460396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641039433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216410394392       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216410882774       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216410878184       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216410877354       residual = 2.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.392495e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216410394392       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216410517886       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216410516804       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216410516603       residual = 3.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 6.050457e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216410394392       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216410425354       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216410425088       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216410425038       residual = 3.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.517004e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7103e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.081742e-02 3 1  ON 0
ci_002                -3.112737e-02 3 1  ON 1
ci_003                -2.554487e-02 3 1  ON 2
ci_004                 2.190650e-02 3 1  ON 3
ci_005                 2.135242e-02 3 1  ON 4
ci_006                -1.967550e-02 3 1  ON 5
ci_007                -2.035122e-02 3 1  ON 6
ci_008                -1.819864e-02 3 1  ON 7
ci_009                -1.833153e-02 3 1  ON 8
ci_010                -1.671209e-02 3 1  ON 9
ci_011                -1.659371e-02 3 1  ON 10
ci_012                -1.627146e-02 3 1  ON 11
ci_013                -1.924123e-02 3 1  ON 12
ci_014                 1.399944e-02 3 1  ON 13
ci_015                 1.414563e-02 3 1  ON 14
ci_016                 1.637333e-02 3 1  ON 15
ci_017                 1.642761e-02 3 1  ON 16
ci_018                 1.364408e-02 3 1  ON 17
ci_019                 1.361511e-02 3 1  ON 18
ci_020                 1.339822e-02 3 1  ON 19
ci_021                 1.391564e-02 3 1  ON 20
ci_022                 1.230600e-02 3 1  ON 21
ci_023                 1.146961e-02 3 1  ON 22
ci_024                 1.087148e-02 3 1  ON 23
ci_025                 1.110566e-02 3 1  ON 24
ci_026                 1.192679e-02 3 1  ON 25
ci_027                 1.191523e-02 3 1  ON 26
ci_028                -1.456271e-02 3 1  ON 27
ci_029                -1.429786e-02 3 1  ON 28
ci_030                -1.120111e-02 3 1  ON 29
ci_031                -1.080483e-02 3 1  ON 30
ci_032                -1.408186e-02 3 1  ON 31
ci_033                 1.039536e-02 3 1  ON 32
ci_034                 1.040576e-02 3 1  ON 33
ci_035                -4.901664e-03 3 1  ON 34
ci_036                -1.082035e-02 3 1  ON 35
ci_037                -1.103587e-02 3 1  ON 36
ci_038                 1.558606e-03 3 1  ON 37
ci_039                 1.198682e-03 3 1  ON 38
ci_040                -4.220331e-03 3 1  ON 39
ci_041                 1.016753e-02 3 1  ON 40
ci_042                 9.645410e-03 3 1  ON 41
ci_043                -3.460463e-03 3 1  ON 42
ci_044                -1.519961e-02 3 1  ON 43
ci_045                -1.906005e-03 3 1  ON 44
ci_046                 5.731367e-03 3 1  ON 45
ci_047                 5.598485e-03 3 1  ON 46
ci_048                -1.169789e-02 3 1  ON 47
ci_049                -1.185991e-02 3 1  ON 48
ci_050                 7.889763e-03 3 1  ON 49
ci_051                 7.658911e-03 3 1  ON 50
ci_052                -6.871231e-03 3 1  ON 51
ci_053                -7.047219e-03 3 1  ON 52
ci_054                -2.240107e-03 3 1  ON 53
ci_055                -2.107647e-03 3 1  ON 54
ci_056                 4.688212e-03 3 1  ON 55
ci_057                 4.732305e-03 3 1  ON 56
ci_058                -7.492442e-03 3 1  ON 57
ci_059                -7.195184e-03 3 1  ON 58
ci_060                 8.633821e-03 3 1  ON 59
ci_061                 8.346151e-03 3 1  ON 60
ci_062                -3.387216e-03 3 1  ON 61
ci_063                -3.272972e-03 3 1  ON 62
ci_064                -3.284810e-03 3 1  ON 63
ci_065                -4.230634e-03 3 1  ON 64
ci_066                 6.150206e-03 3 1  ON 65
ci_067                 6.078693e-03 3 1  ON 66
ci_068                -4.553037e-03 3 1  ON 67
ci_069                -4.675361e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.204
    reference variance = 0.229199
====================================================
  Execution time = 1.3997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1984e-01
  Total weights = 1.9568e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304450194285
                                         uncertainty =       0.002879812063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304450194285
                                         uncertainty =       0.002879812063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390128190
  error estimate for blocks of size 2^( 2) =       0.000400141565
  error estimate for blocks of size 2^( 3) =       0.000408623897
  error estimate for blocks of size 2^( 4) =       0.000415134141
  error estimate for blocks of size 2^( 5) =       0.000418317215
  error estimate for blocks of size 2^( 6) =       0.000420417248
  error estimate for blocks of size 2^( 7) =       0.000423656381

      target function =                  N/A
              le_mean =     -17.216751844381
             les_mean =     296.736405978135
             stat err =       0.000419381246
             autocorr =       1.155588857054
              std dev =       0.551724577717
             le_variance =       0.304400009657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304442945527
                                         uncertainty =       0.002879371352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304442945527
                                         uncertainty =       0.002879371352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390123577
  error estimate for blocks of size 2^( 2) =       0.000400136926
  error estimate for blocks of size 2^( 3) =       0.000408619618
  error estimate for blocks of size 2^( 4) =       0.000415130034
  error estimate for blocks of size 2^( 5) =       0.000418312906
  error estimate for blocks of size 2^( 6) =       0.000420412866
  error estimate for blocks of size 2^( 7) =       0.000423653340

      target function =                  N/A
              le_mean =     -17.216751872762
             les_mean =     296.736391534477
             stat err =       0.000419377286
             autocorr =       1.155594362041
              std dev =       0.551718054272
             le_variance =       0.304392811410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304446503050
                                         uncertainty =       0.002879589439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304446503050
                                         uncertainty =       0.002879589439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390125841
  error estimate for blocks of size 2^( 2) =       0.000400139203
  error estimate for blocks of size 2^( 3) =       0.000408621717
  error estimate for blocks of size 2^( 4) =       0.000415132048
  error estimate for blocks of size 2^( 5) =       0.000418315020
  error estimate for blocks of size 2^( 6) =       0.000420415018
  error estimate for blocks of size 2^( 7) =       0.000423654826

      target function =                  N/A
              le_mean =     -17.216751854811
             les_mean =     296.736380158270
             stat err =       0.000419379228
             autocorr =       1.155591651492
              std dev =       0.551721255732
             le_variance =       0.304396344026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304449728873
                                         uncertainty =       0.002879784132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304449728873
                                         uncertainty =       0.002879784132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390127894
  error estimate for blocks of size 2^( 2) =       0.000400141267
  error estimate for blocks of size 2^( 3) =       0.000408623622
  error estimate for blocks of size 2^( 4) =       0.000415133876
  error estimate for blocks of size 2^( 5) =       0.000418316937
  error estimate for blocks of size 2^( 6) =       0.000420416966
  error estimate for blocks of size 2^( 7) =       0.000423656182

      target function =                  N/A
              le_mean =     -17.216751844991
             les_mean =     296.736391599106
             stat err =       0.000419380990
             autocorr =       1.155589202079
              std dev =       0.551724158847
             le_variance =       0.304399547456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216751844381        initial
     1.5625e+01     1.5625e+02             2.3925e-05       -17.216751872762  <--
     6.2500e+01     6.2500e+02             6.0505e-06       -17.216751854811
     2.5000e+02     2.5000e+03             1.5170e-06       -17.216751844991

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.3375e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.081692e-02 3 1  ON 0
ci_002                -3.113169e-02 3 1  ON 1
ci_003                -2.554675e-02 3 1  ON 2
ci_004                 2.191158e-02 3 1  ON 3
ci_005                 2.135759e-02 3 1  ON 4
ci_006                -1.967848e-02 3 1  ON 5
ci_007                -2.033809e-02 3 1  ON 6
ci_008                -1.819896e-02 3 1  ON 7
ci_009                -1.831667e-02 3 1  ON 8
ci_010                -1.671397e-02 3 1  ON 9
ci_011                -1.659750e-02 3 1  ON 10
ci_012                -1.627751e-02 3 1  ON 11
ci_013                -1.923236e-02 3 1  ON 12
ci_014                 1.400521e-02 3 1  ON 13
ci_015                 1.413310e-02 3 1  ON 14
ci_016                 1.637731e-02 3 1  ON 15
ci_017                 1.642797e-02 3 1  ON 16
ci_018                 1.364708e-02 3 1  ON 17
ci_019                 1.361525e-02 3 1  ON 18
ci_020                 1.340941e-02 3 1  ON 19
ci_021                 1.392447e-02 3 1  ON 20
ci_022                 1.228812e-02 3 1  ON 21
ci_023                 1.147795e-02 3 1  ON 22
ci_024                 1.087408e-02 3 1  ON 23
ci_025                 1.110936e-02 3 1  ON 24
ci_026                 1.192984e-02 3 1  ON 25
ci_027                 1.192098e-02 3 1  ON 26
ci_028                -1.456928e-02 3 1  ON 27
ci_029                -1.429238e-02 3 1  ON 28
ci_030                -1.120620e-02 3 1  ON 29
ci_031                -1.080070e-02 3 1  ON 30
ci_032                -1.409384e-02 3 1  ON 31
ci_033                 1.039071e-02 3 1  ON 32
ci_034                 1.040327e-02 3 1  ON 33
ci_035                -4.905241e-03 3 1  ON 34
ci_036                -1.081932e-02 3 1  ON 35
ci_037                -1.103397e-02 3 1  ON 36
ci_038                 1.555628e-03 3 1  ON 37
ci_039                 1.203707e-03 3 1  ON 38
ci_040                -4.220265e-03 3 1  ON 39
ci_041                 1.016574e-02 3 1  ON 40
ci_042                 9.641387e-03 3 1  ON 41
ci_043                -3.466116e-03 3 1  ON 42
ci_044                -1.519843e-02 3 1  ON 43
ci_045                -1.903822e-03 3 1  ON 44
ci_046                 5.729834e-03 3 1  ON 45
ci_047                 5.598753e-03 3 1  ON 46
ci_048                -1.171035e-02 3 1  ON 47
ci_049                -1.186574e-02 3 1  ON 48
ci_050                 7.893472e-03 3 1  ON 49
ci_051                 7.654853e-03 3 1  ON 50
ci_052                -6.866574e-03 3 1  ON 51
ci_053                -7.054546e-03 3 1  ON 52
ci_054                -2.248545e-03 3 1  ON 53
ci_055                -2.110938e-03 3 1  ON 54
ci_056                 4.695206e-03 3 1  ON 55
ci_057                 4.733182e-03 3 1  ON 56
ci_058                -7.495875e-03 3 1  ON 57
ci_059                -7.182200e-03 3 1  ON 58
ci_060                 8.640536e-03 3 1  ON 59
ci_061                 8.341144e-03 3 1  ON 60
ci_062                -3.381992e-03 3 1  ON 61
ci_063                -3.276140e-03 3 1  ON 62
ci_064                -3.281909e-03 3 1  ON 63
ci_065                -4.232929e-03 3 1  ON 64
ci_066                 6.144950e-03 3 1  ON 65
ci_067                 6.077327e-03 3 1  ON 66
ci_068                -4.550390e-03 3 1  ON 67
ci_069                -4.690194e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.251
    reference variance = 0.382823
====================================================
  Execution time = 1.4375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1416e-01
  Total weights = 1.956089112e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776458023
                                         uncertainty =       0.002552297175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776458023
                                         uncertainty =       0.002552297175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385817948
  error estimate for blocks of size 2^( 2) =       0.000395586943
  error estimate for blocks of size 2^( 3) =       0.000404796961
  error estimate for blocks of size 2^( 4) =       0.000410627196
  error estimate for blocks of size 2^( 5) =       0.000415337144
  error estimate for blocks of size 2^( 6) =       0.000417797572
  error estimate for blocks of size 2^( 7) =       0.000420090832

      target function =                  N/A
              le_mean =     -17.215872315770
             les_mean =     296.700414850743
             stat err =       0.000415963186
             autocorr =       1.162371459361
              std dev =       0.545628974414
             le_variance =       0.297710977720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587231577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872315827       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215872180793       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872079885       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872067129       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.108486e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872315827       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215872280372       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872251608       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872248268       residual = 2.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.943368e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872315827       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215872306851       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872299411       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872298566       residual = 2.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 7.474514e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7041e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.082828e-02 3 1  ON 0
ci_002                -3.113831e-02 3 1  ON 1
ci_003                -2.554406e-02 3 1  ON 2
ci_004                 2.191554e-02 3 1  ON 3
ci_005                 2.134973e-02 3 1  ON 4
ci_006                -1.967592e-02 3 1  ON 5
ci_007                -2.033686e-02 3 1  ON 6
ci_008                -1.820930e-02 3 1  ON 7
ci_009                -1.831947e-02 3 1  ON 8
ci_010                -1.672609e-02 3 1  ON 9
ci_011                -1.659832e-02 3 1  ON 10
ci_012                -1.628345e-02 3 1  ON 11
ci_013                -1.923726e-02 3 1  ON 12
ci_014                 1.400732e-02 3 1  ON 13
ci_015                 1.414466e-02 3 1  ON 14
ci_016                 1.637725e-02 3 1  ON 15
ci_017                 1.642771e-02 3 1  ON 16
ci_018                 1.364107e-02 3 1  ON 17
ci_019                 1.361204e-02 3 1  ON 18
ci_020                 1.342088e-02 3 1  ON 19
ci_021                 1.393469e-02 3 1  ON 20
ci_022                 1.227652e-02 3 1  ON 21
ci_023                 1.147399e-02 3 1  ON 22
ci_024                 1.087493e-02 3 1  ON 23
ci_025                 1.111322e-02 3 1  ON 24
ci_026                 1.192027e-02 3 1  ON 25
ci_027                 1.191796e-02 3 1  ON 26
ci_028                -1.456026e-02 3 1  ON 27
ci_029                -1.430304e-02 3 1  ON 28
ci_030                -1.121060e-02 3 1  ON 29
ci_031                -1.082117e-02 3 1  ON 30
ci_032                -1.409964e-02 3 1  ON 31
ci_033                 1.038640e-02 3 1  ON 32
ci_034                 1.038392e-02 3 1  ON 33
ci_035                -4.905705e-03 3 1  ON 34
ci_036                -1.081355e-02 3 1  ON 35
ci_037                -1.103104e-02 3 1  ON 36
ci_038                 1.551200e-03 3 1  ON 37
ci_039                 1.214052e-03 3 1  ON 38
ci_040                -4.223022e-03 3 1  ON 39
ci_041                 1.015518e-02 3 1  ON 40
ci_042                 9.635982e-03 3 1  ON 41
ci_043                -3.465973e-03 3 1  ON 42
ci_044                -1.520956e-02 3 1  ON 43
ci_045                -1.903446e-03 3 1  ON 44
ci_046                 5.721364e-03 3 1  ON 45
ci_047                 5.590274e-03 3 1  ON 46
ci_048                -1.171238e-02 3 1  ON 47
ci_049                -1.186061e-02 3 1  ON 48
ci_050                 7.899915e-03 3 1  ON 49
ci_051                 7.655156e-03 3 1  ON 50
ci_052                -6.858725e-03 3 1  ON 51
ci_053                -7.051291e-03 3 1  ON 52
ci_054                -2.254703e-03 3 1  ON 53
ci_055                -2.103512e-03 3 1  ON 54
ci_056                 4.687344e-03 3 1  ON 55
ci_057                 4.762615e-03 3 1  ON 56
ci_058                -7.498119e-03 3 1  ON 57
ci_059                -7.181046e-03 3 1  ON 58
ci_060                 8.635178e-03 3 1  ON 59
ci_061                 8.339231e-03 3 1  ON 60
ci_062                -3.375218e-03 3 1  ON 61
ci_063                -3.264056e-03 3 1  ON 62
ci_064                -3.272018e-03 3 1  ON 63
ci_065                -4.217691e-03 3 1  ON 64
ci_066                 6.157279e-03 3 1  ON 65
ci_067                 6.063488e-03 3 1  ON 66
ci_068                -4.553728e-03 3 1  ON 67
ci_069                -4.692115e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2823
    reference variance = 0.323654
====================================================
  Execution time = 1.4117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1324e-01
  Total weights = 1.9567e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300268614980
                                         uncertainty =       0.002011771825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300268614980
                                         uncertainty =       0.002011771825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387456236
  error estimate for blocks of size 2^( 2) =       0.000397139165
  error estimate for blocks of size 2^( 3) =       0.000405698263
  error estimate for blocks of size 2^( 4) =       0.000411831148
  error estimate for blocks of size 2^( 5) =       0.000415760470
  error estimate for blocks of size 2^( 6) =       0.000417835483
  error estimate for blocks of size 2^( 7) =       0.000419267923

      target function =                  N/A
              le_mean =     -17.216849272561
             les_mean =     296.733148576735
             stat err =       0.000416173756
             autocorr =       1.153729692884
              std dev =       0.547945863540
             le_variance =       0.300244669371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286338539
                                         uncertainty =       0.002011314399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286338539
                                         uncertainty =       0.002011314399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387467846
  error estimate for blocks of size 2^( 2) =       0.000397149939
  error estimate for blocks of size 2^( 3) =       0.000405707751
  error estimate for blocks of size 2^( 4) =       0.000411840793
  error estimate for blocks of size 2^( 5) =       0.000415768461
  error estimate for blocks of size 2^( 6) =       0.000417837985
  error estimate for blocks of size 2^( 7) =       0.000419268191

      target function =                  N/A
              le_mean =     -17.216849836053
             les_mean =     296.733237719015
             stat err =       0.000416178858
             autocorr =       1.153688838433
              std dev =       0.547962282469
             le_variance =       0.300262663009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277376974
                                         uncertainty =       0.002011519520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300277376974
                                         uncertainty =       0.002011519520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387461979
  error estimate for blocks of size 2^( 2) =       0.000397144487
  error estimate for blocks of size 2^( 3) =       0.000405702918
  error estimate for blocks of size 2^( 4) =       0.000411835864
  error estimate for blocks of size 2^( 5) =       0.000415764311
  error estimate for blocks of size 2^( 6) =       0.000417836444
  error estimate for blocks of size 2^( 7) =       0.000419267721

      target function =                  N/A
              le_mean =     -17.216849514328
             les_mean =     296.733166368111
             stat err =       0.000416176085
             autocorr =       1.153708402964
              std dev =       0.547953985834
             le_variance =       0.300253570591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300269668867
                                         uncertainty =       0.002011738761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300269668867
                                         uncertainty =       0.002011738761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387456927
  error estimate for blocks of size 2^( 2) =       0.000397139802
  error estimate for blocks of size 2^( 3) =       0.000405698816
  error estimate for blocks of size 2^( 4) =       0.000411831706
  error estimate for blocks of size 2^( 5) =       0.000415760917
  error estimate for blocks of size 2^( 6) =       0.000417835568
  error estimate for blocks of size 2^( 7) =       0.000419267864

      target function =                  N/A
              le_mean =     -17.216849298191
             les_mean =     296.733143699578
             stat err =       0.000416174014
             autocorr =       1.153727005909
              std dev =       0.547946841201
             le_variance =       0.300245740783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216849272561        initial
     3.9062e+00     3.9062e+01             1.1085e-04       -17.216849836053  <--
     1.5625e+01     1.5625e+02             2.9434e-05       -17.216849514328
     6.2500e+01     6.2500e+02             7.4745e-06       -17.216849298191

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3536e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.086057e-02 3 1  ON 0
ci_002                -3.115716e-02 3 1  ON 1
ci_003                -2.553606e-02 3 1  ON 2
ci_004                 2.192685e-02 3 1  ON 3
ci_005                 2.132714e-02 3 1  ON 4
ci_006                -1.966851e-02 3 1  ON 5
ci_007                -2.033323e-02 3 1  ON 6
ci_008                -1.823825e-02 3 1  ON 7
ci_009                -1.832710e-02 3 1  ON 8
ci_010                -1.676082e-02 3 1  ON 9
ci_011                -1.660066e-02 3 1  ON 10
ci_012                -1.630018e-02 3 1  ON 11
ci_013                -1.925125e-02 3 1  ON 12
ci_014                 1.401358e-02 3 1  ON 13
ci_015                 1.417762e-02 3 1  ON 14
ci_016                 1.637694e-02 3 1  ON 15
ci_017                 1.642699e-02 3 1  ON 16
ci_018                 1.362426e-02 3 1  ON 17
ci_019                 1.360301e-02 3 1  ON 18
ci_020                 1.345373e-02 3 1  ON 19
ci_021                 1.396399e-02 3 1  ON 20
ci_022                 1.224385e-02 3 1  ON 21
ci_023                 1.146272e-02 3 1  ON 22
ci_024                 1.087722e-02 3 1  ON 23
ci_025                 1.112431e-02 3 1  ON 24
ci_026                 1.189291e-02 3 1  ON 25
ci_027                 1.190934e-02 3 1  ON 26
ci_028                -1.453444e-02 3 1  ON 27
ci_029                -1.433352e-02 3 1  ON 28
ci_030                -1.122322e-02 3 1  ON 29
ci_031                -1.087930e-02 3 1  ON 30
ci_032                -1.411589e-02 3 1  ON 31
ci_033                 1.037411e-02 3 1  ON 32
ci_034                 1.032903e-02 3 1  ON 33
ci_035                -4.906918e-03 3 1  ON 34
ci_036                -1.079710e-02 3 1  ON 35
ci_037                -1.102285e-02 3 1  ON 36
ci_038                 1.539161e-03 3 1  ON 37
ci_039                 1.242193e-03 3 1  ON 38
ci_040                -4.230468e-03 3 1  ON 39
ci_041                 1.012542e-02 3 1  ON 40
ci_042                 9.620673e-03 3 1  ON 41
ci_043                -3.465599e-03 3 1  ON 42
ci_044                -1.524164e-02 3 1  ON 43
ci_045                -1.902388e-03 3 1  ON 44
ci_046                 5.697512e-03 3 1  ON 45
ci_047                 5.566586e-03 3 1  ON 46
ci_048                -1.171830e-02 3 1  ON 47
ci_049                -1.184569e-02 3 1  ON 48
ci_050                 7.917711e-03 3 1  ON 49
ci_051                 7.655881e-03 3 1  ON 50
ci_052                -6.836903e-03 3 1  ON 51
ci_053                -7.042325e-03 3 1  ON 52
ci_054                -2.272060e-03 3 1  ON 53
ci_055                -2.082802e-03 3 1  ON 54
ci_056                 4.665653e-03 3 1  ON 55
ci_057                 4.844030e-03 3 1  ON 56
ci_058                -7.504416e-03 3 1  ON 57
ci_059                -7.177782e-03 3 1  ON 58
ci_060                 8.620123e-03 3 1  ON 59
ci_061                 8.333913e-03 3 1  ON 60
ci_062                -3.356348e-03 3 1  ON 61
ci_063                -3.230193e-03 3 1  ON 62
ci_064                -3.245866e-03 3 1  ON 63
ci_065                -4.177112e-03 3 1  ON 64
ci_066                 6.191300e-03 3 1  ON 65
ci_067                 6.025385e-03 3 1  ON 66
ci_068                -4.563054e-03 3 1  ON 67
ci_069                -4.697567e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2634
    reference variance = 0.225007
====================================================
  Execution time = 1.4335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1435e-01
  Total weights = 1.956544217e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300013933840
                                         uncertainty =       0.001798594489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300013933840
                                         uncertainty =       0.001798594489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387283275
  error estimate for blocks of size 2^( 2) =       0.000396966932
  error estimate for blocks of size 2^( 3) =       0.000405603659
  error estimate for blocks of size 2^( 4) =       0.000411926646
  error estimate for blocks of size 2^( 5) =       0.000415597527
  error estimate for blocks of size 2^( 6) =       0.000416089831
  error estimate for blocks of size 2^( 7) =       0.000415822964

      target function =                  N/A
              le_mean =     -17.216259266147
             les_mean =     296.713933621520
             stat err =       0.000414859242
             autocorr =       1.147477174787
              std dev =       0.547701259540
             le_variance =       0.299976669702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625926615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259266206       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216262845921       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216262655952       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.540961e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259266206       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216260330120       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216260271927       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 7.540572e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216259266206       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216259545362       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216259530247       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216259530618       residual = 1.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.980186e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6995e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.086722e-02 3 1  ON 0
ci_002                -3.112200e-02 3 1  ON 1
ci_003                -2.555390e-02 3 1  ON 2
ci_004                 2.193028e-02 3 1  ON 3
ci_005                 2.129240e-02 3 1  ON 4
ci_006                -1.969235e-02 3 1  ON 5
ci_007                -2.030012e-02 3 1  ON 6
ci_008                -1.822176e-02 3 1  ON 7
ci_009                -1.830807e-02 3 1  ON 8
ci_010                -1.680217e-02 3 1  ON 9
ci_011                -1.663745e-02 3 1  ON 10
ci_012                -1.628189e-02 3 1  ON 11
ci_013                -1.926154e-02 3 1  ON 12
ci_014                 1.401333e-02 3 1  ON 13
ci_015                 1.418589e-02 3 1  ON 14
ci_016                 1.638618e-02 3 1  ON 15
ci_017                 1.644839e-02 3 1  ON 16
ci_018                 1.358703e-02 3 1  ON 17
ci_019                 1.358168e-02 3 1  ON 18
ci_020                 1.347578e-02 3 1  ON 19
ci_021                 1.397941e-02 3 1  ON 20
ci_022                 1.225933e-02 3 1  ON 21
ci_023                 1.153812e-02 3 1  ON 22
ci_024                 1.085071e-02 3 1  ON 23
ci_025                 1.112225e-02 3 1  ON 24
ci_026                 1.187038e-02 3 1  ON 25
ci_027                 1.190578e-02 3 1  ON 26
ci_028                -1.457751e-02 3 1  ON 27
ci_029                -1.433785e-02 3 1  ON 28
ci_030                -1.124797e-02 3 1  ON 29
ci_031                -1.089180e-02 3 1  ON 30
ci_032                -1.412085e-02 3 1  ON 31
ci_033                 1.033469e-02 3 1  ON 32
ci_034                 1.030329e-02 3 1  ON 33
ci_035                -4.951458e-03 3 1  ON 34
ci_036                -1.074716e-02 3 1  ON 35
ci_037                -1.099169e-02 3 1  ON 36
ci_038                 1.525101e-03 3 1  ON 37
ci_039                 1.282773e-03 3 1  ON 38
ci_040                -4.269964e-03 3 1  ON 39
ci_041                 1.012179e-02 3 1  ON 40
ci_042                 9.630350e-03 3 1  ON 41
ci_043                -3.445376e-03 3 1  ON 42
ci_044                -1.524138e-02 3 1  ON 43
ci_045                -1.857730e-03 3 1  ON 44
ci_046                 5.681327e-03 3 1  ON 45
ci_047                 5.541955e-03 3 1  ON 46
ci_048                -1.168101e-02 3 1  ON 47
ci_049                -1.189024e-02 3 1  ON 48
ci_050                 7.922401e-03 3 1  ON 49
ci_051                 7.681904e-03 3 1  ON 50
ci_052                -6.872733e-03 3 1  ON 51
ci_053                -7.022151e-03 3 1  ON 52
ci_054                -2.294292e-03 3 1  ON 53
ci_055                -2.135236e-03 3 1  ON 54
ci_056                 4.690299e-03 3 1  ON 55
ci_057                 4.894887e-03 3 1  ON 56
ci_058                -7.467382e-03 3 1  ON 57
ci_059                -7.165398e-03 3 1  ON 58
ci_060                 8.672137e-03 3 1  ON 59
ci_061                 8.367511e-03 3 1  ON 60
ci_062                -3.337326e-03 3 1  ON 61
ci_063                -3.264490e-03 3 1  ON 62
ci_064                -3.235820e-03 3 1  ON 63
ci_065                -4.175781e-03 3 1  ON 64
ci_066                 6.149138e-03 3 1  ON 65
ci_067                 6.001153e-03 3 1  ON 66
ci_068                -4.562858e-03 3 1  ON 67
ci_069                -4.699552e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.262371
====================================================
  Execution time = 1.4284e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1593e-01
  Total weights = 1.9565e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299037704707
                                         uncertainty =       0.002228787485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299037704707
                                         uncertainty =       0.002228787485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386645049
  error estimate for blocks of size 2^( 2) =       0.000396764174
  error estimate for blocks of size 2^( 3) =       0.000405562333
  error estimate for blocks of size 2^( 4) =       0.000412380015
  error estimate for blocks of size 2^( 5) =       0.000416510865
  error estimate for blocks of size 2^( 6) =       0.000417432255
  error estimate for blocks of size 2^( 7) =       0.000420523233

      target function =                  N/A
              le_mean =     -17.216674277436
             les_mean =     296.729894259749
             stat err =       0.000416711592
             autocorr =       1.161572323097
              std dev =       0.546798672768
             le_variance =       0.298988788541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299057025812
                                         uncertainty =       0.002232937793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299057025812
                                         uncertainty =       0.002232937793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386657564
  error estimate for blocks of size 2^( 2) =       0.000396775455
  error estimate for blocks of size 2^( 3) =       0.000405571011
  error estimate for blocks of size 2^( 4) =       0.000412389042
  error estimate for blocks of size 2^( 5) =       0.000416527662
  error estimate for blocks of size 2^( 6) =       0.000417435773
  error estimate for blocks of size 2^( 7) =       0.000420534822

      target function =                  N/A
              le_mean =     -17.216676319248
             les_mean =     296.730841728379
             stat err =       0.000416721825
             autocorr =       1.161554178655
              std dev =       0.546816370588
             le_variance =       0.299008143143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299047112850
                                         uncertainty =       0.002231312529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299047112850
                                         uncertainty =       0.002231312529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386651143
  error estimate for blocks of size 2^( 2) =       0.000396769506
  error estimate for blocks of size 2^( 3) =       0.000405566134
  error estimate for blocks of size 2^( 4) =       0.000412383922
  error estimate for blocks of size 2^( 5) =       0.000416519450
  error estimate for blocks of size 2^( 6) =       0.000417432948
  error estimate for blocks of size 2^( 7) =       0.000420528308

      target function =                  N/A
              le_mean =     -17.216675084814
             les_mean =     296.729911537485
             stat err =       0.000416716157
             autocorr =       1.161561161245
              std dev =       0.546807289771
             le_variance =       0.298998212146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299038407207
                                         uncertainty =       0.002229118365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299038407207
                                         uncertainty =       0.002229118365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386645505
  error estimate for blocks of size 2^( 2) =       0.000396764523
  error estimate for blocks of size 2^( 3) =       0.000405562468
  error estimate for blocks of size 2^( 4) =       0.000412380153
  error estimate for blocks of size 2^( 5) =       0.000416511615
  error estimate for blocks of size 2^( 6) =       0.000417431961
  error estimate for blocks of size 2^( 7) =       0.000420523496

      target function =                  N/A
              le_mean =     -17.216674317332
             les_mean =     296.729861657075
             stat err =       0.000416711806
             autocorr =       1.161570780487
              std dev =       0.546799317194
             le_variance =       0.298989493283


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216674277436        initial
     9.7656e-01     9.7656e+00             2.5410e-04       -17.216676319248  <--
     3.9062e+00     3.9062e+01             7.5406e-05       -17.216675084814
     1.5625e+01     1.5625e+02             1.9802e-05       -17.216674317332

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3686e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.087930e-02 3 1  ON 0
ci_002                -3.103534e-02 3 1  ON 1
ci_003                -2.559708e-02 3 1  ON 2
ci_004                 2.193905e-02 3 1  ON 3
ci_005                 2.120351e-02 3 1  ON 4
ci_006                -1.975022e-02 3 1  ON 5
ci_007                -2.021808e-02 3 1  ON 6
ci_008                -1.818327e-02 3 1  ON 7
ci_009                -1.826292e-02 3 1  ON 8
ci_010                -1.690730e-02 3 1  ON 9
ci_011                -1.672690e-02 3 1  ON 10
ci_012                -1.623668e-02 3 1  ON 11
ci_013                -1.928650e-02 3 1  ON 12
ci_014                 1.401474e-02 3 1  ON 13
ci_015                 1.420738e-02 3 1  ON 14
ci_016                 1.640955e-02 3 1  ON 15
ci_017                 1.650343e-02 3 1  ON 16
ci_018                 1.349749e-02 3 1  ON 17
ci_019                 1.353079e-02 3 1  ON 18
ci_020                 1.353198e-02 3 1  ON 19
ci_021                 1.401678e-02 3 1  ON 20
ci_022                 1.229486e-02 3 1  ON 21
ci_023                 1.171681e-02 3 1  ON 22
ci_024                 1.078344e-02 3 1  ON 23
ci_025                 1.111560e-02 3 1  ON 24
ci_026                 1.181488e-02 3 1  ON 25
ci_027                 1.189613e-02 3 1  ON 26
ci_028                -1.468654e-02 3 1  ON 27
ci_029                -1.434875e-02 3 1  ON 28
ci_030                -1.131045e-02 3 1  ON 29
ci_031                -1.092372e-02 3 1  ON 30
ci_032                -1.413197e-02 3 1  ON 31
ci_033                 1.023851e-02 3 1  ON 32
ci_034                 1.023974e-02 3 1  ON 33
ci_035                -5.046978e-03 3 1  ON 34
ci_036                -1.062294e-02 3 1  ON 35
ci_037                -1.091573e-02 3 1  ON 36
ci_038                 1.494989e-03 3 1  ON 37
ci_039                 1.368139e-03 3 1  ON 38
ci_040                -4.352576e-03 3 1  ON 39
ci_041                 1.011464e-02 3 1  ON 40
ci_042                 9.655112e-03 3 1  ON 41
ci_043                -3.402117e-03 3 1  ON 42
ci_044                -1.524288e-02 3 1  ON 43
ci_045                -1.764911e-03 3 1  ON 44
ci_046                 5.643366e-03 3 1  ON 45
ci_047                 5.483865e-03 3 1  ON 46
ci_048                -1.158460e-02 3 1  ON 47
ci_049                -1.200509e-02 3 1  ON 48
ci_050                 7.932926e-03 3 1  ON 49
ci_051                 7.740725e-03 3 1  ON 50
ci_052                -6.953380e-03 3 1  ON 51
ci_053                -6.976067e-03 3 1  ON 52
ci_054                -2.345697e-03 3 1  ON 53
ci_055                -2.256115e-03 3 1  ON 54
ci_056                 4.745430e-03 3 1  ON 55
ci_057                 5.008160e-03 3 1  ON 56
ci_058                -7.380980e-03 3 1  ON 57
ci_059                -7.136165e-03 3 1  ON 58
ci_060                 8.795126e-03 3 1  ON 59
ci_061                 8.447616e-03 3 1  ON 60
ci_062                -3.292322e-03 3 1  ON 61
ci_063                -3.343246e-03 3 1  ON 62
ci_064                -3.217171e-03 3 1  ON 63
ci_065                -4.173573e-03 3 1  ON 64
ci_066                 6.055794e-03 3 1  ON 65
ci_067                 5.947978e-03 3 1  ON 66
ci_068                -4.560873e-03 3 1  ON 67
ci_069                -4.703741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.263037
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1850e-01
  Total weights = 1.956737346e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302066498356
                                         uncertainty =       0.003229228050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302066498356
                                         uncertainty =       0.003229228050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388604520
  error estimate for blocks of size 2^( 2) =       0.000398335587
  error estimate for blocks of size 2^( 3) =       0.000406890352
  error estimate for blocks of size 2^( 4) =       0.000413701223
  error estimate for blocks of size 2^( 5) =       0.000417948882
  error estimate for blocks of size 2^( 6) =       0.000421413536
  error estimate for blocks of size 2^( 7) =       0.000420568486

      target function =                  N/A
              le_mean =     -17.216519531192
             les_mean =     296.727049082604
             stat err =       0.000418408032
             autocorr =       1.159269283694
              std dev =       0.549569783026
             le_variance =       0.302026946415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651953119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519531235       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529751491       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216528340073       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216528299531       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 8.642261e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519531235       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216523665812       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216523218462       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.521155e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216519531235       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520753827       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520650692       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520656067       residual = 1.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.043627e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6922e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.084550e-02 3 1  ON 0
ci_002                -3.111773e-02 3 1  ON 1
ci_003                -2.545733e-02 3 1  ON 2
ci_004                 2.193091e-02 3 1  ON 3
ci_005                 2.126218e-02 3 1  ON 4
ci_006                -1.997621e-02 3 1  ON 5
ci_007                -2.011493e-02 3 1  ON 6
ci_008                -1.827081e-02 3 1  ON 7
ci_009                -1.814150e-02 3 1  ON 8
ci_010                -1.693144e-02 3 1  ON 9
ci_011                -1.664299e-02 3 1  ON 10
ci_012                -1.651737e-02 3 1  ON 11
ci_013                -1.937583e-02 3 1  ON 12
ci_014                 1.405092e-02 3 1  ON 13
ci_015                 1.423210e-02 3 1  ON 14
ci_016                 1.651500e-02 3 1  ON 15
ci_017                 1.639104e-02 3 1  ON 16
ci_018                 1.343041e-02 3 1  ON 17
ci_019                 1.338082e-02 3 1  ON 18
ci_020                 1.355022e-02 3 1  ON 19
ci_021                 1.378127e-02 3 1  ON 20
ci_022                 1.194275e-02 3 1  ON 21
ci_023                 1.179094e-02 3 1  ON 22
ci_024                 1.085167e-02 3 1  ON 23
ci_025                 1.109801e-02 3 1  ON 24
ci_026                 1.183431e-02 3 1  ON 25
ci_027                 1.175468e-02 3 1  ON 26
ci_028                -1.458923e-02 3 1  ON 27
ci_029                -1.421310e-02 3 1  ON 28
ci_030                -1.134620e-02 3 1  ON 29
ci_031                -1.101085e-02 3 1  ON 30
ci_032                -1.388924e-02 3 1  ON 31
ci_033                 1.011232e-02 3 1  ON 32
ci_034                 1.031888e-02 3 1  ON 33
ci_035                -5.016489e-03 3 1  ON 34
ci_036                -1.063580e-02 3 1  ON 35
ci_037                -1.102095e-02 3 1  ON 36
ci_038                 1.370559e-03 3 1  ON 37
ci_039                 1.408283e-03 3 1  ON 38
ci_040                -4.327065e-03 3 1  ON 39
ci_041                 1.007968e-02 3 1  ON 40
ci_042                 9.563976e-03 3 1  ON 41
ci_043                -3.610575e-03 3 1  ON 42
ci_044                -1.544517e-02 3 1  ON 43
ci_045                -1.833268e-03 3 1  ON 44
ci_046                 5.449522e-03 3 1  ON 45
ci_047                 5.357512e-03 3 1  ON 46
ci_048                -1.153664e-02 3 1  ON 47
ci_049                -1.203137e-02 3 1  ON 48
ci_050                 7.786369e-03 3 1  ON 49
ci_051                 7.809642e-03 3 1  ON 50
ci_052                -6.910957e-03 3 1  ON 51
ci_053                -7.008485e-03 3 1  ON 52
ci_054                -2.387168e-03 3 1  ON 53
ci_055                -2.248047e-03 3 1  ON 54
ci_056                 4.879409e-03 3 1  ON 55
ci_057                 4.967202e-03 3 1  ON 56
ci_058                -7.214189e-03 3 1  ON 57
ci_059                -7.027566e-03 3 1  ON 58
ci_060                 8.481322e-03 3 1  ON 59
ci_061                 8.663428e-03 3 1  ON 60
ci_062                -3.161437e-03 3 1  ON 61
ci_063                -3.288693e-03 3 1  ON 62
ci_064                -3.207805e-03 3 1  ON 63
ci_065                -4.288854e-03 3 1  ON 64
ci_066                 6.015469e-03 3 1  ON 65
ci_067                 5.948659e-03 3 1  ON 66
ci_068                -4.640088e-03 3 1  ON 67
ci_069                -4.678895e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.360373
====================================================
  Execution time = 1.4110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0971e-01
  Total weights = 1.9567e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296491756659
                                         uncertainty =       0.002058329183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296491756659
                                         uncertainty =       0.002058329183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384990329
  error estimate for blocks of size 2^( 2) =       0.000394984971
  error estimate for blocks of size 2^( 3) =       0.000403867384
  error estimate for blocks of size 2^( 4) =       0.000409450426
  error estimate for blocks of size 2^( 5) =       0.000412923026
  error estimate for blocks of size 2^( 6) =       0.000415021875
  error estimate for blocks of size 2^( 7) =       0.000417799595

      target function =                  N/A
              le_mean =     -17.216308012521
             les_mean =     296.711338200957
             stat err =       0.000413798731
             autocorr =       1.155257157812
              std dev =       0.544458544483
             le_variance =       0.296435106661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296349810858
                                         uncertainty =       0.002066968949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296349810858
                                         uncertainty =       0.002066968949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384897644
  error estimate for blocks of size 2^( 2) =       0.000394903395
  error estimate for blocks of size 2^( 3) =       0.000403798335
  error estimate for blocks of size 2^( 4) =       0.000409401075
  error estimate for blocks of size 2^( 5) =       0.000412876338
  error estimate for blocks of size 2^( 6) =       0.000414954656
  error estimate for blocks of size 2^( 7) =       0.000417724875

      target function =                  N/A
              le_mean =     -17.216316946894
             les_mean =     296.713250723226
             stat err =       0.000413739236
             autocorr =       1.155481269751
              std dev =       0.544327468662
             le_variance =       0.296292393140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296331762870
                                         uncertainty =       0.002064238199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296331762870
                                         uncertainty =       0.002064238199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384885982
  error estimate for blocks of size 2^( 2) =       0.000394889736
  error estimate for blocks of size 2^( 3) =       0.000403781805
  error estimate for blocks of size 2^( 4) =       0.000409382623
  error estimate for blocks of size 2^( 5) =       0.000412855341
  error estimate for blocks of size 2^( 6) =       0.000414934999
  error estimate for blocks of size 2^( 7) =       0.000417708162

      target function =                  N/A
              le_mean =     -17.216312086677
             les_mean =     296.713541317546
             stat err =       0.000413720281
             autocorr =       1.155445420225
              std dev =       0.544310975361
             le_variance =       0.296274437898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296454487511
                                         uncertainty =       0.002058908544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296454487511
                                         uncertainty =       0.002058908544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384966064
  error estimate for blocks of size 2^( 2) =       0.000394962275
  error estimate for blocks of size 2^( 3) =       0.000403846441
  error estimate for blocks of size 2^( 4) =       0.000409432378
  error estimate for blocks of size 2^( 5) =       0.000412905604
  error estimate for blocks of size 2^( 6) =       0.000415001663
  error estimate for blocks of size 2^( 7) =       0.000417778293

      target function =                  N/A
              le_mean =     -17.216307273758
             les_mean =     296.711855430856
             stat err =       0.000413779484
             autocorr =       1.155295320536
              std dev =       0.544424229094
             le_variance =       0.296397741225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216308012521        initial
     2.4414e-01     2.4414e+00             8.6423e-04       -17.216316946894  <--
     9.7656e-01     9.7656e+00             3.5212e-04       -17.216312086677
     3.9062e+00     3.9062e+01             1.0436e-04       -17.216307273758

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3527e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.079155e-02 3 1  ON 0
ci_002                -3.124733e-02 3 1  ON 1
ci_003                -2.521876e-02 3 1  ON 2
ci_004                 2.193297e-02 3 1  ON 3
ci_005                 2.135916e-02 3 1  ON 4
ci_006                -2.033917e-02 3 1  ON 5
ci_007                -1.994578e-02 3 1  ON 6
ci_008                -1.839447e-02 3 1  ON 7
ci_009                -1.796713e-02 3 1  ON 8
ci_010                -1.697717e-02 3 1  ON 9
ci_011                -1.651326e-02 3 1  ON 10
ci_012                -1.694869e-02 3 1  ON 11
ci_013                -1.955215e-02 3 1  ON 12
ci_014                 1.411181e-02 3 1  ON 13
ci_015                 1.427158e-02 3 1  ON 14
ci_016                 1.669030e-02 3 1  ON 15
ci_017                 1.621686e-02 3 1  ON 16
ci_018                 1.333115e-02 3 1  ON 17
ci_019                 1.316492e-02 3 1  ON 18
ci_020                 1.358388e-02 3 1  ON 19
ci_021                 1.339162e-02 3 1  ON 20
ci_022                 1.143064e-02 3 1  ON 21
ci_023                 1.191094e-02 3 1  ON 22
ci_024                 1.096739e-02 3 1  ON 23
ci_025                 1.106623e-02 3 1  ON 24
ci_026                 1.186412e-02 3 1  ON 25
ci_027                 1.153521e-02 3 1  ON 26
ci_028                -1.443486e-02 3 1  ON 27
ci_029                -1.398412e-02 3 1  ON 28
ci_030                -1.141327e-02 3 1  ON 29
ci_031                -1.114904e-02 3 1  ON 30
ci_032                -1.355320e-02 3 1  ON 31
ci_033                 9.911763e-03 3 1  ON 32
ci_034                 1.043943e-02 3 1  ON 33
ci_035                -4.972689e-03 3 1  ON 34
ci_036                -1.066203e-02 3 1  ON 35
ci_037                -1.119190e-02 3 1  ON 36
ci_038                 1.229748e-03 3 1  ON 37
ci_039                 1.453282e-03 3 1  ON 38
ci_040                -4.301302e-03 3 1  ON 39
ci_041                 1.003736e-02 3 1  ON 40
ci_042                 9.426426e-03 3 1  ON 41
ci_043                -3.855503e-03 3 1  ON 42
ci_044                -1.581281e-02 3 1  ON 43
ci_045                -1.909964e-03 3 1  ON 44
ci_046                 5.173823e-03 3 1  ON 45
ci_047                 5.175217e-03 3 1  ON 46
ci_048                -1.145656e-02 3 1  ON 47
ci_049                -1.207804e-02 3 1  ON 48
ci_050                 7.602638e-03 3 1  ON 49
ci_051                 7.899186e-03 3 1  ON 50
ci_052                -6.861563e-03 3 1  ON 51
ci_053                -7.056044e-03 3 1  ON 52
ci_054                -2.443840e-03 3 1  ON 53
ci_055                -2.241301e-03 3 1  ON 54
ci_056                 5.053962e-03 3 1  ON 55
ci_057                 4.915327e-03 3 1  ON 56
ci_058                -6.988702e-03 3 1  ON 57
ci_059                -6.876440e-03 3 1  ON 58
ci_060                 8.013627e-03 3 1  ON 59
ci_061                 8.998957e-03 3 1  ON 60
ci_062                -2.980741e-03 3 1  ON 61
ci_063                -3.211555e-03 3 1  ON 62
ci_064                -3.195262e-03 3 1  ON 63
ci_065                -4.405206e-03 3 1  ON 64
ci_066                 5.963785e-03 3 1  ON 65
ci_067                 5.947122e-03 3 1  ON 66
ci_068                -4.763423e-03 3 1  ON 67
ci_069                -4.655553e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2209
    reference variance = 0.190304
====================================================
  Execution time = 1.4274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1292e-01
  Total weights = 1.956708974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298454048795
                                         uncertainty =       0.002310451023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298454048795
                                         uncertainty =       0.002310451023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386275313
  error estimate for blocks of size 2^( 2) =       0.000396244393
  error estimate for blocks of size 2^( 3) =       0.000405222633
  error estimate for blocks of size 2^( 4) =       0.000411759102
  error estimate for blocks of size 2^( 5) =       0.000416289878
  error estimate for blocks of size 2^( 6) =       0.000418991064
  error estimate for blocks of size 2^( 7) =       0.000421535923

      target function =                  N/A
              le_mean =     -17.216491895420
             les_mean =     296.720510973972
             stat err =       0.000417143992
             autocorr =       1.166213540422
              std dev =       0.546275786222
             le_variance =       0.298417234612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649189542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491895448       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216489378908       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216488847060       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489167509       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216489278552       residual = 9.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.351928e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491895448       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490284477       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490140854       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490200239       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 8.268760e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491895448       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491235048       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216491259403       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216491253959       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.245266e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6868e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.093201e-02 3 1  ON 0
ci_002                -3.133343e-02 3 1  ON 1
ci_003                -2.524576e-02 3 1  ON 2
ci_004                 2.160794e-02 3 1  ON 3
ci_005                 2.131347e-02 3 1  ON 4
ci_006                -1.981043e-02 3 1  ON 5
ci_007                -1.983384e-02 3 1  ON 6
ci_008                -1.849987e-02 3 1  ON 7
ci_009                -1.810861e-02 3 1  ON 8
ci_010                -1.682570e-02 3 1  ON 9
ci_011                -1.644230e-02 3 1  ON 10
ci_012                -1.612181e-02 3 1  ON 11
ci_013                -1.971645e-02 3 1  ON 12
ci_014                 1.396310e-02 3 1  ON 13
ci_015                 1.448449e-02 3 1  ON 14
ci_016                 1.657367e-02 3 1  ON 15
ci_017                 1.605547e-02 3 1  ON 16
ci_018                 1.333154e-02 3 1  ON 17
ci_019                 1.327593e-02 3 1  ON 18
ci_020                 1.410657e-02 3 1  ON 19
ci_021                 1.402610e-02 3 1  ON 20
ci_022                 1.140877e-02 3 1  ON 21
ci_023                 1.172551e-02 3 1  ON 22
ci_024                 1.098390e-02 3 1  ON 23
ci_025                 1.125161e-02 3 1  ON 24
ci_026                 1.167807e-02 3 1  ON 25
ci_027                 1.168586e-02 3 1  ON 26
ci_028                -1.456565e-02 3 1  ON 27
ci_029                -1.393023e-02 3 1  ON 28
ci_030                -1.134798e-02 3 1  ON 29
ci_031                -1.106540e-02 3 1  ON 30
ci_032                -1.358316e-02 3 1  ON 31
ci_033                 1.007878e-02 3 1  ON 32
ci_034                 1.046334e-02 3 1  ON 33
ci_035                -4.859613e-03 3 1  ON 34
ci_036                -1.083846e-02 3 1  ON 35
ci_037                -1.095287e-02 3 1  ON 36
ci_038                 1.053629e-03 3 1  ON 37
ci_039                 1.222880e-03 3 1  ON 38
ci_040                -4.346500e-03 3 1  ON 39
ci_041                 9.965948e-03 3 1  ON 40
ci_042                 9.518520e-03 3 1  ON 41
ci_043                -3.415876e-03 3 1  ON 42
ci_044                -1.608795e-02 3 1  ON 43
ci_045                -2.074251e-03 3 1  ON 44
ci_046                 5.176150e-03 3 1  ON 45
ci_047                 5.503243e-03 3 1  ON 46
ci_048                -1.157592e-02 3 1  ON 47
ci_049                -1.167453e-02 3 1  ON 48
ci_050                 7.859580e-03 3 1  ON 49
ci_051                 7.787385e-03 3 1  ON 50
ci_052                -6.739011e-03 3 1  ON 51
ci_053                -6.973074e-03 3 1  ON 52
ci_054                -2.811859e-03 3 1  ON 53
ci_055                -2.419184e-03 3 1  ON 54
ci_056                 4.393341e-03 3 1  ON 55
ci_057                 5.597783e-03 3 1  ON 56
ci_058                -6.951598e-03 3 1  ON 57
ci_059                -6.732799e-03 3 1  ON 58
ci_060                 8.821538e-03 3 1  ON 59
ci_061                 9.518007e-03 3 1  ON 60
ci_062                -3.093917e-03 3 1  ON 61
ci_063                -2.989631e-03 3 1  ON 62
ci_064                -3.044492e-03 3 1  ON 63
ci_065                -4.317871e-03 3 1  ON 64
ci_066                 5.742692e-03 3 1  ON 65
ci_067                 5.946516e-03 3 1  ON 66
ci_068                -4.920509e-03 3 1  ON 67
ci_069                -4.060694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2347
    reference variance = 0.239785
====================================================
  Execution time = 1.3944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2378e-01
  Total weights = 1.9568e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306448969743
                                         uncertainty =       0.003474479817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306448969743
                                         uncertainty =       0.003474479817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391449815
  error estimate for blocks of size 2^( 2) =       0.000401205331
  error estimate for blocks of size 2^( 3) =       0.000409963773
  error estimate for blocks of size 2^( 4) =       0.000416683796
  error estimate for blocks of size 2^( 5) =       0.000419715782
  error estimate for blocks of size 2^( 6) =       0.000420670102
  error estimate for blocks of size 2^( 7) =       0.000421266875

      target function =                  N/A
              le_mean =     -17.217028379003
             les_mean =     296.855323247832
             stat err =       0.000419584139
             autocorr =       1.148909820397
              std dev =       0.553593636661
             le_variance =       0.306465914552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304033697486
                                         uncertainty =       0.002868993609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304033697486
                                         uncertainty =       0.002868993609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389904696
  error estimate for blocks of size 2^( 2) =       0.000399744726
  error estimate for blocks of size 2^( 3) =       0.000408547721
  error estimate for blocks of size 2^( 4) =       0.000415237927
  error estimate for blocks of size 2^( 5) =       0.000418260753
  error estimate for blocks of size 2^( 6) =       0.000419252196
  error estimate for blocks of size 2^( 7) =       0.000419906211

      target function =                  N/A
              le_mean =     -17.217039803627
             les_mean =     296.750642301420
             stat err =       0.000418164272
             autocorr =       1.150209409277
              std dev =       0.551408508819
             le_variance =       0.304051343598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304066981635
                                         uncertainty =       0.002856083702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304066981635
                                         uncertainty =       0.002856083702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389925895
  error estimate for blocks of size 2^( 2) =       0.000399773322
  error estimate for blocks of size 2^( 3) =       0.000408582604
  error estimate for blocks of size 2^( 4) =       0.000415274627
  error estimate for blocks of size 2^( 5) =       0.000418300457
  error estimate for blocks of size 2^( 6) =       0.000419284395
  error estimate for blocks of size 2^( 7) =       0.000419939644

      target function =                  N/A
              le_mean =     -17.217049378033
             les_mean =     296.750868744410
             stat err =       0.000418199781
             autocorr =       1.150279674009
              std dev =       0.551438489576
             le_variance =       0.304084407785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304008368788
                                         uncertainty =       0.002877982998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304008368788
                                         uncertainty =       0.002877982998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389888532
  error estimate for blocks of size 2^( 2) =       0.000399711935
  error estimate for blocks of size 2^( 3) =       0.000408507031
  error estimate for blocks of size 2^( 4) =       0.000415204822
  error estimate for blocks of size 2^( 5) =       0.000418215170
  error estimate for blocks of size 2^( 6) =       0.000419226304
  error estimate for blocks of size 2^( 7) =       0.000419865230

      target function =                  N/A
              le_mean =     -17.217042056674
             les_mean =     296.756829010852
             stat err =       0.000418127881
             autocorr =       1.150104583417
              std dev =       0.551385649169
             le_variance =       0.304026134109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217028379003        initial
     6.1035e-02     6.1035e-01             1.3519e-03       -17.217039803627
     2.4414e-01     2.4414e+00             8.2688e-04       -17.217049378033  <--
     9.7656e-01     9.7656e+00             3.2453e-04       -17.217042056674

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3373e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.093201e-02 3 1  ON 0
ci_002                -3.133343e-02 3 1  ON 1
ci_003                -2.524576e-02 3 1  ON 2
ci_004                 2.160794e-02 3 1  ON 3
ci_005                 2.131347e-02 3 1  ON 4
ci_006                -1.981043e-02 3 1  ON 5
ci_007                -1.983384e-02 3 1  ON 6
ci_008                -1.849987e-02 3 1  ON 7
ci_009                -1.810861e-02 3 1  ON 8
ci_010                -1.682570e-02 3 1  ON 9
ci_011                -1.644230e-02 3 1  ON 10
ci_012                -1.612181e-02 3 1  ON 11
ci_013                -1.971645e-02 3 1  ON 12
ci_014                 1.396310e-02 3 1  ON 13
ci_015                 1.448449e-02 3 1  ON 14
ci_016                 1.657367e-02 3 1  ON 15
ci_017                 1.605547e-02 3 1  ON 16
ci_018                 1.333154e-02 3 1  ON 17
ci_019                 1.327593e-02 3 1  ON 18
ci_020                 1.410657e-02 3 1  ON 19
ci_021                 1.402610e-02 3 1  ON 20
ci_022                 1.140877e-02 3 1  ON 21
ci_023                 1.172551e-02 3 1  ON 22
ci_024                 1.098390e-02 3 1  ON 23
ci_025                 1.125161e-02 3 1  ON 24
ci_026                 1.167807e-02 3 1  ON 25
ci_027                 1.168586e-02 3 1  ON 26
ci_028                -1.456565e-02 3 1  ON 27
ci_029                -1.393023e-02 3 1  ON 28
ci_030                -1.134798e-02 3 1  ON 29
ci_031                -1.106540e-02 3 1  ON 30
ci_032                -1.358316e-02 3 1  ON 31
ci_033                 1.007878e-02 3 1  ON 32
ci_034                 1.046334e-02 3 1  ON 33
ci_035                -4.859613e-03 3 1  ON 34
ci_036                -1.083846e-02 3 1  ON 35
ci_037                -1.095287e-02 3 1  ON 36
ci_038                 1.053629e-03 3 1  ON 37
ci_039                 1.222880e-03 3 1  ON 38
ci_040                -4.346500e-03 3 1  ON 39
ci_041                 9.965948e-03 3 1  ON 40
ci_042                 9.518520e-03 3 1  ON 41
ci_043                -3.415876e-03 3 1  ON 42
ci_044                -1.608795e-02 3 1  ON 43
ci_045                -2.074251e-03 3 1  ON 44
ci_046                 5.176150e-03 3 1  ON 45
ci_047                 5.503243e-03 3 1  ON 46
ci_048                -1.157592e-02 3 1  ON 47
ci_049                -1.167453e-02 3 1  ON 48
ci_050                 7.859580e-03 3 1  ON 49
ci_051                 7.787385e-03 3 1  ON 50
ci_052                -6.739011e-03 3 1  ON 51
ci_053                -6.973074e-03 3 1  ON 52
ci_054                -2.811859e-03 3 1  ON 53
ci_055                -2.419184e-03 3 1  ON 54
ci_056                 4.393341e-03 3 1  ON 55
ci_057                 5.597783e-03 3 1  ON 56
ci_058                -6.951598e-03 3 1  ON 57
ci_059                -6.732799e-03 3 1  ON 58
ci_060                 8.821538e-03 3 1  ON 59
ci_061                 9.518007e-03 3 1  ON 60
ci_062                -3.093917e-03 3 1  ON 61
ci_063                -2.989631e-03 3 1  ON 62
ci_064                -3.044492e-03 3 1  ON 63
ci_065                -4.317871e-03 3 1  ON 64
ci_066                 5.742692e-03 3 1  ON 65
ci_067                 5.946516e-03 3 1  ON 66
ci_068                -4.920509e-03 3 1  ON 67
ci_069                -4.060694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.263201
====================================================
  Execution time = 1.4332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1570e-01
  Total weights = 1.956582065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298365310989
                                         uncertainty =       0.002342033731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298365310989
                                         uncertainty =       0.002342033731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386196023
  error estimate for blocks of size 2^( 2) =       0.000396274917
  error estimate for blocks of size 2^( 3) =       0.000404851562
  error estimate for blocks of size 2^( 4) =       0.000412115294
  error estimate for blocks of size 2^( 5) =       0.000416622349
  error estimate for blocks of size 2^( 6) =       0.000419206350
  error estimate for blocks of size 2^( 7) =       0.000419660264

      target function =                  N/A
              le_mean =     -17.216836758075
             les_mean =     296.735166371763
             stat err =       0.000416901064
             autocorr =       1.165333985860
              std dev =       0.546163654155
             le_variance =       0.298294737120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683675808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836758124       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216860614758       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216862015325       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216860841472       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216861043454       residual = 7.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.384014e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836758124       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216852096068       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216852986128       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216852497081       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 8.230778e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836758124       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216843074406       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216843500279       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216843375681       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.564065e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7018e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.097463e-02 3 1  ON 0
ci_002                -3.066763e-02 3 1  ON 1
ci_003                -2.532539e-02 3 1  ON 2
ci_004                 2.183724e-02 3 1  ON 3
ci_005                 2.206518e-02 3 1  ON 4
ci_006                -1.924376e-02 3 1  ON 5
ci_007                -2.003669e-02 3 1  ON 6
ci_008                -1.867196e-02 3 1  ON 7
ci_009                -1.788563e-02 3 1  ON 8
ci_010                -1.726903e-02 3 1  ON 9
ci_011                -1.643677e-02 3 1  ON 10
ci_012                -1.609775e-02 3 1  ON 11
ci_013                -1.970259e-02 3 1  ON 12
ci_014                 1.440429e-02 3 1  ON 13
ci_015                 1.405283e-02 3 1  ON 14
ci_016                 1.652131e-02 3 1  ON 15
ci_017                 1.638293e-02 3 1  ON 16
ci_018                 1.392069e-02 3 1  ON 17
ci_019                 1.394364e-02 3 1  ON 18
ci_020                 1.396002e-02 3 1  ON 19
ci_021                 1.395546e-02 3 1  ON 20
ci_022                 1.169608e-02 3 1  ON 21
ci_023                 1.212884e-02 3 1  ON 22
ci_024                 1.137534e-02 3 1  ON 23
ci_025                 1.162572e-02 3 1  ON 24
ci_026                 1.148853e-02 3 1  ON 25
ci_027                 1.143570e-02 3 1  ON 26
ci_028                -1.442841e-02 3 1  ON 27
ci_029                -1.436887e-02 3 1  ON 28
ci_030                -1.132486e-02 3 1  ON 29
ci_031                -1.100966e-02 3 1  ON 30
ci_032                -1.364723e-02 3 1  ON 31
ci_033                 9.671501e-03 3 1  ON 32
ci_034                 9.744039e-03 3 1  ON 33
ci_035                -4.908562e-03 3 1  ON 34
ci_036                -1.079463e-02 3 1  ON 35
ci_037                -1.097189e-02 3 1  ON 36
ci_038                 1.211504e-03 3 1  ON 37
ci_039                 8.081845e-04 3 1  ON 38
ci_040                -4.035450e-03 3 1  ON 39
ci_041                 1.014244e-02 3 1  ON 40
ci_042                 9.829395e-03 3 1  ON 41
ci_043                -3.417860e-03 3 1  ON 42
ci_044                -1.605380e-02 3 1  ON 43
ci_045                -2.231417e-03 3 1  ON 44
ci_046                 5.123506e-03 3 1  ON 45
ci_047                 5.369542e-03 3 1  ON 46
ci_048                -1.122721e-02 3 1  ON 47
ci_049                -1.172648e-02 3 1  ON 48
ci_050                 7.500300e-03 3 1  ON 49
ci_051                 7.575095e-03 3 1  ON 50
ci_052                -5.915934e-03 3 1  ON 51
ci_053                -6.689661e-03 3 1  ON 52
ci_054                -2.020495e-03 3 1  ON 53
ci_055                -2.713127e-03 3 1  ON 54
ci_056                 5.003349e-03 3 1  ON 55
ci_057                 4.972868e-03 3 1  ON 56
ci_058                -7.084950e-03 3 1  ON 57
ci_059                -7.127455e-03 3 1  ON 58
ci_060                 8.702231e-03 3 1  ON 59
ci_061                 8.942704e-03 3 1  ON 60
ci_062                -3.087700e-03 3 1  ON 61
ci_063                -2.714875e-03 3 1  ON 62
ci_064                -3.149128e-03 3 1  ON 63
ci_065                -4.432091e-03 3 1  ON 64
ci_066                 5.631811e-03 3 1  ON 65
ci_067                 5.468349e-03 3 1  ON 66
ci_068                -5.464666e-03 3 1  ON 67
ci_069                -4.663001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.468358
====================================================
  Execution time = 1.4079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1417e-01
  Total weights = 1.9564e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300470339472
                                         uncertainty =       0.002916168218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300470339472
                                         uncertainty =       0.002916168218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387670380
  error estimate for blocks of size 2^( 2) =       0.000397947761
  error estimate for blocks of size 2^( 3) =       0.000406440112
  error estimate for blocks of size 2^( 4) =       0.000412386864
  error estimate for blocks of size 2^( 5) =       0.000416273396
  error estimate for blocks of size 2^( 6) =       0.000416630461
  error estimate for blocks of size 2^( 7) =       0.000418099798

      target function =                  N/A
              le_mean =     -17.216881494923
             les_mean =     296.746431350105
             stat err =       0.000415847630
             autocorr =       1.150649942903
              std dev =       0.548248709720
             le_variance =       0.300576647709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300496841571
                                         uncertainty =       0.002955329467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300496841571
                                         uncertainty =       0.002955329467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387687221
  error estimate for blocks of size 2^( 2) =       0.000397945830
  error estimate for blocks of size 2^( 3) =       0.000406435364
  error estimate for blocks of size 2^( 4) =       0.000412412946
  error estimate for blocks of size 2^( 5) =       0.000416282227
  error estimate for blocks of size 2^( 6) =       0.000416628487
  error estimate for blocks of size 2^( 7) =       0.000418083808

      target function =                  N/A
              le_mean =     -17.216863432104
             les_mean =     296.737175133935
             stat err =       0.000415851867
             autocorr =       1.150573427018
              std dev =       0.548272525624
             le_variance =       0.300602762354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599360827
                                         uncertainty =       0.002967061435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599360827
                                         uncertainty =       0.002967061435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387753445
  error estimate for blocks of size 2^( 2) =       0.000398007413
  error estimate for blocks of size 2^( 3) =       0.000406497091
  error estimate for blocks of size 2^( 4) =       0.000412476645
  error estimate for blocks of size 2^( 5) =       0.000416344817
  error estimate for blocks of size 2^( 6) =       0.000416678573
  error estimate for blocks of size 2^( 7) =       0.000418124658

      target function =                  N/A
              le_mean =     -17.216883122538
             les_mean =     296.735761950172
             stat err =       0.000415906173
             autocorr =       1.150480875098
              std dev =       0.548366180340
             le_variance =       0.300705467741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300379216451
                                         uncertainty =       0.002919353758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300379216451
                                         uncertainty =       0.002919353758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387611721
  error estimate for blocks of size 2^( 2) =       0.000397889442
  error estimate for blocks of size 2^( 3) =       0.000406384025
  error estimate for blocks of size 2^( 4) =       0.000412337518
  error estimate for blocks of size 2^( 5) =       0.000416213119
  error estimate for blocks of size 2^( 6) =       0.000416548198
  error estimate for blocks of size 2^( 7) =       0.000418016712

      target function =                  N/A
              le_mean =     -17.216867897822
             les_mean =     296.804650262446
             stat err =       0.000415778887
             autocorr =       1.150617729321
              std dev =       0.548165752757
             le_variance =       0.300485692496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216881494923        initial
     6.1035e-02     6.1035e-01             1.3840e-03       -17.216863432104
     2.4414e-01     2.4414e+00             8.2308e-04       -17.216883122538  <--
     9.7656e-01     9.7656e+00             3.5641e-04       -17.216867897822

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3488e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.097463e-02 3 1  ON 0
ci_002                -3.066763e-02 3 1  ON 1
ci_003                -2.532539e-02 3 1  ON 2
ci_004                 2.183724e-02 3 1  ON 3
ci_005                 2.206518e-02 3 1  ON 4
ci_006                -1.924376e-02 3 1  ON 5
ci_007                -2.003669e-02 3 1  ON 6
ci_008                -1.867196e-02 3 1  ON 7
ci_009                -1.788563e-02 3 1  ON 8
ci_010                -1.726903e-02 3 1  ON 9
ci_011                -1.643677e-02 3 1  ON 10
ci_012                -1.609775e-02 3 1  ON 11
ci_013                -1.970259e-02 3 1  ON 12
ci_014                 1.440429e-02 3 1  ON 13
ci_015                 1.405283e-02 3 1  ON 14
ci_016                 1.652131e-02 3 1  ON 15
ci_017                 1.638293e-02 3 1  ON 16
ci_018                 1.392069e-02 3 1  ON 17
ci_019                 1.394364e-02 3 1  ON 18
ci_020                 1.396002e-02 3 1  ON 19
ci_021                 1.395546e-02 3 1  ON 20
ci_022                 1.169608e-02 3 1  ON 21
ci_023                 1.212884e-02 3 1  ON 22
ci_024                 1.137534e-02 3 1  ON 23
ci_025                 1.162572e-02 3 1  ON 24
ci_026                 1.148853e-02 3 1  ON 25
ci_027                 1.143570e-02 3 1  ON 26
ci_028                -1.442841e-02 3 1  ON 27
ci_029                -1.436887e-02 3 1  ON 28
ci_030                -1.132486e-02 3 1  ON 29
ci_031                -1.100966e-02 3 1  ON 30
ci_032                -1.364723e-02 3 1  ON 31
ci_033                 9.671501e-03 3 1  ON 32
ci_034                 9.744039e-03 3 1  ON 33
ci_035                -4.908562e-03 3 1  ON 34
ci_036                -1.079463e-02 3 1  ON 35
ci_037                -1.097189e-02 3 1  ON 36
ci_038                 1.211504e-03 3 1  ON 37
ci_039                 8.081845e-04 3 1  ON 38
ci_040                -4.035450e-03 3 1  ON 39
ci_041                 1.014244e-02 3 1  ON 40
ci_042                 9.829395e-03 3 1  ON 41
ci_043                -3.417860e-03 3 1  ON 42
ci_044                -1.605380e-02 3 1  ON 43
ci_045                -2.231417e-03 3 1  ON 44
ci_046                 5.123506e-03 3 1  ON 45
ci_047                 5.369542e-03 3 1  ON 46
ci_048                -1.122721e-02 3 1  ON 47
ci_049                -1.172648e-02 3 1  ON 48
ci_050                 7.500300e-03 3 1  ON 49
ci_051                 7.575095e-03 3 1  ON 50
ci_052                -5.915934e-03 3 1  ON 51
ci_053                -6.689661e-03 3 1  ON 52
ci_054                -2.020495e-03 3 1  ON 53
ci_055                -2.713127e-03 3 1  ON 54
ci_056                 5.003349e-03 3 1  ON 55
ci_057                 4.972868e-03 3 1  ON 56
ci_058                -7.084950e-03 3 1  ON 57
ci_059                -7.127455e-03 3 1  ON 58
ci_060                 8.702231e-03 3 1  ON 59
ci_061                 8.942704e-03 3 1  ON 60
ci_062                -3.087700e-03 3 1  ON 61
ci_063                -2.714875e-03 3 1  ON 62
ci_064                -3.149128e-03 3 1  ON 63
ci_065                -4.432091e-03 3 1  ON 64
ci_066                 5.631811e-03 3 1  ON 65
ci_067                 5.468349e-03 3 1  ON 66
ci_068                -5.464666e-03 3 1  ON 67
ci_069                -4.663001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.274
    reference variance = 0.311122
====================================================
  Execution time = 1.4419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1443e-01
  Total weights = 1.956847987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299526379470
                                         uncertainty =       0.001904904126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299526379470
                                         uncertainty =       0.001904904126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386946524
  error estimate for blocks of size 2^( 2) =       0.000396933087
  error estimate for blocks of size 2^( 3) =       0.000405604204
  error estimate for blocks of size 2^( 4) =       0.000412244734
  error estimate for blocks of size 2^( 5) =       0.000416694656
  error estimate for blocks of size 2^( 6) =       0.000417761293
  error estimate for blocks of size 2^( 7) =       0.000416979622

      target function =                  N/A
              le_mean =     -17.217031734029
             les_mean =     296.740610379246
             stat err =       0.000415920076
             autocorr =       1.155361441242
              std dev =       0.547225022007
             le_variance =       0.299455224711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703173403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217031734096       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217066479911       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062471705       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217062214274       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217062304338       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.242077e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217031734096       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217053920381       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217051942186       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217051838535       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 6.880230e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217031734096       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040804969       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040440499       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040438314       residual = 1.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.564399e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0620e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.046673e-02 3 1  ON 0
ci_002                -3.066134e-02 3 1  ON 1
ci_003                -2.523570e-02 3 1  ON 2
ci_004                 2.139927e-02 3 1  ON 3
ci_005                 2.190584e-02 3 1  ON 4
ci_006                -1.990660e-02 3 1  ON 5
ci_007                -1.959891e-02 3 1  ON 6
ci_008                -1.836358e-02 3 1  ON 7
ci_009                -1.799638e-02 3 1  ON 8
ci_010                -1.738301e-02 3 1  ON 9
ci_011                -1.707423e-02 3 1  ON 10
ci_012                -1.633879e-02 3 1  ON 11
ci_013                -1.988786e-02 3 1  ON 12
ci_014                 1.465801e-02 3 1  ON 13
ci_015                 1.388240e-02 3 1  ON 14
ci_016                 1.664554e-02 3 1  ON 15
ci_017                 1.625412e-02 3 1  ON 16
ci_018                 1.372521e-02 3 1  ON 17
ci_019                 1.418741e-02 3 1  ON 18
ci_020                 1.383343e-02 3 1  ON 19
ci_021                 1.395079e-02 3 1  ON 20
ci_022                 1.147387e-02 3 1  ON 21
ci_023                 1.184086e-02 3 1  ON 22
ci_024                 1.068731e-02 3 1  ON 23
ci_025                 1.169633e-02 3 1  ON 24
ci_026                 1.187944e-02 3 1  ON 25
ci_027                 1.135242e-02 3 1  ON 26
ci_028                -1.471609e-02 3 1  ON 27
ci_029                -1.456099e-02 3 1  ON 28
ci_030                -1.112204e-02 3 1  ON 29
ci_031                -1.131023e-02 3 1  ON 30
ci_032                -1.328777e-02 3 1  ON 31
ci_033                 9.676218e-03 3 1  ON 32
ci_034                 9.898827e-03 3 1  ON 33
ci_035                -5.002167e-03 3 1  ON 34
ci_036                -1.082178e-02 3 1  ON 35
ci_037                -1.071178e-02 3 1  ON 36
ci_038                 1.023428e-03 3 1  ON 37
ci_039                 1.092563e-03 3 1  ON 38
ci_040                -4.200166e-03 3 1  ON 39
ci_041                 9.826308e-03 3 1  ON 40
ci_042                 9.949477e-03 3 1  ON 41
ci_043                -3.450045e-03 3 1  ON 42
ci_044                -1.571996e-02 3 1  ON 43
ci_045                -1.860824e-03 3 1  ON 44
ci_046                 5.595085e-03 3 1  ON 45
ci_047                 5.527027e-03 3 1  ON 46
ci_048                -1.169858e-02 3 1  ON 47
ci_049                -1.168545e-02 3 1  ON 48
ci_050                 7.265442e-03 3 1  ON 49
ci_051                 7.783177e-03 3 1  ON 50
ci_052                -5.876508e-03 3 1  ON 51
ci_053                -6.750487e-03 3 1  ON 52
ci_054                -2.127405e-03 3 1  ON 53
ci_055                -2.719940e-03 3 1  ON 54
ci_056                 5.115870e-03 3 1  ON 55
ci_057                 4.668163e-03 3 1  ON 56
ci_058                -7.068855e-03 3 1  ON 57
ci_059                -7.216937e-03 3 1  ON 58
ci_060                 8.322515e-03 3 1  ON 59
ci_061                 9.161567e-03 3 1  ON 60
ci_062                -3.061524e-03 3 1  ON 61
ci_063                -3.002083e-03 3 1  ON 62
ci_064                -3.292803e-03 3 1  ON 63
ci_065                -4.062204e-03 3 1  ON 64
ci_066                 5.823768e-03 3 1  ON 65
ci_067                 5.790231e-03 3 1  ON 66
ci_068                -5.497514e-03 3 1  ON 67
ci_069                -4.690259e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.215877
====================================================
  Execution time = 1.4449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1514e-01
  Total weights = 1.9566e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905601183
                                         uncertainty =       0.002073641449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297905601183
                                         uncertainty =       0.002073641449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385963220
  error estimate for blocks of size 2^( 2) =       0.000396186938
  error estimate for blocks of size 2^( 3) =       0.000405380211
  error estimate for blocks of size 2^( 4) =       0.000411426210
  error estimate for blocks of size 2^( 5) =       0.000414300649
  error estimate for blocks of size 2^( 6) =       0.000418153100
  error estimate for blocks of size 2^( 7) =       0.000416316485

      target function =                  N/A
              le_mean =     -17.215965910445
             les_mean =     296.786752744379
             stat err =       0.000415049111
             autocorr =       1.156397476232
              std dev =       0.545834420107
             le_variance =       0.297935214174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345565595
                                         uncertainty =       0.001955860532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345565595
                                         uncertainty =       0.001955860532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385605902
  error estimate for blocks of size 2^( 2) =       0.000395866252
  error estimate for blocks of size 2^( 3) =       0.000405066832
  error estimate for blocks of size 2^( 4) =       0.000411110023
  error estimate for blocks of size 2^( 5) =       0.000413972022
  error estimate for blocks of size 2^( 6) =       0.000417800971
  error estimate for blocks of size 2^( 7) =       0.000416018715

      target function =                  N/A
              le_mean =     -17.215959305898
             les_mean =     296.713235118639
             stat err =       0.000414725433
             autocorr =       1.156735311334
              std dev =       0.545329096009
             le_variance =       0.297383822954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440435928
                                         uncertainty =       0.001957054653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440435928
                                         uncertainty =       0.001957054653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385668078
  error estimate for blocks of size 2^( 2) =       0.000395940342
  error estimate for blocks of size 2^( 3) =       0.000405142023
  error estimate for blocks of size 2^( 4) =       0.000411180984
  error estimate for blocks of size 2^( 5) =       0.000414023265
  error estimate for blocks of size 2^( 6) =       0.000417844269
  error estimate for blocks of size 2^( 7) =       0.000416029245

      target function =                  N/A
              le_mean =     -17.215975200346
             les_mean =     296.766294113456
             stat err =       0.000414769441
             autocorr =       1.156607798447
              std dev =       0.545417025864
             le_variance =       0.297479732103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564328246
                                         uncertainty =       0.001996151867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564328246
                                         uncertainty =       0.001996151867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385743446
  error estimate for blocks of size 2^( 2) =       0.000395974264
  error estimate for blocks of size 2^( 3) =       0.000405169957
  error estimate for blocks of size 2^( 4) =       0.000411214466
  error estimate for blocks of size 2^( 5) =       0.000414087958
  error estimate for blocks of size 2^( 6) =       0.000417924260
  error estimate for blocks of size 2^( 7) =       0.000416107172

      target function =                  N/A
              le_mean =     -17.215956587036
             les_mean =     296.708007591652
             stat err =       0.000414833464
             autocorr =       1.156512830455
              std dev =       0.545523612503
             le_variance =       0.297596011798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215965910445        initial
     6.1035e-02     6.1035e-01             1.2421e-03       -17.215959305898
     2.4414e-01     2.4414e+00             6.8802e-04       -17.215975200346  <--
     9.7656e-01     9.7656e+00             2.5644e-04       -17.215956587036

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3852e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.046673e-02 3 1  ON 0
ci_002                -3.066134e-02 3 1  ON 1
ci_003                -2.523570e-02 3 1  ON 2
ci_004                 2.139927e-02 3 1  ON 3
ci_005                 2.190584e-02 3 1  ON 4
ci_006                -1.990660e-02 3 1  ON 5
ci_007                -1.959891e-02 3 1  ON 6
ci_008                -1.836358e-02 3 1  ON 7
ci_009                -1.799638e-02 3 1  ON 8
ci_010                -1.738301e-02 3 1  ON 9
ci_011                -1.707423e-02 3 1  ON 10
ci_012                -1.633879e-02 3 1  ON 11
ci_013                -1.988786e-02 3 1  ON 12
ci_014                 1.465801e-02 3 1  ON 13
ci_015                 1.388240e-02 3 1  ON 14
ci_016                 1.664554e-02 3 1  ON 15
ci_017                 1.625412e-02 3 1  ON 16
ci_018                 1.372521e-02 3 1  ON 17
ci_019                 1.418741e-02 3 1  ON 18
ci_020                 1.383343e-02 3 1  ON 19
ci_021                 1.395079e-02 3 1  ON 20
ci_022                 1.147387e-02 3 1  ON 21
ci_023                 1.184086e-02 3 1  ON 22
ci_024                 1.068731e-02 3 1  ON 23
ci_025                 1.169633e-02 3 1  ON 24
ci_026                 1.187944e-02 3 1  ON 25
ci_027                 1.135242e-02 3 1  ON 26
ci_028                -1.471609e-02 3 1  ON 27
ci_029                -1.456099e-02 3 1  ON 28
ci_030                -1.112204e-02 3 1  ON 29
ci_031                -1.131023e-02 3 1  ON 30
ci_032                -1.328777e-02 3 1  ON 31
ci_033                 9.676218e-03 3 1  ON 32
ci_034                 9.898827e-03 3 1  ON 33
ci_035                -5.002167e-03 3 1  ON 34
ci_036                -1.082178e-02 3 1  ON 35
ci_037                -1.071178e-02 3 1  ON 36
ci_038                 1.023428e-03 3 1  ON 37
ci_039                 1.092563e-03 3 1  ON 38
ci_040                -4.200166e-03 3 1  ON 39
ci_041                 9.826308e-03 3 1  ON 40
ci_042                 9.949477e-03 3 1  ON 41
ci_043                -3.450045e-03 3 1  ON 42
ci_044                -1.571996e-02 3 1  ON 43
ci_045                -1.860824e-03 3 1  ON 44
ci_046                 5.595085e-03 3 1  ON 45
ci_047                 5.527027e-03 3 1  ON 46
ci_048                -1.169858e-02 3 1  ON 47
ci_049                -1.168545e-02 3 1  ON 48
ci_050                 7.265442e-03 3 1  ON 49
ci_051                 7.783177e-03 3 1  ON 50
ci_052                -5.876508e-03 3 1  ON 51
ci_053                -6.750487e-03 3 1  ON 52
ci_054                -2.127405e-03 3 1  ON 53
ci_055                -2.719940e-03 3 1  ON 54
ci_056                 5.115870e-03 3 1  ON 55
ci_057                 4.668163e-03 3 1  ON 56
ci_058                -7.068855e-03 3 1  ON 57
ci_059                -7.216937e-03 3 1  ON 58
ci_060                 8.322515e-03 3 1  ON 59
ci_061                 9.161567e-03 3 1  ON 60
ci_062                -3.061524e-03 3 1  ON 61
ci_063                -3.002083e-03 3 1  ON 62
ci_064                -3.292803e-03 3 1  ON 63
ci_065                -4.062204e-03 3 1  ON 64
ci_066                 5.823768e-03 3 1  ON 65
ci_067                 5.790231e-03 3 1  ON 66
ci_068                -5.497514e-03 3 1  ON 67
ci_069                -4.690259e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2236
    reference variance = 0.162399
====================================================
  Execution time = 1.4392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1403e-01
  Total weights = 1.956387963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297132889835
                                         uncertainty =       0.002251841086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297132889835
                                         uncertainty =       0.002251841086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385699324
  error estimate for blocks of size 2^( 2) =       0.000395494370
  error estimate for blocks of size 2^( 3) =       0.000404371115
  error estimate for blocks of size 2^( 4) =       0.000410827617
  error estimate for blocks of size 2^( 5) =       0.000415393136
  error estimate for blocks of size 2^( 6) =       0.000417442116
  error estimate for blocks of size 2^( 7) =       0.000420930439

      target function =                  N/A
              le_mean =     -17.216369224234
             les_mean =     296.717403543342
             stat err =       0.000416148327
             autocorr =       1.164122143008
              std dev =       0.545461215440
             le_variance =       0.297527937550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636922423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216369224285       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364801056       residual = 4.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374275686       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374371854       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216373832725       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 2.281837e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216369224285       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216366163331       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216370907559       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216371012474       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216370921771       residual = 2.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.674507e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216369224285       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367852845       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216369200398       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216369224099       residual = 4.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.119068e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6940e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.045356e-02 3 1  ON 0
ci_002                -3.105704e-02 3 1  ON 1
ci_003                -2.514567e-02 3 1  ON 2
ci_004                 2.101893e-02 3 1  ON 3
ci_005                 2.209225e-02 3 1  ON 4
ci_006                -1.986870e-02 3 1  ON 5
ci_007                -1.960154e-02 3 1  ON 6
ci_008                -1.861530e-02 3 1  ON 7
ci_009                -1.801924e-02 3 1  ON 8
ci_010                -1.740006e-02 3 1  ON 9
ci_011                -1.650556e-02 3 1  ON 10
ci_012                -1.607629e-02 3 1  ON 11
ci_013                -1.907346e-02 3 1  ON 12
ci_014                 1.453048e-02 3 1  ON 13
ci_015                 1.425499e-02 3 1  ON 14
ci_016                 1.626491e-02 3 1  ON 15
ci_017                 1.650426e-02 3 1  ON 16
ci_018                 1.383430e-02 3 1  ON 17
ci_019                 1.394355e-02 3 1  ON 18
ci_020                 1.369311e-02 3 1  ON 19
ci_021                 1.344844e-02 3 1  ON 20
ci_022                 1.191344e-02 3 1  ON 21
ci_023                 1.153172e-02 3 1  ON 22
ci_024                 1.112774e-02 3 1  ON 23
ci_025                 1.095678e-02 3 1  ON 24
ci_026                 1.227631e-02 3 1  ON 25
ci_027                 1.163712e-02 3 1  ON 26
ci_028                -1.441473e-02 3 1  ON 27
ci_029                -1.518976e-02 3 1  ON 28
ci_030                -1.070568e-02 3 1  ON 29
ci_031                -1.147211e-02 3 1  ON 30
ci_032                -1.319024e-02 3 1  ON 31
ci_033                 1.022273e-02 3 1  ON 32
ci_034                 1.047986e-02 3 1  ON 33
ci_035                -5.805317e-03 3 1  ON 34
ci_036                -1.091162e-02 3 1  ON 35
ci_037                -1.072687e-02 3 1  ON 36
ci_038                 1.277428e-03 3 1  ON 37
ci_039                 3.601465e-04 3 1  ON 38
ci_040                -5.874674e-03 3 1  ON 39
ci_041                 9.481507e-03 3 1  ON 40
ci_042                 9.828787e-03 3 1  ON 41
ci_043                -3.219335e-03 3 1  ON 42
ci_044                -1.500924e-02 3 1  ON 43
ci_045                -2.075837e-03 3 1  ON 44
ci_046                 5.624014e-03 3 1  ON 45
ci_047                 5.556069e-03 3 1  ON 46
ci_048                -1.113021e-02 3 1  ON 47
ci_049                -1.205215e-02 3 1  ON 48
ci_050                 7.831914e-03 3 1  ON 49
ci_051                 7.353316e-03 3 1  ON 50
ci_052                -6.749507e-03 3 1  ON 51
ci_053                -6.895809e-03 3 1  ON 52
ci_054                -2.198285e-03 3 1  ON 53
ci_055                -2.783051e-03 3 1  ON 54
ci_056                 5.124693e-03 3 1  ON 55
ci_057                 4.789772e-03 3 1  ON 56
ci_058                -7.388090e-03 3 1  ON 57
ci_059                -7.418721e-03 3 1  ON 58
ci_060                 8.712009e-03 3 1  ON 59
ci_061                 9.133354e-03 3 1  ON 60
ci_062                -3.398411e-03 3 1  ON 61
ci_063                -3.032229e-03 3 1  ON 62
ci_064                -3.173380e-03 3 1  ON 63
ci_065                -4.343357e-03 3 1  ON 64
ci_066                 5.683614e-03 3 1  ON 65
ci_067                 5.948319e-03 3 1  ON 66
ci_068                -4.991183e-03 3 1  ON 67
ci_069                -4.520206e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2394
    reference variance = 0.347748
====================================================
  Execution time = 1.4002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1481e-01
  Total weights = 1.9567e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.271397
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299865828561
                                         uncertainty =       0.002043761102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299865828561
                                         uncertainty =       0.002043761102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387227515
  error estimate for blocks of size 2^( 2) =       0.000396926925
  error estimate for blocks of size 2^( 3) =       0.000406370426
  error estimate for blocks of size 2^( 4) =       0.000412916020
  error estimate for blocks of size 2^( 5) =       0.000416799426
  error estimate for blocks of size 2^( 6) =       0.000419627776
  error estimate for blocks of size 2^( 7) =       0.000420022956

      target function =                  N/A
              le_mean =     -17.216284560996
             les_mean =     296.838523469679
             stat err =       0.000417341544
             autocorr =       1.161584531967
              std dev =       0.547622402819
             le_variance =       0.299890296069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300649755753
                                         uncertainty =       0.002075927925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300649755753
                                         uncertainty =       0.002075927925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387734137
  error estimate for blocks of size 2^( 2) =       0.000397428966
  error estimate for blocks of size 2^( 3) =       0.000406870903
  error estimate for blocks of size 2^( 4) =       0.000413395916
  error estimate for blocks of size 2^( 5) =       0.000417332622
  error estimate for blocks of size 2^( 6) =       0.000420249091
  error estimate for blocks of size 2^( 7) =       0.000420794400

      target function =                  N/A
              le_mean =     -17.216262561729
             les_mean =     296.716054213607
             stat err =       0.000417943007
             autocorr =       1.161892765393
              std dev =       0.548338875592
             le_variance =       0.300675522485

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.284217
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301499877387
                                         uncertainty =       0.002087070231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301499877387
                                         uncertainty =       0.002087070231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388281778
  error estimate for blocks of size 2^( 2) =       0.000397976311
  error estimate for blocks of size 2^( 3) =       0.000407405774
  error estimate for blocks of size 2^( 4) =       0.000413918410
  error estimate for blocks of size 2^( 5) =       0.000417846989
  error estimate for blocks of size 2^( 6) =       0.000420771025
  error estimate for blocks of size 2^( 7) =       0.000421297761

      target function =                  N/A
              le_mean =     -17.216293244078
             les_mean =     296.725217594444
             stat err =       0.000418458546
             autocorr =       1.161477668964
              std dev =       0.549113356621
             le_variance =       0.301525478420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299579107499
                                         uncertainty =       0.002051442560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299579107499
                                         uncertainty =       0.002051442560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387043083
  error estimate for blocks of size 2^( 2) =       0.000396750457
  error estimate for blocks of size 2^( 3) =       0.000406207507
  error estimate for blocks of size 2^( 4) =       0.000412748305
  error estimate for blocks of size 2^( 5) =       0.000416677378
  error estimate for blocks of size 2^( 6) =       0.000419566945
  error estimate for blocks of size 2^( 7) =       0.000420115464

      target function =                  N/A
              le_mean =     -17.216261935086
             les_mean =     296.729140024871
             stat err =       0.000417277023
             autocorr =       1.162332340543
              std dev =       0.547361577513
             le_variance =       0.299604696537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216284560996        initial
     6.1035e-02     6.1035e-01             2.2818e-03       -17.216262561729
     2.4414e-01     2.4414e+00             1.6745e-03       -17.216293244078  <--
     9.7656e-01     9.7656e+00             8.1191e-04       -17.216261935086

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3438e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.045356e-02 3 1  ON 0
ci_002                -3.105704e-02 3 1  ON 1
ci_003                -2.514567e-02 3 1  ON 2
ci_004                 2.101893e-02 3 1  ON 3
ci_005                 2.209225e-02 3 1  ON 4
ci_006                -1.986870e-02 3 1  ON 5
ci_007                -1.960154e-02 3 1  ON 6
ci_008                -1.861530e-02 3 1  ON 7
ci_009                -1.801924e-02 3 1  ON 8
ci_010                -1.740006e-02 3 1  ON 9
ci_011                -1.650556e-02 3 1  ON 10
ci_012                -1.607629e-02 3 1  ON 11
ci_013                -1.907346e-02 3 1  ON 12
ci_014                 1.453048e-02 3 1  ON 13
ci_015                 1.425499e-02 3 1  ON 14
ci_016                 1.626491e-02 3 1  ON 15
ci_017                 1.650426e-02 3 1  ON 16
ci_018                 1.383430e-02 3 1  ON 17
ci_019                 1.394355e-02 3 1  ON 18
ci_020                 1.369311e-02 3 1  ON 19
ci_021                 1.344844e-02 3 1  ON 20
ci_022                 1.191344e-02 3 1  ON 21
ci_023                 1.153172e-02 3 1  ON 22
ci_024                 1.112774e-02 3 1  ON 23
ci_025                 1.095678e-02 3 1  ON 24
ci_026                 1.227631e-02 3 1  ON 25
ci_027                 1.163712e-02 3 1  ON 26
ci_028                -1.441473e-02 3 1  ON 27
ci_029                -1.518976e-02 3 1  ON 28
ci_030                -1.070568e-02 3 1  ON 29
ci_031                -1.147211e-02 3 1  ON 30
ci_032                -1.319024e-02 3 1  ON 31
ci_033                 1.022273e-02 3 1  ON 32
ci_034                 1.047986e-02 3 1  ON 33
ci_035                -5.805317e-03 3 1  ON 34
ci_036                -1.091162e-02 3 1  ON 35
ci_037                -1.072687e-02 3 1  ON 36
ci_038                 1.277428e-03 3 1  ON 37
ci_039                 3.601465e-04 3 1  ON 38
ci_040                -5.874674e-03 3 1  ON 39
ci_041                 9.481507e-03 3 1  ON 40
ci_042                 9.828787e-03 3 1  ON 41
ci_043                -3.219335e-03 3 1  ON 42
ci_044                -1.500924e-02 3 1  ON 43
ci_045                -2.075837e-03 3 1  ON 44
ci_046                 5.624014e-03 3 1  ON 45
ci_047                 5.556069e-03 3 1  ON 46
ci_048                -1.113021e-02 3 1  ON 47
ci_049                -1.205215e-02 3 1  ON 48
ci_050                 7.831914e-03 3 1  ON 49
ci_051                 7.353316e-03 3 1  ON 50
ci_052                -6.749507e-03 3 1  ON 51
ci_053                -6.895809e-03 3 1  ON 52
ci_054                -2.198285e-03 3 1  ON 53
ci_055                -2.783051e-03 3 1  ON 54
ci_056                 5.124693e-03 3 1  ON 55
ci_057                 4.789772e-03 3 1  ON 56
ci_058                -7.388090e-03 3 1  ON 57
ci_059                -7.418721e-03 3 1  ON 58
ci_060                 8.712009e-03 3 1  ON 59
ci_061                 9.133354e-03 3 1  ON 60
ci_062                -3.398411e-03 3 1  ON 61
ci_063                -3.032229e-03 3 1  ON 62
ci_064                -3.173380e-03 3 1  ON 63
ci_065                -4.343357e-03 3 1  ON 64
ci_066                 5.683614e-03 3 1  ON 65
ci_067                 5.948319e-03 3 1  ON 66
ci_068                -4.991183e-03 3 1  ON 67
ci_069                -4.520206e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2868
    reference variance = 0.331943
====================================================
  Execution time = 1.4319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1401e-01
  Total weights = 1.956463592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297858341979
                                         uncertainty =       0.002345340974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297858341979
                                         uncertainty =       0.002345340974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385920433
  error estimate for blocks of size 2^( 2) =       0.000395656196
  error estimate for blocks of size 2^( 3) =       0.000404713582
  error estimate for blocks of size 2^( 4) =       0.000410645282
  error estimate for blocks of size 2^( 5) =       0.000414202833
  error estimate for blocks of size 2^( 6) =       0.000415730850
  error estimate for blocks of size 2^( 7) =       0.000418496694

      target function =                  N/A
              le_mean =     -17.216157936506
             les_mean =     296.710100646089
             stat err =       0.000414768915
             autocorr =       1.155092741504
              std dev =       0.545773909913
             le_variance =       0.297869160741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615793651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157936576       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216196298199       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216192874635       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216192935580       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216193374421       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.368365e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157936576       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216183873933       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182173400       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182170498       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 9.945699e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157936576       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169235821       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216168999869       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216169020820       residual = 2.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 4.785963e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6896e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.036855e-02 3 1  ON 0
ci_002                -3.149754e-02 3 1  ON 1
ci_003                -2.534847e-02 3 1  ON 2
ci_004                 2.131039e-02 3 1  ON 3
ci_005                 2.239295e-02 3 1  ON 4
ci_006                -2.006189e-02 3 1  ON 5
ci_007                -1.973382e-02 3 1  ON 6
ci_008                -1.884712e-02 3 1  ON 7
ci_009                -1.815594e-02 3 1  ON 8
ci_010                -1.691672e-02 3 1  ON 9
ci_011                -1.640699e-02 3 1  ON 10
ci_012                -1.612644e-02 3 1  ON 11
ci_013                -1.940026e-02 3 1  ON 12
ci_014                 1.433023e-02 3 1  ON 13
ci_015                 1.393435e-02 3 1  ON 14
ci_016                 1.622533e-02 3 1  ON 15
ci_017                 1.644083e-02 3 1  ON 16
ci_018                 1.324941e-02 3 1  ON 17
ci_019                 1.371265e-02 3 1  ON 18
ci_020                 1.417311e-02 3 1  ON 19
ci_021                 1.398182e-02 3 1  ON 20
ci_022                 1.188970e-02 3 1  ON 21
ci_023                 1.142196e-02 3 1  ON 22
ci_024                 1.131282e-02 3 1  ON 23
ci_025                 1.110867e-02 3 1  ON 24
ci_026                 1.155408e-02 3 1  ON 25
ci_027                 1.157109e-02 3 1  ON 26
ci_028                -1.412701e-02 3 1  ON 27
ci_029                -1.507150e-02 3 1  ON 28
ci_030                -1.073592e-02 3 1  ON 29
ci_031                -1.130281e-02 3 1  ON 30
ci_032                -1.311607e-02 3 1  ON 31
ci_033                 1.030526e-02 3 1  ON 32
ci_034                 1.037645e-02 3 1  ON 33
ci_035                -5.372662e-03 3 1  ON 34
ci_036                -1.104020e-02 3 1  ON 35
ci_037                -1.056490e-02 3 1  ON 36
ci_038                 8.886549e-04 3 1  ON 37
ci_039                 1.045599e-03 3 1  ON 38
ci_040                -4.880104e-03 3 1  ON 39
ci_041                 9.642338e-03 3 1  ON 40
ci_042                 9.977016e-03 3 1  ON 41
ci_043                -3.394694e-03 3 1  ON 42
ci_044                -1.458725e-02 3 1  ON 43
ci_045                -1.846331e-03 3 1  ON 44
ci_046                 5.811360e-03 3 1  ON 45
ci_047                 5.779914e-03 3 1  ON 46
ci_048                -1.158754e-02 3 1  ON 47
ci_049                -1.219195e-02 3 1  ON 48
ci_050                 7.720852e-03 3 1  ON 49
ci_051                 7.284349e-03 3 1  ON 50
ci_052                -6.698099e-03 3 1  ON 51
ci_053                -7.184938e-03 3 1  ON 52
ci_054                -2.344713e-03 3 1  ON 53
ci_055                -2.497741e-03 3 1  ON 54
ci_056                 5.552979e-03 3 1  ON 55
ci_057                 4.736074e-03 3 1  ON 56
ci_058                -7.694607e-03 3 1  ON 57
ci_059                -7.206885e-03 3 1  ON 58
ci_060                 8.211054e-03 3 1  ON 59
ci_061                 9.055741e-03 3 1  ON 60
ci_062                -3.310037e-03 3 1  ON 61
ci_063                -3.184637e-03 3 1  ON 62
ci_064                -3.516392e-03 3 1  ON 63
ci_065                -4.155079e-03 3 1  ON 64
ci_066                 5.852948e-03 3 1  ON 65
ci_067                 6.064222e-03 3 1  ON 66
ci_068                -5.211310e-03 3 1  ON 67
ci_069                -4.692801e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.3125
    reference variance = 0.869061
====================================================
  Execution time = 1.3805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1151e-01
  Total weights = 1.9565e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296022240342
                                         uncertainty =       0.002163287864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296022240342
                                         uncertainty =       0.002163287864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384767611
  error estimate for blocks of size 2^( 2) =       0.000394769650
  error estimate for blocks of size 2^( 3) =       0.000403388339
  error estimate for blocks of size 2^( 4) =       0.000410058971
  error estimate for blocks of size 2^( 5) =       0.000414048367
  error estimate for blocks of size 2^( 6) =       0.000416272340
  error estimate for blocks of size 2^( 7) =       0.000418607471

      target function =                  N/A
              le_mean =     -17.217439107385
             les_mean =     297.040674000760
             stat err =       0.000414746787
             autocorr =       1.161900789545
              std dev =       0.544143574049
             le_variance =       0.296092229178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294981967541
                                         uncertainty =       0.002119022868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294981967541
                                         uncertainty =       0.002119022868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384093513
  error estimate for blocks of size 2^( 2) =       0.000394101771
  error estimate for blocks of size 2^( 3) =       0.000402728887
  error estimate for blocks of size 2^( 4) =       0.000409403553
  error estimate for blocks of size 2^( 5) =       0.000413403824
  error estimate for blocks of size 2^( 6) =       0.000415698559
  error estimate for blocks of size 2^( 7) =       0.000417940809

      target function =                  N/A
              le_mean =     -17.217425125125
             les_mean =     296.753969909180
             stat err =       0.000414111686
             autocorr =       1.162414528960
              std dev =       0.543190254674
             le_variance =       0.295055652773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294938565474
                                         uncertainty =       0.002117187381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294938565474
                                         uncertainty =       0.002117187381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384067058
  error estimate for blocks of size 2^( 2) =       0.000394074855
  error estimate for blocks of size 2^( 3) =       0.000402708926
  error estimate for blocks of size 2^( 4) =       0.000409374077
  error estimate for blocks of size 2^( 5) =       0.000413385729
  error estimate for blocks of size 2^( 6) =       0.000415689981
  error estimate for blocks of size 2^( 7) =       0.000417915093

      target function =                  N/A
              le_mean =     -17.217440332273
             les_mean =     296.763549493125
             stat err =       0.000414091220
             autocorr =       1.162459760731
              std dev =       0.543152841669
             le_variance =       0.295015009413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295498978436
                                         uncertainty =       0.002140456467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295498978436
                                         uncertainty =       0.002140456467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384428406
  error estimate for blocks of size 2^( 2) =       0.000394431023
  error estimate for blocks of size 2^( 3) =       0.000403050426
  error estimate for blocks of size 2^( 4) =       0.000409734584
  error estimate for blocks of size 2^( 5) =       0.000413719208
  error estimate for blocks of size 2^( 6) =       0.000415985204
  error estimate for blocks of size 2^( 7) =       0.000418268862

      target function =                  N/A
              le_mean =     -17.217421826204
             les_mean =     296.757888892734
             stat err =       0.000414426964
             autocorr =       1.162157706636
              std dev =       0.543663866152
             le_variance =       0.295570399360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217439107385        initial
     6.1035e-02     6.1035e-01             1.3684e-03       -17.217425125125
     2.4414e-01     2.4414e+00             9.9457e-04       -17.217440332273  <--
     9.7656e-01     9.7656e+00             4.7860e-04       -17.217421826204

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3247e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.036855e-02 3 1  ON 0
ci_002                -3.149754e-02 3 1  ON 1
ci_003                -2.534847e-02 3 1  ON 2
ci_004                 2.131039e-02 3 1  ON 3
ci_005                 2.239295e-02 3 1  ON 4
ci_006                -2.006189e-02 3 1  ON 5
ci_007                -1.973382e-02 3 1  ON 6
ci_008                -1.884712e-02 3 1  ON 7
ci_009                -1.815594e-02 3 1  ON 8
ci_010                -1.691672e-02 3 1  ON 9
ci_011                -1.640699e-02 3 1  ON 10
ci_012                -1.612644e-02 3 1  ON 11
ci_013                -1.940026e-02 3 1  ON 12
ci_014                 1.433023e-02 3 1  ON 13
ci_015                 1.393435e-02 3 1  ON 14
ci_016                 1.622533e-02 3 1  ON 15
ci_017                 1.644083e-02 3 1  ON 16
ci_018                 1.324941e-02 3 1  ON 17
ci_019                 1.371265e-02 3 1  ON 18
ci_020                 1.417311e-02 3 1  ON 19
ci_021                 1.398182e-02 3 1  ON 20
ci_022                 1.188970e-02 3 1  ON 21
ci_023                 1.142196e-02 3 1  ON 22
ci_024                 1.131282e-02 3 1  ON 23
ci_025                 1.110867e-02 3 1  ON 24
ci_026                 1.155408e-02 3 1  ON 25
ci_027                 1.157109e-02 3 1  ON 26
ci_028                -1.412701e-02 3 1  ON 27
ci_029                -1.507150e-02 3 1  ON 28
ci_030                -1.073592e-02 3 1  ON 29
ci_031                -1.130281e-02 3 1  ON 30
ci_032                -1.311607e-02 3 1  ON 31
ci_033                 1.030526e-02 3 1  ON 32
ci_034                 1.037645e-02 3 1  ON 33
ci_035                -5.372662e-03 3 1  ON 34
ci_036                -1.104020e-02 3 1  ON 35
ci_037                -1.056490e-02 3 1  ON 36
ci_038                 8.886549e-04 3 1  ON 37
ci_039                 1.045599e-03 3 1  ON 38
ci_040                -4.880104e-03 3 1  ON 39
ci_041                 9.642338e-03 3 1  ON 40
ci_042                 9.977016e-03 3 1  ON 41
ci_043                -3.394694e-03 3 1  ON 42
ci_044                -1.458725e-02 3 1  ON 43
ci_045                -1.846331e-03 3 1  ON 44
ci_046                 5.811360e-03 3 1  ON 45
ci_047                 5.779914e-03 3 1  ON 46
ci_048                -1.158754e-02 3 1  ON 47
ci_049                -1.219195e-02 3 1  ON 48
ci_050                 7.720852e-03 3 1  ON 49
ci_051                 7.284349e-03 3 1  ON 50
ci_052                -6.698099e-03 3 1  ON 51
ci_053                -7.184938e-03 3 1  ON 52
ci_054                -2.344713e-03 3 1  ON 53
ci_055                -2.497741e-03 3 1  ON 54
ci_056                 5.552979e-03 3 1  ON 55
ci_057                 4.736074e-03 3 1  ON 56
ci_058                -7.694607e-03 3 1  ON 57
ci_059                -7.206885e-03 3 1  ON 58
ci_060                 8.211054e-03 3 1  ON 59
ci_061                 9.055741e-03 3 1  ON 60
ci_062                -3.310037e-03 3 1  ON 61
ci_063                -3.184637e-03 3 1  ON 62
ci_064                -3.516392e-03 3 1  ON 63
ci_065                -4.155079e-03 3 1  ON 64
ci_066                 5.852948e-03 3 1  ON 65
ci_067                 6.064222e-03 3 1  ON 66
ci_068                -5.211310e-03 3 1  ON 67
ci_069                -4.692801e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.196027
====================================================
  Execution time = 1.4488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1184e-01
  Total weights = 1.956764282e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297554261672
                                         uncertainty =       0.002112476712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297554261672
                                         uncertainty =       0.002112476712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385717761
  error estimate for blocks of size 2^( 2) =       0.000395652949
  error estimate for blocks of size 2^( 3) =       0.000404254099
  error estimate for blocks of size 2^( 4) =       0.000410665418
  error estimate for blocks of size 2^( 5) =       0.000414614030
  error estimate for blocks of size 2^( 6) =       0.000416224737
  error estimate for blocks of size 2^( 7) =       0.000416842962

      target function =                  N/A
              le_mean =     -17.216552668683
             les_mean =     296.721528122759
             stat err =       0.000414586787
             autocorr =       1.155291663744
              std dev =       0.545487288480
             le_variance =       0.297556381893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655266868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552668735       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579820558       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581035344       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216580697000       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216580691841       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.154166e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552668735       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216570445753       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216570583476       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216570392716       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 7.660957e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552668735       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216560134624       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216559977044       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216559929602       residual = 3.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.379607e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7034e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.050731e-02 3 1  ON 0
ci_002                -3.136027e-02 3 1  ON 1
ci_003                -2.598118e-02 3 1  ON 2
ci_004                 2.159577e-02 3 1  ON 3
ci_005                 2.224089e-02 3 1  ON 4
ci_006                -1.978477e-02 3 1  ON 5
ci_007                -1.981408e-02 3 1  ON 6
ci_008                -1.864107e-02 3 1  ON 7
ci_009                -1.780691e-02 3 1  ON 8
ci_010                -1.637799e-02 3 1  ON 9
ci_011                -1.647094e-02 3 1  ON 10
ci_012                -1.615475e-02 3 1  ON 11
ci_013                -1.922384e-02 3 1  ON 12
ci_014                 1.431156e-02 3 1  ON 13
ci_015                 1.445255e-02 3 1  ON 14
ci_016                 1.664377e-02 3 1  ON 15
ci_017                 1.689782e-02 3 1  ON 16
ci_018                 1.333658e-02 3 1  ON 17
ci_019                 1.349389e-02 3 1  ON 18
ci_020                 1.434529e-02 3 1  ON 19
ci_021                 1.395083e-02 3 1  ON 20
ci_022                 1.196242e-02 3 1  ON 21
ci_023                 1.150385e-02 3 1  ON 22
ci_024                 1.120062e-02 3 1  ON 23
ci_025                 1.122359e-02 3 1  ON 24
ci_026                 1.162732e-02 3 1  ON 25
ci_027                 1.220859e-02 3 1  ON 26
ci_028                -1.379711e-02 3 1  ON 27
ci_029                -1.496771e-02 3 1  ON 28
ci_030                -1.050521e-02 3 1  ON 29
ci_031                -1.131116e-02 3 1  ON 30
ci_032                -1.303907e-02 3 1  ON 31
ci_033                 1.079512e-02 3 1  ON 32
ci_034                 1.053862e-02 3 1  ON 33
ci_035                -5.287263e-03 3 1  ON 34
ci_036                -1.082210e-02 3 1  ON 35
ci_037                -1.047584e-02 3 1  ON 36
ci_038                 1.044645e-03 3 1  ON 37
ci_039                 1.322456e-03 3 1  ON 38
ci_040                -4.520017e-03 3 1  ON 39
ci_041                 9.525411e-03 3 1  ON 40
ci_042                 9.967089e-03 3 1  ON 41
ci_043                -3.615217e-03 3 1  ON 42
ci_044                -1.428890e-02 3 1  ON 43
ci_045                -1.935570e-03 3 1  ON 44
ci_046                 5.613224e-03 3 1  ON 45
ci_047                 5.503251e-03 3 1  ON 46
ci_048                -1.173988e-02 3 1  ON 47
ci_049                -1.239356e-02 3 1  ON 48
ci_050                 8.255628e-03 3 1  ON 49
ci_051                 7.573311e-03 3 1  ON 50
ci_052                -7.037902e-03 3 1  ON 51
ci_053                -6.829148e-03 3 1  ON 52
ci_054                -2.692271e-03 3 1  ON 53
ci_055                -2.541966e-03 3 1  ON 54
ci_056                 4.786883e-03 3 1  ON 55
ci_057                 5.131036e-03 3 1  ON 56
ci_058                -8.066250e-03 3 1  ON 57
ci_059                -6.896080e-03 3 1  ON 58
ci_060                 8.051590e-03 3 1  ON 59
ci_061                 9.445361e-03 3 1  ON 60
ci_062                -3.491904e-03 3 1  ON 61
ci_063                -2.935914e-03 3 1  ON 62
ci_064                -3.838794e-03 3 1  ON 63
ci_065                -4.242363e-03 3 1  ON 64
ci_066                 6.364131e-03 3 1  ON 65
ci_067                 5.838734e-03 3 1  ON 66
ci_068                -4.654448e-03 3 1  ON 67
ci_069                -4.396981e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.164583
====================================================
  Execution time = 1.3875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1356e-01
  Total weights = 1.9568e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298646127809
                                         uncertainty =       0.002546561548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298646127809
                                         uncertainty =       0.002546561548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386412026
  error estimate for blocks of size 2^( 2) =       0.000396185599
  error estimate for blocks of size 2^( 3) =       0.000405057411
  error estimate for blocks of size 2^( 4) =       0.000411506181
  error estimate for blocks of size 2^( 5) =       0.000415702485
  error estimate for blocks of size 2^( 6) =       0.000418809958
  error estimate for blocks of size 2^( 7) =       0.000420185422

      target function =                  N/A
              le_mean =     -17.216685270924
             les_mean =     296.736114062806
             stat err =       0.000416551011
             autocorr =       1.162077566887
              std dev =       0.546469128178
             le_variance =       0.298628508052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298997035724
                                         uncertainty =       0.002579233845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298997035724
                                         uncertainty =       0.002579233845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386638609
  error estimate for blocks of size 2^( 2) =       0.000396414268
  error estimate for blocks of size 2^( 3) =       0.000405287368
  error estimate for blocks of size 2^( 4) =       0.000411710192
  error estimate for blocks of size 2^( 5) =       0.000415875622
  error estimate for blocks of size 2^( 6) =       0.000418996935
  error estimate for blocks of size 2^( 7) =       0.000420397692

      target function =                  N/A
              le_mean =     -17.216675736446
             les_mean =     296.728469528235
             stat err =       0.000416745110
             autocorr =       1.161797897824
              std dev =       0.546789564844
             le_variance =       0.298978828222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259849280
                                         uncertainty =       0.002588863172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259849280
                                         uncertainty =       0.002588863172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386808410
  error estimate for blocks of size 2^( 2) =       0.000396582288
  error estimate for blocks of size 2^( 3) =       0.000405452995
  error estimate for blocks of size 2^( 4) =       0.000411863855
  error estimate for blocks of size 2^( 5) =       0.000416016199
  error estimate for blocks of size 2^( 6) =       0.000419145923
  error estimate for blocks of size 2^( 7) =       0.000420566483

      target function =                  N/A
              le_mean =     -17.216682679355
             les_mean =     296.733788684921
             stat err =       0.000416898115
             autocorr =       1.161630611117
              std dev =       0.547029699233
             le_variance =       0.299241491843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298682322312
                                         uncertainty =       0.002553052474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298682322312
                                         uncertainty =       0.002553052474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386435336
  error estimate for blocks of size 2^( 2) =       0.000396207332
  error estimate for blocks of size 2^( 3) =       0.000405078362
  error estimate for blocks of size 2^( 4) =       0.000411514381
  error estimate for blocks of size 2^( 5) =       0.000415697209
  error estimate for blocks of size 2^( 6) =       0.000418817658
  error estimate for blocks of size 2^( 7) =       0.000420197935

      target function =                  N/A
              le_mean =     -17.216676178469
             les_mean =     296.761110444487
             stat err =       0.000416556796
             autocorr =       1.161969647644
              std dev =       0.546502093529
             le_variance =       0.298664538231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216685270924        initial  <--
     6.1035e-02     6.1035e-01             1.1542e-03       -17.216675736446
     2.4414e-01     2.4414e+00             7.6610e-04       -17.216682679355
     9.7656e-01     9.7656e+00             3.3796e-04       -17.216676178469

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2664
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.036855e-02 3 1  ON 0
ci_002                -3.149754e-02 3 1  ON 1
ci_003                -2.534847e-02 3 1  ON 2
ci_004                 2.131039e-02 3 1  ON 3
ci_005                 2.239295e-02 3 1  ON 4
ci_006                -2.006189e-02 3 1  ON 5
ci_007                -1.973382e-02 3 1  ON 6
ci_008                -1.884712e-02 3 1  ON 7
ci_009                -1.815594e-02 3 1  ON 8
ci_010                -1.691672e-02 3 1  ON 9
ci_011                -1.640699e-02 3 1  ON 10
ci_012                -1.612644e-02 3 1  ON 11
ci_013                -1.940026e-02 3 1  ON 12
ci_014                 1.433023e-02 3 1  ON 13
ci_015                 1.393435e-02 3 1  ON 14
ci_016                 1.622533e-02 3 1  ON 15
ci_017                 1.644083e-02 3 1  ON 16
ci_018                 1.324941e-02 3 1  ON 17
ci_019                 1.371265e-02 3 1  ON 18
ci_020                 1.417311e-02 3 1  ON 19
ci_021                 1.398182e-02 3 1  ON 20
ci_022                 1.188970e-02 3 1  ON 21
ci_023                 1.142196e-02 3 1  ON 22
ci_024                 1.131282e-02 3 1  ON 23
ci_025                 1.110867e-02 3 1  ON 24
ci_026                 1.155408e-02 3 1  ON 25
ci_027                 1.157109e-02 3 1  ON 26
ci_028                -1.412701e-02 3 1  ON 27
ci_029                -1.507150e-02 3 1  ON 28
ci_030                -1.073592e-02 3 1  ON 29
ci_031                -1.130281e-02 3 1  ON 30
ci_032                -1.311607e-02 3 1  ON 31
ci_033                 1.030526e-02 3 1  ON 32
ci_034                 1.037645e-02 3 1  ON 33
ci_035                -5.372662e-03 3 1  ON 34
ci_036                -1.104020e-02 3 1  ON 35
ci_037                -1.056490e-02 3 1  ON 36
ci_038                 8.886549e-04 3 1  ON 37
ci_039                 1.045599e-03 3 1  ON 38
ci_040                -4.880104e-03 3 1  ON 39
ci_041                 9.642338e-03 3 1  ON 40
ci_042                 9.977016e-03 3 1  ON 41
ci_043                -3.394694e-03 3 1  ON 42
ci_044                -1.458725e-02 3 1  ON 43
ci_045                -1.846331e-03 3 1  ON 44
ci_046                 5.811360e-03 3 1  ON 45
ci_047                 5.779914e-03 3 1  ON 46
ci_048                -1.158754e-02 3 1  ON 47
ci_049                -1.219195e-02 3 1  ON 48
ci_050                 7.720852e-03 3 1  ON 49
ci_051                 7.284349e-03 3 1  ON 50
ci_052                -6.698099e-03 3 1  ON 51
ci_053                -7.184938e-03 3 1  ON 52
ci_054                -2.344713e-03 3 1  ON 53
ci_055                -2.497741e-03 3 1  ON 54
ci_056                 5.552979e-03 3 1  ON 55
ci_057                 4.736074e-03 3 1  ON 56
ci_058                -7.694607e-03 3 1  ON 57
ci_059                -7.206885e-03 3 1  ON 58
ci_060                 8.211054e-03 3 1  ON 59
ci_061                 9.055741e-03 3 1  ON 60
ci_062                -3.310037e-03 3 1  ON 61
ci_063                -3.184637e-03 3 1  ON 62
ci_064                -3.516392e-03 3 1  ON 63
ci_065                -4.155079e-03 3 1  ON 64
ci_066                 5.852948e-03 3 1  ON 65
ci_067                 6.064222e-03 3 1  ON 66
ci_068                -5.211310e-03 3 1  ON 67
ci_069                -4.692801e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2346
    reference variance = 0.332448
====================================================
  Execution time = 1.4409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1360e-01
  Total weights = 1.956442253e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299726187132
                                         uncertainty =       0.001971470150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299726187132
                                         uncertainty =       0.001971470150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387169881
  error estimate for blocks of size 2^( 2) =       0.000397075379
  error estimate for blocks of size 2^( 3) =       0.000405592805
  error estimate for blocks of size 2^( 4) =       0.000412481934
  error estimate for blocks of size 2^( 5) =       0.000415492477
  error estimate for blocks of size 2^( 6) =       0.000417026027
  error estimate for blocks of size 2^( 7) =       0.000419843422

      target function =                  N/A
              le_mean =     -17.216760037954
             les_mean =     296.730422390988
             stat err =       0.000416210965
             autocorr =       1.155643564199
              std dev =       0.547540896441
             le_variance =       0.299801033275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676003795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760038003       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216767733883       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216767848384       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216767881760       residual = 5.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 5.414472e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760038003       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762502073       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216762547659       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216762545541       residual = 1.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.671808e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760038003       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760700516       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216760714270       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760713004       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 4.439562e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6963e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.038345e-02 3 1  ON 0
ci_002                -3.150006e-02 3 1  ON 1
ci_003                -2.528772e-02 3 1  ON 2
ci_004                 2.131609e-02 3 1  ON 3
ci_005                 2.237534e-02 3 1  ON 4
ci_006                -2.004392e-02 3 1  ON 5
ci_007                -1.977190e-02 3 1  ON 6
ci_008                -1.877886e-02 3 1  ON 7
ci_009                -1.808768e-02 3 1  ON 8
ci_010                -1.687333e-02 3 1  ON 9
ci_011                -1.657417e-02 3 1  ON 10
ci_012                -1.612114e-02 3 1  ON 11
ci_013                -1.936006e-02 3 1  ON 12
ci_014                 1.433890e-02 3 1  ON 13
ci_015                 1.396039e-02 3 1  ON 14
ci_016                 1.619556e-02 3 1  ON 15
ci_017                 1.647715e-02 3 1  ON 16
ci_018                 1.317655e-02 3 1  ON 17
ci_019                 1.367877e-02 3 1  ON 18
ci_020                 1.404762e-02 3 1  ON 19
ci_021                 1.398411e-02 3 1  ON 20
ci_022                 1.173122e-02 3 1  ON 21
ci_023                 1.144049e-02 3 1  ON 22
ci_024                 1.130020e-02 3 1  ON 23
ci_025                 1.109445e-02 3 1  ON 24
ci_026                 1.154000e-02 3 1  ON 25
ci_027                 1.158536e-02 3 1  ON 26
ci_028                -1.413321e-02 3 1  ON 27
ci_029                -1.503175e-02 3 1  ON 28
ci_030                -1.076311e-02 3 1  ON 29
ci_031                -1.126521e-02 3 1  ON 30
ci_032                -1.317805e-02 3 1  ON 31
ci_033                 1.030476e-02 3 1  ON 32
ci_034                 1.037005e-02 3 1  ON 33
ci_035                -5.329991e-03 3 1  ON 34
ci_036                -1.098580e-02 3 1  ON 35
ci_037                -1.053837e-02 3 1  ON 36
ci_038                 8.924921e-04 3 1  ON 37
ci_039                 1.029299e-03 3 1  ON 38
ci_040                -4.785980e-03 3 1  ON 39
ci_041                 9.640668e-03 3 1  ON 40
ci_042                 9.904261e-03 3 1  ON 41
ci_043                -3.422507e-03 3 1  ON 42
ci_044                -1.466010e-02 3 1  ON 43
ci_045                -1.812615e-03 3 1  ON 44
ci_046                 5.765755e-03 3 1  ON 45
ci_047                 5.755417e-03 3 1  ON 46
ci_048                -1.154632e-02 3 1  ON 47
ci_049                -1.216806e-02 3 1  ON 48
ci_050                 7.757871e-03 3 1  ON 49
ci_051                 7.365727e-03 3 1  ON 50
ci_052                -6.694778e-03 3 1  ON 51
ci_053                -7.152616e-03 3 1  ON 52
ci_054                -2.347561e-03 3 1  ON 53
ci_055                -2.493511e-03 3 1  ON 54
ci_056                 5.498388e-03 3 1  ON 55
ci_057                 4.805406e-03 3 1  ON 56
ci_058                -7.608202e-03 3 1  ON 57
ci_059                -7.199812e-03 3 1  ON 58
ci_060                 8.292275e-03 3 1  ON 59
ci_061                 9.097599e-03 3 1  ON 60
ci_062                -3.255289e-03 3 1  ON 61
ci_063                -3.138269e-03 3 1  ON 62
ci_064                -3.528662e-03 3 1  ON 63
ci_065                -4.187316e-03 3 1  ON 64
ci_066                 5.829128e-03 3 1  ON 65
ci_067                 6.095979e-03 3 1  ON 66
ci_068                -5.162562e-03 3 1  ON 67
ci_069                -4.665138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.222094
====================================================
  Execution time = 1.3791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1304e-01
  Total weights = 1.9566e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298809396046
                                         uncertainty =       0.001863167883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298809396046
                                         uncertainty =       0.001863167883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469638
  error estimate for blocks of size 2^( 2) =       0.000396422958
  error estimate for blocks of size 2^( 3) =       0.000405056374
  error estimate for blocks of size 2^( 4) =       0.000411556995
  error estimate for blocks of size 2^( 5) =       0.000415797603
  error estimate for blocks of size 2^( 6) =       0.000419008327
  error estimate for blocks of size 2^( 7) =       0.000419398544

      target function =                  N/A
              le_mean =     -17.216969711874
             les_mean =     296.737337729239
             stat err =       0.000416440367
             autocorr =       1.161114052762
              std dev =       0.546550603520
             le_variance =       0.298717562208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298648619857
                                         uncertainty =       0.001858071226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298648619857
                                         uncertainty =       0.001858071226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386365362
  error estimate for blocks of size 2^( 2) =       0.000396319710
  error estimate for blocks of size 2^( 3) =       0.000404967357
  error estimate for blocks of size 2^( 4) =       0.000411481651
  error estimate for blocks of size 2^( 5) =       0.000415723064
  error estimate for blocks of size 2^( 6) =       0.000418949370
  error estimate for blocks of size 2^( 7) =       0.000419351907

      target function =                  N/A
              le_mean =     -17.216973358653
             les_mean =     296.737058486514
             stat err =       0.000416376498
             autocorr =       1.161384557167
              std dev =       0.546403134899
             le_variance =       0.298556385828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298685194011
                                         uncertainty =       0.001859537261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298685194011
                                         uncertainty =       0.001859537261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386389125
  error estimate for blocks of size 2^( 2) =       0.000396343241
  error estimate for blocks of size 2^( 3) =       0.000404986772
  error estimate for blocks of size 2^( 4) =       0.000411496769
  error estimate for blocks of size 2^( 5) =       0.000415737796
  error estimate for blocks of size 2^( 6) =       0.000418959015
  error estimate for blocks of size 2^( 7) =       0.000419356884

      target function =                  N/A
              le_mean =     -17.216971214197
             les_mean =     296.740548433839
             stat err =       0.000416387616
             autocorr =       1.161303725081
              std dev =       0.546436741192
             le_variance =       0.298593112124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298790265681
                                         uncertainty =       0.001862639363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298790265681
                                         uncertainty =       0.001862639363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386457242
  error estimate for blocks of size 2^( 2) =       0.000396410671
  error estimate for blocks of size 2^( 3) =       0.000405045404
  error estimate for blocks of size 2^( 4) =       0.000411547283
  error estimate for blocks of size 2^( 5) =       0.000415787880
  error estimate for blocks of size 2^( 6) =       0.000419000027
  error estimate for blocks of size 2^( 7) =       0.000419391260

      target function =                  N/A
              le_mean =     -17.216969649918
             les_mean =     296.737193440440
             stat err =       0.000416431613
             autocorr =       1.161139719232
              std dev =       0.546533073131
             le_variance =       0.298698400026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216969711874        initial
     6.1035e-01     6.1035e+00             5.4145e-04       -17.216973358653  <--
     2.4414e+00     2.4414e+01             1.6718e-04       -17.216971214197
     9.7656e+00     9.7656e+01             4.4396e-05       -17.216969649918

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.3301e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.041921e-02 3 1  ON 0
ci_002                -3.151183e-02 3 1  ON 1
ci_003                -2.515310e-02 3 1  ON 2
ci_004                 2.132985e-02 3 1  ON 3
ci_005                 2.233990e-02 3 1  ON 4
ci_006                -2.000512e-02 3 1  ON 5
ci_007                -1.986086e-02 3 1  ON 6
ci_008                -1.864125e-02 3 1  ON 7
ci_009                -1.794744e-02 3 1  ON 8
ci_010                -1.677528e-02 3 1  ON 9
ci_011                -1.694844e-02 3 1  ON 10
ci_012                -1.610907e-02 3 1  ON 11
ci_013                -1.926452e-02 3 1  ON 12
ci_014                 1.436137e-02 3 1  ON 13
ci_015                 1.401989e-02 3 1  ON 14
ci_016                 1.613183e-02 3 1  ON 15
ci_017                 1.656316e-02 3 1  ON 16
ci_018                 1.302567e-02 3 1  ON 17
ci_019                 1.360765e-02 3 1  ON 18
ci_020                 1.376210e-02 3 1  ON 19
ci_021                 1.399424e-02 3 1  ON 20
ci_022                 1.139369e-02 3 1  ON 21
ci_023                 1.148320e-02 3 1  ON 22
ci_024                 1.126972e-02 3 1  ON 23
ci_025                 1.105851e-02 3 1  ON 24
ci_026                 1.151296e-02 3 1  ON 25
ci_027                 1.161615e-02 3 1  ON 26
ci_028                -1.415521e-02 3 1  ON 27
ci_029                -1.494516e-02 3 1  ON 28
ci_030                -1.082330e-02 3 1  ON 29
ci_031                -1.118719e-02 3 1  ON 30
ci_032                -1.330409e-02 3 1  ON 31
ci_033                 1.030490e-02 3 1  ON 32
ci_034                 1.035649e-02 3 1  ON 33
ci_035                -5.251758e-03 3 1  ON 34
ci_036                -1.086409e-02 3 1  ON 35
ci_037                -1.048182e-02 3 1  ON 36
ci_038                 9.010233e-04 3 1  ON 37
ci_039                 1.000673e-03 3 1  ON 38
ci_040                -4.619361e-03 3 1  ON 39
ci_041                 9.639986e-03 3 1  ON 40
ci_042                 9.754113e-03 3 1  ON 41
ci_043                -3.475546e-03 3 1  ON 42
ci_044                -1.484002e-02 3 1  ON 43
ci_045                -1.752482e-03 3 1  ON 44
ci_046                 5.670965e-03 3 1  ON 45
ci_047                 5.704048e-03 3 1  ON 46
ci_048                -1.144795e-02 3 1  ON 47
ci_049                -1.211440e-02 3 1  ON 48
ci_050                 7.828219e-03 3 1  ON 49
ci_051                 7.522353e-03 3 1  ON 50
ci_052                -6.688856e-03 3 1  ON 51
ci_053                -7.087658e-03 3 1  ON 52
ci_054                -2.355528e-03 3 1  ON 53
ci_055                -2.487662e-03 3 1  ON 54
ci_056                 5.393937e-03 3 1  ON 55
ci_057                 4.940934e-03 3 1  ON 56
ci_058                -7.434603e-03 3 1  ON 57
ci_059                -7.184996e-03 3 1  ON 58
ci_060                 8.466427e-03 3 1  ON 59
ci_061                 9.193243e-03 3 1  ON 60
ci_062                -3.143385e-03 3 1  ON 61
ci_063                -3.044031e-03 3 1  ON 62
ci_064                -3.550865e-03 3 1  ON 63
ci_065                -4.240402e-03 3 1  ON 64
ci_066                 5.784428e-03 3 1  ON 65
ci_067                 6.157979e-03 3 1  ON 66
ci_068                -5.062574e-03 3 1  ON 67
ci_069                -4.611478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0280e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2619
    reference variance = 0.311573
====================================================
  Execution time = 1.4448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1108e-01
  Total weights = 1.956950902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390949794
                                         uncertainty =       0.001688862161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390949794
                                         uncertainty =       0.001688862161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385626279
  error estimate for blocks of size 2^( 2) =       0.000395668127
  error estimate for blocks of size 2^( 3) =       0.000403989169
  error estimate for blocks of size 2^( 4) =       0.000410512430
  error estimate for blocks of size 2^( 5) =       0.000415215965
  error estimate for blocks of size 2^( 6) =       0.000416153430
  error estimate for blocks of size 2^( 7) =       0.000415178530

      target function =                  N/A
              le_mean =     -17.216658172280
             les_mean =     296.724399031655
             stat err =       0.000414265089
             autocorr =       1.154046819415
              std dev =       0.545357913408
             le_variance =       0.297415253717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665817228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658172349       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216654201739       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216655376714       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216655117709       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 8.742474e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658172349       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216656292885       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216656638656       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216656585162       residual = 2.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.571400e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658172349       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216657567363       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216657626586       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.570119e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7002e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.070784e-02 3 1  ON 0
ci_002                -3.125536e-02 3 1  ON 1
ci_003                -2.521503e-02 3 1  ON 2
ci_004                 2.143006e-02 3 1  ON 3
ci_005                 2.203551e-02 3 1  ON 4
ci_006                -1.994594e-02 3 1  ON 5
ci_007                -1.971748e-02 3 1  ON 6
ci_008                -1.864997e-02 3 1  ON 7
ci_009                -1.765680e-02 3 1  ON 8
ci_010                -1.695164e-02 3 1  ON 9
ci_011                -1.697207e-02 3 1  ON 10
ci_012                -1.630607e-02 3 1  ON 11
ci_013                -1.894270e-02 3 1  ON 12
ci_014                 1.447665e-02 3 1  ON 13
ci_015                 1.408060e-02 3 1  ON 14
ci_016                 1.608739e-02 3 1  ON 15
ci_017                 1.661230e-02 3 1  ON 16
ci_018                 1.313875e-02 3 1  ON 17
ci_019                 1.361443e-02 3 1  ON 18
ci_020                 1.404333e-02 3 1  ON 19
ci_021                 1.381566e-02 3 1  ON 20
ci_022                 1.143915e-02 3 1  ON 21
ci_023                 1.146682e-02 3 1  ON 22
ci_024                 1.136914e-02 3 1  ON 23
ci_025                 1.102701e-02 3 1  ON 24
ci_026                 1.140492e-02 3 1  ON 25
ci_027                 1.172576e-02 3 1  ON 26
ci_028                -1.418844e-02 3 1  ON 27
ci_029                -1.497968e-02 3 1  ON 28
ci_030                -1.096800e-02 3 1  ON 29
ci_031                -1.096846e-02 3 1  ON 30
ci_032                -1.345678e-02 3 1  ON 31
ci_033                 1.022286e-02 3 1  ON 32
ci_034                 1.055175e-02 3 1  ON 33
ci_035                -5.322796e-03 3 1  ON 34
ci_036                -1.117275e-02 3 1  ON 35
ci_037                -1.084064e-02 3 1  ON 36
ci_038                 1.092318e-03 3 1  ON 37
ci_039                 9.722285e-04 3 1  ON 38
ci_040                -4.594252e-03 3 1  ON 39
ci_041                 9.567004e-03 3 1  ON 40
ci_042                 9.850147e-03 3 1  ON 41
ci_043                -3.420099e-03 3 1  ON 42
ci_044                -1.477847e-02 3 1  ON 43
ci_045                -1.750467e-03 3 1  ON 44
ci_046                 5.571065e-03 3 1  ON 45
ci_047                 5.767344e-03 3 1  ON 46
ci_048                -1.166445e-02 3 1  ON 47
ci_049                -1.217797e-02 3 1  ON 48
ci_050                 7.371079e-03 3 1  ON 49
ci_051                 7.824726e-03 3 1  ON 50
ci_052                -6.744293e-03 3 1  ON 51
ci_053                -7.073962e-03 3 1  ON 52
ci_054                -2.186884e-03 3 1  ON 53
ci_055                -2.493120e-03 3 1  ON 54
ci_056                 5.288553e-03 3 1  ON 55
ci_057                 5.390081e-03 3 1  ON 56
ci_058                -7.390443e-03 3 1  ON 57
ci_059                -7.170729e-03 3 1  ON 58
ci_060                 8.596238e-03 3 1  ON 59
ci_061                 8.962592e-03 3 1  ON 60
ci_062                -3.107744e-03 3 1  ON 61
ci_063                -3.164343e-03 3 1  ON 62
ci_064                -3.374483e-03 3 1  ON 63
ci_065                -4.211374e-03 3 1  ON 64
ci_066                 5.684338e-03 3 1  ON 65
ci_067                 6.093008e-03 3 1  ON 66
ci_068                -4.877749e-03 3 1  ON 67
ci_069                -4.622486e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1535
    reference variance = 0.349248
====================================================
  Execution time = 1.3779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1971e-01
  Total weights = 1.9569e+06
  Execution time = 1.8710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302957347749
                                         uncertainty =       0.003331816118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302957347749
                                         uncertainty =       0.003331816118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389176553
  error estimate for blocks of size 2^( 2) =       0.000399349766
  error estimate for blocks of size 2^( 3) =       0.000407849634
  error estimate for blocks of size 2^( 4) =       0.000414269097
  error estimate for blocks of size 2^( 5) =       0.000418490825
  error estimate for blocks of size 2^( 6) =       0.000419379701
  error estimate for blocks of size 2^( 7) =       0.000421306930

      target function =                  N/A
              le_mean =     -17.216368779013
             les_mean =     296.724437261654
             stat err =       0.000418361638
             autocorr =       1.155607561292
              std dev =       0.550378759752
             le_variance =       0.302916779187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302555550177
                                         uncertainty =       0.003270548317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302555550177
                                         uncertainty =       0.003270548317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388917892
  error estimate for blocks of size 2^( 2) =       0.000399096663
  error estimate for blocks of size 2^( 3) =       0.000407599237
  error estimate for blocks of size 2^( 4) =       0.000414048151
  error estimate for blocks of size 2^( 5) =       0.000418236776
  error estimate for blocks of size 2^( 6) =       0.000419117531
  error estimate for blocks of size 2^( 7) =       0.000420989336

      target function =                  N/A
              le_mean =     -17.216391361094
             les_mean =     296.724779652063
             stat err =       0.000418097948
             autocorr =       1.155686994228
              std dev =       0.550012958025
             le_variance =       0.302514253995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302557818850
                                         uncertainty =       0.003273539133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302557818850
                                         uncertainty =       0.003273539133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388919179
  error estimate for blocks of size 2^( 2) =       0.000399100099
  error estimate for blocks of size 2^( 3) =       0.000407602776
  error estimate for blocks of size 2^( 4) =       0.000414049225
  error estimate for blocks of size 2^( 5) =       0.000418242935
  error estimate for blocks of size 2^( 6) =       0.000419117008
  error estimate for blocks of size 2^( 7) =       0.000420988015

      target function =                  N/A
              le_mean =     -17.216387851875
             les_mean =     296.724639987886
             stat err =       0.000418099296
             autocorr =       1.155686795343
              std dev =       0.550014777796
             le_variance =       0.302516255794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302864419110
                                         uncertainty =       0.003321245622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302864419110
                                         uncertainty =       0.003321245622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389116734
  error estimate for blocks of size 2^( 2) =       0.000399291578
  error estimate for blocks of size 2^( 3) =       0.000407792517
  error estimate for blocks of size 2^( 4) =       0.000414217534
  error estimate for blocks of size 2^( 5) =       0.000418434185
  error estimate for blocks of size 2^( 6) =       0.000419320452
  error estimate for blocks of size 2^( 7) =       0.000421236461

      target function =                  N/A
              le_mean =     -17.216368692269
             les_mean =     296.724183476842
             stat err =       0.000418302158
             autocorr =       1.155634219595
              std dev =       0.550294163156
             le_variance =       0.302823666003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216368779013        initial
     1.5259e-01     1.5259e+00             8.7425e-04       -17.216391361094  <--
     6.1035e-01     6.1035e+00             4.5714e-04       -17.216387851875
     2.4414e+00     2.4414e+01             1.5701e-04       -17.216368692269

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.3214e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.109861e-02 3 1  ON 0
ci_002                -3.094158e-02 3 1  ON 1
ci_003                -2.533583e-02 3 1  ON 2
ci_004                 2.154998e-02 3 1  ON 3
ci_005                 2.157006e-02 3 1  ON 4
ci_006                -1.988084e-02 3 1  ON 5
ci_007                -1.951346e-02 3 1  ON 6
ci_008                -1.866608e-02 3 1  ON 7
ci_009                -1.735298e-02 3 1  ON 8
ci_010                -1.720192e-02 3 1  ON 9
ci_011                -1.696575e-02 3 1  ON 10
ci_012                -1.653740e-02 3 1  ON 11
ci_013                -1.847090e-02 3 1  ON 12
ci_014                 1.460725e-02 3 1  ON 13
ci_015                 1.416645e-02 3 1  ON 14
ci_016                 1.602983e-02 3 1  ON 15
ci_017                 1.667440e-02 3 1  ON 16
ci_018                 1.327322e-02 3 1  ON 17
ci_019                 1.362099e-02 3 1  ON 18
ci_020                 1.441317e-02 3 1  ON 19
ci_021                 1.356608e-02 3 1  ON 20
ci_022                 1.150137e-02 3 1  ON 21
ci_023                 1.145076e-02 3 1  ON 22
ci_024                 1.154126e-02 3 1  ON 23
ci_025                 1.099970e-02 3 1  ON 24
ci_026                 1.126713e-02 3 1  ON 25
ci_027                 1.185867e-02 3 1  ON 26
ci_028                -1.422896e-02 3 1  ON 27
ci_029                -1.501923e-02 3 1  ON 28
ci_030                -1.113637e-02 3 1  ON 29
ci_031                -1.069376e-02 3 1  ON 30
ci_032                -1.362476e-02 3 1  ON 31
ci_033                 1.012196e-02 3 1  ON 32
ci_034                 1.079636e-02 3 1  ON 33
ci_035                -5.377929e-03 3 1  ON 34
ci_036                -1.155224e-02 3 1  ON 35
ci_037                -1.127757e-02 3 1  ON 36
ci_038                 1.247717e-03 3 1  ON 37
ci_039                 9.540005e-04 3 1  ON 38
ci_040                -4.574340e-03 3 1  ON 39
ci_041                 9.487898e-03 3 1  ON 40
ci_042                 9.962166e-03 3 1  ON 41
ci_043                -3.371162e-03 3 1  ON 42
ci_044                -1.469579e-02 3 1  ON 43
ci_045                -1.753970e-03 3 1  ON 44
ci_046                 5.452752e-03 3 1  ON 45
ci_047                 5.834788e-03 3 1  ON 46
ci_048                -1.196390e-02 3 1  ON 47
ci_049                -1.225222e-02 3 1  ON 48
ci_050                 6.953971e-03 3 1  ON 49
ci_051                 8.109711e-03 3 1  ON 50
ci_052                -6.804508e-03 3 1  ON 51
ci_053                -7.067426e-03 3 1  ON 52
ci_054                -2.012904e-03 3 1  ON 53
ci_055                -2.499073e-03 3 1  ON 54
ci_056                 5.187694e-03 3 1  ON 55
ci_057                 5.814469e-03 3 1  ON 56
ci_058                -7.341865e-03 3 1  ON 57
ci_059                -7.154467e-03 3 1  ON 58
ci_060                 8.748177e-03 3 1  ON 59
ci_061                 8.676279e-03 3 1  ON 60
ci_062                -3.070860e-03 3 1  ON 61
ci_063                -3.293025e-03 3 1  ON 62
ci_064                -3.250425e-03 3 1  ON 63
ci_065                -4.190458e-03 3 1  ON 64
ci_066                 5.588177e-03 3 1  ON 65
ci_067                 6.032227e-03 3 1  ON 66
ci_068                -4.665874e-03 3 1  ON 67
ci_069                -4.635538e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0231e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.292
    reference variance = 0.249849
====================================================
  Execution time = 1.4188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1529e-01
  Total weights = 1.956909936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301334421464
                                         uncertainty =       0.002476744914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301334421464
                                         uncertainty =       0.002476744914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388144856
  error estimate for blocks of size 2^( 2) =       0.000398007114
  error estimate for blocks of size 2^( 3) =       0.000407248736
  error estimate for blocks of size 2^( 4) =       0.000413280994
  error estimate for blocks of size 2^( 5) =       0.000417825611
  error estimate for blocks of size 2^( 6) =       0.000420300362
  error estimate for blocks of size 2^( 7) =       0.000423300190

      target function =                  N/A
              le_mean =     -17.216551889530
             les_mean =     296.724948073295
             stat err =       0.000418676790
             autocorr =       1.163509944798
              std dev =       0.548919720150
             le_variance =       0.301312859169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655188953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551889584       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216572334557       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216573234449       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216572891504       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216572951258       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.282433e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551889584       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566672670       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567357297       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567222549       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 8.399028e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551889584       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216558903315       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216559403072       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216559377630       residual = 3.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.567339e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6750e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.150589e-02 3 1  ON 0
ci_002                -3.109031e-02 3 1  ON 1
ci_003                -2.575714e-02 3 1  ON 2
ci_004                 2.073336e-02 3 1  ON 3
ci_005                 2.159188e-02 3 1  ON 4
ci_006                -2.014870e-02 3 1  ON 5
ci_007                -1.932297e-02 3 1  ON 6
ci_008                -1.880041e-02 3 1  ON 7
ci_009                -1.770947e-02 3 1  ON 8
ci_010                -1.676794e-02 3 1  ON 9
ci_011                -1.632398e-02 3 1  ON 10
ci_012                -1.590601e-02 3 1  ON 11
ci_013                -1.871343e-02 3 1  ON 12
ci_014                 1.446993e-02 3 1  ON 13
ci_015                 1.414434e-02 3 1  ON 14
ci_016                 1.592374e-02 3 1  ON 15
ci_017                 1.644316e-02 3 1  ON 16
ci_018                 1.336252e-02 3 1  ON 17
ci_019                 1.330660e-02 3 1  ON 18
ci_020                 1.378709e-02 3 1  ON 19
ci_021                 1.288420e-02 3 1  ON 20
ci_022                 1.214080e-02 3 1  ON 21
ci_023                 1.210839e-02 3 1  ON 22
ci_024                 1.163361e-02 3 1  ON 23
ci_025                 1.129620e-02 3 1  ON 24
ci_026                 1.155341e-02 3 1  ON 25
ci_027                 1.168704e-02 3 1  ON 26
ci_028                -1.451286e-02 3 1  ON 27
ci_029                -1.540879e-02 3 1  ON 28
ci_030                -1.106403e-02 3 1  ON 29
ci_031                -1.102619e-02 3 1  ON 30
ci_032                -1.357280e-02 3 1  ON 31
ci_033                 1.022891e-02 3 1  ON 32
ci_034                 1.013448e-02 3 1  ON 33
ci_035                -5.027577e-03 3 1  ON 34
ci_036                -1.171981e-02 3 1  ON 35
ci_037                -1.105731e-02 3 1  ON 36
ci_038                 1.038871e-03 3 1  ON 37
ci_039                 1.470025e-03 3 1  ON 38
ci_040                -4.412514e-03 3 1  ON 39
ci_041                 9.576636e-03 3 1  ON 40
ci_042                 1.046818e-02 3 1  ON 41
ci_043                -3.166564e-03 3 1  ON 42
ci_044                -1.520473e-02 3 1  ON 43
ci_045                -1.384256e-03 3 1  ON 44
ci_046                 5.290362e-03 3 1  ON 45
ci_047                 5.712704e-03 3 1  ON 46
ci_048                -1.218573e-02 3 1  ON 47
ci_049                -1.141231e-02 3 1  ON 48
ci_050                 7.566514e-03 3 1  ON 49
ci_051                 8.027646e-03 3 1  ON 50
ci_052                -7.081877e-03 3 1  ON 51
ci_053                -7.193866e-03 3 1  ON 52
ci_054                -2.017182e-03 3 1  ON 53
ci_055                -2.234042e-03 3 1  ON 54
ci_056                 4.671123e-03 3 1  ON 55
ci_057                 5.163796e-03 3 1  ON 56
ci_058                -7.376277e-03 3 1  ON 57
ci_059                -7.185203e-03 3 1  ON 58
ci_060                 9.217087e-03 3 1  ON 59
ci_061                 8.934844e-03 3 1  ON 60
ci_062                -2.839381e-03 3 1  ON 61
ci_063                -3.425649e-03 3 1  ON 62
ci_064                -3.229850e-03 3 1  ON 63
ci_065                -4.073114e-03 3 1  ON 64
ci_066                 5.913253e-03 3 1  ON 65
ci_067                 6.181687e-03 3 1  ON 66
ci_068                -4.576575e-03 3 1  ON 67
ci_069                -4.757073e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.184453
====================================================
  Execution time = 1.3796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1404e-01
  Total weights = 1.9569e+06
  Execution time = 1.8639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655610106
                                         uncertainty =       0.002035614727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655610106
                                         uncertainty =       0.002035614727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386473630
  error estimate for blocks of size 2^( 2) =       0.000396327206
  error estimate for blocks of size 2^( 3) =       0.000404897752
  error estimate for blocks of size 2^( 4) =       0.000410764950
  error estimate for blocks of size 2^( 5) =       0.000415483113
  error estimate for blocks of size 2^( 6) =       0.000418553324
  error estimate for blocks of size 2^( 7) =       0.000420514176

      target function =                  N/A
              le_mean =     -17.217500680860
             les_mean =     296.769158906366
             stat err =       0.000416328891
             autocorr =       1.160468529206
              std dev =       0.546556248526
             le_variance =       0.298723732803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299425785642
                                         uncertainty =       0.002065580865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299425785642
                                         uncertainty =       0.002065580865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386969317
  error estimate for blocks of size 2^( 2) =       0.000396801248
  error estimate for blocks of size 2^( 3) =       0.000405337338
  error estimate for blocks of size 2^( 4) =       0.000411204772
  error estimate for blocks of size 2^( 5) =       0.000415911467
  error estimate for blocks of size 2^( 6) =       0.000418973683
  error estimate for blocks of size 2^( 7) =       0.000420949638

      target function =                  N/A
              le_mean =     -17.217467587631
             les_mean =     296.799119015218
             stat err =       0.000416759890
             autocorr =       1.159895241922
              std dev =       0.547257256569
             le_variance =       0.299490504867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300127974077
                                         uncertainty =       0.002094258464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300127974077
                                         uncertainty =       0.002094258464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387422278
  error estimate for blocks of size 2^( 2) =       0.000397251730
  error estimate for blocks of size 2^( 3) =       0.000405762837
  error estimate for blocks of size 2^( 4) =       0.000411626574
  error estimate for blocks of size 2^( 5) =       0.000416314421
  error estimate for blocks of size 2^( 6) =       0.000419350110
  error estimate for blocks of size 2^( 7) =       0.000421265973

      target function =                  N/A
              le_mean =     -17.217492801086
             les_mean =     296.796836041772
             stat err =       0.000417139270
             autocorr =       1.159292352753
              std dev =       0.547897840559
             le_variance =       0.300192043690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369866743
                                         uncertainty =       0.002063765367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369866743
                                         uncertainty =       0.002063765367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386933873
  error estimate for blocks of size 2^( 2) =       0.000396782967
  error estimate for blocks of size 2^( 3) =       0.000405341585
  error estimate for blocks of size 2^( 4) =       0.000411218593
  error estimate for blocks of size 2^( 5) =       0.000415840498
  error estimate for blocks of size 2^( 6) =       0.000418988235
  error estimate for blocks of size 2^( 7) =       0.000421011512

      target function =                  N/A
              le_mean =     -17.217467703257
             les_mean =     296.850802150358
             stat err =       0.000416764710
             autocorr =       1.160134585188
              std dev =       0.547207130624
             le_variance =       0.299435643806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217500680860        initial  <--
     3.8147e-02     3.8147e-01             1.2824e-03       -17.217467587631
     1.5259e-01     1.5259e+00             8.3990e-04       -17.217492801086
     6.1035e-01     6.1035e+00             3.5673e-04       -17.217467703257

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1965
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.109861e-02 3 1  ON 0
ci_002                -3.094158e-02 3 1  ON 1
ci_003                -2.533583e-02 3 1  ON 2
ci_004                 2.154998e-02 3 1  ON 3
ci_005                 2.157006e-02 3 1  ON 4
ci_006                -1.988084e-02 3 1  ON 5
ci_007                -1.951346e-02 3 1  ON 6
ci_008                -1.866608e-02 3 1  ON 7
ci_009                -1.735298e-02 3 1  ON 8
ci_010                -1.720192e-02 3 1  ON 9
ci_011                -1.696575e-02 3 1  ON 10
ci_012                -1.653740e-02 3 1  ON 11
ci_013                -1.847090e-02 3 1  ON 12
ci_014                 1.460725e-02 3 1  ON 13
ci_015                 1.416645e-02 3 1  ON 14
ci_016                 1.602983e-02 3 1  ON 15
ci_017                 1.667440e-02 3 1  ON 16
ci_018                 1.327322e-02 3 1  ON 17
ci_019                 1.362099e-02 3 1  ON 18
ci_020                 1.441317e-02 3 1  ON 19
ci_021                 1.356608e-02 3 1  ON 20
ci_022                 1.150137e-02 3 1  ON 21
ci_023                 1.145076e-02 3 1  ON 22
ci_024                 1.154126e-02 3 1  ON 23
ci_025                 1.099970e-02 3 1  ON 24
ci_026                 1.126713e-02 3 1  ON 25
ci_027                 1.185867e-02 3 1  ON 26
ci_028                -1.422896e-02 3 1  ON 27
ci_029                -1.501923e-02 3 1  ON 28
ci_030                -1.113637e-02 3 1  ON 29
ci_031                -1.069376e-02 3 1  ON 30
ci_032                -1.362476e-02 3 1  ON 31
ci_033                 1.012196e-02 3 1  ON 32
ci_034                 1.079636e-02 3 1  ON 33
ci_035                -5.377929e-03 3 1  ON 34
ci_036                -1.155224e-02 3 1  ON 35
ci_037                -1.127757e-02 3 1  ON 36
ci_038                 1.247717e-03 3 1  ON 37
ci_039                 9.540005e-04 3 1  ON 38
ci_040                -4.574340e-03 3 1  ON 39
ci_041                 9.487898e-03 3 1  ON 40
ci_042                 9.962166e-03 3 1  ON 41
ci_043                -3.371162e-03 3 1  ON 42
ci_044                -1.469579e-02 3 1  ON 43
ci_045                -1.753970e-03 3 1  ON 44
ci_046                 5.452752e-03 3 1  ON 45
ci_047                 5.834788e-03 3 1  ON 46
ci_048                -1.196390e-02 3 1  ON 47
ci_049                -1.225222e-02 3 1  ON 48
ci_050                 6.953971e-03 3 1  ON 49
ci_051                 8.109711e-03 3 1  ON 50
ci_052                -6.804508e-03 3 1  ON 51
ci_053                -7.067426e-03 3 1  ON 52
ci_054                -2.012904e-03 3 1  ON 53
ci_055                -2.499073e-03 3 1  ON 54
ci_056                 5.187694e-03 3 1  ON 55
ci_057                 5.814469e-03 3 1  ON 56
ci_058                -7.341865e-03 3 1  ON 57
ci_059                -7.154467e-03 3 1  ON 58
ci_060                 8.748177e-03 3 1  ON 59
ci_061                 8.676279e-03 3 1  ON 60
ci_062                -3.070860e-03 3 1  ON 61
ci_063                -3.293025e-03 3 1  ON 62
ci_064                -3.250425e-03 3 1  ON 63
ci_065                -4.190458e-03 3 1  ON 64
ci_066                 5.588177e-03 3 1  ON 65
ci_067                 6.032227e-03 3 1  ON 66
ci_068                -4.665874e-03 3 1  ON 67
ci_069                -4.635538e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.522238
====================================================
  Execution time = 1.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1156e-01
  Total weights = 1.956612517e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297734840947
                                         uncertainty =       0.002563153219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297734840947
                                         uncertainty =       0.002563153219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385886418
  error estimate for blocks of size 2^( 2) =       0.000396055528
  error estimate for blocks of size 2^( 3) =       0.000405187568
  error estimate for blocks of size 2^( 4) =       0.000411751887
  error estimate for blocks of size 2^( 5) =       0.000416551997
  error estimate for blocks of size 2^( 6) =       0.000419467852
  error estimate for blocks of size 2^( 7) =       0.000420982581

      target function =                  N/A
              le_mean =     -17.216888362115
             les_mean =     296.732800520432
             stat err =       0.000417188579
             autocorr =       1.168815155589
              std dev =       0.545725806359
             le_variance =       0.297816655726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688836212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216888362188       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216889065748       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889075303       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216888987825       residual = 4.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.686481e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216888362188       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216888611886       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216888570082       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.711768e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216888362188       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216888431929       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216888415614       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 4.939555e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6741e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.102668e-02 3 1  ON 0
ci_002                -3.096354e-02 3 1  ON 1
ci_003                -2.531811e-02 3 1  ON 2
ci_004                 2.156938e-02 3 1  ON 3
ci_005                 2.150546e-02 3 1  ON 4
ci_006                -1.997820e-02 3 1  ON 5
ci_007                -1.965265e-02 3 1  ON 6
ci_008                -1.869532e-02 3 1  ON 7
ci_009                -1.745323e-02 3 1  ON 8
ci_010                -1.727803e-02 3 1  ON 9
ci_011                -1.688712e-02 3 1  ON 10
ci_012                -1.651173e-02 3 1  ON 11
ci_013                -1.841321e-02 3 1  ON 12
ci_014                 1.455269e-02 3 1  ON 13
ci_015                 1.424082e-02 3 1  ON 14
ci_016                 1.614934e-02 3 1  ON 15
ci_017                 1.662179e-02 3 1  ON 16
ci_018                 1.327951e-02 3 1  ON 17
ci_019                 1.355720e-02 3 1  ON 18
ci_020                 1.426252e-02 3 1  ON 19
ci_021                 1.346835e-02 3 1  ON 20
ci_022                 1.163716e-02 3 1  ON 21
ci_023                 1.151927e-02 3 1  ON 22
ci_024                 1.169049e-02 3 1  ON 23
ci_025                 1.100527e-02 3 1  ON 24
ci_026                 1.139185e-02 3 1  ON 25
ci_027                 1.191109e-02 3 1  ON 26
ci_028                -1.412244e-02 3 1  ON 27
ci_029                -1.489334e-02 3 1  ON 28
ci_030                -1.112905e-02 3 1  ON 29
ci_031                -1.067243e-02 3 1  ON 30
ci_032                -1.363082e-02 3 1  ON 31
ci_033                 1.021213e-02 3 1  ON 32
ci_034                 1.085711e-02 3 1  ON 33
ci_035                -5.319893e-03 3 1  ON 34
ci_036                -1.143456e-02 3 1  ON 35
ci_037                -1.128194e-02 3 1  ON 36
ci_038                 1.196384e-03 3 1  ON 37
ci_039                 1.002037e-03 3 1  ON 38
ci_040                -4.573758e-03 3 1  ON 39
ci_041                 9.501888e-03 3 1  ON 40
ci_042                 9.930613e-03 3 1  ON 41
ci_043                -3.403885e-03 3 1  ON 42
ci_044                -1.473561e-02 3 1  ON 43
ci_045                -1.734665e-03 3 1  ON 44
ci_046                 5.492184e-03 3 1  ON 45
ci_047                 5.822128e-03 3 1  ON 46
ci_048                -1.194911e-02 3 1  ON 47
ci_049                -1.222166e-02 3 1  ON 48
ci_050                 7.075487e-03 3 1  ON 49
ci_051                 8.102879e-03 3 1  ON 50
ci_052                -6.905978e-03 3 1  ON 51
ci_053                -7.149194e-03 3 1  ON 52
ci_054                -1.914971e-03 3 1  ON 53
ci_055                -2.532751e-03 3 1  ON 54
ci_056                 5.160380e-03 3 1  ON 55
ci_057                 5.643292e-03 3 1  ON 56
ci_058                -7.320358e-03 3 1  ON 57
ci_059                -7.134361e-03 3 1  ON 58
ci_060                 8.837381e-03 3 1  ON 59
ci_061                 8.663828e-03 3 1  ON 60
ci_062                -3.125917e-03 3 1  ON 61
ci_063                -3.277104e-03 3 1  ON 62
ci_064                -3.192892e-03 3 1  ON 63
ci_065                -4.182875e-03 3 1  ON 64
ci_066                 5.588105e-03 3 1  ON 65
ci_067                 6.174268e-03 3 1  ON 66
ci_068                -4.791410e-03 3 1  ON 67
ci_069                -4.690222e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.273
    reference variance = 0.185838
====================================================
  Execution time = 1.4098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0881e-01
  Total weights = 1.9565e+06
  Execution time = 2.1755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295528551103
                                         uncertainty =       0.001887115503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295528551103
                                         uncertainty =       0.001887115503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384396823
  error estimate for blocks of size 2^( 2) =       0.000394575411
  error estimate for blocks of size 2^( 3) =       0.000403042312
  error estimate for blocks of size 2^( 4) =       0.000409799254
  error estimate for blocks of size 2^( 5) =       0.000412977265
  error estimate for blocks of size 2^( 6) =       0.000415783248
  error estimate for blocks of size 2^( 7) =       0.000417424068

      target function =                  N/A
              le_mean =     -17.216281970078
             les_mean =     296.709408880581
             stat err =       0.000413995959
             autocorr =       1.159932255159
              std dev =       0.543619200000
             le_variance =       0.295521834608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296074061929
                                         uncertainty =       0.001903751453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296074061929
                                         uncertainty =       0.001903751453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384755124
  error estimate for blocks of size 2^( 2) =       0.000394910908
  error estimate for blocks of size 2^( 3) =       0.000403350078
  error estimate for blocks of size 2^( 4) =       0.000410099748
  error estimate for blocks of size 2^( 5) =       0.000413287527
  error estimate for blocks of size 2^( 6) =       0.000416101646
  error estimate for blocks of size 2^( 7) =       0.000417741698

      target function =                  N/A
              le_mean =     -17.216286768520
             les_mean =     296.715029059622
             stat err =       0.000414307655
             autocorr =       1.159516922419
              std dev =       0.544125914302
             le_variance =       0.296073010615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295907524876
                                         uncertainty =       0.001898492299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295907524876
                                         uncertainty =       0.001898492299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384643322
  error estimate for blocks of size 2^( 2) =       0.000394804523
  error estimate for blocks of size 2^( 3) =       0.000403252558
  error estimate for blocks of size 2^( 4) =       0.000410003859
  error estimate for blocks of size 2^( 5) =       0.000413184810
  error estimate for blocks of size 2^( 6) =       0.000415993613
  error estimate for blocks of size 2^( 7) =       0.000417638260

      target function =                  N/A
              le_mean =     -17.216282447448
             les_mean =     296.709684774918
             stat err =       0.000414205135
             autocorr =       1.159616977081
              std dev =       0.543967802294
             le_variance =       0.295900969932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295578487370
                                         uncertainty =       0.001888677696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295578487370
                                         uncertainty =       0.001888677696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384429308
  error estimate for blocks of size 2^( 2) =       0.000394606091
  error estimate for blocks of size 2^( 3) =       0.000403070520
  error estimate for blocks of size 2^( 4) =       0.000409826811
  error estimate for blocks of size 2^( 5) =       0.000413006109
  error estimate for blocks of size 2^( 6) =       0.000415812000
  error estimate for blocks of size 2^( 7) =       0.000417451568

      target function =                  N/A
              le_mean =     -17.216281836277
             les_mean =     296.720983969995
             stat err =       0.000414024122
             autocorr =       1.159894025325
              std dev =       0.543665140502
             le_variance =       0.295571784997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216281970078        initial
     3.8147e-01     3.8147e+00             4.6865e-04       -17.216286768520  <--
     1.5259e+00     1.5259e+01             1.7118e-04       -17.216282447448
     6.1035e+00     6.1035e+01             4.9396e-05       -17.216281836277

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.4204e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.087849e-02 3 1  ON 0
ci_002                -3.100484e-02 3 1  ON 1
ci_003                -2.528414e-02 3 1  ON 2
ci_004                 2.161456e-02 3 1  ON 3
ci_005                 2.136847e-02 3 1  ON 4
ci_006                -2.017056e-02 3 1  ON 5
ci_007                -1.992690e-02 3 1  ON 6
ci_008                -1.874563e-02 3 1  ON 7
ci_009                -1.762410e-02 3 1  ON 8
ci_010                -1.742973e-02 3 1  ON 9
ci_011                -1.674696e-02 3 1  ON 10
ci_012                -1.646462e-02 3 1  ON 11
ci_013                -1.829096e-02 3 1  ON 12
ci_014                 1.444529e-02 3 1  ON 13
ci_015                 1.437259e-02 3 1  ON 14
ci_016                 1.637951e-02 3 1  ON 15
ci_017                 1.650589e-02 3 1  ON 16
ci_018                 1.329094e-02 3 1  ON 17
ci_019                 1.344060e-02 3 1  ON 18
ci_020                 1.396461e-02 3 1  ON 19
ci_021                 1.327388e-02 3 1  ON 20
ci_022                 1.188097e-02 3 1  ON 21
ci_023                 1.163687e-02 3 1  ON 22
ci_024                 1.200990e-02 3 1  ON 23
ci_025                 1.102002e-02 3 1  ON 24
ci_026                 1.162876e-02 3 1  ON 25
ci_027                 1.201012e-02 3 1  ON 26
ci_028                -1.391402e-02 3 1  ON 27
ci_029                -1.464457e-02 3 1  ON 28
ci_030                -1.110973e-02 3 1  ON 29
ci_031                -1.062782e-02 3 1  ON 30
ci_032                -1.364466e-02 3 1  ON 31
ci_033                 1.038791e-02 3 1  ON 32
ci_034                 1.097738e-02 3 1  ON 33
ci_035                -5.234201e-03 3 1  ON 34
ci_036                -1.121363e-02 3 1  ON 35
ci_037                -1.129727e-02 3 1  ON 36
ci_038                 1.122353e-03 3 1  ON 37
ci_039                 1.072689e-03 3 1  ON 38
ci_040                -4.575611e-03 3 1  ON 39
ci_041                 9.524867e-03 3 1  ON 40
ci_042                 9.868930e-03 3 1  ON 41
ci_043                -3.455691e-03 3 1  ON 42
ci_044                -1.481991e-02 3 1  ON 43
ci_045                -1.708133e-03 3 1  ON 44
ci_046                 5.563753e-03 3 1  ON 45
ci_047                 5.799324e-03 3 1  ON 46
ci_048                -1.193297e-02 3 1  ON 47
ci_049                -1.216428e-02 3 1  ON 48
ci_050                 7.269423e-03 3 1  ON 49
ci_051                 8.089591e-03 3 1  ON 50
ci_052                -7.073301e-03 3 1  ON 51
ci_053                -7.283553e-03 3 1  ON 52
ci_054                -1.749625e-03 3 1  ON 53
ci_055                -2.587753e-03 3 1  ON 54
ci_056                 5.116695e-03 3 1  ON 55
ci_057                 5.371585e-03 3 1  ON 56
ci_058                -7.284587e-03 3 1  ON 57
ci_059                -7.102625e-03 3 1  ON 58
ci_060                 9.000585e-03 3 1  ON 59
ci_061                 8.638410e-03 3 1  ON 60
ci_062                -3.224094e-03 3 1  ON 61
ci_063                -3.249829e-03 3 1  ON 62
ci_064                -3.119162e-03 3 1  ON 63
ci_065                -4.173884e-03 3 1  ON 64
ci_066                 5.587819e-03 3 1  ON 65
ci_067                 6.396870e-03 3 1  ON 66
ci_068                -5.012632e-03 3 1  ON 67
ci_069                -4.786047e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2941
    reference variance = 0.336669
====================================================
  Execution time = 1.4537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1435e-01
  Total weights = 1.956843139e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299074957846
                                         uncertainty =       0.002276740331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299074957846
                                         uncertainty =       0.002276740331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386817203
  error estimate for blocks of size 2^( 2) =       0.000396645890
  error estimate for blocks of size 2^( 3) =       0.000405596131
  error estimate for blocks of size 2^( 4) =       0.000412564708
  error estimate for blocks of size 2^( 5) =       0.000417243064
  error estimate for blocks of size 2^( 6) =       0.000419575986
  error estimate for blocks of size 2^( 7) =       0.000420288228

      target function =                  N/A
              le_mean =     -17.216052875350
             les_mean =     296.706823423271
             stat err =       0.000417417997
             autocorr =       1.164476636044
              std dev =       0.547042133971
             le_variance =       0.299255096340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605287535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052875386       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216071484682       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216070075651       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216070344115       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.080047e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052875386       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216063049919       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216062428439       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216062429123       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 6.137447e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052875386       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216056492323       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216056358575       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.250415e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7087e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.055231e-02 3 1  ON 0
ci_002                -3.095199e-02 3 1  ON 1
ci_003                -2.489150e-02 3 1  ON 2
ci_004                 2.165157e-02 3 1  ON 3
ci_005                 2.125172e-02 3 1  ON 4
ci_006                -2.022829e-02 3 1  ON 5
ci_007                -2.025110e-02 3 1  ON 6
ci_008                -1.843088e-02 3 1  ON 7
ci_009                -1.823784e-02 3 1  ON 8
ci_010                -1.706468e-02 3 1  ON 9
ci_011                -1.708897e-02 3 1  ON 10
ci_012                -1.614216e-02 3 1  ON 11
ci_013                -1.858539e-02 3 1  ON 12
ci_014                 1.447295e-02 3 1  ON 13
ci_015                 1.414810e-02 3 1  ON 14
ci_016                 1.662489e-02 3 1  ON 15
ci_017                 1.666780e-02 3 1  ON 16
ci_018                 1.342779e-02 3 1  ON 17
ci_019                 1.333777e-02 3 1  ON 18
ci_020                 1.418218e-02 3 1  ON 19
ci_021                 1.358516e-02 3 1  ON 20
ci_022                 1.218848e-02 3 1  ON 21
ci_023                 1.149801e-02 3 1  ON 22
ci_024                 1.207223e-02 3 1  ON 23
ci_025                 1.062253e-02 3 1  ON 24
ci_026                 1.157577e-02 3 1  ON 25
ci_027                 1.201103e-02 3 1  ON 26
ci_028                -1.390437e-02 3 1  ON 27
ci_029                -1.478141e-02 3 1  ON 28
ci_030                -1.116896e-02 3 1  ON 29
ci_031                -1.041509e-02 3 1  ON 30
ci_032                -1.362862e-02 3 1  ON 31
ci_033                 1.068707e-02 3 1  ON 32
ci_034                 1.065868e-02 3 1  ON 33
ci_035                -5.216845e-03 3 1  ON 34
ci_036                -1.127202e-02 3 1  ON 35
ci_037                -1.081646e-02 3 1  ON 36
ci_038                 1.016135e-03 3 1  ON 37
ci_039                 1.224772e-03 3 1  ON 38
ci_040                -4.274630e-03 3 1  ON 39
ci_041                 9.559856e-03 3 1  ON 40
ci_042                 9.844101e-03 3 1  ON 41
ci_043                -3.365322e-03 3 1  ON 42
ci_044                -1.488448e-02 3 1  ON 43
ci_045                -1.816135e-03 3 1  ON 44
ci_046                 5.815308e-03 3 1  ON 45
ci_047                 5.634447e-03 3 1  ON 46
ci_048                -1.165170e-02 3 1  ON 47
ci_049                -1.217603e-02 3 1  ON 48
ci_050                 7.353716e-03 3 1  ON 49
ci_051                 7.872483e-03 3 1  ON 50
ci_052                -6.917028e-03 3 1  ON 51
ci_053                -6.984433e-03 3 1  ON 52
ci_054                -1.861290e-03 3 1  ON 53
ci_055                -2.084122e-03 3 1  ON 54
ci_056                 5.325449e-03 3 1  ON 55
ci_057                 5.252467e-03 3 1  ON 56
ci_058                -7.092164e-03 3 1  ON 57
ci_059                -6.761732e-03 3 1  ON 58
ci_060                 8.601368e-03 3 1  ON 59
ci_061                 8.476869e-03 3 1  ON 60
ci_062                -3.106696e-03 3 1  ON 61
ci_063                -3.290456e-03 3 1  ON 62
ci_064                -3.129560e-03 3 1  ON 63
ci_065                -4.356768e-03 3 1  ON 64
ci_066                 5.682977e-03 3 1  ON 65
ci_067                 6.311889e-03 3 1  ON 66
ci_068                -4.801652e-03 3 1  ON 67
ci_069                -4.692999e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.168528
====================================================
  Execution time = 1.3861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1863e-01
  Total weights = 1.9569e+06
  Execution time = 1.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303577502770
                                         uncertainty =       0.003124289449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303577502770
                                         uncertainty =       0.003124289449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389538141
  error estimate for blocks of size 2^( 2) =       0.000399067030
  error estimate for blocks of size 2^( 3) =       0.000408138566
  error estimate for blocks of size 2^( 4) =       0.000414131160
  error estimate for blocks of size 2^( 5) =       0.000417991725
  error estimate for blocks of size 2^( 6) =       0.000421132310
  error estimate for blocks of size 2^( 7) =       0.000421950125

      target function =                  N/A
              le_mean =     -17.216449375270
             les_mean =     296.887230820278
             stat err =       0.000418801330
             autocorr =       1.155888996010
              std dev =       0.550890122605
             le_variance =       0.303479927184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302422480685
                                         uncertainty =       0.003114083386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302422480685
                                         uncertainty =       0.003114083386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388795582
  error estimate for blocks of size 2^( 2) =       0.000398353885
  error estimate for blocks of size 2^( 3) =       0.000407459528
  error estimate for blocks of size 2^( 4) =       0.000413462228
  error estimate for blocks of size 2^( 5) =       0.000417316649
  error estimate for blocks of size 2^( 6) =       0.000420433149
  error estimate for blocks of size 2^( 7) =       0.000421193393

      target function =                  N/A
              le_mean =     -17.216423299143
             les_mean =     296.724251343657
             stat err =       0.000418101355
             autocorr =       1.156433080396
              std dev =       0.549839985427
             le_variance =       0.302324009574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302322293687
                                         uncertainty =       0.003112031000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302322293687
                                         uncertainty =       0.003112031000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388731087
  error estimate for blocks of size 2^( 2) =       0.000398289465
  error estimate for blocks of size 2^( 3) =       0.000407398452
  error estimate for blocks of size 2^( 4) =       0.000413403660
  error estimate for blocks of size 2^( 5) =       0.000417258022
  error estimate for blocks of size 2^( 6) =       0.000420376601
  error estimate for blocks of size 2^( 7) =       0.000421125952

      target function =                  N/A
              le_mean =     -17.216426754807
             les_mean =     296.803694376713
             stat err =       0.000418041059
             autocorr =       1.156483214129
              std dev =       0.549748774829
             le_variance =       0.302223715427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303130526710
                                         uncertainty =       0.003130820659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303130526710
                                         uncertainty =       0.003130820659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389251370
  error estimate for blocks of size 2^( 2) =       0.000398787499
  error estimate for blocks of size 2^( 3) =       0.000407867607
  error estimate for blocks of size 2^( 4) =       0.000413867442
  error estimate for blocks of size 2^( 5) =       0.000417713891
  error estimate for blocks of size 2^( 6) =       0.000420857639
  error estimate for blocks of size 2^( 7) =       0.000421609017

      target function =                  N/A
              le_mean =     -17.216427905186
             les_mean =     296.725564395276
             stat err =       0.000418511997
             autocorr =       1.155993854540
              std dev =       0.550484566565
             le_variance =       0.303033258026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216449375270        initial  <--
     9.5367e-02     9.5367e-01             1.0800e-03       -17.216423299143
     3.8147e-01     3.8147e+00             6.1374e-04       -17.216426754807
     1.5259e+00     1.5259e+01             2.2504e-04       -17.216427905186

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2897
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.087849e-02 3 1  ON 0
ci_002                -3.100484e-02 3 1  ON 1
ci_003                -2.528414e-02 3 1  ON 2
ci_004                 2.161456e-02 3 1  ON 3
ci_005                 2.136847e-02 3 1  ON 4
ci_006                -2.017056e-02 3 1  ON 5
ci_007                -1.992690e-02 3 1  ON 6
ci_008                -1.874563e-02 3 1  ON 7
ci_009                -1.762410e-02 3 1  ON 8
ci_010                -1.742973e-02 3 1  ON 9
ci_011                -1.674696e-02 3 1  ON 10
ci_012                -1.646462e-02 3 1  ON 11
ci_013                -1.829096e-02 3 1  ON 12
ci_014                 1.444529e-02 3 1  ON 13
ci_015                 1.437259e-02 3 1  ON 14
ci_016                 1.637951e-02 3 1  ON 15
ci_017                 1.650589e-02 3 1  ON 16
ci_018                 1.329094e-02 3 1  ON 17
ci_019                 1.344060e-02 3 1  ON 18
ci_020                 1.396461e-02 3 1  ON 19
ci_021                 1.327388e-02 3 1  ON 20
ci_022                 1.188097e-02 3 1  ON 21
ci_023                 1.163687e-02 3 1  ON 22
ci_024                 1.200990e-02 3 1  ON 23
ci_025                 1.102002e-02 3 1  ON 24
ci_026                 1.162876e-02 3 1  ON 25
ci_027                 1.201012e-02 3 1  ON 26
ci_028                -1.391402e-02 3 1  ON 27
ci_029                -1.464457e-02 3 1  ON 28
ci_030                -1.110973e-02 3 1  ON 29
ci_031                -1.062782e-02 3 1  ON 30
ci_032                -1.364466e-02 3 1  ON 31
ci_033                 1.038791e-02 3 1  ON 32
ci_034                 1.097738e-02 3 1  ON 33
ci_035                -5.234201e-03 3 1  ON 34
ci_036                -1.121363e-02 3 1  ON 35
ci_037                -1.129727e-02 3 1  ON 36
ci_038                 1.122353e-03 3 1  ON 37
ci_039                 1.072689e-03 3 1  ON 38
ci_040                -4.575611e-03 3 1  ON 39
ci_041                 9.524867e-03 3 1  ON 40
ci_042                 9.868930e-03 3 1  ON 41
ci_043                -3.455691e-03 3 1  ON 42
ci_044                -1.481991e-02 3 1  ON 43
ci_045                -1.708133e-03 3 1  ON 44
ci_046                 5.563753e-03 3 1  ON 45
ci_047                 5.799324e-03 3 1  ON 46
ci_048                -1.193297e-02 3 1  ON 47
ci_049                -1.216428e-02 3 1  ON 48
ci_050                 7.269423e-03 3 1  ON 49
ci_051                 8.089591e-03 3 1  ON 50
ci_052                -7.073301e-03 3 1  ON 51
ci_053                -7.283553e-03 3 1  ON 52
ci_054                -1.749625e-03 3 1  ON 53
ci_055                -2.587753e-03 3 1  ON 54
ci_056                 5.116695e-03 3 1  ON 55
ci_057                 5.371585e-03 3 1  ON 56
ci_058                -7.284587e-03 3 1  ON 57
ci_059                -7.102625e-03 3 1  ON 58
ci_060                 9.000585e-03 3 1  ON 59
ci_061                 8.638410e-03 3 1  ON 60
ci_062                -3.224094e-03 3 1  ON 61
ci_063                -3.249829e-03 3 1  ON 62
ci_064                -3.119162e-03 3 1  ON 63
ci_065                -4.173884e-03 3 1  ON 64
ci_066                 5.587819e-03 3 1  ON 65
ci_067                 6.396870e-03 3 1  ON 66
ci_068                -5.012632e-03 3 1  ON 67
ci_069                -4.786047e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.31138
====================================================
  Execution time = 1.4461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1019e-01
  Total weights = 1.956310039e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296972917270
                                         uncertainty =       0.003142152423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296972917270
                                         uncertainty =       0.003142152423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385302043
  error estimate for blocks of size 2^( 2) =       0.000395227989
  error estimate for blocks of size 2^( 3) =       0.000404300018
  error estimate for blocks of size 2^( 4) =       0.000410658847
  error estimate for blocks of size 2^( 5) =       0.000415272226
  error estimate for blocks of size 2^( 6) =       0.000418276364
  error estimate for blocks of size 2^( 7) =       0.000421653897

      target function =                  N/A
              le_mean =     -17.217060311504
             les_mean =     296.737358348501
             stat err =       0.000416465334
             autocorr =       1.168301921030
              std dev =       0.544899374159
             le_variance =       0.296915327959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721706031150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060311551       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217065334908       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217065380046       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217065463443       residual = 2.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.837917e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060311551       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061779361       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061785856       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061805503       residual = 2.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 1.082119e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217060311551       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217060694670       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217060696064       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217060700785       residual = 3.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.794456e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6987e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.088424e-02 3 1  ON 0
ci_002                -3.101749e-02 3 1  ON 1
ci_003                -2.535274e-02 3 1  ON 2
ci_004                 2.158763e-02 3 1  ON 3
ci_005                 2.134439e-02 3 1  ON 4
ci_006                -2.014817e-02 3 1  ON 5
ci_007                -1.996775e-02 3 1  ON 6
ci_008                -1.877029e-02 3 1  ON 7
ci_009                -1.763566e-02 3 1  ON 8
ci_010                -1.741293e-02 3 1  ON 9
ci_011                -1.673934e-02 3 1  ON 10
ci_012                -1.643806e-02 3 1  ON 11
ci_013                -1.839918e-02 3 1  ON 12
ci_014                 1.445752e-02 3 1  ON 13
ci_015                 1.433801e-02 3 1  ON 14
ci_016                 1.640494e-02 3 1  ON 15
ci_017                 1.648621e-02 3 1  ON 16
ci_018                 1.329934e-02 3 1  ON 17
ci_019                 1.344237e-02 3 1  ON 18
ci_020                 1.390030e-02 3 1  ON 19
ci_021                 1.334811e-02 3 1  ON 20
ci_022                 1.188759e-02 3 1  ON 21
ci_023                 1.159893e-02 3 1  ON 22
ci_024                 1.194432e-02 3 1  ON 23
ci_025                 1.103968e-02 3 1  ON 24
ci_026                 1.163237e-02 3 1  ON 25
ci_027                 1.201359e-02 3 1  ON 26
ci_028                -1.394425e-02 3 1  ON 27
ci_029                -1.464569e-02 3 1  ON 28
ci_030                -1.108917e-02 3 1  ON 29
ci_031                -1.067604e-02 3 1  ON 30
ci_032                -1.366663e-02 3 1  ON 31
ci_033                 1.035425e-02 3 1  ON 32
ci_034                 1.092498e-02 3 1  ON 33
ci_035                -5.230285e-03 3 1  ON 34
ci_036                -1.119959e-02 3 1  ON 35
ci_037                -1.126559e-02 3 1  ON 36
ci_038                 1.147434e-03 3 1  ON 37
ci_039                 1.101991e-03 3 1  ON 38
ci_040                -4.579299e-03 3 1  ON 39
ci_041                 9.520169e-03 3 1  ON 40
ci_042                 9.883904e-03 3 1  ON 41
ci_043                -3.443200e-03 3 1  ON 42
ci_044                -1.485773e-02 3 1  ON 43
ci_045                -1.683872e-03 3 1  ON 44
ci_046                 5.539885e-03 3 1  ON 45
ci_047                 5.789212e-03 3 1  ON 46
ci_048                -1.191060e-02 3 1  ON 47
ci_049                -1.213015e-02 3 1  ON 48
ci_050                 7.292493e-03 3 1  ON 49
ci_051                 8.081115e-03 3 1  ON 50
ci_052                -7.079111e-03 3 1  ON 51
ci_053                -7.301580e-03 3 1  ON 52
ci_054                -1.807137e-03 3 1  ON 53
ci_055                -2.562889e-03 3 1  ON 54
ci_056                 5.084907e-03 3 1  ON 55
ci_057                 5.312257e-03 3 1  ON 56
ci_058                -7.285383e-03 3 1  ON 57
ci_059                -7.110670e-03 3 1  ON 58
ci_060                 8.946941e-03 3 1  ON 59
ci_061                 8.630955e-03 3 1  ON 60
ci_062                -3.228171e-03 3 1  ON 61
ci_063                -3.214796e-03 3 1  ON 62
ci_064                -3.114732e-03 3 1  ON 63
ci_065                -4.152954e-03 3 1  ON 64
ci_066                 5.579880e-03 3 1  ON 65
ci_067                 6.335238e-03 3 1  ON 66
ci_068                -5.082239e-03 3 1  ON 67
ci_069                -4.793976e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2392
    reference variance = 0.162172
====================================================
  Execution time = 1.3875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1855e-01
  Total weights = 1.9566e+06
  Execution time = 1.8703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299191603194
                                         uncertainty =       0.002145735274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299191603194
                                         uncertainty =       0.002145735274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386773477
  error estimate for blocks of size 2^( 2) =       0.000396636355
  error estimate for blocks of size 2^( 3) =       0.000405336106
  error estimate for blocks of size 2^( 4) =       0.000412053933
  error estimate for blocks of size 2^( 5) =       0.000415502857
  error estimate for blocks of size 2^( 6) =       0.000418236765
  error estimate for blocks of size 2^( 7) =       0.000419476540

      target function =                  N/A
              le_mean =     -17.216185573300
             les_mean =     296.715369161155
             stat err =       0.000416317524
             autocorr =       1.158606644593
              std dev =       0.546980296430
             le_variance =       0.299187444683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299251827710
                                         uncertainty =       0.002144101097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299251827710
                                         uncertainty =       0.002144101097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386811918
  error estimate for blocks of size 2^( 2) =       0.000396674518
  error estimate for blocks of size 2^( 3) =       0.000405375460
  error estimate for blocks of size 2^( 4) =       0.000412093465
  error estimate for blocks of size 2^( 5) =       0.000415534436
  error estimate for blocks of size 2^( 6) =       0.000418280377
  error estimate for blocks of size 2^( 7) =       0.000419528015

      target function =                  N/A
              le_mean =     -17.216189795943
             les_mean =     296.717632639142
             stat err =       0.000416359073
             autocorr =       1.158607597544
              std dev =       0.547034661098
             le_variance =       0.299246920443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299222321883
                                         uncertainty =       0.002144600075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299222321883
                                         uncertainty =       0.002144600075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386793054
  error estimate for blocks of size 2^( 2) =       0.000396655802
  error estimate for blocks of size 2^( 3) =       0.000405356303
  error estimate for blocks of size 2^( 4) =       0.000412074177
  error estimate for blocks of size 2^( 5) =       0.000415518095
  error estimate for blocks of size 2^( 6) =       0.000418259024
  error estimate for blocks of size 2^( 7) =       0.000419503545

      target function =                  N/A
              le_mean =     -17.216187466364
             les_mean =     296.716288441278
             stat err =       0.000416338710
             autocorr =       1.158607276085
              std dev =       0.547007983180
             le_variance =       0.299217733663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194739856
                                         uncertainty =       0.002145571434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194739856
                                         uncertainty =       0.002145571434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386775468
  error estimate for blocks of size 2^( 2) =       0.000396638339
  error estimate for blocks of size 2^( 3) =       0.000405338193
  error estimate for blocks of size 2^( 4) =       0.000412056054
  error estimate for blocks of size 2^( 5) =       0.000415504267
  error estimate for blocks of size 2^( 6) =       0.000418239096
  error estimate for blocks of size 2^( 7) =       0.000419479501

      target function =                  N/A
              le_mean =     -17.216185740350
             les_mean =     296.715339106367
             stat err =       0.000416319729
             autocorr =       1.158606990924
              std dev =       0.546983112509
             le_variance =       0.299190525370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216185573300        initial
     9.5367e-01     9.5367e+00             3.8379e-04       -17.216189795943  <--
     3.8147e+00     3.8147e+01             1.0821e-04       -17.216187466364
     1.5259e+01     1.5259e+02             2.7945e-05       -17.216185740350

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.3273e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.089590e-02 3 1  ON 0
ci_002                -3.104568e-02 3 1  ON 1
ci_003                -2.552369e-02 3 1  ON 2
ci_004                 2.151938e-02 3 1  ON 3
ci_005                 2.128517e-02 3 1  ON 4
ci_006                -2.009086e-02 3 1  ON 5
ci_007                -2.006986e-02 3 1  ON 6
ci_008                -1.882612e-02 3 1  ON 7
ci_009                -1.765963e-02 3 1  ON 8
ci_010                -1.736736e-02 3 1  ON 9
ci_011                -1.672233e-02 3 1  ON 10
ci_012                -1.637562e-02 3 1  ON 11
ci_013                -1.867476e-02 3 1  ON 12
ci_014                 1.448851e-02 3 1  ON 13
ci_015                 1.425729e-02 3 1  ON 14
ci_016                 1.646880e-02 3 1  ON 15
ci_017                 1.643577e-02 3 1  ON 16
ci_018                 1.331848e-02 3 1  ON 17
ci_019                 1.344543e-02 3 1  ON 18
ci_020                 1.373718e-02 3 1  ON 19
ci_021                 1.353315e-02 3 1  ON 20
ci_022                 1.190318e-02 3 1  ON 21
ci_023                 1.150942e-02 3 1  ON 22
ci_024                 1.177608e-02 3 1  ON 23
ci_025                 1.109003e-02 3 1  ON 24
ci_026                 1.164059e-02 3 1  ON 25
ci_027                 1.202217e-02 3 1  ON 26
ci_028                -1.402100e-02 3 1  ON 27
ci_029                -1.464728e-02 3 1  ON 28
ci_030                -1.103893e-02 3 1  ON 29
ci_031                -1.079281e-02 3 1  ON 30
ci_032                -1.371593e-02 3 1  ON 31
ci_033                 1.027261e-02 3 1  ON 32
ci_034                 1.079735e-02 3 1  ON 33
ci_035                -5.222105e-03 3 1  ON 34
ci_036                -1.116695e-02 3 1  ON 35
ci_037                -1.118887e-02 3 1  ON 36
ci_038                 1.201178e-03 3 1  ON 37
ci_039                 1.165077e-03 3 1  ON 38
ci_040                -4.586442e-03 3 1  ON 39
ci_041                 9.507352e-03 3 1  ON 40
ci_042                 9.918659e-03 3 1  ON 41
ci_043                -3.415555e-03 3 1  ON 42
ci_044                -1.495527e-02 3 1  ON 43
ci_045                -1.631426e-03 3 1  ON 44
ci_046                 5.483928e-03 3 1  ON 45
ci_047                 5.765676e-03 3 1  ON 46
ci_048                -1.185429e-02 3 1  ON 47
ci_049                -1.204276e-02 3 1  ON 48
ci_050                 7.342884e-03 3 1  ON 49
ci_051                 8.062668e-03 3 1  ON 50
ci_052                -7.092493e-03 3 1  ON 51
ci_053                -7.342049e-03 3 1  ON 52
ci_054                -1.939322e-03 3 1  ON 53
ci_055                -2.505605e-03 3 1  ON 54
ci_056                 5.013199e-03 3 1  ON 55
ci_057                 5.180187e-03 3 1  ON 56
ci_058                -7.287509e-03 3 1  ON 57
ci_059                -7.128486e-03 3 1  ON 58
ci_060                 8.819548e-03 3 1  ON 59
ci_061                 8.613948e-03 3 1  ON 60
ci_062                -3.235630e-03 3 1  ON 61
ci_063                -3.131561e-03 3 1  ON 62
ci_064                -3.106391e-03 3 1  ON 63
ci_065                -4.111071e-03 3 1  ON 64
ci_066                 5.561737e-03 3 1  ON 65
ci_067                 6.200330e-03 3 1  ON 66
ci_068                -5.248358e-03 3 1  ON 67
ci_069                -4.813632e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2977
    reference variance = 0.638431
====================================================
  Execution time = 1.4435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1322e-01
  Total weights = 1.956546539e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724281627
                                         uncertainty =       0.001802064422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300724281627
                                         uncertainty =       0.001802064422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387739988
  error estimate for blocks of size 2^( 2) =       0.000397392165
  error estimate for blocks of size 2^( 3) =       0.000406026070
  error estimate for blocks of size 2^( 4) =       0.000411733558
  error estimate for blocks of size 2^( 5) =       0.000415454945
  error estimate for blocks of size 2^( 6) =       0.000417181867
  error estimate for blocks of size 2^( 7) =       0.000416856806

      target function =                  N/A
              le_mean =     -17.216467063443
             les_mean =     296.719955155332
             stat err =       0.000415306794
             autocorr =       1.147246881696
              std dev =       0.548347150330
             le_variance =       0.300684597275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646706344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216467063488       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477504974       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216474621844       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216474623799       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 6.656285e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216467063488       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471212414       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216470586695       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216470663119       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.649006e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216467063488       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216468279967       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216468208836       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216468211678       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.774173e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6989e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.106929e-02 3 1  ON 0
ci_002                -3.112691e-02 3 1  ON 1
ci_003                -2.543032e-02 3 1  ON 2
ci_004                 2.164243e-02 3 1  ON 3
ci_005                 2.127070e-02 3 1  ON 4
ci_006                -2.000112e-02 3 1  ON 5
ci_007                -2.018861e-02 3 1  ON 6
ci_008                -1.863166e-02 3 1  ON 7
ci_009                -1.788418e-02 3 1  ON 8
ci_010                -1.738106e-02 3 1  ON 9
ci_011                -1.659886e-02 3 1  ON 10
ci_012                -1.659535e-02 3 1  ON 11
ci_013                -1.873035e-02 3 1  ON 12
ci_014                 1.425930e-02 3 1  ON 13
ci_015                 1.431473e-02 3 1  ON 14
ci_016                 1.666546e-02 3 1  ON 15
ci_017                 1.657025e-02 3 1  ON 16
ci_018                 1.323202e-02 3 1  ON 17
ci_019                 1.333780e-02 3 1  ON 18
ci_020                 1.349809e-02 3 1  ON 19
ci_021                 1.376387e-02 3 1  ON 20
ci_022                 1.177032e-02 3 1  ON 21
ci_023                 1.145144e-02 3 1  ON 22
ci_024                 1.161165e-02 3 1  ON 23
ci_025                 1.109732e-02 3 1  ON 24
ci_026                 1.174927e-02 3 1  ON 25
ci_027                 1.187301e-02 3 1  ON 26
ci_028                -1.423878e-02 3 1  ON 27
ci_029                -1.458740e-02 3 1  ON 28
ci_030                -1.100738e-02 3 1  ON 29
ci_031                -1.074318e-02 3 1  ON 30
ci_032                -1.390599e-02 3 1  ON 31
ci_033                 1.030819e-02 3 1  ON 32
ci_034                 1.058237e-02 3 1  ON 33
ci_035                -5.205997e-03 3 1  ON 34
ci_036                -1.105050e-02 3 1  ON 35
ci_037                -1.115707e-02 3 1  ON 36
ci_038                 1.237076e-03 3 1  ON 37
ci_039                 1.232022e-03 3 1  ON 38
ci_040                -4.528312e-03 3 1  ON 39
ci_041                 9.686892e-03 3 1  ON 40
ci_042                 9.875786e-03 3 1  ON 41
ci_043                -3.296300e-03 3 1  ON 42
ci_044                -1.499772e-02 3 1  ON 43
ci_045                -1.562646e-03 3 1  ON 44
ci_046                 5.568235e-03 3 1  ON 45
ci_047                 5.880752e-03 3 1  ON 46
ci_048                -1.201958e-02 3 1  ON 47
ci_049                -1.204348e-02 3 1  ON 48
ci_050                 7.353102e-03 3 1  ON 49
ci_051                 8.098853e-03 3 1  ON 50
ci_052                -6.996301e-03 3 1  ON 51
ci_053                -7.196455e-03 3 1  ON 52
ci_054                -2.030336e-03 3 1  ON 53
ci_055                -2.319186e-03 3 1  ON 54
ci_056                 5.058394e-03 3 1  ON 55
ci_057                 5.204504e-03 3 1  ON 56
ci_058                -7.400217e-03 3 1  ON 57
ci_059                -7.239976e-03 3 1  ON 58
ci_060                 8.757701e-03 3 1  ON 59
ci_061                 8.547421e-03 3 1  ON 60
ci_062                -3.281589e-03 3 1  ON 61
ci_063                -3.050739e-03 3 1  ON 62
ci_064                -3.196026e-03 3 1  ON 63
ci_065                -4.150120e-03 3 1  ON 64
ci_066                 5.543487e-03 3 1  ON 65
ci_067                 6.192354e-03 3 1  ON 66
ci_068                -4.983457e-03 3 1  ON 67
ci_069                -4.899004e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0977
    reference variance = 0.548868
====================================================
  Execution time = 1.3801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1081e-01
  Total weights = 1.9566e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297838502434
                                         uncertainty =       0.001989594159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297838502434
                                         uncertainty =       0.001989594159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385995063
  error estimate for blocks of size 2^( 2) =       0.000395646067
  error estimate for blocks of size 2^( 3) =       0.000404287992
  error estimate for blocks of size 2^( 4) =       0.000411238296
  error estimate for blocks of size 2^( 5) =       0.000414248473
  error estimate for blocks of size 2^( 6) =       0.000416938240
  error estimate for blocks of size 2^( 7) =       0.000418404229

      target function =                  N/A
              le_mean =     -17.216754072305
             les_mean =     296.728215002127
             stat err =       0.000415207310
             autocorr =       1.157088241246
              std dev =       0.545879453746
             le_variance =       0.297984378023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297852897430
                                         uncertainty =       0.002002083057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297852897430
                                         uncertainty =       0.002002083057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386004408
  error estimate for blocks of size 2^( 2) =       0.000395661719
  error estimate for blocks of size 2^( 3) =       0.000404300907
  error estimate for blocks of size 2^( 4) =       0.000411248639
  error estimate for blocks of size 2^( 5) =       0.000414274958
  error estimate for blocks of size 2^( 6) =       0.000416959057
  error estimate for blocks of size 2^( 7) =       0.000418362332

      target function =                  N/A
              le_mean =     -17.216779068250
             les_mean =     296.738158595252
             stat err =       0.000415211246
             autocorr =       1.157054158656
              std dev =       0.545892669338
             le_variance =       0.297998806437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297624321943
                                         uncertainty =       0.001985772387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297624321943
                                         uncertainty =       0.001985772387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385857385
  error estimate for blocks of size 2^( 2) =       0.000395515431
  error estimate for blocks of size 2^( 3) =       0.000404159239
  error estimate for blocks of size 2^( 4) =       0.000411109618
  error estimate for blocks of size 2^( 5) =       0.000414130852
  error estimate for blocks of size 2^( 6) =       0.000416824886
  error estimate for blocks of size 2^( 7) =       0.000418249179

      target function =                  N/A
              le_mean =     -17.216766488785
             les_mean =     296.730399496030
             stat err =       0.000415078634
             autocorr =       1.157196530593
              std dev =       0.545684747483
             le_variance =       0.297771843635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787518642
                                         uncertainty =       0.001988988851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787518642
                                         uncertainty =       0.001988988851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385962253
  error estimate for blocks of size 2^( 2) =       0.000395614410
  error estimate for blocks of size 2^( 3) =       0.000404257020
  error estimate for blocks of size 2^( 4) =       0.000411207275
  error estimate for blocks of size 2^( 5) =       0.000414218879
  error estimate for blocks of size 2^( 6) =       0.000416909791
  error estimate for blocks of size 2^( 7) =       0.000418369875

      target function =                  N/A
              le_mean =     -17.216754655283
             les_mean =     296.728344526881
             stat err =       0.000415176455
             autocorr =       1.157112983916
              std dev =       0.545833052986
             le_variance =       0.297933721732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216754072305        initial
     2.3842e-01     2.3842e+00             6.6563e-04       -17.216779068250  <--
     9.5367e-01     9.5367e+00             2.6490e-04       -17.216766488785
     3.8147e+00     3.8147e+01             7.7742e-05       -17.216754655283

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3233e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.132989e-02 3 1  ON 0
ci_002                -3.124332e-02 3 1  ON 1
ci_003                -2.525329e-02 3 1  ON 2
ci_004                 2.184889e-02 3 1  ON 3
ci_005                 2.123661e-02 3 1  ON 4
ci_006                -1.983141e-02 3 1  ON 5
ci_007                -2.036270e-02 3 1  ON 6
ci_008                -1.837039e-02 3 1  ON 7
ci_009                -1.818591e-02 3 1  ON 8
ci_010                -1.738303e-02 3 1  ON 9
ci_011                -1.639705e-02 3 1  ON 10
ci_012                -1.693819e-02 3 1  ON 11
ci_013                -1.883804e-02 3 1  ON 12
ci_014                 1.391558e-02 3 1  ON 13
ci_015                 1.441923e-02 3 1  ON 14
ci_016                 1.699586e-02 3 1  ON 15
ci_017                 1.677169e-02 3 1  ON 16
ci_018                 1.310383e-02 3 1  ON 17
ci_019                 1.317612e-02 3 1  ON 18
ci_020                 1.307732e-02 3 1  ON 19
ci_021                 1.415167e-02 3 1  ON 20
ci_022                 1.157846e-02 3 1  ON 21
ci_023                 1.136931e-02 3 1  ON 22
ci_024                 1.130754e-02 3 1  ON 23
ci_025                 1.112017e-02 3 1  ON 24
ci_026                 1.191860e-02 3 1  ON 25
ci_027                 1.164093e-02 3 1  ON 26
ci_028                -1.462228e-02 3 1  ON 27
ci_029                -1.447720e-02 3 1  ON 28
ci_030                -1.095613e-02 3 1  ON 29
ci_031                -1.067202e-02 3 1  ON 30
ci_032                -1.415520e-02 3 1  ON 31
ci_033                 1.037284e-02 3 1  ON 32
ci_034                 1.026324e-02 3 1  ON 33
ci_035                -5.184329e-03 3 1  ON 34
ci_036                -1.085715e-02 3 1  ON 35
ci_037                -1.110499e-02 3 1  ON 36
ci_038                 1.276655e-03 3 1  ON 37
ci_039                 1.307523e-03 3 1  ON 38
ci_040                -4.463160e-03 3 1  ON 39
ci_041                 9.964297e-03 3 1  ON 40
ci_042                 9.818302e-03 3 1  ON 41
ci_043                -3.155135e-03 3 1  ON 42
ci_044                -1.505850e-02 3 1  ON 43
ci_045                -1.486978e-03 3 1  ON 44
ci_046                 5.691567e-03 3 1  ON 45
ci_047                 6.048451e-03 3 1  ON 46
ci_048                -1.230663e-02 3 1  ON 47
ci_049                -1.202205e-02 3 1  ON 48
ci_050                 7.362447e-03 3 1  ON 49
ci_051                 8.140232e-03 3 1  ON 50
ci_052                -6.868530e-03 3 1  ON 51
ci_053                -7.002704e-03 3 1  ON 52
ci_054                -2.157612e-03 3 1  ON 53
ci_055                -2.064513e-03 3 1  ON 54
ci_056                 5.118407e-03 3 1  ON 55
ci_057                 5.236114e-03 3 1  ON 56
ci_058                -7.551195e-03 3 1  ON 57
ci_059                -7.392594e-03 3 1  ON 58
ci_060                 8.667725e-03 3 1  ON 59
ci_061                 8.452791e-03 3 1  ON 60
ci_062                -3.344841e-03 3 1  ON 61
ci_063                -2.939902e-03 3 1  ON 62
ci_064                -3.282548e-03 3 1  ON 63
ci_065                -4.188499e-03 3 1  ON 64
ci_066                 5.522746e-03 3 1  ON 65
ci_067                 6.184735e-03 3 1  ON 66
ci_068                -4.582729e-03 3 1  ON 67
ci_069                -5.032783e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1608
    reference variance = 0.241427
====================================================
  Execution time = 1.4222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.956824132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297557409565
                                         uncertainty =       0.001968322493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297557409565
                                         uncertainty =       0.001968322493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385688346
  error estimate for blocks of size 2^( 2) =       0.000395273331
  error estimate for blocks of size 2^( 3) =       0.000404342921
  error estimate for blocks of size 2^( 4) =       0.000411044718
  error estimate for blocks of size 2^( 5) =       0.000414726409
  error estimate for blocks of size 2^( 6) =       0.000415830793
  error estimate for blocks of size 2^( 7) =       0.000417429606

      target function =                  N/A
              le_mean =     -17.216494520151
             les_mean =     296.720180444000
             stat err =       0.000414757881
             autocorr =       1.156421781634
              std dev =       0.545445689072
             le_variance =       0.297510999728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649452015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494520185       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216482420868       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216483143000       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216484287144       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216484106873       residual = 3.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.692720e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494520185       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486942406       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216487115377       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216487358026       residual = 7.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 9.483127e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216494520185       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491482761       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216491386089       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.457917e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053785 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6774e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.155931e-02 3 1  ON 0
ci_002                -3.128279e-02 3 1  ON 1
ci_003                -2.497205e-02 3 1  ON 2
ci_004                 2.090058e-02 3 1  ON 3
ci_005                 2.173170e-02 3 1  ON 4
ci_006                -2.029421e-02 3 1  ON 5
ci_007                -2.003169e-02 3 1  ON 6
ci_008                -1.865456e-02 3 1  ON 7
ci_009                -1.797836e-02 3 1  ON 8
ci_010                -1.694274e-02 3 1  ON 9
ci_011                -1.569323e-02 3 1  ON 10
ci_012                -1.670491e-02 3 1  ON 11
ci_013                -1.905067e-02 3 1  ON 12
ci_014                 1.377241e-02 3 1  ON 13
ci_015                 1.513389e-02 3 1  ON 14
ci_016                 1.664242e-02 3 1  ON 15
ci_017                 1.624504e-02 3 1  ON 16
ci_018                 1.300811e-02 3 1  ON 17
ci_019                 1.390154e-02 3 1  ON 18
ci_020                 1.318027e-02 3 1  ON 19
ci_021                 1.331832e-02 3 1  ON 20
ci_022                 1.131467e-02 3 1  ON 21
ci_023                 1.142621e-02 3 1  ON 22
ci_024                 1.152617e-02 3 1  ON 23
ci_025                 1.091002e-02 3 1  ON 24
ci_026                 1.190423e-02 3 1  ON 25
ci_027                 1.193678e-02 3 1  ON 26
ci_028                -1.403064e-02 3 1  ON 27
ci_029                -1.461177e-02 3 1  ON 28
ci_030                -1.085712e-02 3 1  ON 29
ci_031                -1.081736e-02 3 1  ON 30
ci_032                -1.377837e-02 3 1  ON 31
ci_033                 9.853759e-03 3 1  ON 32
ci_034                 1.046393e-02 3 1  ON 33
ci_035                -5.123386e-03 3 1  ON 34
ci_036                -1.073997e-02 3 1  ON 35
ci_037                -1.126571e-02 3 1  ON 36
ci_038                 1.397774e-03 3 1  ON 37
ci_039                 1.333799e-03 3 1  ON 38
ci_040                -4.198790e-03 3 1  ON 39
ci_041                 1.017096e-02 3 1  ON 40
ci_042                 9.704839e-03 3 1  ON 41
ci_043                -3.052961e-03 3 1  ON 42
ci_044                -1.558557e-02 3 1  ON 43
ci_045                -1.716103e-03 3 1  ON 44
ci_046                 5.847532e-03 3 1  ON 45
ci_047                 5.791977e-03 3 1  ON 46
ci_048                -1.239750e-02 3 1  ON 47
ci_049                -1.248034e-02 3 1  ON 48
ci_050                 7.328258e-03 3 1  ON 49
ci_051                 8.245567e-03 3 1  ON 50
ci_052                -6.705790e-03 3 1  ON 51
ci_053                -6.442071e-03 3 1  ON 52
ci_054                -2.389171e-03 3 1  ON 53
ci_055                -2.155300e-03 3 1  ON 54
ci_056                 4.471987e-03 3 1  ON 55
ci_057                 5.378348e-03 3 1  ON 56
ci_058                -7.235036e-03 3 1  ON 57
ci_059                -7.121566e-03 3 1  ON 58
ci_060                 8.824695e-03 3 1  ON 59
ci_061                 8.741082e-03 3 1  ON 60
ci_062                -3.312978e-03 3 1  ON 61
ci_063                -3.419156e-03 3 1  ON 62
ci_064                -3.287080e-03 3 1  ON 63
ci_065                -4.108737e-03 3 1  ON 64
ci_066                 5.612429e-03 3 1  ON 65
ci_067                 5.815528e-03 3 1  ON 66
ci_068                -4.645305e-03 3 1  ON 67
ci_069                -4.506017e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1601
    reference variance = 0.191929
====================================================
  Execution time = 1.3984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0697e-01
  Total weights = 1.9563e+06
  Execution time = 1.8553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294581910244
                                         uncertainty =       0.001568808943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294581910244
                                         uncertainty =       0.001568808943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383767064
  error estimate for blocks of size 2^( 2) =       0.000394048717
  error estimate for blocks of size 2^( 3) =       0.000402755699
  error estimate for blocks of size 2^( 4) =       0.000409222198
  error estimate for blocks of size 2^( 5) =       0.000413493406
  error estimate for blocks of size 2^( 6) =       0.000415402747
  error estimate for blocks of size 2^( 7) =       0.000417202956

      target function =                  N/A
              le_mean =     -17.216229855857
             les_mean =     296.706475623843
             stat err =       0.000413830327
             autocorr =       1.162811259835
              std dev =       0.542728586670
             le_variance =       0.294554318789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294554404147
                                         uncertainty =       0.001540539223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294554404147
                                         uncertainty =       0.001540539223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383748147
  error estimate for blocks of size 2^( 2) =       0.000394049745
  error estimate for blocks of size 2^( 3) =       0.000402788474
  error estimate for blocks of size 2^( 4) =       0.000409248176
  error estimate for blocks of size 2^( 5) =       0.000413564969
  error estimate for blocks of size 2^( 6) =       0.000415416044
  error estimate for blocks of size 2^( 7) =       0.000417193897

      target function =                  N/A
              le_mean =     -17.216234957262
             les_mean =     296.708602740375
             stat err =       0.000413855772
             autocorr =       1.163068920355
              std dev =       0.542701833381
             le_variance =       0.294525279955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295004685656
                                         uncertainty =       0.001587888962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295004685656
                                         uncertainty =       0.001587888962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384040875
  error estimate for blocks of size 2^( 2) =       0.000394344323
  error estimate for blocks of size 2^( 3) =       0.000403084808
  error estimate for blocks of size 2^( 4) =       0.000409541978
  error estimate for blocks of size 2^( 5) =       0.000413899483
  error estimate for blocks of size 2^( 6) =       0.000415707329
  error estimate for blocks of size 2^( 7) =       0.000417407148

      target function =                  N/A
              le_mean =     -17.216231749106
             les_mean =     297.005149217966
             stat err =       0.000414138985
             autocorr =       1.162886495565
              std dev =       0.543115814119
             le_variance =       0.294974787546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294494660278
                                         uncertainty =       0.001561119921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294494660278
                                         uncertainty =       0.001561119921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383710050
  error estimate for blocks of size 2^( 2) =       0.000393997021
  error estimate for blocks of size 2^( 3) =       0.000402712845
  error estimate for blocks of size 2^( 4) =       0.000409176913
  error estimate for blocks of size 2^( 5) =       0.000413460356
  error estimate for blocks of size 2^( 6) =       0.000415356250
  error estimate for blocks of size 2^( 7) =       0.000417147423

      target function =                  N/A
              le_mean =     -17.216219774466
             les_mean =     296.705803746289
             stat err =       0.000413785236
             autocorr =       1.162903377042
              std dev =       0.542647957303
             le_variance =       0.294466805566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216229855857        initial
     5.9605e-02     5.9605e-01             1.6927e-03       -17.216234957262  <--
     2.3842e-01     2.3842e+00             9.4831e-04       -17.216231749106
     9.5367e-01     9.5367e+00             3.4579e-04       -17.216219774466

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.3563e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.174693e-02 3 1  ON 0
ci_002                -3.133268e-02 3 1  ON 1
ci_003                -2.473396e-02 3 1  ON 2
ci_004                 2.015617e-02 3 1  ON 3
ci_005                 2.210512e-02 3 1  ON 4
ci_006                -2.062378e-02 3 1  ON 5
ci_007                -1.983582e-02 3 1  ON 6
ci_008                -1.879747e-02 3 1  ON 7
ci_009                -1.788172e-02 3 1  ON 8
ci_010                -1.662752e-02 3 1  ON 9
ci_011                -1.527387e-02 3 1  ON 10
ci_012                -1.655887e-02 3 1  ON 11
ci_013                -1.923912e-02 3 1  ON 12
ci_014                 1.371474e-02 3 1  ON 13
ci_015                 1.556339e-02 3 1  ON 14
ci_016                 1.635203e-02 3 1  ON 15
ci_017                 1.590635e-02 3 1  ON 16
ci_018                 1.294820e-02 3 1  ON 17
ci_019                 1.431401e-02 3 1  ON 18
ci_020                 1.328269e-02 3 1  ON 19
ci_021                 1.273637e-02 3 1  ON 20
ci_022                 1.119962e-02 3 1  ON 21
ci_023                 1.146352e-02 3 1  ON 22
ci_024                 1.170459e-02 3 1  ON 23
ci_025                 1.074718e-02 3 1  ON 24
ci_026                 1.189364e-02 3 1  ON 25
ci_027                 1.209320e-02 3 1  ON 26
ci_028                -1.361180e-02 3 1  ON 27
ci_029                -1.476080e-02 3 1  ON 28
ci_030                -1.079217e-02 3 1  ON 29
ci_031                -1.088898e-02 3 1  ON 30
ci_032                -1.357734e-02 3 1  ON 31
ci_033                 9.508779e-03 3 1  ON 32
ci_034                 1.056453e-02 3 1  ON 33
ci_035                -5.098167e-03 3 1  ON 34
ci_036                -1.066628e-02 3 1  ON 35
ci_037                -1.137727e-02 3 1  ON 36
ci_038                 1.445958e-03 3 1  ON 37
ci_039                 1.341621e-03 3 1  ON 38
ci_040                -4.101755e-03 3 1  ON 39
ci_041                 1.028076e-02 3 1  ON 40
ci_042                 9.623440e-03 3 1  ON 41
ci_043                -3.012556e-03 3 1  ON 42
ci_044                -1.602491e-02 3 1  ON 43
ci_045                -1.802207e-03 3 1  ON 44
ci_046                 5.929978e-03 3 1  ON 45
ci_047                 5.646002e-03 3 1  ON 46
ci_048                -1.250619e-02 3 1  ON 47
ci_049                -1.287775e-02 3 1  ON 48
ci_050                 7.314281e-03 3 1  ON 49
ci_051                 8.295251e-03 3 1  ON 50
ci_052                -6.635971e-03 3 1  ON 51
ci_053                -6.186174e-03 3 1  ON 52
ci_054                -2.505414e-03 3 1  ON 53
ci_055                -2.201070e-03 3 1  ON 54
ci_056                 4.175785e-03 3 1  ON 55
ci_057                 5.443475e-03 3 1  ON 56
ci_058                -7.069955e-03 3 1  ON 57
ci_059                -6.997268e-03 3 1  ON 58
ci_060                 8.921987e-03 3 1  ON 59
ci_061                 8.913021e-03 3 1  ON 60
ci_062                -3.290919e-03 3 1  ON 61
ci_063                -3.668886e-03 3 1  ON 62
ci_064                -3.286916e-03 3 1  ON 63
ci_065                -4.087436e-03 3 1  ON 64
ci_066                 5.658057e-03 3 1  ON 65
ci_067                 5.645554e-03 3 1  ON 66
ci_068                -4.691869e-03 3 1  ON 67
ci_069                -4.222279e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2439
    reference variance = 0.303485
====================================================
  Execution time = 1.4378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1283e-01
  Total weights = 1.956958780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299626089113
                                         uncertainty =       0.002072551909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299626089113
                                         uncertainty =       0.002072551909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387053224
  error estimate for blocks of size 2^( 2) =       0.000397247958
  error estimate for blocks of size 2^( 3) =       0.000405763473
  error estimate for blocks of size 2^( 4) =       0.000412159789
  error estimate for blocks of size 2^( 5) =       0.000417274566
  error estimate for blocks of size 2^( 6) =       0.000419552098
  error estimate for blocks of size 2^( 7) =       0.000420529740

      target function =                  N/A
              le_mean =     -17.216554725519
             les_mean =     296.722589120132
             stat err =       0.000417379048
             autocorr =       1.162839863244
              std dev =       0.547375918140
             le_variance =       0.299620395759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655472552e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554725591       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216608947812       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216615033871       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216614828357       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216614799403       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 2.217238e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554725591       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601297556       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605762714       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605624508       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605602113       residual = 6.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.779210e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554725591       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584496075       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216586591866       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216586559213       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 9.928175e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6902e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.188762e-02 3 1  ON 0
ci_002                -3.095669e-02 3 1  ON 1
ci_003                -2.424372e-02 3 1  ON 2
ci_004                 2.193538e-02 3 1  ON 3
ci_005                 2.153145e-02 3 1  ON 4
ci_006                -1.994361e-02 3 1  ON 5
ci_007                -1.921786e-02 3 1  ON 6
ci_008                -1.845261e-02 3 1  ON 7
ci_009                -1.833699e-02 3 1  ON 8
ci_010                -1.729570e-02 3 1  ON 9
ci_011                -1.549293e-02 3 1  ON 10
ci_012                -1.662449e-02 3 1  ON 11
ci_013                -1.888655e-02 3 1  ON 12
ci_014                 1.361245e-02 3 1  ON 13
ci_015                 1.422181e-02 3 1  ON 14
ci_016                 1.623019e-02 3 1  ON 15
ci_017                 1.670813e-02 3 1  ON 16
ci_018                 1.343894e-02 3 1  ON 17
ci_019                 1.328602e-02 3 1  ON 18
ci_020                 1.460783e-02 3 1  ON 19
ci_021                 1.357270e-02 3 1  ON 20
ci_022                 1.181193e-02 3 1  ON 21
ci_023                 1.093070e-02 3 1  ON 22
ci_024                 1.128185e-02 3 1  ON 23
ci_025                 1.122365e-02 3 1  ON 24
ci_026                 1.154757e-02 3 1  ON 25
ci_027                 1.214634e-02 3 1  ON 26
ci_028                -1.418279e-02 3 1  ON 27
ci_029                -1.520004e-02 3 1  ON 28
ci_030                -1.029937e-02 3 1  ON 29
ci_031                -1.062262e-02 3 1  ON 30
ci_032                -1.326750e-02 3 1  ON 31
ci_033                 9.741423e-03 3 1  ON 32
ci_034                 1.020533e-02 3 1  ON 33
ci_035                -5.019637e-03 3 1  ON 34
ci_036                -1.024429e-02 3 1  ON 35
ci_037                -1.077289e-02 3 1  ON 36
ci_038                 1.573370e-03 3 1  ON 37
ci_039                 1.159272e-03 3 1  ON 38
ci_040                -4.126473e-03 3 1  ON 39
ci_041                 1.005504e-02 3 1  ON 40
ci_042                 9.586265e-03 3 1  ON 41
ci_043                -3.701245e-03 3 1  ON 42
ci_044                -1.536561e-02 3 1  ON 43
ci_045                -1.763418e-03 3 1  ON 44
ci_046                 4.973510e-03 3 1  ON 45
ci_047                 4.961160e-03 3 1  ON 46
ci_048                -1.207781e-02 3 1  ON 47
ci_049                -1.250045e-02 3 1  ON 48
ci_050                 7.782219e-03 3 1  ON 49
ci_051                 7.824141e-03 3 1  ON 50
ci_052                -6.959365e-03 3 1  ON 51
ci_053                -7.068025e-03 3 1  ON 52
ci_054                -2.167477e-03 3 1  ON 53
ci_055                -2.249513e-03 3 1  ON 54
ci_056                 5.370968e-03 3 1  ON 55
ci_057                 5.632533e-03 3 1  ON 56
ci_058                -7.725847e-03 3 1  ON 57
ci_059                -7.564214e-03 3 1  ON 58
ci_060                 9.213115e-03 3 1  ON 59
ci_061                 8.733520e-03 3 1  ON 60
ci_062                -2.806328e-03 3 1  ON 61
ci_063                -2.900624e-03 3 1  ON 62
ci_064                -3.293018e-03 3 1  ON 63
ci_065                -4.108847e-03 3 1  ON 64
ci_066                 6.149392e-03 3 1  ON 65
ci_067                 6.526927e-03 3 1  ON 66
ci_068                -5.289432e-03 3 1  ON 67
ci_069                -4.510667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.234948
====================================================
  Execution time = 1.4002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0918e-01
  Total weights = 1.9566e+06
  Execution time = 1.8600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.122378
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297858375350
                                         uncertainty =       0.001817676331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297858375350
                                         uncertainty =       0.001817676331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385885197
  error estimate for blocks of size 2^( 2) =       0.000395603320
  error estimate for blocks of size 2^( 3) =       0.000404444571
  error estimate for blocks of size 2^( 4) =       0.000410592678
  error estimate for blocks of size 2^( 5) =       0.000413043780
  error estimate for blocks of size 2^( 6) =       0.000415497820
  error estimate for blocks of size 2^( 7) =       0.000416420462

      target function =                  N/A
              le_mean =     -17.217108633960
             les_mean =     296.781082048343
             stat err =       0.000413888685
             autocorr =       1.150405290664
              std dev =       0.545724078548
             le_variance =       0.297814769907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297610358995
                                         uncertainty =       0.001803514576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297610358995
                                         uncertainty =       0.001803514576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385723394
  error estimate for blocks of size 2^( 2) =       0.000395423801
  error estimate for blocks of size 2^( 3) =       0.000404268820
  error estimate for blocks of size 2^( 4) =       0.000410471974
  error estimate for blocks of size 2^( 5) =       0.000412933265
  error estimate for blocks of size 2^( 6) =       0.000415295113
  error estimate for blocks of size 2^( 7) =       0.000416080003

      target function =                  N/A
              le_mean =     -17.217048118353
             les_mean =     296.736821923501
             stat err =       0.000413695089
             autocorr =       1.150293779991
              std dev =       0.545495255129
             le_variance =       0.297565073368

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.118099
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298374220071
                                         uncertainty =       0.001827671936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298374220071
                                         uncertainty =       0.001827671936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386218097
  error estimate for blocks of size 2^( 2) =       0.000395905375
  error estimate for blocks of size 2^( 3) =       0.000404757694
  error estimate for blocks of size 2^( 4) =       0.000410972461
  error estimate for blocks of size 2^( 5) =       0.000413447258
  error estimate for blocks of size 2^( 6) =       0.000415733413
  error estimate for blocks of size 2^( 7) =       0.000416454350

      target function =                  N/A
              le_mean =     -17.217106371553
             les_mean =     296.755837857587
             stat err =       0.000414151871
             autocorr =       1.149883956116
              std dev =       0.546194871406
             le_variance =       0.298328837551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297603449933
                                         uncertainty =       0.001800115807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297603449933
                                         uncertainty =       0.001800115807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385719217
  error estimate for blocks of size 2^( 2) =       0.000395425943
  error estimate for blocks of size 2^( 3) =       0.000404273416
  error estimate for blocks of size 2^( 4) =       0.000410465203
  error estimate for blocks of size 2^( 5) =       0.000412927311
  error estimate for blocks of size 2^( 6) =       0.000415327204
  error estimate for blocks of size 2^( 7) =       0.000416181398

      target function =                  N/A
              le_mean =     -17.217055982529
             les_mean =     296.758834512727
             stat err =       0.000413725279
             autocorr =       1.150486595484
              std dev =       0.545489347656
             le_variance =       0.297558628407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217108633960        initial  <--
     1.4901e-02     1.4901e-01             2.2172e-03       -17.217048118353
     5.9605e-02     5.9605e-01             1.7792e-03       -17.217106371553
     2.3842e-01     2.3842e+00             9.9282e-04       -17.217055982529

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4055
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.174693e-02 3 1  ON 0
ci_002                -3.133268e-02 3 1  ON 1
ci_003                -2.473396e-02 3 1  ON 2
ci_004                 2.015617e-02 3 1  ON 3
ci_005                 2.210512e-02 3 1  ON 4
ci_006                -2.062378e-02 3 1  ON 5
ci_007                -1.983582e-02 3 1  ON 6
ci_008                -1.879747e-02 3 1  ON 7
ci_009                -1.788172e-02 3 1  ON 8
ci_010                -1.662752e-02 3 1  ON 9
ci_011                -1.527387e-02 3 1  ON 10
ci_012                -1.655887e-02 3 1  ON 11
ci_013                -1.923912e-02 3 1  ON 12
ci_014                 1.371474e-02 3 1  ON 13
ci_015                 1.556339e-02 3 1  ON 14
ci_016                 1.635203e-02 3 1  ON 15
ci_017                 1.590635e-02 3 1  ON 16
ci_018                 1.294820e-02 3 1  ON 17
ci_019                 1.431401e-02 3 1  ON 18
ci_020                 1.328269e-02 3 1  ON 19
ci_021                 1.273637e-02 3 1  ON 20
ci_022                 1.119962e-02 3 1  ON 21
ci_023                 1.146352e-02 3 1  ON 22
ci_024                 1.170459e-02 3 1  ON 23
ci_025                 1.074718e-02 3 1  ON 24
ci_026                 1.189364e-02 3 1  ON 25
ci_027                 1.209320e-02 3 1  ON 26
ci_028                -1.361180e-02 3 1  ON 27
ci_029                -1.476080e-02 3 1  ON 28
ci_030                -1.079217e-02 3 1  ON 29
ci_031                -1.088898e-02 3 1  ON 30
ci_032                -1.357734e-02 3 1  ON 31
ci_033                 9.508779e-03 3 1  ON 32
ci_034                 1.056453e-02 3 1  ON 33
ci_035                -5.098167e-03 3 1  ON 34
ci_036                -1.066628e-02 3 1  ON 35
ci_037                -1.137727e-02 3 1  ON 36
ci_038                 1.445958e-03 3 1  ON 37
ci_039                 1.341621e-03 3 1  ON 38
ci_040                -4.101755e-03 3 1  ON 39
ci_041                 1.028076e-02 3 1  ON 40
ci_042                 9.623440e-03 3 1  ON 41
ci_043                -3.012556e-03 3 1  ON 42
ci_044                -1.602491e-02 3 1  ON 43
ci_045                -1.802207e-03 3 1  ON 44
ci_046                 5.929978e-03 3 1  ON 45
ci_047                 5.646002e-03 3 1  ON 46
ci_048                -1.250619e-02 3 1  ON 47
ci_049                -1.287775e-02 3 1  ON 48
ci_050                 7.314281e-03 3 1  ON 49
ci_051                 8.295251e-03 3 1  ON 50
ci_052                -6.635971e-03 3 1  ON 51
ci_053                -6.186174e-03 3 1  ON 52
ci_054                -2.505414e-03 3 1  ON 53
ci_055                -2.201070e-03 3 1  ON 54
ci_056                 4.175785e-03 3 1  ON 55
ci_057                 5.443475e-03 3 1  ON 56
ci_058                -7.069955e-03 3 1  ON 57
ci_059                -6.997268e-03 3 1  ON 58
ci_060                 8.921987e-03 3 1  ON 59
ci_061                 8.913021e-03 3 1  ON 60
ci_062                -3.290919e-03 3 1  ON 61
ci_063                -3.668886e-03 3 1  ON 62
ci_064                -3.286916e-03 3 1  ON 63
ci_065                -4.087436e-03 3 1  ON 64
ci_066                 5.658057e-03 3 1  ON 65
ci_067                 5.645554e-03 3 1  ON 66
ci_068                -4.691869e-03 3 1  ON 67
ci_069                -4.222279e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1366
    reference variance = 0.158511
====================================================
  Execution time = 1.4491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1929e-01
  Total weights = 1.956716432e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304015444044
                                         uncertainty =       0.004502563816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304015444044
                                         uncertainty =       0.004502563816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389899285
  error estimate for blocks of size 2^( 2) =       0.000399577832
  error estimate for blocks of size 2^( 3) =       0.000408600557
  error estimate for blocks of size 2^( 4) =       0.000415004559
  error estimate for blocks of size 2^( 5) =       0.000418383838
  error estimate for blocks of size 2^( 6) =       0.000419419446
  error estimate for blocks of size 2^( 7) =       0.000421565946

      target function =                  N/A
              le_mean =     -17.216200724662
             les_mean =     296.716852782948
             stat err =       0.000418593447
             autocorr =       1.152603605358
              std dev =       0.551400856514
             le_variance =       0.304042904565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620072466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216200724777       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216242321054       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216241424257       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216241625706       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.499862e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216200724777       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220396293       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220556420       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 6.884779e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216200724777       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216207053387       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216207261352       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216207255921       residual = 1.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 2.182438e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7088e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.171333e-02 3 1  ON 0
ci_002                -3.098730e-02 3 1  ON 1
ci_003                -2.474334e-02 3 1  ON 2
ci_004                 2.057860e-02 3 1  ON 3
ci_005                 2.202236e-02 3 1  ON 4
ci_006                -2.041674e-02 3 1  ON 5
ci_007                -2.000240e-02 3 1  ON 6
ci_008                -1.857222e-02 3 1  ON 7
ci_009                -1.786506e-02 3 1  ON 8
ci_010                -1.668060e-02 3 1  ON 9
ci_011                -1.560236e-02 3 1  ON 10
ci_012                -1.662481e-02 3 1  ON 11
ci_013                -1.928705e-02 3 1  ON 12
ci_014                 1.348429e-02 3 1  ON 13
ci_015                 1.487492e-02 3 1  ON 14
ci_016                 1.623954e-02 3 1  ON 15
ci_017                 1.602316e-02 3 1  ON 16
ci_018                 1.316366e-02 3 1  ON 17
ci_019                 1.406402e-02 3 1  ON 18
ci_020                 1.335433e-02 3 1  ON 19
ci_021                 1.307110e-02 3 1  ON 20
ci_022                 1.154518e-02 3 1  ON 21
ci_023                 1.162379e-02 3 1  ON 22
ci_024                 1.173345e-02 3 1  ON 23
ci_025                 1.105050e-02 3 1  ON 24
ci_026                 1.198571e-02 3 1  ON 25
ci_027                 1.212944e-02 3 1  ON 26
ci_028                -1.374644e-02 3 1  ON 27
ci_029                -1.482450e-02 3 1  ON 28
ci_030                -1.091851e-02 3 1  ON 29
ci_031                -1.102916e-02 3 1  ON 30
ci_032                -1.379694e-02 3 1  ON 31
ci_033                 9.668303e-03 3 1  ON 32
ci_034                 1.043776e-02 3 1  ON 33
ci_035                -5.125943e-03 3 1  ON 34
ci_036                -1.045929e-02 3 1  ON 35
ci_037                -1.108273e-02 3 1  ON 36
ci_038                 1.345437e-03 3 1  ON 37
ci_039                 1.308856e-03 3 1  ON 38
ci_040                -4.090664e-03 3 1  ON 39
ci_041                 1.016677e-02 3 1  ON 40
ci_042                 9.701372e-03 3 1  ON 41
ci_043                -2.980739e-03 3 1  ON 42
ci_044                -1.585155e-02 3 1  ON 43
ci_045                -1.796638e-03 3 1  ON 44
ci_046                 5.758477e-03 3 1  ON 45
ci_047                 5.654092e-03 3 1  ON 46
ci_048                -1.247210e-02 3 1  ON 47
ci_049                -1.270926e-02 3 1  ON 48
ci_050                 7.396418e-03 3 1  ON 49
ci_051                 7.904885e-03 3 1  ON 50
ci_052                -6.751537e-03 3 1  ON 51
ci_053                -6.541442e-03 3 1  ON 52
ci_054                -2.499509e-03 3 1  ON 53
ci_055                -2.256595e-03 3 1  ON 54
ci_056                 4.308186e-03 3 1  ON 55
ci_057                 4.959121e-03 3 1  ON 56
ci_058                -7.288090e-03 3 1  ON 57
ci_059                -7.110903e-03 3 1  ON 58
ci_060                 8.753673e-03 3 1  ON 59
ci_061                 9.170356e-03 3 1  ON 60
ci_062                -3.166637e-03 3 1  ON 61
ci_063                -3.270454e-03 3 1  ON 62
ci_064                -3.274816e-03 3 1  ON 63
ci_065                -4.212046e-03 3 1  ON 64
ci_066                 5.633048e-03 3 1  ON 65
ci_067                 5.826478e-03 3 1  ON 66
ci_068                -4.669163e-03 3 1  ON 67
ci_069                -4.314857e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2189
    reference variance = 0.257471
====================================================
  Execution time = 1.4123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1001e-01
  Total weights = 1.9567e+06
  Execution time = 1.8568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296386325713
                                         uncertainty =       0.001734184669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296386325713
                                         uncertainty =       0.001734184669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384958248
  error estimate for blocks of size 2^( 2) =       0.000395097859
  error estimate for blocks of size 2^( 3) =       0.000403994028
  error estimate for blocks of size 2^( 4) =       0.000410224675
  error estimate for blocks of size 2^( 5) =       0.000414632796
  error estimate for blocks of size 2^( 6) =       0.000415773046
  error estimate for blocks of size 2^( 7) =       0.000419330896

      target function =                  N/A
              le_mean =     -17.217152920845
             les_mean =     296.746782630994
             stat err =       0.000414990353
             autocorr =       1.162114027239
              std dev =       0.544413175892
             le_variance =       0.296385706085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296323858076
                                         uncertainty =       0.001725672499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296323858076
                                         uncertainty =       0.001725672499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384917810
  error estimate for blocks of size 2^( 2) =       0.000395052489
  error estimate for blocks of size 2^( 3) =       0.000403956584
  error estimate for blocks of size 2^( 4) =       0.000410212990
  error estimate for blocks of size 2^( 5) =       0.000414631867
  error estimate for blocks of size 2^( 6) =       0.000415770150
  error estimate for blocks of size 2^( 7) =       0.000419267530

      target function =                  N/A
              le_mean =     -17.217188134663
             les_mean =     296.759349028864
             stat err =       0.000414970634
             autocorr =       1.162247755534
              std dev =       0.544355987664
             le_variance =       0.296323441305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296279466895
                                         uncertainty =       0.001724102911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296279466895
                                         uncertainty =       0.001724102911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384889089
  error estimate for blocks of size 2^( 2) =       0.000395024768
  error estimate for blocks of size 2^( 3) =       0.000403930481
  error estimate for blocks of size 2^( 4) =       0.000410186970
  error estimate for blocks of size 2^( 5) =       0.000414603912
  error estimate for blocks of size 2^( 6) =       0.000415739746
  error estimate for blocks of size 2^( 7) =       0.000419242030

      target function =                  N/A
              le_mean =     -17.217184354014
             les_mean =     296.743996264845
             stat err =       0.000414943164
             autocorr =       1.162267330788
              std dev =       0.544315369155
             le_variance =       0.296279221099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296320846507
                                         uncertainty =       0.001731393644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296320846507
                                         uncertainty =       0.001731393644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384915744
  error estimate for blocks of size 2^( 2) =       0.000395057789
  error estimate for blocks of size 2^( 3) =       0.000403956173
  error estimate for blocks of size 2^( 4) =       0.000410186323
  error estimate for blocks of size 2^( 5) =       0.000414596510
  error estimate for blocks of size 2^( 6) =       0.000415742672
  error estimate for blocks of size 2^( 7) =       0.000419254662

      target function =                  N/A
              le_mean =     -17.217160946859
             les_mean =     296.756589031694
             stat err =       0.000414945042
             autocorr =       1.162116874959
              std dev =       0.544353066222
             le_variance =       0.296320260705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217152920845        initial
     1.4901e-01     1.4901e+00             1.4999e-03       -17.217188134663  <--
     5.9605e-01     5.9605e+00             6.8848e-04       -17.217184354014
     2.3842e+00     2.3842e+01             2.1824e-04       -17.217160946859

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.3505e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.166459e-02 3 1  ON 0
ci_002                -3.055901e-02 3 1  ON 1
ci_003                -2.475631e-02 3 1  ON 2
ci_004                 2.115883e-02 3 1  ON 3
ci_005                 2.190654e-02 3 1  ON 4
ci_006                -2.015453e-02 3 1  ON 5
ci_007                -2.021121e-02 3 1  ON 6
ci_008                -1.832686e-02 3 1  ON 7
ci_009                -1.784671e-02 3 1  ON 8
ci_010                -1.673549e-02 3 1  ON 9
ci_011                -1.599647e-02 3 1  ON 10
ci_012                -1.670833e-02 3 1  ON 11
ci_013                -1.935172e-02 3 1  ON 12
ci_014                 1.319487e-02 3 1  ON 13
ci_015                 1.406353e-02 3 1  ON 14
ci_016                 1.611227e-02 3 1  ON 15
ci_017                 1.615571e-02 3 1  ON 16
ci_018                 1.341461e-02 3 1  ON 17
ci_019                 1.378897e-02 3 1  ON 18
ci_020                 1.344653e-02 3 1  ON 19
ci_021                 1.351482e-02 3 1  ON 20
ci_022                 1.191707e-02 3 1  ON 21
ci_023                 1.181827e-02 3 1  ON 22
ci_024                 1.177773e-02 3 1  ON 23
ci_025                 1.149176e-02 3 1  ON 24
ci_026                 1.209297e-02 3 1  ON 25
ci_027                 1.219410e-02 3 1  ON 26
ci_028                -1.391915e-02 3 1  ON 27
ci_029                -1.488952e-02 3 1  ON 28
ci_030                -1.107291e-02 3 1  ON 29
ci_031                -1.120255e-02 3 1  ON 30
ci_032                -1.401771e-02 3 1  ON 31
ci_033                 9.892057e-03 3 1  ON 32
ci_034                 1.031229e-02 3 1  ON 33
ci_035                -5.150358e-03 3 1  ON 34
ci_036                -1.020012e-02 3 1  ON 35
ci_037                -1.071152e-02 3 1  ON 36
ci_038                 1.264416e-03 3 1  ON 37
ci_039                 1.283210e-03 3 1  ON 38
ci_040                -4.088242e-03 3 1  ON 39
ci_041                 1.004332e-02 3 1  ON 40
ci_042                 9.797341e-03 3 1  ON 41
ci_043                -2.948608e-03 3 1  ON 42
ci_044                -1.561412e-02 3 1  ON 43
ci_045                -1.792074e-03 3 1  ON 44
ci_046                 5.584283e-03 3 1  ON 45
ci_047                 5.666872e-03 3 1  ON 46
ci_048                -1.241359e-02 3 1  ON 47
ci_049                -1.246839e-02 3 1  ON 48
ci_050                 7.464931e-03 3 1  ON 49
ci_051                 7.558458e-03 3 1  ON 50
ci_052                -6.858616e-03 3 1  ON 51
ci_053                -6.875608e-03 3 1  ON 52
ci_054                -2.499113e-03 3 1  ON 53
ci_055                -2.320126e-03 3 1  ON 54
ci_056                 4.431383e-03 3 1  ON 55
ci_057                 4.514137e-03 3 1  ON 56
ci_058                -7.513971e-03 3 1  ON 57
ci_059                -7.222993e-03 3 1  ON 58
ci_060                 8.547582e-03 3 1  ON 59
ci_061                 9.451817e-03 3 1  ON 60
ci_062                -3.038287e-03 3 1  ON 61
ci_063                -2.854479e-03 3 1  ON 62
ci_064                -3.261012e-03 3 1  ON 63
ci_065                -4.308902e-03 3 1  ON 64
ci_066                 5.612921e-03 3 1  ON 65
ci_067                 5.994143e-03 3 1  ON 66
ci_068                -4.644766e-03 3 1  ON 67
ci_069                -4.406832e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.311698
====================================================
  Execution time = 1.4471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1121e-01
  Total weights = 1.956847656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298185322747
                                         uncertainty =       0.001798358187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298185322747
                                         uncertainty =       0.001798358187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386097988
  error estimate for blocks of size 2^( 2) =       0.000395930116
  error estimate for blocks of size 2^( 3) =       0.000404872226
  error estimate for blocks of size 2^( 4) =       0.000411876636
  error estimate for blocks of size 2^( 5) =       0.000415550047
  error estimate for blocks of size 2^( 6) =       0.000417722178
  error estimate for blocks of size 2^( 7) =       0.000416991018

      target function =                  N/A
              le_mean =     -17.216770773642
             les_mean =     296.728406491880
             stat err =       0.000415534970
             autocorr =       1.158297392356
              std dev =       0.546025011579
             le_variance =       0.298143313270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677077364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770773670       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790378122       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216793104326       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216793569517       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216793513650       residual = 1.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-02 is 1.514018e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770773670       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784966774       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216786074023       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216786231121       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.019643e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770773670       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777519092       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216777548011       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216777575984       residual = 7.95e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.535412e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7076e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.064495e-02 3 1  ON 0
ci_002                -3.109537e-02 3 1  ON 1
ci_003                -2.531802e-02 3 1  ON 2
ci_004                 2.153461e-02 3 1  ON 3
ci_005                 2.134797e-02 3 1  ON 4
ci_006                -1.953546e-02 3 1  ON 5
ci_007                -2.048509e-02 3 1  ON 6
ci_008                -1.832008e-02 3 1  ON 7
ci_009                -1.769696e-02 3 1  ON 8
ci_010                -1.633914e-02 3 1  ON 9
ci_011                -1.587327e-02 3 1  ON 10
ci_012                -1.641743e-02 3 1  ON 11
ci_013                -1.928737e-02 3 1  ON 12
ci_014                 1.345342e-02 3 1  ON 13
ci_015                 1.433526e-02 3 1  ON 14
ci_016                 1.607748e-02 3 1  ON 15
ci_017                 1.681112e-02 3 1  ON 16
ci_018                 1.349657e-02 3 1  ON 17
ci_019                 1.343021e-02 3 1  ON 18
ci_020                 1.360312e-02 3 1  ON 19
ci_021                 1.365071e-02 3 1  ON 20
ci_022                 1.211810e-02 3 1  ON 21
ci_023                 1.152615e-02 3 1  ON 22
ci_024                 1.162942e-02 3 1  ON 23
ci_025                 1.115787e-02 3 1  ON 24
ci_026                 1.238637e-02 3 1  ON 25
ci_027                 1.234959e-02 3 1  ON 26
ci_028                -1.351694e-02 3 1  ON 27
ci_029                -1.533422e-02 3 1  ON 28
ci_030                -1.078737e-02 3 1  ON 29
ci_031                -1.081031e-02 3 1  ON 30
ci_032                -1.376856e-02 3 1  ON 31
ci_033                 1.028141e-02 3 1  ON 32
ci_034                 1.030011e-02 3 1  ON 33
ci_035                -4.842997e-03 3 1  ON 34
ci_036                -1.059151e-02 3 1  ON 35
ci_037                -1.060949e-02 3 1  ON 36
ci_038                 1.146808e-03 3 1  ON 37
ci_039                 1.250613e-03 3 1  ON 38
ci_040                -3.996142e-03 3 1  ON 39
ci_041                 9.864447e-03 3 1  ON 40
ci_042                 1.009086e-02 3 1  ON 41
ci_043                -3.346130e-03 3 1  ON 42
ci_044                -1.551311e-02 3 1  ON 43
ci_045                -1.995875e-03 3 1  ON 44
ci_046                 5.797915e-03 3 1  ON 45
ci_047                 5.782715e-03 3 1  ON 46
ci_048                -1.178937e-02 3 1  ON 47
ci_049                -1.234100e-02 3 1  ON 48
ci_050                 7.494268e-03 3 1  ON 49
ci_051                 7.830983e-03 3 1  ON 50
ci_052                -7.258646e-03 3 1  ON 51
ci_053                -6.670290e-03 3 1  ON 52
ci_054                -2.478852e-03 3 1  ON 53
ci_055                -2.288738e-03 3 1  ON 54
ci_056                 4.582707e-03 3 1  ON 55
ci_057                 4.984474e-03 3 1  ON 56
ci_058                -7.539518e-03 3 1  ON 57
ci_059                -6.987462e-03 3 1  ON 58
ci_060                 8.589517e-03 3 1  ON 59
ci_061                 8.473610e-03 3 1  ON 60
ci_062                -2.933122e-03 3 1  ON 61
ci_063                -2.862063e-03 3 1  ON 62
ci_064                -3.418416e-03 3 1  ON 63
ci_065                -4.339447e-03 3 1  ON 64
ci_066                 6.397684e-03 3 1  ON 65
ci_067                 5.694427e-03 3 1  ON 66
ci_068                -4.983501e-03 3 1  ON 67
ci_069                -4.551041e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2586
    reference variance = 0.168044
====================================================
  Execution time = 1.4113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1389e-01
  Total weights = 1.9567e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923344115
                                         uncertainty =       0.002040120603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923344115
                                         uncertainty =       0.002040120603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386557517
  error estimate for blocks of size 2^( 2) =       0.000396633275
  error estimate for blocks of size 2^( 3) =       0.000405351938
  error estimate for blocks of size 2^( 4) =       0.000411227412
  error estimate for blocks of size 2^( 5) =       0.000415449852
  error estimate for blocks of size 2^( 6) =       0.000416903719
  error estimate for blocks of size 2^( 7) =       0.000416647500

      target function =                  N/A
              le_mean =     -17.216687102882
             les_mean =     296.755775292091
             stat err =       0.000415057121
             autocorr =       1.152888988534
              std dev =       0.546674883864
             le_variance =       0.298853428648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298675855669
                                         uncertainty =       0.002039032796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298675855669
                                         uncertainty =       0.002039032796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386398094
  error estimate for blocks of size 2^( 2) =       0.000396492357
  error estimate for blocks of size 2^( 3) =       0.000405215240
  error estimate for blocks of size 2^( 4) =       0.000411114040
  error estimate for blocks of size 2^( 5) =       0.000415393239
  error estimate for blocks of size 2^( 6) =       0.000416881570
  error estimate for blocks of size 2^( 7) =       0.000416705504

      target function =                  N/A
              le_mean =     -17.216672454799
             les_mean =     296.749767738405
             stat err =       0.000415023588
             autocorr =       1.153654093628
              std dev =       0.546449424682
             le_variance =       0.298606973735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298954919111
                                         uncertainty =       0.002066155583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298954919111
                                         uncertainty =       0.002066155583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386578346
  error estimate for blocks of size 2^( 2) =       0.000396675468
  error estimate for blocks of size 2^( 3) =       0.000405388000
  error estimate for blocks of size 2^( 4) =       0.000411282992
  error estimate for blocks of size 2^( 5) =       0.000415578769
  error estimate for blocks of size 2^( 6) =       0.000417061727
  error estimate for blocks of size 2^( 7) =       0.000416923380

      target function =                  N/A
              le_mean =     -17.216701644024
             les_mean =     296.789630937329
             stat err =       0.000415211717
             autocorr =       1.153623657077
              std dev =       0.546704340420
             le_variance =       0.298885635834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298794163685
                                         uncertainty =       0.002040435140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298794163685
                                         uncertainty =       0.002040435140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386474230
  error estimate for blocks of size 2^( 2) =       0.000396556246
  error estimate for blocks of size 2^( 3) =       0.000405275961
  error estimate for blocks of size 2^( 4) =       0.000411159459
  error estimate for blocks of size 2^( 5) =       0.000415402480
  error estimate for blocks of size 2^( 6) =       0.000416872001
  error estimate for blocks of size 2^( 7) =       0.000416650686

      target function =                  N/A
              le_mean =     -17.216677104890
             les_mean =     296.729273845422
             stat err =       0.000415021157
             autocorr =       1.153186082464
              std dev =       0.546557097279
             le_variance =       0.298724660586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216687102882        initial
     3.7253e-02     3.7253e-01             1.5140e-03       -17.216672454799
     1.4901e-01     1.4901e+00             1.0196e-03       -17.216701644024  <--
     5.9605e-01     5.9605e+00             4.5354e-04       -17.216677104890

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.3503e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.064495e-02 3 1  ON 0
ci_002                -3.109537e-02 3 1  ON 1
ci_003                -2.531802e-02 3 1  ON 2
ci_004                 2.153461e-02 3 1  ON 3
ci_005                 2.134797e-02 3 1  ON 4
ci_006                -1.953546e-02 3 1  ON 5
ci_007                -2.048509e-02 3 1  ON 6
ci_008                -1.832008e-02 3 1  ON 7
ci_009                -1.769696e-02 3 1  ON 8
ci_010                -1.633914e-02 3 1  ON 9
ci_011                -1.587327e-02 3 1  ON 10
ci_012                -1.641743e-02 3 1  ON 11
ci_013                -1.928737e-02 3 1  ON 12
ci_014                 1.345342e-02 3 1  ON 13
ci_015                 1.433526e-02 3 1  ON 14
ci_016                 1.607748e-02 3 1  ON 15
ci_017                 1.681112e-02 3 1  ON 16
ci_018                 1.349657e-02 3 1  ON 17
ci_019                 1.343021e-02 3 1  ON 18
ci_020                 1.360312e-02 3 1  ON 19
ci_021                 1.365071e-02 3 1  ON 20
ci_022                 1.211810e-02 3 1  ON 21
ci_023                 1.152615e-02 3 1  ON 22
ci_024                 1.162942e-02 3 1  ON 23
ci_025                 1.115787e-02 3 1  ON 24
ci_026                 1.238637e-02 3 1  ON 25
ci_027                 1.234959e-02 3 1  ON 26
ci_028                -1.351694e-02 3 1  ON 27
ci_029                -1.533422e-02 3 1  ON 28
ci_030                -1.078737e-02 3 1  ON 29
ci_031                -1.081031e-02 3 1  ON 30
ci_032                -1.376856e-02 3 1  ON 31
ci_033                 1.028141e-02 3 1  ON 32
ci_034                 1.030011e-02 3 1  ON 33
ci_035                -4.842997e-03 3 1  ON 34
ci_036                -1.059151e-02 3 1  ON 35
ci_037                -1.060949e-02 3 1  ON 36
ci_038                 1.146808e-03 3 1  ON 37
ci_039                 1.250613e-03 3 1  ON 38
ci_040                -3.996142e-03 3 1  ON 39
ci_041                 9.864447e-03 3 1  ON 40
ci_042                 1.009086e-02 3 1  ON 41
ci_043                -3.346130e-03 3 1  ON 42
ci_044                -1.551311e-02 3 1  ON 43
ci_045                -1.995875e-03 3 1  ON 44
ci_046                 5.797915e-03 3 1  ON 45
ci_047                 5.782715e-03 3 1  ON 46
ci_048                -1.178937e-02 3 1  ON 47
ci_049                -1.234100e-02 3 1  ON 48
ci_050                 7.494268e-03 3 1  ON 49
ci_051                 7.830983e-03 3 1  ON 50
ci_052                -7.258646e-03 3 1  ON 51
ci_053                -6.670290e-03 3 1  ON 52
ci_054                -2.478852e-03 3 1  ON 53
ci_055                -2.288738e-03 3 1  ON 54
ci_056                 4.582707e-03 3 1  ON 55
ci_057                 4.984474e-03 3 1  ON 56
ci_058                -7.539518e-03 3 1  ON 57
ci_059                -6.987462e-03 3 1  ON 58
ci_060                 8.589517e-03 3 1  ON 59
ci_061                 8.473610e-03 3 1  ON 60
ci_062                -2.933122e-03 3 1  ON 61
ci_063                -2.862063e-03 3 1  ON 62
ci_064                -3.418416e-03 3 1  ON 63
ci_065                -4.339447e-03 3 1  ON 64
ci_066                 6.397684e-03 3 1  ON 65
ci_067                 5.694427e-03 3 1  ON 66
ci_068                -4.983501e-03 3 1  ON 67
ci_069                -4.551041e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0594e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.168345
====================================================
  Execution time = 1.6672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1574e-01
  Total weights = 1.956741791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223902559
                                         uncertainty =       0.002286732719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300223902559
                                         uncertainty =       0.002286732719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387403794
  error estimate for blocks of size 2^( 2) =       0.000397633008
  error estimate for blocks of size 2^( 3) =       0.000406669631
  error estimate for blocks of size 2^( 4) =       0.000412804581
  error estimate for blocks of size 2^( 5) =       0.000416950223
  error estimate for blocks of size 2^( 6) =       0.000418636936
  error estimate for blocks of size 2^( 7) =       0.000419001621

      target function =                  N/A
              le_mean =     -17.217045417662
             les_mean =     296.742393138663
             stat err =       0.000416848340
             autocorr =       1.157786322282
              std dev =       0.547871699334
             le_variance =       0.300163398931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704541766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045417706       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217053221000       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217052317014       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217051985015       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217051946631       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-02 is 1.254661e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045417706       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217051108869       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217050330449       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217050137590       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 8.912752e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217045417706       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048150311       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217047719036       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217047682391       residual = 3.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.367522e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9262e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.074646e-02 3 1  ON 0
ci_002                -3.125830e-02 3 1  ON 1
ci_003                -2.474179e-02 3 1  ON 2
ci_004                 2.102963e-02 3 1  ON 3
ci_005                 2.160587e-02 3 1  ON 4
ci_006                -2.000197e-02 3 1  ON 5
ci_007                -1.962307e-02 3 1  ON 6
ci_008                -1.837070e-02 3 1  ON 7
ci_009                -1.858824e-02 3 1  ON 8
ci_010                -1.675205e-02 3 1  ON 9
ci_011                -1.649165e-02 3 1  ON 10
ci_012                -1.695049e-02 3 1  ON 11
ci_013                -1.984617e-02 3 1  ON 12
ci_014                 1.395490e-02 3 1  ON 13
ci_015                 1.424853e-02 3 1  ON 14
ci_016                 1.601100e-02 3 1  ON 15
ci_017                 1.596678e-02 3 1  ON 16
ci_018                 1.277704e-02 3 1  ON 17
ci_019                 1.337761e-02 3 1  ON 18
ci_020                 1.364217e-02 3 1  ON 19
ci_021                 1.361055e-02 3 1  ON 20
ci_022                 1.206923e-02 3 1  ON 21
ci_023                 1.173051e-02 3 1  ON 22
ci_024                 1.193692e-02 3 1  ON 23
ci_025                 1.116366e-02 3 1  ON 24
ci_026                 1.230211e-02 3 1  ON 25
ci_027                 1.212893e-02 3 1  ON 26
ci_028                -1.399223e-02 3 1  ON 27
ci_029                -1.529955e-02 3 1  ON 28
ci_030                -1.108475e-02 3 1  ON 29
ci_031                -1.089940e-02 3 1  ON 30
ci_032                -1.327865e-02 3 1  ON 31
ci_033                 1.070051e-02 3 1  ON 32
ci_034                 1.018107e-02 3 1  ON 33
ci_035                -5.391674e-03 3 1  ON 34
ci_036                -1.069701e-02 3 1  ON 35
ci_037                -1.093021e-02 3 1  ON 36
ci_038                 1.363850e-03 3 1  ON 37
ci_039                 1.247350e-03 3 1  ON 38
ci_040                -4.090477e-03 3 1  ON 39
ci_041                 1.006239e-02 3 1  ON 40
ci_042                 1.001794e-02 3 1  ON 41
ci_043                -3.438607e-03 3 1  ON 42
ci_044                -1.590559e-02 3 1  ON 43
ci_045                -2.190985e-03 3 1  ON 44
ci_046                 5.813339e-03 3 1  ON 45
ci_047                 5.377398e-03 3 1  ON 46
ci_048                -1.192177e-02 3 1  ON 47
ci_049                -1.231069e-02 3 1  ON 48
ci_050                 7.857412e-03 3 1  ON 49
ci_051                 8.437349e-03 3 1  ON 50
ci_052                -7.423010e-03 3 1  ON 51
ci_053                -7.020029e-03 3 1  ON 52
ci_054                -1.999882e-03 3 1  ON 53
ci_055                -2.538354e-03 3 1  ON 54
ci_056                 5.066945e-03 3 1  ON 55
ci_057                 5.122525e-03 3 1  ON 56
ci_058                -7.335443e-03 3 1  ON 57
ci_059                -7.195872e-03 3 1  ON 58
ci_060                 8.261907e-03 3 1  ON 59
ci_061                 8.831386e-03 3 1  ON 60
ci_062                -2.740671e-03 3 1  ON 61
ci_063                -2.741399e-03 3 1  ON 62
ci_064                -3.205334e-03 3 1  ON 63
ci_065                -4.301977e-03 3 1  ON 64
ci_066                 6.107777e-03 3 1  ON 65
ci_067                 5.808150e-03 3 1  ON 66
ci_068                -5.288939e-03 3 1  ON 67
ci_069                -4.605158e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1852
    reference variance = 0.36742
====================================================
  Execution time = 1.4084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1135e-01
  Total weights = 1.9566e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412363945
                                         uncertainty =       0.001765343358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296412363945
                                         uncertainty =       0.001765343358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384919159
  error estimate for blocks of size 2^( 2) =       0.000395264431
  error estimate for blocks of size 2^( 3) =       0.000404221381
  error estimate for blocks of size 2^( 4) =       0.000410609691
  error estimate for blocks of size 2^( 5) =       0.000414447522
  error estimate for blocks of size 2^( 6) =       0.000416619861
  error estimate for blocks of size 2^( 7) =       0.000417963368

      target function =                  N/A
              le_mean =     -17.216891833857
             les_mean =     296.733762681743
             stat err =       0.000414910111
             autocorr =       1.161900609835
              std dev =       0.544357894833
             le_variance =       0.296325517667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297501903149
                                         uncertainty =       0.001787784996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297501903149
                                         uncertainty =       0.001787784996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385625983
  error estimate for blocks of size 2^( 2) =       0.000395905821
  error estimate for blocks of size 2^( 3) =       0.000404798640
  error estimate for blocks of size 2^( 4) =       0.000411118072
  error estimate for blocks of size 2^( 5) =       0.000414902272
  error estimate for blocks of size 2^( 6) =       0.000417115651
  error estimate for blocks of size 2^( 7) =       0.000418422312

      target function =                  N/A
              le_mean =     -17.216862878658
             les_mean =     296.732730976682
             stat err =       0.000415389577
             autocorr =       1.160322231041
              std dev =       0.545357494627
             le_variance =       0.297414796946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298465467055
                                         uncertainty =       0.001814392223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298465467055
                                         uncertainty =       0.001814392223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250036
  error estimate for blocks of size 2^( 2) =       0.000396493746
  error estimate for blocks of size 2^( 3) =       0.000405349929
  error estimate for blocks of size 2^( 4) =       0.000411630748
  error estimate for blocks of size 2^( 5) =       0.000415371101
  error estimate for blocks of size 2^( 6) =       0.000417608913
  error estimate for blocks of size 2^( 7) =       0.000418880048

      target function =                  N/A
              le_mean =     -17.216866436517
             les_mean =     296.822949807616
             stat err =       0.000415872702
             autocorr =       1.159267772644
              std dev =       0.546240039776
             le_variance =       0.298378181054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296730576631
                                         uncertainty =       0.001772426346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296730576631
                                         uncertainty =       0.001772426346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385125759
  error estimate for blocks of size 2^( 2) =       0.000395446443
  error estimate for blocks of size 2^( 3) =       0.000404380466
  error estimate for blocks of size 2^( 4) =       0.000410746650
  error estimate for blocks of size 2^( 5) =       0.000414560960
  error estimate for blocks of size 2^( 6) =       0.000416748546
  error estimate for blocks of size 2^( 7) =       0.000418088036

      target function =                  N/A
              le_mean =     -17.216870208419
             les_mean =     296.741080546177
             stat err =       0.000415036048
             autocorr =       1.161359036716
              std dev =       0.544650071571
             le_variance =       0.296643700462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216891833857        initial  <--
     3.7253e-02     3.7253e-01             1.2547e-03       -17.216862878658
     1.4901e-01     1.4901e+00             8.9128e-04       -17.216866436517
     5.9605e-01     5.9605e+00             4.3675e-04       -17.216870208419

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4554
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.064495e-02 3 1  ON 0
ci_002                -3.109537e-02 3 1  ON 1
ci_003                -2.531802e-02 3 1  ON 2
ci_004                 2.153461e-02 3 1  ON 3
ci_005                 2.134797e-02 3 1  ON 4
ci_006                -1.953546e-02 3 1  ON 5
ci_007                -2.048509e-02 3 1  ON 6
ci_008                -1.832008e-02 3 1  ON 7
ci_009                -1.769696e-02 3 1  ON 8
ci_010                -1.633914e-02 3 1  ON 9
ci_011                -1.587327e-02 3 1  ON 10
ci_012                -1.641743e-02 3 1  ON 11
ci_013                -1.928737e-02 3 1  ON 12
ci_014                 1.345342e-02 3 1  ON 13
ci_015                 1.433526e-02 3 1  ON 14
ci_016                 1.607748e-02 3 1  ON 15
ci_017                 1.681112e-02 3 1  ON 16
ci_018                 1.349657e-02 3 1  ON 17
ci_019                 1.343021e-02 3 1  ON 18
ci_020                 1.360312e-02 3 1  ON 19
ci_021                 1.365071e-02 3 1  ON 20
ci_022                 1.211810e-02 3 1  ON 21
ci_023                 1.152615e-02 3 1  ON 22
ci_024                 1.162942e-02 3 1  ON 23
ci_025                 1.115787e-02 3 1  ON 24
ci_026                 1.238637e-02 3 1  ON 25
ci_027                 1.234959e-02 3 1  ON 26
ci_028                -1.351694e-02 3 1  ON 27
ci_029                -1.533422e-02 3 1  ON 28
ci_030                -1.078737e-02 3 1  ON 29
ci_031                -1.081031e-02 3 1  ON 30
ci_032                -1.376856e-02 3 1  ON 31
ci_033                 1.028141e-02 3 1  ON 32
ci_034                 1.030011e-02 3 1  ON 33
ci_035                -4.842997e-03 3 1  ON 34
ci_036                -1.059151e-02 3 1  ON 35
ci_037                -1.060949e-02 3 1  ON 36
ci_038                 1.146808e-03 3 1  ON 37
ci_039                 1.250613e-03 3 1  ON 38
ci_040                -3.996142e-03 3 1  ON 39
ci_041                 9.864447e-03 3 1  ON 40
ci_042                 1.009086e-02 3 1  ON 41
ci_043                -3.346130e-03 3 1  ON 42
ci_044                -1.551311e-02 3 1  ON 43
ci_045                -1.995875e-03 3 1  ON 44
ci_046                 5.797915e-03 3 1  ON 45
ci_047                 5.782715e-03 3 1  ON 46
ci_048                -1.178937e-02 3 1  ON 47
ci_049                -1.234100e-02 3 1  ON 48
ci_050                 7.494268e-03 3 1  ON 49
ci_051                 7.830983e-03 3 1  ON 50
ci_052                -7.258646e-03 3 1  ON 51
ci_053                -6.670290e-03 3 1  ON 52
ci_054                -2.478852e-03 3 1  ON 53
ci_055                -2.288738e-03 3 1  ON 54
ci_056                 4.582707e-03 3 1  ON 55
ci_057                 4.984474e-03 3 1  ON 56
ci_058                -7.539518e-03 3 1  ON 57
ci_059                -6.987462e-03 3 1  ON 58
ci_060                 8.589517e-03 3 1  ON 59
ci_061                 8.473610e-03 3 1  ON 60
ci_062                -2.933122e-03 3 1  ON 61
ci_063                -2.862063e-03 3 1  ON 62
ci_064                -3.418416e-03 3 1  ON 63
ci_065                -4.339447e-03 3 1  ON 64
ci_066                 6.397684e-03 3 1  ON 65
ci_067                 5.694427e-03 3 1  ON 66
ci_068                -4.983501e-03 3 1  ON 67
ci_069                -4.551041e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1674
    reference variance = 0.169296
====================================================
  Execution time = 1.4576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1506e-01
  Total weights = 1.956838986e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297324810360
                                         uncertainty =       0.002170970175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297324810360
                                         uncertainty =       0.002170970175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385514993
  error estimate for blocks of size 2^( 2) =       0.000395517851
  error estimate for blocks of size 2^( 3) =       0.000404424313
  error estimate for blocks of size 2^( 4) =       0.000411062961
  error estimate for blocks of size 2^( 5) =       0.000414056788
  error estimate for blocks of size 2^( 6) =       0.000416018365
  error estimate for blocks of size 2^( 7) =       0.000418927755

      target function =                  N/A
              le_mean =     -17.216926472507
             les_mean =     296.737618523479
             stat err =       0.000415016468
             autocorr =       1.158905739026
              std dev =       0.545200531527
             le_variance =       0.297243619577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692647251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926472587       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926969746       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926821074       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216926740859       residual = 5.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 6.054383e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926472587       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926653413       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926589467       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.995276e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216926472587       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216926523594       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216926505443       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 5.422362e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7161e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.070894e-02 3 1  ON 0
ci_002                -3.100043e-02 3 1  ON 1
ci_003                -2.531473e-02 3 1  ON 2
ci_004                 2.152992e-02 3 1  ON 3
ci_005                 2.154750e-02 3 1  ON 4
ci_006                -1.947913e-02 3 1  ON 5
ci_007                -2.048885e-02 3 1  ON 6
ci_008                -1.838121e-02 3 1  ON 7
ci_009                -1.777460e-02 3 1  ON 8
ci_010                -1.636387e-02 3 1  ON 9
ci_011                -1.584517e-02 3 1  ON 10
ci_012                -1.642901e-02 3 1  ON 11
ci_013                -1.924318e-02 3 1  ON 12
ci_014                 1.348947e-02 3 1  ON 13
ci_015                 1.441419e-02 3 1  ON 14
ci_016                 1.610358e-02 3 1  ON 15
ci_017                 1.679496e-02 3 1  ON 16
ci_018                 1.346408e-02 3 1  ON 17
ci_019                 1.341409e-02 3 1  ON 18
ci_020                 1.364563e-02 3 1  ON 19
ci_021                 1.354452e-02 3 1  ON 20
ci_022                 1.219625e-02 3 1  ON 21
ci_023                 1.154057e-02 3 1  ON 22
ci_024                 1.166397e-02 3 1  ON 23
ci_025                 1.111143e-02 3 1  ON 24
ci_026                 1.225111e-02 3 1  ON 25
ci_027                 1.232953e-02 3 1  ON 26
ci_028                -1.362547e-02 3 1  ON 27
ci_029                -1.530479e-02 3 1  ON 28
ci_030                -1.081974e-02 3 1  ON 29
ci_031                -1.082944e-02 3 1  ON 30
ci_032                -1.380874e-02 3 1  ON 31
ci_033                 1.028660e-02 3 1  ON 32
ci_034                 1.035972e-02 3 1  ON 33
ci_035                -4.957251e-03 3 1  ON 34
ci_036                -1.055320e-02 3 1  ON 35
ci_037                -1.059487e-02 3 1  ON 36
ci_038                 1.184935e-03 3 1  ON 37
ci_039                 1.290639e-03 3 1  ON 38
ci_040                -3.976216e-03 3 1  ON 39
ci_041                 9.750469e-03 3 1  ON 40
ci_042                 1.001183e-02 3 1  ON 41
ci_043                -3.364439e-03 3 1  ON 42
ci_044                -1.538085e-02 3 1  ON 43
ci_045                -1.923808e-03 3 1  ON 44
ci_046                 5.793228e-03 3 1  ON 45
ci_047                 5.670790e-03 3 1  ON 46
ci_048                -1.179081e-02 3 1  ON 47
ci_049                -1.238496e-02 3 1  ON 48
ci_050                 7.570223e-03 3 1  ON 49
ci_051                 7.905716e-03 3 1  ON 50
ci_052                -7.127365e-03 3 1  ON 51
ci_053                -6.724231e-03 3 1  ON 52
ci_054                -2.454224e-03 3 1  ON 53
ci_055                -2.197489e-03 3 1  ON 54
ci_056                 4.611964e-03 3 1  ON 55
ci_057                 4.969008e-03 3 1  ON 56
ci_058                -7.494122e-03 3 1  ON 57
ci_059                -7.064340e-03 3 1  ON 58
ci_060                 8.569087e-03 3 1  ON 59
ci_061                 8.500110e-03 3 1  ON 60
ci_062                -2.842408e-03 3 1  ON 61
ci_063                -2.801657e-03 3 1  ON 62
ci_064                -3.487265e-03 3 1  ON 63
ci_065                -4.314251e-03 3 1  ON 64
ci_066                 6.221263e-03 3 1  ON 65
ci_067                 5.761809e-03 3 1  ON 66
ci_068                -5.000134e-03 3 1  ON 67
ci_069                -4.554857e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.188905
====================================================
  Execution time = 1.4141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1385e-01
  Total weights = 1.9566e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296773661331
                                         uncertainty =       0.001914741031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296773661331
                                         uncertainty =       0.001914741031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385227046
  error estimate for blocks of size 2^( 2) =       0.000394990833
  error estimate for blocks of size 2^( 3) =       0.000403168431
  error estimate for blocks of size 2^( 4) =       0.000409148511
  error estimate for blocks of size 2^( 5) =       0.000412224844
  error estimate for blocks of size 2^( 6) =       0.000413037664
  error estimate for blocks of size 2^( 7) =       0.000413820673

      target function =                  N/A
              le_mean =     -17.216914086399
             les_mean =     296.737062630871
             stat err =       0.000412057923
             autocorr =       1.144150088426
              std dev =       0.544793312652
             le_variance =       0.296799753510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296776681642
                                         uncertainty =       0.001880000875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296776681642
                                         uncertainty =       0.001880000875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385229080
  error estimate for blocks of size 2^( 2) =       0.000394983282
  error estimate for blocks of size 2^( 3) =       0.000403152403
  error estimate for blocks of size 2^( 4) =       0.000409134739
  error estimate for blocks of size 2^( 5) =       0.000412208613
  error estimate for blocks of size 2^( 6) =       0.000413008432
  error estimate for blocks of size 2^( 7) =       0.000413792366

      target function =                  N/A
              le_mean =     -17.216917904408
             les_mean =     296.736340016402
             stat err =       0.000412036037
             autocorr =       1.144016467283
              std dev =       0.544796189965
             le_variance =       0.296802888601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296778044502
                                         uncertainty =       0.001890650199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296778044502
                                         uncertainty =       0.001890650199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385229965
  error estimate for blocks of size 2^( 2) =       0.000394986328
  error estimate for blocks of size 2^( 3) =       0.000403156754
  error estimate for blocks of size 2^( 4) =       0.000409137904
  error estimate for blocks of size 2^( 5) =       0.000412212820
  error estimate for blocks of size 2^( 6) =       0.000413016377
  error estimate for blocks of size 2^( 7) =       0.000413802265

      target function =                  N/A
              le_mean =     -17.216915657598
             les_mean =     296.736673207984
             stat err =       0.000412042342
             autocorr =       1.144046217853
              std dev =       0.544797441615
             le_variance =       0.296804252390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296770988146
                                         uncertainty =       0.001911189969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296770988146
                                         uncertainty =       0.001911189969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385225324
  error estimate for blocks of size 2^( 2) =       0.000394988182
  error estimate for blocks of size 2^( 3) =       0.000403164662
  error estimate for blocks of size 2^( 4) =       0.000409145146
  error estimate for blocks of size 2^( 5) =       0.000412221051
  error estimate for blocks of size 2^( 6) =       0.000413029741
  error estimate for blocks of size 2^( 7) =       0.000413813237

      target function =                  N/A
              le_mean =     -17.216914297025
             les_mean =     296.736447231437
             stat err =       0.000412052294
             autocorr =       1.144129051074
              std dev =       0.544790878180
             le_variance =       0.296797100948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216914086399        initial
     3.7253e-01     3.7253e+00             6.0544e-04       -17.216917904408  <--
     1.4901e+00     1.4901e+01             1.9953e-04       -17.216915657598
     5.9605e+00     5.9605e+01             5.4224e-05       -17.216914297025

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.3596e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.083489e-02 3 1  ON 0
ci_002                -3.082853e-02 3 1  ON 1
ci_003                -2.530072e-02 3 1  ON 2
ci_004                 2.152457e-02 3 1  ON 3
ci_005                 2.195341e-02 3 1  ON 4
ci_006                -1.936413e-02 3 1  ON 5
ci_007                -2.049833e-02 3 1  ON 6
ci_008                -1.848831e-02 3 1  ON 7
ci_009                -1.790674e-02 3 1  ON 8
ci_010                -1.641432e-02 3 1  ON 9
ci_011                -1.579440e-02 3 1  ON 10
ci_012                -1.644808e-02 3 1  ON 11
ci_013                -1.914986e-02 3 1  ON 12
ci_014                 1.355597e-02 3 1  ON 13
ci_015                 1.455822e-02 3 1  ON 14
ci_016                 1.615571e-02 3 1  ON 15
ci_017                 1.677127e-02 3 1  ON 16
ci_018                 1.341229e-02 3 1  ON 17
ci_019                 1.339058e-02 3 1  ON 18
ci_020                 1.372522e-02 3 1  ON 19
ci_021                 1.333545e-02 3 1  ON 20
ci_022                 1.233169e-02 3 1  ON 21
ci_023                 1.156865e-02 3 1  ON 22
ci_024                 1.172869e-02 3 1  ON 23
ci_025                 1.101272e-02 3 1  ON 24
ci_026                 1.199891e-02 3 1  ON 25
ci_027                 1.229175e-02 3 1  ON 26
ci_028                -1.383964e-02 3 1  ON 27
ci_029                -1.525198e-02 3 1  ON 28
ci_030                -1.088282e-02 3 1  ON 29
ci_031                -1.086686e-02 3 1  ON 30
ci_032                -1.387396e-02 3 1  ON 31
ci_033                 1.029403e-02 3 1  ON 32
ci_034                 1.047154e-02 3 1  ON 33
ci_035                -5.123131e-03 3 1  ON 34
ci_036                -1.048257e-02 3 1  ON 35
ci_037                -1.056428e-02 3 1  ON 36
ci_038                 1.241424e-03 3 1  ON 37
ci_039                 1.351511e-03 3 1  ON 38
ci_040                -3.945432e-03 3 1  ON 39
ci_041                 9.549247e-03 3 1  ON 40
ci_042                 9.873024e-03 3 1  ON 41
ci_043                -3.392826e-03 3 1  ON 42
ci_044                -1.510417e-02 3 1  ON 43
ci_045                -1.815799e-03 3 1  ON 44
ci_046                 5.788368e-03 3 1  ON 45
ci_047                 5.475015e-03 3 1  ON 46
ci_048                -1.177725e-02 3 1  ON 47
ci_049                -1.247211e-02 3 1  ON 48
ci_050                 7.687662e-03 3 1  ON 49
ci_051                 8.024091e-03 3 1  ON 50
ci_052                -6.915354e-03 3 1  ON 51
ci_053                -6.815847e-03 3 1  ON 52
ci_054                -2.416391e-03 3 1  ON 53
ci_055                -2.048627e-03 3 1  ON 54
ci_056                 4.657083e-03 3 1  ON 55
ci_057                 4.943824e-03 3 1  ON 56
ci_058                -7.414616e-03 3 1  ON 57
ci_059                -7.189574e-03 3 1  ON 58
ci_060                 8.530446e-03 3 1  ON 59
ci_061                 8.544110e-03 3 1  ON 60
ci_062                -2.689608e-03 3 1  ON 61
ci_063                -2.699790e-03 3 1  ON 62
ci_064                -3.575413e-03 3 1  ON 63
ci_065                -4.279133e-03 3 1  ON 64
ci_066                 5.948949e-03 3 1  ON 65
ci_067                 5.868192e-03 3 1  ON 66
ci_068                -5.027503e-03 3 1  ON 67
ci_069                -4.559777e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.198026
====================================================
  Execution time = 1.4701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1720e-01
  Total weights = 1.956772733e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299929596768
                                         uncertainty =       0.001780821357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299929596768
                                         uncertainty =       0.001780821357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387240690
  error estimate for blocks of size 2^( 2) =       0.000397331361
  error estimate for blocks of size 2^( 3) =       0.000406153491
  error estimate for blocks of size 2^( 4) =       0.000412435051
  error estimate for blocks of size 2^( 5) =       0.000416372251
  error estimate for blocks of size 2^( 6) =       0.000418033286
  error estimate for blocks of size 2^( 7) =       0.000418571214

      target function =                  N/A
              le_mean =     -17.216636483519
             les_mean =     296.729772317014
             stat err =       0.000416352951
             autocorr =       1.156009288576
              std dev =       0.547641035262
             le_variance =       0.299910703503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663648352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636483600       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216649796448       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216653815646       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216653458856       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216653432578       residual = 3.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 1.351491e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636483600       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216643704727       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216644412775       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216644380667       residual = 7.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 6.409908e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636483600       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216639034937       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216638866334       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216638860363       residual = 3.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.063319e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7250e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.082763e-02 3 1  ON 0
ci_002                -3.029048e-02 3 1  ON 1
ci_003                -2.542692e-02 3 1  ON 2
ci_004                 2.158867e-02 3 1  ON 3
ci_005                 2.184961e-02 3 1  ON 4
ci_006                -1.957798e-02 3 1  ON 5
ci_007                -2.008587e-02 3 1  ON 6
ci_008                -1.861757e-02 3 1  ON 7
ci_009                -1.844542e-02 3 1  ON 8
ci_010                -1.676137e-02 3 1  ON 9
ci_011                -1.627259e-02 3 1  ON 10
ci_012                -1.645511e-02 3 1  ON 11
ci_013                -1.850887e-02 3 1  ON 12
ci_014                 1.352628e-02 3 1  ON 13
ci_015                 1.474411e-02 3 1  ON 14
ci_016                 1.628984e-02 3 1  ON 15
ci_017                 1.675671e-02 3 1  ON 16
ci_018                 1.311668e-02 3 1  ON 17
ci_019                 1.314096e-02 3 1  ON 18
ci_020                 1.371251e-02 3 1  ON 19
ci_021                 1.346249e-02 3 1  ON 20
ci_022                 1.190975e-02 3 1  ON 21
ci_023                 1.189508e-02 3 1  ON 22
ci_024                 1.115056e-02 3 1  ON 23
ci_025                 1.101265e-02 3 1  ON 24
ci_026                 1.216429e-02 3 1  ON 25
ci_027                 1.198943e-02 3 1  ON 26
ci_028                -1.411067e-02 3 1  ON 27
ci_029                -1.463921e-02 3 1  ON 28
ci_030                -1.092256e-02 3 1  ON 29
ci_031                -1.096277e-02 3 1  ON 30
ci_032                -1.406966e-02 3 1  ON 31
ci_033                 1.066566e-02 3 1  ON 32
ci_034                 1.066451e-02 3 1  ON 33
ci_035                -5.120231e-03 3 1  ON 34
ci_036                -1.089100e-02 3 1  ON 35
ci_037                -1.116106e-02 3 1  ON 36
ci_038                 1.410087e-03 3 1  ON 37
ci_039                 1.305368e-03 3 1  ON 38
ci_040                -4.124224e-03 3 1  ON 39
ci_041                 9.558318e-03 3 1  ON 40
ci_042                 9.714812e-03 3 1  ON 41
ci_043                -3.593698e-03 3 1  ON 42
ci_044                -1.501842e-02 3 1  ON 43
ci_045                -1.755160e-03 3 1  ON 44
ci_046                 5.515528e-03 3 1  ON 45
ci_047                 5.735016e-03 3 1  ON 46
ci_048                -1.193282e-02 3 1  ON 47
ci_049                -1.205354e-02 3 1  ON 48
ci_050                 7.775300e-03 3 1  ON 49
ci_051                 7.576073e-03 3 1  ON 50
ci_052                -6.895013e-03 3 1  ON 51
ci_053                -6.719350e-03 3 1  ON 52
ci_054                -2.365399e-03 3 1  ON 53
ci_055                -2.191220e-03 3 1  ON 54
ci_056                 4.739587e-03 3 1  ON 55
ci_057                 5.285944e-03 3 1  ON 56
ci_058                -7.212341e-03 3 1  ON 57
ci_059                -7.209003e-03 3 1  ON 58
ci_060                 8.609983e-03 3 1  ON 59
ci_061                 8.368046e-03 3 1  ON 60
ci_062                -2.907949e-03 3 1  ON 61
ci_063                -2.796703e-03 3 1  ON 62
ci_064                -3.510715e-03 3 1  ON 63
ci_065                -4.465875e-03 3 1  ON 64
ci_066                 5.910917e-03 3 1  ON 65
ci_067                 6.246609e-03 3 1  ON 66
ci_068                -4.826645e-03 3 1  ON 67
ci_069                -4.571576e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.3119
    reference variance = 0.373198
====================================================
  Execution time = 1.4364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1728e-01
  Total weights = 1.9570e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300383037939
                                         uncertainty =       0.002376265070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300383037939
                                         uncertainty =       0.002376265070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387608677
  error estimate for blocks of size 2^( 2) =       0.000397257348
  error estimate for blocks of size 2^( 3) =       0.000405904736
  error estimate for blocks of size 2^( 4) =       0.000412135577
  error estimate for blocks of size 2^( 5) =       0.000415985781
  error estimate for blocks of size 2^( 6) =       0.000416788589
  error estimate for blocks of size 2^( 7) =       0.000417675602

      target function =                  N/A
              le_mean =     -17.216844031137
             les_mean =     296.754923222546
             stat err =       0.000415646387
             autocorr =       1.149902551577
              std dev =       0.548161448563
             le_variance =       0.300480973691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300322989971
                                         uncertainty =       0.002372639883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300322989971
                                         uncertainty =       0.002372639883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387571587
  error estimate for blocks of size 2^( 2) =       0.000397232432
  error estimate for blocks of size 2^( 3) =       0.000405899254
  error estimate for blocks of size 2^( 4) =       0.000412144872
  error estimate for blocks of size 2^( 5) =       0.000415990546
  error estimate for blocks of size 2^( 6) =       0.000416739950
  error estimate for blocks of size 2^( 7) =       0.000417546824

      target function =                  N/A
              le_mean =     -17.216854309409
             les_mean =     296.744717113042
             stat err =       0.000415605548
             autocorr =       1.149896655082
              std dev =       0.548108994533
             le_variance =       0.300423469888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300342137859
                                         uncertainty =       0.002373263481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300342137859
                                         uncertainty =       0.002373263481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387583143
  error estimate for blocks of size 2^( 2) =       0.000397245074
  error estimate for blocks of size 2^( 3) =       0.000405910054
  error estimate for blocks of size 2^( 4) =       0.000412152492
  error estimate for blocks of size 2^( 5) =       0.000415995801
  error estimate for blocks of size 2^( 6) =       0.000416747397
  error estimate for blocks of size 2^( 7) =       0.000417575242

      target function =                  N/A
              le_mean =     -17.216857412686
             les_mean =     296.745833583087
             stat err =       0.000415617733
             autocorr =       1.149895510778
              std dev =       0.548125337122
             le_variance =       0.300441385195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300302877485
                                         uncertainty =       0.002372825034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300302877485
                                         uncertainty =       0.002372825034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387557047
  error estimate for blocks of size 2^( 2) =       0.000397209192
  error estimate for blocks of size 2^( 3) =       0.000405861049
  error estimate for blocks of size 2^( 4) =       0.000412094653
  error estimate for blocks of size 2^( 5) =       0.000415942537
  error estimate for blocks of size 2^( 6) =       0.000416735423
  error estimate for blocks of size 2^( 7) =       0.000417602548

      target function =                  N/A
              le_mean =     -17.216837915283
             les_mean =     296.738314787503
             stat err =       0.000415593790
             autocorr =       1.149917871867
              std dev =       0.548088431796
             le_variance =       0.300400929068


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216844031137        initial
     9.3132e-02     9.3132e-01             1.3515e-03       -17.216854309409
     3.7253e-01     3.7253e+00             6.4099e-04       -17.216857412686  <--
     1.4901e+00     1.4901e+01             2.0633e-04       -17.216837915283

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.3763e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.082763e-02 3 1  ON 0
ci_002                -3.029048e-02 3 1  ON 1
ci_003                -2.542692e-02 3 1  ON 2
ci_004                 2.158867e-02 3 1  ON 3
ci_005                 2.184961e-02 3 1  ON 4
ci_006                -1.957798e-02 3 1  ON 5
ci_007                -2.008587e-02 3 1  ON 6
ci_008                -1.861757e-02 3 1  ON 7
ci_009                -1.844542e-02 3 1  ON 8
ci_010                -1.676137e-02 3 1  ON 9
ci_011                -1.627259e-02 3 1  ON 10
ci_012                -1.645511e-02 3 1  ON 11
ci_013                -1.850887e-02 3 1  ON 12
ci_014                 1.352628e-02 3 1  ON 13
ci_015                 1.474411e-02 3 1  ON 14
ci_016                 1.628984e-02 3 1  ON 15
ci_017                 1.675671e-02 3 1  ON 16
ci_018                 1.311668e-02 3 1  ON 17
ci_019                 1.314096e-02 3 1  ON 18
ci_020                 1.371251e-02 3 1  ON 19
ci_021                 1.346249e-02 3 1  ON 20
ci_022                 1.190975e-02 3 1  ON 21
ci_023                 1.189508e-02 3 1  ON 22
ci_024                 1.115056e-02 3 1  ON 23
ci_025                 1.101265e-02 3 1  ON 24
ci_026                 1.216429e-02 3 1  ON 25
ci_027                 1.198943e-02 3 1  ON 26
ci_028                -1.411067e-02 3 1  ON 27
ci_029                -1.463921e-02 3 1  ON 28
ci_030                -1.092256e-02 3 1  ON 29
ci_031                -1.096277e-02 3 1  ON 30
ci_032                -1.406966e-02 3 1  ON 31
ci_033                 1.066566e-02 3 1  ON 32
ci_034                 1.066451e-02 3 1  ON 33
ci_035                -5.120231e-03 3 1  ON 34
ci_036                -1.089100e-02 3 1  ON 35
ci_037                -1.116106e-02 3 1  ON 36
ci_038                 1.410087e-03 3 1  ON 37
ci_039                 1.305368e-03 3 1  ON 38
ci_040                -4.124224e-03 3 1  ON 39
ci_041                 9.558318e-03 3 1  ON 40
ci_042                 9.714812e-03 3 1  ON 41
ci_043                -3.593698e-03 3 1  ON 42
ci_044                -1.501842e-02 3 1  ON 43
ci_045                -1.755160e-03 3 1  ON 44
ci_046                 5.515528e-03 3 1  ON 45
ci_047                 5.735016e-03 3 1  ON 46
ci_048                -1.193282e-02 3 1  ON 47
ci_049                -1.205354e-02 3 1  ON 48
ci_050                 7.775300e-03 3 1  ON 49
ci_051                 7.576073e-03 3 1  ON 50
ci_052                -6.895013e-03 3 1  ON 51
ci_053                -6.719350e-03 3 1  ON 52
ci_054                -2.365399e-03 3 1  ON 53
ci_055                -2.191220e-03 3 1  ON 54
ci_056                 4.739587e-03 3 1  ON 55
ci_057                 5.285944e-03 3 1  ON 56
ci_058                -7.212341e-03 3 1  ON 57
ci_059                -7.209003e-03 3 1  ON 58
ci_060                 8.609983e-03 3 1  ON 59
ci_061                 8.368046e-03 3 1  ON 60
ci_062                -2.907949e-03 3 1  ON 61
ci_063                -2.796703e-03 3 1  ON 62
ci_064                -3.510715e-03 3 1  ON 63
ci_065                -4.465875e-03 3 1  ON 64
ci_066                 5.910917e-03 3 1  ON 65
ci_067                 6.246609e-03 3 1  ON 66
ci_068                -4.826645e-03 3 1  ON 67
ci_069                -4.571576e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2155
    reference variance = 0.209231
====================================================
  Execution time = 1.4652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1410e-01
  Total weights = 1.956802653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301301053364
                                         uncertainty =       0.002237541080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301301053364
                                         uncertainty =       0.002237541080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388123688
  error estimate for blocks of size 2^( 2) =       0.000398502515
  error estimate for blocks of size 2^( 3) =       0.000406902461
  error estimate for blocks of size 2^( 4) =       0.000413325449
  error estimate for blocks of size 2^( 5) =       0.000417863594
  error estimate for blocks of size 2^( 6) =       0.000419902384
  error estimate for blocks of size 2^( 7) =       0.000421092397

      target function =                  N/A
              le_mean =     -17.217003858438
             les_mean =     296.739324817012
             stat err =       0.000418045956
             autocorr =       1.160132928446
              std dev =       0.548889783911
             le_variance =       0.301279994882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700385844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217003858512       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217017965952       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217017876879       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217017775960       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217017831937       residual = 4.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 8.792538e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217003858512       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217011710880       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217011691120       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217011623575       residual = 7.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 4.646330e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217003858512       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217006689667       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217006735714       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217006715416       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.624790e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7210e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.104543e-02 3 1  ON 0
ci_002                -3.026347e-02 3 1  ON 1
ci_003                -2.512692e-02 3 1  ON 2
ci_004                 2.132652e-02 3 1  ON 3
ci_005                 2.171514e-02 3 1  ON 4
ci_006                -1.983470e-02 3 1  ON 5
ci_007                -2.002363e-02 3 1  ON 6
ci_008                -1.876008e-02 3 1  ON 7
ci_009                -1.844903e-02 3 1  ON 8
ci_010                -1.697086e-02 3 1  ON 9
ci_011                -1.655568e-02 3 1  ON 10
ci_012                -1.691347e-02 3 1  ON 11
ci_013                -1.856404e-02 3 1  ON 12
ci_014                 1.380328e-02 3 1  ON 13
ci_015                 1.427947e-02 3 1  ON 14
ci_016                 1.649176e-02 3 1  ON 15
ci_017                 1.635451e-02 3 1  ON 16
ci_018                 1.315870e-02 3 1  ON 17
ci_019                 1.328685e-02 3 1  ON 18
ci_020                 1.362059e-02 3 1  ON 19
ci_021                 1.389897e-02 3 1  ON 20
ci_022                 1.177388e-02 3 1  ON 21
ci_023                 1.201092e-02 3 1  ON 22
ci_024                 1.083777e-02 3 1  ON 23
ci_025                 1.096705e-02 3 1  ON 24
ci_026                 1.212568e-02 3 1  ON 25
ci_027                 1.195209e-02 3 1  ON 26
ci_028                -1.446281e-02 3 1  ON 27
ci_029                -1.440596e-02 3 1  ON 28
ci_030                -1.100519e-02 3 1  ON 29
ci_031                -1.073422e-02 3 1  ON 30
ci_032                -1.382929e-02 3 1  ON 31
ci_033                 1.071431e-02 3 1  ON 32
ci_034                 1.071123e-02 3 1  ON 33
ci_035                -4.948370e-03 3 1  ON 34
ci_036                -1.065278e-02 3 1  ON 35
ci_037                -1.100975e-02 3 1  ON 36
ci_038                 1.117639e-03 3 1  ON 37
ci_039                 1.246410e-03 3 1  ON 38
ci_040                -4.192737e-03 3 1  ON 39
ci_041                 9.775342e-03 3 1  ON 40
ci_042                 9.496269e-03 3 1  ON 41
ci_043                -3.456828e-03 3 1  ON 42
ci_044                -1.521919e-02 3 1  ON 43
ci_045                -1.691003e-03 3 1  ON 44
ci_046                 5.606726e-03 3 1  ON 45
ci_047                 5.689459e-03 3 1  ON 46
ci_048                -1.193672e-02 3 1  ON 47
ci_049                -1.202847e-02 3 1  ON 48
ci_050                 8.080514e-03 3 1  ON 49
ci_051                 7.651942e-03 3 1  ON 50
ci_052                -7.031478e-03 3 1  ON 51
ci_053                -7.043236e-03 3 1  ON 52
ci_054                -2.397494e-03 3 1  ON 53
ci_055                -2.422556e-03 3 1  ON 54
ci_056                 5.152572e-03 3 1  ON 55
ci_057                 4.998278e-03 3 1  ON 56
ci_058                -7.289311e-03 3 1  ON 57
ci_059                -7.338921e-03 3 1  ON 58
ci_060                 8.501316e-03 3 1  ON 59
ci_061                 8.223590e-03 3 1  ON 60
ci_062                -2.862249e-03 3 1  ON 61
ci_063                -2.947166e-03 3 1  ON 62
ci_064                -3.583318e-03 3 1  ON 63
ci_065                -4.191718e-03 3 1  ON 64
ci_066                 5.799241e-03 3 1  ON 65
ci_067                 6.131351e-03 3 1  ON 66
ci_068                -4.869981e-03 3 1  ON 67
ci_069                -4.863337e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.13991
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0875e-01
  Total weights = 1.9567e+06
  Execution time = 1.8584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295286027587
                                         uncertainty =       0.001806081012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295286027587
                                         uncertainty =       0.001806081012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384217213
  error estimate for blocks of size 2^( 2) =       0.000394094191
  error estimate for blocks of size 2^( 3) =       0.000402740924
  error estimate for blocks of size 2^( 4) =       0.000408822419
  error estimate for blocks of size 2^( 5) =       0.000411981144
  error estimate for blocks of size 2^( 6) =       0.000414152972
  error estimate for blocks of size 2^( 7) =       0.000414375823

      target function =                  N/A
              le_mean =     -17.216865633222
             les_mean =     296.740340727915
             stat err =       0.000412333090
             autocorr =       1.151708950781
              std dev =       0.543365193110
             le_variance =       0.295245733084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296178532554
                                         uncertainty =       0.001821844173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296178532554
                                         uncertainty =       0.001821844173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384797588
  error estimate for blocks of size 2^( 2) =       0.000394645099
  error estimate for blocks of size 2^( 3) =       0.000403257529
  error estimate for blocks of size 2^( 4) =       0.000409317062
  error estimate for blocks of size 2^( 5) =       0.000412447563
  error estimate for blocks of size 2^( 6) =       0.000414599362
  error estimate for blocks of size 2^( 7) =       0.000414778808

      target function =                  N/A
              le_mean =     -17.216853379936
             les_mean =     296.784682468301
             stat err =       0.000412785699
             autocorr =       1.150759591586
              std dev =       0.544185967273
             le_variance =       0.296138366976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296246101079
                                         uncertainty =       0.001819133638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296246101079
                                         uncertainty =       0.001819133638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384841508
  error estimate for blocks of size 2^( 2) =       0.000394685298
  error estimate for blocks of size 2^( 3) =       0.000403299419
  error estimate for blocks of size 2^( 4) =       0.000409338810
  error estimate for blocks of size 2^( 5) =       0.000412475232
  error estimate for blocks of size 2^( 6) =       0.000414625981
  error estimate for blocks of size 2^( 7) =       0.000414833920

      target function =                  N/A
              le_mean =     -17.216863869423
             les_mean =     296.731753942171
             stat err =       0.000412818486
             autocorr =       1.150679716311
              std dev =       0.544248080212
             le_variance =       0.296205972815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295416677493
                                         uncertainty =       0.001811629879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295416677493
                                         uncertainty =       0.001811629879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384302162
  error estimate for blocks of size 2^( 2) =       0.000394172508
  error estimate for blocks of size 2^( 3) =       0.000402814206
  error estimate for blocks of size 2^( 4) =       0.000408881963
  error estimate for blocks of size 2^( 5) =       0.000412040214
  error estimate for blocks of size 2^( 6) =       0.000414195158
  error estimate for blocks of size 2^( 7) =       0.000414404307

      target function =                  N/A
              le_mean =     -17.216860277615
             les_mean =     298.148797201309
             stat err =       0.000412380410
             autocorr =       1.151464085742
              std dev =       0.543485330070
             le_variance =       0.295376304001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216865633222        initial  <--
     9.3132e-02     9.3132e-01             8.7925e-04       -17.216853379936
     3.7253e-01     3.7253e+00             4.6463e-04       -17.216863869423
     1.4901e+00     1.4901e+01             1.6248e-04       -17.216860277615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9314
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.082763e-02 3 1  ON 0
ci_002                -3.029048e-02 3 1  ON 1
ci_003                -2.542692e-02 3 1  ON 2
ci_004                 2.158867e-02 3 1  ON 3
ci_005                 2.184961e-02 3 1  ON 4
ci_006                -1.957798e-02 3 1  ON 5
ci_007                -2.008587e-02 3 1  ON 6
ci_008                -1.861757e-02 3 1  ON 7
ci_009                -1.844542e-02 3 1  ON 8
ci_010                -1.676137e-02 3 1  ON 9
ci_011                -1.627259e-02 3 1  ON 10
ci_012                -1.645511e-02 3 1  ON 11
ci_013                -1.850887e-02 3 1  ON 12
ci_014                 1.352628e-02 3 1  ON 13
ci_015                 1.474411e-02 3 1  ON 14
ci_016                 1.628984e-02 3 1  ON 15
ci_017                 1.675671e-02 3 1  ON 16
ci_018                 1.311668e-02 3 1  ON 17
ci_019                 1.314096e-02 3 1  ON 18
ci_020                 1.371251e-02 3 1  ON 19
ci_021                 1.346249e-02 3 1  ON 20
ci_022                 1.190975e-02 3 1  ON 21
ci_023                 1.189508e-02 3 1  ON 22
ci_024                 1.115056e-02 3 1  ON 23
ci_025                 1.101265e-02 3 1  ON 24
ci_026                 1.216429e-02 3 1  ON 25
ci_027                 1.198943e-02 3 1  ON 26
ci_028                -1.411067e-02 3 1  ON 27
ci_029                -1.463921e-02 3 1  ON 28
ci_030                -1.092256e-02 3 1  ON 29
ci_031                -1.096277e-02 3 1  ON 30
ci_032                -1.406966e-02 3 1  ON 31
ci_033                 1.066566e-02 3 1  ON 32
ci_034                 1.066451e-02 3 1  ON 33
ci_035                -5.120231e-03 3 1  ON 34
ci_036                -1.089100e-02 3 1  ON 35
ci_037                -1.116106e-02 3 1  ON 36
ci_038                 1.410087e-03 3 1  ON 37
ci_039                 1.305368e-03 3 1  ON 38
ci_040                -4.124224e-03 3 1  ON 39
ci_041                 9.558318e-03 3 1  ON 40
ci_042                 9.714812e-03 3 1  ON 41
ci_043                -3.593698e-03 3 1  ON 42
ci_044                -1.501842e-02 3 1  ON 43
ci_045                -1.755160e-03 3 1  ON 44
ci_046                 5.515528e-03 3 1  ON 45
ci_047                 5.735016e-03 3 1  ON 46
ci_048                -1.193282e-02 3 1  ON 47
ci_049                -1.205354e-02 3 1  ON 48
ci_050                 7.775300e-03 3 1  ON 49
ci_051                 7.576073e-03 3 1  ON 50
ci_052                -6.895013e-03 3 1  ON 51
ci_053                -6.719350e-03 3 1  ON 52
ci_054                -2.365399e-03 3 1  ON 53
ci_055                -2.191220e-03 3 1  ON 54
ci_056                 4.739587e-03 3 1  ON 55
ci_057                 5.285944e-03 3 1  ON 56
ci_058                -7.212341e-03 3 1  ON 57
ci_059                -7.209003e-03 3 1  ON 58
ci_060                 8.609983e-03 3 1  ON 59
ci_061                 8.368046e-03 3 1  ON 60
ci_062                -2.907949e-03 3 1  ON 61
ci_063                -2.796703e-03 3 1  ON 62
ci_064                -3.510715e-03 3 1  ON 63
ci_065                -4.465875e-03 3 1  ON 64
ci_066                 5.910917e-03 3 1  ON 65
ci_067                 6.246609e-03 3 1  ON 66
ci_068                -4.826645e-03 3 1  ON 67
ci_069                -4.571576e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.61078
====================================================
  Execution time = 1.4694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1083e-01
  Total weights = 1.956696257e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298152678636
                                         uncertainty =       0.002742338536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298152678636
                                         uncertainty =       0.002742338536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386083878
  error estimate for blocks of size 2^( 2) =       0.000395913081
  error estimate for blocks of size 2^( 3) =       0.000405145884
  error estimate for blocks of size 2^( 4) =       0.000411862607
  error estimate for blocks of size 2^( 5) =       0.000415927190
  error estimate for blocks of size 2^( 6) =       0.000417384194
  error estimate for blocks of size 2^( 7) =       0.000419639104

      target function =                  N/A
              le_mean =     -17.216784450390
             les_mean =     296.728496181602
             stat err =       0.000416203274
             autocorr =       1.162111103561
              std dev =       0.546005055954
             le_variance =       0.298121521128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678445039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784450447       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216789562390       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216789464547       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216789431463       residual = 7.63e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 2.991465e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784450447       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216785966668       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216785950314       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216785932029       residual = 1.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 8.388756e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784450447       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784848032       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216784845102       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216784839427       residual = 1.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 2.162996e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7229e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.083623e-02 3 1  ON 0
ci_002                -3.035111e-02 3 1  ON 1
ci_003                -2.537082e-02 3 1  ON 2
ci_004                 2.156740e-02 3 1  ON 3
ci_005                 2.186564e-02 3 1  ON 4
ci_006                -1.961175e-02 3 1  ON 5
ci_007                -2.008417e-02 3 1  ON 6
ci_008                -1.855973e-02 3 1  ON 7
ci_009                -1.841287e-02 3 1  ON 8
ci_010                -1.673422e-02 3 1  ON 9
ci_011                -1.626067e-02 3 1  ON 10
ci_012                -1.644266e-02 3 1  ON 11
ci_013                -1.859276e-02 3 1  ON 12
ci_014                 1.360417e-02 3 1  ON 13
ci_015                 1.472374e-02 3 1  ON 14
ci_016                 1.627042e-02 3 1  ON 15
ci_017                 1.675076e-02 3 1  ON 16
ci_018                 1.311699e-02 3 1  ON 17
ci_019                 1.319577e-02 3 1  ON 18
ci_020                 1.374721e-02 3 1  ON 19
ci_021                 1.340766e-02 3 1  ON 20
ci_022                 1.188281e-02 3 1  ON 21
ci_023                 1.191446e-02 3 1  ON 22
ci_024                 1.112837e-02 3 1  ON 23
ci_025                 1.099006e-02 3 1  ON 24
ci_026                 1.212728e-02 3 1  ON 25
ci_027                 1.195955e-02 3 1  ON 26
ci_028                -1.412312e-02 3 1  ON 27
ci_029                -1.464184e-02 3 1  ON 28
ci_030                -1.092648e-02 3 1  ON 29
ci_031                -1.096928e-02 3 1  ON 30
ci_032                -1.403876e-02 3 1  ON 31
ci_033                 1.063642e-02 3 1  ON 32
ci_034                 1.064252e-02 3 1  ON 33
ci_035                -5.135811e-03 3 1  ON 34
ci_036                -1.085491e-02 3 1  ON 35
ci_037                -1.111962e-02 3 1  ON 36
ci_038                 1.389345e-03 3 1  ON 37
ci_039                 1.302204e-03 3 1  ON 38
ci_040                -4.172008e-03 3 1  ON 39
ci_041                 9.555262e-03 3 1  ON 40
ci_042                 9.785887e-03 3 1  ON 41
ci_043                -3.601136e-03 3 1  ON 42
ci_044                -1.502793e-02 3 1  ON 43
ci_045                -1.794082e-03 3 1  ON 44
ci_046                 5.474150e-03 3 1  ON 45
ci_047                 5.692971e-03 3 1  ON 46
ci_048                -1.193881e-02 3 1  ON 47
ci_049                -1.202508e-02 3 1  ON 48
ci_050                 7.786380e-03 3 1  ON 49
ci_051                 7.596122e-03 3 1  ON 50
ci_052                -6.886845e-03 3 1  ON 51
ci_053                -6.741100e-03 3 1  ON 52
ci_054                -2.411898e-03 3 1  ON 53
ci_055                -2.218314e-03 3 1  ON 54
ci_056                 4.753092e-03 3 1  ON 55
ci_057                 5.251655e-03 3 1  ON 56
ci_058                -7.197841e-03 3 1  ON 57
ci_059                -7.156874e-03 3 1  ON 58
ci_060                 8.614439e-03 3 1  ON 59
ci_061                 8.389457e-03 3 1  ON 60
ci_062                -2.912225e-03 3 1  ON 61
ci_063                -2.839080e-03 3 1  ON 62
ci_064                -3.495192e-03 3 1  ON 63
ci_065                -4.464544e-03 3 1  ON 64
ci_066                 5.895129e-03 3 1  ON 65
ci_067                 6.166770e-03 3 1  ON 66
ci_068                -4.762402e-03 3 1  ON 67
ci_069                -4.613990e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.153393
====================================================
  Execution time = 1.4596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2400e-01
  Total weights = 1.9564e+06
  Execution time = 1.8679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302549249680
                                         uncertainty =       0.002350289484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302549249680
                                         uncertainty =       0.002350289484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388955883
  error estimate for blocks of size 2^( 2) =       0.000398733863
  error estimate for blocks of size 2^( 3) =       0.000407573818
  error estimate for blocks of size 2^( 4) =       0.000414186399
  error estimate for blocks of size 2^( 5) =       0.000418561323
  error estimate for blocks of size 2^( 6) =       0.000420568775
  error estimate for blocks of size 2^( 7) =       0.000421355362

      target function =                  N/A
              le_mean =     -17.216222478362
             les_mean =     297.747390752618
             stat err =       0.000418667965
             autocorr =       1.158614005112
              std dev =       0.550066684458
             le_variance =       0.302573357351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302404229009
                                         uncertainty =       0.002343601309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302404229009
                                         uncertainty =       0.002343601309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388863282
  error estimate for blocks of size 2^( 2) =       0.000398641768
  error estimate for blocks of size 2^( 3) =       0.000407491604
  error estimate for blocks of size 2^( 4) =       0.000414105876
  error estimate for blocks of size 2^( 5) =       0.000418476101
  error estimate for blocks of size 2^( 6) =       0.000420433439
  error estimate for blocks of size 2^( 7) =       0.000421184901

      target function =                  N/A
              le_mean =     -17.216226426295
             les_mean =     296.724218525335
             stat err =       0.000418550079
             autocorr =       1.158513188685
              std dev =       0.549935726926
             le_variance =       0.302429303750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302445581379
                                         uncertainty =       0.002345783525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302445581379
                                         uncertainty =       0.002345783525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388889638
  error estimate for blocks of size 2^( 2) =       0.000398666947
  error estimate for blocks of size 2^( 3) =       0.000407514638
  error estimate for blocks of size 2^( 4) =       0.000414125353
  error estimate for blocks of size 2^( 5) =       0.000418498297
  error estimate for blocks of size 2^( 6) =       0.000420460601
  error estimate for blocks of size 2^( 7) =       0.000421213514

      target function =                  N/A
              le_mean =     -17.216226031280
             les_mean =     296.722749249330
             stat err =       0.000418574441
             autocorr =       1.158491011811
              std dev =       0.549973000832
             le_variance =       0.302470301644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302507773487
                                         uncertainty =       0.002348719033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302507773487
                                         uncertainty =       0.002348719033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388929313
  error estimate for blocks of size 2^( 2) =       0.000398705111
  error estimate for blocks of size 2^( 3) =       0.000407550115
  error estimate for blocks of size 2^( 4) =       0.000414156420
  error estimate for blocks of size 2^( 5) =       0.000418532548
  error estimate for blocks of size 2^( 6) =       0.000420502075
  error estimate for blocks of size 2^( 7) =       0.000421257891

      target function =                  N/A
              le_mean =     -17.216226215874
             les_mean =     296.722571276908
             stat err =       0.000418612233
             autocorr =       1.158463829057
              std dev =       0.550029109622
             le_variance =       0.302532021432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216222478362        initial
     9.3132e-01     9.3132e+00             2.9915e-04       -17.216226426295  <--
     3.7253e+00     3.7253e+01             8.3888e-05       -17.216226031280
     1.4901e+01     1.4901e+02             2.1630e-05       -17.216226215874

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.4089e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.085723e-02 3 1  ON 0
ci_002                -3.049748e-02 3 1  ON 1
ci_003                -2.522687e-02 3 1  ON 2
ci_004                 2.151668e-02 3 1  ON 3
ci_005                 2.190669e-02 3 1  ON 4
ci_006                -1.969606e-02 3 1  ON 5
ci_007                -2.007766e-02 3 1  ON 6
ci_008                -1.842492e-02 3 1  ON 7
ci_009                -1.833972e-02 3 1  ON 8
ci_010                -1.666694e-02 3 1  ON 9
ci_011                -1.623079e-02 3 1  ON 10
ci_012                -1.641281e-02 3 1  ON 11
ci_013                -1.880802e-02 3 1  ON 12
ci_014                 1.379122e-02 3 1  ON 13
ci_015                 1.467738e-02 3 1  ON 14
ci_016                 1.621874e-02 3 1  ON 15
ci_017                 1.673520e-02 3 1  ON 16
ci_018                 1.311723e-02 3 1  ON 17
ci_019                 1.332424e-02 3 1  ON 18
ci_020                 1.383300e-02 3 1  ON 19
ci_021                 1.327256e-02 3 1  ON 20
ci_022                 1.181856e-02 3 1  ON 21
ci_023                 1.195990e-02 3 1  ON 22
ci_024                 1.107033e-02 3 1  ON 23
ci_025                 1.093062e-02 3 1  ON 24
ci_026                 1.203674e-02 3 1  ON 25
ci_027                 1.188848e-02 3 1  ON 26
ci_028                -1.415408e-02 3 1  ON 27
ci_029                -1.465051e-02 3 1  ON 28
ci_030                -1.093799e-02 3 1  ON 29
ci_031                -1.098618e-02 3 1  ON 30
ci_032                -1.396709e-02 3 1  ON 31
ci_033                 1.056389e-02 3 1  ON 32
ci_034                 1.058735e-02 3 1  ON 33
ci_035                -5.168634e-03 3 1  ON 34
ci_036                -1.076827e-02 3 1  ON 35
ci_037                -1.101806e-02 3 1  ON 36
ci_038                 1.345609e-03 3 1  ON 37
ci_039                 1.294678e-03 3 1  ON 38
ci_040                -4.270844e-03 3 1  ON 39
ci_041                 9.548240e-03 3 1  ON 40
ci_042                 9.953968e-03 3 1  ON 41
ci_043                -3.617247e-03 3 1  ON 42
ci_044                -1.505333e-02 3 1  ON 43
ci_045                -1.875799e-03 3 1  ON 44
ci_046                 5.376670e-03 3 1  ON 45
ci_047                 5.594176e-03 3 1  ON 46
ci_048                -1.195444e-02 3 1  ON 47
ci_049                -1.195664e-02 3 1  ON 48
ci_050                 7.810780e-03 3 1  ON 49
ci_051                 7.639242e-03 3 1  ON 50
ci_052                -6.867989e-03 3 1  ON 51
ci_053                -6.790542e-03 3 1  ON 52
ci_054                -2.517391e-03 3 1  ON 53
ci_055                -2.280005e-03 3 1  ON 54
ci_056                 4.782173e-03 3 1  ON 55
ci_057                 5.176274e-03 3 1  ON 56
ci_058                -7.164862e-03 3 1  ON 57
ci_059                -7.037337e-03 3 1  ON 58
ci_060                 8.624404e-03 3 1  ON 59
ci_061                 8.441349e-03 3 1  ON 60
ci_062                -2.921085e-03 3 1  ON 61
ci_063                -2.935788e-03 3 1  ON 62
ci_064                -3.464408e-03 3 1  ON 63
ci_065                -4.462138e-03 3 1  ON 64
ci_066                 5.860032e-03 3 1  ON 65
ci_067                 5.991839e-03 3 1  ON 66
ci_068                -4.610717e-03 3 1  ON 67
ci_069                -4.712696e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.293018
====================================================
  Execution time = 1.4841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0908e-01
  Total weights = 1.956655389e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295757730172
                                         uncertainty =       0.001664468971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295757730172
                                         uncertainty =       0.001664468971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384580510
  error estimate for blocks of size 2^( 2) =       0.000394379447
  error estimate for blocks of size 2^( 3) =       0.000403592353
  error estimate for blocks of size 2^( 4) =       0.000410262663
  error estimate for blocks of size 2^( 5) =       0.000413222093
  error estimate for blocks of size 2^( 6) =       0.000413798406
  error estimate for blocks of size 2^( 7) =       0.000415504268

      target function =                  N/A
              le_mean =     -17.216745651443
             les_mean =     296.725409082864
             stat err =       0.000413196857
             autocorr =       1.154355235083
              std dev =       0.543878973451
             le_variance =       0.295804337762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674565144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216745651461       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759016335       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757122985       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757163594       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 7.450935e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216745651461       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216751276281       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216750876481       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216750897403       residual = 1.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 3.030408e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216745651461       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747347452       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216747316210       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 8.993373e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7416e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.093842e-02 3 1  ON 0
ci_002                -3.063325e-02 3 1  ON 1
ci_003                -2.530342e-02 3 1  ON 2
ci_004                 2.158006e-02 3 1  ON 3
ci_005                 2.166971e-02 3 1  ON 4
ci_006                -1.963258e-02 3 1  ON 5
ci_007                -2.005221e-02 3 1  ON 6
ci_008                -1.840471e-02 3 1  ON 7
ci_009                -1.818645e-02 3 1  ON 8
ci_010                -1.678642e-02 3 1  ON 9
ci_011                -1.646300e-02 3 1  ON 10
ci_012                -1.662848e-02 3 1  ON 11
ci_013                -1.888220e-02 3 1  ON 12
ci_014                 1.368573e-02 3 1  ON 13
ci_015                 1.465285e-02 3 1  ON 14
ci_016                 1.627405e-02 3 1  ON 15
ci_017                 1.661850e-02 3 1  ON 16
ci_018                 1.325057e-02 3 1  ON 17
ci_019                 1.337790e-02 3 1  ON 18
ci_020                 1.379893e-02 3 1  ON 19
ci_021                 1.322039e-02 3 1  ON 20
ci_022                 1.212160e-02 3 1  ON 21
ci_023                 1.192650e-02 3 1  ON 22
ci_024                 1.111693e-02 3 1  ON 23
ci_025                 1.097740e-02 3 1  ON 24
ci_026                 1.191916e-02 3 1  ON 25
ci_027                 1.180838e-02 3 1  ON 26
ci_028                -1.413572e-02 3 1  ON 27
ci_029                -1.471366e-02 3 1  ON 28
ci_030                -1.084077e-02 3 1  ON 29
ci_031                -1.107469e-02 3 1  ON 30
ci_032                -1.394167e-02 3 1  ON 31
ci_033                 1.050085e-02 3 1  ON 32
ci_034                 1.029583e-02 3 1  ON 33
ci_035                -5.350650e-03 3 1  ON 34
ci_036                -1.075748e-02 3 1  ON 35
ci_037                -1.105501e-02 3 1  ON 36
ci_038                 1.363750e-03 3 1  ON 37
ci_039                 1.413550e-03 3 1  ON 38
ci_040                -4.447319e-03 3 1  ON 39
ci_041                 9.639252e-03 3 1  ON 40
ci_042                 9.828288e-03 3 1  ON 41
ci_043                -3.383487e-03 3 1  ON 42
ci_044                -1.517315e-02 3 1  ON 43
ci_045                -1.843457e-03 3 1  ON 44
ci_046                 5.533904e-03 3 1  ON 45
ci_047                 5.717316e-03 3 1  ON 46
ci_048                -1.202173e-02 3 1  ON 47
ci_049                -1.195450e-02 3 1  ON 48
ci_050                 7.663884e-03 3 1  ON 49
ci_051                 7.518205e-03 3 1  ON 50
ci_052                -6.890848e-03 3 1  ON 51
ci_053                -6.917244e-03 3 1  ON 52
ci_054                -2.438436e-03 3 1  ON 53
ci_055                -2.318683e-03 3 1  ON 54
ci_056                 4.848331e-03 3 1  ON 55
ci_057                 5.122011e-03 3 1  ON 56
ci_058                -7.082472e-03 3 1  ON 57
ci_059                -7.198626e-03 3 1  ON 58
ci_060                 8.714002e-03 3 1  ON 59
ci_061                 8.265101e-03 3 1  ON 60
ci_062                -2.820887e-03 3 1  ON 61
ci_063                -2.959970e-03 3 1  ON 62
ci_064                -3.637948e-03 3 1  ON 63
ci_065                -4.382191e-03 3 1  ON 64
ci_066                 5.883797e-03 3 1  ON 65
ci_067                 5.759690e-03 3 1  ON 66
ci_068                -4.632343e-03 3 1  ON 67
ci_069                -4.778347e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.265895
====================================================
  Execution time = 1.4537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.9571e+06
  Execution time = 1.8494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298546935042
                                         uncertainty =       0.002464924534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298546935042
                                         uncertainty =       0.002464924534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386314128
  error estimate for blocks of size 2^( 2) =       0.000396190707
  error estimate for blocks of size 2^( 3) =       0.000404878936
  error estimate for blocks of size 2^( 4) =       0.000411364455
  error estimate for blocks of size 2^( 5) =       0.000416178296
  error estimate for blocks of size 2^( 6) =       0.000418942196
  error estimate for blocks of size 2^( 7) =       0.000419661614

      target function =                  N/A
              le_mean =     -17.216997598055
             les_mean =     296.739651278919
             stat err =       0.000416536640
             autocorr =       1.162586396027
              std dev =       0.546330679707
             le_variance =       0.298477211589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298818603528
                                         uncertainty =       0.002466614377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298818603528
                                         uncertainty =       0.002466614377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386489857
  error estimate for blocks of size 2^( 2) =       0.000396354484
  error estimate for blocks of size 2^( 3) =       0.000405040965
  error estimate for blocks of size 2^( 4) =       0.000411504084
  error estimate for blocks of size 2^( 5) =       0.000416322848
  error estimate for blocks of size 2^( 6) =       0.000419088292
  error estimate for blocks of size 2^( 7) =       0.000419815838

      target function =                  N/A
              le_mean =     -17.216996168150
             les_mean =     296.786917247821
             stat err =       0.000416682765
             autocorr =       1.162344521743
              std dev =       0.546579197845
             le_variance =       0.298748819517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298744251258
                                         uncertainty =       0.002466996882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298744251258
                                         uncertainty =       0.002466996882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386441722
  error estimate for blocks of size 2^( 2) =       0.000396310550
  error estimate for blocks of size 2^( 3) =       0.000404995851
  error estimate for blocks of size 2^( 4) =       0.000411463794
  error estimate for blocks of size 2^( 5) =       0.000416286211
  error estimate for blocks of size 2^( 6) =       0.000419049618
  error estimate for blocks of size 2^( 7) =       0.000419771349

      target function =                  N/A
              le_mean =     -17.216994323035
             les_mean =     296.740073389844
             stat err =       0.000416642743
             autocorr =       1.162410770951
              std dev =       0.546511124852
             le_variance =       0.298674409587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298564652359
                                         uncertainty =       0.002465172029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298564652359
                                         uncertainty =       0.002465172029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386325580
  error estimate for blocks of size 2^( 2) =       0.000396201374
  error estimate for blocks of size 2^( 3) =       0.000404888703
  error estimate for blocks of size 2^( 4) =       0.000411371862
  error estimate for blocks of size 2^( 5) =       0.000416188221
  error estimate for blocks of size 2^( 6) =       0.000418950799
  error estimate for blocks of size 2^( 7) =       0.000419665065

      target function =                  N/A
              le_mean =     -17.216996046773
             les_mean =     296.738815282023
             stat err =       0.000416543987
             autocorr =       1.162558480328
              std dev =       0.546346874479
             le_variance =       0.298494907253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216997598055        initial  <--
     2.3283e-01     2.3283e+00             7.4509e-04       -17.216996168150
     9.3132e-01     9.3132e+00             3.0304e-04       -17.216994323035
     3.7253e+00     3.7253e+01             8.9934e-05       -17.216996046773

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8989
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.085723e-02 3 1  ON 0
ci_002                -3.049748e-02 3 1  ON 1
ci_003                -2.522687e-02 3 1  ON 2
ci_004                 2.151668e-02 3 1  ON 3
ci_005                 2.190669e-02 3 1  ON 4
ci_006                -1.969606e-02 3 1  ON 5
ci_007                -2.007766e-02 3 1  ON 6
ci_008                -1.842492e-02 3 1  ON 7
ci_009                -1.833972e-02 3 1  ON 8
ci_010                -1.666694e-02 3 1  ON 9
ci_011                -1.623079e-02 3 1  ON 10
ci_012                -1.641281e-02 3 1  ON 11
ci_013                -1.880802e-02 3 1  ON 12
ci_014                 1.379122e-02 3 1  ON 13
ci_015                 1.467738e-02 3 1  ON 14
ci_016                 1.621874e-02 3 1  ON 15
ci_017                 1.673520e-02 3 1  ON 16
ci_018                 1.311723e-02 3 1  ON 17
ci_019                 1.332424e-02 3 1  ON 18
ci_020                 1.383300e-02 3 1  ON 19
ci_021                 1.327256e-02 3 1  ON 20
ci_022                 1.181856e-02 3 1  ON 21
ci_023                 1.195990e-02 3 1  ON 22
ci_024                 1.107033e-02 3 1  ON 23
ci_025                 1.093062e-02 3 1  ON 24
ci_026                 1.203674e-02 3 1  ON 25
ci_027                 1.188848e-02 3 1  ON 26
ci_028                -1.415408e-02 3 1  ON 27
ci_029                -1.465051e-02 3 1  ON 28
ci_030                -1.093799e-02 3 1  ON 29
ci_031                -1.098618e-02 3 1  ON 30
ci_032                -1.396709e-02 3 1  ON 31
ci_033                 1.056389e-02 3 1  ON 32
ci_034                 1.058735e-02 3 1  ON 33
ci_035                -5.168634e-03 3 1  ON 34
ci_036                -1.076827e-02 3 1  ON 35
ci_037                -1.101806e-02 3 1  ON 36
ci_038                 1.345609e-03 3 1  ON 37
ci_039                 1.294678e-03 3 1  ON 38
ci_040                -4.270844e-03 3 1  ON 39
ci_041                 9.548240e-03 3 1  ON 40
ci_042                 9.953968e-03 3 1  ON 41
ci_043                -3.617247e-03 3 1  ON 42
ci_044                -1.505333e-02 3 1  ON 43
ci_045                -1.875799e-03 3 1  ON 44
ci_046                 5.376670e-03 3 1  ON 45
ci_047                 5.594176e-03 3 1  ON 46
ci_048                -1.195444e-02 3 1  ON 47
ci_049                -1.195664e-02 3 1  ON 48
ci_050                 7.810780e-03 3 1  ON 49
ci_051                 7.639242e-03 3 1  ON 50
ci_052                -6.867989e-03 3 1  ON 51
ci_053                -6.790542e-03 3 1  ON 52
ci_054                -2.517391e-03 3 1  ON 53
ci_055                -2.280005e-03 3 1  ON 54
ci_056                 4.782173e-03 3 1  ON 55
ci_057                 5.176274e-03 3 1  ON 56
ci_058                -7.164862e-03 3 1  ON 57
ci_059                -7.037337e-03 3 1  ON 58
ci_060                 8.624404e-03 3 1  ON 59
ci_061                 8.441349e-03 3 1  ON 60
ci_062                -2.921085e-03 3 1  ON 61
ci_063                -2.935788e-03 3 1  ON 62
ci_064                -3.464408e-03 3 1  ON 63
ci_065                -4.462138e-03 3 1  ON 64
ci_066                 5.860032e-03 3 1  ON 65
ci_067                 5.991839e-03 3 1  ON 66
ci_068                -4.610717e-03 3 1  ON 67
ci_069                -4.712696e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1322e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.240489
====================================================
  Execution time = 1.4814e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1678e-01
  Total weights = 1.957148239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301360707222
                                         uncertainty =       0.002630395954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301360707222
                                         uncertainty =       0.002630395954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388162880
  error estimate for blocks of size 2^( 2) =       0.000397820551
  error estimate for blocks of size 2^( 3) =       0.000407024519
  error estimate for blocks of size 2^( 4) =       0.000413715748
  error estimate for blocks of size 2^( 5) =       0.000417366618
  error estimate for blocks of size 2^( 6) =       0.000420691397
  error estimate for blocks of size 2^( 7) =       0.000420458801

      target function =                  N/A
              le_mean =     -17.216545495463
             les_mean =     296.726221534768
             stat err =       0.000418058141
             autocorr =       1.159966283531
              std dev =       0.548945209630
             le_variance =       0.301340843176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654549546e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545495525       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545940492       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546024826       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 1.278941e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545495525       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545615390       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545636028       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545634053       residual = 9.41e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 3.531914e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545495525       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545526084       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545531213       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545530745       residual = 1.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 9.076852e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7369e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.086594e-02 3 1  ON 0
ci_002                -3.051612e-02 3 1  ON 1
ci_003                -2.521811e-02 3 1  ON 2
ci_004                 2.150458e-02 3 1  ON 3
ci_005                 2.191452e-02 3 1  ON 4
ci_006                -1.969893e-02 3 1  ON 5
ci_007                -2.007507e-02 3 1  ON 6
ci_008                -1.839390e-02 3 1  ON 7
ci_009                -1.833986e-02 3 1  ON 8
ci_010                -1.667023e-02 3 1  ON 9
ci_011                -1.623044e-02 3 1  ON 10
ci_012                -1.639305e-02 3 1  ON 11
ci_013                -1.883535e-02 3 1  ON 12
ci_014                 1.381182e-02 3 1  ON 13
ci_015                 1.466465e-02 3 1  ON 14
ci_016                 1.620640e-02 3 1  ON 15
ci_017                 1.671930e-02 3 1  ON 16
ci_018                 1.313333e-02 3 1  ON 17
ci_019                 1.331441e-02 3 1  ON 18
ci_020                 1.383174e-02 3 1  ON 19
ci_021                 1.328252e-02 3 1  ON 20
ci_022                 1.182387e-02 3 1  ON 21
ci_023                 1.196145e-02 3 1  ON 22
ci_024                 1.106542e-02 3 1  ON 23
ci_025                 1.092349e-02 3 1  ON 24
ci_026                 1.204194e-02 3 1  ON 25
ci_027                 1.190040e-02 3 1  ON 26
ci_028                -1.415319e-02 3 1  ON 27
ci_029                -1.461653e-02 3 1  ON 28
ci_030                -1.094616e-02 3 1  ON 29
ci_031                -1.099301e-02 3 1  ON 30
ci_032                -1.397747e-02 3 1  ON 31
ci_033                 1.057722e-02 3 1  ON 32
ci_034                 1.057362e-02 3 1  ON 33
ci_035                -5.168436e-03 3 1  ON 34
ci_036                -1.078654e-02 3 1  ON 35
ci_037                -1.101760e-02 3 1  ON 36
ci_038                 1.348237e-03 3 1  ON 37
ci_039                 1.281086e-03 3 1  ON 38
ci_040                -4.256752e-03 3 1  ON 39
ci_041                 9.558651e-03 3 1  ON 40
ci_042                 9.937025e-03 3 1  ON 41
ci_043                -3.612747e-03 3 1  ON 42
ci_044                -1.507061e-02 3 1  ON 43
ci_045                -1.873854e-03 3 1  ON 44
ci_046                 5.375912e-03 3 1  ON 45
ci_047                 5.589608e-03 3 1  ON 46
ci_048                -1.195615e-02 3 1  ON 47
ci_049                -1.195877e-02 3 1  ON 48
ci_050                 7.809081e-03 3 1  ON 49
ci_051                 7.674561e-03 3 1  ON 50
ci_052                -6.863219e-03 3 1  ON 51
ci_053                -6.791270e-03 3 1  ON 52
ci_054                -2.510913e-03 3 1  ON 53
ci_055                -2.280850e-03 3 1  ON 54
ci_056                 4.799818e-03 3 1  ON 55
ci_057                 5.164203e-03 3 1  ON 56
ci_058                -7.180742e-03 3 1  ON 57
ci_059                -7.057055e-03 3 1  ON 58
ci_060                 8.641982e-03 3 1  ON 59
ci_061                 8.449207e-03 3 1  ON 60
ci_062                -2.916242e-03 3 1  ON 61
ci_063                -2.922505e-03 3 1  ON 62
ci_064                -3.450931e-03 3 1  ON 63
ci_065                -4.443216e-03 3 1  ON 64
ci_066                 5.868183e-03 3 1  ON 65
ci_067                 5.980030e-03 3 1  ON 66
ci_068                -4.600770e-03 3 1  ON 67
ci_069                -4.701551e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2369
    reference variance = 0.310397
====================================================
  Execution time = 1.4347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1944e-01
  Total weights = 1.9566e+06
  Execution time = 1.8617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301877219765
                                         uncertainty =       0.002902915773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301877219765
                                         uncertainty =       0.002902915773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510696
  error estimate for blocks of size 2^( 2) =       0.000398423071
  error estimate for blocks of size 2^( 3) =       0.000407306975
  error estimate for blocks of size 2^( 4) =       0.000413646260
  error estimate for blocks of size 2^( 5) =       0.000417202349
  error estimate for blocks of size 2^( 6) =       0.000418018396
  error estimate for blocks of size 2^( 7) =       0.000420156222

      target function =                  N/A
              le_mean =     -17.216322149930
             les_mean =     296.721190587387
             stat err =       0.000417255807
             autocorr =       1.153450120715
              std dev =       0.549437095489
             le_variance =       0.301881121900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301876220622
                                         uncertainty =       0.002918791557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301876220622
                                         uncertainty =       0.002918791557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510021
  error estimate for blocks of size 2^( 2) =       0.000398421479
  error estimate for blocks of size 2^( 3) =       0.000407305786
  error estimate for blocks of size 2^( 4) =       0.000413645923
  error estimate for blocks of size 2^( 5) =       0.000417204910
  error estimate for blocks of size 2^( 6) =       0.000418021897
  error estimate for blocks of size 2^( 7) =       0.000420159602

      target function =                  N/A
              le_mean =     -17.216320858529
             les_mean =     296.721211191255
             stat err =       0.000417258083
             autocorr =       1.153466711507
              std dev =       0.549436141377
             le_variance =       0.301880073451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301875002608
                                         uncertainty =       0.002911257613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301875002608
                                         uncertainty =       0.002911257613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388509252
  error estimate for blocks of size 2^( 2) =       0.000398421148
  error estimate for blocks of size 2^( 3) =       0.000407305313
  error estimate for blocks of size 2^( 4) =       0.000413645044
  error estimate for blocks of size 2^( 5) =       0.000417202718
  error estimate for blocks of size 2^( 6) =       0.000418019231
  error estimate for blocks of size 2^( 7) =       0.000420156949

      target function =                  N/A
              le_mean =     -17.216321358859
             les_mean =     296.721171549626
             stat err =       0.000417255985
             autocorr =       1.153459682719
              std dev =       0.549435053365
             le_variance =       0.301878877866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301876773834
                                         uncertainty =       0.002903962987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301876773834
                                         uncertainty =       0.002903962987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388510407
  error estimate for blocks of size 2^( 2) =       0.000398422721
  error estimate for blocks of size 2^( 3) =       0.000407306660
  error estimate for blocks of size 2^( 4) =       0.000413646002
  error estimate for blocks of size 2^( 5) =       0.000417202294
  error estimate for blocks of size 2^( 6) =       0.000418018400
  error estimate for blocks of size 2^( 7) =       0.000420156204

      target function =                  N/A
              le_mean =     -17.216322037689
             les_mean =     296.721183675360
             stat err =       0.000417255725
             autocorr =       1.153451385574
              std dev =       0.549436686575
             le_variance =       0.301880672555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216322149930        initial  <--
     2.3283e+00     2.3283e+01             1.2789e-04       -17.216320858529
     9.3132e+00     9.3132e+01             3.5319e-05       -17.216321358859
     3.7253e+01     3.7253e+02             9.0769e-06       -17.216322037689

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7429
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.085723e-02 3 1  ON 0
ci_002                -3.049748e-02 3 1  ON 1
ci_003                -2.522687e-02 3 1  ON 2
ci_004                 2.151668e-02 3 1  ON 3
ci_005                 2.190669e-02 3 1  ON 4
ci_006                -1.969606e-02 3 1  ON 5
ci_007                -2.007766e-02 3 1  ON 6
ci_008                -1.842492e-02 3 1  ON 7
ci_009                -1.833972e-02 3 1  ON 8
ci_010                -1.666694e-02 3 1  ON 9
ci_011                -1.623079e-02 3 1  ON 10
ci_012                -1.641281e-02 3 1  ON 11
ci_013                -1.880802e-02 3 1  ON 12
ci_014                 1.379122e-02 3 1  ON 13
ci_015                 1.467738e-02 3 1  ON 14
ci_016                 1.621874e-02 3 1  ON 15
ci_017                 1.673520e-02 3 1  ON 16
ci_018                 1.311723e-02 3 1  ON 17
ci_019                 1.332424e-02 3 1  ON 18
ci_020                 1.383300e-02 3 1  ON 19
ci_021                 1.327256e-02 3 1  ON 20
ci_022                 1.181856e-02 3 1  ON 21
ci_023                 1.195990e-02 3 1  ON 22
ci_024                 1.107033e-02 3 1  ON 23
ci_025                 1.093062e-02 3 1  ON 24
ci_026                 1.203674e-02 3 1  ON 25
ci_027                 1.188848e-02 3 1  ON 26
ci_028                -1.415408e-02 3 1  ON 27
ci_029                -1.465051e-02 3 1  ON 28
ci_030                -1.093799e-02 3 1  ON 29
ci_031                -1.098618e-02 3 1  ON 30
ci_032                -1.396709e-02 3 1  ON 31
ci_033                 1.056389e-02 3 1  ON 32
ci_034                 1.058735e-02 3 1  ON 33
ci_035                -5.168634e-03 3 1  ON 34
ci_036                -1.076827e-02 3 1  ON 35
ci_037                -1.101806e-02 3 1  ON 36
ci_038                 1.345609e-03 3 1  ON 37
ci_039                 1.294678e-03 3 1  ON 38
ci_040                -4.270844e-03 3 1  ON 39
ci_041                 9.548240e-03 3 1  ON 40
ci_042                 9.953968e-03 3 1  ON 41
ci_043                -3.617247e-03 3 1  ON 42
ci_044                -1.505333e-02 3 1  ON 43
ci_045                -1.875799e-03 3 1  ON 44
ci_046                 5.376670e-03 3 1  ON 45
ci_047                 5.594176e-03 3 1  ON 46
ci_048                -1.195444e-02 3 1  ON 47
ci_049                -1.195664e-02 3 1  ON 48
ci_050                 7.810780e-03 3 1  ON 49
ci_051                 7.639242e-03 3 1  ON 50
ci_052                -6.867989e-03 3 1  ON 51
ci_053                -6.790542e-03 3 1  ON 52
ci_054                -2.517391e-03 3 1  ON 53
ci_055                -2.280005e-03 3 1  ON 54
ci_056                 4.782173e-03 3 1  ON 55
ci_057                 5.176274e-03 3 1  ON 56
ci_058                -7.164862e-03 3 1  ON 57
ci_059                -7.037337e-03 3 1  ON 58
ci_060                 8.624404e-03 3 1  ON 59
ci_061                 8.441349e-03 3 1  ON 60
ci_062                -2.921085e-03 3 1  ON 61
ci_063                -2.935788e-03 3 1  ON 62
ci_064                -3.464408e-03 3 1  ON 63
ci_065                -4.462138e-03 3 1  ON 64
ci_066                 5.860032e-03 3 1  ON 65
ci_067                 5.991839e-03 3 1  ON 66
ci_068                -4.610717e-03 3 1  ON 67
ci_069                -4.712696e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.328156
====================================================
  Execution time = 1.4639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1566e-01
  Total weights = 1.956518040e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297332418819
                                         uncertainty =       0.001810743497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297332418819
                                         uncertainty =       0.001810743497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385543454
  error estimate for blocks of size 2^( 2) =       0.000395204095
  error estimate for blocks of size 2^( 3) =       0.000404510553
  error estimate for blocks of size 2^( 4) =       0.000411152520
  error estimate for blocks of size 2^( 5) =       0.000415584541
  error estimate for blocks of size 2^( 6) =       0.000418656478
  error estimate for blocks of size 2^( 7) =       0.000419962723

      target function =                  N/A
              le_mean =     -17.216118796110
             les_mean =     296.710407955611
             stat err =       0.000416339065
             autocorr =       1.166131855349
              std dev =       0.545240780844
             le_variance =       0.297287509095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611879611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216118796149       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216118933300       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216118939125       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.547675e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216118796149       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216118830720       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216118832172       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.902458e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216118796149       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216118804809       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216118805172       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 9.777173e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074227 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0667e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.085628e-02 3 1  ON 0
ci_002                -3.049940e-02 3 1  ON 1
ci_003                -2.522749e-02 3 1  ON 2
ci_004                 2.151533e-02 3 1  ON 3
ci_005                 2.190392e-02 3 1  ON 4
ci_006                -1.969590e-02 3 1  ON 5
ci_007                -2.007561e-02 3 1  ON 6
ci_008                -1.842262e-02 3 1  ON 7
ci_009                -1.833963e-02 3 1  ON 8
ci_010                -1.666737e-02 3 1  ON 9
ci_011                -1.623107e-02 3 1  ON 10
ci_012                -1.641332e-02 3 1  ON 11
ci_013                -1.880908e-02 3 1  ON 12
ci_014                 1.379423e-02 3 1  ON 13
ci_015                 1.467693e-02 3 1  ON 14
ci_016                 1.621993e-02 3 1  ON 15
ci_017                 1.673630e-02 3 1  ON 16
ci_018                 1.311731e-02 3 1  ON 17
ci_019                 1.332607e-02 3 1  ON 18
ci_020                 1.383231e-02 3 1  ON 19
ci_021                 1.327149e-02 3 1  ON 20
ci_022                 1.181821e-02 3 1  ON 21
ci_023                 1.196037e-02 3 1  ON 22
ci_024                 1.106940e-02 3 1  ON 23
ci_025                 1.092899e-02 3 1  ON 24
ci_026                 1.203549e-02 3 1  ON 25
ci_027                 1.189074e-02 3 1  ON 26
ci_028                -1.415353e-02 3 1  ON 27
ci_029                -1.464938e-02 3 1  ON 28
ci_030                -1.093687e-02 3 1  ON 29
ci_031                -1.098402e-02 3 1  ON 30
ci_032                -1.396654e-02 3 1  ON 31
ci_033                 1.056466e-02 3 1  ON 32
ci_034                 1.058543e-02 3 1  ON 33
ci_035                -5.167612e-03 3 1  ON 34
ci_036                -1.076882e-02 3 1  ON 35
ci_037                -1.101948e-02 3 1  ON 36
ci_038                 1.345376e-03 3 1  ON 37
ci_039                 1.291767e-03 3 1  ON 38
ci_040                -4.271215e-03 3 1  ON 39
ci_041                 9.548565e-03 3 1  ON 40
ci_042                 9.955410e-03 3 1  ON 41
ci_043                -3.616050e-03 3 1  ON 42
ci_044                -1.505367e-02 3 1  ON 43
ci_045                -1.875280e-03 3 1  ON 44
ci_046                 5.375838e-03 3 1  ON 45
ci_047                 5.598078e-03 3 1  ON 46
ci_048                -1.195318e-02 3 1  ON 47
ci_049                -1.195765e-02 3 1  ON 48
ci_050                 7.807900e-03 3 1  ON 49
ci_051                 7.639305e-03 3 1  ON 50
ci_052                -6.868195e-03 3 1  ON 51
ci_053                -6.790433e-03 3 1  ON 52
ci_054                -2.515530e-03 3 1  ON 53
ci_055                -2.280730e-03 3 1  ON 54
ci_056                 4.784514e-03 3 1  ON 55
ci_057                 5.175551e-03 3 1  ON 56
ci_058                -7.166726e-03 3 1  ON 57
ci_059                -7.036040e-03 3 1  ON 58
ci_060                 8.620823e-03 3 1  ON 59
ci_061                 8.441553e-03 3 1  ON 60
ci_062                -2.919424e-03 3 1  ON 61
ci_063                -2.936766e-03 3 1  ON 62
ci_064                -3.464653e-03 3 1  ON 63
ci_065                -4.460496e-03 3 1  ON 64
ci_066                 5.859895e-03 3 1  ON 65
ci_067                 5.989722e-03 3 1  ON 66
ci_068                -4.612179e-03 3 1  ON 67
ci_069                -4.714645e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1651
    reference variance = 0.262308
====================================================
  Execution time = 1.4837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1595e-01
  Total weights = 1.9567e+06
  Execution time = 1.8534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298820441649
                                         uncertainty =       0.002708524130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298820441649
                                         uncertainty =       0.002708524130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386582582
  error estimate for blocks of size 2^( 2) =       0.000396348820
  error estimate for blocks of size 2^( 3) =       0.000405365729
  error estimate for blocks of size 2^( 4) =       0.000411950820
  error estimate for blocks of size 2^( 5) =       0.000415462896
  error estimate for blocks of size 2^( 6) =       0.000417973241
  error estimate for blocks of size 2^( 7) =       0.000420565913

      target function =                  N/A
              le_mean =     -17.216934735527
             les_mean =     296.738801142499
             stat err =       0.000416488217
             autocorr =       1.160702378634
              std dev =       0.546710330465
             le_variance =       0.298892185437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298810962766
                                         uncertainty =       0.002708928665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298810962766
                                         uncertainty =       0.002708928665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386576443
  error estimate for blocks of size 2^( 2) =       0.000396342843
  error estimate for blocks of size 2^( 3) =       0.000405359881
  error estimate for blocks of size 2^( 4) =       0.000411945026
  error estimate for blocks of size 2^( 5) =       0.000415457902
  error estimate for blocks of size 2^( 6) =       0.000417968568
  error estimate for blocks of size 2^( 7) =       0.000420560898

      target function =                  N/A
              le_mean =     -17.216934761337
             les_mean =     296.738783391612
             stat err =       0.000416483099
             autocorr =       1.160710714495
              std dev =       0.546701647949
             le_variance =       0.298882691870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298815632427
                                         uncertainty =       0.002708726236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298815632427
                                         uncertainty =       0.002708726236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386579467
  error estimate for blocks of size 2^( 2) =       0.000396345788
  error estimate for blocks of size 2^( 3) =       0.000405362762
  error estimate for blocks of size 2^( 4) =       0.000411947881
  error estimate for blocks of size 2^( 5) =       0.000415460361
  error estimate for blocks of size 2^( 6) =       0.000417970869
  error estimate for blocks of size 2^( 7) =       0.000420563367

      target function =                  N/A
              le_mean =     -17.216934746741
             les_mean =     296.738791184895
             stat err =       0.000416485619
             autocorr =       1.160706602484
              std dev =       0.546705925338
             le_variance =       0.298887368800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298819836900
                                         uncertainty =       0.002708549307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298819836900
                                         uncertainty =       0.002708549307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386582190
  error estimate for blocks of size 2^( 2) =       0.000396348439
  error estimate for blocks of size 2^( 3) =       0.000405365356
  error estimate for blocks of size 2^( 4) =       0.000411950450
  error estimate for blocks of size 2^( 5) =       0.000415462577
  error estimate for blocks of size 2^( 6) =       0.000417972943
  error estimate for blocks of size 2^( 7) =       0.000420565592

      target function =                  N/A
              le_mean =     -17.216934736720
             les_mean =     296.738799778630
             stat err =       0.000416487891
             autocorr =       1.160702909094
              std dev =       0.546709776536
             le_variance =       0.298891579760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934735527        initial
     2.3283e+01     2.3283e+02             1.5477e-05       -17.216934761337  <--
     9.3132e+01     9.3132e+02             3.9025e-06       -17.216934746741
     3.7253e+02     3.7253e+03             9.7772e-07       -17.216934736720

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.4209e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.085347e-02 3 1  ON 0
ci_002                -3.050508e-02 3 1  ON 1
ci_003                -2.522934e-02 3 1  ON 2
ci_004                 2.151132e-02 3 1  ON 3
ci_005                 2.189568e-02 3 1  ON 4
ci_006                -1.969542e-02 3 1  ON 5
ci_007                -2.006950e-02 3 1  ON 6
ci_008                -1.841578e-02 3 1  ON 7
ci_009                -1.833937e-02 3 1  ON 8
ci_010                -1.666867e-02 3 1  ON 9
ci_011                -1.623190e-02 3 1  ON 10
ci_012                -1.641483e-02 3 1  ON 11
ci_013                -1.881225e-02 3 1  ON 12
ci_014                 1.380318e-02 3 1  ON 13
ci_015                 1.467557e-02 3 1  ON 14
ci_016                 1.622348e-02 3 1  ON 15
ci_017                 1.673957e-02 3 1  ON 16
ci_018                 1.311754e-02 3 1  ON 17
ci_019                 1.333149e-02 3 1  ON 18
ci_020                 1.383028e-02 3 1  ON 19
ci_021                 1.326832e-02 3 1  ON 20
ci_022                 1.181714e-02 3 1  ON 21
ci_023                 1.196176e-02 3 1  ON 22
ci_024                 1.106666e-02 3 1  ON 23
ci_025                 1.092414e-02 3 1  ON 24
ci_026                 1.203177e-02 3 1  ON 25
ci_027                 1.189745e-02 3 1  ON 26
ci_028                -1.415190e-02 3 1  ON 27
ci_029                -1.464604e-02 3 1  ON 28
ci_030                -1.093355e-02 3 1  ON 29
ci_031                -1.097761e-02 3 1  ON 30
ci_032                -1.396493e-02 3 1  ON 31
ci_033                 1.056693e-02 3 1  ON 32
ci_034                 1.057974e-02 3 1  ON 33
ci_035                -5.164598e-03 3 1  ON 34
ci_036                -1.077043e-02 3 1  ON 35
ci_037                -1.102371e-02 3 1  ON 36
ci_038                 1.344685e-03 3 1  ON 37
ci_039                 1.283179e-03 3 1  ON 38
ci_040                -4.272308e-03 3 1  ON 39
ci_041                 9.549527e-03 3 1  ON 40
ci_042                 9.959692e-03 3 1  ON 41
ci_043                -3.612512e-03 3 1  ON 42
ci_044                -1.505468e-02 3 1  ON 43
ci_045                -1.873747e-03 3 1  ON 44
ci_046                 5.373371e-03 3 1  ON 45
ci_047                 5.609652e-03 3 1  ON 46
ci_048                -1.194941e-02 3 1  ON 47
ci_049                -1.196067e-02 3 1  ON 48
ci_050                 7.799387e-03 3 1  ON 49
ci_051                 7.639489e-03 3 1  ON 50
ci_052                -6.868802e-03 3 1  ON 51
ci_053                -6.790113e-03 3 1  ON 52
ci_054                -2.510015e-03 3 1  ON 53
ci_055                -2.282876e-03 3 1  ON 54
ci_056                 4.791436e-03 3 1  ON 55
ci_057                 5.173415e-03 3 1  ON 56
ci_058                -7.172251e-03 3 1  ON 57
ci_059                -7.032200e-03 3 1  ON 58
ci_060                 8.610192e-03 3 1  ON 59
ci_061                 8.442159e-03 3 1  ON 60
ci_062                -2.914501e-03 3 1  ON 61
ci_063                -2.939662e-03 3 1  ON 62
ci_064                -3.465378e-03 3 1  ON 63
ci_065                -4.455663e-03 3 1  ON 64
ci_066                 5.859491e-03 3 1  ON 65
ci_067                 5.983467e-03 3 1  ON 66
ci_068                -4.616516e-03 3 1  ON 67
ci_069                -4.720428e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.397423
====================================================
  Execution time = 1.4751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1985e-01
  Total weights = 1.956741916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301463190148
                                         uncertainty =       0.002455907835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301463190148
                                         uncertainty =       0.002455907835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388377574
  error estimate for blocks of size 2^( 2) =       0.000398466234
  error estimate for blocks of size 2^( 3) =       0.000407618274
  error estimate for blocks of size 2^( 4) =       0.000413908131
  error estimate for blocks of size 2^( 5) =       0.000418393835
  error estimate for blocks of size 2^( 6) =       0.000420084059
  error estimate for blocks of size 2^( 7) =       0.000422121865

      target function =                  N/A
              le_mean =     -17.217562677986
             les_mean =     296.764314967376
             stat err =       0.000418626972
             autocorr =       1.161839465366
              std dev =       0.549248832316
             le_variance =       0.301674279801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721756267799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217562678059       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217562744557       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217562755035       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217562761145       residual = 2.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 6.407722e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217562678059       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217562695247       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217562696460       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217562698253       residual = 3.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.655805e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217562678059       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217562682392       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217562682602       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217562683068       residual = 3.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 4.174627e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7319e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.084907e-02 3 1  ON 0
ci_002                -3.050390e-02 3 1  ON 1
ci_003                -2.523524e-02 3 1  ON 2
ci_004                 2.151431e-02 3 1  ON 3
ci_005                 2.189172e-02 3 1  ON 4
ci_006                -1.970028e-02 3 1  ON 5
ci_007                -2.006586e-02 3 1  ON 6
ci_008                -1.840044e-02 3 1  ON 7
ci_009                -1.834376e-02 3 1  ON 8
ci_010                -1.667683e-02 3 1  ON 9
ci_011                -1.623921e-02 3 1  ON 10
ci_012                -1.641196e-02 3 1  ON 11
ci_013                -1.882229e-02 3 1  ON 12
ci_014                 1.381364e-02 3 1  ON 13
ci_015                 1.466090e-02 3 1  ON 14
ci_016                 1.623095e-02 3 1  ON 15
ci_017                 1.674363e-02 3 1  ON 16
ci_018                 1.311723e-02 3 1  ON 17
ci_019                 1.332435e-02 3 1  ON 18
ci_020                 1.383246e-02 3 1  ON 19
ci_021                 1.327051e-02 3 1  ON 20
ci_022                 1.182012e-02 3 1  ON 21
ci_023                 1.195352e-02 3 1  ON 22
ci_024                 1.106650e-02 3 1  ON 23
ci_025                 1.093454e-02 3 1  ON 24
ci_026                 1.202985e-02 3 1  ON 25
ci_027                 1.189809e-02 3 1  ON 26
ci_028                -1.415850e-02 3 1  ON 27
ci_029                -1.464065e-02 3 1  ON 28
ci_030                -1.093436e-02 3 1  ON 29
ci_031                -1.096939e-02 3 1  ON 30
ci_032                -1.396824e-02 3 1  ON 31
ci_033                 1.056141e-02 3 1  ON 32
ci_034                 1.057243e-02 3 1  ON 33
ci_035                -5.162010e-03 3 1  ON 34
ci_036                -1.076759e-02 3 1  ON 35
ci_037                -1.102243e-02 3 1  ON 36
ci_038                 1.344108e-03 3 1  ON 37
ci_039                 1.288625e-03 3 1  ON 38
ci_040                -4.262063e-03 3 1  ON 39
ci_041                 9.554395e-03 3 1  ON 40
ci_042                 9.968344e-03 3 1  ON 41
ci_043                -3.609709e-03 3 1  ON 42
ci_044                -1.506054e-02 3 1  ON 43
ci_045                -1.866958e-03 3 1  ON 44
ci_046                 5.376251e-03 3 1  ON 45
ci_047                 5.626210e-03 3 1  ON 46
ci_048                -1.195724e-02 3 1  ON 47
ci_049                -1.195936e-02 3 1  ON 48
ci_050                 7.789874e-03 3 1  ON 49
ci_051                 7.632446e-03 3 1  ON 50
ci_052                -6.877861e-03 3 1  ON 51
ci_053                -6.792774e-03 3 1  ON 52
ci_054                -2.500966e-03 3 1  ON 53
ci_055                -2.285355e-03 3 1  ON 54
ci_056                 4.796775e-03 3 1  ON 55
ci_057                 5.163550e-03 3 1  ON 56
ci_058                -7.181931e-03 3 1  ON 57
ci_059                -7.027932e-03 3 1  ON 58
ci_060                 8.610318e-03 3 1  ON 59
ci_061                 8.449159e-03 3 1  ON 60
ci_062                -2.917601e-03 3 1  ON 61
ci_063                -2.932490e-03 3 1  ON 62
ci_064                -3.477337e-03 3 1  ON 63
ci_065                -4.453703e-03 3 1  ON 64
ci_066                 5.858103e-03 3 1  ON 65
ci_067                 5.979563e-03 3 1  ON 66
ci_068                -4.606205e-03 3 1  ON 67
ci_069                -4.723991e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2753
    reference variance = 0.183614
====================================================
  Execution time = 1.4640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1129e-01
  Total weights = 1.9570e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670784683
                                         uncertainty =       0.002032451263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296670784683
                                         uncertainty =       0.002032451263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385111738
  error estimate for blocks of size 2^( 2) =       0.000395232294
  error estimate for blocks of size 2^( 3) =       0.000404125182
  error estimate for blocks of size 2^( 4) =       0.000409974003
  error estimate for blocks of size 2^( 5) =       0.000414737509
  error estimate for blocks of size 2^( 6) =       0.000417606023
  error estimate for blocks of size 2^( 7) =       0.000419583337

      target function =                  N/A
              le_mean =     -17.216130967462
             les_mean =     296.706461087098
             stat err =       0.000415475218
             autocorr =       1.163902862055
              std dev =       0.544630243500
             le_variance =       0.296622102135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633426358
                                         uncertainty =       0.002036941351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296633426358
                                         uncertainty =       0.002036941351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385087479
  error estimate for blocks of size 2^( 2) =       0.000395207946
  error estimate for blocks of size 2^( 3) =       0.000404101077
  error estimate for blocks of size 2^( 4) =       0.000409950093
  error estimate for blocks of size 2^( 5) =       0.000414713133
  error estimate for blocks of size 2^( 6) =       0.000417578933
  error estimate for blocks of size 2^( 7) =       0.000419554395

      target function =                  N/A
              le_mean =     -17.216131245489
             les_mean =     296.706544333125
             stat err =       0.000415449139
             autocorr =       1.163903382644
              std dev =       0.544595935447
             le_variance =       0.296584732905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296651019613
                                         uncertainty =       0.002034757090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296651019613
                                         uncertainty =       0.002034757090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385098904
  error estimate for blocks of size 2^( 2) =       0.000395219409
  error estimate for blocks of size 2^( 3) =       0.000404112433
  error estimate for blocks of size 2^( 4) =       0.000409961371
  error estimate for blocks of size 2^( 5) =       0.000414724665
  error estimate for blocks of size 2^( 6) =       0.000417591767
  error estimate for blocks of size 2^( 7) =       0.000419568105

      target function =                  N/A
              le_mean =     -17.216131077423
             les_mean =     296.706459845458
             stat err =       0.000415461477
             autocorr =       1.163903452683
              std dev =       0.544612092649
             le_variance =       0.296602331460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296668252598
                                         uncertainty =       0.002032739472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296668252598
                                         uncertainty =       0.002032739472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385110094
  error estimate for blocks of size 2^( 2) =       0.000395230643
  error estimate for blocks of size 2^( 3) =       0.000404123549
  error estimate for blocks of size 2^( 4) =       0.000409972385
  error estimate for blocks of size 2^( 5) =       0.000414735866
  error estimate for blocks of size 2^( 6) =       0.000417604202
  error estimate for blocks of size 2^( 7) =       0.000419581391

      target function =                  N/A
              le_mean =     -17.216130977393
             les_mean =     296.706458721236
             stat err =       0.000415473461
             autocorr =       1.163902956167
              std dev =       0.544627918267
             le_variance =       0.296619569356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216130967462        initial
     5.8208e+00     5.8208e+01             6.4077e-05       -17.216131245489  <--
     2.3283e+01     2.3283e+02             1.6558e-05       -17.216131077423
     9.3132e+01     9.3132e+02             4.1746e-06       -17.216130977393

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.4033e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.083616e-02 3 1  ON 0
ci_002                -3.050042e-02 3 1  ON 1
ci_003                -2.525239e-02 3 1  ON 2
ci_004                 2.152304e-02 3 1  ON 3
ci_005                 2.188014e-02 3 1  ON 4
ci_006                -1.971435e-02 3 1  ON 5
ci_007                -2.005520e-02 3 1  ON 6
ci_008                -1.835656e-02 3 1  ON 7
ci_009                -1.835621e-02 3 1  ON 8
ci_010                -1.670053e-02 3 1  ON 9
ci_011                -1.626024e-02 3 1  ON 10
ci_012                -1.640378e-02 3 1  ON 11
ci_013                -1.885167e-02 3 1  ON 12
ci_014                 1.384389e-02 3 1  ON 13
ci_015                 1.461870e-02 3 1  ON 14
ci_016                 1.625267e-02 3 1  ON 15
ci_017                 1.675531e-02 3 1  ON 16
ci_018                 1.311632e-02 3 1  ON 17
ci_019                 1.330379e-02 3 1  ON 18
ci_020                 1.383864e-02 3 1  ON 19
ci_021                 1.327692e-02 3 1  ON 20
ci_022                 1.182861e-02 3 1  ON 21
ci_023                 1.192991e-02 3 1  ON 22
ci_024                 1.106604e-02 3 1  ON 23
ci_025                 1.096488e-02 3 1  ON 24
ci_026                 1.202436e-02 3 1  ON 25
ci_027                 1.190004e-02 3 1  ON 26
ci_028                -1.417762e-02 3 1  ON 27
ci_029                -1.462500e-02 3 1  ON 28
ci_030                -1.093679e-02 3 1  ON 29
ci_031                -1.094572e-02 3 1  ON 30
ci_032                -1.397766e-02 3 1  ON 31
ci_033                 1.054551e-02 3 1  ON 32
ci_034                 1.055133e-02 3 1  ON 33
ci_035                -5.154717e-03 3 1  ON 34
ci_036                -1.075936e-02 3 1  ON 35
ci_037                -1.101866e-02 3 1  ON 36
ci_038                 1.342495e-03 3 1  ON 37
ci_039                 1.303946e-03 3 1  ON 38
ci_040                -4.233392e-03 3 1  ON 39
ci_041                 9.568491e-03 3 1  ON 40
ci_042                 9.993330e-03 3 1  ON 41
ci_043                -3.601815e-03 3 1  ON 42
ci_044                -1.507767e-02 3 1  ON 43
ci_045                -1.847899e-03 3 1  ON 44
ci_046                 5.384515e-03 3 1  ON 45
ci_047                 5.673730e-03 3 1  ON 46
ci_048                -1.198008e-02 3 1  ON 47
ci_049                -1.195561e-02 3 1  ON 48
ci_050                 7.762925e-03 3 1  ON 49
ci_051                 7.612488e-03 3 1  ON 50
ci_052                -6.903603e-03 3 1  ON 51
ci_053                -6.800325e-03 3 1  ON 52
ci_054                -2.475130e-03 3 1  ON 53
ci_055                -2.292407e-03 3 1  ON 54
ci_056                 4.811925e-03 3 1  ON 55
ci_057                 5.135588e-03 3 1  ON 56
ci_058                -7.209584e-03 3 1  ON 57
ci_059                -7.015741e-03 3 1  ON 58
ci_060                 8.610673e-03 3 1  ON 59
ci_061                 8.469342e-03 3 1  ON 60
ci_062                -2.926464e-03 3 1  ON 61
ci_063                -2.911956e-03 3 1  ON 62
ci_064                -3.510254e-03 3 1  ON 63
ci_065                -4.448283e-03 3 1  ON 64
ci_066                 5.854193e-03 3 1  ON 65
ci_067                 5.968543e-03 3 1  ON 66
ci_068                -4.576589e-03 3 1  ON 67
ci_069                -4.734197e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1606
    reference variance = 0.305535
====================================================
  Execution time = 1.4666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1351e-01
  Total weights = 1.956543060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298107904838
                                         uncertainty =       0.002089118993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298107904838
                                         uncertainty =       0.002089118993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386081545
  error estimate for blocks of size 2^( 2) =       0.000396288673
  error estimate for blocks of size 2^( 3) =       0.000405109747
  error estimate for blocks of size 2^( 4) =       0.000411149150
  error estimate for blocks of size 2^( 5) =       0.000414647251
  error estimate for blocks of size 2^( 6) =       0.000417566255
  error estimate for blocks of size 2^( 7) =       0.000419235516

      target function =                  N/A
              le_mean =     -17.217381168080
             les_mean =     296.751721973972
             stat err =       0.000415649543
             autocorr =       1.159034942268
              std dev =       0.546001757567
             le_variance =       0.298117919266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721738116808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381168139       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217381836455       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217382095146       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217382076481       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 1.519081e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381168139       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217381355131       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217381431135       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217381425554       residual = 2.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 4.273674e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217381168139       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217381216323       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217381236109       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217381234705       residual = 2.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.102995e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7234e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.082949e-02 3 1  ON 0
ci_002                -3.048885e-02 3 1  ON 1
ci_003                -2.524655e-02 3 1  ON 2
ci_004                 2.153839e-02 3 1  ON 3
ci_005                 2.184747e-02 3 1  ON 4
ci_006                -1.973619e-02 3 1  ON 5
ci_007                -2.004744e-02 3 1  ON 6
ci_008                -1.837003e-02 3 1  ON 7
ci_009                -1.834811e-02 3 1  ON 8
ci_010                -1.673631e-02 3 1  ON 9
ci_011                -1.629343e-02 3 1  ON 10
ci_012                -1.644582e-02 3 1  ON 11
ci_013                -1.886464e-02 3 1  ON 12
ci_014                 1.380116e-02 3 1  ON 13
ci_015                 1.460549e-02 3 1  ON 14
ci_016                 1.626390e-02 3 1  ON 15
ci_017                 1.673759e-02 3 1  ON 16
ci_018                 1.313144e-02 3 1  ON 17
ci_019                 1.332496e-02 3 1  ON 18
ci_020                 1.387027e-02 3 1  ON 19
ci_021                 1.329175e-02 3 1  ON 20
ci_022                 1.182288e-02 3 1  ON 21
ci_023                 1.193176e-02 3 1  ON 22
ci_024                 1.105288e-02 3 1  ON 23
ci_025                 1.094579e-02 3 1  ON 24
ci_026                 1.203976e-02 3 1  ON 25
ci_027                 1.190281e-02 3 1  ON 26
ci_028                -1.418947e-02 3 1  ON 27
ci_029                -1.463107e-02 3 1  ON 28
ci_030                -1.094333e-02 3 1  ON 29
ci_031                -1.092232e-02 3 1  ON 30
ci_032                -1.401231e-02 3 1  ON 31
ci_033                 1.053611e-02 3 1  ON 32
ci_034                 1.052316e-02 3 1  ON 33
ci_035                -5.155635e-03 3 1  ON 34
ci_036                -1.078608e-02 3 1  ON 35
ci_037                -1.104366e-02 3 1  ON 36
ci_038                 1.352909e-03 3 1  ON 37
ci_039                 1.318373e-03 3 1  ON 38
ci_040                -4.234041e-03 3 1  ON 39
ci_041                 9.574914e-03 3 1  ON 40
ci_042                 9.999520e-03 3 1  ON 41
ci_043                -3.577444e-03 3 1  ON 42
ci_044                -1.506208e-02 3 1  ON 43
ci_045                -1.845096e-03 3 1  ON 44
ci_046                 5.389584e-03 3 1  ON 45
ci_047                 5.672868e-03 3 1  ON 46
ci_048                -1.198297e-02 3 1  ON 47
ci_049                -1.194762e-02 3 1  ON 48
ci_050                 7.771630e-03 3 1  ON 49
ci_051                 7.619757e-03 3 1  ON 50
ci_052                -6.919715e-03 3 1  ON 51
ci_053                -6.818564e-03 3 1  ON 52
ci_054                -2.469718e-03 3 1  ON 53
ci_055                -2.323687e-03 3 1  ON 54
ci_056                 4.819370e-03 3 1  ON 55
ci_057                 5.143916e-03 3 1  ON 56
ci_058                -7.225269e-03 3 1  ON 57
ci_059                -7.054884e-03 3 1  ON 58
ci_060                 8.585062e-03 3 1  ON 59
ci_061                 8.490028e-03 3 1  ON 60
ci_062                -2.938384e-03 3 1  ON 61
ci_063                -2.906506e-03 3 1  ON 62
ci_064                -3.521702e-03 3 1  ON 63
ci_065                -4.456374e-03 3 1  ON 64
ci_066                 5.834543e-03 3 1  ON 65
ci_067                 5.979840e-03 3 1  ON 66
ci_068                -4.584166e-03 3 1  ON 67
ci_069                -4.693059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1463
    reference variance = 0.475914
====================================================
  Execution time = 1.4354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1136e-01
  Total weights = 1.9568e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296093695099
                                         uncertainty =       0.002015837547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296093695099
                                         uncertainty =       0.002015837547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384802806
  error estimate for blocks of size 2^( 2) =       0.000395032256
  error estimate for blocks of size 2^( 3) =       0.000403807732
  error estimate for blocks of size 2^( 4) =       0.000410115689
  error estimate for blocks of size 2^( 5) =       0.000413692673
  error estimate for blocks of size 2^( 6) =       0.000415200105
  error estimate for blocks of size 2^( 7) =       0.000415254603

      target function =                  N/A
              le_mean =     -17.216606425690
             les_mean =     296.722802970674
             stat err =       0.000413565767
             autocorr =       1.155081709002
              std dev =       0.544193346413
             le_variance =       0.296146398281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296191622608
                                         uncertainty =       0.002019134650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296191622608
                                         uncertainty =       0.002019134650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384866494
  error estimate for blocks of size 2^( 2) =       0.000395093223
  error estimate for blocks of size 2^( 3) =       0.000403864705
  error estimate for blocks of size 2^( 4) =       0.000410168132
  error estimate for blocks of size 2^( 5) =       0.000413739401
  error estimate for blocks of size 2^( 6) =       0.000415239742
  error estimate for blocks of size 2^( 7) =       0.000415292123

      target function =                  N/A
              le_mean =     -17.216605342909
             les_mean =     296.724153005643
             stat err =       0.000413609849
             autocorr =       1.154945620743
              std dev =       0.544283415986
             le_variance =       0.296244436917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296149053593
                                         uncertainty =       0.002017645281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296149053593
                                         uncertainty =       0.002017645281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384838810
  error estimate for blocks of size 2^( 2) =       0.000395066606
  error estimate for blocks of size 2^( 3) =       0.000403839764
  error estimate for blocks of size 2^( 4) =       0.000410145235
  error estimate for blocks of size 2^( 5) =       0.000413719276
  error estimate for blocks of size 2^( 6) =       0.000415222641
  error estimate for blocks of size 2^( 7) =       0.000415275982

      target function =                  N/A
              le_mean =     -17.216605766036
             les_mean =     296.723051423013
             stat err =       0.000413590784
             autocorr =       1.155005305541
              std dev =       0.544244264266
             le_variance =       0.296201819186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100697457
                                         uncertainty =       0.002016068290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100697457
                                         uncertainty =       0.002016068290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384807360
  error estimate for blocks of size 2^( 2) =       0.000395036597
  error estimate for blocks of size 2^( 3) =       0.000403811777
  error estimate for blocks of size 2^( 4) =       0.000410119410
  error estimate for blocks of size 2^( 5) =       0.000413696014
  error estimate for blocks of size 2^( 6) =       0.000415202903
  error estimate for blocks of size 2^( 7) =       0.000415257236

      target function =                  N/A
              le_mean =     -17.216606314874
             les_mean =     296.722818770230
             stat err =       0.000413568891
             autocorr =       1.155071812894
              std dev =       0.544199787591
             le_variance =       0.296153408814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216606425690        initial  <--
     1.4552e+00     1.4552e+01             1.5191e-04       -17.216605342909
     5.8208e+00     5.8208e+01             4.2737e-05       -17.216605766036
     2.3283e+01     2.3283e+02             1.1030e-05       -17.216606314874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7471
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.083616e-02 3 1  ON 0
ci_002                -3.050042e-02 3 1  ON 1
ci_003                -2.525239e-02 3 1  ON 2
ci_004                 2.152304e-02 3 1  ON 3
ci_005                 2.188014e-02 3 1  ON 4
ci_006                -1.971435e-02 3 1  ON 5
ci_007                -2.005520e-02 3 1  ON 6
ci_008                -1.835656e-02 3 1  ON 7
ci_009                -1.835621e-02 3 1  ON 8
ci_010                -1.670053e-02 3 1  ON 9
ci_011                -1.626024e-02 3 1  ON 10
ci_012                -1.640378e-02 3 1  ON 11
ci_013                -1.885167e-02 3 1  ON 12
ci_014                 1.384389e-02 3 1  ON 13
ci_015                 1.461870e-02 3 1  ON 14
ci_016                 1.625267e-02 3 1  ON 15
ci_017                 1.675531e-02 3 1  ON 16
ci_018                 1.311632e-02 3 1  ON 17
ci_019                 1.330379e-02 3 1  ON 18
ci_020                 1.383864e-02 3 1  ON 19
ci_021                 1.327692e-02 3 1  ON 20
ci_022                 1.182861e-02 3 1  ON 21
ci_023                 1.192991e-02 3 1  ON 22
ci_024                 1.106604e-02 3 1  ON 23
ci_025                 1.096488e-02 3 1  ON 24
ci_026                 1.202436e-02 3 1  ON 25
ci_027                 1.190004e-02 3 1  ON 26
ci_028                -1.417762e-02 3 1  ON 27
ci_029                -1.462500e-02 3 1  ON 28
ci_030                -1.093679e-02 3 1  ON 29
ci_031                -1.094572e-02 3 1  ON 30
ci_032                -1.397766e-02 3 1  ON 31
ci_033                 1.054551e-02 3 1  ON 32
ci_034                 1.055133e-02 3 1  ON 33
ci_035                -5.154717e-03 3 1  ON 34
ci_036                -1.075936e-02 3 1  ON 35
ci_037                -1.101866e-02 3 1  ON 36
ci_038                 1.342495e-03 3 1  ON 37
ci_039                 1.303946e-03 3 1  ON 38
ci_040                -4.233392e-03 3 1  ON 39
ci_041                 9.568491e-03 3 1  ON 40
ci_042                 9.993330e-03 3 1  ON 41
ci_043                -3.601815e-03 3 1  ON 42
ci_044                -1.507767e-02 3 1  ON 43
ci_045                -1.847899e-03 3 1  ON 44
ci_046                 5.384515e-03 3 1  ON 45
ci_047                 5.673730e-03 3 1  ON 46
ci_048                -1.198008e-02 3 1  ON 47
ci_049                -1.195561e-02 3 1  ON 48
ci_050                 7.762925e-03 3 1  ON 49
ci_051                 7.612488e-03 3 1  ON 50
ci_052                -6.903603e-03 3 1  ON 51
ci_053                -6.800325e-03 3 1  ON 52
ci_054                -2.475130e-03 3 1  ON 53
ci_055                -2.292407e-03 3 1  ON 54
ci_056                 4.811925e-03 3 1  ON 55
ci_057                 5.135588e-03 3 1  ON 56
ci_058                -7.209584e-03 3 1  ON 57
ci_059                -7.015741e-03 3 1  ON 58
ci_060                 8.610673e-03 3 1  ON 59
ci_061                 8.469342e-03 3 1  ON 60
ci_062                -2.926464e-03 3 1  ON 61
ci_063                -2.911956e-03 3 1  ON 62
ci_064                -3.510254e-03 3 1  ON 63
ci_065                -4.448283e-03 3 1  ON 64
ci_066                 5.854193e-03 3 1  ON 65
ci_067                 5.968543e-03 3 1  ON 66
ci_068                -4.576589e-03 3 1  ON 67
ci_069                -4.734197e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1018
    reference variance = 0.175472
====================================================
  Execution time = 1.4666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0818e-01
  Total weights = 1.956801362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295760572567
                                         uncertainty =       0.001978247174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295760572567
                                         uncertainty =       0.001978247174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384529802
  error estimate for blocks of size 2^( 2) =       0.000394562164
  error estimate for blocks of size 2^( 3) =       0.000403417050
  error estimate for blocks of size 2^( 4) =       0.000410521499
  error estimate for blocks of size 2^( 5) =       0.000414147348
  error estimate for blocks of size 2^( 6) =       0.000415368959
  error estimate for blocks of size 2^( 7) =       0.000417224432

      target function =                  N/A
              le_mean =     -17.216839228041
             les_mean =     296.727728631080
             stat err =       0.000414315559
             autocorr =       1.160920495146
              std dev =       0.543807260948
             le_variance =       0.295726337060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683922804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839228099       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839367857       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839369646       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839369933       residual = 3.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+01 is 2.901650e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839228099       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839263537       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839263809       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839263889       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 7.391163e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216839228099       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216839236990       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216839237047       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216839237068       residual = 3.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.856560e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7237e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.083588e-02 3 1  ON 0
ci_002                -3.050059e-02 3 1  ON 1
ci_003                -2.525259e-02 3 1  ON 2
ci_004                 2.152474e-02 3 1  ON 3
ci_005                 2.188105e-02 3 1  ON 4
ci_006                -1.971523e-02 3 1  ON 5
ci_007                -2.005497e-02 3 1  ON 6
ci_008                -1.836019e-02 3 1  ON 7
ci_009                -1.835635e-02 3 1  ON 8
ci_010                -1.670311e-02 3 1  ON 9
ci_011                -1.626179e-02 3 1  ON 10
ci_012                -1.640415e-02 3 1  ON 11
ci_013                -1.885360e-02 3 1  ON 12
ci_014                 1.384450e-02 3 1  ON 13
ci_015                 1.461651e-02 3 1  ON 14
ci_016                 1.625067e-02 3 1  ON 15
ci_017                 1.675408e-02 3 1  ON 16
ci_018                 1.311354e-02 3 1  ON 17
ci_019                 1.330601e-02 3 1  ON 18
ci_020                 1.383852e-02 3 1  ON 19
ci_021                 1.327597e-02 3 1  ON 20
ci_022                 1.183001e-02 3 1  ON 21
ci_023                 1.192955e-02 3 1  ON 22
ci_024                 1.106154e-02 3 1  ON 23
ci_025                 1.096425e-02 3 1  ON 24
ci_026                 1.202328e-02 3 1  ON 25
ci_027                 1.190207e-02 3 1  ON 26
ci_028                -1.417909e-02 3 1  ON 27
ci_029                -1.462410e-02 3 1  ON 28
ci_030                -1.093673e-02 3 1  ON 29
ci_031                -1.094885e-02 3 1  ON 30
ci_032                -1.397832e-02 3 1  ON 31
ci_033                 1.054583e-02 3 1  ON 32
ci_034                 1.054934e-02 3 1  ON 33
ci_035                -5.156165e-03 3 1  ON 34
ci_036                -1.076006e-02 3 1  ON 35
ci_037                -1.101675e-02 3 1  ON 36
ci_038                 1.340172e-03 3 1  ON 37
ci_039                 1.300646e-03 3 1  ON 38
ci_040                -4.234168e-03 3 1  ON 39
ci_041                 9.570780e-03 3 1  ON 40
ci_042                 9.993051e-03 3 1  ON 41
ci_043                -3.594424e-03 3 1  ON 42
ci_044                -1.507978e-02 3 1  ON 43
ci_045                -1.848823e-03 3 1  ON 44
ci_046                 5.387204e-03 3 1  ON 45
ci_047                 5.669640e-03 3 1  ON 46
ci_048                -1.197993e-02 3 1  ON 47
ci_049                -1.195767e-02 3 1  ON 48
ci_050                 7.768230e-03 3 1  ON 49
ci_051                 7.614399e-03 3 1  ON 50
ci_052                -6.902863e-03 3 1  ON 51
ci_053                -6.799291e-03 3 1  ON 52
ci_054                -2.472561e-03 3 1  ON 53
ci_055                -2.292786e-03 3 1  ON 54
ci_056                 4.813275e-03 3 1  ON 55
ci_057                 5.138683e-03 3 1  ON 56
ci_058                -7.210056e-03 3 1  ON 57
ci_059                -7.017841e-03 3 1  ON 58
ci_060                 8.608426e-03 3 1  ON 59
ci_061                 8.466650e-03 3 1  ON 60
ci_062                -2.926511e-03 3 1  ON 61
ci_063                -2.916117e-03 3 1  ON 62
ci_064                -3.510342e-03 3 1  ON 63
ci_065                -4.450564e-03 3 1  ON 64
ci_066                 5.850922e-03 3 1  ON 65
ci_067                 5.966490e-03 3 1  ON 66
ci_068                -4.577833e-03 3 1  ON 67
ci_069                -4.731897e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2303
    reference variance = 0.301855
====================================================
  Execution time = 1.4371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1076e-01
  Total weights = 1.9565e+06
  Execution time = 1.8591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295713017212
                                         uncertainty =       0.001725633438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295713017212
                                         uncertainty =       0.001725633438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384510727
  error estimate for blocks of size 2^( 2) =       0.000394499452
  error estimate for blocks of size 2^( 3) =       0.000403145173
  error estimate for blocks of size 2^( 4) =       0.000409379813
  error estimate for blocks of size 2^( 5) =       0.000413893740
  error estimate for blocks of size 2^( 6) =       0.000416414845
  error estimate for blocks of size 2^( 7) =       0.000416212260

      target function =                  N/A
              le_mean =     -17.216931074450
             les_mean =     296.733494981069
             stat err =       0.000413975165
             autocorr =       1.159128688942
              std dev =       0.543780285010
             le_variance =       0.295696998365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295731015478
                                         uncertainty =       0.001725608951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295731015478
                                         uncertainty =       0.001725608951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384522425
  error estimate for blocks of size 2^( 2) =       0.000394510119
  error estimate for blocks of size 2^( 3) =       0.000403154992
  error estimate for blocks of size 2^( 4) =       0.000409389399
  error estimate for blocks of size 2^( 5) =       0.000413902401
  error estimate for blocks of size 2^( 6) =       0.000416423959
  error estimate for blocks of size 2^( 7) =       0.000416222762

      target function =                  N/A
              le_mean =     -17.216930849240
             les_mean =     296.733446024468
             stat err =       0.000413984630
             autocorr =       1.159111164271
              std dev =       0.543796828966
             le_variance =       0.295714991194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295722116460
                                         uncertainty =       0.001725620387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295722116460
                                         uncertainty =       0.001725620387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384516641
  error estimate for blocks of size 2^( 2) =       0.000394504842
  error estimate for blocks of size 2^( 3) =       0.000403150132
  error estimate for blocks of size 2^( 4) =       0.000409384654
  error estimate for blocks of size 2^( 5) =       0.000413898107
  error estimate for blocks of size 2^( 6) =       0.000416419439
  error estimate for blocks of size 2^( 7) =       0.000416217561

      target function =                  N/A
              le_mean =     -17.216930955778
             les_mean =     296.733464182791
             stat err =       0.000413979940
             autocorr =       1.159119774147
              std dev =       0.543788649101
             le_variance =       0.295706094891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295714154862
                                         uncertainty =       0.001725631684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295714154862
                                         uncertainty =       0.001725631684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384511466
  error estimate for blocks of size 2^( 2) =       0.000394500126
  error estimate for blocks of size 2^( 3) =       0.000403145792
  error estimate for blocks of size 2^( 4) =       0.000409380418
  error estimate for blocks of size 2^( 5) =       0.000413894285
  error estimate for blocks of size 2^( 6) =       0.000416415419
  error estimate for blocks of size 2^( 7) =       0.000416212923

      target function =                  N/A
              le_mean =     -17.216931059057
             les_mean =     296.733489687079
             stat err =       0.000413975761
             autocorr =       1.159127569975
              std dev =       0.543781330754
             le_variance =       0.295698135677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216931074450        initial  <--
     1.4552e+01     1.4552e+02             2.9016e-05       -17.216930849240
     5.8208e+01     5.8208e+02             7.3912e-06       -17.216930955778
     2.3283e+02     2.3283e+03             1.8566e-06       -17.216931059057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7617
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.083616e-02 3 1  ON 0
ci_002                -3.050042e-02 3 1  ON 1
ci_003                -2.525239e-02 3 1  ON 2
ci_004                 2.152304e-02 3 1  ON 3
ci_005                 2.188014e-02 3 1  ON 4
ci_006                -1.971435e-02 3 1  ON 5
ci_007                -2.005520e-02 3 1  ON 6
ci_008                -1.835656e-02 3 1  ON 7
ci_009                -1.835621e-02 3 1  ON 8
ci_010                -1.670053e-02 3 1  ON 9
ci_011                -1.626024e-02 3 1  ON 10
ci_012                -1.640378e-02 3 1  ON 11
ci_013                -1.885167e-02 3 1  ON 12
ci_014                 1.384389e-02 3 1  ON 13
ci_015                 1.461870e-02 3 1  ON 14
ci_016                 1.625267e-02 3 1  ON 15
ci_017                 1.675531e-02 3 1  ON 16
ci_018                 1.311632e-02 3 1  ON 17
ci_019                 1.330379e-02 3 1  ON 18
ci_020                 1.383864e-02 3 1  ON 19
ci_021                 1.327692e-02 3 1  ON 20
ci_022                 1.182861e-02 3 1  ON 21
ci_023                 1.192991e-02 3 1  ON 22
ci_024                 1.106604e-02 3 1  ON 23
ci_025                 1.096488e-02 3 1  ON 24
ci_026                 1.202436e-02 3 1  ON 25
ci_027                 1.190004e-02 3 1  ON 26
ci_028                -1.417762e-02 3 1  ON 27
ci_029                -1.462500e-02 3 1  ON 28
ci_030                -1.093679e-02 3 1  ON 29
ci_031                -1.094572e-02 3 1  ON 30
ci_032                -1.397766e-02 3 1  ON 31
ci_033                 1.054551e-02 3 1  ON 32
ci_034                 1.055133e-02 3 1  ON 33
ci_035                -5.154717e-03 3 1  ON 34
ci_036                -1.075936e-02 3 1  ON 35
ci_037                -1.101866e-02 3 1  ON 36
ci_038                 1.342495e-03 3 1  ON 37
ci_039                 1.303946e-03 3 1  ON 38
ci_040                -4.233392e-03 3 1  ON 39
ci_041                 9.568491e-03 3 1  ON 40
ci_042                 9.993330e-03 3 1  ON 41
ci_043                -3.601815e-03 3 1  ON 42
ci_044                -1.507767e-02 3 1  ON 43
ci_045                -1.847899e-03 3 1  ON 44
ci_046                 5.384515e-03 3 1  ON 45
ci_047                 5.673730e-03 3 1  ON 46
ci_048                -1.198008e-02 3 1  ON 47
ci_049                -1.195561e-02 3 1  ON 48
ci_050                 7.762925e-03 3 1  ON 49
ci_051                 7.612488e-03 3 1  ON 50
ci_052                -6.903603e-03 3 1  ON 51
ci_053                -6.800325e-03 3 1  ON 52
ci_054                -2.475130e-03 3 1  ON 53
ci_055                -2.292407e-03 3 1  ON 54
ci_056                 4.811925e-03 3 1  ON 55
ci_057                 5.135588e-03 3 1  ON 56
ci_058                -7.209584e-03 3 1  ON 57
ci_059                -7.015741e-03 3 1  ON 58
ci_060                 8.610673e-03 3 1  ON 59
ci_061                 8.469342e-03 3 1  ON 60
ci_062                -2.926464e-03 3 1  ON 61
ci_063                -2.911956e-03 3 1  ON 62
ci_064                -3.510254e-03 3 1  ON 63
ci_065                -4.448283e-03 3 1  ON 64
ci_066                 5.854193e-03 3 1  ON 65
ci_067                 5.968543e-03 3 1  ON 66
ci_068                -4.576589e-03 3 1  ON 67
ci_069                -4.734197e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.324306
====================================================
  Execution time = 1.4677e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1033e-01
  Total weights = 1.956844847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297009678183
                                         uncertainty =       0.002009658461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297009678183
                                         uncertainty =       0.002009658461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385386504
  error estimate for blocks of size 2^( 2) =       0.000395668825
  error estimate for blocks of size 2^( 3) =       0.000404432851
  error estimate for blocks of size 2^( 4) =       0.000411127025
  error estimate for blocks of size 2^( 5) =       0.000413898978
  error estimate for blocks of size 2^( 6) =       0.000415878102
  error estimate for blocks of size 2^( 7) =       0.000417508519

      target function =                  N/A
              le_mean =     -17.216383653138
             les_mean =     296.714199563001
             stat err =       0.000414603156
             autocorr =       1.157369956628
              std dev =       0.545018820042
             le_variance =       0.297045514200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638365314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383653184       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383628174       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383626474       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 1.979806e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383653184       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383646922       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383646495       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 4.958021e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383653184       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383651618       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383651511       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.240038e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7228e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.083644e-02 3 1  ON 0
ci_002                -3.050027e-02 3 1  ON 1
ci_003                -2.525241e-02 3 1  ON 2
ci_004                 2.152316e-02 3 1  ON 3
ci_005                 2.187997e-02 3 1  ON 4
ci_006                -1.971416e-02 3 1  ON 5
ci_007                -2.005529e-02 3 1  ON 6
ci_008                -1.835631e-02 3 1  ON 7
ci_009                -1.835612e-02 3 1  ON 8
ci_010                -1.670064e-02 3 1  ON 9
ci_011                -1.626041e-02 3 1  ON 10
ci_012                -1.640362e-02 3 1  ON 11
ci_013                -1.885174e-02 3 1  ON 12
ci_014                 1.384396e-02 3 1  ON 13
ci_015                 1.461910e-02 3 1  ON 14
ci_016                 1.625268e-02 3 1  ON 15
ci_017                 1.675519e-02 3 1  ON 16
ci_018                 1.311634e-02 3 1  ON 17
ci_019                 1.330384e-02 3 1  ON 18
ci_020                 1.383849e-02 3 1  ON 19
ci_021                 1.327706e-02 3 1  ON 20
ci_022                 1.182850e-02 3 1  ON 21
ci_023                 1.192996e-02 3 1  ON 22
ci_024                 1.106587e-02 3 1  ON 23
ci_025                 1.096513e-02 3 1  ON 24
ci_026                 1.202433e-02 3 1  ON 25
ci_027                 1.190007e-02 3 1  ON 26
ci_028                -1.417766e-02 3 1  ON 27
ci_029                -1.462514e-02 3 1  ON 28
ci_030                -1.093655e-02 3 1  ON 29
ci_031                -1.094558e-02 3 1  ON 30
ci_032                -1.397739e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055116e-02 3 1  ON 33
ci_035                -5.154590e-03 3 1  ON 34
ci_036                -1.075939e-02 3 1  ON 35
ci_037                -1.101869e-02 3 1  ON 36
ci_038                 1.342840e-03 3 1  ON 37
ci_039                 1.303971e-03 3 1  ON 38
ci_040                -4.233607e-03 3 1  ON 39
ci_041                 9.568481e-03 3 1  ON 40
ci_042                 9.993205e-03 3 1  ON 41
ci_043                -3.601689e-03 3 1  ON 42
ci_044                -1.507764e-02 3 1  ON 43
ci_045                -1.847983e-03 3 1  ON 44
ci_046                 5.384349e-03 3 1  ON 45
ci_047                 5.673559e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195557e-02 3 1  ON 48
ci_050                 7.763420e-03 3 1  ON 49
ci_051                 7.612548e-03 3 1  ON 50
ci_052                -6.903400e-03 3 1  ON 51
ci_053                -6.800023e-03 3 1  ON 52
ci_054                -2.474931e-03 3 1  ON 53
ci_055                -2.292569e-03 3 1  ON 54
ci_056                 4.812247e-03 3 1  ON 55
ci_057                 5.135168e-03 3 1  ON 56
ci_058                -7.209462e-03 3 1  ON 57
ci_059                -7.016106e-03 3 1  ON 58
ci_060                 8.610686e-03 3 1  ON 59
ci_061                 8.469630e-03 3 1  ON 60
ci_062                -2.926757e-03 3 1  ON 61
ci_063                -2.911921e-03 3 1  ON 62
ci_064                -3.510142e-03 3 1  ON 63
ci_065                -4.448361e-03 3 1  ON 64
ci_066                 5.854269e-03 3 1  ON 65
ci_067                 5.968270e-03 3 1  ON 66
ci_068                -4.576674e-03 3 1  ON 67
ci_069                -4.734248e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1735
    reference variance = 0.363961
====================================================
  Execution time = 1.4316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1508e-01
  Total weights = 1.9570e+06
  Execution time = 1.8720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302020034386
                                         uncertainty =       0.002499412880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302020034386
                                         uncertainty =       0.002499412880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388606507
  error estimate for blocks of size 2^( 2) =       0.000398459069
  error estimate for blocks of size 2^( 3) =       0.000407085649
  error estimate for blocks of size 2^( 4) =       0.000413044485
  error estimate for blocks of size 2^( 5) =       0.000416978692
  error estimate for blocks of size 2^( 6) =       0.000419314439
  error estimate for blocks of size 2^( 7) =       0.000421767917

      target function =                  N/A
              le_mean =     -17.216667382063
             les_mean =     296.728715340611
             stat err =       0.000417776383
             autocorr =       1.155759937370
              std dev =       0.549572591924
             le_variance =       0.302030033794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302019708340
                                         uncertainty =       0.002499208485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302019708340
                                         uncertainty =       0.002499208485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388606300
  error estimate for blocks of size 2^( 2) =       0.000398458924
  error estimate for blocks of size 2^( 3) =       0.000407085558
  error estimate for blocks of size 2^( 4) =       0.000413044430
  error estimate for blocks of size 2^( 5) =       0.000416978655
  error estimate for blocks of size 2^( 6) =       0.000419314443
  error estimate for blocks of size 2^( 7) =       0.000421767883

      target function =                  N/A
              le_mean =     -17.216667370449
             les_mean =     296.728714110324
             stat err =       0.000417776353
             autocorr =       1.155760997875
              std dev =       0.549572299575
             le_variance =       0.302029712460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302019870942
                                         uncertainty =       0.002499310503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302019870942
                                         uncertainty =       0.002499310503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388606403
  error estimate for blocks of size 2^( 2) =       0.000398458996
  error estimate for blocks of size 2^( 3) =       0.000407085603
  error estimate for blocks of size 2^( 4) =       0.000413044458
  error estimate for blocks of size 2^( 5) =       0.000416978673
  error estimate for blocks of size 2^( 6) =       0.000419314441
  error estimate for blocks of size 2^( 7) =       0.000421767900

      target function =                  N/A
              le_mean =     -17.216667376225
             les_mean =     296.728714714278
             stat err =       0.000417776368
             autocorr =       1.155760468481
              std dev =       0.549572445370
             le_variance =       0.302029872710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302020013924
                                         uncertainty =       0.002499400076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302020013924
                                         uncertainty =       0.002499400076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388606494
  error estimate for blocks of size 2^( 2) =       0.000398459060
  error estimate for blocks of size 2^( 3) =       0.000407085643
  error estimate for blocks of size 2^( 4) =       0.000413044482
  error estimate for blocks of size 2^( 5) =       0.000416978689
  error estimate for blocks of size 2^( 6) =       0.000419314439
  error estimate for blocks of size 2^( 7) =       0.000421767915

      target function =                  N/A
              le_mean =     -17.216667381330
             les_mean =     296.728715261135
             stat err =       0.000417776381
             autocorr =       1.155760003794
              std dev =       0.549572573576
             le_variance =       0.302030013627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216667382063        initial  <--
     1.4552e+02     1.4552e+03             1.9798e-06       -17.216667370449
     5.8208e+02     5.8208e+03             4.9580e-07       -17.216667376225
     2.3283e+03     2.3283e+04             1.2400e-07       -17.216667381330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7375
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.083616e-02 3 1  ON 0
ci_002                -3.050042e-02 3 1  ON 1
ci_003                -2.525239e-02 3 1  ON 2
ci_004                 2.152304e-02 3 1  ON 3
ci_005                 2.188014e-02 3 1  ON 4
ci_006                -1.971435e-02 3 1  ON 5
ci_007                -2.005520e-02 3 1  ON 6
ci_008                -1.835656e-02 3 1  ON 7
ci_009                -1.835621e-02 3 1  ON 8
ci_010                -1.670053e-02 3 1  ON 9
ci_011                -1.626024e-02 3 1  ON 10
ci_012                -1.640378e-02 3 1  ON 11
ci_013                -1.885167e-02 3 1  ON 12
ci_014                 1.384389e-02 3 1  ON 13
ci_015                 1.461870e-02 3 1  ON 14
ci_016                 1.625267e-02 3 1  ON 15
ci_017                 1.675531e-02 3 1  ON 16
ci_018                 1.311632e-02 3 1  ON 17
ci_019                 1.330379e-02 3 1  ON 18
ci_020                 1.383864e-02 3 1  ON 19
ci_021                 1.327692e-02 3 1  ON 20
ci_022                 1.182861e-02 3 1  ON 21
ci_023                 1.192991e-02 3 1  ON 22
ci_024                 1.106604e-02 3 1  ON 23
ci_025                 1.096488e-02 3 1  ON 24
ci_026                 1.202436e-02 3 1  ON 25
ci_027                 1.190004e-02 3 1  ON 26
ci_028                -1.417762e-02 3 1  ON 27
ci_029                -1.462500e-02 3 1  ON 28
ci_030                -1.093679e-02 3 1  ON 29
ci_031                -1.094572e-02 3 1  ON 30
ci_032                -1.397766e-02 3 1  ON 31
ci_033                 1.054551e-02 3 1  ON 32
ci_034                 1.055133e-02 3 1  ON 33
ci_035                -5.154717e-03 3 1  ON 34
ci_036                -1.075936e-02 3 1  ON 35
ci_037                -1.101866e-02 3 1  ON 36
ci_038                 1.342495e-03 3 1  ON 37
ci_039                 1.303946e-03 3 1  ON 38
ci_040                -4.233392e-03 3 1  ON 39
ci_041                 9.568491e-03 3 1  ON 40
ci_042                 9.993330e-03 3 1  ON 41
ci_043                -3.601815e-03 3 1  ON 42
ci_044                -1.507767e-02 3 1  ON 43
ci_045                -1.847899e-03 3 1  ON 44
ci_046                 5.384515e-03 3 1  ON 45
ci_047                 5.673730e-03 3 1  ON 46
ci_048                -1.198008e-02 3 1  ON 47
ci_049                -1.195561e-02 3 1  ON 48
ci_050                 7.762925e-03 3 1  ON 49
ci_051                 7.612488e-03 3 1  ON 50
ci_052                -6.903603e-03 3 1  ON 51
ci_053                -6.800325e-03 3 1  ON 52
ci_054                -2.475130e-03 3 1  ON 53
ci_055                -2.292407e-03 3 1  ON 54
ci_056                 4.811925e-03 3 1  ON 55
ci_057                 5.135588e-03 3 1  ON 56
ci_058                -7.209584e-03 3 1  ON 57
ci_059                -7.015741e-03 3 1  ON 58
ci_060                 8.610673e-03 3 1  ON 59
ci_061                 8.469342e-03 3 1  ON 60
ci_062                -2.926464e-03 3 1  ON 61
ci_063                -2.911956e-03 3 1  ON 62
ci_064                -3.510254e-03 3 1  ON 63
ci_065                -4.448283e-03 3 1  ON 64
ci_066                 5.854193e-03 3 1  ON 65
ci_067                 5.968543e-03 3 1  ON 66
ci_068                -4.576589e-03 3 1  ON 67
ci_069                -4.734197e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2576
    reference variance = 0.282114
====================================================
  Execution time = 1.4910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1031e-01
  Total weights = 1.956864318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296280498041
                                         uncertainty =       0.002010309587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296280498041
                                         uncertainty =       0.002010309587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384879304
  error estimate for blocks of size 2^( 2) =       0.000394739304
  error estimate for blocks of size 2^( 3) =       0.000403524156
  error estimate for blocks of size 2^( 4) =       0.000410373017
  error estimate for blocks of size 2^( 5) =       0.000414950725
  error estimate for blocks of size 2^( 6) =       0.000417047793
  error estimate for blocks of size 2^( 7) =       0.000418528487

      target function =                  N/A
              le_mean =     -17.217076929156
             les_mean =     296.738045454437
             stat err =       0.000415225006
             autocorr =       1.163905930761
              std dev =       0.544301532106
             le_variance =       0.296264157853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707692916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217076929231       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217076930924       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217076930808       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217076930816       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.445463e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217076929231       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217076929654       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217076929625       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217076929625       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 6.114392e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217076929231       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217076929336       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217076929329       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217076929330       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.528644e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7481e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.083614e-02 3 1  ON 0
ci_002                -3.050047e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152302e-02 3 1  ON 3
ci_005                 2.188011e-02 3 1  ON 4
ci_006                -1.971434e-02 3 1  ON 5
ci_007                -2.005520e-02 3 1  ON 6
ci_008                -1.835657e-02 3 1  ON 7
ci_009                -1.835617e-02 3 1  ON 8
ci_010                -1.670055e-02 3 1  ON 9
ci_011                -1.626030e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885168e-02 3 1  ON 12
ci_014                 1.384392e-02 3 1  ON 13
ci_015                 1.461870e-02 3 1  ON 14
ci_016                 1.625268e-02 3 1  ON 15
ci_017                 1.675532e-02 3 1  ON 16
ci_018                 1.311633e-02 3 1  ON 17
ci_019                 1.330380e-02 3 1  ON 18
ci_020                 1.383862e-02 3 1  ON 19
ci_021                 1.327694e-02 3 1  ON 20
ci_022                 1.182864e-02 3 1  ON 21
ci_023                 1.192990e-02 3 1  ON 22
ci_024                 1.106603e-02 3 1  ON 23
ci_025                 1.096489e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190007e-02 3 1  ON 26
ci_028                -1.417760e-02 3 1  ON 27
ci_029                -1.462498e-02 3 1  ON 28
ci_030                -1.093678e-02 3 1  ON 29
ci_031                -1.094572e-02 3 1  ON 30
ci_032                -1.397762e-02 3 1  ON 31
ci_033                 1.054548e-02 3 1  ON 32
ci_034                 1.055132e-02 3 1  ON 33
ci_035                -5.154718e-03 3 1  ON 34
ci_036                -1.075937e-02 3 1  ON 35
ci_037                -1.101863e-02 3 1  ON 36
ci_038                 1.342474e-03 3 1  ON 37
ci_039                 1.303968e-03 3 1  ON 38
ci_040                -4.233386e-03 3 1  ON 39
ci_041                 9.568527e-03 3 1  ON 40
ci_042                 9.993337e-03 3 1  ON 41
ci_043                -3.601822e-03 3 1  ON 42
ci_044                -1.507764e-02 3 1  ON 43
ci_045                -1.847900e-03 3 1  ON 44
ci_046                 5.384536e-03 3 1  ON 45
ci_047                 5.673725e-03 3 1  ON 46
ci_048                -1.198007e-02 3 1  ON 47
ci_049                -1.195559e-02 3 1  ON 48
ci_050                 7.762929e-03 3 1  ON 49
ci_051                 7.612452e-03 3 1  ON 50
ci_052                -6.903582e-03 3 1  ON 51
ci_053                -6.800296e-03 3 1  ON 52
ci_054                -2.475113e-03 3 1  ON 53
ci_055                -2.292406e-03 3 1  ON 54
ci_056                 4.811959e-03 3 1  ON 55
ci_057                 5.135571e-03 3 1  ON 56
ci_058                -7.209633e-03 3 1  ON 57
ci_059                -7.015776e-03 3 1  ON 58
ci_060                 8.610660e-03 3 1  ON 59
ci_061                 8.469398e-03 3 1  ON 60
ci_062                -2.926494e-03 3 1  ON 61
ci_063                -2.911978e-03 3 1  ON 62
ci_064                -3.510250e-03 3 1  ON 63
ci_065                -4.448304e-03 3 1  ON 64
ci_066                 5.854194e-03 3 1  ON 65
ci_067                 5.968546e-03 3 1  ON 66
ci_068                -4.576591e-03 3 1  ON 67
ci_069                -4.734181e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.159215
====================================================
  Execution time = 1.4276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1856e-01
  Total weights = 1.9570e+06
  Execution time = 1.8565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579208087
                                         uncertainty =       0.002388938137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579208087
                                         uncertainty =       0.002388938137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388308253
  error estimate for blocks of size 2^( 2) =       0.000398681543
  error estimate for blocks of size 2^( 3) =       0.000407854782
  error estimate for blocks of size 2^( 4) =       0.000414726645
  error estimate for blocks of size 2^( 5) =       0.000418554853
  error estimate for blocks of size 2^( 6) =       0.000420442634
  error estimate for blocks of size 2^( 7) =       0.000417845318

      target function =                  N/A
              le_mean =     -17.216730433971
             les_mean =     296.734363145822
             stat err =       0.000417892362
             autocorr =       1.158178836672
              std dev =       0.549150798212
             le_variance =       0.301566599177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579366072
                                         uncertainty =       0.002388947313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579366072
                                         uncertainty =       0.002388947313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388308355
  error estimate for blocks of size 2^( 2) =       0.000398681640
  error estimate for blocks of size 2^( 3) =       0.000407854876
  error estimate for blocks of size 2^( 4) =       0.000414726732
  error estimate for blocks of size 2^( 5) =       0.000418554943
  error estimate for blocks of size 2^( 6) =       0.000420442724
  error estimate for blocks of size 2^( 7) =       0.000417845401

      target function =                  N/A
              le_mean =     -17.216730436928
             les_mean =     296.734363250974
             stat err =       0.000417892450
             autocorr =       1.158178715046
              std dev =       0.549150942186
             le_variance =       0.301566757304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579287086
                                         uncertainty =       0.002388942725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579287086
                                         uncertainty =       0.002388942725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388308304
  error estimate for blocks of size 2^( 2) =       0.000398681592
  error estimate for blocks of size 2^( 3) =       0.000407854829
  error estimate for blocks of size 2^( 4) =       0.000414726688
  error estimate for blocks of size 2^( 5) =       0.000418554898
  error estimate for blocks of size 2^( 6) =       0.000420442679
  error estimate for blocks of size 2^( 7) =       0.000417845359

      target function =                  N/A
              le_mean =     -17.216730435449
             les_mean =     296.734363197476
             stat err =       0.000417892406
             autocorr =       1.158178775848
              std dev =       0.549150870205
             le_variance =       0.301566678247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579217962
                                         uncertainty =       0.002388938711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301579217962
                                         uncertainty =       0.002388938711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388308260
  error estimate for blocks of size 2^( 2) =       0.000398681549
  error estimate for blocks of size 2^( 3) =       0.000407854787
  error estimate for blocks of size 2^( 4) =       0.000414726650
  error estimate for blocks of size 2^( 5) =       0.000418554858
  error estimate for blocks of size 2^( 6) =       0.000420442640
  error estimate for blocks of size 2^( 7) =       0.000417845323

      target function =                  N/A
              le_mean =     -17.216730434156
             les_mean =     296.734363152174
             stat err =       0.000417892368
             autocorr =       1.158178829067
              std dev =       0.549150807211
             le_variance =       0.301566609060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216730433971        initial
     1.4552e+03     1.4552e+04             2.4455e-07       -17.216730436928  <--
     5.8208e+03     5.8208e+04             6.1144e-08       -17.216730435449
     2.3283e+04     2.3283e+05             1.5286e-08       -17.216730434156

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 2.3650e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.083610e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525236e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.188001e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835661e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626048e-02 3 1  ON 10
ci_012                -1.640380e-02 3 1  ON 11
ci_013                -1.885172e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327697e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154722e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342409e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233367e-03 3 1  ON 39
ci_041                 9.568635e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601844e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673713e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762942e-03 3 1  ON 49
ci_051                 7.612344e-03 3 1  ON 50
ci_052                -6.903518e-03 3 1  ON 51
ci_053                -6.800207e-03 3 1  ON 52
ci_054                -2.475063e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812061e-03 3 1  ON 55
ci_057                 5.135518e-03 3 1  ON 56
ci_058                -7.209778e-03 3 1  ON 57
ci_059                -7.015882e-03 3 1  ON 58
ci_060                 8.610620e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926583e-03 3 1  ON 61
ci_063                -2.912044e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448368e-03 3 1  ON 64
ci_066                 5.854194e-03 3 1  ON 65
ci_067                 5.968555e-03 3 1  ON 66
ci_068                -4.576596e-03 3 1  ON 67
ci_069                -4.734132e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1137e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.207757
====================================================
  Execution time = 1.4790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1402e-01
  Total weights = 1.956575581e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299906283786
                                         uncertainty =       0.002182594318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299906283786
                                         uncertainty =       0.002182594318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387218078
  error estimate for blocks of size 2^( 2) =       0.000396919353
  error estimate for blocks of size 2^( 3) =       0.000406217403
  error estimate for blocks of size 2^( 4) =       0.000412206347
  error estimate for blocks of size 2^( 5) =       0.000416755061
  error estimate for blocks of size 2^( 6) =       0.000419186644
  error estimate for blocks of size 2^( 7) =       0.000419444822

      target function =                  N/A
              le_mean =     -17.216490398133
             les_mean =     296.721565069595
             stat err =       0.000416898219
             autocorr =       1.159174525378
              std dev =       0.547609058042
             le_variance =       0.299875680449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649039813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490398208       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490396744       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490395074       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490394962       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 6.989725e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490398208       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490397842       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490397424       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490397396       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.748436e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490398208       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490398116       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490398012       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490398001       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 4.371719e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7345e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.083607e-02 3 1  ON 0
ci_002                -3.050072e-02 3 1  ON 1
ci_003                -2.525244e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.187989e-02 3 1  ON 4
ci_006                -1.971434e-02 3 1  ON 5
ci_007                -2.005521e-02 3 1  ON 6
ci_008                -1.835660e-02 3 1  ON 7
ci_009                -1.835594e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626056e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885175e-02 3 1  ON 12
ci_014                 1.384405e-02 3 1  ON 13
ci_015                 1.461856e-02 3 1  ON 14
ci_016                 1.625267e-02 3 1  ON 15
ci_017                 1.675538e-02 3 1  ON 16
ci_018                 1.311640e-02 3 1  ON 17
ci_019                 1.330370e-02 3 1  ON 18
ci_020                 1.383843e-02 3 1  ON 19
ci_021                 1.327714e-02 3 1  ON 20
ci_022                 1.182884e-02 3 1  ON 21
ci_023                 1.192988e-02 3 1  ON 22
ci_024                 1.106609e-02 3 1  ON 23
ci_025                 1.096507e-02 3 1  ON 24
ci_026                 1.202445e-02 3 1  ON 25
ci_027                 1.190021e-02 3 1  ON 26
ci_028                -1.417769e-02 3 1  ON 27
ci_029                -1.462487e-02 3 1  ON 28
ci_030                -1.093685e-02 3 1  ON 29
ci_031                -1.094585e-02 3 1  ON 30
ci_032                -1.397733e-02 3 1  ON 31
ci_033                 1.054539e-02 3 1  ON 32
ci_034                 1.055119e-02 3 1  ON 33
ci_035                -5.154711e-03 3 1  ON 34
ci_036                -1.075954e-02 3 1  ON 35
ci_037                -1.101848e-02 3 1  ON 36
ci_038                 1.342407e-03 3 1  ON 37
ci_039                 1.304121e-03 3 1  ON 38
ci_040                -4.233283e-03 3 1  ON 39
ci_041                 9.568562e-03 3 1  ON 40
ci_042                 9.993304e-03 3 1  ON 41
ci_043                -3.601714e-03 3 1  ON 42
ci_044                -1.507745e-02 3 1  ON 43
ci_045                -1.847820e-03 3 1  ON 44
ci_046                 5.384731e-03 3 1  ON 45
ci_047                 5.673562e-03 3 1  ON 46
ci_048                -1.198003e-02 3 1  ON 47
ci_049                -1.195554e-02 3 1  ON 48
ci_050                 7.763076e-03 3 1  ON 49
ci_051                 7.612429e-03 3 1  ON 50
ci_052                -6.903601e-03 3 1  ON 51
ci_053                -6.800282e-03 3 1  ON 52
ci_054                -2.475188e-03 3 1  ON 53
ci_055                -2.292382e-03 3 1  ON 54
ci_056                 4.812133e-03 3 1  ON 55
ci_057                 5.135494e-03 3 1  ON 56
ci_058                -7.209807e-03 3 1  ON 57
ci_059                -7.015932e-03 3 1  ON 58
ci_060                 8.610637e-03 3 1  ON 59
ci_061                 8.469648e-03 3 1  ON 60
ci_062                -2.926733e-03 3 1  ON 61
ci_063                -2.911968e-03 3 1  ON 62
ci_064                -3.510137e-03 3 1  ON 63
ci_065                -4.448389e-03 3 1  ON 64
ci_066                 5.854297e-03 3 1  ON 65
ci_067                 5.968719e-03 3 1  ON 66
ci_068                -4.576570e-03 3 1  ON 67
ci_069                -4.734106e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1704
    reference variance = 0.255747
====================================================
  Execution time = 1.4580e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1291e-01
  Total weights = 1.9568e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325818075
                                         uncertainty =       0.001862215893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325818075
                                         uncertainty =       0.001862215893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386185364
  error estimate for blocks of size 2^( 2) =       0.000395834475
  error estimate for blocks of size 2^( 3) =       0.000404937406
  error estimate for blocks of size 2^( 4) =       0.000411179117
  error estimate for blocks of size 2^( 5) =       0.000414942727
  error estimate for blocks of size 2^( 6) =       0.000416503631
  error estimate for blocks of size 2^( 7) =       0.000418461817

      target function =                  N/A
              le_mean =     -17.216301463147
             les_mean =     296.713951179573
             stat err =       0.000415271823
             autocorr =       1.156307411339
              std dev =       0.546148579043
             le_variance =       0.298278270391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298326167446
                                         uncertainty =       0.001862221684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298326167446
                                         uncertainty =       0.001862221684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386185589
  error estimate for blocks of size 2^( 2) =       0.000395834701
  error estimate for blocks of size 2^( 3) =       0.000404937635
  error estimate for blocks of size 2^( 4) =       0.000411179339
  error estimate for blocks of size 2^( 5) =       0.000414942960
  error estimate for blocks of size 2^( 6) =       0.000416503852
  error estimate for blocks of size 2^( 7) =       0.000418462003

      target function =                  N/A
              le_mean =     -17.216301461459
             les_mean =     296.713948138649
             stat err =       0.000415272039
             autocorr =       1.156307258982
              std dev =       0.546148897981
             le_variance =       0.298278618766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325992836
                                         uncertainty =       0.001862218789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325992836
                                         uncertainty =       0.001862218789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386185477
  error estimate for blocks of size 2^( 2) =       0.000395834588
  error estimate for blocks of size 2^( 3) =       0.000404937521
  error estimate for blocks of size 2^( 4) =       0.000411179228
  error estimate for blocks of size 2^( 5) =       0.000414942844
  error estimate for blocks of size 2^( 6) =       0.000416503742
  error estimate for blocks of size 2^( 7) =       0.000418461910

      target function =                  N/A
              le_mean =     -17.216301462297
             les_mean =     296.713949635409
             stat err =       0.000415271931
             autocorr =       1.156307335100
              std dev =       0.546148738581
             le_variance =       0.298278444653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325839919
                                         uncertainty =       0.001862216255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298325839919
                                         uncertainty =       0.001862216255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386185378
  error estimate for blocks of size 2^( 2) =       0.000395834489
  error estimate for blocks of size 2^( 3) =       0.000404937420
  error estimate for blocks of size 2^( 4) =       0.000411179131
  error estimate for blocks of size 2^( 5) =       0.000414942742
  error estimate for blocks of size 2^( 6) =       0.000416503645
  error estimate for blocks of size 2^( 7) =       0.000418461829

      target function =                  N/A
              le_mean =     -17.216301463040
             les_mean =     296.713950983959
             stat err =       0.000415271837
             autocorr =       1.156307401803
              std dev =       0.546148598984
             le_variance =       0.298278292172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216301463147        initial  <--
     3.6380e+02     3.6380e+03             6.9897e-07       -17.216301461459
     1.4552e+03     1.4552e+04             1.7484e-07       -17.216301462297
     5.8208e+03     5.8208e+04             4.3717e-08       -17.216301463040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9679
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.083610e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525236e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.188001e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835661e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626048e-02 3 1  ON 10
ci_012                -1.640380e-02 3 1  ON 11
ci_013                -1.885172e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327697e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154722e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342409e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233367e-03 3 1  ON 39
ci_041                 9.568635e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601844e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673713e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762942e-03 3 1  ON 49
ci_051                 7.612344e-03 3 1  ON 50
ci_052                -6.903518e-03 3 1  ON 51
ci_053                -6.800207e-03 3 1  ON 52
ci_054                -2.475063e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812061e-03 3 1  ON 55
ci_057                 5.135518e-03 3 1  ON 56
ci_058                -7.209778e-03 3 1  ON 57
ci_059                -7.015882e-03 3 1  ON 58
ci_060                 8.610620e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926583e-03 3 1  ON 61
ci_063                -2.912044e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448368e-03 3 1  ON 64
ci_066                 5.854194e-03 3 1  ON 65
ci_067                 5.968555e-03 3 1  ON 66
ci_068                -4.576596e-03 3 1  ON 67
ci_069                -4.734132e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.229386
====================================================
  Execution time = 1.5239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1612e-01
  Total weights = 1.956975077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300065941538
                                         uncertainty =       0.002233189738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300065941538
                                         uncertainty =       0.002233189738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387295156
  error estimate for blocks of size 2^( 2) =       0.000397378065
  error estimate for blocks of size 2^( 3) =       0.000406396389
  error estimate for blocks of size 2^( 4) =       0.000412579605
  error estimate for blocks of size 2^( 5) =       0.000417026971
  error estimate for blocks of size 2^( 6) =       0.000419986436
  error estimate for blocks of size 2^( 7) =       0.000419836324

      target function =                  N/A
              le_mean =     -17.216298310905
             les_mean =     296.717051357979
             stat err =       0.000417357334
             autocorr =       1.161266692097
              std dev =       0.547718061741
             le_variance =       0.299995075158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629831090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298310975       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298310702       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298310608       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216298310628       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 9.499667e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298310975       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298310907       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298310883       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216298310888       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.375038e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298310975       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298310958       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298310952       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216298310953       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 5.937672e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7813e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.083611e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525237e-02 3 1  ON 2
ci_004                 2.152297e-02 3 1  ON 3
ci_005                 2.187999e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835660e-02 3 1  ON 7
ci_009                -1.835606e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626050e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885174e-02 3 1  ON 12
ci_014                 1.384400e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675532e-02 3 1  ON 16
ci_018                 1.311637e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383859e-02 3 1  ON 19
ci_021                 1.327697e-02 3 1  ON 20
ci_022                 1.182876e-02 3 1  ON 21
ci_023                 1.192990e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417757e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094573e-02 3 1  ON 30
ci_032                -1.397751e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055130e-02 3 1  ON 33
ci_035                -5.154725e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342410e-03 3 1  ON 37
ci_039                 1.304048e-03 3 1  ON 38
ci_040                -4.233361e-03 3 1  ON 39
ci_041                 9.568651e-03 3 1  ON 40
ci_042                 9.993361e-03 3 1  ON 41
ci_043                -3.601845e-03 3 1  ON 42
ci_044                -1.507756e-02 3 1  ON 43
ci_045                -1.847920e-03 3 1  ON 44
ci_046                 5.384596e-03 3 1  ON 45
ci_047                 5.673708e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195552e-02 3 1  ON 48
ci_050                 7.762934e-03 3 1  ON 49
ci_051                 7.612346e-03 3 1  ON 50
ci_052                -6.903505e-03 3 1  ON 51
ci_053                -6.800211e-03 3 1  ON 52
ci_054                -2.475069e-03 3 1  ON 53
ci_055                -2.292408e-03 3 1  ON 54
ci_056                 4.812058e-03 3 1  ON 55
ci_057                 5.135509e-03 3 1  ON 56
ci_058                -7.209773e-03 3 1  ON 57
ci_059                -7.015871e-03 3 1  ON 58
ci_060                 8.610607e-03 3 1  ON 59
ci_061                 8.469557e-03 3 1  ON 60
ci_062                -2.926589e-03 3 1  ON 61
ci_063                -2.912041e-03 3 1  ON 62
ci_064                -3.510223e-03 3 1  ON 63
ci_065                -4.448358e-03 3 1  ON 64
ci_066                 5.854211e-03 3 1  ON 65
ci_067                 5.968556e-03 3 1  ON 66
ci_068                -4.576595e-03 3 1  ON 67
ci_069                -4.734127e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1828
    reference variance = 0.289939
====================================================
  Execution time = 1.6508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1291e-01
  Total weights = 1.9570e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640044405
                                         uncertainty =       0.002202210112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640044405
                                         uncertainty =       0.002202210112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386373222
  error estimate for blocks of size 2^( 2) =       0.000396520817
  error estimate for blocks of size 2^( 3) =       0.000405047140
  error estimate for blocks of size 2^( 4) =       0.000411336603
  error estimate for blocks of size 2^( 5) =       0.000415244304
  error estimate for blocks of size 2^( 6) =       0.000417942258
  error estimate for blocks of size 2^( 7) =       0.000418428748

      target function =                  N/A
              le_mean =     -17.216257144305
             les_mean =     296.712423434492
             stat err =       0.000415737978
             autocorr =       1.157778181650
              std dev =       0.546414250334
             le_variance =       0.298568532968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298639985305
                                         uncertainty =       0.002202208736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298639985305
                                         uncertainty =       0.002202208736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386373184
  error estimate for blocks of size 2^( 2) =       0.000396520782
  error estimate for blocks of size 2^( 3) =       0.000405047107
  error estimate for blocks of size 2^( 4) =       0.000411336570
  error estimate for blocks of size 2^( 5) =       0.000415244270
  error estimate for blocks of size 2^( 6) =       0.000417942228
  error estimate for blocks of size 2^( 7) =       0.000418428718

      target function =                  N/A
              le_mean =     -17.216257143906
             les_mean =     296.712423288438
             stat err =       0.000415737947
             autocorr =       1.157778234345
              std dev =       0.546414196350
             le_variance =       0.298568473973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640014853
                                         uncertainty =       0.002202209424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640014853
                                         uncertainty =       0.002202209424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386373203
  error estimate for blocks of size 2^( 2) =       0.000396520800
  error estimate for blocks of size 2^( 3) =       0.000405047123
  error estimate for blocks of size 2^( 4) =       0.000411336587
  error estimate for blocks of size 2^( 5) =       0.000415244287
  error estimate for blocks of size 2^( 6) =       0.000417942243
  error estimate for blocks of size 2^( 7) =       0.000418428733

      target function =                  N/A
              le_mean =     -17.216257144105
             les_mean =     296.712423361443
             stat err =       0.000415737962
             autocorr =       1.157778207994
              std dev =       0.546414223340
             le_variance =       0.298568503468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640040711
                                         uncertainty =       0.002202210026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298640040711
                                         uncertainty =       0.002202210026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386373219
  error estimate for blocks of size 2^( 2) =       0.000396520815
  error estimate for blocks of size 2^( 3) =       0.000405047138
  error estimate for blocks of size 2^( 4) =       0.000411336601
  error estimate for blocks of size 2^( 5) =       0.000415244301
  error estimate for blocks of size 2^( 6) =       0.000417942256
  error estimate for blocks of size 2^( 7) =       0.000418428746

      target function =                  N/A
              le_mean =     -17.216257144280
             les_mean =     296.712423425359
             stat err =       0.000415737976
             autocorr =       1.157778184938
              std dev =       0.546414246959
             le_variance =       0.298568529280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216257144305        initial  <--
     3.6380e+03     3.6380e+04             9.4997e-08       -17.216257143906
     1.4552e+04     1.4552e+05             2.3750e-08       -17.216257144105
     5.8208e+04     5.8208e+05             5.9377e-09       -17.216257144280

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.9328
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.083610e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525236e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.188001e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835661e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626048e-02 3 1  ON 10
ci_012                -1.640380e-02 3 1  ON 11
ci_013                -1.885172e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327697e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154722e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342409e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233367e-03 3 1  ON 39
ci_041                 9.568635e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601844e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673713e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762942e-03 3 1  ON 49
ci_051                 7.612344e-03 3 1  ON 50
ci_052                -6.903518e-03 3 1  ON 51
ci_053                -6.800207e-03 3 1  ON 52
ci_054                -2.475063e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812061e-03 3 1  ON 55
ci_057                 5.135518e-03 3 1  ON 56
ci_058                -7.209778e-03 3 1  ON 57
ci_059                -7.015882e-03 3 1  ON 58
ci_060                 8.610620e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926583e-03 3 1  ON 61
ci_063                -2.912044e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448368e-03 3 1  ON 64
ci_066                 5.854194e-03 3 1  ON 65
ci_067                 5.968555e-03 3 1  ON 66
ci_068                -4.576596e-03 3 1  ON 67
ci_069                -4.734132e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.203975
====================================================
  Execution time = 1.5040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.0828e-01
  Total weights = 1.956612614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294918324887
                                         uncertainty =       0.001626660464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294918324887
                                         uncertainty =       0.001626660464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384005803
  error estimate for blocks of size 2^( 2) =       0.000394126871
  error estimate for blocks of size 2^( 3) =       0.000403509475
  error estimate for blocks of size 2^( 4) =       0.000410150091
  error estimate for blocks of size 2^( 5) =       0.000414008423
  error estimate for blocks of size 2^( 6) =       0.000417755696
  error estimate for blocks of size 2^( 7) =       0.000418604948

      target function =                  N/A
              le_mean =     -17.217681546565
             les_mean =     296.756836960380
             stat err =       0.000415129789
             autocorr =       1.168670879640
              std dev =       0.543066215161
             le_variance =       0.294920914049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721768154657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217681546648       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217681546701       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217681546705       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217681546707       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 1.477547e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217681546648       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217681546661       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217681546662       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217681546665       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 3.693880e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217681546648       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217681546651       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217681546652       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217681546652       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 9.234707e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7607e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.083610e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525237e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.188001e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835661e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640380e-02 3 1  ON 11
ci_013                -1.885172e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327697e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154722e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342408e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233369e-03 3 1  ON 39
ci_041                 9.568634e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601845e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673710e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762942e-03 3 1  ON 49
ci_051                 7.612343e-03 3 1  ON 50
ci_052                -6.903517e-03 3 1  ON 51
ci_053                -6.800207e-03 3 1  ON 52
ci_054                -2.475063e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812060e-03 3 1  ON 55
ci_057                 5.135519e-03 3 1  ON 56
ci_058                -7.209780e-03 3 1  ON 57
ci_059                -7.015883e-03 3 1  ON 58
ci_060                 8.610617e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926582e-03 3 1  ON 61
ci_063                -2.912044e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448368e-03 3 1  ON 64
ci_066                 5.854195e-03 3 1  ON 65
ci_067                 5.968554e-03 3 1  ON 66
ci_068                -4.576597e-03 3 1  ON 67
ci_069                -4.734133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.290773
====================================================
  Execution time = 1.4422e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1384e-01
  Total weights = 1.9564e+06
  Execution time = 1.8601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393535912
                                         uncertainty =       0.002484008657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393535912
                                         uncertainty =       0.002484008657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386878757
  error estimate for blocks of size 2^( 2) =       0.000396550843
  error estimate for blocks of size 2^( 3) =       0.000405835149
  error estimate for blocks of size 2^( 4) =       0.000412135426
  error estimate for blocks of size 2^( 5) =       0.000415156262
  error estimate for blocks of size 2^( 6) =       0.000416895755
  error estimate for blocks of size 2^( 7) =       0.000418998937

      target function =                  N/A
              le_mean =     -17.216932413040
             les_mean =     296.736604419505
             stat err =       0.000415796595
             autocorr =       1.155080063634
              std dev =       0.547129185729
             le_variance =       0.299350345877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393543977
                                         uncertainty =       0.002484009122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393543977
                                         uncertainty =       0.002484009122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386878763
  error estimate for blocks of size 2^( 2) =       0.000396550848
  error estimate for blocks of size 2^( 3) =       0.000405835154
  error estimate for blocks of size 2^( 4) =       0.000412135430
  error estimate for blocks of size 2^( 5) =       0.000415156266
  error estimate for blocks of size 2^( 6) =       0.000416895759
  error estimate for blocks of size 2^( 7) =       0.000418998942

      target function =                  N/A
              le_mean =     -17.216932413175
             les_mean =     296.736604432230
             stat err =       0.000415796599
             autocorr =       1.155080057056
              std dev =       0.547129193065
             le_variance =       0.299350353903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393539945
                                         uncertainty =       0.002484008890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393539945
                                         uncertainty =       0.002484008890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386878760
  error estimate for blocks of size 2^( 2) =       0.000396550845
  error estimate for blocks of size 2^( 3) =       0.000405835152
  error estimate for blocks of size 2^( 4) =       0.000412135428
  error estimate for blocks of size 2^( 5) =       0.000415156264
  error estimate for blocks of size 2^( 6) =       0.000416895757
  error estimate for blocks of size 2^( 7) =       0.000418998939

      target function =                  N/A
              le_mean =     -17.216932413108
             les_mean =     296.736604425868
             stat err =       0.000415796597
             autocorr =       1.155080060348
              std dev =       0.547129189397
             le_variance =       0.299350349890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393536416
                                         uncertainty =       0.002484008686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299393536416
                                         uncertainty =       0.002484008686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386878758
  error estimate for blocks of size 2^( 2) =       0.000396550843
  error estimate for blocks of size 2^( 3) =       0.000405835150
  error estimate for blocks of size 2^( 4) =       0.000412135426
  error estimate for blocks of size 2^( 5) =       0.000415156262
  error estimate for blocks of size 2^( 6) =       0.000416895756
  error estimate for blocks of size 2^( 7) =       0.000418998937

      target function =                  N/A
              le_mean =     -17.216932413049
             les_mean =     296.736604420300
             stat err =       0.000415796595
             autocorr =       1.155080063225
              std dev =       0.547129186187
             le_variance =       0.299350346378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216932413040        initial
     3.6380e+04     3.6380e+05             1.4775e-08       -17.216932413175  <--
     1.4552e+05     1.4552e+06             3.6939e-09       -17.216932413108
     5.8208e+05     5.8208e+06             9.2347e-10       -17.216932413049

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 2.3801e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292401e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912045e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.21417
====================================================
  Execution time = 1.4844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1639e-01
  Total weights = 1.956516964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299756489515
                                         uncertainty =       0.003635218573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299756489515
                                         uncertainty =       0.003635218573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387119227
  error estimate for blocks of size 2^( 2) =       0.000396998788
  error estimate for blocks of size 2^( 3) =       0.000405994208
  error estimate for blocks of size 2^( 4) =       0.000412605097
  error estimate for blocks of size 2^( 5) =       0.000416212863
  error estimate for blocks of size 2^( 6) =       0.000418462598
  error estimate for blocks of size 2^( 7) =       0.000419113239

      target function =                  N/A
              le_mean =     -17.216527650312
             les_mean =     296.725212235271
             stat err =       0.000416598449
             autocorr =       1.158099341072
              std dev =       0.547469260527
             le_variance =       0.299722591222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652765031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216527650372       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216527650496       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216527650503       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216527650501       residual = 4.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 3.562136e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216527650372       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216527650403       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216527650405       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216527650404       residual = 4.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 8.905455e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216527650372       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216527650380       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216527650380       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216527650281       residual = 4.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 2.226371e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7395e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525237e-02 3 1  ON 2
ci_004                 2.152296e-02 3 1  ON 3
ci_005                 2.188001e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885174e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330383e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327699e-02 3 1  ON 20
ci_022                 1.182872e-02 3 1  ON 21
ci_023                 1.192988e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096494e-02 3 1  ON 24
ci_026                 1.202436e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093678e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154723e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304033e-03 3 1  ON 38
ci_040                -4.233374e-03 3 1  ON 39
ci_041                 9.568633e-03 3 1  ON 40
ci_042                 9.993364e-03 3 1  ON 41
ci_043                -3.601847e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847902e-03 3 1  ON 44
ci_046                 5.384602e-03 3 1  ON 45
ci_047                 5.673702e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195552e-02 3 1  ON 48
ci_050                 7.762935e-03 3 1  ON 49
ci_051                 7.612345e-03 3 1  ON 50
ci_052                -6.903518e-03 3 1  ON 51
ci_053                -6.800212e-03 3 1  ON 52
ci_054                -2.475061e-03 3 1  ON 53
ci_055                -2.292406e-03 3 1  ON 54
ci_056                 4.812059e-03 3 1  ON 55
ci_057                 5.135526e-03 3 1  ON 56
ci_058                -7.209789e-03 3 1  ON 57
ci_059                -7.015893e-03 3 1  ON 58
ci_060                 8.610608e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926582e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510236e-03 3 1  ON 63
ci_065                -4.448363e-03 3 1  ON 64
ci_066                 5.854203e-03 3 1  ON 65
ci_067                 5.968556e-03 3 1  ON 66
ci_068                -4.576600e-03 3 1  ON 67
ci_069                -4.734138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.195
    reference variance = 0.12279
====================================================
  Execution time = 1.4514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1066e-01
  Total weights = 1.9570e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917496043
                                         uncertainty =       0.002520550992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917496043
                                         uncertainty =       0.002520550992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386631088
  error estimate for blocks of size 2^( 2) =       0.000396688083
  error estimate for blocks of size 2^( 3) =       0.000405684330
  error estimate for blocks of size 2^( 4) =       0.000412152749
  error estimate for blocks of size 2^( 5) =       0.000416087565
  error estimate for blocks of size 2^( 6) =       0.000417181776
  error estimate for blocks of size 2^( 7) =       0.000418173071

      target function =                  N/A
              le_mean =     -17.217053094566
             les_mean =     296.737575165145
             stat err =       0.000415898790
             autocorr =       1.157128984708
              std dev =       0.546778927590
             le_variance =       0.298967195656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917502566
                                         uncertainty =       0.002520552529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917502566
                                         uncertainty =       0.002520552529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386631092
  error estimate for blocks of size 2^( 2) =       0.000396688087
  error estimate for blocks of size 2^( 3) =       0.000405684334
  error estimate for blocks of size 2^( 4) =       0.000412152753
  error estimate for blocks of size 2^( 5) =       0.000416087569
  error estimate for blocks of size 2^( 6) =       0.000417181780
  error estimate for blocks of size 2^( 7) =       0.000418173076

      target function =                  N/A
              le_mean =     -17.217053094469
             les_mean =     296.737575217060
             stat err =       0.000415898794
             autocorr =       1.157128982660
              std dev =       0.546778933504
             le_variance =       0.298967202124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917499304
                                         uncertainty =       0.002520551760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917499304
                                         uncertainty =       0.002520551760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386631090
  error estimate for blocks of size 2^( 2) =       0.000396688085
  error estimate for blocks of size 2^( 3) =       0.000405684332
  error estimate for blocks of size 2^( 4) =       0.000412152751
  error estimate for blocks of size 2^( 5) =       0.000416087567
  error estimate for blocks of size 2^( 6) =       0.000417181778
  error estimate for blocks of size 2^( 7) =       0.000418173073

      target function =                  N/A
              le_mean =     -17.217053094518
             les_mean =     296.737575191065
             stat err =       0.000415898792
             autocorr =       1.157128983686
              std dev =       0.546778930547
             le_variance =       0.298967198890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917496450
                                         uncertainty =       0.002520551088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917496450
                                         uncertainty =       0.002520551088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386631088
  error estimate for blocks of size 2^( 2) =       0.000396688083
  error estimate for blocks of size 2^( 3) =       0.000405684331
  error estimate for blocks of size 2^( 4) =       0.000412152750
  error estimate for blocks of size 2^( 5) =       0.000416087565
  error estimate for blocks of size 2^( 6) =       0.000417181777
  error estimate for blocks of size 2^( 7) =       0.000418173071

      target function =                  N/A
              le_mean =     -17.217053094560
             les_mean =     296.737575168381
             stat err =       0.000415898791
             autocorr =       1.157128984578
              std dev =       0.546778927960
             le_variance =       0.298967196061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217053094566        initial  <--
     9.0949e+03     9.0949e+04             3.5621e-08       -17.217053094469
     3.6380e+04     3.6380e+05             8.9055e-09       -17.217053094518
     1.4552e+05     1.4552e+06             2.2264e-09       -17.217053094560

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0531
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292401e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912045e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1605
    reference variance = 0.872212
====================================================
  Execution time = 1.4696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1188e-01
  Total weights = 1.956653212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298535975856
                                         uncertainty =       0.002249355600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298535975856
                                         uncertainty =       0.002249355600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386345203
  error estimate for blocks of size 2^( 2) =       0.000396517895
  error estimate for blocks of size 2^( 3) =       0.000405578291
  error estimate for blocks of size 2^( 4) =       0.000412190599
  error estimate for blocks of size 2^( 5) =       0.000416632189
  error estimate for blocks of size 2^( 6) =       0.000419456546
  error estimate for blocks of size 2^( 7) =       0.000421019499

      target function =                  N/A
              le_mean =     -17.216292232232
             les_mean =     296.712599022909
             stat err =       0.000417324708
             autocorr =       1.166801954129
              std dev =       0.546374626127
             le_variance =       0.298525232076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629223223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292232304       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292232263       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216292232263       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292232263       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+04 is 3.879054e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292232304       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292232293       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216292232293       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292232352       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 9.697660e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216292232304       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216292232301       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216292232301       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216292232301       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 2.424417e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7258e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384600e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800207e-03 3 1  ON 52
ci_054                -2.475063e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912045e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448372e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968551e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2977
    reference variance = 0.256119
====================================================
  Execution time = 1.4523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1249e-01
  Total weights = 1.9567e+06
  Execution time = 1.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665306117
                                         uncertainty =       0.002800271499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665306117
                                         uncertainty =       0.002800271499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387042679
  error estimate for blocks of size 2^( 2) =       0.000396879465
  error estimate for blocks of size 2^( 3) =       0.000405535714
  error estimate for blocks of size 2^( 4) =       0.000411443625
  error estimate for blocks of size 2^( 5) =       0.000415931742
  error estimate for blocks of size 2^( 6) =       0.000416970668
  error estimate for blocks of size 2^( 7) =       0.000419023193

      target function =                  N/A
              le_mean =     -17.216209666202
             les_mean =     296.710370088845
             stat err =       0.000415842307
             autocorr =       1.154355639710
              std dev =       0.547361005722
             le_variance =       0.299604070585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665310047
                                         uncertainty =       0.002800271708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665310047
                                         uncertainty =       0.002800271708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387042681
  error estimate for blocks of size 2^( 2) =       0.000396879467
  error estimate for blocks of size 2^( 3) =       0.000405535716
  error estimate for blocks of size 2^( 4) =       0.000411443627
  error estimate for blocks of size 2^( 5) =       0.000415931744
  error estimate for blocks of size 2^( 6) =       0.000416970670
  error estimate for blocks of size 2^( 7) =       0.000419023196

      target function =                  N/A
              le_mean =     -17.216209666173
             les_mean =     296.710370088400
             stat err =       0.000415842309
             autocorr =       1.154355636061
              std dev =       0.547361009311
             le_variance =       0.299604074514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665308082
                                         uncertainty =       0.002800271603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665308082
                                         uncertainty =       0.002800271603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387042680
  error estimate for blocks of size 2^( 2) =       0.000396879466
  error estimate for blocks of size 2^( 3) =       0.000405535715
  error estimate for blocks of size 2^( 4) =       0.000411443626
  error estimate for blocks of size 2^( 5) =       0.000415931743
  error estimate for blocks of size 2^( 6) =       0.000416970669
  error estimate for blocks of size 2^( 7) =       0.000419023195

      target function =                  N/A
              le_mean =     -17.216209666188
             les_mean =     296.710370088622
             stat err =       0.000415842308
             autocorr =       1.154355637885
              std dev =       0.547361007517
             le_variance =       0.299604072550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665306362
                                         uncertainty =       0.002800271512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299665306362
                                         uncertainty =       0.002800271512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387042679
  error estimate for blocks of size 2^( 2) =       0.000396879465
  error estimate for blocks of size 2^( 3) =       0.000405535714
  error estimate for blocks of size 2^( 4) =       0.000411443625
  error estimate for blocks of size 2^( 5) =       0.000415931742
  error estimate for blocks of size 2^( 6) =       0.000416970668
  error estimate for blocks of size 2^( 7) =       0.000419023194

      target function =                  N/A
              le_mean =     -17.216209666200
             les_mean =     296.710370088817
             stat err =       0.000415842307
             autocorr =       1.154355639468
              std dev =       0.547361005946
             le_variance =       0.299604070831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216209666202        initial  <--
     9.0949e+04     9.0949e+05             3.8791e-09       -17.216209666173
     3.6380e+05     3.6380e+06             9.6977e-10       -17.216209666188
     1.4552e+06     1.4552e+07             2.4244e-10       -17.216209666200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9418
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292401e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912045e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.168137
====================================================
  Execution time = 1.4653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0869e-01
  Total weights = 1.956630678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295816326616
                                         uncertainty =       0.001720712482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295816326616
                                         uncertainty =       0.001720712482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384630924
  error estimate for blocks of size 2^( 2) =       0.000394380688
  error estimate for blocks of size 2^( 3) =       0.000403160404
  error estimate for blocks of size 2^( 4) =       0.000409170773
  error estimate for blocks of size 2^( 5) =       0.000413206320
  error estimate for blocks of size 2^( 6) =       0.000415810009
  error estimate for blocks of size 2^( 7) =       0.000414715639

      target function =                  N/A
              le_mean =     -17.216114470439
             les_mean =     296.703286434702
             stat err =       0.000413225685
             autocorr =       1.154213689174
              std dev =       0.543950268845
             le_variance =       0.295881894977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611447044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114470478       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114470480       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114470480       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 3.326288e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114470478       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114470479       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114470479       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 8.315721e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114470478       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114470478       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216114470478       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 2.078931e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7197e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292401e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912045e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2749
    reference variance = 0.690368
====================================================
  Execution time = 1.4684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1039e-01
  Total weights = 1.9568e+06
  Execution time = 1.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079881
                                         uncertainty =       0.002299458136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079881
                                         uncertainty =       0.002299458136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386843528
  error estimate for blocks of size 2^( 2) =       0.000396758081
  error estimate for blocks of size 2^( 3) =       0.000405833108
  error estimate for blocks of size 2^( 4) =       0.000411986584
  error estimate for blocks of size 2^( 5) =       0.000416058493
  error estimate for blocks of size 2^( 6) =       0.000419513710
  error estimate for blocks of size 2^( 7) =       0.000421138420

      target function =                  N/A
              le_mean =     -17.215756155899
             les_mean =     296.692651229826
             stat err =       0.000417174302
             autocorr =       1.162959055694
              std dev =       0.547079364026
             le_variance =       0.299295830543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079949
                                         uncertainty =       0.002299458139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079949
                                         uncertainty =       0.002299458139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386843528
  error estimate for blocks of size 2^( 2) =       0.000396758081
  error estimate for blocks of size 2^( 3) =       0.000405833108
  error estimate for blocks of size 2^( 4) =       0.000411986584
  error estimate for blocks of size 2^( 5) =       0.000416058493
  error estimate for blocks of size 2^( 6) =       0.000419513710
  error estimate for blocks of size 2^( 7) =       0.000421138420

      target function =                  N/A
              le_mean =     -17.215756155899
             les_mean =     296.692651229522
             stat err =       0.000417174302
             autocorr =       1.162959055648
              std dev =       0.547079364087
             le_variance =       0.299295830610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079915
                                         uncertainty =       0.002299458137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079915
                                         uncertainty =       0.002299458137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386843528
  error estimate for blocks of size 2^( 2) =       0.000396758081
  error estimate for blocks of size 2^( 3) =       0.000405833108
  error estimate for blocks of size 2^( 4) =       0.000411986584
  error estimate for blocks of size 2^( 5) =       0.000416058493
  error estimate for blocks of size 2^( 6) =       0.000419513710
  error estimate for blocks of size 2^( 7) =       0.000421138420

      target function =                  N/A
              le_mean =     -17.215756155899
             les_mean =     296.692651229674
             stat err =       0.000417174302
             autocorr =       1.162959055669
              std dev =       0.547079364057
             le_variance =       0.299295830577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079886
                                         uncertainty =       0.002299458136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299205079886
                                         uncertainty =       0.002299458136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386843528
  error estimate for blocks of size 2^( 2) =       0.000396758081
  error estimate for blocks of size 2^( 3) =       0.000405833108
  error estimate for blocks of size 2^( 4) =       0.000411986584
  error estimate for blocks of size 2^( 5) =       0.000416058493
  error estimate for blocks of size 2^( 6) =       0.000419513710
  error estimate for blocks of size 2^( 7) =       0.000421138420

      target function =                  N/A
              le_mean =     -17.215756155899
             les_mean =     296.692651229807
             stat err =       0.000417174302
             autocorr =       1.162959055687
              std dev =       0.547079364030
             le_variance =       0.299295830547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215756155899        initial
     9.0949e+05     9.0949e+06             3.3263e-10       -17.215756155899  <--
     3.6380e+06     3.6380e+07             8.3157e-11       -17.215756155899
     1.4552e+07     1.4552e+08             2.0789e-11       -17.215756155899

*****************************************************************************
Applying the update for shift_i =   9.0949e+05     and shift_s =   9.0949e+06
*****************************************************************************

  Execution time = 2.4133e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.162419
====================================================
  Execution time = 1.4670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0617e-01
  Total weights = 1.956694026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293721295968
                                         uncertainty =       0.001852715544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293721295968
                                         uncertainty =       0.001852715544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383203559
  error estimate for blocks of size 2^( 2) =       0.000393034547
  error estimate for blocks of size 2^( 3) =       0.000401802957
  error estimate for blocks of size 2^( 4) =       0.000407793206
  error estimate for blocks of size 2^( 5) =       0.000412987868
  error estimate for blocks of size 2^( 6) =       0.000415939928
  error estimate for blocks of size 2^( 7) =       0.000416241315

      target function =                  N/A
              le_mean =     -17.216326918460
             les_mean =     296.708078741034
             stat err =       0.000413240579
             autocorr =       1.162912005991
              std dev =       0.541931670875
             le_variance =       0.293689935897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632691846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326918493       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326918506       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326918506       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216326918506       residual = 2.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 1.410223e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326918493       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326918496       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326918497       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216326918508       residual = 2.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 3.525560e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326918493       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326918494       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216326918494       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216326918465       residual = 2.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 8.813900e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7222e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209787e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510237e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.220785
====================================================
  Execution time = 1.4252e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1023e-01
  Total weights = 1.9562e+06
  Execution time = 1.8702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397781
                                         uncertainty =       0.002555964384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397781
                                         uncertainty =       0.002555964384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386210735
  error estimate for blocks of size 2^( 2) =       0.000396249667
  error estimate for blocks of size 2^( 3) =       0.000405267099
  error estimate for blocks of size 2^( 4) =       0.000411799608
  error estimate for blocks of size 2^( 5) =       0.000415482576
  error estimate for blocks of size 2^( 6) =       0.000416411248
  error estimate for blocks of size 2^( 7) =       0.000419861181

      target function =                  N/A
              le_mean =     -17.216447788674
             les_mean =     296.716303122193
             stat err =       0.000415888653
             autocorr =       1.159592670840
              std dev =       0.546184458931
             le_variance =       0.298317463177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397742
                                         uncertainty =       0.002555964335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397742
                                         uncertainty =       0.002555964335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386210735
  error estimate for blocks of size 2^( 2) =       0.000396249667
  error estimate for blocks of size 2^( 3) =       0.000405267099
  error estimate for blocks of size 2^( 4) =       0.000411799607
  error estimate for blocks of size 2^( 5) =       0.000415482576
  error estimate for blocks of size 2^( 6) =       0.000416411248
  error estimate for blocks of size 2^( 7) =       0.000419861181

      target function =                  N/A
              le_mean =     -17.216447788669
             les_mean =     296.716303122197
             stat err =       0.000415888653
             autocorr =       1.159592670647
              std dev =       0.546184458900
             le_variance =       0.298317463144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397762
                                         uncertainty =       0.002555964359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397762
                                         uncertainty =       0.002555964359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386210735
  error estimate for blocks of size 2^( 2) =       0.000396249667
  error estimate for blocks of size 2^( 3) =       0.000405267099
  error estimate for blocks of size 2^( 4) =       0.000411799607
  error estimate for blocks of size 2^( 5) =       0.000415482576
  error estimate for blocks of size 2^( 6) =       0.000416411248
  error estimate for blocks of size 2^( 7) =       0.000419861181

      target function =                  N/A
              le_mean =     -17.216447788672
             les_mean =     296.716303122195
             stat err =       0.000415888653
             autocorr =       1.159592670747
              std dev =       0.546184458915
             le_variance =       0.298317463160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397779
                                         uncertainty =       0.002555964381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298260397779
                                         uncertainty =       0.002555964381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386210735
  error estimate for blocks of size 2^( 2) =       0.000396249667
  error estimate for blocks of size 2^( 3) =       0.000405267099
  error estimate for blocks of size 2^( 4) =       0.000411799608
  error estimate for blocks of size 2^( 5) =       0.000415482576
  error estimate for blocks of size 2^( 6) =       0.000416411248
  error estimate for blocks of size 2^( 7) =       0.000419861181

      target function =                  N/A
              le_mean =     -17.216447788674
             les_mean =     296.716303122193
             stat err =       0.000415888653
             autocorr =       1.159592670834
              std dev =       0.546184458929
             le_variance =       0.298317463175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216447788674        initial  <--
     2.2737e+05     2.2737e+06             1.4102e-09       -17.216447788669
     9.0949e+05     9.0949e+06             3.5256e-10       -17.216447788672
     3.6380e+06     3.6380e+07             8.8139e-11       -17.216447788674

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6595
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2778
    reference variance = 0.247425
====================================================
  Execution time = 1.4719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2581e-01
  Total weights = 1.956385360e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308957647855
                                         uncertainty =       0.009830787070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308957647855
                                         uncertainty =       0.009830787070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392999601
  error estimate for blocks of size 2^( 2) =       0.000402917575
  error estimate for blocks of size 2^( 3) =       0.000411450479
  error estimate for blocks of size 2^( 4) =       0.000417870801
  error estimate for blocks of size 2^( 5) =       0.000422825297
  error estimate for blocks of size 2^( 6) =       0.000425431888
  error estimate for blocks of size 2^( 7) =       0.000425228605

      target function =                  N/A
              le_mean =     -17.216280771395
             les_mean =     296.726132266563
             stat err =       0.000422839148
             autocorr =       1.157620366476
              std dev =       0.555785365680
             le_variance =       0.308897372703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628077140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216280771424       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216280771425       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216280771425       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216280771425       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 1.502704e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216280771424       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216280771424       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216280771424       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216280771278       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 3.756760e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216280771424       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216280771424       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216280771424       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216280750141       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 9.391881e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7273e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2666
    reference variance = 0.239847
====================================================
  Execution time = 1.4353e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1112e-01
  Total weights = 1.9567e+06
  Execution time = 1.8553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487853
                                         uncertainty =       0.001860092668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487853
                                         uncertainty =       0.001860092668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384899144
  error estimate for blocks of size 2^( 2) =       0.000394757715
  error estimate for blocks of size 2^( 3) =       0.000403857969
  error estimate for blocks of size 2^( 4) =       0.000410597050
  error estimate for blocks of size 2^( 5) =       0.000414337916
  error estimate for blocks of size 2^( 6) =       0.000415326936
  error estimate for blocks of size 2^( 7) =       0.000416279667

      target function =                  N/A
              le_mean =     -17.217243781629
             les_mean =     296.744605958539
             stat err =       0.000414135392
             autocorr =       1.157686061839
              std dev =       0.544329589411
             le_variance =       0.296294701908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487898
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487898
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384899144
  error estimate for blocks of size 2^( 2) =       0.000394757715
  error estimate for blocks of size 2^( 3) =       0.000403857969
  error estimate for blocks of size 2^( 4) =       0.000410597050
  error estimate for blocks of size 2^( 5) =       0.000414337917
  error estimate for blocks of size 2^( 6) =       0.000415326936
  error estimate for blocks of size 2^( 7) =       0.000416279667

      target function =                  N/A
              le_mean =     -17.217243781629
             les_mean =     296.744605955468
             stat err =       0.000414135392
             autocorr =       1.157686061811
              std dev =       0.544329589452
             le_variance =       0.296294701953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487876
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487876
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384899144
  error estimate for blocks of size 2^( 2) =       0.000394757715
  error estimate for blocks of size 2^( 3) =       0.000403857969
  error estimate for blocks of size 2^( 4) =       0.000410597050
  error estimate for blocks of size 2^( 5) =       0.000414337917
  error estimate for blocks of size 2^( 6) =       0.000415326936
  error estimate for blocks of size 2^( 7) =       0.000416279667

      target function =                  N/A
              le_mean =     -17.217243781629
             les_mean =     296.744605957004
             stat err =       0.000414135392
             autocorr =       1.157686061822
              std dev =       0.544329589431
             le_variance =       0.296294701930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487856
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296381487856
                                         uncertainty =       0.001860092669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384899144
  error estimate for blocks of size 2^( 2) =       0.000394757715
  error estimate for blocks of size 2^( 3) =       0.000403857969
  error estimate for blocks of size 2^( 4) =       0.000410597050
  error estimate for blocks of size 2^( 5) =       0.000414337916
  error estimate for blocks of size 2^( 6) =       0.000415326936
  error estimate for blocks of size 2^( 7) =       0.000416279667

      target function =                  N/A
              le_mean =     -17.217243781629
             les_mean =     296.744605958347
             stat err =       0.000414135392
             autocorr =       1.157686061839
              std dev =       0.544329589413
             le_variance =       0.296294701911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217243781629        initial  <--
     2.2737e+06     2.2737e+07             1.5027e-10       -17.217243781629
     9.0949e+06     9.0949e+07             3.7568e-11       -17.217243781629
     3.6380e+07     3.6380e+08             9.3919e-12       -17.217243781629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7298
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.259203
====================================================
  Execution time = 1.4777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1557e-01
  Total weights = 1.956089612e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297751521523
                                         uncertainty =       0.002126397605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297751521523
                                         uncertainty =       0.002126397605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385856895
  error estimate for blocks of size 2^( 2) =       0.000395816646
  error estimate for blocks of size 2^( 3) =       0.000404600591
  error estimate for blocks of size 2^( 4) =       0.000411103414
  error estimate for blocks of size 2^( 5) =       0.000415502232
  error estimate for blocks of size 2^( 6) =       0.000417514226
  error estimate for blocks of size 2^( 7) =       0.000417794335

      target function =                  N/A
              le_mean =     -17.216882799071
             les_mean =     296.736624612067
             stat err =       0.000415478552
             autocorr =       1.159430412208
              std dev =       0.545684053928
             le_variance =       0.297771086711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688279907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882799143       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882799143       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882799143       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 1.054048e-11

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882799143       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882799143       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882799143       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 2.635121e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882799143       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882799143       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882799143       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 6.587803e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7339e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.158258
====================================================
  Execution time = 1.4242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1287e-01
  Total weights = 1.9568e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947794
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947794
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386234592
  error estimate for blocks of size 2^( 2) =       0.000396363196
  error estimate for blocks of size 2^( 3) =       0.000405350686
  error estimate for blocks of size 2^( 4) =       0.000411528305
  error estimate for blocks of size 2^( 5) =       0.000415149183
  error estimate for blocks of size 2^( 6) =       0.000417781198
  error estimate for blocks of size 2^( 7) =       0.000419921498

      target function =                  N/A
              le_mean =     -17.217262091886
             les_mean =     296.746988860803
             stat err =       0.000416095046
             autocorr =       1.160600504123
              std dev =       0.546218198665
             le_variance =       0.298354320553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947800
                                         uncertainty =       0.002909090585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947800
                                         uncertainty =       0.002909090585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386234592
  error estimate for blocks of size 2^( 2) =       0.000396363196
  error estimate for blocks of size 2^( 3) =       0.000405350686
  error estimate for blocks of size 2^( 4) =       0.000411528305
  error estimate for blocks of size 2^( 5) =       0.000415149183
  error estimate for blocks of size 2^( 6) =       0.000417781198
  error estimate for blocks of size 2^( 7) =       0.000419921498

      target function =                  N/A
              le_mean =     -17.217262091886
             les_mean =     296.746988860854
             stat err =       0.000416095046
             autocorr =       1.160600504122
              std dev =       0.546218198671
             le_variance =       0.298354320559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947797
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947797
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386234592
  error estimate for blocks of size 2^( 2) =       0.000396363196
  error estimate for blocks of size 2^( 3) =       0.000405350686
  error estimate for blocks of size 2^( 4) =       0.000411528305
  error estimate for blocks of size 2^( 5) =       0.000415149183
  error estimate for blocks of size 2^( 6) =       0.000417781198
  error estimate for blocks of size 2^( 7) =       0.000419921498

      target function =                  N/A
              le_mean =     -17.217262091886
             les_mean =     296.746988860828
             stat err =       0.000416095046
             autocorr =       1.160600504123
              std dev =       0.546218198668
             le_variance =       0.298354320556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947794
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298432947794
                                         uncertainty =       0.002909090584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386234592
  error estimate for blocks of size 2^( 2) =       0.000396363196
  error estimate for blocks of size 2^( 3) =       0.000405350686
  error estimate for blocks of size 2^( 4) =       0.000411528305
  error estimate for blocks of size 2^( 5) =       0.000415149183
  error estimate for blocks of size 2^( 6) =       0.000417781198
  error estimate for blocks of size 2^( 7) =       0.000419921498

      target function =                  N/A
              le_mean =     -17.217262091886
             les_mean =     296.746988860806
             stat err =       0.000416095046
             autocorr =       1.160600504132
              std dev =       0.546218198666
             le_variance =       0.298354320554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217262091886        initial
     2.2737e+07     2.2737e+08             1.0540e-11       -17.217262091886  <--
     9.0949e+07     9.0949e+08             2.6351e-12       -17.217262091886
     3.6380e+08     3.6380e+09             6.5878e-13       -17.217262091886

*****************************************************************************
Applying the update for shift_i =   2.2737e+07     and shift_s =   2.2737e+08
*****************************************************************************

  Execution time = 2.7449e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.211157
====================================================
  Execution time = 1.4577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1230e-01
  Total weights = 1.956593596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294779398035
                                         uncertainty =       0.002431186694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294779398035
                                         uncertainty =       0.002431186694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383904152
  error estimate for blocks of size 2^( 2) =       0.000393654756
  error estimate for blocks of size 2^( 3) =       0.000402639803
  error estimate for blocks of size 2^( 4) =       0.000409746909
  error estimate for blocks of size 2^( 5) =       0.000413013247
  error estimate for blocks of size 2^( 6) =       0.000414908391
  error estimate for blocks of size 2^( 7) =       0.000416413921

      target function =                  N/A
              le_mean =     -17.216392212359
             les_mean =     296.716464155208
             stat err =       0.000413520617
             autocorr =       1.160242354535
              std dev =       0.542922458738
             le_variance =       0.294764796202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639221236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392212425       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392212426       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392212426       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392212426       residual = 5.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 9.323328e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392212425       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392212426       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392212426       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392212426       residual = 5.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 2.330832e-11

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392212425       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392212425       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392212425       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392170353       residual = 5.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 5.827066e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7157e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812057e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.24945
====================================================
  Execution time = 1.4333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0951e-01
  Total weights = 1.9567e+06
  Execution time = 1.8584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894683
                                         uncertainty =       0.001931683829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894683
                                         uncertainty =       0.001931683829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385349722
  error estimate for blocks of size 2^( 2) =       0.000395461757
  error estimate for blocks of size 2^( 3) =       0.000404721677
  error estimate for blocks of size 2^( 4) =       0.000411064364
  error estimate for blocks of size 2^( 5) =       0.000414638060
  error estimate for blocks of size 2^( 6) =       0.000416723882
  error estimate for blocks of size 2^( 7) =       0.000417076354

      target function =                  N/A
              le_mean =     -17.216904183558
             les_mean =     296.731295955420
             stat err =       0.000414875665
             autocorr =       1.159113119969
              std dev =       0.544966803679
             le_variance =       0.296988817112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894728
                                         uncertainty =       0.001931683831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894728
                                         uncertainty =       0.001931683831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385349722
  error estimate for blocks of size 2^( 2) =       0.000395461757
  error estimate for blocks of size 2^( 3) =       0.000404721677
  error estimate for blocks of size 2^( 4) =       0.000411064364
  error estimate for blocks of size 2^( 5) =       0.000414638060
  error estimate for blocks of size 2^( 6) =       0.000416723882
  error estimate for blocks of size 2^( 7) =       0.000417076354

      target function =                  N/A
              le_mean =     -17.216904183558
             les_mean =     296.731295955187
             stat err =       0.000414875665
             autocorr =       1.159113119897
              std dev =       0.544966803720
             le_variance =       0.296988817156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894706
                                         uncertainty =       0.001931683830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894706
                                         uncertainty =       0.001931683830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385349722
  error estimate for blocks of size 2^( 2) =       0.000395461757
  error estimate for blocks of size 2^( 3) =       0.000404721677
  error estimate for blocks of size 2^( 4) =       0.000411064364
  error estimate for blocks of size 2^( 5) =       0.000414638060
  error estimate for blocks of size 2^( 6) =       0.000416723882
  error estimate for blocks of size 2^( 7) =       0.000417076354

      target function =                  N/A
              le_mean =     -17.216904183558
             les_mean =     296.731295955304
             stat err =       0.000414875665
             autocorr =       1.159113119937
              std dev =       0.544966803699
             le_variance =       0.296988817134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894686
                                         uncertainty =       0.001931683829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297034894686
                                         uncertainty =       0.001931683829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385349722
  error estimate for blocks of size 2^( 2) =       0.000395461757
  error estimate for blocks of size 2^( 3) =       0.000404721677
  error estimate for blocks of size 2^( 4) =       0.000411064364
  error estimate for blocks of size 2^( 5) =       0.000414638060
  error estimate for blocks of size 2^( 6) =       0.000416723882
  error estimate for blocks of size 2^( 7) =       0.000417076354

      target function =                  N/A
              le_mean =     -17.216904183558
             les_mean =     296.731295955405
             stat err =       0.000414875665
             autocorr =       1.159113119961
              std dev =       0.544966803682
             le_variance =       0.296988817115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216904183558        initial
     5.6843e+06     5.6843e+07             9.3233e-11       -17.216904183558  <--
     2.2737e+07     2.2737e+08             2.3308e-11       -17.216904183558
     9.0949e+07     9.0949e+08             5.8271e-12       -17.216904183558

*****************************************************************************
Applying the update for shift_i =   5.6843e+06     and shift_s =   5.6843e+07
*****************************************************************************

  Execution time = 2.3728e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.230385
====================================================
  Execution time = 1.4710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0921e-01
  Total weights = 1.956668043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295959289394
                                         uncertainty =       0.001855397166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295959289394
                                         uncertainty =       0.001855397166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384644966
  error estimate for blocks of size 2^( 2) =       0.000395086437
  error estimate for blocks of size 2^( 3) =       0.000404042690
  error estimate for blocks of size 2^( 4) =       0.000411075606
  error estimate for blocks of size 2^( 5) =       0.000414808055
  error estimate for blocks of size 2^( 6) =       0.000416253884
  error estimate for blocks of size 2^( 7) =       0.000416917536

      target function =                  N/A
              le_mean =     -17.216148295872
             les_mean =     296.704972373483
             stat err =       0.000414763770
             autocorr =       1.162737079247
              std dev =       0.543970127259
             le_variance =       0.295903499351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614829587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216148295927       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216148295931       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216148295931       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+06 is 1.856953e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216148295927       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216148295928       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216148295928       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 4.642383e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216148295927       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216148295927       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216148295927       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 1.160596e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7259e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135520e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1914
    reference variance = 0.252528
====================================================
  Execution time = 1.4330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1502e-01
  Total weights = 1.9569e+06
  Execution time = 1.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904868
                                         uncertainty =       0.001935046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904868
                                         uncertainty =       0.001935046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385857168
  error estimate for blocks of size 2^( 2) =       0.000395728661
  error estimate for blocks of size 2^( 3) =       0.000404636754
  error estimate for blocks of size 2^( 4) =       0.000410750204
  error estimate for blocks of size 2^( 5) =       0.000414496160
  error estimate for blocks of size 2^( 6) =       0.000417352958
  error estimate for blocks of size 2^( 7) =       0.000418021166

      target function =                  N/A
              le_mean =     -17.216738798741
             les_mean =     296.731113810105
             stat err =       0.000415155122
             autocorr =       1.157624359463
              std dev =       0.545684439498
             le_variance =       0.297771507510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712905031
                                         uncertainty =       0.001935046152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712905031
                                         uncertainty =       0.001935046152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385857168
  error estimate for blocks of size 2^( 2) =       0.000395728661
  error estimate for blocks of size 2^( 3) =       0.000404636754
  error estimate for blocks of size 2^( 4) =       0.000410750204
  error estimate for blocks of size 2^( 5) =       0.000414496160
  error estimate for blocks of size 2^( 6) =       0.000417352958
  error estimate for blocks of size 2^( 7) =       0.000418021166

      target function =                  N/A
              le_mean =     -17.216738798743
             les_mean =     296.731113814076
             stat err =       0.000415155122
             autocorr =       1.157624359402
              std dev =       0.545684439648
             le_variance =       0.297771507674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904949
                                         uncertainty =       0.001935046147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904949
                                         uncertainty =       0.001935046147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385857168
  error estimate for blocks of size 2^( 2) =       0.000395728661
  error estimate for blocks of size 2^( 3) =       0.000404636754
  error estimate for blocks of size 2^( 4) =       0.000410750204
  error estimate for blocks of size 2^( 5) =       0.000414496160
  error estimate for blocks of size 2^( 6) =       0.000417352958
  error estimate for blocks of size 2^( 7) =       0.000418021166

      target function =                  N/A
              le_mean =     -17.216738798742
             les_mean =     296.731113812090
             stat err =       0.000415155122
             autocorr =       1.157624359425
              std dev =       0.545684439573
             le_variance =       0.297771507592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904878
                                         uncertainty =       0.001935046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297712904878
                                         uncertainty =       0.001935046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385857168
  error estimate for blocks of size 2^( 2) =       0.000395728661
  error estimate for blocks of size 2^( 3) =       0.000404636754
  error estimate for blocks of size 2^( 4) =       0.000410750204
  error estimate for blocks of size 2^( 5) =       0.000414496160
  error estimate for blocks of size 2^( 6) =       0.000417352958
  error estimate for blocks of size 2^( 7) =       0.000418021166

      target function =                  N/A
              le_mean =     -17.216738798742
             les_mean =     296.731113810353
             stat err =       0.000415155122
             autocorr =       1.157624359449
              std dev =       0.545684439507
             le_variance =       0.297771507520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216738798741        initial
     1.4211e+06     1.4211e+07             1.8570e-10       -17.216738798743  <--
     5.6843e+06     5.6843e+07             4.6424e-11       -17.216738798742
     2.2737e+07     2.2737e+08             1.1606e-11       -17.216738798742

*****************************************************************************
Applying the update for shift_i =   1.4211e+06     and shift_s =   1.4211e+07
*****************************************************************************

  Execution time = 2.3716e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968551e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2454
    reference variance = 0.183468
====================================================
  Execution time = 1.4917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1607e-01
  Total weights = 1.956531295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298804425106
                                         uncertainty =       0.001822013260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298804425106
                                         uncertainty =       0.001822013260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386509412
  error estimate for blocks of size 2^( 2) =       0.000396760434
  error estimate for blocks of size 2^( 3) =       0.000405535966
  error estimate for blocks of size 2^( 4) =       0.000411541034
  error estimate for blocks of size 2^( 5) =       0.000415642612
  error estimate for blocks of size 2^( 6) =       0.000418294673
  error estimate for blocks of size 2^( 7) =       0.000418492022

      target function =                  N/A
              le_mean =     -17.217249352877
             les_mean =     296.749743860905
             stat err =       0.000415992585
             autocorr =       1.158379946071
              std dev =       0.546606853050
             le_variance =       0.298779051801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724935288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249352942       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249352948       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249352947       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+05 is 8.541112e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249352942       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249352943       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249352943       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+06 is 2.135279e-10

solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249352942       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249352942       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249352942       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 5.338199e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7447e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469565e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.47975
====================================================
  Execution time = 1.4436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1836e-01
  Total weights = 1.9567e+06
  Execution time = 1.8581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530028
                                         uncertainty =       0.002553053438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530028
                                         uncertainty =       0.002553053438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388627394
  error estimate for blocks of size 2^( 2) =       0.000397953344
  error estimate for blocks of size 2^( 3) =       0.000406738719
  error estimate for blocks of size 2^( 4) =       0.000413785602
  error estimate for blocks of size 2^( 5) =       0.000417810679
  error estimate for blocks of size 2^( 6) =       0.000419490851
  error estimate for blocks of size 2^( 7) =       0.000418633467

      target function =                  N/A
              le_mean =     -17.216562408729
             les_mean =     296.728377134374
             stat err =       0.000417430149
             autocorr =       1.153721020631
              std dev =       0.549602131651
             le_variance =       0.302062503116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530012
                                         uncertainty =       0.002553053424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530012
                                         uncertainty =       0.002553053424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388627394
  error estimate for blocks of size 2^( 2) =       0.000397953344
  error estimate for blocks of size 2^( 3) =       0.000406738719
  error estimate for blocks of size 2^( 4) =       0.000413785602
  error estimate for blocks of size 2^( 5) =       0.000417810679
  error estimate for blocks of size 2^( 6) =       0.000419490851
  error estimate for blocks of size 2^( 7) =       0.000418633467

      target function =                  N/A
              le_mean =     -17.216562408721
             les_mean =     296.728377135410
             stat err =       0.000417430149
             autocorr =       1.153721020719
              std dev =       0.549602131637
             le_variance =       0.302062503100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530020
                                         uncertainty =       0.002553053431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530020
                                         uncertainty =       0.002553053431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388627394
  error estimate for blocks of size 2^( 2) =       0.000397953344
  error estimate for blocks of size 2^( 3) =       0.000406738719
  error estimate for blocks of size 2^( 4) =       0.000413785602
  error estimate for blocks of size 2^( 5) =       0.000417810679
  error estimate for blocks of size 2^( 6) =       0.000419490851
  error estimate for blocks of size 2^( 7) =       0.000418633467

      target function =                  N/A
              le_mean =     -17.216562408725
             les_mean =     296.728377134892
             stat err =       0.000417430149
             autocorr =       1.153721020671
              std dev =       0.549602131644
             le_variance =       0.302062503107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530027
                                         uncertainty =       0.002553053437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302135530027
                                         uncertainty =       0.002553053437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388627394
  error estimate for blocks of size 2^( 2) =       0.000397953344
  error estimate for blocks of size 2^( 3) =       0.000406738719
  error estimate for blocks of size 2^( 4) =       0.000413785602
  error estimate for blocks of size 2^( 5) =       0.000417810679
  error estimate for blocks of size 2^( 6) =       0.000419490851
  error estimate for blocks of size 2^( 7) =       0.000418633467

      target function =                  N/A
              le_mean =     -17.216562408728
             les_mean =     296.728377134439
             stat err =       0.000417430149
             autocorr =       1.153721020633
              std dev =       0.549602131650
             le_variance =       0.302062503114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216562408729        initial  <--
     3.5527e+05     3.5527e+06             8.5411e-10       -17.216562408721
     1.4211e+06     1.4211e+07             2.1353e-10       -17.216562408725
     5.6843e+06     5.6843e+07             5.3382e-11       -17.216562408728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8257
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968551e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.203161
====================================================
  Execution time = 1.4746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1805e-01
  Total weights = 1.956786257e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303317132643
                                         uncertainty =       0.003355934665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303317132643
                                         uncertainty =       0.003355934665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389374542
  error estimate for blocks of size 2^( 2) =       0.000399255678
  error estimate for blocks of size 2^( 3) =       0.000407797251
  error estimate for blocks of size 2^( 4) =       0.000414227016
  error estimate for blocks of size 2^( 5) =       0.000418801424
  error estimate for blocks of size 2^( 6) =       0.000421779741
  error estimate for blocks of size 2^( 7) =       0.000423141911

      target function =                  N/A
              le_mean =     -17.216809876563
             les_mean =     296.736588557241
             stat err =       0.000419487523
             autocorr =       1.160654582682
              std dev =       0.550658757477
             le_variance =       0.303225067186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680987656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809876671       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809876673       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809876673       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809876673       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 1.242584e-10

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809876671       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809876672       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809876672       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809876672       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 3.106456e-11

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216809876671       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216809876672       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216809876672       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216809876672       residual = 1.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 7.766172e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7297e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106599e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.217051
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1334e-01
  Total weights = 1.9566e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780851
                                         uncertainty =       0.002383837036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780851
                                         uncertainty =       0.002383837036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386088136
  error estimate for blocks of size 2^( 2) =       0.000396056993
  error estimate for blocks of size 2^( 3) =       0.000405532648
  error estimate for blocks of size 2^( 4) =       0.000412865570
  error estimate for blocks of size 2^( 5) =       0.000416226529
  error estimate for blocks of size 2^( 6) =       0.000417317668
  error estimate for blocks of size 2^( 7) =       0.000418777981

      target function =                  N/A
              le_mean =     -17.216892716392
             les_mean =     296.734736768411
             stat err =       0.000416296937
             autocorr =       1.162608567081
              std dev =       0.546011077632
             le_variance =       0.298128096897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780890
                                         uncertainty =       0.002383837040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780890
                                         uncertainty =       0.002383837040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386088136
  error estimate for blocks of size 2^( 2) =       0.000396056993
  error estimate for blocks of size 2^( 3) =       0.000405532648
  error estimate for blocks of size 2^( 4) =       0.000412865570
  error estimate for blocks of size 2^( 5) =       0.000416226529
  error estimate for blocks of size 2^( 6) =       0.000417317668
  error estimate for blocks of size 2^( 7) =       0.000418777981

      target function =                  N/A
              le_mean =     -17.216892716394
             les_mean =     296.734736768459
             stat err =       0.000416296937
             autocorr =       1.162608567051
              std dev =       0.546011077667
             le_variance =       0.298128096936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780870
                                         uncertainty =       0.002383837038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780870
                                         uncertainty =       0.002383837038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386088136
  error estimate for blocks of size 2^( 2) =       0.000396056993
  error estimate for blocks of size 2^( 3) =       0.000405532648
  error estimate for blocks of size 2^( 4) =       0.000412865570
  error estimate for blocks of size 2^( 5) =       0.000416226529
  error estimate for blocks of size 2^( 6) =       0.000417317668
  error estimate for blocks of size 2^( 7) =       0.000418777981

      target function =                  N/A
              le_mean =     -17.216892716393
             les_mean =     296.734736768435
             stat err =       0.000416296937
             autocorr =       1.162608567065
              std dev =       0.546011077650
             le_variance =       0.298128096916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780854
                                         uncertainty =       0.002383837036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298221780854
                                         uncertainty =       0.002383837036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386088136
  error estimate for blocks of size 2^( 2) =       0.000396056993
  error estimate for blocks of size 2^( 3) =       0.000405532648
  error estimate for blocks of size 2^( 4) =       0.000412865570
  error estimate for blocks of size 2^( 5) =       0.000416226529
  error estimate for blocks of size 2^( 6) =       0.000417317668
  error estimate for blocks of size 2^( 7) =       0.000418777981

      target function =                  N/A
              le_mean =     -17.216892716392
             les_mean =     296.734736768414
             stat err =       0.000416296937
             autocorr =       1.162608567065
              std dev =       0.546011077634
             le_variance =       0.298128096899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216892716392        initial
     3.5527e+06     3.5527e+07             1.2426e-10       -17.216892716394  <--
     1.4211e+07     1.4211e+08             3.1065e-11       -17.216892716393
     5.6843e+07     5.6843e+08             7.7662e-12       -17.216892716392

*****************************************************************************
Applying the update for shift_i =   3.5527e+06     and shift_s =   3.5527e+07
*****************************************************************************

  Execution time = 2.3856e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.987662
====================================================
  Execution time = 1.4643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1496e-01
  Total weights = 1.956715155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297288392393
                                         uncertainty =       0.001786853134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297288392393
                                         uncertainty =       0.001786853134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385750864
  error estimate for blocks of size 2^( 2) =       0.000395351887
  error estimate for blocks of size 2^( 3) =       0.000403708418
  error estimate for blocks of size 2^( 4) =       0.000409864040
  error estimate for blocks of size 2^( 5) =       0.000413479744
  error estimate for blocks of size 2^( 6) =       0.000416668052
  error estimate for blocks of size 2^( 7) =       0.000418769699

      target function =                  N/A
              le_mean =     -17.217226671631
             les_mean =     296.747855600857
             stat err =       0.000414695384
             autocorr =       1.155698597094
              std dev =       0.545534103860
             le_variance =       0.297607458475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721722667163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226671702       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226671706       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226671706       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226671706       residual = 3.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+05 is 3.996434e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226671702       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226671703       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226671703       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226671703       residual = 3.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 9.991086e-11

solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226671702       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226671702       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226671702       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226679533       residual = 3.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 2.497771e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7181e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1957
    reference variance = 0.308578
====================================================
  Execution time = 1.4333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1668e-01
  Total weights = 1.9566e+06
  Execution time = 1.8507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462227
                                         uncertainty =       0.002086498966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462227
                                         uncertainty =       0.002086498966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385982593
  error estimate for blocks of size 2^( 2) =       0.000395519374
  error estimate for blocks of size 2^( 3) =       0.000404572930
  error estimate for blocks of size 2^( 4) =       0.000411663556
  error estimate for blocks of size 2^( 5) =       0.000414355081
  error estimate for blocks of size 2^( 6) =       0.000416329841
  error estimate for blocks of size 2^( 7) =       0.000417850955

      target function =                  N/A
              le_mean =     -17.216537455074
             les_mean =     296.725840006089
             stat err =       0.000415049858
             autocorr =       1.156285554469
              std dev =       0.545861818533
             le_variance =       0.297965124932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462278
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462278
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385982594
  error estimate for blocks of size 2^( 2) =       0.000395519374
  error estimate for blocks of size 2^( 3) =       0.000404572930
  error estimate for blocks of size 2^( 4) =       0.000411663556
  error estimate for blocks of size 2^( 5) =       0.000414355081
  error estimate for blocks of size 2^( 6) =       0.000416329841
  error estimate for blocks of size 2^( 7) =       0.000417850955

      target function =                  N/A
              le_mean =     -17.216537455070
             les_mean =     296.725840006708
             stat err =       0.000415049858
             autocorr =       1.156285554397
              std dev =       0.545861818579
             le_variance =       0.297965124983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462252
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462252
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385982593
  error estimate for blocks of size 2^( 2) =       0.000395519374
  error estimate for blocks of size 2^( 3) =       0.000404572930
  error estimate for blocks of size 2^( 4) =       0.000411663556
  error estimate for blocks of size 2^( 5) =       0.000414355081
  error estimate for blocks of size 2^( 6) =       0.000416329841
  error estimate for blocks of size 2^( 7) =       0.000417850955

      target function =                  N/A
              le_mean =     -17.216537455072
             les_mean =     296.725840006399
             stat err =       0.000415049858
             autocorr =       1.156285554429
              std dev =       0.545861818556
             le_variance =       0.297965124957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462230
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298038462230
                                         uncertainty =       0.002086498965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385982593
  error estimate for blocks of size 2^( 2) =       0.000395519374
  error estimate for blocks of size 2^( 3) =       0.000404572930
  error estimate for blocks of size 2^( 4) =       0.000411663556
  error estimate for blocks of size 2^( 5) =       0.000414355081
  error estimate for blocks of size 2^( 6) =       0.000416329841
  error estimate for blocks of size 2^( 7) =       0.000417850955

      target function =                  N/A
              le_mean =     -17.216537455074
             les_mean =     296.725840006128
             stat err =       0.000415049858
             autocorr =       1.156285554452
              std dev =       0.545861818536
             le_variance =       0.297965124935


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216537455074        initial  <--
     8.8818e+05     8.8818e+06             3.9964e-10       -17.216537455070
     3.5527e+06     3.5527e+07             9.9911e-11       -17.216537455072
     1.4211e+07     1.4211e+08             2.4978e-11       -17.216537455074

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6661
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0853e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1393
    reference variance = 0.237103
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1288e-01
  Total weights = 1.956547243e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599375069
                                         uncertainty =       0.002289880661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298599375069
                                         uncertainty =       0.002289880661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386348125
  error estimate for blocks of size 2^( 2) =       0.000396499273
  error estimate for blocks of size 2^( 3) =       0.000405592783
  error estimate for blocks of size 2^( 4) =       0.000412095130
  error estimate for blocks of size 2^( 5) =       0.000416624824
  error estimate for blocks of size 2^( 6) =       0.000418696329
  error estimate for blocks of size 2^( 7) =       0.000419735528

      target function =                  N/A
              le_mean =     -17.216126870265
             les_mean =     296.707900202785
             stat err =       0.000416787953
             autocorr =       1.163784840600
              std dev =       0.546378758639
             le_variance =       0.298529747891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612687027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216126870314       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216126870314       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216126870314       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216126870147       residual = 3.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 4.737023e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216126870314       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216126870314       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216126870314       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216126870314       residual = 3.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 1.184256e-11

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216126870314       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216126870314       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216126870314       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216126870314       residual = 3.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 2.960550e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6759e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1621
    reference variance = 0.199897
====================================================
  Execution time = 1.3684e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1045e-01
  Total weights = 1.9567e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362731
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362731
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385094326
  error estimate for blocks of size 2^( 2) =       0.000395005639
  error estimate for blocks of size 2^( 3) =       0.000403506822
  error estimate for blocks of size 2^( 4) =       0.000410384941
  error estimate for blocks of size 2^( 5) =       0.000414533019
  error estimate for blocks of size 2^( 6) =       0.000416286586
  error estimate for blocks of size 2^( 7) =       0.000417238212

      target function =                  N/A
              le_mean =     -17.216533634205
             les_mean =     296.719482414829
             stat err =       0.000414610690
             autocorr =       1.159168978247
              std dev =       0.544605618834
             le_variance =       0.296595280065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362752
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362752
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385094326
  error estimate for blocks of size 2^( 2) =       0.000395005639
  error estimate for blocks of size 2^( 3) =       0.000403506822
  error estimate for blocks of size 2^( 4) =       0.000410384941
  error estimate for blocks of size 2^( 5) =       0.000414533019
  error estimate for blocks of size 2^( 6) =       0.000416286586
  error estimate for blocks of size 2^( 7) =       0.000417238212

      target function =                  N/A
              le_mean =     -17.216533634205
             les_mean =     296.719482414870
             stat err =       0.000414610690
             autocorr =       1.159168978221
              std dev =       0.544605618853
             le_variance =       0.296595280086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362741
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362741
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385094326
  error estimate for blocks of size 2^( 2) =       0.000395005639
  error estimate for blocks of size 2^( 3) =       0.000403506822
  error estimate for blocks of size 2^( 4) =       0.000410384941
  error estimate for blocks of size 2^( 5) =       0.000414533019
  error estimate for blocks of size 2^( 6) =       0.000416286586
  error estimate for blocks of size 2^( 7) =       0.000417238212

      target function =                  N/A
              le_mean =     -17.216533634205
             les_mean =     296.719482414849
             stat err =       0.000414610690
             autocorr =       1.159168978239
              std dev =       0.544605618843
             le_variance =       0.296595280076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362732
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296595362732
                                         uncertainty =       0.002049088173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385094326
  error estimate for blocks of size 2^( 2) =       0.000395005639
  error estimate for blocks of size 2^( 3) =       0.000403506822
  error estimate for blocks of size 2^( 4) =       0.000410384941
  error estimate for blocks of size 2^( 5) =       0.000414533019
  error estimate for blocks of size 2^( 6) =       0.000416286586
  error estimate for blocks of size 2^( 7) =       0.000417238212

      target function =                  N/A
              le_mean =     -17.216533634205
             les_mean =     296.719482414831
             stat err =       0.000414610690
             autocorr =       1.159168978246
              std dev =       0.544605618835
             le_variance =       0.296595280067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216533634205        initial  <--
     8.8818e+06     8.8818e+07             4.7370e-11       -17.216533634205
     3.5527e+07     3.5527e+08             1.1843e-11       -17.216533634205
     1.4211e+08     1.4211e+09             2.9606e-12       -17.216533634205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0334
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.3047
    reference variance = 0.186029
====================================================
  Execution time = 1.4327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1105e-01
  Total weights = 1.956815607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297801084511
                                         uncertainty =       0.001989083104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297801084511
                                         uncertainty =       0.001989083104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385873989
  error estimate for blocks of size 2^( 2) =       0.000396054900
  error estimate for blocks of size 2^( 3) =       0.000404818846
  error estimate for blocks of size 2^( 4) =       0.000411454883
  error estimate for blocks of size 2^( 5) =       0.000415566792
  error estimate for blocks of size 2^( 6) =       0.000416120158
  error estimate for blocks of size 2^( 7) =       0.000416414804

      target function =                  N/A
              le_mean =     -17.216903076044
             les_mean =     296.732796957246
             stat err =       0.000414889159
             autocorr =       1.156040808518
              std dev =       0.545708228546
             le_variance =       0.297797470702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690307604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216903076123       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216903076123       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216903076123       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216903076123       residual = 2.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+07 is 2.778425e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216903076123       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216903076123       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216903076123       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216903076123       residual = 2.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+08 is 6.945621e-13

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216903076123       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216903076123       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216903076123       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216903067303       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+09 is 1.736519e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6860e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1817
    reference variance = 0.239166
====================================================
  Execution time = 1.3624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1390e-01
  Total weights = 1.9567e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417063
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417063
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386133624
  error estimate for blocks of size 2^( 2) =       0.000395993837
  error estimate for blocks of size 2^( 3) =       0.000405243801
  error estimate for blocks of size 2^( 4) =       0.000411301426
  error estimate for blocks of size 2^( 5) =       0.000416094810
  error estimate for blocks of size 2^( 6) =       0.000416105087
  error estimate for blocks of size 2^( 7) =       0.000415417198

      target function =                  N/A
              le_mean =     -17.216354912998
             les_mean =     296.716778414055
             stat err =       0.000414729630
             autocorr =       1.153599044133
              std dev =       0.546075407315
             le_variance =       0.298198350474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417065
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417065
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386133624
  error estimate for blocks of size 2^( 2) =       0.000395993837
  error estimate for blocks of size 2^( 3) =       0.000405243801
  error estimate for blocks of size 2^( 4) =       0.000411301426
  error estimate for blocks of size 2^( 5) =       0.000416094810
  error estimate for blocks of size 2^( 6) =       0.000416105087
  error estimate for blocks of size 2^( 7) =       0.000415417198

      target function =                  N/A
              le_mean =     -17.216354912998
             les_mean =     296.716778414059
             stat err =       0.000414729630
             autocorr =       1.153599044114
              std dev =       0.546075407316
             le_variance =       0.298198350475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417064
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417064
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386133624
  error estimate for blocks of size 2^( 2) =       0.000395993837
  error estimate for blocks of size 2^( 3) =       0.000405243801
  error estimate for blocks of size 2^( 4) =       0.000411301426
  error estimate for blocks of size 2^( 5) =       0.000416094810
  error estimate for blocks of size 2^( 6) =       0.000416105087
  error estimate for blocks of size 2^( 7) =       0.000415417198

      target function =                  N/A
              le_mean =     -17.216354912998
             les_mean =     296.716778414057
             stat err =       0.000414729630
             autocorr =       1.153599044122
              std dev =       0.546075407315
             le_variance =       0.298198350475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417063
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298257417063
                                         uncertainty =       0.001949267025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386133624
  error estimate for blocks of size 2^( 2) =       0.000395993837
  error estimate for blocks of size 2^( 3) =       0.000405243801
  error estimate for blocks of size 2^( 4) =       0.000411301426
  error estimate for blocks of size 2^( 5) =       0.000416094810
  error estimate for blocks of size 2^( 6) =       0.000416105087
  error estimate for blocks of size 2^( 7) =       0.000415417198

      target function =                  N/A
              le_mean =     -17.216354912998
             les_mean =     296.716778414055
             stat err =       0.000414729630
             autocorr =       1.153599044118
              std dev =       0.546075407315
             le_variance =       0.298198350474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216354912998        initial  <--
     8.8818e+07     8.8818e+08             2.7784e-12       -17.216354912998
     3.5527e+08     3.5527e+09             6.9456e-13       -17.216354912998
     1.4211e+09     1.4211e+10             1.7365e-13       -17.216354912998

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8924
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.241425
====================================================
  Execution time = 1.6423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1077e-01
  Total weights = 1.956704672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329544223
                                         uncertainty =       0.002092377824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297329544223
                                         uncertainty =       0.002092377824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385499112
  error estimate for blocks of size 2^( 2) =       0.000395121322
  error estimate for blocks of size 2^( 3) =       0.000404005584
  error estimate for blocks of size 2^( 4) =       0.000409929145
  error estimate for blocks of size 2^( 5) =       0.000414786621
  error estimate for blocks of size 2^( 6) =       0.000417846941
  error estimate for blocks of size 2^( 7) =       0.000418577962

      target function =                  N/A
              le_mean =     -17.216675731676
             les_mean =     296.724693111260
             stat err =       0.000415285167
             autocorr =       1.160502488885
              std dev =       0.545178072020
             le_variance =       0.297219130212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667573168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675731735       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675731735       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675731735       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675731735       residual = 1.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+08 is 4.546077e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675731735       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675731735       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675731735       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675731735       residual = 1.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 1.136519e-13

solving harmonic davidson linear method for identity shift 1.4211e+10, overlap shift 1.4211e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675731735       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675731735       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675731735       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675731735       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+10 is 2.856668e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8944e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.297678
====================================================
  Execution time = 1.3599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1367e-01
  Total weights = 1.9568e+06
  Execution time = 1.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386435903
  error estimate for blocks of size 2^( 2) =       0.000395925005
  error estimate for blocks of size 2^( 3) =       0.000404993493
  error estimate for blocks of size 2^( 4) =       0.000411369607
  error estimate for blocks of size 2^( 5) =       0.000415115872
  error estimate for blocks of size 2^( 6) =       0.000416503619
  error estimate for blocks of size 2^( 7) =       0.000417662871

      target function =                  N/A
              le_mean =     -17.216554821337
             les_mean =     296.723425689775
             stat err =       0.000415162992
             autocorr =       1.154203343744
              std dev =       0.546502895628
             le_variance =       0.298665414930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386435903
  error estimate for blocks of size 2^( 2) =       0.000395925005
  error estimate for blocks of size 2^( 3) =       0.000404993493
  error estimate for blocks of size 2^( 4) =       0.000411369607
  error estimate for blocks of size 2^( 5) =       0.000415115872
  error estimate for blocks of size 2^( 6) =       0.000416503619
  error estimate for blocks of size 2^( 7) =       0.000417662871

      target function =                  N/A
              le_mean =     -17.216554821337
             les_mean =     296.723425689773
             stat err =       0.000415162992
             autocorr =       1.154203343735
              std dev =       0.546502895628
             le_variance =       0.298665414930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386435903
  error estimate for blocks of size 2^( 2) =       0.000395925005
  error estimate for blocks of size 2^( 3) =       0.000404993493
  error estimate for blocks of size 2^( 4) =       0.000411369607
  error estimate for blocks of size 2^( 5) =       0.000415115872
  error estimate for blocks of size 2^( 6) =       0.000416503619
  error estimate for blocks of size 2^( 7) =       0.000417662871

      target function =                  N/A
              le_mean =     -17.216554821337
             les_mean =     296.723425689774
             stat err =       0.000415162992
             autocorr =       1.154203343746
              std dev =       0.546502895628
             le_variance =       0.298665414930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676726523
                                         uncertainty =       0.002034690656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386435903
  error estimate for blocks of size 2^( 2) =       0.000395925005
  error estimate for blocks of size 2^( 3) =       0.000404993493
  error estimate for blocks of size 2^( 4) =       0.000411369607
  error estimate for blocks of size 2^( 5) =       0.000415115872
  error estimate for blocks of size 2^( 6) =       0.000416503619
  error estimate for blocks of size 2^( 7) =       0.000417662871

      target function =                  N/A
              le_mean =     -17.216554821337
             les_mean =     296.723425689775
             stat err =       0.000415162992
             autocorr =       1.154203343745
              std dev =       0.546502895628
             le_variance =       0.298665414930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216554821337        initial  <--
     8.8818e+08     8.8818e+09             4.5461e-13       -17.216554821337
     3.5527e+09     3.5527e+10             1.1365e-13       -17.216554821337
     1.4211e+10     1.4211e+11             2.8567e-14       -17.216554821337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9276
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.083609e-02 3 1  ON 0
ci_002                -3.050061e-02 3 1  ON 1
ci_003                -2.525238e-02 3 1  ON 2
ci_004                 2.152295e-02 3 1  ON 3
ci_005                 2.188000e-02 3 1  ON 4
ci_006                -1.971433e-02 3 1  ON 5
ci_007                -2.005518e-02 3 1  ON 6
ci_008                -1.835662e-02 3 1  ON 7
ci_009                -1.835607e-02 3 1  ON 8
ci_010                -1.670061e-02 3 1  ON 9
ci_011                -1.626049e-02 3 1  ON 10
ci_012                -1.640379e-02 3 1  ON 11
ci_013                -1.885173e-02 3 1  ON 12
ci_014                 1.384401e-02 3 1  ON 13
ci_015                 1.461871e-02 3 1  ON 14
ci_016                 1.625270e-02 3 1  ON 15
ci_017                 1.675533e-02 3 1  ON 16
ci_018                 1.311636e-02 3 1  ON 17
ci_019                 1.330382e-02 3 1  ON 18
ci_020                 1.383858e-02 3 1  ON 19
ci_021                 1.327698e-02 3 1  ON 20
ci_022                 1.182873e-02 3 1  ON 21
ci_023                 1.192989e-02 3 1  ON 22
ci_024                 1.106600e-02 3 1  ON 23
ci_025                 1.096493e-02 3 1  ON 24
ci_026                 1.202437e-02 3 1  ON 25
ci_027                 1.190015e-02 3 1  ON 26
ci_028                -1.417755e-02 3 1  ON 27
ci_029                -1.462491e-02 3 1  ON 28
ci_030                -1.093677e-02 3 1  ON 29
ci_031                -1.094574e-02 3 1  ON 30
ci_032                -1.397750e-02 3 1  ON 31
ci_033                 1.054537e-02 3 1  ON 32
ci_034                 1.055131e-02 3 1  ON 33
ci_035                -5.154721e-03 3 1  ON 34
ci_036                -1.075940e-02 3 1  ON 35
ci_037                -1.101853e-02 3 1  ON 36
ci_038                 1.342405e-03 3 1  ON 37
ci_039                 1.304034e-03 3 1  ON 38
ci_040                -4.233373e-03 3 1  ON 39
ci_041                 9.568632e-03 3 1  ON 40
ci_042                 9.993360e-03 3 1  ON 41
ci_043                -3.601846e-03 3 1  ON 42
ci_044                -1.507757e-02 3 1  ON 43
ci_045                -1.847906e-03 3 1  ON 44
ci_046                 5.384599e-03 3 1  ON 45
ci_047                 5.673701e-03 3 1  ON 46
ci_048                -1.198004e-02 3 1  ON 47
ci_049                -1.195551e-02 3 1  ON 48
ci_050                 7.762941e-03 3 1  ON 49
ci_051                 7.612341e-03 3 1  ON 50
ci_052                -6.903515e-03 3 1  ON 51
ci_053                -6.800206e-03 3 1  ON 52
ci_054                -2.475062e-03 3 1  ON 53
ci_055                -2.292402e-03 3 1  ON 54
ci_056                 4.812056e-03 3 1  ON 55
ci_057                 5.135521e-03 3 1  ON 56
ci_058                -7.209788e-03 3 1  ON 57
ci_059                -7.015886e-03 3 1  ON 58
ci_060                 8.610611e-03 3 1  ON 59
ci_061                 8.469566e-03 3 1  ON 60
ci_062                -2.926580e-03 3 1  ON 61
ci_063                -2.912046e-03 3 1  ON 62
ci_064                -3.510238e-03 3 1  ON 63
ci_065                -4.448371e-03 3 1  ON 64
ci_066                 5.854198e-03 3 1  ON 65
ci_067                 5.968550e-03 3 1  ON 66
ci_068                -4.576599e-03 3 1  ON 67
ci_069                -4.734136e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1877e+01 secs
  Total Execution time = 2.4713e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
