Rank =    0  Free Memory = 85205 MB
Rank =    1  Free Memory = 85204 MB
Rank =    2  Free Memory = 85204 MB
Rank =    3  Free Memory = 85204 MB
Rank =    4  Free Memory = 85204 MB
Rank =    5  Free Memory = 85203 MB
Rank =    6  Free Memory = 85203 MB
Rank =    7  Free Memory = 85202 MB
Rank =    8  Free Memory = 85202 MB
Rank =    9  Free Memory = 85202 MB
Rank =   10  Free Memory = 85201 MB
Rank =   11  Free Memory = 85201 MB
Rank =   12  Free Memory = 85201 MB
Rank =   13  Free Memory = 85201 MB
Rank =   14  Free Memory = 85201 MB
Rank =   15  Free Memory = 85189 MB
Rank =   16  Free Memory = 85188 MB
Rank =   17  Free Memory = 85188 MB
Rank =   18  Free Memory = 85188 MB
Rank =   19  Free Memory = 85188 MB
Rank =   20  Free Memory = 85188 MB
Rank =   21  Free Memory = 85188 MB
Rank =   22  Free Memory = 85188 MB
Rank =   23  Free Memory = 85188 MB
Rank =   24  Free Memory = 85188 MB
Rank =   25  Free Memory = 85188 MB
Rank =   26  Free Memory = 85188 MB
Rank =   27  Free Memory = 85188 MB
Rank =   28  Free Memory = 85188 MB
Rank =   29  Free Memory = 85188 MB
Rank =   30  Free Memory = 85188 MB
Rank =   31  Free Memory = 85188 MB
Rank =   32  Free Memory = 73499 MB
Rank =   33  Free Memory = 73499 MB
Rank =   34  Free Memory = 73498 MB
Rank =   35  Free Memory = 73498 MB
Rank =   36  Free Memory = 73498 MB
Rank =   37  Free Memory = 73498 MB
Rank =   38  Free Memory = 73498 MB
Rank =   39  Free Memory = 73498 MB
Rank =   40  Free Memory = 73498 MB
Rank =   41  Free Memory = 73498 MB
Rank =   42  Free Memory = 73498 MB
Rank =   43  Free Memory = 73498 MB
Rank =   44  Free Memory = 73498 MB
Rank =   45  Free Memory = 73498 MB
Rank =   46  Free Memory = 73498 MB
Rank =   47  Free Memory = 73498 MB
Rank =   48  Free Memory = 73498 MB
Rank =   49  Free Memory = 73498 MB
Rank =   50  Free Memory = 73498 MB
Rank =   51  Free Memory = 73498 MB
Rank =   52  Free Memory = 73498 MB
Rank =   53  Free Memory = 73498 MB
Rank =   54  Free Memory = 73498 MB
Rank =   55  Free Memory = 73498 MB
Rank =   56  Free Memory = 73498 MB
Rank =   57  Free Memory = 73498 MB
Rank =   58  Free Memory = 73498 MB
Rank =   59  Free Memory = 73498 MB
Rank =   60  Free Memory = 73498 MB
Rank =   61  Free Memory = 73498 MB
Rank =   62  Free Memory = 73498 MB
Rank =   63  Free Memory = 73498 MB
Rank =   64  Free Memory = 74145 MB
Rank =   65  Free Memory = 74145 MB
Rank =   66  Free Memory = 74145 MB
Rank =   67  Free Memory = 74145 MB
Rank =   68  Free Memory = 74145 MB
Rank =   69  Free Memory = 74145 MB
Rank =   70  Free Memory = 74145 MB
Rank =   71  Free Memory = 74145 MB
Rank =   72  Free Memory = 74145 MB
Rank =   73  Free Memory = 74145 MB
Rank =   74  Free Memory = 74145 MB
Rank =   75  Free Memory = 74145 MB
Rank =   76  Free Memory = 74145 MB
Rank =   77  Free Memory = 74145 MB
Rank =   78  Free Memory = 74145 MB
Rank =   79  Free Memory = 74145 MB
Rank =   80  Free Memory = 74145 MB
Rank =   81  Free Memory = 74145 MB
Rank =   82  Free Memory = 74145 MB
Rank =   83  Free Memory = 74145 MB
Rank =   84  Free Memory = 74145 MB
Rank =   85  Free Memory = 74145 MB
Rank =   86  Free Memory = 74145 MB
Rank =   87  Free Memory = 74145 MB
Rank =   88  Free Memory = 74145 MB
Rank =   89  Free Memory = 74145 MB
Rank =   90  Free Memory = 74145 MB
Rank =   91  Free Memory = 74145 MB
Rank =   92  Free Memory = 74145 MB
Rank =   93  Free Memory = 74145 MB
Rank =   94  Free Memory = 74145 MB
Rank =   95  Free Memory = 74145 MB
Rank =   96  Free Memory = 73102 MB
Rank =   97  Free Memory = 73102 MB
Rank =   98  Free Memory = 73102 MB
Rank =   99  Free Memory = 73102 MB
Rank =  100  Free Memory = 73102 MB
Rank =  101  Free Memory = 73102 MB
Rank =  102  Free Memory = 73102 MB
Rank =  103  Free Memory = 73102 MB
Rank =  104  Free Memory = 73102 MB
Rank =  105  Free Memory = 73102 MB
Rank =  106  Free Memory = 73102 MB
Rank =  107  Free Memory = 73102 MB
Rank =  108  Free Memory = 73102 MB
Rank =  109  Free Memory = 73102 MB
Rank =  110  Free Memory = 73102 MB
Rank =  111  Free Memory = 73102 MB
Rank =  112  Free Memory = 73102 MB
Rank =  113  Free Memory = 73102 MB
Rank =  114  Free Memory = 73102 MB
Rank =  115  Free Memory = 73102 MB
Rank =  116  Free Memory = 73102 MB
Rank =  117  Free Memory = 73102 MB
Rank =  118  Free Memory = 73102 MB
Rank =  119  Free Memory = 73102 MB
Rank =  120  Free Memory = 73102 MB
Rank =  121  Free Memory = 73102 MB
Rank =  122  Free Memory = 73102 MB
Rank =  123  Free Memory = 73102 MB
Rank =  124  Free Memory = 73102 MB
Rank =  125  Free Memory = 73102 MB
Rank =  126  Free Memory = 73102 MB
Rank =  127  Free Memory = 73102 MB
  Input file(s): opt_h2o_gs_lmtt_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001b.xml

  Project = H2O
  date    = 2023-03-02 15:48:16 PST
  host    = n0113.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 448

  Range of prime numbers to use as seeds over processors and threads = 3181-4219


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.738145e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.5563e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2061
    reference variance = 0.172378
====================================================
  Execution time = 2.1200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308368694757
                                         uncertainty =       0.004103993868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308368694757
                                         uncertainty =       0.004103993868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392771217
  error estimate for blocks of size 2^( 2) =       0.000403893866
  error estimate for blocks of size 2^( 3) =       0.000414304688
  error estimate for blocks of size 2^( 4) =       0.000421474821
  error estimate for blocks of size 2^( 5) =       0.000425705311
  error estimate for blocks of size 2^( 6) =       0.000427325961
  error estimate for blocks of size 2^( 7) =       0.000427356550

      target function =                  N/A
              le_mean =     -17.213835774240
             les_mean =     296.624680366110
             stat err =       0.000425465661
             autocorr =       1.173409822788
              std dev =       0.555462382044
             le_variance =       0.308538457866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721383577424e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213835774240       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214148356322       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214311751714       residual = 8.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214478354609       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214556011927       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214610822744       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214636302755       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214651173089       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214653729604       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214652015805       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214651068479       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214652174047       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214652254368       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.642306e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213835774240       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213972479247       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214040665345       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214115269255       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214147575024       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214165694848       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214168566290       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214170979840       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214171039869       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214171186146       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214170902788       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.273152e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213835774240       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213877828546       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213898903769       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213922995290       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213932623859       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213937169569       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213937842956       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213937973469       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213938037240       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213938069627       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213938041054       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.449306e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6877e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.925884e-01                 1 1 ON  0
uu_1  3.689188e-02                 1 1 ON  1
uu_2  -4.645151e-02                1 1 ON  2
uu_3  -9.439275e-02                1 1 ON  3
uu_4  -1.252612e-01                1 1 ON  4
uu_5  -1.325952e-01                1 1 ON  5
uu_6  -1.093101e-01                1 1 ON  6
uu_7  -3.340132e-02                1 1 ON  7
uu_8  1.030262e-01                 1 1 ON  8
uu_9  1.188641e-01                 1 1 ON  9
ud_0  3.197326e-01                 1 1 ON  10
ud_1  7.790192e-02                 1 1 ON  11
ud_2  -9.931765e-03                1 1 ON  12
ud_3  -5.806850e-02                1 1 ON  13
ud_4  -1.072392e-01                1 1 ON  14
ud_5  -1.489739e-01                1 1 ON  15
ud_6  -1.577065e-01                1 1 ON  16
ud_7  -1.080903e-01                1 1 ON  17
ud_8  9.573603e-03                 1 1 ON  18
ud_9  9.250220e-02                 1 1 ON  19
eO_0  -6.864425e-01                1 1 ON  20
eO_1  -4.051335e-01                1 1 ON  21
eO_2  -5.664610e-02                1 1 ON  22
eO_3  1.649629e-01                 1 1 ON  23
eO_4  2.643865e-01                 1 1 ON  24
eO_5  3.066354e-01                 1 1 ON  25
eO_6  2.482025e-01                 1 1 ON  26
eO_7  1.082517e-01                 1 1 ON  27
eO_8  2.729111e-02                 1 1 ON  28
eO_9  1.813448e-02                 1 1 ON  29
eH1_0 -1.760248e-01                1 1 ON  30
eH1_1 -9.841536e-02                1 1 ON  31
eH1_2 -6.248366e-02                1 1 ON  32
eH1_3 -2.849832e-02                1 1 ON  33
eH1_4 1.796486e-02                 1 1 ON  34
eH1_5 3.106452e-02                 1 1 ON  35
eH1_6 7.774935e-02                 1 1 ON  36
eH1_7 1.114365e-01                 1 1 ON  37
eH1_8 8.858237e-02                 1 1 ON  38
eH1_9 2.360112e-02                 1 1 ON  39
eH2_0 -1.777287e-01                1 1 ON  40
eH2_1 -1.002332e-01                1 1 ON  41
eH2_2 -6.454930e-02                1 1 ON  42
eH2_3 -2.998528e-02                1 1 ON  43
eH2_4 1.656772e-02                 1 1 ON  44
eH2_5 3.145777e-02                 1 1 ON  45
eH2_6 8.010185e-02                 1 1 ON  46
eH2_7 1.151953e-01                 1 1 ON  47
eH2_8 9.165465e-02                 1 1 ON  48
eH2_9 2.564344e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1778
    reference variance = 0.185624
====================================================
  Execution time = 2.0991e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1949e-01
  Total weights = 2.0000e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318100727814
                                         uncertainty =       0.010144206577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318100727814
                                         uncertainty =       0.010144206577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398736156
  error estimate for blocks of size 2^( 2) =       0.000409862398
  error estimate for blocks of size 2^( 3) =       0.000419479199
  error estimate for blocks of size 2^( 4) =       0.000426960567
  error estimate for blocks of size 2^( 5) =       0.000431113480
  error estimate for blocks of size 2^( 6) =       0.000432770948
  error estimate for blocks of size 2^( 7) =       0.000434514974

      target function =                  N/A
              le_mean =     -17.216045185811
             les_mean =     296.710192725715
             stat err =       0.000431339992
             autocorr =       1.170221885228
              std dev =       0.563898080173
             le_variance =       0.317981044823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323752576432
                                         uncertainty =       0.010514556180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323752576432
                                         uncertainty =       0.010514556180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402258638
  error estimate for blocks of size 2^( 2) =       0.000412416563
  error estimate for blocks of size 2^( 3) =       0.000421193283
  error estimate for blocks of size 2^( 4) =       0.000428244457
  error estimate for blocks of size 2^( 5) =       0.000432138765
  error estimate for blocks of size 2^( 6) =       0.000433731236
  error estimate for blocks of size 2^( 7) =       0.000435379700

      target function =                  N/A
              le_mean =     -17.216082609877
             les_mean =     296.717124291682
             stat err =       0.000432373539
             autocorr =       1.155333746010
              std dev =       0.568879621158
             le_variance =       0.323624023369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322179050387
                                         uncertainty =       0.010433607646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322179050387
                                         uncertainty =       0.010433607646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401280880
  error estimate for blocks of size 2^( 2) =       0.000411618359
  error estimate for blocks of size 2^( 3) =       0.000420552900
  error estimate for blocks of size 2^( 4) =       0.000427687908
  error estimate for blocks of size 2^( 5) =       0.000431633038
  error estimate for blocks of size 2^( 6) =       0.000433233458
  error estimate for blocks of size 2^( 7) =       0.000434920337

      target function =                  N/A
              le_mean =     -17.216032500869
             les_mean =     296.713827598860
             stat err =       0.000431868685
             autocorr =       1.158261165256
              std dev =       0.567496862464
             le_variance =       0.322052688906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318406664309
                                         uncertainty =       0.010184843891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318406664309
                                         uncertainty =       0.010184843891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398927332
  error estimate for blocks of size 2^( 2) =       0.000409920202
  error estimate for blocks of size 2^( 3) =       0.000419425273
  error estimate for blocks of size 2^( 4) =       0.000426849577
  error estimate for blocks of size 2^( 5) =       0.000430969374
  error estimate for blocks of size 2^( 6) =       0.000432615764
  error estimate for blocks of size 2^( 7) =       0.000434353329

      target function =                  N/A
              le_mean =     -17.216004652232
             les_mean =     296.709102059210
             stat err =       0.000431197011
             autocorr =       1.168325612375
              std dev =       0.564168443543
             le_variance =       0.318286032690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216045185811        initial
     2.5000e-01     2.5000e+00             1.6423e-02       -17.216082609877  <--
     1.0000e+00     1.0000e+01             5.2732e-03       -17.216032500869
     4.0000e+00     4.0000e+01             1.4493e-03       -17.216004652232

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0461e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.943895e-01 1 1  ON 0
 uu_1                 3.824899e-02 1 1  ON 1
 uu_2                -4.751261e-02 1 1  ON 2
 uu_3                -9.588727e-02 1 1  ON 3
 uu_4                -1.257034e-01 1 1  ON 4
 uu_5                -1.324091e-01 1 1  ON 5
 uu_6                -1.093998e-01 1 1  ON 6
 uu_7                -3.381169e-02 1 1  ON 7
 uu_8                 1.028563e-01 1 1  ON 8
 uu_9                 1.190303e-01 1 1  ON 9
 ud_0                 3.271518e-01 1 1  ON 10
 ud_1                 8.078551e-02 1 1  ON 11
 ud_2                -1.273507e-02 1 1  ON 12
 ud_3                -6.268165e-02 1 1  ON 13
 ud_4                -1.094916e-01 1 1  ON 14
 ud_5                -1.487988e-01 1 1  ON 15
 ud_6                -1.576697e-01 1 1  ON 16
 ud_7                -1.086220e-01 1 1  ON 17
 ud_8                 9.070504e-03 1 1  ON 18
 ud_9                 9.254264e-02 1 1  ON 19
 eO_0                -6.975925e-01 1 1  ON 20
 eO_1                -4.093340e-01 1 1  ON 21
 eO_2                -4.950304e-02 1 1  ON 22
 eO_3                 1.720363e-01 1 1  ON 23
 eO_4                 2.657407e-01 1 1  ON 24
 eO_5                 3.058971e-01 1 1  ON 25
 eO_6                 2.482559e-01 1 1  ON 26
 eO_7                 1.086299e-01 1 1  ON 27
 eO_8                 2.735136e-02 1 1  ON 28
 eO_9                 1.814970e-02 1 1  ON 29
eH1_0                -1.766859e-01 1 1  ON 30
eH1_1                -9.875964e-02 1 1  ON 31
eH1_2                -6.272529e-02 1 1  ON 32
eH1_3                -2.798219e-02 1 1  ON 33
eH1_4                 1.844838e-02 1 1  ON 34
eH1_5                 3.150364e-02 1 1  ON 35
eH1_6                 7.750215e-02 1 1  ON 36
eH1_7                 1.112578e-01 1 1  ON 37
eH1_8                 8.875122e-02 1 1  ON 38
eH1_9                 2.365442e-02 1 1  ON 39
eH2_0                -1.784269e-01 1 1  ON 40
eH2_1                -1.007527e-01 1 1  ON 41
eH2_2                -6.472842e-02 1 1  ON 42
eH2_3                -2.949154e-02 1 1  ON 43
eH2_4                 1.716738e-02 1 1  ON 44
eH2_5                 3.188178e-02 1 1  ON 45
eH2_6                 7.978085e-02 1 1  ON 46
eH2_7                 1.150620e-01 1 1  ON 47
eH2_8                 9.187994e-02 1 1  ON 48
eH2_9                 2.573411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7352e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1843
    reference variance = 0.243461
====================================================
  Execution time = 2.0861e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308257436148
                                         uncertainty =       0.002973345051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308257436148
                                         uncertainty =       0.002973345051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392585400
  error estimate for blocks of size 2^( 2) =       0.000403198404
  error estimate for blocks of size 2^( 3) =       0.000412635650
  error estimate for blocks of size 2^( 4) =       0.000419185149
  error estimate for blocks of size 2^( 5) =       0.000423769824
  error estimate for blocks of size 2^( 6) =       0.000428060092
  error estimate for blocks of size 2^( 7) =       0.000428459421

      target function =                  N/A
              le_mean =     -17.215465392973
             les_mean =     296.680495135202
             stat err =       0.000424868621
             autocorr =       1.171226866113
              std dev =       0.555199597145
             le_variance =       0.308246592670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721546539297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215465392973       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215550799325       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215623649229       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215706875123       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215781465699       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215828287476       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215869882373       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215875548500       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215878412236       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215884978616       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215889505828       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215891430324       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215890474974       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215891908890       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215892897584       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215892338340       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215892290935       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.780620e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215465392973       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215519811246       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215564041015       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215606363401       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215657175442       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215677641566       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215688872074       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215687052399       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215686829073       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215687491123       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215688629084       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215688310917       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.138521e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215465392973       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215487592362       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215505918223       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215520230139       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215540788447       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215547295935       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215548790709       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215547966943       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215547718621       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215547825863       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215547886091       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.582954e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6350e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.966374e-01 1 1  ON 0
 uu_1                 3.967145e-02 1 1  ON 1
 uu_2                -4.829431e-02 1 1  ON 2
 uu_3                -9.720468e-02 1 1  ON 3
 uu_4                -1.266022e-01 1 1  ON 4
 uu_5                -1.327069e-01 1 1  ON 5
 uu_6                -1.096341e-01 1 1  ON 6
 uu_7                -3.435058e-02 1 1  ON 7
 uu_8                 1.026288e-01 1 1  ON 8
 uu_9                 1.193295e-01 1 1  ON 9
 ud_0                 3.332671e-01 1 1  ON 10
 ud_1                 8.319191e-02 1 1  ON 11
 ud_2                -1.450198e-02 1 1  ON 12
 ud_3                -6.646776e-02 1 1  ON 13
 ud_4                -1.122157e-01 1 1  ON 14
 ud_5                -1.485745e-01 1 1  ON 15
 ud_6                -1.573765e-01 1 1  ON 16
 ud_7                -1.090873e-01 1 1  ON 17
 ud_8                 8.534278e-03 1 1  ON 18
 ud_9                 9.253054e-02 1 1  ON 19
 eO_0                -7.089777e-01 1 1  ON 20
 eO_1                -4.137511e-01 1 1  ON 21
 eO_2                -4.388476e-02 1 1  ON 22
 eO_3                 1.799197e-01 1 1  ON 23
 eO_4                 2.680294e-01 1 1  ON 24
 eO_5                 3.050546e-01 1 1  ON 25
 eO_6                 2.483942e-01 1 1  ON 26
 eO_7                 1.091955e-01 1 1  ON 27
 eO_8                 2.744557e-02 1 1  ON 28
 eO_9                 1.817846e-02 1 1  ON 29
eH1_0                -1.773245e-01 1 1  ON 30
eH1_1                -9.947402e-02 1 1  ON 31
eH1_2                -6.279540e-02 1 1  ON 32
eH1_3                -2.755633e-02 1 1  ON 33
eH1_4                 1.864670e-02 1 1  ON 34
eH1_5                 3.237042e-02 1 1  ON 35
eH1_6                 7.722665e-02 1 1  ON 36
eH1_7                 1.109825e-01 1 1  ON 37
eH1_8                 8.906085e-02 1 1  ON 38
eH1_9                 2.376641e-02 1 1  ON 39
eH2_0                -1.793341e-01 1 1  ON 40
eH2_1                -1.014434e-01 1 1  ON 41
eH2_2                -6.435941e-02 1 1  ON 42
eH2_3                -2.900532e-02 1 1  ON 43
eH2_4                 1.759453e-02 1 1  ON 44
eH2_5                 3.235500e-02 1 1  ON 45
eH2_6                 7.933056e-02 1 1  ON 46
eH2_7                 1.149264e-01 1 1  ON 47
eH2_8                 9.220333e-02 1 1  ON 48
eH2_9                 2.581817e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1392
    reference variance = 0.28107
====================================================
  Execution time = 2.0171e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1179e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307521413455
                                         uncertainty =       0.002652811580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307521413455
                                         uncertainty =       0.002652811580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392164476
  error estimate for blocks of size 2^( 2) =       0.000402481973
  error estimate for blocks of size 2^( 3) =       0.000412228135
  error estimate for blocks of size 2^( 4) =       0.000419343779
  error estimate for blocks of size 2^( 5) =       0.000424957383
  error estimate for blocks of size 2^( 6) =       0.000427119418
  error estimate for blocks of size 2^( 7) =       0.000428583571

      target function =                  N/A
              le_mean =     -17.216118655274
             les_mean =     296.702327350594
             stat err =       0.000425001038
             autocorr =       1.174474197662
              std dev =       0.554604320139
             le_variance =       0.307585951917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315811315910
                                         uncertainty =       0.002710351234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315811315910
                                         uncertainty =       0.002710351234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397418104
  error estimate for blocks of size 2^( 2) =       0.000407130444
  error estimate for blocks of size 2^( 3) =       0.000416349509
  error estimate for blocks of size 2^( 4) =       0.000423153250
  error estimate for blocks of size 2^( 5) =       0.000428659221
  error estimate for blocks of size 2^( 6) =       0.000430749770
  error estimate for blocks of size 2^( 7) =       0.000432328880

      target function =                  N/A
              le_mean =     -17.216087676150
             les_mean =     296.709557014132
             stat err =       0.000428722780
             autocorr =       1.163744994818
              std dev =       0.562034072966
             le_variance =       0.315882299175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317016969987
                                         uncertainty =       0.002722186507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317016969987
                                         uncertainty =       0.002722186507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398176145
  error estimate for blocks of size 2^( 2) =       0.000407870607
  error estimate for blocks of size 2^( 3) =       0.000417087095
  error estimate for blocks of size 2^( 4) =       0.000423895584
  error estimate for blocks of size 2^( 5) =       0.000429424274
  error estimate for blocks of size 2^( 6) =       0.000431500090
  error estimate for blocks of size 2^( 7) =       0.000433112630

      target function =                  N/A
              le_mean =     -17.216118248736
             les_mean =     296.711815881300
             stat err =       0.000429483144
             autocorr =       1.163434055380
              std dev =       0.563106104911
             le_variance =       0.317088485388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309059472409
                                         uncertainty =       0.002666834187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309059472409
                                         uncertainty =       0.002666834187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144587
  error estimate for blocks of size 2^( 2) =       0.000403318054
  error estimate for blocks of size 2^( 3) =       0.000412946903
  error estimate for blocks of size 2^( 4) =       0.000419996851
  error estimate for blocks of size 2^( 5) =       0.000425591740
  error estimate for blocks of size 2^( 6) =       0.000427731460
  error estimate for blocks of size 2^( 7) =       0.000429223628

      target function =                  N/A
              le_mean =     -17.216066200956
             les_mean =     296.702060613095
             stat err =       0.000425635920
             autocorr =       1.172119637914
              std dev =       0.555990406343
             le_variance =       0.309125331945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216118655274        initial  <--
     6.2500e-02     6.2500e-01             2.7806e-02       -17.216087676150
     2.5000e-01     2.5000e+00             1.1385e-02       -17.216118248736
     1.0000e+00     1.0000e+01             3.5830e-03       -17.216066200956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7267
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.943895e-01 1 1  ON 0
 uu_1                 3.824899e-02 1 1  ON 1
 uu_2                -4.751261e-02 1 1  ON 2
 uu_3                -9.588727e-02 1 1  ON 3
 uu_4                -1.257034e-01 1 1  ON 4
 uu_5                -1.324091e-01 1 1  ON 5
 uu_6                -1.093998e-01 1 1  ON 6
 uu_7                -3.381169e-02 1 1  ON 7
 uu_8                 1.028563e-01 1 1  ON 8
 uu_9                 1.190303e-01 1 1  ON 9
 ud_0                 3.271518e-01 1 1  ON 10
 ud_1                 8.078551e-02 1 1  ON 11
 ud_2                -1.273507e-02 1 1  ON 12
 ud_3                -6.268165e-02 1 1  ON 13
 ud_4                -1.094916e-01 1 1  ON 14
 ud_5                -1.487988e-01 1 1  ON 15
 ud_6                -1.576697e-01 1 1  ON 16
 ud_7                -1.086220e-01 1 1  ON 17
 ud_8                 9.070504e-03 1 1  ON 18
 ud_9                 9.254264e-02 1 1  ON 19
 eO_0                -6.975925e-01 1 1  ON 20
 eO_1                -4.093340e-01 1 1  ON 21
 eO_2                -4.950304e-02 1 1  ON 22
 eO_3                 1.720363e-01 1 1  ON 23
 eO_4                 2.657407e-01 1 1  ON 24
 eO_5                 3.058971e-01 1 1  ON 25
 eO_6                 2.482559e-01 1 1  ON 26
 eO_7                 1.086299e-01 1 1  ON 27
 eO_8                 2.735136e-02 1 1  ON 28
 eO_9                 1.814970e-02 1 1  ON 29
eH1_0                -1.766859e-01 1 1  ON 30
eH1_1                -9.875964e-02 1 1  ON 31
eH1_2                -6.272529e-02 1 1  ON 32
eH1_3                -2.798219e-02 1 1  ON 33
eH1_4                 1.844838e-02 1 1  ON 34
eH1_5                 3.150364e-02 1 1  ON 35
eH1_6                 7.750215e-02 1 1  ON 36
eH1_7                 1.112578e-01 1 1  ON 37
eH1_8                 8.875122e-02 1 1  ON 38
eH1_9                 2.365442e-02 1 1  ON 39
eH2_0                -1.784269e-01 1 1  ON 40
eH2_1                -1.007527e-01 1 1  ON 41
eH2_2                -6.472842e-02 1 1  ON 42
eH2_3                -2.949154e-02 1 1  ON 43
eH2_4                 1.716738e-02 1 1  ON 44
eH2_5                 3.188178e-02 1 1  ON 45
eH2_6                 7.978085e-02 1 1  ON 46
eH2_7                 1.150620e-01 1 1  ON 47
eH2_8                 9.187994e-02 1 1  ON 48
eH2_9                 2.573411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7177e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.184771
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1356e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313613066413
                                         uncertainty =       0.003382068645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313613066413
                                         uncertainty =       0.003382068645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395952552
  error estimate for blocks of size 2^( 2) =       0.000406201969
  error estimate for blocks of size 2^( 3) =       0.000415113872
  error estimate for blocks of size 2^( 4) =       0.000422029669
  error estimate for blocks of size 2^( 5) =       0.000426784871
  error estimate for blocks of size 2^( 6) =       0.000428890606
  error estimate for blocks of size 2^( 7) =       0.000431473442

      target function =                  N/A
              le_mean =     -17.214962470342
             les_mean =     296.668489546016
             stat err =       0.000427294647
             autocorr =       1.164578077252
              std dev =       0.559961469681
             le_variance =       0.313556847527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721496247034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214962470342       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215008510229       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215038958285       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215063070353       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215082330253       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215091089828       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215095704949       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215095893682       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215095629587       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215095815479       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215095713795       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.226036e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214962470342       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214977311117       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214987671900       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214994970879       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215000730620       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215003275902       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215003913248       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215003841778       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215003812838       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215003819056       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.466525e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214962470342       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214966469883       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214969331367       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214971281363       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214972769417       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214973420720       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214973544746       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214973521964       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214973515805       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214973517034       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.790951e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6097e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.946190e-01 1 1  ON 0
 uu_1                 3.849212e-02 1 1  ON 1
 uu_2                -4.766756e-02 1 1  ON 2
 uu_3                -9.602740e-02 1 1  ON 3
 uu_4                -1.257495e-01 1 1  ON 4
 uu_5                -1.323680e-01 1 1  ON 5
 uu_6                -1.094939e-01 1 1  ON 6
 uu_7                -3.392010e-02 1 1  ON 7
 uu_8                 1.028179e-01 1 1  ON 8
 uu_9                 1.190542e-01 1 1  ON 9
 ud_0                 3.282372e-01 1 1  ON 10
 ud_1                 8.118652e-02 1 1  ON 11
 ud_2                -1.316267e-02 1 1  ON 12
 ud_3                -6.328846e-02 1 1  ON 13
 ud_4                -1.098106e-01 1 1  ON 14
 ud_5                -1.487103e-01 1 1  ON 15
 ud_6                -1.577150e-01 1 1  ON 16
 ud_7                -1.087601e-01 1 1  ON 17
 ud_8                 8.994077e-03 1 1  ON 18
 ud_9                 9.254447e-02 1 1  ON 19
 eO_0                -6.990590e-01 1 1  ON 20
 eO_1                -4.098717e-01 1 1  ON 21
 eO_2                -4.852293e-02 1 1  ON 22
 eO_3                 1.729705e-01 1 1  ON 23
 eO_4                 2.659099e-01 1 1  ON 24
 eO_5                 3.057778e-01 1 1  ON 25
 eO_6                 2.482384e-01 1 1  ON 26
 eO_7                 1.086691e-01 1 1  ON 27
 eO_8                 2.735826e-02 1 1  ON 28
 eO_9                 1.815490e-02 1 1  ON 29
eH1_0                -1.767784e-01 1 1  ON 30
eH1_1                -9.882078e-02 1 1  ON 31
eH1_2                -6.275414e-02 1 1  ON 32
eH1_3                -2.788211e-02 1 1  ON 33
eH1_4                 1.853220e-02 1 1  ON 34
eH1_5                 3.156632e-02 1 1  ON 35
eH1_6                 7.743260e-02 1 1  ON 36
eH1_7                 1.112219e-01 1 1  ON 37
eH1_8                 8.877622e-02 1 1  ON 38
eH1_9                 2.366226e-02 1 1  ON 39
eH2_0                -1.785323e-01 1 1  ON 40
eH2_1                -1.007680e-01 1 1  ON 41
eH2_2                -6.473160e-02 1 1  ON 42
eH2_3                -2.943079e-02 1 1  ON 43
eH2_4                 1.722550e-02 1 1  ON 44
eH2_5                 3.193625e-02 1 1  ON 45
eH2_6                 7.972874e-02 1 1  ON 46
eH2_7                 1.150252e-01 1 1  ON 47
eH2_8                 9.190754e-02 1 1  ON 48
eH2_9                 2.574295e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2143
    reference variance = 0.160149
====================================================
  Execution time = 2.0894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1640e-01
  Total weights = 2.0000e+06
  Execution time = 1.8664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315687025532
                                         uncertainty =       0.006219426160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315687025532
                                         uncertainty =       0.006219426160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397280355
  error estimate for blocks of size 2^( 2) =       0.000408000740
  error estimate for blocks of size 2^( 3) =       0.000416934096
  error estimate for blocks of size 2^( 4) =       0.000423285424
  error estimate for blocks of size 2^( 5) =       0.000427991160
  error estimate for blocks of size 2^( 6) =       0.000429076067
  error estimate for blocks of size 2^( 7) =       0.000431465903

      target function =                  N/A
              le_mean =     -17.215197857633
             les_mean =     296.678700479832
             stat err =       0.000427954639
             autocorr =       1.160382836491
              std dev =       0.561839265446
             le_variance =       0.315663360196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318091849321
                                         uncertainty =       0.006289062382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318091849321
                                         uncertainty =       0.006289062382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398790849
  error estimate for blocks of size 2^( 2) =       0.000409313709
  error estimate for blocks of size 2^( 3) =       0.000418100807
  error estimate for blocks of size 2^( 4) =       0.000424332887
  error estimate for blocks of size 2^( 5) =       0.000428965465
  error estimate for blocks of size 2^( 6) =       0.000430026712
  error estimate for blocks of size 2^( 7) =       0.000432477935

      target function =                  N/A
              le_mean =     -17.215201603558
             les_mean =     296.681234374591
             stat err =       0.000428950750
             autocorr =       1.156976384348
              std dev =       0.563975427203
             le_variance =       0.318068282489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317200993668
                                         uncertainty =       0.006263850974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317200993668
                                         uncertainty =       0.006263850974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398231959
  error estimate for blocks of size 2^( 2) =       0.000408826235
  error estimate for blocks of size 2^( 3) =       0.000417667355
  error estimate for blocks of size 2^( 4) =       0.000423943748
  error estimate for blocks of size 2^( 5) =       0.000428601197
  error estimate for blocks of size 2^( 6) =       0.000429673569
  error estimate for blocks of size 2^( 7) =       0.000432106130

      target function =                  N/A
              le_mean =     -17.215192710939
             les_mean =     296.680037301897
             stat err =       0.000428581161
             autocorr =       1.158227664574
              std dev =       0.563185036842
             le_variance =       0.317177385723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315883228854
                                         uncertainty =       0.006225417274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315883228854
                                         uncertainty =       0.006225417274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397403807
  error estimate for blocks of size 2^( 2) =       0.000408106669
  error estimate for blocks of size 2^( 3) =       0.000417027268
  error estimate for blocks of size 2^( 4) =       0.000423368346
  error estimate for blocks of size 2^( 5) =       0.000428067411
  error estimate for blocks of size 2^( 6) =       0.000429150697
  error estimate for blocks of size 2^( 7) =       0.000431546474

      target function =                  N/A
              le_mean =     -17.215195717183
             les_mean =     296.678822994410
             stat err =       0.000428033232
             autocorr =       1.160087989729
              std dev =       0.562013853406
             le_variance =       0.315859571420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215197857633        initial
     6.2500e-01     6.2500e+00             5.2260e-03       -17.215201603558  <--
     2.5000e+00     2.5000e+01             1.4665e-03       -17.215192710939
     1.0000e+01     1.0000e+02             3.7910e-04       -17.215195717183

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0320e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.953326e-01 1 1  ON 0
 uu_1                 3.901191e-02 1 1  ON 1
 uu_2                -4.792574e-02 1 1  ON 2
 uu_3                -9.641350e-02 1 1  ON 3
 uu_4                -1.259675e-01 1 1  ON 4
 uu_5                -1.323146e-01 1 1  ON 5
 uu_6                -1.097195e-01 1 1  ON 6
 uu_7                -3.421863e-02 1 1  ON 7
 uu_8                 1.027073e-01 1 1  ON 8
 uu_9                 1.191280e-01 1 1  ON 9
 ud_0                 3.306203e-01 1 1  ON 10
 ud_1                 8.207055e-02 1 1  ON 11
 ud_2                -1.388945e-02 1 1  ON 12
 ud_3                -6.468652e-02 1 1  ON 13
 ud_4                -1.106803e-01 1 1  ON 14
 ud_5                -1.485302e-01 1 1  ON 15
 ud_6                -1.577192e-01 1 1  ON 16
 ud_7                -1.091103e-01 1 1  ON 17
 ud_8                 8.776009e-03 1 1  ON 18
 ud_9                 9.255224e-02 1 1  ON 19
 eO_0                -7.028185e-01 1 1  ON 20
 eO_1                -4.113026e-01 1 1  ON 21
 eO_2                -4.645259e-02 1 1  ON 22
 eO_3                 1.755394e-01 1 1  ON 23
 eO_4                 2.665879e-01 1 1  ON 24
 eO_5                 3.055036e-01 1 1  ON 25
 eO_6                 2.482059e-01 1 1  ON 26
 eO_7                 1.087924e-01 1 1  ON 27
 eO_8                 2.737997e-02 1 1  ON 28
 eO_9                 1.817084e-02 1 1  ON 29
eH1_0                -1.770548e-01 1 1  ON 30
eH1_1                -9.904255e-02 1 1  ON 31
eH1_2                -6.276144e-02 1 1  ON 32
eH1_3                -2.766523e-02 1 1  ON 33
eH1_4                 1.872301e-02 1 1  ON 34
eH1_5                 3.179249e-02 1 1  ON 35
eH1_6                 7.727210e-02 1 1  ON 36
eH1_7                 1.111258e-01 1 1  ON 37
eH1_8                 8.885423e-02 1 1  ON 38
eH1_9                 2.368653e-02 1 1  ON 39
eH2_0                -1.788327e-01 1 1  ON 40
eH2_1                -1.008878e-01 1 1  ON 41
eH2_2                -6.468500e-02 1 1  ON 42
eH2_3                -2.928807e-02 1 1  ON 43
eH2_4                 1.734308e-02 1 1  ON 44
eH2_5                 3.213435e-02 1 1  ON 45
eH2_6                 7.961954e-02 1 1  ON 46
eH2_7                 1.149272e-01 1 1  ON 47
eH2_8                 9.199363e-02 1 1  ON 48
eH2_9                 2.577015e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3326
    reference variance = 0.281094
====================================================
  Execution time = 2.0593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1723e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317342001235
                                         uncertainty =       0.005254424956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317342001235
                                         uncertainty =       0.005254424956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398262944
  error estimate for blocks of size 2^( 2) =       0.000408727855
  error estimate for blocks of size 2^( 3) =       0.000417807063
  error estimate for blocks of size 2^( 4) =       0.000424026878
  error estimate for blocks of size 2^( 5) =       0.000428189365
  error estimate for blocks of size 2^( 6) =       0.000429531674
  error estimate for blocks of size 2^( 7) =       0.000431483840

      target function =                  N/A
              le_mean =     -17.215948213971
             les_mean =     296.706099492177
             stat err =       0.000428307939
             autocorr =       1.156571403811
              std dev =       0.563228856389
             le_variance =       0.317226744669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721594821397e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948213971       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215967587565       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215995992227       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216036000355       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216049924830       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216073920485       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216087342365       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216086055232       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216084461399       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216087430122       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216087852337       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216087817655       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216088055650       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.369221e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948213971       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215957054807       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215969119563       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215983906216       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215991621335       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215999036881       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216002049077       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216001065720       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216000619229       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216000967620       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216000925270       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.592519e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948213971       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215950998778       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215954751902       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215958917863       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215961256912       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215963227636       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215963877277       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215963647593       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215963562738       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215963600556       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.281007e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6193e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.962774e-01 1 1  ON 0
 uu_1                 3.951010e-02 1 1  ON 1
 uu_2                -4.818278e-02 1 1  ON 2
 uu_3                -9.699160e-02 1 1  ON 3
 uu_4                -1.263379e-01 1 1  ON 4
 uu_5                -1.323945e-01 1 1  ON 5
 uu_6                -1.097583e-01 1 1  ON 6
 uu_7                -3.441668e-02 1 1  ON 7
 uu_8                 1.025850e-01 1 1  ON 8
 uu_9                 1.192228e-01 1 1  ON 9
 ud_0                 3.329770e-01 1 1  ON 10
 ud_1                 8.304582e-02 1 1  ON 11
 ud_2                -1.457591e-02 1 1  ON 12
 ud_3                -6.631959e-02 1 1  ON 13
 ud_4                -1.117363e-01 1 1  ON 14
 ud_5                -1.483876e-01 1 1  ON 15
 ud_6                -1.574931e-01 1 1  ON 16
 ud_7                -1.093307e-01 1 1  ON 17
 ud_8                 8.566412e-03 1 1  ON 18
 ud_9                 9.256739e-02 1 1  ON 19
 eO_0                -7.074110e-01 1 1  ON 20
 eO_1                -4.130908e-01 1 1  ON 21
 eO_2                -4.422026e-02 1 1  ON 22
 eO_3                 1.786319e-01 1 1  ON 23
 eO_4                 2.675354e-01 1 1  ON 24
 eO_5                 3.052272e-01 1 1  ON 25
 eO_6                 2.483083e-01 1 1  ON 26
 eO_7                 1.090131e-01 1 1  ON 27
 eO_8                 2.742090e-02 1 1  ON 28
 eO_9                 1.818462e-02 1 1  ON 29
eH1_0                -1.773427e-01 1 1  ON 30
eH1_1                -9.938920e-02 1 1  ON 31
eH1_2                -6.280772e-02 1 1  ON 32
eH1_3                -2.749776e-02 1 1  ON 33
eH1_4                 1.882160e-02 1 1  ON 34
eH1_5                 3.214014e-02 1 1  ON 35
eH1_6                 7.720355e-02 1 1  ON 36
eH1_7                 1.110739e-01 1 1  ON 37
eH1_8                 8.898358e-02 1 1  ON 38
eH1_9                 2.373004e-02 1 1  ON 39
eH2_0                -1.790431e-01 1 1  ON 40
eH2_1                -1.011812e-01 1 1  ON 41
eH2_2                -6.452855e-02 1 1  ON 42
eH2_3                -2.900212e-02 1 1  ON 43
eH2_4                 1.749630e-02 1 1  ON 44
eH2_5                 3.230383e-02 1 1  ON 45
eH2_6                 7.939423e-02 1 1  ON 46
eH2_7                 1.147896e-01 1 1  ON 47
eH2_8                 9.206342e-02 1 1  ON 48
eH2_9                 2.578893e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2592
    reference variance = 0.262787
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1422e-01
  Total weights = 2.0000e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312429259830
                                         uncertainty =       0.003413793629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312429259830
                                         uncertainty =       0.003413793629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395258985
  error estimate for blocks of size 2^( 2) =       0.000405460089
  error estimate for blocks of size 2^( 3) =       0.000414881843
  error estimate for blocks of size 2^( 4) =       0.000421850441
  error estimate for blocks of size 2^( 5) =       0.000426369132
  error estimate for blocks of size 2^( 6) =       0.000427862745
  error estimate for blocks of size 2^( 7) =       0.000429632071

      target function =                  N/A
              le_mean =     -17.215814863932
             les_mean =     296.696740603266
             stat err =       0.000426428597
             autocorr =       1.163936108747
              std dev =       0.558980617106
             le_variance =       0.312459330300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316794500447
                                         uncertainty =       0.003466743875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316794500447
                                         uncertainty =       0.003466743875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398009726
  error estimate for blocks of size 2^( 2) =       0.000407902138
  error estimate for blocks of size 2^( 3) =       0.000417058985
  error estimate for blocks of size 2^( 4) =       0.000423848574
  error estimate for blocks of size 2^( 5) =       0.000428243808
  error estimate for blocks of size 2^( 6) =       0.000429745551
  error estimate for blocks of size 2^( 7) =       0.000431606400

      target function =                  N/A
              le_mean =     -17.215843963432
             les_mean =     296.702106698193
             stat err =       0.000428361083
             autocorr =       1.158330914114
              std dev =       0.562870751918
             le_variance =       0.316823483365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316114731906
                                         uncertainty =       0.003459122553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316114731906
                                         uncertainty =       0.003459122553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397582597
  error estimate for blocks of size 2^( 2) =       0.000407531031
  error estimate for blocks of size 2^( 3) =       0.000416737756
  error estimate for blocks of size 2^( 4) =       0.000423559223
  error estimate for blocks of size 2^( 5) =       0.000427969854
  error estimate for blocks of size 2^( 6) =       0.000429481728
  error estimate for blocks of size 2^( 7) =       0.000431336380

      target function =                  N/A
              le_mean =     -17.215832105383
             les_mean =     296.701018766147
             stat err =       0.000428086796
             autocorr =       1.159334960101
              std dev =       0.562266701380
             le_variance =       0.316143843481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312960842264
                                         uncertainty =       0.003420882029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312960842264
                                         uncertainty =       0.003420882029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395594967
  error estimate for blocks of size 2^( 2) =       0.000405753955
  error estimate for blocks of size 2^( 3) =       0.000415140318
  error estimate for blocks of size 2^( 4) =       0.000422084774
  error estimate for blocks of size 2^( 5) =       0.000426585667
  error estimate for blocks of size 2^( 6) =       0.000428082165
  error estimate for blocks of size 2^( 7) =       0.000429864753

      target function =                  N/A
              le_mean =     -17.215810321348
             les_mean =     296.697115620675
             stat err =       0.000426654340
             autocorr =       1.163190425308
              std dev =       0.559455768176
             le_variance =       0.312990756545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215814863932        initial
     1.5625e-01     1.5625e+00             1.3692e-02       -17.215843963432  <--
     6.2500e-01     6.2500e+00             4.5925e-03       -17.215832105383
     2.5000e+00     2.5000e+01             1.2810e-03       -17.215810321348

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9683e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.983904e-01 1 1  ON 0
 uu_1                 4.057206e-02 1 1  ON 1
 uu_2                -4.828179e-02 1 1  ON 2
 uu_3                -9.796720e-02 1 1  ON 3
 uu_4                -1.275100e-01 1 1  ON 4
 uu_5                -1.330119e-01 1 1  ON 5
 uu_6                -1.098647e-01 1 1  ON 6
 uu_7                -3.489502e-02 1 1  ON 7
 uu_8                 1.022604e-01 1 1  ON 8
 uu_9                 1.195066e-01 1 1  ON 9
 ud_0                 3.363510e-01 1 1  ON 10
 ud_1                 8.465543e-02 1 1  ON 11
 ud_2                -1.507046e-02 1 1  ON 12
 ud_3                -6.852423e-02 1 1  ON 13
 ud_4                -1.138958e-01 1 1  ON 14
 ud_5                -1.487445e-01 1 1  ON 15
 ud_6                -1.567241e-01 1 1  ON 16
 ud_7                -1.096633e-01 1 1  ON 17
 ud_8                 8.039724e-03 1 1  ON 18
 ud_9                 9.262426e-02 1 1  ON 19
 eO_0                -7.165107e-01 1 1  ON 20
 eO_1                -4.172591e-01 1 1  ON 21
 eO_2                -4.174987e-02 1 1  ON 22
 eO_3                 1.849708e-01 1 1  ON 23
 eO_4                 2.710663e-01 1 1  ON 24
 eO_5                 3.049309e-01 1 1  ON 25
 eO_6                 2.486826e-01 1 1  ON 26
 eO_7                 1.096768e-01 1 1  ON 27
 eO_8                 2.754523e-02 1 1  ON 28
 eO_9                 1.822570e-02 1 1  ON 29
eH1_0                -1.781363e-01 1 1  ON 30
eH1_1                -1.002529e-01 1 1  ON 31
eH1_2                -6.277718e-02 1 1  ON 32
eH1_3                -2.735244e-02 1 1  ON 33
eH1_4                 1.882188e-02 1 1  ON 34
eH1_5                 3.304751e-02 1 1  ON 35
eH1_6                 7.729248e-02 1 1  ON 36
eH1_7                 1.109958e-01 1 1  ON 37
eH1_8                 8.937298e-02 1 1  ON 38
eH1_9                 2.385982e-02 1 1  ON 39
eH2_0                -1.795679e-01 1 1  ON 40
eH2_1                -1.017831e-01 1 1  ON 41
eH2_2                -6.409849e-02 1 1  ON 42
eH2_3                -2.855542e-02 1 1  ON 43
eH2_4                 1.766442e-02 1 1  ON 44
eH2_5                 3.280374e-02 1 1  ON 45
eH2_6                 7.901326e-02 1 1  ON 46
eH2_7                 1.144461e-01 1 1  ON 47
eH2_8                 9.227447e-02 1 1  ON 48
eH2_9                 2.584613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2365
    reference variance = 0.330388
====================================================
  Execution time = 2.2317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1266e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312701322642
                                         uncertainty =       0.003353056090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312701322642
                                         uncertainty =       0.003353056090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395384818
  error estimate for blocks of size 2^( 2) =       0.000405367250
  error estimate for blocks of size 2^( 3) =       0.000414606150
  error estimate for blocks of size 2^( 4) =       0.000420876704
  error estimate for blocks of size 2^( 5) =       0.000425135434
  error estimate for blocks of size 2^( 6) =       0.000428158539
  error estimate for blocks of size 2^( 7) =       0.000429729760

      target function =                  N/A
              le_mean =     -17.215899831955
             les_mean =     296.699865175485
             stat err =       0.000425975110
             autocorr =       1.160722676107
              std dev =       0.559158571339
             le_variance =       0.312658307902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589983196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899831955       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215912903042       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215938788124       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215967818387       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215976743019       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215976401787       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215972453253       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215989790064       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216003944409       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216010926613       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216012267998       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216012500998       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216012165942       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216012288871       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216011508039       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216013117366       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216012908200       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.084711e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899831955       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215908358006       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215925529409       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215942634434       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215944624313       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215939429003       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215940283600       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215946066960       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215949936956       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215950260867       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215949797010       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215950049752       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215949713557       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.422237e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215899831955       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215903398042       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215910879122       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215916714753       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215917201349       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215915763833       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215914791735       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215916185675       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215916765347       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215916723477       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215916735513       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.660672e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7856e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.007242e-01 1 1  ON 0
 uu_1                 4.195312e-02 1 1  ON 1
 uu_2                -4.797137e-02 1 1  ON 2
 uu_3                -9.856686e-02 1 1  ON 3
 uu_4                -1.285895e-01 1 1  ON 4
 uu_5                -1.337792e-01 1 1  ON 5
 uu_6                -1.107822e-01 1 1  ON 6
 uu_7                -3.597439e-02 1 1  ON 7
 uu_8                 1.017616e-01 1 1  ON 8
 uu_9                 1.198879e-01 1 1  ON 9
 ud_0                 3.395804e-01 1 1  ON 10
 ud_1                 8.600493e-02 1 1  ON 11
 ud_2                -1.507789e-02 1 1  ON 12
 ud_3                -7.001787e-02 1 1  ON 13
 ud_4                -1.159246e-01 1 1  ON 14
 ud_5                -1.495820e-01 1 1  ON 15
 ud_6                -1.560908e-01 1 1  ON 16
 ud_7                -1.101991e-01 1 1  ON 17
 ud_8                 7.256450e-03 1 1  ON 18
 ud_9                 9.264238e-02 1 1  ON 19
 eO_0                -7.249329e-01 1 1  ON 20
 eO_1                -4.217893e-01 1 1  ON 21
 eO_2                -4.060805e-02 1 1  ON 22
 eO_3                 1.911409e-01 1 1  ON 23
 eO_4                 2.756274e-01 1 1  ON 24
 eO_5                 3.047527e-01 1 1  ON 25
 eO_6                 2.490363e-01 1 1  ON 26
 eO_7                 1.103219e-01 1 1  ON 27
 eO_8                 2.768208e-02 1 1  ON 28
 eO_9                 1.827319e-02 1 1  ON 29
eH1_0                -1.790783e-01 1 1  ON 30
eH1_1                -1.012400e-01 1 1  ON 31
eH1_2                -6.289921e-02 1 1  ON 32
eH1_3                -2.726892e-02 1 1  ON 33
eH1_4                 1.901040e-02 1 1  ON 34
eH1_5                 3.407534e-02 1 1  ON 35
eH1_6                 7.748595e-02 1 1  ON 36
eH1_7                 1.109449e-01 1 1  ON 37
eH1_8                 8.982569e-02 1 1  ON 38
eH1_9                 2.397087e-02 1 1  ON 39
eH2_0                -1.800664e-01 1 1  ON 40
eH2_1                -1.023510e-01 1 1  ON 41
eH2_2                -6.387407e-02 1 1  ON 42
eH2_3                -2.845313e-02 1 1  ON 43
eH2_4                 1.783974e-02 1 1  ON 44
eH2_5                 3.338636e-02 1 1  ON 45
eH2_6                 7.874122e-02 1 1  ON 46
eH2_7                 1.141669e-01 1 1  ON 47
eH2_8                 9.260446e-02 1 1  ON 48
eH2_9                 2.597481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2171
    reference variance = 0.393594
====================================================
  Execution time = 2.0383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314296972653
                                         uncertainty =       0.004237481040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314296972653
                                         uncertainty =       0.004237481040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396615144
  error estimate for blocks of size 2^( 2) =       0.000406827034
  error estimate for blocks of size 2^( 3) =       0.000415785364
  error estimate for blocks of size 2^( 4) =       0.000422809681
  error estimate for blocks of size 2^( 5) =       0.000426937735
  error estimate for blocks of size 2^( 6) =       0.000428426240
  error estimate for blocks of size 2^( 7) =       0.000428945252

      target function =                  N/A
              le_mean =     -17.215816468554
             les_mean =     296.698943666949
             stat err =       0.000426779727
             autocorr =       1.157894460638
              std dev =       0.560898516063
             le_variance =       0.314607145321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318936236469
                                         uncertainty =       0.004262670587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318936236469
                                         uncertainty =       0.004262670587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399532985
  error estimate for blocks of size 2^( 2) =       0.000409526279
  error estimate for blocks of size 2^( 3) =       0.000418283081
  error estimate for blocks of size 2^( 4) =       0.000425094006
  error estimate for blocks of size 2^( 5) =       0.000429157504
  error estimate for blocks of size 2^( 6) =       0.000430611903
  error estimate for blocks of size 2^( 7) =       0.000431126594

      target function =                  N/A
              le_mean =     -17.215803533579
             les_mean =     296.703144359806
             stat err =       0.000428997502
             autocorr =       1.152933466896
              std dev =       0.565024966401
             le_variance =       0.319253212656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577835955
                                         uncertainty =       0.004274476339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577835955
                                         uncertainty =       0.004274476339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399935000
  error estimate for blocks of size 2^( 2) =       0.000409920210
  error estimate for blocks of size 2^( 3) =       0.000418679078
  error estimate for blocks of size 2^( 4) =       0.000425492638
  error estimate for blocks of size 2^( 5) =       0.000429549288
  error estimate for blocks of size 2^( 6) =       0.000430996254
  error estimate for blocks of size 2^( 7) =       0.000431537738

      target function =                  N/A
              le_mean =     -17.215798288249
             les_mean =     296.703606549894
             stat err =       0.000429393979
             autocorr =       1.152744547319
              std dev =       0.565593500825
             le_variance =       0.319896008176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315360001178
                                         uncertainty =       0.004246568423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315360001178
                                         uncertainty =       0.004246568423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397285712
  error estimate for blocks of size 2^( 2) =       0.000407446920
  error estimate for blocks of size 2^( 3) =       0.000416362331
  error estimate for blocks of size 2^( 4) =       0.000423344151
  error estimate for blocks of size 2^( 5) =       0.000427454985
  error estimate for blocks of size 2^( 6) =       0.000428932201
  error estimate for blocks of size 2^( 7) =       0.000429459230

      target function =                  N/A
              le_mean =     -17.215800917164
             les_mean =     296.699472934804
             stat err =       0.000427297642
             autocorr =       1.156791530080
              std dev =       0.561846841435
             le_variance =       0.315671873230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215816468554        initial  <--
     3.9062e-02     3.9062e-01             2.0847e-02       -17.215803533579
     1.5625e-01     1.5625e+00             8.4222e-03       -17.215798288249
     6.2500e-01     6.2500e+00             2.6607e-03       -17.215800917164

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6647
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.983904e-01 1 1  ON 0
 uu_1                 4.057206e-02 1 1  ON 1
 uu_2                -4.828179e-02 1 1  ON 2
 uu_3                -9.796720e-02 1 1  ON 3
 uu_4                -1.275100e-01 1 1  ON 4
 uu_5                -1.330119e-01 1 1  ON 5
 uu_6                -1.098647e-01 1 1  ON 6
 uu_7                -3.489502e-02 1 1  ON 7
 uu_8                 1.022604e-01 1 1  ON 8
 uu_9                 1.195066e-01 1 1  ON 9
 ud_0                 3.363510e-01 1 1  ON 10
 ud_1                 8.465543e-02 1 1  ON 11
 ud_2                -1.507046e-02 1 1  ON 12
 ud_3                -6.852423e-02 1 1  ON 13
 ud_4                -1.138958e-01 1 1  ON 14
 ud_5                -1.487445e-01 1 1  ON 15
 ud_6                -1.567241e-01 1 1  ON 16
 ud_7                -1.096633e-01 1 1  ON 17
 ud_8                 8.039724e-03 1 1  ON 18
 ud_9                 9.262426e-02 1 1  ON 19
 eO_0                -7.165107e-01 1 1  ON 20
 eO_1                -4.172591e-01 1 1  ON 21
 eO_2                -4.174987e-02 1 1  ON 22
 eO_3                 1.849708e-01 1 1  ON 23
 eO_4                 2.710663e-01 1 1  ON 24
 eO_5                 3.049309e-01 1 1  ON 25
 eO_6                 2.486826e-01 1 1  ON 26
 eO_7                 1.096768e-01 1 1  ON 27
 eO_8                 2.754523e-02 1 1  ON 28
 eO_9                 1.822570e-02 1 1  ON 29
eH1_0                -1.781363e-01 1 1  ON 30
eH1_1                -1.002529e-01 1 1  ON 31
eH1_2                -6.277718e-02 1 1  ON 32
eH1_3                -2.735244e-02 1 1  ON 33
eH1_4                 1.882188e-02 1 1  ON 34
eH1_5                 3.304751e-02 1 1  ON 35
eH1_6                 7.729248e-02 1 1  ON 36
eH1_7                 1.109958e-01 1 1  ON 37
eH1_8                 8.937298e-02 1 1  ON 38
eH1_9                 2.385982e-02 1 1  ON 39
eH2_0                -1.795679e-01 1 1  ON 40
eH2_1                -1.017831e-01 1 1  ON 41
eH2_2                -6.409849e-02 1 1  ON 42
eH2_3                -2.855542e-02 1 1  ON 43
eH2_4                 1.766442e-02 1 1  ON 44
eH2_5                 3.280374e-02 1 1  ON 45
eH2_6                 7.901326e-02 1 1  ON 46
eH2_7                 1.144461e-01 1 1  ON 47
eH2_8                 9.227447e-02 1 1  ON 48
eH2_9                 2.584613e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7526e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1722
    reference variance = 0.13918
====================================================
  Execution time = 2.0338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0864e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308649813564
                                         uncertainty =       0.003062891096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308649813564
                                         uncertainty =       0.003062891096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392838603
  error estimate for blocks of size 2^( 2) =       0.000402794998
  error estimate for blocks of size 2^( 3) =       0.000411544752
  error estimate for blocks of size 2^( 4) =       0.000418332405
  error estimate for blocks of size 2^( 5) =       0.000422116425
  error estimate for blocks of size 2^( 6) =       0.000423888347
  error estimate for blocks of size 2^( 7) =       0.000424602827

      target function =                  N/A
              le_mean =     -17.215784537459
             les_mean =     296.691881421762
             stat err =       0.000422235001
             autocorr =       1.155261090867
              std dev =       0.555557680043
             le_variance =       0.308644335854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721578453746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215784537459       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215786109947       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215794052621       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215802249143       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215805572257       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215810579857       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215811395703       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215813392672       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215813545368       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215813310476       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215813121610       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.241642e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215784537459       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215785061121       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215787450951       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215789803963       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215791049950       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215792071412       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215792271658       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215792647571       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215792690614       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.206902e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215784537459       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215784680227       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215785310552       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215785920970       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215786264330       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215786501902       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215786553199       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215786626997       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215786637356       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.131538e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5866e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.986883e-01 1 1  ON 0
 uu_1                 4.071200e-02 1 1  ON 1
 uu_2                -4.833211e-02 1 1  ON 2
 uu_3                -9.806940e-02 1 1  ON 3
 uu_4                -1.276201e-01 1 1  ON 4
 uu_5                -1.330308e-01 1 1  ON 5
 uu_6                -1.099583e-01 1 1  ON 6
 uu_7                -3.502064e-02 1 1  ON 7
 uu_8                 1.022183e-01 1 1  ON 8
 uu_9                 1.195576e-01 1 1  ON 9
 ud_0                 3.369022e-01 1 1  ON 10
 ud_1                 8.488177e-02 1 1  ON 11
 ud_2                -1.514279e-02 1 1  ON 12
 ud_3                -6.882989e-02 1 1  ON 13
 ud_4                -1.142665e-01 1 1  ON 14
 ud_5                -1.487770e-01 1 1  ON 15
 ud_6                -1.566216e-01 1 1  ON 16
 ud_7                -1.097144e-01 1 1  ON 17
 ud_8                 7.949033e-03 1 1  ON 18
 ud_9                 9.262408e-02 1 1  ON 19
 eO_0                -7.177176e-01 1 1  ON 20
 eO_1                -4.177841e-01 1 1  ON 21
 eO_2                -4.143643e-02 1 1  ON 22
 eO_3                 1.858320e-01 1 1  ON 23
 eO_4                 2.714761e-01 1 1  ON 24
 eO_5                 3.049394e-01 1 1  ON 25
 eO_6                 2.487198e-01 1 1  ON 26
 eO_7                 1.097534e-01 1 1  ON 27
 eO_8                 2.755915e-02 1 1  ON 28
 eO_9                 1.823235e-02 1 1  ON 29
eH1_0                -1.782688e-01 1 1  ON 30
eH1_1                -1.003659e-01 1 1  ON 31
eH1_2                -6.271601e-02 1 1  ON 32
eH1_3                -2.732382e-02 1 1  ON 33
eH1_4                 1.882897e-02 1 1  ON 34
eH1_5                 3.315347e-02 1 1  ON 35
eH1_6                 7.728705e-02 1 1  ON 36
eH1_7                 1.109714e-01 1 1  ON 37
eH1_8                 8.942063e-02 1 1  ON 38
eH1_9                 2.387858e-02 1 1  ON 39
eH2_0                -1.797365e-01 1 1  ON 40
eH2_1                -1.018202e-01 1 1  ON 41
eH2_2                -6.406954e-02 1 1  ON 42
eH2_3                -2.857249e-02 1 1  ON 43
eH2_4                 1.776733e-02 1 1  ON 44
eH2_5                 3.288380e-02 1 1  ON 45
eH2_6                 7.899362e-02 1 1  ON 46
eH2_7                 1.144206e-01 1 1  ON 47
eH2_8                 9.231112e-02 1 1  ON 48
eH2_9                 2.586183e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.198405
====================================================
  Execution time = 2.0540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2424e-01
  Total weights = 2.0000e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323799251629
                                         uncertainty =       0.004736405283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323799251629
                                         uncertainty =       0.004736405283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402351250
  error estimate for blocks of size 2^( 2) =       0.000412383164
  error estimate for blocks of size 2^( 3) =       0.000421182564
  error estimate for blocks of size 2^( 4) =       0.000427408913
  error estimate for blocks of size 2^( 5) =       0.000431563436
  error estimate for blocks of size 2^( 6) =       0.000433139358
  error estimate for blocks of size 2^( 7) =       0.000432735268

      target function =                  N/A
              le_mean =     -17.215853002252
             les_mean =     296.709367490403
             stat err =       0.000431211744
             autocorr =       1.148604331314
              std dev =       0.569010594924
             le_variance =       0.323773057135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325199206880
                                         uncertainty =       0.004760453695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325199206880
                                         uncertainty =       0.004760453695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403219917
  error estimate for blocks of size 2^( 2) =       0.000413194680
  error estimate for blocks of size 2^( 3) =       0.000421936700
  error estimate for blocks of size 2^( 4) =       0.000428128098
  error estimate for blocks of size 2^( 5) =       0.000432261528
  error estimate for blocks of size 2^( 6) =       0.000433838187
  error estimate for blocks of size 2^( 7) =       0.000433434581

      target function =                  N/A
              le_mean =     -17.215867403259
             les_mean =     296.711262886811
             stat err =       0.000431915598
             autocorr =       1.147397305826
              std dev =       0.570239075117
             le_variance =       0.325172602791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324732784961
                                         uncertainty =       0.004752645175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324732784961
                                         uncertainty =       0.004752645175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402930732
  error estimate for blocks of size 2^( 2) =       0.000412925395
  error estimate for blocks of size 2^( 3) =       0.000421688197
  error estimate for blocks of size 2^( 4) =       0.000427892280
  error estimate for blocks of size 2^( 5) =       0.000432033602
  error estimate for blocks of size 2^( 6) =       0.000433608817
  error estimate for blocks of size 2^( 7) =       0.000433204304

      target function =                  N/A
              le_mean =     -17.215860328929
             les_mean =     296.710553051778
             stat err =       0.000431684751
             autocorr =       1.147816940289
              std dev =       0.569830105323
             le_variance =       0.324706348932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323928131490
                                         uncertainty =       0.004738675291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323928131490
                                         uncertainty =       0.004738675291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402431302
  error estimate for blocks of size 2^( 2) =       0.000412457981
  error estimate for blocks of size 2^( 3) =       0.000421252294
  error estimate for blocks of size 2^( 4) =       0.000427475534
  error estimate for blocks of size 2^( 5) =       0.000431628240
  error estimate for blocks of size 2^( 6) =       0.000433203953
  error estimate for blocks of size 2^( 7) =       0.000432799772

      target function =                  N/A
              le_mean =     -17.215853680335
             les_mean =     296.709519686088
             stat err =       0.000431276875
             autocorr =       1.148494279222
              std dev =       0.569123804927
             le_variance =       0.323901905334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215853002252        initial
     3.9062e-01     3.9062e+00             4.2416e-03       -17.215867403259  <--
     1.5625e+00     1.5625e+01             1.2069e-03       -17.215860328929
     6.2500e+00     6.2500e+01             3.1315e-04       -17.215853680335

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9785e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.994798e-01 1 1  ON 0
 uu_1                 4.107559e-02 1 1  ON 1
 uu_2                -4.832921e-02 1 1  ON 2
 uu_3                -9.831606e-02 1 1  ON 3
 uu_4                -1.279441e-01 1 1  ON 4
 uu_5                -1.331966e-01 1 1  ON 5
 uu_6                -1.102155e-01 1 1  ON 6
 uu_7                -3.538143e-02 1 1  ON 7
 uu_8                 1.020935e-01 1 1  ON 8
 uu_9                 1.197137e-01 1 1  ON 9
 ud_0                 3.380570e-01 1 1  ON 10
 ud_1                 8.542149e-02 1 1  ON 11
 ud_2                -1.520047e-02 1 1  ON 12
 ud_3                -6.946133e-02 1 1  ON 13
 ud_4                -1.151063e-01 1 1  ON 14
 ud_5                -1.489961e-01 1 1  ON 15
 ud_6                -1.563287e-01 1 1  ON 16
 ud_7                -1.098252e-01 1 1  ON 17
 ud_8                 7.687426e-03 1 1  ON 18
 ud_9                 9.262550e-02 1 1  ON 19
 eO_0                -7.207523e-01 1 1  ON 20
 eO_1                -4.192739e-01 1 1  ON 21
 eO_2                -4.092558e-02 1 1  ON 22
 eO_3                 1.879516e-01 1 1  ON 23
 eO_4                 2.728167e-01 1 1  ON 24
 eO_5                 3.050506e-01 1 1  ON 25
 eO_6                 2.488480e-01 1 1  ON 26
 eO_7                 1.099899e-01 1 1  ON 27
 eO_8                 2.760233e-02 1 1  ON 28
 eO_9                 1.825273e-02 1 1  ON 29
eH1_0                -1.786239e-01 1 1  ON 30
eH1_1                -1.006613e-01 1 1  ON 31
eH1_2                -6.259677e-02 1 1  ON 32
eH1_3                -2.724122e-02 1 1  ON 33
eH1_4                 1.882131e-02 1 1  ON 34
eH1_5                 3.342882e-02 1 1  ON 35
eH1_6                 7.730856e-02 1 1  ON 36
eH1_7                 1.109086e-01 1 1  ON 37
eH1_8                 8.956726e-02 1 1  ON 38
eH1_9                 2.393608e-02 1 1  ON 39
eH2_0                -1.801550e-01 1 1  ON 40
eH2_1                -1.019758e-01 1 1  ON 41
eH2_2                -6.398033e-02 1 1  ON 42
eH2_3                -2.859733e-02 1 1  ON 43
eH2_4                 1.794101e-02 1 1  ON 44
eH2_5                 3.312337e-02 1 1  ON 45
eH2_6                 7.898358e-02 1 1  ON 46
eH2_7                 1.143553e-01 1 1  ON 47
eH2_8                 9.242429e-02 1 1  ON 48
eH2_9                 2.590996e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.212014
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2039e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320209526475
                                         uncertainty =       0.003708351264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320209526475
                                         uncertainty =       0.003708351264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400244594
  error estimate for blocks of size 2^( 2) =       0.000409694835
  error estimate for blocks of size 2^( 3) =       0.000418800403
  error estimate for blocks of size 2^( 4) =       0.000425167774
  error estimate for blocks of size 2^( 5) =       0.000429014086
  error estimate for blocks of size 2^( 6) =       0.000433119605
  error estimate for blocks of size 2^( 7) =       0.000436089030

      target function =                  N/A
              le_mean =     -17.216046223503
             les_mean =     296.712638879853
             stat err =       0.000430847624
             autocorr =       1.158767896165
              std dev =       0.566031333271
             le_variance =       0.320391470244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604622350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046223503       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216048987348       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216072557055       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216089086811       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216094963690       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216092555744       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216096603115       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216100334831       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216097341368       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216097062117       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216098876615       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216099309528       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216099016776       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216098923410       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.062425e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046223503       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216047497068       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216059337497       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216064339899       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216066669168       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216065028122       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216065715990       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216066350902       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216065636430       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216065637618       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216065774949       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.597239e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046223503       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216046626936       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216050555840       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216051569847       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052368628       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216051857867       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216051916119       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052047344       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216051966732       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.015243e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6199e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.005820e-01 1 1  ON 0
 uu_1                 4.166066e-02 1 1  ON 1
 uu_2                -4.833474e-02 1 1  ON 2
 uu_3                -9.870652e-02 1 1  ON 3
 uu_4                -1.285603e-01 1 1  ON 4
 uu_5                -1.334668e-01 1 1  ON 5
 uu_6                -1.104447e-01 1 1  ON 6
 uu_7                -3.566844e-02 1 1  ON 7
 uu_8                 1.019171e-01 1 1  ON 8
 uu_9                 1.198510e-01 1 1  ON 9
 ud_0                 3.391681e-01 1 1  ON 10
 ud_1                 8.590031e-02 1 1  ON 11
 ud_2                -1.516165e-02 1 1  ON 12
 ud_3                -6.999652e-02 1 1  ON 13
 ud_4                -1.159798e-01 1 1  ON 14
 ud_5                -1.492591e-01 1 1  ON 15
 ud_6                -1.559209e-01 1 1  ON 16
 ud_7                -1.099601e-01 1 1  ON 17
 ud_8                 7.364152e-03 1 1  ON 18
 ud_9                 9.260814e-02 1 1  ON 19
 eO_0                -7.243496e-01 1 1  ON 20
 eO_1                -4.210647e-01 1 1  ON 21
 eO_2                -4.040744e-02 1 1  ON 22
 eO_3                 1.904697e-01 1 1  ON 23
 eO_4                 2.743506e-01 1 1  ON 24
 eO_5                 3.052206e-01 1 1  ON 25
 eO_6                 2.491314e-01 1 1  ON 26
 eO_7                 1.103046e-01 1 1  ON 27
 eO_8                 2.763482e-02 1 1  ON 28
 eO_9                 1.826310e-02 1 1  ON 29
eH1_0                -1.790467e-01 1 1  ON 30
eH1_1                -1.010677e-01 1 1  ON 31
eH1_2                -6.247539e-02 1 1  ON 32
eH1_3                -2.703733e-02 1 1  ON 33
eH1_4                 1.887104e-02 1 1  ON 34
eH1_5                 3.379468e-02 1 1  ON 35
eH1_6                 7.725756e-02 1 1  ON 36
eH1_7                 1.108154e-01 1 1  ON 37
eH1_8                 8.973245e-02 1 1  ON 38
eH1_9                 2.400035e-02 1 1  ON 39
eH2_0                -1.804319e-01 1 1  ON 40
eH2_1                -1.024106e-01 1 1  ON 41
eH2_2                -6.376374e-02 1 1  ON 42
eH2_3                -2.830635e-02 1 1  ON 43
eH2_4                 1.779914e-02 1 1  ON 44
eH2_5                 3.342457e-02 1 1  ON 45
eH2_6                 7.889426e-02 1 1  ON 46
eH2_7                 1.142764e-01 1 1  ON 47
eH2_8                 9.258244e-02 1 1  ON 48
eH2_9                 2.595546e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.131651
====================================================
  Execution time = 2.0076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3144e-01
  Total weights = 2.0000e+06
  Execution time = 1.8353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330347408911
                                         uncertainty =       0.009681852908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330347408911
                                         uncertainty =       0.009681852908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406422104
  error estimate for blocks of size 2^( 2) =       0.000416200118
  error estimate for blocks of size 2^( 3) =       0.000425017486
  error estimate for blocks of size 2^( 4) =       0.000431376243
  error estimate for blocks of size 2^( 5) =       0.000434492507
  error estimate for blocks of size 2^( 6) =       0.000435998950
  error estimate for blocks of size 2^( 7) =       0.000436228760

      target function =                  N/A
              le_mean =     -17.216006628887
             les_mean =     296.721241934096
             stat err =       0.000434524115
             autocorr =       1.143070792269
              std dev =       0.574767651672
             le_variance =       0.330357853408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332912769544
                                         uncertainty =       0.009790018500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332912769544
                                         uncertainty =       0.009790018500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407996722
  error estimate for blocks of size 2^( 2) =       0.000417675105
  error estimate for blocks of size 2^( 3) =       0.000426385719
  error estimate for blocks of size 2^( 4) =       0.000432679200
  error estimate for blocks of size 2^( 5) =       0.000435751409
  error estimate for blocks of size 2^( 6) =       0.000437187950
  error estimate for blocks of size 2^( 7) =       0.000437434923

      target function =                  N/A
              le_mean =     -17.216019673704
             les_mean =     296.724255889976
             stat err =       0.000435763371
             autocorr =       1.140743740090
              std dev =       0.576994498310
             le_variance =       0.332922651080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332556486380
                                         uncertainty =       0.009769621374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332556486380
                                         uncertainty =       0.009769621374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407778414
  error estimate for blocks of size 2^( 2) =       0.000417475074
  error estimate for blocks of size 2^( 3) =       0.000426210917
  error estimate for blocks of size 2^( 4) =       0.000432520118
  error estimate for blocks of size 2^( 5) =       0.000435601530
  error estimate for blocks of size 2^( 6) =       0.000437049229
  error estimate for blocks of size 2^( 7) =       0.000437290988

      target function =                  N/A
              le_mean =     -17.216013106209
             les_mean =     296.723673577130
             stat err =       0.000435615466
             autocorr =       1.141190417743
              std dev =       0.576685763878
             le_variance =       0.332566470259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330704355275
                                         uncertainty =       0.009695224175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330704355275
                                         uncertainty =       0.009695224175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406641575
  error estimate for blocks of size 2^( 2) =       0.000416405924
  error estimate for blocks of size 2^( 3) =       0.000425210171
  error estimate for blocks of size 2^( 4) =       0.000431560923
  error estimate for blocks of size 2^( 5) =       0.000434671072
  error estimate for blocks of size 2^( 6) =       0.000436168211
  error estimate for blocks of size 2^( 7) =       0.000436399540

      target function =                  N/A
              le_mean =     -17.216005969131
             les_mean =     296.721576105122
             stat err =       0.000434699937
             autocorr =       1.142761487197
              std dev =       0.575078030633
             le_variance =       0.330714741317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216006628887        initial
     9.7656e-02     9.7656e-01             1.0624e-02       -17.216019673704  <--
     3.9062e-01     3.9062e+00             3.5972e-03       -17.216013106209
     1.5625e+00     1.5625e+01             1.0152e-03       -17.216005969131

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.9318e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.025998e-01 1 1  ON 0
 uu_1                 4.284782e-02 1 1  ON 1
 uu_2                -4.794216e-02 1 1  ON 2
 uu_3                -9.915202e-02 1 1  ON 3
 uu_4                -1.296555e-01 1 1  ON 4
 uu_5                -1.343936e-01 1 1  ON 5
 uu_6                -1.111283e-01 1 1  ON 6
 uu_7                -3.646394e-02 1 1  ON 7
 uu_8                 1.014108e-01 1 1  ON 8
 uu_9                 1.202595e-01 1 1  ON 9
 ud_0                 3.408832e-01 1 1  ON 10
 ud_1                 8.700477e-02 1 1  ON 11
 ud_2                -1.481849e-02 1 1  ON 12
 ud_3                -7.058486e-02 1 1  ON 13
 ud_4                -1.172632e-01 1 1  ON 14
 ud_5                -1.502202e-01 1 1  ON 15
 ud_6                -1.553990e-01 1 1  ON 16
 ud_7                -1.102225e-01 1 1  ON 17
 ud_8                 6.489752e-03 1 1  ON 18
 ud_9                 9.256389e-02 1 1  ON 19
 eO_0                -7.313766e-01 1 1  ON 20
 eO_1                -4.253007e-01 1 1  ON 21
 eO_2                -4.071244e-02 1 1  ON 22
 eO_3                 1.945644e-01 1 1  ON 23
 eO_4                 2.787723e-01 1 1  ON 24
 eO_5                 3.062732e-01 1 1  ON 25
 eO_6                 2.500385e-01 1 1  ON 26
 eO_7                 1.112446e-01 1 1  ON 27
 eO_8                 2.773521e-02 1 1  ON 28
 eO_9                 1.829418e-02 1 1  ON 29
eH1_0                -1.799302e-01 1 1  ON 30
eH1_1                -1.017538e-01 1 1  ON 31
eH1_2                -6.236321e-02 1 1  ON 32
eH1_3                -2.676253e-02 1 1  ON 33
eH1_4                 1.894157e-02 1 1  ON 34
eH1_5                 3.435607e-02 1 1  ON 35
eH1_6                 7.731510e-02 1 1  ON 36
eH1_7                 1.106132e-01 1 1  ON 37
eH1_8                 9.022610e-02 1 1  ON 38
eH1_9                 2.419236e-02 1 1  ON 39
eH2_0                -1.810437e-01 1 1  ON 40
eH2_1                -1.030020e-01 1 1  ON 41
eH2_2                -6.354518e-02 1 1  ON 42
eH2_3                -2.794804e-02 1 1  ON 43
eH2_4                 1.766124e-02 1 1  ON 44
eH2_5                 3.379223e-02 1 1  ON 45
eH2_6                 7.881985e-02 1 1  ON 46
eH2_7                 1.141109e-01 1 1  ON 47
eH2_8                 9.305445e-02 1 1  ON 48
eH2_9                 2.609145e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2709
    reference variance = 0.671182
====================================================
  Execution time = 2.0588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321076641905
                                         uncertainty =       0.004702319778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321076641905
                                         uncertainty =       0.004702319778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400641189
  error estimate for blocks of size 2^( 2) =       0.000410468232
  error estimate for blocks of size 2^( 3) =       0.000419115101
  error estimate for blocks of size 2^( 4) =       0.000424956613
  error estimate for blocks of size 2^( 5) =       0.000428640504
  error estimate for blocks of size 2^( 6) =       0.000431157432
  error estimate for blocks of size 2^( 7) =       0.000432535215

      target function =                  N/A
              le_mean =     -17.216104291433
             les_mean =     296.715273537580
             stat err =       0.000429322441
             autocorr =       1.148301646254
              std dev =       0.566592203078
             le_variance =       0.321026724589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610429143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216104291433       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216111286536       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216120802787       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216126362806       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216137695130       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216153315339       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216153837019       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216157608505       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216159971269       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216159873757       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216162239696       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216161850819       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216162931380       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216164143836       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216164704182       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216164893348       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216164661339       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216165273105       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216165134189       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.894863e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216104291433       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216109770756       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216115668161       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216119394535       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216121855946       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216130356733       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216130041366       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216130671745       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216131063504       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216130601499       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216131088385       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216130789089       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216130798883       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 7.164672e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216104291433       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107226626       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216109296767       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216111207267       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216110780238       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216113332844       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216113292957       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216113363079       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216113289308       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216113345651       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.257626e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6102e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.041402e-01 1 1  ON 0
 uu_1                 4.432764e-02 1 1  ON 1
 uu_2                -4.692597e-02 1 1  ON 2
 uu_3                -9.908999e-02 1 1  ON 3
 uu_4                -1.302099e-01 1 1  ON 4
 uu_5                -1.356725e-01 1 1  ON 5
 uu_6                -1.125263e-01 1 1  ON 6
 uu_7                -3.800458e-02 1 1  ON 7
 uu_8                 1.006393e-01 1 1  ON 8
 uu_9                 1.208938e-01 1 1  ON 9
 ud_0                 3.426773e-01 1 1  ON 10
 ud_1                 8.827855e-02 1 1  ON 11
 ud_2                -1.432173e-02 1 1  ON 12
 ud_3                -7.096509e-02 1 1  ON 13
 ud_4                -1.181753e-01 1 1  ON 14
 ud_5                -1.512336e-01 1 1  ON 15
 ud_6                -1.551662e-01 1 1  ON 16
 ud_7                -1.108386e-01 1 1  ON 17
 ud_8                 4.941510e-03 1 1  ON 18
 ud_9                 9.246589e-02 1 1  ON 19
 eO_0                -7.385413e-01 1 1  ON 20
 eO_1                -4.303289e-01 1 1  ON 21
 eO_2                -4.199263e-02 1 1  ON 22
 eO_3                 1.978839e-01 1 1  ON 23
 eO_4                 2.848303e-01 1 1  ON 24
 eO_5                 3.077454e-01 1 1  ON 25
 eO_6                 2.511002e-01 1 1  ON 26
 eO_7                 1.124819e-01 1 1  ON 27
 eO_8                 2.788344e-02 1 1  ON 28
 eO_9                 1.836796e-02 1 1  ON 29
eH1_0                -1.807143e-01 1 1  ON 30
eH1_1                -1.020505e-01 1 1  ON 31
eH1_2                -6.228923e-02 1 1  ON 32
eH1_3                -2.708507e-02 1 1  ON 33
eH1_4                 1.896033e-02 1 1  ON 34
eH1_5                 3.483963e-02 1 1  ON 35
eH1_6                 7.722541e-02 1 1  ON 36
eH1_7                 1.105389e-01 1 1  ON 37
eH1_8                 9.086551e-02 1 1  ON 38
eH1_9                 2.441906e-02 1 1  ON 39
eH2_0                -1.818584e-01 1 1  ON 40
eH2_1                -1.035499e-01 1 1  ON 41
eH2_2                -6.364992e-02 1 1  ON 42
eH2_3                -2.807913e-02 1 1  ON 43
eH2_4                 1.810207e-02 1 1  ON 44
eH2_5                 3.396272e-02 1 1  ON 45
eH2_6                 7.909168e-02 1 1  ON 46
eH2_7                 1.140081e-01 1 1  ON 47
eH2_8                 9.361779e-02 1 1  ON 48
eH2_9                 2.628850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2792
    reference variance = 0.671093
====================================================
  Execution time = 2.0178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2704e-01
  Total weights = 2.0000e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326053575272
                                         uncertainty =       0.005971793471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326053575272
                                         uncertainty =       0.005971793471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403706428
  error estimate for blocks of size 2^( 2) =       0.000413091106
  error estimate for blocks of size 2^( 3) =       0.000422509702
  error estimate for blocks of size 2^( 4) =       0.000429014558
  error estimate for blocks of size 2^( 5) =       0.000433176754
  error estimate for blocks of size 2^( 6) =       0.000435051947
  error estimate for blocks of size 2^( 7) =       0.000434213190

      target function =                  N/A
              le_mean =     -17.215784536753
             les_mean =     296.709194812515
             stat err =       0.000432864112
             autocorr =       1.149666384619
              std dev =       0.570927105317
             le_variance =       0.325957759586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328402902579
                                         uncertainty =       0.005997956683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328402902579
                                         uncertainty =       0.005997956683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405158442
  error estimate for blocks of size 2^( 2) =       0.000414433710
  error estimate for blocks of size 2^( 3) =       0.000423721412
  error estimate for blocks of size 2^( 4) =       0.000430116201
  error estimate for blocks of size 2^( 5) =       0.000434221412
  error estimate for blocks of size 2^( 6) =       0.000436033282
  error estimate for blocks of size 2^( 7) =       0.000435146836

      target function =                  N/A
              le_mean =     -17.215798156610
             les_mean =     296.712012731910
             stat err =       0.000433879433
             autocorr =       1.146801735079
              std dev =       0.572980564165
             le_variance =       0.328306726910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284558209
                                         uncertainty =       0.005994780360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328284558209
                                         uncertainty =       0.005994780360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405085442
  error estimate for blocks of size 2^( 2) =       0.000414373390
  error estimate for blocks of size 2^( 3) =       0.000423679807
  error estimate for blocks of size 2^( 4) =       0.000430086671
  error estimate for blocks of size 2^( 5) =       0.000434205950
  error estimate for blocks of size 2^( 6) =       0.000436023765
  error estimate for blocks of size 2^( 7) =       0.000435147212

      target function =                  N/A
              le_mean =     -17.215790357208
             les_mean =     296.711625890177
             stat err =       0.000433865900
             autocorr =       1.147143537381
              std dev =       0.572877326240
             le_variance =       0.328188430920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326456527224
                                         uncertainty =       0.005976267159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326456527224
                                         uncertainty =       0.005976267159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403955866
  error estimate for blocks of size 2^( 2) =       0.000413321737
  error estimate for blocks of size 2^( 3) =       0.000422720096
  error estimate for blocks of size 2^( 4) =       0.000429206165
  error estimate for blocks of size 2^( 5) =       0.000433361227
  error estimate for blocks of size 2^( 6) =       0.000435226167
  error estimate for blocks of size 2^( 7) =       0.000434382706

      target function =                  N/A
              le_mean =     -17.215780276120
             les_mean =     296.709451035815
             stat err =       0.000433044066
             autocorr =       1.149201928458
              std dev =       0.571279864292
             le_variance =       0.326360683345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215784536753        initial
     2.4414e-02     2.4414e-01             1.8949e-02       -17.215798156610  <--
     9.7656e-02     9.7656e-01             7.1647e-03       -17.215790357208
     3.9062e-01     3.9062e+00             2.2576e-03       -17.215780276120

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 2.9415e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.068725e-01 1 1  ON 0
 uu_1                 4.651803e-02 1 1  ON 1
 uu_2                -4.540755e-02 1 1  ON 2
 uu_3                -9.860918e-02 1 1  ON 3
 uu_4                -1.309908e-01 1 1  ON 4
 uu_5                -1.376633e-01 1 1  ON 5
 uu_6                -1.151063e-01 1 1  ON 6
 uu_7                -4.173726e-02 1 1  ON 7
 uu_8                 9.827425e-02 1 1  ON 8
 uu_9                 1.228530e-01 1 1  ON 9
 ud_0                 3.451435e-01 1 1  ON 10
 ud_1                 9.031745e-02 1 1  ON 11
 ud_2                -1.294286e-02 1 1  ON 12
 ud_3                -7.056569e-02 1 1  ON 13
 ud_4                -1.187754e-01 1 1  ON 14
 ud_5                -1.527147e-01 1 1  ON 15
 ud_6                -1.560248e-01 1 1  ON 16
 ud_7                -1.119887e-01 1 1  ON 17
 ud_8                 6.233258e-04 1 1  ON 18
 ud_9                 9.215464e-02 1 1  ON 19
 eO_0                -7.503252e-01 1 1  ON 20
 eO_1                -4.398731e-01 1 1  ON 21
 eO_2                -4.722379e-02 1 1  ON 22
 eO_3                 1.992376e-01 1 1  ON 23
 eO_4                 2.932995e-01 1 1  ON 24
 eO_5                 3.149971e-01 1 1  ON 25
 eO_6                 2.555292e-01 1 1  ON 26
 eO_7                 1.165090e-01 1 1  ON 27
 eO_8                 2.835886e-02 1 1  ON 28
 eO_9                 1.859811e-02 1 1  ON 29
eH1_0                -1.816481e-01 1 1  ON 30
eH1_1                -1.029276e-01 1 1  ON 31
eH1_2                -6.277938e-02 1 1  ON 32
eH1_3                -2.740446e-02 1 1  ON 33
eH1_4                 1.863154e-02 1 1  ON 34
eH1_5                 3.434963e-02 1 1  ON 35
eH1_6                 7.713111e-02 1 1  ON 36
eH1_7                 1.108594e-01 1 1  ON 37
eH1_8                 9.296144e-02 1 1  ON 38
eH1_9                 2.514071e-02 1 1  ON 39
eH2_0                -1.828482e-01 1 1  ON 40
eH2_1                -1.045206e-01 1 1  ON 41
eH2_2                -6.419162e-02 1 1  ON 42
eH2_3                -2.836971e-02 1 1  ON 43
eH2_4                 1.803270e-02 1 1  ON 44
eH2_5                 3.327944e-02 1 1  ON 45
eH2_6                 7.977716e-02 1 1  ON 46
eH2_7                 1.141906e-01 1 1  ON 47
eH2_8                 9.548367e-02 1 1  ON 48
eH2_9                 2.691944e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2699
    reference variance = 0.19802
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3121e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330971271542
                                         uncertainty =       0.009207203445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330971271542
                                         uncertainty =       0.009207203445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406946003
  error estimate for blocks of size 2^( 2) =       0.000416576407
  error estimate for blocks of size 2^( 3) =       0.000424566769
  error estimate for blocks of size 2^( 4) =       0.000430748839
  error estimate for blocks of size 2^( 5) =       0.000434569152
  error estimate for blocks of size 2^( 6) =       0.000435693971
  error estimate for blocks of size 2^( 7) =       0.000437081488

      target function =                  N/A
              le_mean =     -17.215814467183
             les_mean =     296.715477702251
             stat err =       0.000434523362
             autocorr =       1.140125574910
              std dev =       0.575508557194
             le_variance =       0.331210099403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721581446718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814467183       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215815034951       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215814147032       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215818460974       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215819912390       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215825049811       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215833190172       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215831888949       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215836351217       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215842846933       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215845016073       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215844814909       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215846359981       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215847975579       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215854691739       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215850631582       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215851370929       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215852904185       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215852003073       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215852400785       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215852410579       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215853169933       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215854188332       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.889879e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814467183       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215814990616       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215814031373       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215818052648       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215819438963       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215823475325       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215828223278       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215825929914       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215827850350       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215831070493       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215831513578       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215831144694       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215830704989       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215831474368       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215832565523       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215831631095       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215831394822       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.018410e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215814467183       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215814866038       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215813851396       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215816960178       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215818189280       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820221264       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215821133484       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215819708358       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215820072739       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215821014557       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215821011635       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215820983226       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 3.113271e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6053e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.091623e-01 1 1  ON 0
 uu_1                 4.759661e-02 1 1  ON 1
 uu_2                -4.473089e-02 1 1  ON 2
 uu_3                -9.867619e-02 1 1  ON 3
 uu_4                -1.325271e-01 1 1  ON 4
 uu_5                -1.399767e-01 1 1  ON 5
 uu_6                -1.174536e-01 1 1  ON 6
 uu_7                -4.475270e-02 1 1  ON 7
 uu_8                 9.634710e-02 1 1  ON 8
 uu_9                 1.258562e-01 1 1  ON 9
 ud_0                 3.463154e-01 1 1  ON 10
 ud_1                 9.125292e-02 1 1  ON 11
 ud_2                -1.238621e-02 1 1  ON 12
 ud_3                -7.028268e-02 1 1  ON 13
 ud_4                -1.192341e-01 1 1  ON 14
 ud_5                -1.542685e-01 1 1  ON 15
 ud_6                -1.571179e-01 1 1  ON 16
 ud_7                -1.123462e-01 1 1  ON 17
 ud_8                -2.342217e-03 1 1  ON 18
 ud_9                 9.246868e-02 1 1  ON 19
 eO_0                -7.605093e-01 1 1  ON 20
 eO_1                -4.491437e-01 1 1  ON 21
 eO_2                -5.365535e-02 1 1  ON 22
 eO_3                 1.980728e-01 1 1  ON 23
 eO_4                 2.993425e-01 1 1  ON 24
 eO_5                 3.233184e-01 1 1  ON 25
 eO_6                 2.611952e-01 1 1  ON 26
 eO_7                 1.215939e-01 1 1  ON 27
 eO_8                 2.944885e-02 1 1  ON 28
 eO_9                 1.899292e-02 1 1  ON 29
eH1_0                -1.816116e-01 1 1  ON 30
eH1_1                -1.035975e-01 1 1  ON 31
eH1_2                -6.327112e-02 1 1  ON 32
eH1_3                -2.748309e-02 1 1  ON 33
eH1_4                 1.728872e-02 1 1  ON 34
eH1_5                 3.205552e-02 1 1  ON 35
eH1_6                 7.761180e-02 1 1  ON 36
eH1_7                 1.109098e-01 1 1  ON 37
eH1_8                 9.602794e-02 1 1  ON 38
eH1_9                 2.607194e-02 1 1  ON 39
eH2_0                -1.828775e-01 1 1  ON 40
eH2_1                -1.045310e-01 1 1  ON 41
eH2_2                -6.451449e-02 1 1  ON 42
eH2_3                -2.827757e-02 1 1  ON 43
eH2_4                 1.745487e-02 1 1  ON 44
eH2_5                 3.121333e-02 1 1  ON 45
eH2_6                 7.866298e-02 1 1  ON 46
eH2_7                 1.135437e-01 1 1  ON 47
eH2_8                 9.868781e-02 1 1  ON 48
eH2_9                 2.800401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.193992
====================================================
  Execution time = 2.0221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2861e-01
  Total weights = 2.0000e+06
  Execution time = 1.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327564835098
                                         uncertainty =       0.007321638048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327564835098
                                         uncertainty =       0.007321638048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404662258
  error estimate for blocks of size 2^( 2) =       0.000414264086
  error estimate for blocks of size 2^( 3) =       0.000422934191
  error estimate for blocks of size 2^( 4) =       0.000429290484
  error estimate for blocks of size 2^( 5) =       0.000433258427
  error estimate for blocks of size 2^( 6) =       0.000435369950
  error estimate for blocks of size 2^( 7) =       0.000435281157

      target function =                  N/A
              le_mean =     -17.216498110177
             les_mean =     296.735310099323
             stat err =       0.000433300004
             autocorr =       1.146547327626
              std dev =       0.572278852794
             le_variance =       0.327503085355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329571940633
                                         uncertainty =       0.007368048837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329571940633
                                         uncertainty =       0.007368048837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405899986
  error estimate for blocks of size 2^( 2) =       0.000415445557
  error estimate for blocks of size 2^( 3) =       0.000424033007
  error estimate for blocks of size 2^( 4) =       0.000430312758
  error estimate for blocks of size 2^( 5) =       0.000434225049
  error estimate for blocks of size 2^( 6) =       0.000436268571
  error estimate for blocks of size 2^( 7) =       0.000436117133

      target function =                  N/A
              le_mean =     -17.216504802052
             les_mean =     296.737547031959
             stat err =       0.000434230878
             autocorr =       1.144467151588
              std dev =       0.574029265475
             le_variance =       0.329509597622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329835342281
                                         uncertainty =       0.007367932692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329835342281
                                         uncertainty =       0.007367932692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406062092
  error estimate for blocks of size 2^( 2) =       0.000415613035
  error estimate for blocks of size 2^( 3) =       0.000424210672
  error estimate for blocks of size 2^( 4) =       0.000430488581
  error estimate for blocks of size 2^( 5) =       0.000434395758
  error estimate for blocks of size 2^( 6) =       0.000436433726
  error estimate for blocks of size 2^( 7) =       0.000436263908

      target function =                  N/A
              le_mean =     -17.216503642349
             les_mean =     296.737770347460
             stat err =       0.000434395493
             autocorr =       1.144420755986
              std dev =       0.574258517843
             le_variance =       0.329772845315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328158889150
                                         uncertainty =       0.007332076230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328158889150
                                         uncertainty =       0.007332076230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405028962
  error estimate for blocks of size 2^( 2) =       0.000414616500
  error estimate for blocks of size 2^( 3) =       0.000423269539
  error estimate for blocks of size 2^( 4) =       0.000429604052
  error estimate for blocks of size 2^( 5) =       0.000433553702
  error estimate for blocks of size 2^( 6) =       0.000435645170
  error estimate for blocks of size 2^( 7) =       0.000435530278

      target function =                  N/A
              le_mean =     -17.216494261016
             les_mean =     296.735771396303
             stat err =       0.000433583301
             autocorr =       1.145969173156
              std dev =       0.572797451781
             le_variance =       0.328096920767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216498110177        initial
     6.1035e-03     6.1035e-02             2.8899e-02       -17.216504802052  <--
     2.4414e-02     2.4414e-01             1.0184e-02       -17.216503642349
     9.7656e-02     9.7656e-01             3.1133e-03       -17.216494261016

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 2.9476e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.101656e-01 1 1  ON 0
 uu_1                 4.801213e-02 1 1  ON 1
 uu_2                -4.475388e-02 1 1  ON 2
 uu_3                -9.943688e-02 1 1  ON 3
 uu_4                -1.344237e-01 1 1  ON 4
 uu_5                -1.435169e-01 1 1  ON 5
 uu_6                -1.225196e-01 1 1  ON 6
 uu_7                -5.152697e-02 1 1  ON 7
 uu_8                 8.996430e-02 1 1  ON 8
 uu_9                 1.351291e-01 1 1  ON 9
 ud_0                 3.481961e-01 1 1  ON 10
 ud_1                 9.295104e-02 1 1  ON 11
 ud_2                -1.105355e-02 1 1  ON 12
 ud_3                -6.948584e-02 1 1  ON 13
 ud_4                -1.193606e-01 1 1  ON 14
 ud_5                -1.557641e-01 1 1  ON 15
 ud_6                -1.597979e-01 1 1  ON 16
 ud_7                -1.163107e-01 1 1  ON 17
 ud_8                -1.086263e-02 1 1  ON 18
 ud_9                 9.321781e-02 1 1  ON 19
 eO_0                -7.792240e-01 1 1  ON 20
 eO_1                -4.665170e-01 1 1  ON 21
 eO_2                -6.806491e-02 1 1  ON 22
 eO_3                 1.891232e-01 1 1  ON 23
 eO_4                 3.004210e-01 1 1  ON 24
 eO_5                 3.369659e-01 1 1  ON 25
 eO_6                 2.816138e-01 1 1  ON 26
 eO_7                 1.394538e-01 1 1  ON 27
 eO_8                 3.313904e-02 1 1  ON 28
 eO_9                 2.026584e-02 1 1  ON 29
eH1_0                -1.828814e-01 1 1  ON 30
eH1_1                -1.051887e-01 1 1  ON 31
eH1_2                -6.466165e-02 1 1  ON 32
eH1_3                -2.858234e-02 1 1  ON 33
eH1_4                 1.589989e-02 1 1  ON 34
eH1_5                 2.933351e-02 1 1  ON 35
eH1_6                 7.347305e-02 1 1  ON 36
eH1_7                 1.099820e-01 1 1  ON 37
eH1_8                 1.063930e-01 1 1  ON 38
eH1_9                 2.921931e-02 1 1  ON 39
eH2_0                -1.840421e-01 1 1  ON 40
eH2_1                -1.057271e-01 1 1  ON 41
eH2_2                -6.552034e-02 1 1  ON 42
eH2_3                -2.910365e-02 1 1  ON 43
eH2_4                 1.662007e-02 1 1  ON 44
eH2_5                 2.869554e-02 1 1  ON 45
eH2_6                 7.335737e-02 1 1  ON 46
eH2_7                 1.107928e-01 1 1  ON 47
eH2_8                 1.093629e-01 1 1  ON 48
eH2_9                 3.165443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2713
    reference variance = 0.34128
====================================================
  Execution time = 2.0418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2411e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324180871258
                                         uncertainty =       0.004503264434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324180871258
                                         uncertainty =       0.004503264434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402561552
  error estimate for blocks of size 2^( 2) =       0.000412182870
  error estimate for blocks of size 2^( 3) =       0.000420665599
  error estimate for blocks of size 2^( 4) =       0.000427126737
  error estimate for blocks of size 2^( 5) =       0.000431294390
  error estimate for blocks of size 2^( 6) =       0.000432204946
  error estimate for blocks of size 2^( 7) =       0.000433694432

      target function =                  N/A
              le_mean =     -17.215262956405
             les_mean =     296.689390102961
             stat err =       0.000431080126
             autocorr =       1.146704229943
              std dev =       0.569308006996
             le_variance =       0.324111606830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721526295641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215262956405       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215266493347       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215266819664       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215268048162       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215268182663       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215266446645       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215265662863       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215268070963       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215273514451       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215274563067       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215276786545       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215294604588       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215297712987       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215293840149       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215297387822       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215304910330       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215305978099       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215308788772       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215313174556       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215315474638       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215317118908       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215314432762       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215316139884       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215317691404       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215317491618       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215317897880       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215319394234       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215321143828       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 1.192155e-01

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215262956405       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215266373848       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215266688335       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215267888062       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215268033804       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215266334598       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215265574690       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215267733136       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215272260136       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215272473155       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215273004823       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215281655755       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215282126577       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215279885723       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215280934445       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215283403073       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215283466029       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215283742699       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215285103686       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215285190480       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215285490681       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215284623140       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 2.520564e-02

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215262956405       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215265966984       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215266245088       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215267347249       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215267531327       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215265972777       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215265339821       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215266840305       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215269450800       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215269101931       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215268731673       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215271083229       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215270885491       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215270334677       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215270657290       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 6.643444e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6072e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.094982e-01 1 1  ON 0
 uu_1                 4.765458e-02 1 1  ON 1
 uu_2                -4.525242e-02 1 1  ON 2
 uu_3                -1.000743e-01 1 1  ON 3
 uu_4                -1.351837e-01 1 1  ON 4
 uu_5                -1.452687e-01 1 1  ON 5
 uu_6                -1.270889e-01 1 1  ON 6
 uu_7                -5.744373e-02 1 1  ON 7
 uu_8                 8.248371e-02 1 1  ON 8
 uu_9                 1.447476e-01 1 1  ON 9
 ud_0                 3.503421e-01 1 1  ON 10
 ud_1                 9.519709e-02 1 1  ON 11
 ud_2                -9.193245e-03 1 1  ON 12
 ud_3                -6.811876e-02 1 1  ON 13
 ud_4                -1.190162e-01 1 1  ON 14
 ud_5                -1.556028e-01 1 1  ON 15
 ud_6                -1.623205e-01 1 1  ON 16
 ud_7                -1.197550e-01 1 1  ON 17
 ud_8                -2.191686e-02 1 1  ON 18
 ud_9                 9.275352e-02 1 1  ON 19
 eO_0                -7.964601e-01 1 1  ON 20
 eO_1                -4.825873e-01 1 1  ON 21
 eO_2                -8.272117e-02 1 1  ON 22
 eO_3                 1.774391e-01 1 1  ON 23
 eO_4                 2.955814e-01 1 1  ON 24
 eO_5                 3.449143e-01 1 1  ON 25
 eO_6                 3.068194e-01 1 1  ON 26
 eO_7                 1.643118e-01 1 1  ON 27
 eO_8                 3.675994e-02 1 1  ON 28
 eO_9                 2.182462e-02 1 1  ON 29
eH1_0                -1.857416e-01 1 1  ON 30
eH1_1                -1.064681e-01 1 1  ON 31
eH1_2                -6.625607e-02 1 1  ON 32
eH1_3                -3.033264e-02 1 1  ON 33
eH1_4                 1.559501e-02 1 1  ON 34
eH1_5                 2.919009e-02 1 1  ON 35
eH1_6                 6.861544e-02 1 1  ON 36
eH1_7                 1.069631e-01 1 1  ON 37
eH1_8                 1.178789e-01 1 1  ON 38
eH1_9                 3.244610e-02 1 1  ON 39
eH2_0                -1.863709e-01 1 1  ON 40
eH2_1                -1.083817e-01 1 1  ON 41
eH2_2                -6.826650e-02 1 1  ON 42
eH2_3                -3.181779e-02 1 1  ON 43
eH2_4                 1.357608e-02 1 1  ON 44
eH2_5                 2.603434e-02 1 1  ON 45
eH2_6                 7.092103e-02 1 1  ON 46
eH2_7                 1.126184e-01 1 1  ON 47
eH2_8                 1.214782e-01 1 1  ON 48
eH2_9                 3.491656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.188
    reference variance = 0.243507
====================================================
  Execution time = 2.2024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2729e-01
  Total weights = 2.0000e+06
  Execution time = 1.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327045426327
                                         uncertainty =       0.004127515488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327045426327
                                         uncertainty =       0.004127515488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404386063
  error estimate for blocks of size 2^( 2) =       0.000413300228
  error estimate for blocks of size 2^( 3) =       0.000421803200
  error estimate for blocks of size 2^( 4) =       0.000428246621
  error estimate for blocks of size 2^( 5) =       0.000432382360
  error estimate for blocks of size 2^( 6) =       0.000433820556
  error estimate for blocks of size 2^( 7) =       0.000435255118

      target function =                  N/A
              le_mean =     -17.216562444075
             les_mean =     296.737078402518
             stat err =       0.000432426164
             autocorr =       1.143487885529
              std dev =       0.571888254212
             le_variance =       0.327056175305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327827642365
                                         uncertainty =       0.004133513122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327827642365
                                         uncertainty =       0.004133513122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404868024
  error estimate for blocks of size 2^( 2) =       0.000413749847
  error estimate for blocks of size 2^( 3) =       0.000422195969
  error estimate for blocks of size 2^( 4) =       0.000428563743
  error estimate for blocks of size 2^( 5) =       0.000432672406
  error estimate for blocks of size 2^( 6) =       0.000434113219
  error estimate for blocks of size 2^( 7) =       0.000435531667

      target function =                  N/A
              le_mean =     -17.216577250482
             les_mean =     296.738368291368
             stat err =       0.000432720259
             autocorr =       1.142319262971
              std dev =       0.572569850291
             le_variance =       0.327836233463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327560667745
                                         uncertainty =       0.004129612239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327560667745
                                         uncertainty =       0.004129612239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404703412
  error estimate for blocks of size 2^( 2) =       0.000413608261
  error estimate for blocks of size 2^( 3) =       0.000422079071
  error estimate for blocks of size 2^( 4) =       0.000428471159
  error estimate for blocks of size 2^( 5) =       0.000432593458
  error estimate for blocks of size 2^( 6) =       0.000434025513
  error estimate for blocks of size 2^( 7) =       0.000435457013

      target function =                  N/A
              le_mean =     -17.216566291845
             les_mean =     296.737724421591
             stat err =       0.000432636786
             autocorr =       1.142807691210
              std dev =       0.572337054446
             le_variance =       0.327569703892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327043591390
                                         uncertainty =       0.004126260451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327043591390
                                         uncertainty =       0.004126260451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404384660
  error estimate for blocks of size 2^( 2) =       0.000413300169
  error estimate for blocks of size 2^( 3) =       0.000421798801
  error estimate for blocks of size 2^( 4) =       0.000428231671
  error estimate for blocks of size 2^( 5) =       0.000432366208
  error estimate for blocks of size 2^( 6) =       0.000433797291
  error estimate for blocks of size 2^( 7) =       0.000435230851

      target function =                  N/A
              le_mean =     -17.216558462902
             les_mean =     296.736939049442
             stat err =       0.000432406505
             autocorr =       1.143391850476
              std dev =       0.571886270538
             le_variance =       0.327053906430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216562444075        initial
     1.5259e-03     1.5259e-02             1.1922e-01       -17.216577250482  <--
     6.1035e-03     6.1035e-02             2.5206e-02       -17.216566291845
     2.4414e-02     2.4414e-01             6.6434e-03       -17.216558462902

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 3.1267e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.064621e-01 1 1  ON 0
 uu_1                 4.463948e-02 1 1  ON 1
 uu_2                -4.856192e-02 1 1  ON 2
 uu_3                -1.038085e-01 1 1  ON 3
 uu_4                -1.395946e-01 1 1  ON 4
 uu_5                -1.511435e-01 1 1  ON 5
 uu_6                -1.377787e-01 1 1  ON 6
 uu_7                -7.590329e-02 1 1  ON 7
 uu_8                 5.461102e-02 1 1  ON 8
 uu_9                 1.751666e-01 1 1  ON 9
 ud_0                 3.539991e-01 1 1  ON 10
 ud_1                 9.878438e-02 1 1  ON 11
 ud_2                -5.991445e-03 1 1  ON 12
 ud_3                -6.551359e-02 1 1  ON 13
 ud_4                -1.175349e-01 1 1  ON 14
 ud_5                -1.555286e-01 1 1  ON 15
 ud_6                -1.674560e-01 1 1  ON 16
 ud_7                -1.311574e-01 1 1  ON 17
 ud_8                -4.948466e-02 1 1  ON 18
 ud_9                 8.761843e-02 1 1  ON 19
 eO_0                -8.378086e-01 1 1  ON 20
 eO_1                -5.227725e-01 1 1  ON 21
 eO_2                -1.206122e-01 1 1  ON 22
 eO_3                 1.442266e-01 1 1  ON 23
 eO_4                 2.723406e-01 1 1  ON 24
 eO_5                 3.429481e-01 1 1  ON 25
 eO_6                 3.629560e-01 1 1  ON 26
 eO_7                 2.586693e-01 1 1  ON 27
 eO_8                 5.326280e-02 1 1  ON 28
 eO_9                 2.775320e-02 1 1  ON 29
eH1_0                -1.917053e-01 1 1  ON 30
eH1_1                -1.115426e-01 1 1  ON 31
eH1_2                -7.134601e-02 1 1  ON 32
eH1_3                -3.522654e-02 1 1  ON 33
eH1_4                 1.151800e-02 1 1  ON 34
eH1_5                 2.420053e-02 1 1  ON 35
eH1_6                 6.147563e-02 1 1  ON 36
eH1_7                 8.852610e-02 1 1  ON 37
eH1_8                 1.563863e-01 1 1  ON 38
eH1_9                 4.527327e-02 1 1  ON 39
eH2_0                -1.945753e-01 1 1  ON 40
eH2_1                -1.161183e-01 1 1  ON 41
eH2_2                -7.591088e-02 1 1  ON 42
eH2_3                -3.915237e-02 1 1  ON 43
eH2_4                 6.532755e-03 1 1  ON 44
eH2_5                 1.877691e-02 1 1  ON 45
eH2_6                 6.692556e-02 1 1  ON 46
eH2_7                 1.027443e-01 1 1  ON 47
eH2_8                 1.618577e-01 1 1  ON 48
eH2_9                 4.807362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1818
    reference variance = 0.207714
====================================================
  Execution time = 2.0349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2187e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321906220705
                                         uncertainty =       0.005448311489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321906220705
                                         uncertainty =       0.005448311489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401166742
  error estimate for blocks of size 2^( 2) =       0.000410747912
  error estimate for blocks of size 2^( 3) =       0.000418999995
  error estimate for blocks of size 2^( 4) =       0.000425336211
  error estimate for blocks of size 2^( 5) =       0.000428153894
  error estimate for blocks of size 2^( 6) =       0.000428767665
  error estimate for blocks of size 2^( 7) =       0.000431462566

      target function =                  N/A
              le_mean =     -17.216589946818
             les_mean =     296.732838746144
             stat err =       0.000428430084
             autocorr =       1.140538828357
              std dev =       0.567335447692
             le_variance =       0.321869510208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658994682e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589946818       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593359109       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597140891       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216595944835       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597816707       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597876863       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216598435173       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216597693557       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216600461302       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216603631713       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216607467136       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216606416441       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216609082451       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216606633193       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216608384453       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216610877986       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216610255883       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216613864180       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216618787553       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216622028359       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216628207184       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216633026107       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216631850435       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216634126741       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216634844365       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216633385951       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216636871709       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216639751444       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216639800075       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216639869153       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.216641848033       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-04 is 2.816789e-01

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589946818       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593338257       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597121413       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216595921896       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597754058       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597813844       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216598361005       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216597621199       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216600336321       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216603384614       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216606882753       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216605833846       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216608126830       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216605791590       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216607146406       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216609061971       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216608341270       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216610707945       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216613569712       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216615268486       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216618171259       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216620093407       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216617890753       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216618552575       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216618249186       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216617475252       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 6.595500e-02

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216589946818       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593257338       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216597035623       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216595827924       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216597516226       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216597573939       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216598079531       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216597349508       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216599874319       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216602493793       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216604955060       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216603980299       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216605300182       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216603426266       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216604096065       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216604991217       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216604404657       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216605141394       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216605940877       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216606371724       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216606968179       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-03 is 1.710360e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5887e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.027309e-01 1 1  ON 0
 uu_1                 4.154466e-02 1 1  ON 1
 uu_2                -5.167970e-02 1 1  ON 2
 uu_3                -1.066015e-01 1 1  ON 3
 uu_4                -1.420161e-01 1 1  ON 4
 uu_5                -1.530660e-01 1 1  ON 5
 uu_6                -1.396683e-01 1 1  ON 6
 uu_7                -8.434186e-02 1 1  ON 7
 uu_8                 2.986989e-02 1 1  ON 8
 uu_9                 1.847935e-01 1 1  ON 9
 ud_0                 3.525430e-01 1 1  ON 10
 ud_1                 9.761324e-02 1 1  ON 11
 ud_2                -6.812807e-03 1 1  ON 12
 ud_3                -6.654504e-02 1 1  ON 13
 ud_4                -1.180671e-01 1 1  ON 14
 ud_5                -1.583064e-01 1 1  ON 15
 ud_6                -1.701196e-01 1 1  ON 16
 ud_7                -1.374435e-01 1 1  ON 17
 ud_8                -6.176091e-02 1 1  ON 18
 ud_9                 7.876572e-02 1 1  ON 19
 eO_0                -8.482355e-01 1 1  ON 20
 eO_1                -5.334280e-01 1 1  ON 21
 eO_2                -1.319991e-01 1 1  ON 22
 eO_3                 1.299480e-01 1 1  ON 23
 eO_4                 2.523901e-01 1 1  ON 24
 eO_5                 3.241049e-01 1 1  ON 25
 eO_6                 3.535533e-01 1 1  ON 26
 eO_7                 3.246243e-01 1 1  ON 27
 eO_8                 7.355690e-02 1 1  ON 28
 eO_9                 3.251442e-02 1 1  ON 29
eH1_0                -2.001076e-01 1 1  ON 30
eH1_1                -1.227079e-01 1 1  ON 31
eH1_2                -8.182109e-02 1 1  ON 32
eH1_3                -4.513909e-02 1 1  ON 33
eH1_4                 1.849287e-03 1 1  ON 34
eH1_5                 1.628951e-02 1 1  ON 35
eH1_6                 6.354723e-02 1 1  ON 36
eH1_7                 9.590951e-02 1 1  ON 37
eH1_8                 1.830495e-01 1 1  ON 38
eH1_9                 5.919122e-02 1 1  ON 39
eH2_0                -1.972823e-01 1 1  ON 40
eH2_1                -1.179932e-01 1 1  ON 41
eH2_2                -7.679719e-02 1 1  ON 42
eH2_3                -4.113195e-02 1 1  ON 43
eH2_4                 5.793143e-03 1 1  ON 44
eH2_5                 2.166074e-02 1 1  ON 45
eH2_6                 6.239381e-02 1 1  ON 46
eH2_7                 7.361655e-02 1 1  ON 47
eH2_8                 1.831786e-01 1 1  ON 48
eH2_9                 6.285839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1672
    reference variance = 0.185355
====================================================
  Execution time = 2.0139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2037e-01
  Total weights = 2.0000e+06
  Execution time = 1.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321099197162
                                         uncertainty =       0.003125327014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321099197162
                                         uncertainty =       0.003125327014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400639725
  error estimate for blocks of size 2^( 2) =       0.000410228352
  error estimate for blocks of size 2^( 3) =       0.000418707632
  error estimate for blocks of size 2^( 4) =       0.000425022906
  error estimate for blocks of size 2^( 5) =       0.000428566585
  error estimate for blocks of size 2^( 6) =       0.000429213543
  error estimate for blocks of size 2^( 7) =       0.000432868430

      target function =                  N/A
              le_mean =     -17.216235933780
             les_mean =     296.719803944894
             stat err =       0.000428917866
             autocorr =       1.146146825735
              std dev =       0.566590132128
             le_variance =       0.321024377824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320523780071
                                         uncertainty =       0.003124961568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320523780071
                                         uncertainty =       0.003124961568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400280513
  error estimate for blocks of size 2^( 2) =       0.000409873919
  error estimate for blocks of size 2^( 3) =       0.000418326395
  error estimate for blocks of size 2^( 4) =       0.000424611133
  error estimate for blocks of size 2^( 5) =       0.000428147670
  error estimate for blocks of size 2^( 6) =       0.000428788691
  error estimate for blocks of size 2^( 7) =       0.000432300618

      target function =                  N/A
              le_mean =     -17.216263551576
             les_mean =     296.720179495270
             stat err =       0.000428462028
             autocorr =       1.145765610394
              std dev =       0.566082130232
             le_variance =       0.320448978169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319910139836
                                         uncertainty =       0.003122512523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319910139836
                                         uncertainty =       0.003122512523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399897578
  error estimate for blocks of size 2^( 2) =       0.000409499998
  error estimate for blocks of size 2^( 3) =       0.000417974834
  error estimate for blocks of size 2^( 4) =       0.000424295241
  error estimate for blocks of size 2^( 5) =       0.000427848774
  error estimate for blocks of size 2^( 6) =       0.000428529656
  error estimate for blocks of size 2^( 7) =       0.000432078321

      target function =                  N/A
              le_mean =     -17.216237409957
             les_mean =     296.718666541348
             stat err =       0.000428187998
             autocorr =       1.146493067617
              std dev =       0.565540577918
             le_variance =       0.319836145271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320665783346
                                         uncertainty =       0.003124615963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320665783346
                                         uncertainty =       0.003124615963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400369374
  error estimate for blocks of size 2^( 2) =       0.000409960997
  error estimate for blocks of size 2^( 3) =       0.000418437069
  error estimate for blocks of size 2^( 4) =       0.000424754032
  error estimate for blocks of size 2^( 5) =       0.000428296429
  error estimate for blocks of size 2^( 6) =       0.000428955235
  error estimate for blocks of size 2^( 7) =       0.000432584157

      target function =                  N/A
              le_mean =     -17.216222908685
             les_mean =     296.718922351931
             stat err =       0.000428647463
             autocorr =       1.146248601938
              std dev =       0.566207798170
             le_variance =       0.320591270708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216235933780        initial
     3.8147e-04     3.8147e-03             2.8168e-01       -17.216263551576  <--
     1.5259e-03     1.5259e-02             6.5955e-02       -17.216237409957
     6.1035e-03     6.1035e-02             1.7104e-02       -17.216222908685

*****************************************************************************
Applying the update for shift_i =   3.8147e-04     and shift_s =   3.8147e-03
*****************************************************************************

  Execution time = 2.9395e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.907682e-01 1 1  ON 0
 uu_1                 2.992280e-02 1 1  ON 1
 uu_2                -6.348312e-02 1 1  ON 2
 uu_3                -1.184837e-01 1 1  ON 3
 uu_4                -1.540767e-01 1 1  ON 4
 uu_5                -1.660222e-01 1 1  ON 5
 uu_6                -1.540355e-01 1 1  ON 6
 uu_7                -1.096310e-01 1 1  ON 7
 uu_8                -4.273347e-02 1 1  ON 8
 uu_9                 2.071833e-01 1 1  ON 9
 ud_0                 3.483503e-01 1 1  ON 10
 ud_1                 9.360465e-02 1 1  ON 11
 ud_2                -1.074255e-02 1 1  ON 12
 ud_3                -7.093267e-02 1 1  ON 13
 ud_4                -1.227317e-01 1 1  ON 14
 ud_5                -1.658007e-01 1 1  ON 15
 ud_6                -1.810951e-01 1 1  ON 16
 ud_7                -1.541829e-01 1 1  ON 17
 ud_8                -1.094981e-01 1 1  ON 18
 ud_9                 3.859868e-02 1 1  ON 19
 eO_0                -9.050046e-01 1 1  ON 20
 eO_1                -5.896619e-01 1 1  ON 21
 eO_2                -1.875419e-01 1 1  ON 22
 eO_3                 7.534441e-02 1 1  ON 23
 eO_4                 1.998994e-01 1 1  ON 24
 eO_5                 2.973430e-01 1 1  ON 25
 eO_6                 3.264016e-01 1 1  ON 26
 eO_7                 5.403482e-01 1 1  ON 27
 eO_8                 1.531126e-01 1 1  ON 28
 eO_9                 5.177523e-02 1 1  ON 29
eH1_0                -2.248870e-01 1 1  ON 30
eH1_1                -1.495627e-01 1 1  ON 31
eH1_2                -1.079165e-01 1 1  ON 32
eH1_3                -7.065973e-02 1 1  ON 33
eH1_4                -2.287177e-02 1 1  ON 34
eH1_5                -7.263580e-03 1 1  ON 35
eH1_6                 4.664767e-02 1 1  ON 36
eH1_7                 9.578441e-02 1 1  ON 37
eH1_8                 2.698543e-01 1 1  ON 38
eH1_9                 1.114757e-01 1 1  ON 39
eH2_0                -2.075245e-01 1 1  ON 40
eH2_1                -1.281144e-01 1 1  ON 41
eH2_2                -8.600012e-02 1 1  ON 42
eH2_3                -5.113426e-02 1 1  ON 43
eH2_4                -3.091578e-03 1 1  ON 44
eH2_5                 1.417469e-02 1 1  ON 45
eH2_6                 3.827523e-02 1 1  ON 46
eH2_7                 2.196967e-02 1 1  ON 47
eH2_8                 2.516430e-01 1 1  ON 48
eH2_9                 1.145052e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2523
    reference variance = 0.227131
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323984271786
                                         uncertainty =       0.003932067416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323984271786
                                         uncertainty =       0.003932067416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402480306
  error estimate for blocks of size 2^( 2) =       0.000412161938
  error estimate for blocks of size 2^( 3) =       0.000420650795
  error estimate for blocks of size 2^( 4) =       0.000426223371
  error estimate for blocks of size 2^( 5) =       0.000430377738
  error estimate for blocks of size 2^( 6) =       0.000432361031
  error estimate for blocks of size 2^( 7) =       0.000433527165

      target function =                  N/A
              le_mean =     -17.216417288425
             les_mean =     296.729004881160
             stat err =       0.000430622326
             autocorr =       1.144731980117
              std dev =       0.569193107808
             le_variance =       0.323980793976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641728842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-05, overlap shift 9.5367e-04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417288425       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423453419       residual = 9.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423525778       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216422780606       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425014832       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426761490       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216423202616       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216424609377       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216427099594       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216427156252       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216428701960       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216430974482       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216434795759       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216434841286       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216431821679       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216431225121       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216433442942       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216434396056       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216436205753       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216439022361       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216441890441       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216440229557       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216438680177       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216436564520       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216439587738       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216440137844       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216441973538       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216442908702       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216442337492       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216443411487       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-05 is 4.280699e-02

solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417288425       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423446285       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423520314       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216422781161       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425012155       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426757616       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216423215427       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216424599879       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216427083482       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216427122545       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216428655017       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216430912108       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216434665344       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216434671541       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216431710452       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216431128169       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216433260687       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216434155203       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216435808103       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216438387199       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216440951568       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216439330808       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216437845050       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216436013084       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216438550673       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216438942422       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216440444168       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-04 is 3.515273e-02

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216417288425       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216423417912       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216423498710       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216422783278       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216425001229       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216426741720       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216423265167       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216424563673       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216427020117       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216426991412       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216428473938       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216430671481       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216434166423       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216434030047       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216431295654       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216430767657       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216432603961       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216433321750       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216434496898       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216436376691       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216438105097       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216436737494       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216435462983       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216434442272       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216435872109       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216435996039       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-03 is 2.329852e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6098e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.908457e-01 1 1  ON 0
 uu_1                 2.921572e-02 1 1  ON 1
 uu_2                -6.425204e-02 1 1  ON 2
 uu_3                -1.195855e-01 1 1  ON 3
 uu_4                -1.558149e-01 1 1  ON 4
 uu_5                -1.683938e-01 1 1  ON 5
 uu_6                -1.579479e-01 1 1  ON 6
 uu_7                -1.119997e-01 1 1  ON 7
 uu_8                -3.842168e-02 1 1  ON 8
 uu_9                 1.918649e-01 1 1  ON 9
 ud_0                 3.500343e-01 1 1  ON 10
 ud_1                 9.491654e-02 1 1  ON 11
 ud_2                -1.000634e-02 1 1  ON 12
 ud_3                -7.023237e-02 1 1  ON 13
 ud_4                -1.224043e-01 1 1  ON 14
 ud_5                -1.628249e-01 1 1  ON 15
 ud_6                -1.777052e-01 1 1  ON 16
 ud_7                -1.552119e-01 1 1  ON 17
 ud_8                -1.123717e-01 1 1  ON 18
 ud_9                 2.089161e-02 1 1  ON 19
 eO_0                -9.108137e-01 1 1  ON 20
 eO_1                -5.958198e-01 1 1  ON 21
 eO_2                -1.919034e-01 1 1  ON 22
 eO_3                 7.527572e-02 1 1  ON 23
 eO_4                 2.073459e-01 1 1  ON 24
 eO_5                 3.053498e-01 1 1  ON 25
 eO_6                 3.293185e-01 1 1  ON 26
 eO_7                 5.192877e-01 1 1  ON 27
 eO_8                 1.661511e-01 1 1  ON 28
 eO_9                 5.648985e-02 1 1  ON 29
eH1_0                -2.192121e-01 1 1  ON 30
eH1_1                -1.402696e-01 1 1  ON 31
eH1_2                -9.973285e-02 1 1  ON 32
eH1_3                -6.283275e-02 1 1  ON 33
eH1_4                -1.597046e-02 1 1  ON 34
eH1_5                -2.223354e-03 1 1  ON 35
eH1_6                 4.170203e-02 1 1  ON 36
eH1_7                 6.475655e-02 1 1  ON 37
eH1_8                 2.571330e-01 1 1  ON 38
eH1_9                 1.156900e-01 1 1  ON 39
eH2_0                -2.106097e-01 1 1  ON 40
eH2_1                -1.306667e-01 1 1  ON 41
eH2_2                -8.965777e-02 1 1  ON 42
eH2_3                -5.288377e-02 1 1  ON 43
eH2_4                -7.385105e-03 1 1  ON 44
eH2_5                 2.824256e-03 1 1  ON 45
eH2_6                 3.733108e-02 1 1  ON 46
eH2_7                 5.712240e-02 1 1  ON 47
eH2_8                 2.372299e-01 1 1  ON 48
eH2_9                 1.161135e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.367137
====================================================
  Execution time = 1.9862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2593e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325361576007
                                         uncertainty =       0.003943631774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325361576007
                                         uncertainty =       0.003943631774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403275819
  error estimate for blocks of size 2^( 2) =       0.000412627566
  error estimate for blocks of size 2^( 3) =       0.000421066128
  error estimate for blocks of size 2^( 4) =       0.000426904417
  error estimate for blocks of size 2^( 5) =       0.000430132774
  error estimate for blocks of size 2^( 6) =       0.000431090878
  error estimate for blocks of size 2^( 7) =       0.000434100595

      target function =                  N/A
              le_mean =     -17.216664745580
             les_mean =     296.738807571173
             stat err =       0.000430557166
             autocorr =       1.139875135150
              std dev =       0.570318132381
             le_variance =       0.325262772123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325754956207
                                         uncertainty =       0.003964394877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325754956207
                                         uncertainty =       0.003964394877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403519891
  error estimate for blocks of size 2^( 2) =       0.000412842192
  error estimate for blocks of size 2^( 3) =       0.000421266113
  error estimate for blocks of size 2^( 4) =       0.000427117785
  error estimate for blocks of size 2^( 5) =       0.000430335534
  error estimate for blocks of size 2^( 6) =       0.000431294158
  error estimate for blocks of size 2^( 7) =       0.000434350043

      target function =                  N/A
              le_mean =     -17.216611303337
             les_mean =     296.737361212150
             stat err =       0.000430774380
             autocorr =       1.139645649604
              std dev =       0.570663302479
             le_variance =       0.325656604796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326872837866
                                         uncertainty =       0.003990586897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326872837866
                                         uncertainty =       0.003990586897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404211914
  error estimate for blocks of size 2^( 2) =       0.000413534088
  error estimate for blocks of size 2^( 3) =       0.000421963483
  error estimate for blocks of size 2^( 4) =       0.000427843860
  error estimate for blocks of size 2^( 5) =       0.000431077319
  error estimate for blocks of size 2^( 6) =       0.000432027751
  error estimate for blocks of size 2^( 7) =       0.000435107168

      target function =                  N/A
              le_mean =     -17.216610979834
             les_mean =     296.738468010807
             stat err =       0.000431514025
             autocorr =       1.139650302272
              std dev =       0.571641971220
             le_variance =       0.326774543260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325924054717
                                         uncertainty =       0.003965147651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325924054717
                                         uncertainty =       0.003965147651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403624476
  error estimate for blocks of size 2^( 2) =       0.000412949016
  error estimate for blocks of size 2^( 3) =       0.000421369501
  error estimate for blocks of size 2^( 4) =       0.000427214758
  error estimate for blocks of size 2^( 5) =       0.000430440716
  error estimate for blocks of size 2^( 6) =       0.000431392055
  error estimate for blocks of size 2^( 7) =       0.000434423913

      target function =                  N/A
              le_mean =     -17.216612858561
             les_mean =     296.737583593972
             stat err =       0.000430867860
             autocorr =       1.139549542886
              std dev =       0.570811208132
             le_variance =       0.325825435329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216664745580        initial  <--
     9.5367e-05     9.5367e-04             4.2807e-02       -17.216611303337
     3.8147e-04     3.8147e-03             3.5153e-02       -17.216610979834
     1.5259e-03     1.5259e-02             2.3299e-02       -17.216612858561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1484
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.907682e-01 1 1  ON 0
 uu_1                 2.992280e-02 1 1  ON 1
 uu_2                -6.348312e-02 1 1  ON 2
 uu_3                -1.184837e-01 1 1  ON 3
 uu_4                -1.540767e-01 1 1  ON 4
 uu_5                -1.660222e-01 1 1  ON 5
 uu_6                -1.540355e-01 1 1  ON 6
 uu_7                -1.096310e-01 1 1  ON 7
 uu_8                -4.273347e-02 1 1  ON 8
 uu_9                 2.071833e-01 1 1  ON 9
 ud_0                 3.483503e-01 1 1  ON 10
 ud_1                 9.360465e-02 1 1  ON 11
 ud_2                -1.074255e-02 1 1  ON 12
 ud_3                -7.093267e-02 1 1  ON 13
 ud_4                -1.227317e-01 1 1  ON 14
 ud_5                -1.658007e-01 1 1  ON 15
 ud_6                -1.810951e-01 1 1  ON 16
 ud_7                -1.541829e-01 1 1  ON 17
 ud_8                -1.094981e-01 1 1  ON 18
 ud_9                 3.859868e-02 1 1  ON 19
 eO_0                -9.050046e-01 1 1  ON 20
 eO_1                -5.896619e-01 1 1  ON 21
 eO_2                -1.875419e-01 1 1  ON 22
 eO_3                 7.534441e-02 1 1  ON 23
 eO_4                 1.998994e-01 1 1  ON 24
 eO_5                 2.973430e-01 1 1  ON 25
 eO_6                 3.264016e-01 1 1  ON 26
 eO_7                 5.403482e-01 1 1  ON 27
 eO_8                 1.531126e-01 1 1  ON 28
 eO_9                 5.177523e-02 1 1  ON 29
eH1_0                -2.248870e-01 1 1  ON 30
eH1_1                -1.495627e-01 1 1  ON 31
eH1_2                -1.079165e-01 1 1  ON 32
eH1_3                -7.065973e-02 1 1  ON 33
eH1_4                -2.287177e-02 1 1  ON 34
eH1_5                -7.263580e-03 1 1  ON 35
eH1_6                 4.664767e-02 1 1  ON 36
eH1_7                 9.578441e-02 1 1  ON 37
eH1_8                 2.698543e-01 1 1  ON 38
eH1_9                 1.114757e-01 1 1  ON 39
eH2_0                -2.075245e-01 1 1  ON 40
eH2_1                -1.281144e-01 1 1  ON 41
eH2_2                -8.600012e-02 1 1  ON 42
eH2_3                -5.113426e-02 1 1  ON 43
eH2_4                -3.091578e-03 1 1  ON 44
eH2_5                 1.417469e-02 1 1  ON 45
eH2_6                 3.827523e-02 1 1  ON 46
eH2_7                 2.196967e-02 1 1  ON 47
eH2_8                 2.516430e-01 1 1  ON 48
eH2_9                 1.145052e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.303345
====================================================
  Execution time = 2.0588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324956223195
                                         uncertainty =       0.003574366190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324956223195
                                         uncertainty =       0.003574366190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403051510
  error estimate for blocks of size 2^( 2) =       0.000412507933
  error estimate for blocks of size 2^( 3) =       0.000421013110
  error estimate for blocks of size 2^( 4) =       0.000427854409
  error estimate for blocks of size 2^( 5) =       0.000430783853
  error estimate for blocks of size 2^( 6) =       0.000433172259
  error estimate for blocks of size 2^( 7) =       0.000433509920

      target function =                  N/A
              le_mean =     -17.216385418050
             les_mean =     296.728827740345
             stat err =       0.000431330110
             autocorr =       1.145245111893
              std dev =       0.570000912234
             le_variance =       0.324901039948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638541805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385418050       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387338846       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391239248       residual = 9.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216398084240       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216399410805       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216399702025       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216402622606       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216405769550       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216403199917       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216406028788       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216407067350       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216403203659       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216407381834       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216404937406       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216404012512       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216404390807       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216404393157       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216404513503       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216404423730       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216406659607       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216407219184       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216410103907       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216408359893       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216410641703       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216411710420       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-04 is 3.428517e-02

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385418050       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387305480       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391062760       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216397926250       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216399162287       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216399622558       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216401906971       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216405490291       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216402869985       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216404832463       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216406158691       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216402728469       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216406371699       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216403988277       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216403406432       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216403688674       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216403693102       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216403800946       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216403716730       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216405007670       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216405290211       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216406493469       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216405559807       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216406346800       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-03 is 1.747991e-02

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216385418050       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387182855       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390452801       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216397353213       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216398259088       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216399264009       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216399579970       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216403411616       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216402242184       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216402688287       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216403336102       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216401258833       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216403360340       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216401415659       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216401633118       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216401677345       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216401747430       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216401767153       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216401749535       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-02 is 7.633270e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6226e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.916470e-01 1 1  ON 0
 uu_1                 2.963734e-02 1 1  ON 1
 uu_2                -6.378854e-02 1 1  ON 2
 uu_3                -1.194747e-01 1 1  ON 3
 uu_4                -1.554112e-01 1 1  ON 4
 uu_5                -1.680898e-01 1 1  ON 5
 uu_6                -1.570170e-01 1 1  ON 6
 uu_7                -1.094616e-01 1 1  ON 7
 uu_8                -4.012399e-02 1 1  ON 8
 uu_9                 2.020353e-01 1 1  ON 9
 ud_0                 3.483401e-01 1 1  ON 10
 ud_1                 9.302513e-02 1 1  ON 11
 ud_2                -1.147204e-02 1 1  ON 12
 ud_3                -7.132827e-02 1 1  ON 13
 ud_4                -1.233027e-01 1 1  ON 14
 ud_5                -1.633783e-01 1 1  ON 15
 ud_6                -1.794740e-01 1 1  ON 16
 ud_7                -1.552584e-01 1 1  ON 17
 ud_8                -1.090026e-01 1 1  ON 18
 ud_9                 3.261096e-02 1 1  ON 19
 eO_0                -9.071097e-01 1 1  ON 20
 eO_1                -5.922300e-01 1 1  ON 21
 eO_2                -1.893291e-01 1 1  ON 22
 eO_3                 7.731573e-02 1 1  ON 23
 eO_4                 2.050865e-01 1 1  ON 24
 eO_5                 2.946154e-01 1 1  ON 25
 eO_6                 3.285511e-01 1 1  ON 26
 eO_7                 5.356093e-01 1 1  ON 27
 eO_8                 1.562606e-01 1 1  ON 28
 eO_9                 5.252032e-02 1 1  ON 29
eH1_0                -2.217879e-01 1 1  ON 30
eH1_1                -1.439303e-01 1 1  ON 31
eH1_2                -1.032252e-01 1 1  ON 32
eH1_3                -6.612434e-02 1 1  ON 33
eH1_4                -1.892002e-02 1 1  ON 34
eH1_5                -3.911881e-03 1 1  ON 35
eH1_6                 4.350402e-02 1 1  ON 36
eH1_7                 7.830450e-02 1 1  ON 37
eH1_8                 2.635203e-01 1 1  ON 38
eH1_9                 1.123876e-01 1 1  ON 39
eH2_0                -2.103115e-01 1 1  ON 40
eH2_1                -1.316291e-01 1 1  ON 41
eH2_2                -9.085955e-02 1 1  ON 42
eH2_3                -5.428249e-02 1 1  ON 43
eH2_4                -7.252194e-03 1 1  ON 44
eH2_5                 5.199605e-03 1 1  ON 45
eH2_6                 4.933417e-02 1 1  ON 46
eH2_7                 3.890215e-02 1 1  ON 47
eH2_8                 2.489089e-01 1 1  ON 48
eH2_9                 1.154093e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.150416
====================================================
  Execution time = 1.9966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2451e-01
  Total weights = 2.0000e+06
  Execution time = 1.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323776318468
                                         uncertainty =       0.004641809663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323776318468
                                         uncertainty =       0.004641809663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402298064
  error estimate for blocks of size 2^( 2) =       0.000411882903
  error estimate for blocks of size 2^( 3) =       0.000420334543
  error estimate for blocks of size 2^( 4) =       0.000426351348
  error estimate for blocks of size 2^( 5) =       0.000430073330
  error estimate for blocks of size 2^( 6) =       0.000431769141
  error estimate for blocks of size 2^( 7) =       0.000431735917

      target function =                  N/A
              le_mean =     -17.215709507336
             les_mean =     296.704341144068
             stat err =       0.000429982434
             autocorr =       1.142366717762
              std dev =       0.568935378508
             le_variance =       0.323687464918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324648303399
                                         uncertainty =       0.004650109886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324648303399
                                         uncertainty =       0.004650109886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402839095
  error estimate for blocks of size 2^( 2) =       0.000412386182
  error estimate for blocks of size 2^( 3) =       0.000420805454
  error estimate for blocks of size 2^( 4) =       0.000426814636
  error estimate for blocks of size 2^( 5) =       0.000430514463
  error estimate for blocks of size 2^( 6) =       0.000432205999
  error estimate for blocks of size 2^( 7) =       0.000432189871

      target function =                  N/A
              le_mean =     -17.215684350144
             les_mean =     296.704346153950
             stat err =       0.000430431242
             autocorr =       1.141679888554
              std dev =       0.569700511182
             le_variance =       0.324558672441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325575416446
                                         uncertainty =       0.004657476218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325575416446
                                         uncertainty =       0.004657476218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403413570
  error estimate for blocks of size 2^( 2) =       0.000412951778
  error estimate for blocks of size 2^( 3) =       0.000421371197
  error estimate for blocks of size 2^( 4) =       0.000427397295
  error estimate for blocks of size 2^( 5) =       0.000431091321
  error estimate for blocks of size 2^( 6) =       0.000432796951
  error estimate for blocks of size 2^( 7) =       0.000432810138

      target function =                  N/A
              le_mean =     -17.215706487741
             les_mean =     296.706034726425
             stat err =       0.000431023926
             autocorr =       1.141567907730
              std dev =       0.570512942105
             le_variance =       0.325485017109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503979156
                                         uncertainty =       0.004648851033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503979156
                                         uncertainty =       0.004648851033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402749584
  error estimate for blocks of size 2^( 2) =       0.000412306066
  error estimate for blocks of size 2^( 3) =       0.000420736162
  error estimate for blocks of size 2^( 4) =       0.000426754867
  error estimate for blocks of size 2^( 5) =       0.000430462758
  error estimate for blocks of size 2^( 6) =       0.000432162564
  error estimate for blocks of size 2^( 7) =       0.000432150125

      target function =                  N/A
              le_mean =     -17.215690716487
             les_mean =     296.704421137603
             stat err =       0.000430382579
             autocorr =       1.141929168578
              std dev =       0.569573923279
             le_variance =       0.324414454080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215709507336        initial  <--
     9.5367e-04     9.5367e-03             3.4285e-02       -17.215684350144
     3.8147e-03     3.8147e-02             1.7480e-02       -17.215706487741
     1.5259e-02     1.5259e-01             7.6333e-03       -17.215690716487

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2191
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.907682e-01 1 1  ON 0
 uu_1                 2.992280e-02 1 1  ON 1
 uu_2                -6.348312e-02 1 1  ON 2
 uu_3                -1.184837e-01 1 1  ON 3
 uu_4                -1.540767e-01 1 1  ON 4
 uu_5                -1.660222e-01 1 1  ON 5
 uu_6                -1.540355e-01 1 1  ON 6
 uu_7                -1.096310e-01 1 1  ON 7
 uu_8                -4.273347e-02 1 1  ON 8
 uu_9                 2.071833e-01 1 1  ON 9
 ud_0                 3.483503e-01 1 1  ON 10
 ud_1                 9.360465e-02 1 1  ON 11
 ud_2                -1.074255e-02 1 1  ON 12
 ud_3                -7.093267e-02 1 1  ON 13
 ud_4                -1.227317e-01 1 1  ON 14
 ud_5                -1.658007e-01 1 1  ON 15
 ud_6                -1.810951e-01 1 1  ON 16
 ud_7                -1.541829e-01 1 1  ON 17
 ud_8                -1.094981e-01 1 1  ON 18
 ud_9                 3.859868e-02 1 1  ON 19
 eO_0                -9.050046e-01 1 1  ON 20
 eO_1                -5.896619e-01 1 1  ON 21
 eO_2                -1.875419e-01 1 1  ON 22
 eO_3                 7.534441e-02 1 1  ON 23
 eO_4                 1.998994e-01 1 1  ON 24
 eO_5                 2.973430e-01 1 1  ON 25
 eO_6                 3.264016e-01 1 1  ON 26
 eO_7                 5.403482e-01 1 1  ON 27
 eO_8                 1.531126e-01 1 1  ON 28
 eO_9                 5.177523e-02 1 1  ON 29
eH1_0                -2.248870e-01 1 1  ON 30
eH1_1                -1.495627e-01 1 1  ON 31
eH1_2                -1.079165e-01 1 1  ON 32
eH1_3                -7.065973e-02 1 1  ON 33
eH1_4                -2.287177e-02 1 1  ON 34
eH1_5                -7.263580e-03 1 1  ON 35
eH1_6                 4.664767e-02 1 1  ON 36
eH1_7                 9.578441e-02 1 1  ON 37
eH1_8                 2.698543e-01 1 1  ON 38
eH1_9                 1.114757e-01 1 1  ON 39
eH2_0                -2.075245e-01 1 1  ON 40
eH2_1                -1.281144e-01 1 1  ON 41
eH2_2                -8.600012e-02 1 1  ON 42
eH2_3                -5.113426e-02 1 1  ON 43
eH2_4                -3.091578e-03 1 1  ON 44
eH2_5                 1.417469e-02 1 1  ON 45
eH2_6                 3.827523e-02 1 1  ON 46
eH2_7                 2.196967e-02 1 1  ON 47
eH2_8                 2.516430e-01 1 1  ON 48
eH2_9                 1.145052e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.449438
====================================================
  Execution time = 2.0593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2511e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324935997756
                                         uncertainty =       0.005631971803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324935997756
                                         uncertainty =       0.005631971803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403179336
  error estimate for blocks of size 2^( 2) =       0.000412707605
  error estimate for blocks of size 2^( 3) =       0.000420969499
  error estimate for blocks of size 2^( 4) =       0.000426517824
  error estimate for blocks of size 2^( 5) =       0.000430593758
  error estimate for blocks of size 2^( 6) =       0.000432319581
  error estimate for blocks of size 2^( 7) =       0.000434645029

      target function =                  N/A
              le_mean =     -17.216262291590
             les_mean =     296.724794283644
             stat err =       0.000431019048
             autocorr =       1.142868852837
              std dev =       0.570181684544
             le_variance =       0.325107153390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626229159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216262291590       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216261970816       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216262992632       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216270243417       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216273910800       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216282647232       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216287771877       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216289347529       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288684128       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216288148355       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216291545500       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216292656987       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216292835909       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216292935745       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216292202746       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216291728221       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216292692973       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216292977801       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216292961496       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216292303991       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 1.071570e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216262291590       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216262003248       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216263422536       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216269622896       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216272220357       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216278957626       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216282488845       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216283064176       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216282204289       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216281523462       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216283084492       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216283431060       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216282948650       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216283006493       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.003725e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216262291590       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216262086280       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216264511358       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267860688       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216268857267       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216272139612       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216273230978       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216273264436       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216272800980       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216272712053       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216272977161       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.466855e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6168e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.910838e-01 1 1  ON 0
 uu_1                 2.957316e-02 1 1  ON 1
 uu_2                -6.370139e-02 1 1  ON 2
 uu_3                -1.188954e-01 1 1  ON 3
 uu_4                -1.546506e-01 1 1  ON 4
 uu_5                -1.665150e-01 1 1  ON 5
 uu_6                -1.545564e-01 1 1  ON 6
 uu_7                -1.093305e-01 1 1  ON 7
 uu_8                -4.147401e-02 1 1  ON 8
 uu_9                 2.068420e-01 1 1  ON 9
 ud_0                 3.477569e-01 1 1  ON 10
 ud_1                 9.282707e-02 1 1  ON 11
 ud_2                -1.194613e-02 1 1  ON 12
 ud_3                -7.176622e-02 1 1  ON 13
 ud_4                -1.235926e-01 1 1  ON 14
 ud_5                -1.637770e-01 1 1  ON 15
 ud_6                -1.790485e-01 1 1  ON 16
 ud_7                -1.547856e-01 1 1  ON 17
 ud_8                -1.092409e-01 1 1  ON 18
 ud_9                 3.838341e-02 1 1  ON 19
 eO_0                -9.054209e-01 1 1  ON 20
 eO_1                -5.906486e-01 1 1  ON 21
 eO_2                -1.886592e-01 1 1  ON 22
 eO_3                 7.552049e-02 1 1  ON 23
 eO_4                 2.018524e-01 1 1  ON 24
 eO_5                 2.972991e-01 1 1  ON 25
 eO_6                 3.264787e-01 1 1  ON 26
 eO_7                 5.396551e-01 1 1  ON 27
 eO_8                 1.538414e-01 1 1  ON 28
 eO_9                 5.197964e-02 1 1  ON 29
eH1_0                -2.249839e-01 1 1  ON 30
eH1_1                -1.475306e-01 1 1  ON 31
eH1_2                -1.067327e-01 1 1  ON 32
eH1_3                -6.967108e-02 1 1  ON 33
eH1_4                -2.273916e-02 1 1  ON 34
eH1_5                -7.947662e-03 1 1  ON 35
eH1_6                 4.433325e-02 1 1  ON 36
eH1_7                 9.434984e-02 1 1  ON 37
eH1_8                 2.695462e-01 1 1  ON 38
eH1_9                 1.116757e-01 1 1  ON 39
eH2_0                -2.070861e-01 1 1  ON 40
eH2_1                -1.281253e-01 1 1  ON 41
eH2_2                -8.763660e-02 1 1  ON 42
eH2_3                -5.126523e-02 1 1  ON 43
eH2_4                -4.707638e-03 1 1  ON 44
eH2_5                 1.017096e-02 1 1  ON 45
eH2_6                 4.196925e-02 1 1  ON 46
eH2_7                 2.495618e-02 1 1  ON 47
eH2_8                 2.515034e-01 1 1  ON 48
eH2_9                 1.147263e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1695
    reference variance = 0.148386
====================================================
  Execution time = 1.9884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3904e-01
  Total weights = 2.0000e+06
  Execution time = 1.8360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338643655020
                                         uncertainty =       0.011403328407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338643655020
                                         uncertainty =       0.011403328407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411430095
  error estimate for blocks of size 2^( 2) =       0.000420961562
  error estimate for blocks of size 2^( 3) =       0.000428737182
  error estimate for blocks of size 2^( 4) =       0.000433973122
  error estimate for blocks of size 2^( 5) =       0.000437838518
  error estimate for blocks of size 2^( 6) =       0.000440487331
  error estimate for blocks of size 2^( 7) =       0.000442943747

      target function =                  N/A
              le_mean =     -17.216656090993
             les_mean =     296.751796232488
             stat err =       0.000438810680
             autocorr =       1.137528444440
              std dev =       0.581850020400
             le_variance =       0.338549446239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339201400815
                                         uncertainty =       0.011433834846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339201400815
                                         uncertainty =       0.011433834846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411768944
  error estimate for blocks of size 2^( 2) =       0.000421272431
  error estimate for blocks of size 2^( 3) =       0.000429024089
  error estimate for blocks of size 2^( 4) =       0.000434243488
  error estimate for blocks of size 2^( 5) =       0.000438131840
  error estimate for blocks of size 2^( 6) =       0.000440784877
  error estimate for blocks of size 2^( 7) =       0.000443237736

      target function =                  N/A
              le_mean =     -17.216662008191
             les_mean =     296.752557860983
             stat err =       0.000439099485
             autocorr =       1.137152418088
              std dev =       0.582329224960
             le_variance =       0.339107326243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339722460592
                                         uncertainty =       0.011455963076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339722460592
                                         uncertainty =       0.011455963076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412085306
  error estimate for blocks of size 2^( 2) =       0.000421576865
  error estimate for blocks of size 2^( 3) =       0.000429317448
  error estimate for blocks of size 2^( 4) =       0.000434532282
  error estimate for blocks of size 2^( 5) =       0.000438436419
  error estimate for blocks of size 2^( 6) =       0.000441083077
  error estimate for blocks of size 2^( 7) =       0.000443560034

      target function =                  N/A
              le_mean =     -17.216675695045
             les_mean =     296.753550416805
             stat err =       0.000439402953
             autocorr =       1.136977017159
              std dev =       0.582776628093
             le_variance =       0.339628598251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339092091848
                                         uncertainty =       0.011426991435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339092091848
                                         uncertainty =       0.011426991435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411702569
  error estimate for blocks of size 2^( 2) =       0.000421214317
  error estimate for blocks of size 2^( 3) =       0.000428970825
  error estimate for blocks of size 2^( 4) =       0.000434194267
  error estimate for blocks of size 2^( 5) =       0.000438067470
  error estimate for blocks of size 2^( 6) =       0.000440710230
  error estimate for blocks of size 2^( 7) =       0.000443180283

      target function =                  N/A
              le_mean =     -17.216652029218
             les_mean =     296.752104935920
             stat err =       0.000439038062
             autocorr =       1.137200894480
              std dev =       0.582235356390
             le_variance =       0.338998010231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216656090993        initial
     9.5367e-03     9.5367e-02             1.0716e-02       -17.216662008191
     3.8147e-02     3.8147e-01             4.0037e-03       -17.216675695045  <--
     1.5259e-01     1.5259e+00             1.4669e-03       -17.216652029218

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9142e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.910838e-01 1 1  ON 0
 uu_1                 2.957316e-02 1 1  ON 1
 uu_2                -6.370139e-02 1 1  ON 2
 uu_3                -1.188954e-01 1 1  ON 3
 uu_4                -1.546506e-01 1 1  ON 4
 uu_5                -1.665150e-01 1 1  ON 5
 uu_6                -1.545564e-01 1 1  ON 6
 uu_7                -1.093305e-01 1 1  ON 7
 uu_8                -4.147401e-02 1 1  ON 8
 uu_9                 2.068420e-01 1 1  ON 9
 ud_0                 3.477569e-01 1 1  ON 10
 ud_1                 9.282707e-02 1 1  ON 11
 ud_2                -1.194613e-02 1 1  ON 12
 ud_3                -7.176622e-02 1 1  ON 13
 ud_4                -1.235926e-01 1 1  ON 14
 ud_5                -1.637770e-01 1 1  ON 15
 ud_6                -1.790485e-01 1 1  ON 16
 ud_7                -1.547856e-01 1 1  ON 17
 ud_8                -1.092409e-01 1 1  ON 18
 ud_9                 3.838341e-02 1 1  ON 19
 eO_0                -9.054209e-01 1 1  ON 20
 eO_1                -5.906486e-01 1 1  ON 21
 eO_2                -1.886592e-01 1 1  ON 22
 eO_3                 7.552049e-02 1 1  ON 23
 eO_4                 2.018524e-01 1 1  ON 24
 eO_5                 2.972991e-01 1 1  ON 25
 eO_6                 3.264787e-01 1 1  ON 26
 eO_7                 5.396551e-01 1 1  ON 27
 eO_8                 1.538414e-01 1 1  ON 28
 eO_9                 5.197964e-02 1 1  ON 29
eH1_0                -2.249839e-01 1 1  ON 30
eH1_1                -1.475306e-01 1 1  ON 31
eH1_2                -1.067327e-01 1 1  ON 32
eH1_3                -6.967108e-02 1 1  ON 33
eH1_4                -2.273916e-02 1 1  ON 34
eH1_5                -7.947662e-03 1 1  ON 35
eH1_6                 4.433325e-02 1 1  ON 36
eH1_7                 9.434984e-02 1 1  ON 37
eH1_8                 2.695462e-01 1 1  ON 38
eH1_9                 1.116757e-01 1 1  ON 39
eH2_0                -2.070861e-01 1 1  ON 40
eH2_1                -1.281253e-01 1 1  ON 41
eH2_2                -8.763660e-02 1 1  ON 42
eH2_3                -5.126523e-02 1 1  ON 43
eH2_4                -4.707638e-03 1 1  ON 44
eH2_5                 1.017096e-02 1 1  ON 45
eH2_6                 4.196925e-02 1 1  ON 46
eH2_7                 2.495618e-02 1 1  ON 47
eH2_8                 2.515034e-01 1 1  ON 48
eH2_9                 1.147263e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5338e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.15
    reference variance = 0.12983
====================================================
  Execution time = 2.0368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2075e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320736366295
                                         uncertainty =       0.003972391053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320736366295
                                         uncertainty =       0.003972391053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400465803
  error estimate for blocks of size 2^( 2) =       0.000409888219
  error estimate for blocks of size 2^( 3) =       0.000418172710
  error estimate for blocks of size 2^( 4) =       0.000424669506
  error estimate for blocks of size 2^( 5) =       0.000428310423
  error estimate for blocks of size 2^( 6) =       0.000431659624
  error estimate for blocks of size 2^( 7) =       0.000431152094

      target function =                  N/A
              le_mean =     -17.216128376874
             les_mean =     296.715821847506
             stat err =       0.000428947912
             autocorr =       1.147303300490
              std dev =       0.566344169971
             le_variance =       0.320745718860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612837687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216128376874       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216123823739       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216122371106       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216122842065       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216124571901       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216125371855       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216123120524       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216124870666       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216129021917       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216128842059       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216129055126       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216129277546       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216130581027       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216131595300       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216132017382       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216132263900       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216131326688       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216131565593       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216132483541       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216132702672       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 1.017378e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216128376874       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216124320423       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216123212992       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216123680010       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216125213634       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216126010440       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216124286729       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216125642412       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216128108730       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216127719271       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216127953072       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216127571966       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216127993776       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216128015080       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 3.322353e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216128376874       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216125552725       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216125001451       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216125302264       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216126599988       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216127027241       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216126460859       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216127034998       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216127398086       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216127470181       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.369491e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5946e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.916893e-01 1 1  ON 0
 uu_1                 2.939574e-02 1 1  ON 1
 uu_2                -6.394801e-02 1 1  ON 2
 uu_3                -1.193305e-01 1 1  ON 3
 uu_4                -1.553110e-01 1 1  ON 4
 uu_5                -1.674817e-01 1 1  ON 5
 uu_6                -1.547921e-01 1 1  ON 6
 uu_7                -1.089896e-01 1 1  ON 7
 uu_8                -4.036863e-02 1 1  ON 8
 uu_9                 2.064156e-01 1 1  ON 9
 ud_0                 3.481281e-01 1 1  ON 10
 ud_1                 9.265201e-02 1 1  ON 11
 ud_2                -1.198246e-02 1 1  ON 12
 ud_3                -7.190595e-02 1 1  ON 13
 ud_4                -1.235298e-01 1 1  ON 14
 ud_5                -1.637866e-01 1 1  ON 15
 ud_6                -1.791417e-01 1 1  ON 16
 ud_7                -1.555337e-01 1 1  ON 17
 ud_8                -1.087273e-01 1 1  ON 18
 ud_9                 3.804715e-02 1 1  ON 19
 eO_0                -9.058396e-01 1 1  ON 20
 eO_1                -5.909247e-01 1 1  ON 21
 eO_2                -1.886905e-01 1 1  ON 22
 eO_3                 7.613735e-02 1 1  ON 23
 eO_4                 2.025131e-01 1 1  ON 24
 eO_5                 2.964939e-01 1 1  ON 25
 eO_6                 3.263891e-01 1 1  ON 26
 eO_7                 5.390473e-01 1 1  ON 27
 eO_8                 1.545426e-01 1 1  ON 28
 eO_9                 5.213597e-02 1 1  ON 29
eH1_0                -2.253841e-01 1 1  ON 30
eH1_1                -1.467939e-01 1 1  ON 31
eH1_2                -1.061009e-01 1 1  ON 32
eH1_3                -6.859975e-02 1 1  ON 33
eH1_4                -2.115457e-02 1 1  ON 34
eH1_5                -5.899563e-03 1 1  ON 35
eH1_6                 4.132365e-02 1 1  ON 36
eH1_7                 9.153127e-02 1 1  ON 37
eH1_8                 2.690505e-01 1 1  ON 38
eH1_9                 1.120910e-01 1 1  ON 39
eH2_0                -2.067123e-01 1 1  ON 40
eH2_1                -1.287037e-01 1 1  ON 41
eH2_2                -8.799199e-02 1 1  ON 42
eH2_3                -5.137158e-02 1 1  ON 43
eH2_4                -5.300916e-03 1 1  ON 44
eH2_5                 6.848612e-03 1 1  ON 45
eH2_6                 4.340650e-02 1 1  ON 46
eH2_7                 2.787154e-02 1 1  ON 47
eH2_8                 2.513815e-01 1 1  ON 48
eH2_9                 1.148647e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1337
    reference variance = 0.377358
====================================================
  Execution time = 1.9907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2156e-01
  Total weights = 2.0000e+06
  Execution time = 1.8285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320954639569
                                         uncertainty =       0.002931074533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320954639569
                                         uncertainty =       0.002931074533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400612320
  error estimate for blocks of size 2^( 2) =       0.000409793673
  error estimate for blocks of size 2^( 3) =       0.000417923373
  error estimate for blocks of size 2^( 4) =       0.000423558389
  error estimate for blocks of size 2^( 5) =       0.000427558747
  error estimate for blocks of size 2^( 6) =       0.000428538540
  error estimate for blocks of size 2^( 7) =       0.000430306383

      target function =                  N/A
              le_mean =     -17.217612339643
             les_mean =     296.767154980416
             stat err =       0.000427490515
             autocorr =       1.138687000943
              std dev =       0.566551376904
             le_variance =       0.320980462672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321602970399
                                         uncertainty =       0.002938650206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321602970399
                                         uncertainty =       0.002938650206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401017196
  error estimate for blocks of size 2^( 2) =       0.000410185560
  error estimate for blocks of size 2^( 3) =       0.000418302751
  error estimate for blocks of size 2^( 4) =       0.000423925296
  error estimate for blocks of size 2^( 5) =       0.000427909455
  error estimate for blocks of size 2^( 6) =       0.000428862819
  error estimate for blocks of size 2^( 7) =       0.000430606544

      target function =                  N/A
              le_mean =     -17.217610879396
             les_mean =     296.767753816053
             stat err =       0.000427826028
             autocorr =       1.138173355395
              std dev =       0.567123956963
             le_variance =       0.321629582561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322131411233
                                         uncertainty =       0.002944657349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322131411233
                                         uncertainty =       0.002944657349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401346754
  error estimate for blocks of size 2^( 2) =       0.000410506987
  error estimate for blocks of size 2^( 3) =       0.000418615765
  error estimate for blocks of size 2^( 4) =       0.000424235003
  error estimate for blocks of size 2^( 5) =       0.000428211202
  error estimate for blocks of size 2^( 6) =       0.000429151839
  error estimate for blocks of size 2^( 7) =       0.000430890581

      target function =                  N/A
              le_mean =     -17.217616415020
             les_mean =     296.768473287378
             stat err =       0.000428122156
             autocorr =       1.137878519894
              std dev =       0.567590022544
             le_variance =       0.322158433692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321404124259
                                         uncertainty =       0.002936328500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321404124259
                                         uncertainty =       0.002936328500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400892865
  error estimate for blocks of size 2^( 2) =       0.000410064845
  error estimate for blocks of size 2^( 3) =       0.000418185708
  error estimate for blocks of size 2^( 4) =       0.000423815254
  error estimate for blocks of size 2^( 5) =       0.000427807941
  error estimate for blocks of size 2^( 6) =       0.000428777363
  error estimate for blocks of size 2^( 7) =       0.000430537819

      target function =                  N/A
              le_mean =     -17.217612247937
             les_mean =     296.767601538333
             stat err =       0.000427734594
             autocorr =       1.138392690621
              std dev =       0.566948127027
             le_variance =       0.321430178739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217612339643        initial
     9.5367e-03     9.5367e-02             1.0174e-02       -17.217610879396
     3.8147e-02     3.8147e-01             3.3224e-03       -17.217616415020  <--
     1.5259e-01     1.5259e+00             1.3695e-03       -17.217612247937

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9181e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.916893e-01 1 1  ON 0
 uu_1                 2.939574e-02 1 1  ON 1
 uu_2                -6.394801e-02 1 1  ON 2
 uu_3                -1.193305e-01 1 1  ON 3
 uu_4                -1.553110e-01 1 1  ON 4
 uu_5                -1.674817e-01 1 1  ON 5
 uu_6                -1.547921e-01 1 1  ON 6
 uu_7                -1.089896e-01 1 1  ON 7
 uu_8                -4.036863e-02 1 1  ON 8
 uu_9                 2.064156e-01 1 1  ON 9
 ud_0                 3.481281e-01 1 1  ON 10
 ud_1                 9.265201e-02 1 1  ON 11
 ud_2                -1.198246e-02 1 1  ON 12
 ud_3                -7.190595e-02 1 1  ON 13
 ud_4                -1.235298e-01 1 1  ON 14
 ud_5                -1.637866e-01 1 1  ON 15
 ud_6                -1.791417e-01 1 1  ON 16
 ud_7                -1.555337e-01 1 1  ON 17
 ud_8                -1.087273e-01 1 1  ON 18
 ud_9                 3.804715e-02 1 1  ON 19
 eO_0                -9.058396e-01 1 1  ON 20
 eO_1                -5.909247e-01 1 1  ON 21
 eO_2                -1.886905e-01 1 1  ON 22
 eO_3                 7.613735e-02 1 1  ON 23
 eO_4                 2.025131e-01 1 1  ON 24
 eO_5                 2.964939e-01 1 1  ON 25
 eO_6                 3.263891e-01 1 1  ON 26
 eO_7                 5.390473e-01 1 1  ON 27
 eO_8                 1.545426e-01 1 1  ON 28
 eO_9                 5.213597e-02 1 1  ON 29
eH1_0                -2.253841e-01 1 1  ON 30
eH1_1                -1.467939e-01 1 1  ON 31
eH1_2                -1.061009e-01 1 1  ON 32
eH1_3                -6.859975e-02 1 1  ON 33
eH1_4                -2.115457e-02 1 1  ON 34
eH1_5                -5.899563e-03 1 1  ON 35
eH1_6                 4.132365e-02 1 1  ON 36
eH1_7                 9.153127e-02 1 1  ON 37
eH1_8                 2.690505e-01 1 1  ON 38
eH1_9                 1.120910e-01 1 1  ON 39
eH2_0                -2.067123e-01 1 1  ON 40
eH2_1                -1.287037e-01 1 1  ON 41
eH2_2                -8.799199e-02 1 1  ON 42
eH2_3                -5.137158e-02 1 1  ON 43
eH2_4                -5.300916e-03 1 1  ON 44
eH2_5                 6.848612e-03 1 1  ON 45
eH2_6                 4.340650e-02 1 1  ON 46
eH2_7                 2.787154e-02 1 1  ON 47
eH2_8                 2.513815e-01 1 1  ON 48
eH2_9                 1.148647e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5179e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.204228
====================================================
  Execution time = 2.2534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2138e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354227011
                                         uncertainty =       0.002903429836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354227011
                                         uncertainty =       0.002903429836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400862962
  error estimate for blocks of size 2^( 2) =       0.000410706667
  error estimate for blocks of size 2^( 3) =       0.000419121486
  error estimate for blocks of size 2^( 4) =       0.000425539076
  error estimate for blocks of size 2^( 5) =       0.000428668316
  error estimate for blocks of size 2^( 6) =       0.000431014552
  error estimate for blocks of size 2^( 7) =       0.000433940233

      target function =                  N/A
              le_mean =     -17.216460459939
             les_mean =     296.727892836159
             stat err =       0.000429790544
             autocorr =       1.149534079641
              std dev =       0.566905837155
             le_variance =       0.321382228200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646045994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460459939       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462677409       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463097879       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216463480833       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216465365911       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216465903859       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464777132       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216468352488       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216470193755       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216468925358       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216469203218       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216469072435       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216469358410       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216468768010       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216469087169       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216468840685       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 6.179887e-03

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460459939       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462355456       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216462785242       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216463139995       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464696018       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216464625150       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216463832714       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216466226097       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216466869476       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216466119560       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216466127089       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216465959994       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 2.316543e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460459939       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461659059       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216462043810       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216462408277       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216463217256       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216462600145       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462621518       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216463265575       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216463276250       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216463083190       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 6.531235e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8123e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.911172e-01 1 1  ON 0
 uu_1                 2.930042e-02 1 1  ON 1
 uu_2                -6.416681e-02 1 1  ON 2
 uu_3                -1.195579e-01 1 1  ON 3
 uu_4                -1.554236e-01 1 1  ON 4
 uu_5                -1.679001e-01 1 1  ON 5
 uu_6                -1.552763e-01 1 1  ON 6
 uu_7                -1.086668e-01 1 1  ON 7
 uu_8                -3.956476e-02 1 1  ON 8
 uu_9                 2.062508e-01 1 1  ON 9
 ud_0                 3.480440e-01 1 1  ON 10
 ud_1                 9.268047e-02 1 1  ON 11
 ud_2                -1.203303e-02 1 1  ON 12
 ud_3                -7.191207e-02 1 1  ON 13
 ud_4                -1.237696e-01 1 1  ON 14
 ud_5                -1.637693e-01 1 1  ON 15
 ud_6                -1.788913e-01 1 1  ON 16
 ud_7                -1.564001e-01 1 1  ON 17
 ud_8                -1.081992e-01 1 1  ON 18
 ud_9                 3.778143e-02 1 1  ON 19
 eO_0                -9.062462e-01 1 1  ON 20
 eO_1                -5.911214e-01 1 1  ON 21
 eO_2                -1.882747e-01 1 1  ON 22
 eO_3                 7.628271e-02 1 1  ON 23
 eO_4                 2.026452e-01 1 1  ON 24
 eO_5                 2.962965e-01 1 1  ON 25
 eO_6                 3.260762e-01 1 1  ON 26
 eO_7                 5.385752e-01 1 1  ON 27
 eO_8                 1.551580e-01 1 1  ON 28
 eO_9                 5.232296e-02 1 1  ON 29
eH1_0                -2.240142e-01 1 1  ON 30
eH1_1                -1.459048e-01 1 1  ON 31
eH1_2                -1.047102e-01 1 1  ON 32
eH1_3                -6.801916e-02 1 1  ON 33
eH1_4                -2.065107e-02 1 1  ON 34
eH1_5                -7.137202e-03 1 1  ON 35
eH1_6                 3.900710e-02 1 1  ON 36
eH1_7                 9.037676e-02 1 1  ON 37
eH1_8                 2.686302e-01 1 1  ON 38
eH1_9                 1.122158e-01 1 1  ON 39
eH2_0                -2.077319e-01 1 1  ON 40
eH2_1                -1.294713e-01 1 1  ON 41
eH2_2                -8.822249e-02 1 1  ON 42
eH2_3                -5.168898e-02 1 1  ON 43
eH2_4                -5.533857e-03 1 1  ON 44
eH2_5                 6.959062e-03 1 1  ON 45
eH2_6                 4.464345e-02 1 1  ON 46
eH2_7                 2.916974e-02 1 1  ON 47
eH2_8                 2.509840e-01 1 1  ON 48
eH2_9                 1.150142e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.178476
====================================================
  Execution time = 2.0033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2446e-01
  Total weights = 2.0000e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324699515546
                                         uncertainty =       0.005466106368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324699515546
                                         uncertainty =       0.005466106368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402891359
  error estimate for blocks of size 2^( 2) =       0.000412141722
  error estimate for blocks of size 2^( 3) =       0.000420421524
  error estimate for blocks of size 2^( 4) =       0.000426160345
  error estimate for blocks of size 2^( 5) =       0.000430243503
  error estimate for blocks of size 2^( 6) =       0.000430939235
  error estimate for blocks of size 2^( 7) =       0.000432299347

      target function =                  N/A
              le_mean =     -17.216818337939
             les_mean =     296.743476414239
             stat err =       0.000429910607
             autocorr =       1.138624211906
              std dev =       0.569774424649
             le_variance =       0.324642894984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324493678611
                                         uncertainty =       0.005458119699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324493678611
                                         uncertainty =       0.005458119699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402763669
  error estimate for blocks of size 2^( 2) =       0.000412015965
  error estimate for blocks of size 2^( 3) =       0.000420302878
  error estimate for blocks of size 2^( 4) =       0.000426043945
  error estimate for blocks of size 2^( 5) =       0.000430127675
  error estimate for blocks of size 2^( 6) =       0.000430805910
  error estimate for blocks of size 2^( 7) =       0.000432182232

      target function =                  N/A
              le_mean =     -17.216820625896
             les_mean =     296.743349448263
             stat err =       0.000429789941
             autocorr =       1.138706804645
              std dev =       0.569593843179
             le_variance =       0.324437146187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324338730552
                                         uncertainty =       0.005451974172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324338730552
                                         uncertainty =       0.005451974172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402667493
  error estimate for blocks of size 2^( 2) =       0.000411923405
  error estimate for blocks of size 2^( 3) =       0.000420217249
  error estimate for blocks of size 2^( 4) =       0.000425961022
  error estimate for blocks of size 2^( 5) =       0.000430047261
  error estimate for blocks of size 2^( 6) =       0.000430720402
  error estimate for blocks of size 2^( 7) =       0.000432098732

      target function =                  N/A
              le_mean =     -17.216819752119
             les_mean =     296.743164434030
             stat err =       0.000429706854
             autocorr =       1.138810391818
              std dev =       0.569457829178
             le_variance =       0.324282219212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324516546531
                                         uncertainty =       0.005460795875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324516546531
                                         uncertainty =       0.005460795875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777833
  error estimate for blocks of size 2^( 2) =       0.000412030946
  error estimate for blocks of size 2^( 3) =       0.000420316363
  error estimate for blocks of size 2^( 4) =       0.000426057363
  error estimate for blocks of size 2^( 5) =       0.000430142125
  error estimate for blocks of size 2^( 6) =       0.000430830682
  error estimate for blocks of size 2^( 7) =       0.000432195165

      target function =                  N/A
              le_mean =     -17.216817846216
             les_mean =     296.743276552603
             stat err =       0.000429806334
             autocorr =       1.138713583265
              std dev =       0.569613873642
             le_variance =       0.324459965045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216818337939        initial
     9.5367e-03     9.5367e-02             6.1799e-03       -17.216820625896  <--
     3.8147e-02     3.8147e-01             2.3165e-03       -17.216819752119
     1.5259e-01     1.5259e+00             6.5312e-04       -17.216817846216

*****************************************************************************
Applying the update for shift_i =   9.5367e-03     and shift_s =   9.5367e-02
*****************************************************************************

  Execution time = 2.9285e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.904831e-01 1 1  ON 0
 uu_1                 2.867172e-02 1 1  ON 1
 uu_2                -6.480380e-02 1 1  ON 2
 uu_3                -1.202036e-01 1 1  ON 3
 uu_4                -1.560292e-01 1 1  ON 4
 uu_5                -1.683902e-01 1 1  ON 5
 uu_6                -1.557340e-01 1 1  ON 6
 uu_7                -1.082843e-01 1 1  ON 7
 uu_8                -3.798315e-02 1 1  ON 8
 uu_9                 2.058937e-01 1 1  ON 9
 ud_0                 3.479623e-01 1 1  ON 10
 ud_1                 9.264071e-02 1 1  ON 11
 ud_2                -1.212848e-02 1 1  ON 12
 ud_3                -7.203638e-02 1 1  ON 13
 ud_4                -1.239517e-01 1 1  ON 14
 ud_5                -1.639267e-01 1 1  ON 15
 ud_6                -1.788742e-01 1 1  ON 16
 ud_7                -1.576397e-01 1 1  ON 17
 ud_8                -1.071675e-01 1 1  ON 18
 ud_9                 3.718361e-02 1 1  ON 19
 eO_0                -9.064898e-01 1 1  ON 20
 eO_1                -5.912044e-01 1 1  ON 21
 eO_2                -1.882592e-01 1 1  ON 22
 eO_3                 7.645569e-02 1 1  ON 23
 eO_4                 2.029264e-01 1 1  ON 24
 eO_5                 2.959726e-01 1 1  ON 25
 eO_6                 3.253929e-01 1 1  ON 26
 eO_7                 5.375461e-01 1 1  ON 27
 eO_8                 1.564592e-01 1 1  ON 28
 eO_9                 5.272171e-02 1 1  ON 29
eH1_0                -2.225626e-01 1 1  ON 30
eH1_1                -1.446011e-01 1 1  ON 31
eH1_2                -1.034106e-01 1 1  ON 32
eH1_3                -6.679897e-02 1 1  ON 33
eH1_4                -1.963710e-02 1 1  ON 34
eH1_5                -6.940548e-03 1 1  ON 35
eH1_6                 3.514376e-02 1 1  ON 36
eH1_7                 8.786339e-02 1 1  ON 37
eH1_8                 2.676862e-01 1 1  ON 38
eH1_9                 1.124735e-01 1 1  ON 39
eH2_0                -2.087824e-01 1 1  ON 40
eH2_1                -1.302680e-01 1 1  ON 41
eH2_2                -8.882205e-02 1 1  ON 42
eH2_3                -5.236590e-02 1 1  ON 43
eH2_4                -5.946785e-03 1 1  ON 44
eH2_5                 6.124356e-03 1 1  ON 45
eH2_6                 4.646265e-02 1 1  ON 46
eH2_7                 3.186772e-02 1 1  ON 47
eH2_8                 2.501571e-01 1 1  ON 48
eH2_9                 1.153329e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.3167
    reference variance = 1.74993
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318984375967
                                         uncertainty =       0.005106940378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318984375967
                                         uncertainty =       0.005106940378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399444388
  error estimate for blocks of size 2^( 2) =       0.000408502471
  error estimate for blocks of size 2^( 3) =       0.000416838361
  error estimate for blocks of size 2^( 4) =       0.000422589607
  error estimate for blocks of size 2^( 5) =       0.000425727272
  error estimate for blocks of size 2^( 6) =       0.000427780319
  error estimate for blocks of size 2^( 7) =       0.000429769027

      target function =                  N/A
              le_mean =     -17.216046024264
             les_mean =     296.711352187911
             stat err =       0.000426466556
             autocorr =       1.139875216596
              std dev =       0.564899670638
             le_variance =       0.319111637887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604602426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046024264       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216046718913       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216048538715       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216049973322       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216051476351       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052585921       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216050588022       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216050571670       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216047675982       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216049781515       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216049541206       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216051348590       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216054846153       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216056511953       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216057974747       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216059195677       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216058644674       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216060262052       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216059252543       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216060382011       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216059522240       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216059905440       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-03 is 1.848939e-02

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046024264       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216046698542       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216048453226       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216049810024       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216051230078       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052271979       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216050385641       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216050290653       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216047894011       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216049767784       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216049512688       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216050864046       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216052560667       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216053131003       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216053327475       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216053795347       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216053469649       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 6.942726e-03

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216046024264       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216046627751       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216048189095       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216049289226       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216050455500       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216051262094       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216049758209       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216049523218       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216048224601       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216049433910       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216049212184       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216049825345       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 2.064989e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6296e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.907748e-01 1 1  ON 0
 uu_1                 2.889656e-02 1 1  ON 1
 uu_2                -6.458152e-02 1 1  ON 2
 uu_3                -1.201074e-01 1 1  ON 3
 uu_4                -1.562040e-01 1 1  ON 4
 uu_5                -1.683544e-01 1 1  ON 5
 uu_6                -1.553517e-01 1 1  ON 6
 uu_7                -1.088315e-01 1 1  ON 7
 uu_8                -3.945580e-02 1 1  ON 8
 uu_9                 2.022031e-01 1 1  ON 9
 ud_0                 3.492084e-01 1 1  ON 10
 ud_1                 9.377293e-02 1 1  ON 11
 ud_2                -1.096549e-02 1 1  ON 12
 ud_3                -7.119819e-02 1 1  ON 13
 ud_4                -1.229066e-01 1 1  ON 14
 ud_5                -1.632389e-01 1 1  ON 15
 ud_6                -1.792679e-01 1 1  ON 16
 ud_7                -1.592499e-01 1 1  ON 17
 ud_8                -1.109789e-01 1 1  ON 18
 ud_9                 3.330956e-02 1 1  ON 19
 eO_0                -9.075998e-01 1 1  ON 20
 eO_1                -5.924310e-01 1 1  ON 21
 eO_2                -1.892885e-01 1 1  ON 22
 eO_3                 7.669380e-02 1 1  ON 23
 eO_4                 2.041305e-01 1 1  ON 24
 eO_5                 2.988546e-01 1 1  ON 25
 eO_6                 3.260408e-01 1 1  ON 26
 eO_7                 5.337633e-01 1 1  ON 27
 eO_8                 1.575196e-01 1 1  ON 28
 eO_9                 5.317432e-02 1 1  ON 29
eH1_0                -2.215185e-01 1 1  ON 30
eH1_1                -1.430633e-01 1 1  ON 31
eH1_2                -1.020691e-01 1 1  ON 32
eH1_3                -6.540215e-02 1 1  ON 33
eH1_4                -1.867863e-02 1 1  ON 34
eH1_5                -5.138422e-03 1 1  ON 35
eH1_6                 3.522383e-02 1 1  ON 36
eH1_7                 8.092066e-02 1 1  ON 37
eH1_8                 2.650394e-01 1 1  ON 38
eH1_9                 1.133070e-01 1 1  ON 39
eH2_0                -2.113797e-01 1 1  ON 40
eH2_1                -1.317641e-01 1 1  ON 41
eH2_2                -9.032694e-02 1 1  ON 42
eH2_3                -5.320688e-02 1 1  ON 43
eH2_4                -6.750837e-03 1 1  ON 44
eH2_5                 5.685821e-03 1 1  ON 45
eH2_6                 4.909171e-02 1 1  ON 46
eH2_7                 3.793034e-02 1 1  ON 47
eH2_8                 2.484253e-01 1 1  ON 48
eH2_9                 1.153264e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.149476
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2100e-01
  Total weights = 2.0000e+06
  Execution time = 1.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320988448851
                                         uncertainty =       0.003330418361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320988448851
                                         uncertainty =       0.003330418361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400605680
  error estimate for blocks of size 2^( 2) =       0.000410035422
  error estimate for blocks of size 2^( 3) =       0.000418729294
  error estimate for blocks of size 2^( 4) =       0.000424938273
  error estimate for blocks of size 2^( 5) =       0.000428254200
  error estimate for blocks of size 2^( 6) =       0.000429620932
  error estimate for blocks of size 2^( 7) =       0.000430305747

      target function =                  N/A
              le_mean =     -17.216693671838
             les_mean =     296.735510650998
             stat err =       0.000428279788
             autocorr =       1.142933475596
              std dev =       0.566541985719
             le_variance =       0.320969821582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321075080755
                                         uncertainty =       0.003332295940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321075080755
                                         uncertainty =       0.003332295940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400659798
  error estimate for blocks of size 2^( 2) =       0.000410085064
  error estimate for blocks of size 2^( 3) =       0.000418771651
  error estimate for blocks of size 2^( 4) =       0.000424972911
  error estimate for blocks of size 2^( 5) =       0.000428277324
  error estimate for blocks of size 2^( 6) =       0.000429648846
  error estimate for blocks of size 2^( 7) =       0.000430323490

      target function =                  N/A
              le_mean =     -17.216691466820
             les_mean =     296.735521450638
             stat err =       0.000428305642
             autocorr =       1.142762698735
              std dev =       0.566618520255
             le_variance =       0.321056547496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321071598980
                                         uncertainty =       0.003332617926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321071598980
                                         uncertainty =       0.003332617926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400657678
  error estimate for blocks of size 2^( 2) =       0.000410086744
  error estimate for blocks of size 2^( 3) =       0.000418778617
  error estimate for blocks of size 2^( 4) =       0.000424986730
  error estimate for blocks of size 2^( 5) =       0.000428286998
  error estimate for blocks of size 2^( 6) =       0.000429662825
  error estimate for blocks of size 2^( 7) =       0.000430349094

      target function =                  N/A
              le_mean =     -17.216694710531
             les_mean =     296.735629745638
             stat err =       0.000428321412
             autocorr =       1.142858940435
              std dev =       0.566615522666
             le_variance =       0.321053150526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320982878048
                                         uncertainty =       0.003330586556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320982878048
                                         uncertainty =       0.003330586556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400602237
  error estimate for blocks of size 2^( 2) =       0.000410031964
  error estimate for blocks of size 2^( 3) =       0.000418725019
  error estimate for blocks of size 2^( 4) =       0.000424932945
  error estimate for blocks of size 2^( 5) =       0.000428243533
  error estimate for blocks of size 2^( 6) =       0.000429612572
  error estimate for blocks of size 2^( 7) =       0.000430301768

      target function =                  N/A
              le_mean =     -17.216691979487
             les_mean =     296.735446860761
             stat err =       0.000428272705
             autocorr =       1.142915313534
              std dev =       0.566537116814
             le_variance =       0.320964304727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216693671838        initial
     2.3842e-03     2.3842e-02             1.8489e-02       -17.216691466820
     9.5367e-03     9.5367e-02             6.9427e-03       -17.216694710531  <--
     3.8147e-02     3.8147e-01             2.0650e-03       -17.216691979487

*****************************************************************************
Applying the update for shift_i =   9.5367e-03     and shift_s =   9.5367e-02
*****************************************************************************

  Execution time = 2.9683e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.907748e-01 1 1  ON 0
 uu_1                 2.889656e-02 1 1  ON 1
 uu_2                -6.458152e-02 1 1  ON 2
 uu_3                -1.201074e-01 1 1  ON 3
 uu_4                -1.562040e-01 1 1  ON 4
 uu_5                -1.683544e-01 1 1  ON 5
 uu_6                -1.553517e-01 1 1  ON 6
 uu_7                -1.088315e-01 1 1  ON 7
 uu_8                -3.945580e-02 1 1  ON 8
 uu_9                 2.022031e-01 1 1  ON 9
 ud_0                 3.492084e-01 1 1  ON 10
 ud_1                 9.377293e-02 1 1  ON 11
 ud_2                -1.096549e-02 1 1  ON 12
 ud_3                -7.119819e-02 1 1  ON 13
 ud_4                -1.229066e-01 1 1  ON 14
 ud_5                -1.632389e-01 1 1  ON 15
 ud_6                -1.792679e-01 1 1  ON 16
 ud_7                -1.592499e-01 1 1  ON 17
 ud_8                -1.109789e-01 1 1  ON 18
 ud_9                 3.330956e-02 1 1  ON 19
 eO_0                -9.075998e-01 1 1  ON 20
 eO_1                -5.924310e-01 1 1  ON 21
 eO_2                -1.892885e-01 1 1  ON 22
 eO_3                 7.669380e-02 1 1  ON 23
 eO_4                 2.041305e-01 1 1  ON 24
 eO_5                 2.988546e-01 1 1  ON 25
 eO_6                 3.260408e-01 1 1  ON 26
 eO_7                 5.337633e-01 1 1  ON 27
 eO_8                 1.575196e-01 1 1  ON 28
 eO_9                 5.317432e-02 1 1  ON 29
eH1_0                -2.215185e-01 1 1  ON 30
eH1_1                -1.430633e-01 1 1  ON 31
eH1_2                -1.020691e-01 1 1  ON 32
eH1_3                -6.540215e-02 1 1  ON 33
eH1_4                -1.867863e-02 1 1  ON 34
eH1_5                -5.138422e-03 1 1  ON 35
eH1_6                 3.522383e-02 1 1  ON 36
eH1_7                 8.092066e-02 1 1  ON 37
eH1_8                 2.650394e-01 1 1  ON 38
eH1_9                 1.133070e-01 1 1  ON 39
eH2_0                -2.113797e-01 1 1  ON 40
eH2_1                -1.317641e-01 1 1  ON 41
eH2_2                -9.032694e-02 1 1  ON 42
eH2_3                -5.320688e-02 1 1  ON 43
eH2_4                -6.750837e-03 1 1  ON 44
eH2_5                 5.685821e-03 1 1  ON 45
eH2_6                 4.909171e-02 1 1  ON 46
eH2_7                 3.793034e-02 1 1  ON 47
eH2_8                 2.484253e-01 1 1  ON 48
eH2_9                 1.153264e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5984e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1845
    reference variance = 0.287449
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3679e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336266805429
                                         uncertainty =       0.010532579996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336266805429
                                         uncertainty =       0.010532579996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410360017
  error estimate for blocks of size 2^( 2) =       0.000420142412
  error estimate for blocks of size 2^( 3) =       0.000428220950
  error estimate for blocks of size 2^( 4) =       0.000434208367
  error estimate for blocks of size 2^( 5) =       0.000437575621
  error estimate for blocks of size 2^( 6) =       0.000439139809
  error estimate for blocks of size 2^( 7) =       0.000438842024

      target function =                  N/A
              le_mean =     -17.216330716432
             les_mean =     296.738833856356
             stat err =       0.000437441455
             autocorr =       1.136343932631
              std dev =       0.580336701582
             le_variance =       0.336790687203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633071643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216330716432       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216333433801       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216340054861       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216338792016       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216337319739       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216337195798       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216337729507       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216337178744       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216336722390       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216338875807       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216339343001       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216339992562       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216341046667       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216341812584       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216340876640       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216341142883       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216340904828       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216340156081       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216338716505       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216339665382       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216340022187       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216340048352       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-03 is 1.491854e-02

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216330716432       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216333333340       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339667036       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216338386713       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216337010006       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216337003619       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216337439885       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216336898902       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216336523816       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216338381153       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216338676570       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216339043423       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216339745582       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216339937234       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216339345003       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216339290497       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216339236049       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 5.102009e-03

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216330716432       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332996205       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216338358258       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216337292591       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216336266966       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216336263607       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216336491848       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216336038829       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216335887052       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216337028384       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216337059357       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216337106488       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 1.372900e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5970e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.903265e-01 1 1  ON 0
 uu_1                 2.881202e-02 1 1  ON 1
 uu_2                -6.478542e-02 1 1  ON 2
 uu_3                -1.201117e-01 1 1  ON 3
 uu_4                -1.565593e-01 1 1  ON 4
 uu_5                -1.686517e-01 1 1  ON 5
 uu_6                -1.566790e-01 1 1  ON 6
 uu_7                -1.096752e-01 1 1  ON 7
 uu_8                -3.747757e-02 1 1  ON 8
 uu_9                 2.008265e-01 1 1  ON 9
 ud_0                 3.482168e-01 1 1  ON 10
 ud_1                 9.313399e-02 1 1  ON 11
 ud_2                -1.162190e-02 1 1  ON 12
 ud_3                -7.186482e-02 1 1  ON 13
 ud_4                -1.240067e-01 1 1  ON 14
 ud_5                -1.644774e-01 1 1  ON 15
 ud_6                -1.804575e-01 1 1  ON 16
 ud_7                -1.569600e-01 1 1  ON 17
 ud_8                -1.082756e-01 1 1  ON 18
 ud_9                 3.277278e-02 1 1  ON 19
 eO_0                -9.098964e-01 1 1  ON 20
 eO_1                -5.938994e-01 1 1  ON 21
 eO_2                -1.907152e-01 1 1  ON 22
 eO_3                 7.679463e-02 1 1  ON 23
 eO_4                 2.064955e-01 1 1  ON 24
 eO_5                 2.993964e-01 1 1  ON 25
 eO_6                 3.275917e-01 1 1  ON 26
 eO_7                 5.312814e-01 1 1  ON 27
 eO_8                 1.598380e-01 1 1  ON 28
 eO_9                 5.388485e-02 1 1  ON 29
eH1_0                -2.207094e-01 1 1  ON 30
eH1_1                -1.429815e-01 1 1  ON 31
eH1_2                -1.024326e-01 1 1  ON 32
eH1_3                -6.548583e-02 1 1  ON 33
eH1_4                -1.819146e-02 1 1  ON 34
eH1_5                -4.019716e-03 1 1  ON 35
eH1_6                 3.699483e-02 1 1  ON 36
eH1_7                 7.722366e-02 1 1  ON 37
eH1_8                 2.635145e-01 1 1  ON 38
eH1_9                 1.140088e-01 1 1  ON 39
eH2_0                -2.104364e-01 1 1  ON 40
eH2_1                -1.316504e-01 1 1  ON 41
eH2_2                -9.077277e-02 1 1  ON 42
eH2_3                -5.446853e-02 1 1  ON 43
eH2_4                -8.154497e-03 1 1  ON 44
eH2_5                 4.766615e-03 1 1  ON 45
eH2_6                 4.700770e-02 1 1  ON 46
eH2_7                 4.303235e-02 1 1  ON 47
eH2_8                 2.472247e-01 1 1  ON 48
eH2_9                 1.158651e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1423
    reference variance = 0.175107
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2933e-01
  Total weights = 2.0000e+06
  Execution time = 1.8210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329517947179
                                         uncertainty =       0.003444154592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329517947179
                                         uncertainty =       0.003444154592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405843891
  error estimate for blocks of size 2^( 2) =       0.000414919387
  error estimate for blocks of size 2^( 3) =       0.000423235840
  error estimate for blocks of size 2^( 4) =       0.000429372372
  error estimate for blocks of size 2^( 5) =       0.000432897038
  error estimate for blocks of size 2^( 6) =       0.000435803248
  error estimate for blocks of size 2^( 7) =       0.000438119162

      target function =                  N/A
              le_mean =     -17.217071465554
             les_mean =     296.756968212248
             stat err =       0.000434047955
             autocorr =       1.143819256539
              std dev =       0.573949934199
             le_variance =       0.329418526968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329431393016
                                         uncertainty =       0.003439461859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329431393016
                                         uncertainty =       0.003439461859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405790835
  error estimate for blocks of size 2^( 2) =       0.000414881439
  error estimate for blocks of size 2^( 3) =       0.000423201488
  error estimate for blocks of size 2^( 4) =       0.000429323465
  error estimate for blocks of size 2^( 5) =       0.000432841422
  error estimate for blocks of size 2^( 6) =       0.000435742614
  error estimate for blocks of size 2^( 7) =       0.000438054379

      target function =                  N/A
              le_mean =     -17.217063342404
             les_mean =     296.756602375923
             stat err =       0.000433990470
             autocorr =       1.143815340284
              std dev =       0.573874902963
             le_variance =       0.329332404251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368521656
                                         uncertainty =       0.003434594392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368521656
                                         uncertainty =       0.003434594392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405752255
  error estimate for blocks of size 2^( 2) =       0.000414860110
  error estimate for blocks of size 2^( 3) =       0.000423186391
  error estimate for blocks of size 2^( 4) =       0.000429307007
  error estimate for blocks of size 2^( 5) =       0.000432838681
  error estimate for blocks of size 2^( 6) =       0.000435748742
  error estimate for blocks of size 2^( 7) =       0.000438065596

      target function =                  N/A
              le_mean =     -17.217064862839
             les_mean =     296.756592111358
             stat err =       0.000433990007
             autocorr =       1.144030424526
              std dev =       0.573820341897
             le_variance =       0.329269784775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329372650433
                                         uncertainty =       0.003439506720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329372650433
                                         uncertainty =       0.003439506720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405754569
  error estimate for blocks of size 2^( 2) =       0.000414842221
  error estimate for blocks of size 2^( 3) =       0.000423163020
  error estimate for blocks of size 2^( 4) =       0.000429294069
  error estimate for blocks of size 2^( 5) =       0.000432824334
  error estimate for blocks of size 2^( 6) =       0.000435731799
  error estimate for blocks of size 2^( 7) =       0.000438052154

      target function =                  N/A
              le_mean =     -17.217065114775
             les_mean =     296.756604543001
             stat err =       0.000433975589
             autocorr =       1.143941364513
              std dev =       0.573823615095
             le_variance =       0.329273541241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217071465554        initial  <--
     2.3842e-03     2.3842e-02             1.4919e-02       -17.217063342404
     9.5367e-03     9.5367e-02             5.1020e-03       -17.217064862839
     3.8147e-02     3.8147e-01             1.3729e-03       -17.217065114775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5168
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.907748e-01 1 1  ON 0
 uu_1                 2.889656e-02 1 1  ON 1
 uu_2                -6.458152e-02 1 1  ON 2
 uu_3                -1.201074e-01 1 1  ON 3
 uu_4                -1.562040e-01 1 1  ON 4
 uu_5                -1.683544e-01 1 1  ON 5
 uu_6                -1.553517e-01 1 1  ON 6
 uu_7                -1.088315e-01 1 1  ON 7
 uu_8                -3.945580e-02 1 1  ON 8
 uu_9                 2.022031e-01 1 1  ON 9
 ud_0                 3.492084e-01 1 1  ON 10
 ud_1                 9.377293e-02 1 1  ON 11
 ud_2                -1.096549e-02 1 1  ON 12
 ud_3                -7.119819e-02 1 1  ON 13
 ud_4                -1.229066e-01 1 1  ON 14
 ud_5                -1.632389e-01 1 1  ON 15
 ud_6                -1.792679e-01 1 1  ON 16
 ud_7                -1.592499e-01 1 1  ON 17
 ud_8                -1.109789e-01 1 1  ON 18
 ud_9                 3.330956e-02 1 1  ON 19
 eO_0                -9.075998e-01 1 1  ON 20
 eO_1                -5.924310e-01 1 1  ON 21
 eO_2                -1.892885e-01 1 1  ON 22
 eO_3                 7.669380e-02 1 1  ON 23
 eO_4                 2.041305e-01 1 1  ON 24
 eO_5                 2.988546e-01 1 1  ON 25
 eO_6                 3.260408e-01 1 1  ON 26
 eO_7                 5.337633e-01 1 1  ON 27
 eO_8                 1.575196e-01 1 1  ON 28
 eO_9                 5.317432e-02 1 1  ON 29
eH1_0                -2.215185e-01 1 1  ON 30
eH1_1                -1.430633e-01 1 1  ON 31
eH1_2                -1.020691e-01 1 1  ON 32
eH1_3                -6.540215e-02 1 1  ON 33
eH1_4                -1.867863e-02 1 1  ON 34
eH1_5                -5.138422e-03 1 1  ON 35
eH1_6                 3.522383e-02 1 1  ON 36
eH1_7                 8.092066e-02 1 1  ON 37
eH1_8                 2.650394e-01 1 1  ON 38
eH1_9                 1.133070e-01 1 1  ON 39
eH2_0                -2.113797e-01 1 1  ON 40
eH2_1                -1.317641e-01 1 1  ON 41
eH2_2                -9.032694e-02 1 1  ON 42
eH2_3                -5.320688e-02 1 1  ON 43
eH2_4                -6.750837e-03 1 1  ON 44
eH2_5                 5.685821e-03 1 1  ON 45
eH2_6                 4.909171e-02 1 1  ON 46
eH2_7                 3.793034e-02 1 1  ON 47
eH2_8                 2.484253e-01 1 1  ON 48
eH2_9                 1.153264e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.387652
====================================================
  Execution time = 2.0938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326166664402
                                         uncertainty =       0.003792022799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326166664402
                                         uncertainty =       0.003792022799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403816863
  error estimate for blocks of size 2^( 2) =       0.000412923432
  error estimate for blocks of size 2^( 3) =       0.000421383634
  error estimate for blocks of size 2^( 4) =       0.000428162915
  error estimate for blocks of size 2^( 5) =       0.000431225183
  error estimate for blocks of size 2^( 6) =       0.000431827261
  error estimate for blocks of size 2^( 7) =       0.000432998222

      target function =                  N/A
              le_mean =     -17.216485695872
             les_mean =     296.733515670032
             stat err =       0.000431053395
             autocorr =       1.139444666411
              std dev =       0.571083283724
             le_variance =       0.326136116949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648569587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216485695872       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216487924695       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490834965       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490424418       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216491214549       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216489866470       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216490509020       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216489198672       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216489125344       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216489436925       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216488890667       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216488876646       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216488702944       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.165757e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216485695872       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216487402144       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216489750947       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216489458824       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216490036917       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216488982679       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216489367270       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216488824107       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216488720543       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216488715393       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216488842215       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 7.593162e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216485695872       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486576389       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216487971245       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216487992795       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216487574323       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216487866414       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216487743648       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216487673696       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.855999e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6476e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.908155e-01 1 1  ON 0
 uu_1                 2.922156e-02 1 1  ON 1
 uu_2                -6.448132e-02 1 1  ON 2
 uu_3                -1.201693e-01 1 1  ON 3
 uu_4                -1.562751e-01 1 1  ON 4
 uu_5                -1.686147e-01 1 1  ON 5
 uu_6                -1.557713e-01 1 1  ON 6
 uu_7                -1.086693e-01 1 1  ON 7
 uu_8                -3.912961e-02 1 1  ON 8
 uu_9                 2.018736e-01 1 1  ON 9
 ud_0                 3.487722e-01 1 1  ON 10
 ud_1                 9.368681e-02 1 1  ON 11
 ud_2                -1.123090e-02 1 1  ON 12
 ud_3                -7.114413e-02 1 1  ON 13
 ud_4                -1.229844e-01 1 1  ON 14
 ud_5                -1.632166e-01 1 1  ON 15
 ud_6                -1.787123e-01 1 1  ON 16
 ud_7                -1.587481e-01 1 1  ON 17
 ud_8                -1.109162e-01 1 1  ON 18
 ud_9                 3.294456e-02 1 1  ON 19
 eO_0                -9.081237e-01 1 1  ON 20
 eO_1                -5.924617e-01 1 1  ON 21
 eO_2                -1.894280e-01 1 1  ON 22
 eO_3                 7.693077e-02 1 1  ON 23
 eO_4                 2.048431e-01 1 1  ON 24
 eO_5                 2.984204e-01 1 1  ON 25
 eO_6                 3.261669e-01 1 1  ON 26
 eO_7                 5.336293e-01 1 1  ON 27
 eO_8                 1.576992e-01 1 1  ON 28
 eO_9                 5.317484e-02 1 1  ON 29
eH1_0                -2.214116e-01 1 1  ON 30
eH1_1                -1.429655e-01 1 1  ON 31
eH1_2                -1.020107e-01 1 1  ON 32
eH1_3                -6.495446e-02 1 1  ON 33
eH1_4                -1.860489e-02 1 1  ON 34
eH1_5                -5.588816e-03 1 1  ON 35
eH1_6                 3.528743e-02 1 1  ON 36
eH1_7                 8.052008e-02 1 1  ON 37
eH1_8                 2.649131e-01 1 1  ON 38
eH1_9                 1.133914e-01 1 1  ON 39
eH2_0                -2.106309e-01 1 1  ON 40
eH2_1                -1.315385e-01 1 1  ON 41
eH2_2                -9.070410e-02 1 1  ON 42
eH2_3                -5.326797e-02 1 1  ON 43
eH2_4                -6.925350e-03 1 1  ON 44
eH2_5                 6.053590e-03 1 1  ON 45
eH2_6                 4.833239e-02 1 1  ON 46
eH2_7                 3.806959e-02 1 1  ON 47
eH2_8                 2.483241e-01 1 1  ON 48
eH2_9                 1.152999e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2867
    reference variance = 0.292999
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2561e-01
  Total weights = 2.0000e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325684688871
                                         uncertainty =       0.004651972202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325684688871
                                         uncertainty =       0.004651972202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403498422
  error estimate for blocks of size 2^( 2) =       0.000412616560
  error estimate for blocks of size 2^( 3) =       0.000421016317
  error estimate for blocks of size 2^( 4) =       0.000427028364
  error estimate for blocks of size 2^( 5) =       0.000430697332
  error estimate for blocks of size 2^( 6) =       0.000431956954
  error estimate for blocks of size 2^( 7) =       0.000432094619

      target function =                  N/A
              le_mean =     -17.217360818099
             les_mean =     296.763135331408
             stat err =       0.000430444317
             autocorr =       1.138020997743
              std dev =       0.570632941210
             le_variance =       0.325621953595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325703521989
                                         uncertainty =       0.004650292673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325703521989
                                         uncertainty =       0.004650292673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403509980
  error estimate for blocks of size 2^( 2) =       0.000412627744
  error estimate for blocks of size 2^( 3) =       0.000421020792
  error estimate for blocks of size 2^( 4) =       0.000427033738
  error estimate for blocks of size 2^( 5) =       0.000430702640
  error estimate for blocks of size 2^( 6) =       0.000431964719
  error estimate for blocks of size 2^( 7) =       0.000432105895

      target function =                  N/A
              le_mean =     -17.217364669781
             les_mean =     296.763286616965
             stat err =       0.000430451748
             autocorr =       1.137995096877
              std dev =       0.570649285955
             le_variance =       0.325640607561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325671789091
                                         uncertainty =       0.004648933850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325671789091
                                         uncertainty =       0.004648933850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403490259
  error estimate for blocks of size 2^( 2) =       0.000412608436
  error estimate for blocks of size 2^( 3) =       0.000420998788
  error estimate for blocks of size 2^( 4) =       0.000427013500
  error estimate for blocks of size 2^( 5) =       0.000430685059
  error estimate for blocks of size 2^( 6) =       0.000431944813
  error estimate for blocks of size 2^( 7) =       0.000432092651

      target function =                  N/A
              le_mean =     -17.217368571685
             les_mean =     296.763389148397
             stat err =       0.000430434006
             autocorr =       1.138012522729
              std dev =       0.570621396337
             le_variance =       0.325608777957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325620301221
                                         uncertainty =       0.004650743784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325620301221
                                         uncertainty =       0.004650743784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403458467
  error estimate for blocks of size 2^( 2) =       0.000412576830
  error estimate for blocks of size 2^( 3) =       0.000420974116
  error estimate for blocks of size 2^( 4) =       0.000426988076
  error estimate for blocks of size 2^( 5) =       0.000430658195
  error estimate for blocks of size 2^( 6) =       0.000431916922
  error estimate for blocks of size 2^( 7) =       0.000432057954

      target function =                  N/A
              le_mean =     -17.217362242288
             les_mean =     296.763119888998
             stat err =       0.000430405287
             autocorr =       1.138039997427
              std dev =       0.570576436244
             le_variance =       0.325557469597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217360818099        initial
     2.3842e-02     2.3842e-01             2.1658e-03       -17.217364669781
     9.5367e-02     9.5367e-01             7.5932e-04       -17.217368571685  <--
     3.8147e-01     3.8147e+00             2.8560e-04       -17.217362242288

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 2.9435e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.908155e-01 1 1  ON 0
 uu_1                 2.922156e-02 1 1  ON 1
 uu_2                -6.448132e-02 1 1  ON 2
 uu_3                -1.201693e-01 1 1  ON 3
 uu_4                -1.562751e-01 1 1  ON 4
 uu_5                -1.686147e-01 1 1  ON 5
 uu_6                -1.557713e-01 1 1  ON 6
 uu_7                -1.086693e-01 1 1  ON 7
 uu_8                -3.912961e-02 1 1  ON 8
 uu_9                 2.018736e-01 1 1  ON 9
 ud_0                 3.487722e-01 1 1  ON 10
 ud_1                 9.368681e-02 1 1  ON 11
 ud_2                -1.123090e-02 1 1  ON 12
 ud_3                -7.114413e-02 1 1  ON 13
 ud_4                -1.229844e-01 1 1  ON 14
 ud_5                -1.632166e-01 1 1  ON 15
 ud_6                -1.787123e-01 1 1  ON 16
 ud_7                -1.587481e-01 1 1  ON 17
 ud_8                -1.109162e-01 1 1  ON 18
 ud_9                 3.294456e-02 1 1  ON 19
 eO_0                -9.081237e-01 1 1  ON 20
 eO_1                -5.924617e-01 1 1  ON 21
 eO_2                -1.894280e-01 1 1  ON 22
 eO_3                 7.693077e-02 1 1  ON 23
 eO_4                 2.048431e-01 1 1  ON 24
 eO_5                 2.984204e-01 1 1  ON 25
 eO_6                 3.261669e-01 1 1  ON 26
 eO_7                 5.336293e-01 1 1  ON 27
 eO_8                 1.576992e-01 1 1  ON 28
 eO_9                 5.317484e-02 1 1  ON 29
eH1_0                -2.214116e-01 1 1  ON 30
eH1_1                -1.429655e-01 1 1  ON 31
eH1_2                -1.020107e-01 1 1  ON 32
eH1_3                -6.495446e-02 1 1  ON 33
eH1_4                -1.860489e-02 1 1  ON 34
eH1_5                -5.588816e-03 1 1  ON 35
eH1_6                 3.528743e-02 1 1  ON 36
eH1_7                 8.052008e-02 1 1  ON 37
eH1_8                 2.649131e-01 1 1  ON 38
eH1_9                 1.133914e-01 1 1  ON 39
eH2_0                -2.106309e-01 1 1  ON 40
eH2_1                -1.315385e-01 1 1  ON 41
eH2_2                -9.070410e-02 1 1  ON 42
eH2_3                -5.326797e-02 1 1  ON 43
eH2_4                -6.925350e-03 1 1  ON 44
eH2_5                 6.053590e-03 1 1  ON 45
eH2_6                 4.833239e-02 1 1  ON 46
eH2_7                 3.806959e-02 1 1  ON 47
eH2_8                 2.483241e-01 1 1  ON 48
eH2_9                 1.152999e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5917e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1719
    reference variance = 0.277909
====================================================
  Execution time = 2.0645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1837e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318451639382
                                         uncertainty =       0.003169767463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318451639382
                                         uncertainty =       0.003169767463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398980365
  error estimate for blocks of size 2^( 2) =       0.000408307874
  error estimate for blocks of size 2^( 3) =       0.000416978406
  error estimate for blocks of size 2^( 4) =       0.000423101646
  error estimate for blocks of size 2^( 5) =       0.000426572901
  error estimate for blocks of size 2^( 6) =       0.000429727910
  error estimate for blocks of size 2^( 7) =       0.000429237719

      target function =                  N/A
              le_mean =     -17.216180824417
             les_mean =     296.715252683422
             stat err =       0.000427160044
             autocorr =       1.146246963360
              std dev =       0.564243443535
             le_variance =       0.318370663573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618082442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180824417       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182714253       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216183655729       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216184775125       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216183819092       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216184312332       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216184572497       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216184649047       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216184926634       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216186204841       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216186094296       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216185992913       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 2.161057e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180824417       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182310341       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182948035       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216183792377       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216183082351       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216183181639       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216183369262       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216183424780       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216183784050       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 5.454966e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216180824417       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216181625491       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216181957491       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182445909       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216182204902       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216182001575       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216182086472       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.398978e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6177e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.910776e-01 1 1  ON 0
 uu_1                 2.913974e-02 1 1  ON 1
 uu_2                -6.442189e-02 1 1  ON 2
 uu_3                -1.200409e-01 1 1  ON 3
 uu_4                -1.562455e-01 1 1  ON 4
 uu_5                -1.689128e-01 1 1  ON 5
 uu_6                -1.558337e-01 1 1  ON 6
 uu_7                -1.087861e-01 1 1  ON 7
 uu_8                -3.906633e-02 1 1  ON 8
 uu_9                 2.015719e-01 1 1  ON 9
 ud_0                 3.484101e-01 1 1  ON 10
 ud_1                 9.345484e-02 1 1  ON 11
 ud_2                -1.119180e-02 1 1  ON 12
 ud_3                -7.122622e-02 1 1  ON 13
 ud_4                -1.230424e-01 1 1  ON 14
 ud_5                -1.628785e-01 1 1  ON 15
 ud_6                -1.786452e-01 1 1  ON 16
 ud_7                -1.585486e-01 1 1  ON 17
 ud_8                -1.108814e-01 1 1  ON 18
 ud_9                 3.276360e-02 1 1  ON 19
 eO_0                -9.077912e-01 1 1  ON 20
 eO_1                -5.927134e-01 1 1  ON 21
 eO_2                -1.895336e-01 1 1  ON 22
 eO_3                 7.690532e-02 1 1  ON 23
 eO_4                 2.048301e-01 1 1  ON 24
 eO_5                 2.984109e-01 1 1  ON 25
 eO_6                 3.262586e-01 1 1  ON 26
 eO_7                 5.333917e-01 1 1  ON 27
 eO_8                 1.578445e-01 1 1  ON 28
 eO_9                 5.320075e-02 1 1  ON 29
eH1_0                -2.216599e-01 1 1  ON 30
eH1_1                -1.426436e-01 1 1  ON 31
eH1_2                -1.019041e-01 1 1  ON 32
eH1_3                -6.508435e-02 1 1  ON 33
eH1_4                -1.876472e-02 1 1  ON 34
eH1_5                -5.598563e-03 1 1  ON 35
eH1_6                 3.565202e-02 1 1  ON 36
eH1_7                 8.034453e-02 1 1  ON 37
eH1_8                 2.647489e-01 1 1  ON 38
eH1_9                 1.134232e-01 1 1  ON 39
eH2_0                -2.102830e-01 1 1  ON 40
eH2_1                -1.317760e-01 1 1  ON 41
eH2_2                -9.067995e-02 1 1  ON 42
eH2_3                -5.379825e-02 1 1  ON 43
eH2_4                -7.145456e-03 1 1  ON 44
eH2_5                 5.754683e-03 1 1  ON 45
eH2_6                 4.864158e-02 1 1  ON 46
eH2_7                 3.861509e-02 1 1  ON 47
eH2_8                 2.482671e-01 1 1  ON 48
eH2_9                 1.153570e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2437
    reference variance = 0.290205
====================================================
  Execution time = 2.0063e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2997e-01
  Total weights = 2.0000e+06
  Execution time = 1.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330316503740
                                         uncertainty =       0.008350227882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330316503740
                                         uncertainty =       0.008350227882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406354287
  error estimate for blocks of size 2^( 2) =       0.000415908512
  error estimate for blocks of size 2^( 3) =       0.000424276788
  error estimate for blocks of size 2^( 4) =       0.000429942474
  error estimate for blocks of size 2^( 5) =       0.000433597630
  error estimate for blocks of size 2^( 6) =       0.000434774647
  error estimate for blocks of size 2^( 7) =       0.000435200593

      target function =                  N/A
              le_mean =     -17.216584215502
             les_mean =     296.741019497729
             stat err =       0.000433378836
             autocorr =       1.137432690341
              std dev =       0.574671744029
             le_variance =       0.330247613386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329934484677
                                         uncertainty =       0.008356798751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329934484677
                                         uncertainty =       0.008356798751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406119025
  error estimate for blocks of size 2^( 2) =       0.000415688781
  error estimate for blocks of size 2^( 3) =       0.000424071831
  error estimate for blocks of size 2^( 4) =       0.000429747107
  error estimate for blocks of size 2^( 5) =       0.000433403315
  error estimate for blocks of size 2^( 6) =       0.000434589644
  error estimate for blocks of size 2^( 7) =       0.000435027221

      target function =                  N/A
              le_mean =     -17.216581082782
             les_mean =     296.740529340330
             stat err =       0.000433191822
             autocorr =       1.137768295626
              std dev =       0.574339033373
             le_variance =       0.329865325256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329769916577
                                         uncertainty =       0.008360185863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329769916577
                                         uncertainty =       0.008360185863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406017555
  error estimate for blocks of size 2^( 2) =       0.000415596639
  error estimate for blocks of size 2^( 3) =       0.000423988853
  error estimate for blocks of size 2^( 4) =       0.000429669226
  error estimate for blocks of size 2^( 5) =       0.000433330136
  error estimate for blocks of size 2^( 6) =       0.000434521743
  error estimate for blocks of size 2^( 7) =       0.000434971478

      target function =                  N/A
              le_mean =     -17.216581313635
             les_mean =     296.740372474402
             stat err =       0.000433123146
             autocorr =       1.137976154724
              std dev =       0.574195533122
             le_variance =       0.329700510257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330155581593
                                         uncertainty =       0.008355166953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330155581593
                                         uncertainty =       0.008355166953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406255187
  error estimate for blocks of size 2^( 2) =       0.000415816644
  error estimate for blocks of size 2^( 3) =       0.000424191544
  error estimate for blocks of size 2^( 4) =       0.000429861707
  error estimate for blocks of size 2^( 5) =       0.000433518846
  error estimate for blocks of size 2^( 6) =       0.000434701148
  error estimate for blocks of size 2^( 7) =       0.000435135378

      target function =                  N/A
              le_mean =     -17.216582775772
             les_mean =     296.740808863356
             stat err =       0.000433304270
             autocorr =       1.137596114044
              std dev =       0.574531594782
             le_variance =       0.330086553402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216584215502        initial  <--
     2.3842e-02     2.3842e-01             2.1611e-03       -17.216581082782
     9.5367e-02     9.5367e-01             5.4550e-04       -17.216581313635
     3.8147e-01     3.8147e+00             2.3990e-04       -17.216582775772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2999
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.908155e-01 1 1  ON 0
 uu_1                 2.922156e-02 1 1  ON 1
 uu_2                -6.448132e-02 1 1  ON 2
 uu_3                -1.201693e-01 1 1  ON 3
 uu_4                -1.562751e-01 1 1  ON 4
 uu_5                -1.686147e-01 1 1  ON 5
 uu_6                -1.557713e-01 1 1  ON 6
 uu_7                -1.086693e-01 1 1  ON 7
 uu_8                -3.912961e-02 1 1  ON 8
 uu_9                 2.018736e-01 1 1  ON 9
 ud_0                 3.487722e-01 1 1  ON 10
 ud_1                 9.368681e-02 1 1  ON 11
 ud_2                -1.123090e-02 1 1  ON 12
 ud_3                -7.114413e-02 1 1  ON 13
 ud_4                -1.229844e-01 1 1  ON 14
 ud_5                -1.632166e-01 1 1  ON 15
 ud_6                -1.787123e-01 1 1  ON 16
 ud_7                -1.587481e-01 1 1  ON 17
 ud_8                -1.109162e-01 1 1  ON 18
 ud_9                 3.294456e-02 1 1  ON 19
 eO_0                -9.081237e-01 1 1  ON 20
 eO_1                -5.924617e-01 1 1  ON 21
 eO_2                -1.894280e-01 1 1  ON 22
 eO_3                 7.693077e-02 1 1  ON 23
 eO_4                 2.048431e-01 1 1  ON 24
 eO_5                 2.984204e-01 1 1  ON 25
 eO_6                 3.261669e-01 1 1  ON 26
 eO_7                 5.336293e-01 1 1  ON 27
 eO_8                 1.576992e-01 1 1  ON 28
 eO_9                 5.317484e-02 1 1  ON 29
eH1_0                -2.214116e-01 1 1  ON 30
eH1_1                -1.429655e-01 1 1  ON 31
eH1_2                -1.020107e-01 1 1  ON 32
eH1_3                -6.495446e-02 1 1  ON 33
eH1_4                -1.860489e-02 1 1  ON 34
eH1_5                -5.588816e-03 1 1  ON 35
eH1_6                 3.528743e-02 1 1  ON 36
eH1_7                 8.052008e-02 1 1  ON 37
eH1_8                 2.649131e-01 1 1  ON 38
eH1_9                 1.133914e-01 1 1  ON 39
eH2_0                -2.106309e-01 1 1  ON 40
eH2_1                -1.315385e-01 1 1  ON 41
eH2_2                -9.070410e-02 1 1  ON 42
eH2_3                -5.326797e-02 1 1  ON 43
eH2_4                -6.925350e-03 1 1  ON 44
eH2_5                 6.053590e-03 1 1  ON 45
eH2_6                 4.833239e-02 1 1  ON 46
eH2_7                 3.806959e-02 1 1  ON 47
eH2_8                 2.483241e-01 1 1  ON 48
eH2_9                 1.152999e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.263525
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2116e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321140581804
                                         uncertainty =       0.003003339369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321140581804
                                         uncertainty =       0.003003339369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400725749
  error estimate for blocks of size 2^( 2) =       0.000410335852
  error estimate for blocks of size 2^( 3) =       0.000418224051
  error estimate for blocks of size 2^( 4) =       0.000424144621
  error estimate for blocks of size 2^( 5) =       0.000428912117
  error estimate for blocks of size 2^( 6) =       0.000430661531
  error estimate for blocks of size 2^( 7) =       0.000430141856

      target function =                  N/A
              le_mean =     -17.217122527405
             les_mean =     296.750470215002
             stat err =       0.000428465031
             autocorr =       1.143236989745
              std dev =       0.566711789102
             le_variance =       0.321162251908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712252740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122527405       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122324405       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217123339390       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217124299980       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217123815769       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123957238       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217123750860       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217123825823       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217123872595       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 6.412482e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122527405       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122450461       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217122739713       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217123205045       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217122987434       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123039036       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217122966378       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.883257e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217122527405       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217122505319       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217122579863       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217122722546       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217122657435       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217122672975       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.818692e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8972e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.908450e-01 1 1  ON 0
 uu_1                 2.914746e-02 1 1  ON 1
 uu_2                -6.448265e-02 1 1  ON 2
 uu_3                -1.201562e-01 1 1  ON 3
 uu_4                -1.563308e-01 1 1  ON 4
 uu_5                -1.685500e-01 1 1  ON 5
 uu_6                -1.558055e-01 1 1  ON 6
 uu_7                -1.086793e-01 1 1  ON 7
 uu_8                -3.910570e-02 1 1  ON 8
 uu_9                 2.018489e-01 1 1  ON 9
 ud_0                 3.487946e-01 1 1  ON 10
 ud_1                 9.361326e-02 1 1  ON 11
 ud_2                -1.121008e-02 1 1  ON 12
 ud_3                -7.113617e-02 1 1  ON 13
 ud_4                -1.229549e-01 1 1  ON 14
 ud_5                -1.632453e-01 1 1  ON 15
 ud_6                -1.787278e-01 1 1  ON 16
 ud_7                -1.587220e-01 1 1  ON 17
 ud_8                -1.109251e-01 1 1  ON 18
 ud_9                 3.291881e-02 1 1  ON 19
 eO_0                -9.080441e-01 1 1  ON 20
 eO_1                -5.924545e-01 1 1  ON 21
 eO_2                -1.894650e-01 1 1  ON 22
 eO_3                 7.688307e-02 1 1  ON 23
 eO_4                 2.047951e-01 1 1  ON 24
 eO_5                 2.984447e-01 1 1  ON 25
 eO_6                 3.261863e-01 1 1  ON 26
 eO_7                 5.335989e-01 1 1  ON 27
 eO_8                 1.577151e-01 1 1  ON 28
 eO_9                 5.318111e-02 1 1  ON 29
eH1_0                -2.214260e-01 1 1  ON 30
eH1_1                -1.428930e-01 1 1  ON 31
eH1_2                -1.020682e-01 1 1  ON 32
eH1_3                -6.501671e-02 1 1  ON 33
eH1_4                -1.860226e-02 1 1  ON 34
eH1_5                -5.542614e-03 1 1  ON 35
eH1_6                 3.534684e-02 1 1  ON 36
eH1_7                 8.048936e-02 1 1  ON 37
eH1_8                 2.648815e-01 1 1  ON 38
eH1_9                 1.133957e-01 1 1  ON 39
eH2_0                -2.104426e-01 1 1  ON 40
eH2_1                -1.314480e-01 1 1  ON 41
eH2_2                -9.076064e-02 1 1  ON 42
eH2_3                -5.336080e-02 1 1  ON 43
eH2_4                -6.967680e-03 1 1  ON 44
eH2_5                 5.934095e-03 1 1  ON 45
eH2_6                 4.829251e-02 1 1  ON 46
eH2_7                 3.813575e-02 1 1  ON 47
eH2_8                 2.483117e-01 1 1  ON 48
eH2_9                 1.153048e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.19283
====================================================
  Execution time = 2.0039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2119e-01
  Total weights = 2.0000e+06
  Execution time = 1.8340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321216247458
                                         uncertainty =       0.003672516620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321216247458
                                         uncertainty =       0.003672516620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400716942
  error estimate for blocks of size 2^( 2) =       0.000410238163
  error estimate for blocks of size 2^( 3) =       0.000418445209
  error estimate for blocks of size 2^( 4) =       0.000424581842
  error estimate for blocks of size 2^( 5) =       0.000426700738
  error estimate for blocks of size 2^( 6) =       0.000428938514
  error estimate for blocks of size 2^( 7) =       0.000430042959

      target function =                  N/A
              le_mean =     -17.217098282581
             les_mean =     296.749621246532
             stat err =       0.000427566013
             autocorr =       1.138494519385
              std dev =       0.566699333893
             le_variance =       0.321148135035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321262452293
                                         uncertainty =       0.003676109273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321262452293
                                         uncertainty =       0.003676109273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400745728
  error estimate for blocks of size 2^( 2) =       0.000410269264
  error estimate for blocks of size 2^( 3) =       0.000418476352
  error estimate for blocks of size 2^( 4) =       0.000424612175
  error estimate for blocks of size 2^( 5) =       0.000426732534
  error estimate for blocks of size 2^( 6) =       0.000428974713
  error estimate for blocks of size 2^( 7) =       0.000430079117

      target function =                  N/A
              le_mean =     -17.217099049381
             les_mean =     296.749693793031
             stat err =       0.000427599635
             autocorr =       1.138509996650
              std dev =       0.566740043975
             le_variance =       0.321194277445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321297791082
                                         uncertainty =       0.003676307261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321297791082
                                         uncertainty =       0.003676307261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400767775
  error estimate for blocks of size 2^( 2) =       0.000410290210
  error estimate for blocks of size 2^( 3) =       0.000418496109
  error estimate for blocks of size 2^( 4) =       0.000424631924
  error estimate for blocks of size 2^( 5) =       0.000426751675
  error estimate for blocks of size 2^( 6) =       0.000428992260
  error estimate for blocks of size 2^( 7) =       0.000430097189

      target function =                  N/A
              le_mean =     -17.217098405844
             les_mean =     296.749706974271
             stat err =       0.000427618262
             autocorr =       1.138483922452
              std dev =       0.566771222243
             le_variance =       0.321229618363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233064930
                                         uncertainty =       0.003673225678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321233064930
                                         uncertainty =       0.003673225678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400727427
  error estimate for blocks of size 2^( 2) =       0.000410248719
  error estimate for blocks of size 2^( 3) =       0.000418455456
  error estimate for blocks of size 2^( 4) =       0.000424591962
  error estimate for blocks of size 2^( 5) =       0.000426710925
  error estimate for blocks of size 2^( 6) =       0.000428949036
  error estimate for blocks of size 2^( 7) =       0.000430053441

      target function =                  N/A
              le_mean =     -17.217098288687
             les_mean =     296.749638263245
             stat err =       0.000427576341
             autocorr =       1.138489940023
              std dev =       0.566714162085
             le_variance =       0.321164941508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217098282581        initial
     2.3842e-01     2.3842e+00             6.4125e-04       -17.217099049381  <--
     9.5367e-01     9.5367e+00             1.8833e-04       -17.217098405844
     3.8147e+00     3.8147e+01             4.8187e-05       -17.217098288687

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.9274e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.908166e-01 1 1  ON 0
 uu_1                 2.904769e-02 1 1  ON 1
 uu_2                -6.450481e-02 1 1  ON 2
 uu_3                -1.201512e-01 1 1  ON 3
 uu_4                -1.563814e-01 1 1  ON 4
 uu_5                -1.684584e-01 1 1  ON 5
 uu_6                -1.558898e-01 1 1  ON 6
 uu_7                -1.087013e-01 1 1  ON 7
 uu_8                -3.903171e-02 1 1  ON 8
 uu_9                 2.017728e-01 1 1  ON 9
 ud_0                 3.487463e-01 1 1  ON 10
 ud_1                 9.351967e-02 1 1  ON 11
 ud_2                -1.121157e-02 1 1  ON 12
 ud_3                -7.110045e-02 1 1  ON 13
 ud_4                -1.229038e-01 1 1  ON 14
 ud_5                -1.632604e-01 1 1  ON 15
 ud_6                -1.787663e-01 1 1  ON 16
 ud_7                -1.586469e-01 1 1  ON 17
 ud_8                -1.109524e-01 1 1  ON 18
 ud_9                 3.283960e-02 1 1  ON 19
 eO_0                -9.078917e-01 1 1  ON 20
 eO_1                -5.924318e-01 1 1  ON 21
 eO_2                -1.895131e-01 1 1  ON 22
 eO_3                 7.678101e-02 1 1  ON 23
 eO_4                 2.046395e-01 1 1  ON 24
 eO_5                 2.985069e-01 1 1  ON 25
 eO_6                 3.262474e-01 1 1  ON 26
 eO_7                 5.335055e-01 1 1  ON 27
 eO_8                 1.577641e-01 1 1  ON 28
 eO_9                 5.320051e-02 1 1  ON 29
eH1_0                -2.214422e-01 1 1  ON 30
eH1_1                -1.427878e-01 1 1  ON 31
eH1_2                -1.021662e-01 1 1  ON 32
eH1_3                -6.515524e-02 1 1  ON 33
eH1_4                -1.861631e-02 1 1  ON 34
eH1_5                -5.415565e-03 1 1  ON 35
eH1_6                 3.552310e-02 1 1  ON 36
eH1_7                 8.039624e-02 1 1  ON 37
eH1_8                 2.647848e-01 1 1  ON 38
eH1_9                 1.134088e-01 1 1  ON 39
eH2_0                -2.099897e-01 1 1  ON 40
eH2_1                -1.313339e-01 1 1  ON 41
eH2_2                -9.083074e-02 1 1  ON 42
eH2_3                -5.354114e-02 1 1  ON 43
eH2_4                -7.065595e-03 1 1  ON 44
eH2_5                 5.618273e-03 1 1  ON 45
eH2_6                 4.816844e-02 1 1  ON 46
eH2_7                 3.833772e-02 1 1  ON 47
eH2_8                 2.482739e-01 1 1  ON 48
eH2_9                 1.153201e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.223857
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325296306064
                                         uncertainty =       0.003827887355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325296306064
                                         uncertainty =       0.003827887355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403249989
  error estimate for blocks of size 2^( 2) =       0.000412913799
  error estimate for blocks of size 2^( 3) =       0.000421480358
  error estimate for blocks of size 2^( 4) =       0.000427621692
  error estimate for blocks of size 2^( 5) =       0.000431898626
  error estimate for blocks of size 2^( 6) =       0.000433837294
  error estimate for blocks of size 2^( 7) =       0.000433838943

      target function =                  N/A
              le_mean =     -17.216533084747
             les_mean =     296.734232402098
             stat err =       0.000431799139
             autocorr =       1.146607600507
              std dev =       0.570281602815
             le_variance =       0.325221106509


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653308475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533084747       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533152990       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533382235       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535092160       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216534824756       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535722859       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216536270357       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535072578       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216535728535       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216535716031       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216535955383       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 1.550848e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533084747       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533123679       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533203365       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216534040489       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216534096588       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216534749533       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216534726823       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216534301625       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216534410454       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 5.836302e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533084747       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533099071       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533106838       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216533367768       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216533484057       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216533730325       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216533623938       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.633308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.398893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6199e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.909263e-01 1 1  ON 0
 uu_1                 2.891697e-02 1 1  ON 1
 uu_2                -6.460112e-02 1 1  ON 2
 uu_3                -1.200309e-01 1 1  ON 3
 uu_4                -1.562977e-01 1 1  ON 4
 uu_5                -1.684488e-01 1 1  ON 5
 uu_6                -1.558852e-01 1 1  ON 6
 uu_7                -1.088673e-01 1 1  ON 7
 uu_8                -3.902599e-02 1 1  ON 8
 uu_9                 2.016406e-01 1 1  ON 9
 ud_0                 3.487847e-01 1 1  ON 10
 ud_1                 9.358959e-02 1 1  ON 11
 ud_2                -1.116249e-02 1 1  ON 12
 ud_3                -7.111612e-02 1 1  ON 13
 ud_4                -1.228555e-01 1 1  ON 14
 ud_5                -1.634769e-01 1 1  ON 15
 ud_6                -1.788674e-01 1 1  ON 16
 ud_7                -1.586167e-01 1 1  ON 17
 ud_8                -1.109283e-01 1 1  ON 18
 ud_9                 3.279633e-02 1 1  ON 19
 eO_0                -9.078606e-01 1 1  ON 20
 eO_1                -5.924785e-01 1 1  ON 21
 eO_2                -1.895663e-01 1 1  ON 22
 eO_3                 7.662841e-02 1 1  ON 23
 eO_4                 2.049674e-01 1 1  ON 24
 eO_5                 2.985053e-01 1 1  ON 25
 eO_6                 3.261336e-01 1 1  ON 26
 eO_7                 5.333635e-01 1 1  ON 27
 eO_8                 1.578640e-01 1 1  ON 28
 eO_9                 5.323010e-02 1 1  ON 29
eH1_0                -2.213568e-01 1 1  ON 30
eH1_1                -1.429157e-01 1 1  ON 31
eH1_2                -1.021965e-01 1 1  ON 32
eH1_3                -6.534051e-02 1 1  ON 33
eH1_4                -1.870994e-02 1 1  ON 34
eH1_5                -4.831935e-03 1 1  ON 35
eH1_6                 3.556102e-02 1 1  ON 36
eH1_7                 8.014428e-02 1 1  ON 37
eH1_8                 2.646523e-01 1 1  ON 38
eH1_9                 1.134605e-01 1 1  ON 39
eH2_0                -2.098926e-01 1 1  ON 40
eH2_1                -1.314016e-01 1 1  ON 41
eH2_2                -9.070719e-02 1 1  ON 42
eH2_3                -5.368663e-02 1 1  ON 43
eH2_4                -6.903176e-03 1 1  ON 44
eH2_5                 5.342820e-03 1 1  ON 45
eH2_6                 4.801964e-02 1 1  ON 46
eH2_7                 3.859301e-02 1 1  ON 47
eH2_8                 2.482465e-01 1 1  ON 48
eH2_9                 1.153327e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1169
    reference variance = 0.215045
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321829886258
                                         uncertainty =       0.003551356716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321829886258
                                         uncertainty =       0.003551356716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401115582
  error estimate for blocks of size 2^( 2) =       0.000410453436
  error estimate for blocks of size 2^( 3) =       0.000418473935
  error estimate for blocks of size 2^( 4) =       0.000424549569
  error estimate for blocks of size 2^( 5) =       0.000427957033
  error estimate for blocks of size 2^( 6) =       0.000429017265
  error estimate for blocks of size 2^( 7) =       0.000430439452

      target function =                  N/A
              le_mean =     -17.216812281734
             les_mean =     296.740412403872
             stat err =       0.000427990830
             autocorr =       1.138491680572
              std dev =       0.567263096195
             le_variance =       0.321787420304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321801305949
                                         uncertainty =       0.003552291103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321801305949
                                         uncertainty =       0.003552291103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401097812
  error estimate for blocks of size 2^( 2) =       0.000410438262
  error estimate for blocks of size 2^( 3) =       0.000418461092
  error estimate for blocks of size 2^( 4) =       0.000424537010
  error estimate for blocks of size 2^( 5) =       0.000427946637
  error estimate for blocks of size 2^( 6) =       0.000429008734
  error estimate for blocks of size 2^( 7) =       0.000430435724

      target function =                  N/A
              le_mean =     -17.216810097885
             les_mean =     296.740308695164
             stat err =       0.000427982026
             autocorr =       1.138545722147
              std dev =       0.567237965403
             le_variance =       0.321758909394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321788839700
                                         uncertainty =       0.003552691204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321788839700
                                         uncertainty =       0.003552691204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401090049
  error estimate for blocks of size 2^( 2) =       0.000410432705
  error estimate for blocks of size 2^( 3) =       0.000418456334
  error estimate for blocks of size 2^( 4) =       0.000424532409
  error estimate for blocks of size 2^( 5) =       0.000427943990
  error estimate for blocks of size 2^( 6) =       0.000429002647
  error estimate for blocks of size 2^( 7) =       0.000430427587

      target function =                  N/A
              le_mean =     -17.216809208127
             les_mean =     296.740265603367
             stat err =       0.000427976658
             autocorr =       1.138561231768
              std dev =       0.567226987358
             le_variance =       0.321746455188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321817411562
                                         uncertainty =       0.003551664059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321817411562
                                         uncertainty =       0.003551664059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401107809
  error estimate for blocks of size 2^( 2) =       0.000410446829
  error estimate for blocks of size 2^( 3) =       0.000418467975
  error estimate for blocks of size 2^( 4) =       0.000424543693
  error estimate for blocks of size 2^( 5) =       0.000427952041
  error estimate for blocks of size 2^( 6) =       0.000429011365
  error estimate for blocks of size 2^( 7) =       0.000430433906

      target function =                  N/A
              le_mean =     -17.216811333128
             les_mean =     296.740367269003
             stat err =       0.000427985251
             autocorr =       1.138506124717
              std dev =       0.567252103889
             le_variance =       0.321774949367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216812281734        initial  <--
     5.9605e-02     5.9605e-01             1.5508e-03       -17.216810097885
     2.3842e-01     2.3842e+00             5.8363e-04       -17.216809208127
     9.5367e-01     9.5367e+00             1.6333e-04       -17.216811333128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7113
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.908166e-01 1 1  ON 0
 uu_1                 2.904769e-02 1 1  ON 1
 uu_2                -6.450481e-02 1 1  ON 2
 uu_3                -1.201512e-01 1 1  ON 3
 uu_4                -1.563814e-01 1 1  ON 4
 uu_5                -1.684584e-01 1 1  ON 5
 uu_6                -1.558898e-01 1 1  ON 6
 uu_7                -1.087013e-01 1 1  ON 7
 uu_8                -3.903171e-02 1 1  ON 8
 uu_9                 2.017728e-01 1 1  ON 9
 ud_0                 3.487463e-01 1 1  ON 10
 ud_1                 9.351967e-02 1 1  ON 11
 ud_2                -1.121157e-02 1 1  ON 12
 ud_3                -7.110045e-02 1 1  ON 13
 ud_4                -1.229038e-01 1 1  ON 14
 ud_5                -1.632604e-01 1 1  ON 15
 ud_6                -1.787663e-01 1 1  ON 16
 ud_7                -1.586469e-01 1 1  ON 17
 ud_8                -1.109524e-01 1 1  ON 18
 ud_9                 3.283960e-02 1 1  ON 19
 eO_0                -9.078917e-01 1 1  ON 20
 eO_1                -5.924318e-01 1 1  ON 21
 eO_2                -1.895131e-01 1 1  ON 22
 eO_3                 7.678101e-02 1 1  ON 23
 eO_4                 2.046395e-01 1 1  ON 24
 eO_5                 2.985069e-01 1 1  ON 25
 eO_6                 3.262474e-01 1 1  ON 26
 eO_7                 5.335055e-01 1 1  ON 27
 eO_8                 1.577641e-01 1 1  ON 28
 eO_9                 5.320051e-02 1 1  ON 29
eH1_0                -2.214422e-01 1 1  ON 30
eH1_1                -1.427878e-01 1 1  ON 31
eH1_2                -1.021662e-01 1 1  ON 32
eH1_3                -6.515524e-02 1 1  ON 33
eH1_4                -1.861631e-02 1 1  ON 34
eH1_5                -5.415565e-03 1 1  ON 35
eH1_6                 3.552310e-02 1 1  ON 36
eH1_7                 8.039624e-02 1 1  ON 37
eH1_8                 2.647848e-01 1 1  ON 38
eH1_9                 1.134088e-01 1 1  ON 39
eH2_0                -2.099897e-01 1 1  ON 40
eH2_1                -1.313339e-01 1 1  ON 41
eH2_2                -9.083074e-02 1 1  ON 42
eH2_3                -5.354114e-02 1 1  ON 43
eH2_4                -7.065595e-03 1 1  ON 44
eH2_5                 5.618273e-03 1 1  ON 45
eH2_6                 4.816844e-02 1 1  ON 46
eH2_7                 3.833772e-02 1 1  ON 47
eH2_8                 2.482739e-01 1 1  ON 48
eH2_9                 1.153201e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5916e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1795
    reference variance = 0.217133
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327754581114
                                         uncertainty =       0.004071846585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327754581114
                                         uncertainty =       0.004071846585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404765093
  error estimate for blocks of size 2^( 2) =       0.000414331503
  error estimate for blocks of size 2^( 3) =       0.000422186347
  error estimate for blocks of size 2^( 4) =       0.000428347474
  error estimate for blocks of size 2^( 5) =       0.000431502936
  error estimate for blocks of size 2^( 6) =       0.000432433602
  error estimate for blocks of size 2^( 7) =       0.000430885566

      target function =                  N/A
              le_mean =     -17.216591401487
             les_mean =     296.738688882590
             stat err =       0.000430792395
             autocorr =       1.132739256223
              std dev =       0.572424283797
             le_variance =       0.327669560680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659140149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216591401487       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591605187       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591116725       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216591148867       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216591709756       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216591383028       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216591391055       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.078718e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216591401487       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591466955       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591319487       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216591301639       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216591492595       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216591398640       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216591398992       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 5.695546e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216591401487       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216591419112       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216591380219       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216591372656       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216591425351       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216591402211       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216591401720       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.458505e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6259e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.908152e-01 1 1  ON 0
 uu_1                 2.902357e-02 1 1  ON 1
 uu_2                -6.449129e-02 1 1  ON 2
 uu_3                -1.201623e-01 1 1  ON 3
 uu_4                -1.563413e-01 1 1  ON 4
 uu_5                -1.684703e-01 1 1  ON 5
 uu_6                -1.559026e-01 1 1  ON 6
 uu_7                -1.087110e-01 1 1  ON 7
 uu_8                -3.902639e-02 1 1  ON 8
 uu_9                 2.017617e-01 1 1  ON 9
 ud_0                 3.487470e-01 1 1  ON 10
 ud_1                 9.354374e-02 1 1  ON 11
 ud_2                -1.121378e-02 1 1  ON 12
 ud_3                -7.110540e-02 1 1  ON 13
 ud_4                -1.229156e-01 1 1  ON 14
 ud_5                -1.632986e-01 1 1  ON 15
 ud_6                -1.787391e-01 1 1  ON 16
 ud_7                -1.586378e-01 1 1  ON 17
 ud_8                -1.109580e-01 1 1  ON 18
 ud_9                 3.282781e-02 1 1  ON 19
 eO_0                -9.078622e-01 1 1  ON 20
 eO_1                -5.924659e-01 1 1  ON 21
 eO_2                -1.894937e-01 1 1  ON 22
 eO_3                 7.676797e-02 1 1  ON 23
 eO_4                 2.046546e-01 1 1  ON 24
 eO_5                 2.984924e-01 1 1  ON 25
 eO_6                 3.262437e-01 1 1  ON 26
 eO_7                 5.334944e-01 1 1  ON 27
 eO_8                 1.577704e-01 1 1  ON 28
 eO_9                 5.320357e-02 1 1  ON 29
eH1_0                -2.214348e-01 1 1  ON 30
eH1_1                -1.428290e-01 1 1  ON 31
eH1_2                -1.021416e-01 1 1  ON 32
eH1_3                -6.515788e-02 1 1  ON 33
eH1_4                -1.862780e-02 1 1  ON 34
eH1_5                -5.358610e-03 1 1  ON 35
eH1_6                 3.552811e-02 1 1  ON 36
eH1_7                 8.036093e-02 1 1  ON 37
eH1_8                 2.647728e-01 1 1  ON 38
eH1_9                 1.134149e-01 1 1  ON 39
eH2_0                -2.099631e-01 1 1  ON 40
eH2_1                -1.313732e-01 1 1  ON 41
eH2_2                -9.080729e-02 1 1  ON 42
eH2_3                -5.358729e-02 1 1  ON 43
eH2_4                -7.046532e-03 1 1  ON 44
eH2_5                 5.625449e-03 1 1  ON 45
eH2_6                 4.815893e-02 1 1  ON 46
eH2_7                 3.835766e-02 1 1  ON 47
eH2_8                 2.482670e-01 1 1  ON 48
eH2_9                 1.153212e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2116
    reference variance = 0.501051
====================================================
  Execution time = 1.9957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.0000e+06
  Execution time = 1.8274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319055747483
                                         uncertainty =       0.003824417263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319055747483
                                         uncertainty =       0.003824417263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399376325
  error estimate for blocks of size 2^( 2) =       0.000408883755
  error estimate for blocks of size 2^( 3) =       0.000416872407
  error estimate for blocks of size 2^( 4) =       0.000422744456
  error estimate for blocks of size 2^( 5) =       0.000425845578
  error estimate for blocks of size 2^( 6) =       0.000428146774
  error estimate for blocks of size 2^( 7) =       0.000427753515

      target function =                  N/A
              le_mean =     -17.215758404606
             les_mean =     296.701340184773
             stat err =       0.000426122581
             autocorr =       1.138425103016
              std dev =       0.564803415810
             le_variance =       0.319002898510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318998256729
                                         uncertainty =       0.003823273873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318998256729
                                         uncertainty =       0.003823273873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399340364
  error estimate for blocks of size 2^( 2) =       0.000408848479
  error estimate for blocks of size 2^( 3) =       0.000416838785
  error estimate for blocks of size 2^( 4) =       0.000422709125
  error estimate for blocks of size 2^( 5) =       0.000425811342
  error estimate for blocks of size 2^( 6) =       0.000428112690
  error estimate for blocks of size 2^( 7) =       0.000427717300

      target function =                  N/A
              le_mean =     -17.215758843638
             les_mean =     296.701297855986
             stat err =       0.000426087614
             autocorr =       1.138443287419
              std dev =       0.564752559219
             le_variance =       0.318945453144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319009232731
                                         uncertainty =       0.003823719773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319009232731
                                         uncertainty =       0.003823719773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399347225
  error estimate for blocks of size 2^( 2) =       0.000408855348
  error estimate for blocks of size 2^( 3) =       0.000416845333
  error estimate for blocks of size 2^( 4) =       0.000422716169
  error estimate for blocks of size 2^( 5) =       0.000425818254
  error estimate for blocks of size 2^( 6) =       0.000428120101
  error estimate for blocks of size 2^( 7) =       0.000427725223

      target function =                  N/A
              le_mean =     -17.215758723627
             les_mean =     296.701304683409
             stat err =       0.000426094937
             autocorr =       1.138443297570
              std dev =       0.564762262159
             le_variance =       0.318956412759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048866869
                                         uncertainty =       0.003824323474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048866869
                                         uncertainty =       0.003824323474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399372021
  error estimate for blocks of size 2^( 2) =       0.000408879557
  error estimate for blocks of size 2^( 3) =       0.000416868402
  error estimate for blocks of size 2^( 4) =       0.000422740279
  error estimate for blocks of size 2^( 5) =       0.000425841544
  error estimate for blocks of size 2^( 6) =       0.000428142857
  error estimate for blocks of size 2^( 7) =       0.000427749365

      target function =                  N/A
              le_mean =     -17.215758445198
             les_mean =     296.701334705722
             stat err =       0.000426118511
             autocorr =       1.138427900441
              std dev =       0.564797328088
             le_variance =       0.318996021815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215758404606        initial
     5.9605e-01     5.9605e+00             2.0787e-04       -17.215758843638  <--
     2.3842e+00     2.3842e+01             5.6955e-05       -17.215758723627
     9.5367e+00     9.5367e+01             1.4585e-05       -17.215758445198

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.9156e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.907983e-01 1 1  ON 0
 uu_1                 2.898540e-02 1 1  ON 1
 uu_2                -6.447658e-02 1 1  ON 2
 uu_3                -1.201659e-01 1 1  ON 3
 uu_4                -1.562649e-01 1 1  ON 4
 uu_5                -1.684871e-01 1 1  ON 5
 uu_6                -1.559364e-01 1 1  ON 6
 uu_7                -1.087391e-01 1 1  ON 7
 uu_8                -3.901265e-02 1 1  ON 8
 uu_9                 2.017320e-01 1 1  ON 9
 ud_0                 3.487617e-01 1 1  ON 10
 ud_1                 9.358520e-02 1 1  ON 11
 ud_2                -1.121238e-02 1 1  ON 12
 ud_3                -7.112209e-02 1 1  ON 13
 ud_4                -1.229445e-01 1 1  ON 14
 ud_5                -1.633938e-01 1 1  ON 15
 ud_6                -1.786704e-01 1 1  ON 16
 ud_7                -1.586135e-01 1 1  ON 17
 ud_8                -1.109725e-01 1 1  ON 18
 ud_9                 3.279642e-02 1 1  ON 19
 eO_0                -9.078123e-01 1 1  ON 20
 eO_1                -5.925174e-01 1 1  ON 21
 eO_2                -1.894541e-01 1 1  ON 22
 eO_3                 7.673367e-02 1 1  ON 23
 eO_4                 2.046962e-01 1 1  ON 24
 eO_5                 2.984545e-01 1 1  ON 25
 eO_6                 3.262331e-01 1 1  ON 26
 eO_7                 5.334647e-01 1 1  ON 27
 eO_8                 1.577873e-01 1 1  ON 28
 eO_9                 5.321172e-02 1 1  ON 29
eH1_0                -2.214202e-01 1 1  ON 30
eH1_1                -1.429185e-01 1 1  ON 31
eH1_2                -1.020958e-01 1 1  ON 32
eH1_3                -6.516178e-02 1 1  ON 33
eH1_4                -1.865620e-02 1 1  ON 34
eH1_5                -5.207693e-03 1 1  ON 35
eH1_6                 3.554207e-02 1 1  ON 36
eH1_7                 8.026661e-02 1 1  ON 37
eH1_8                 2.647407e-01 1 1  ON 38
eH1_9                 1.134313e-01 1 1  ON 39
eH2_0                -2.098976e-01 1 1  ON 40
eH2_1                -1.314666e-01 1 1  ON 41
eH2_2                -9.076748e-02 1 1  ON 42
eH2_3                -5.368743e-02 1 1  ON 43
eH2_4                -7.008064e-03 1 1  ON 44
eH2_5                 5.649862e-03 1 1  ON 45
eH2_6                 4.813513e-02 1 1  ON 46
eH2_7                 3.841058e-02 1 1  ON 47
eH2_8                 2.482486e-01 1 1  ON 48
eH2_9                 1.153241e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.3164
    reference variance = 0.309143
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3487e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334950730042
                                         uncertainty =       0.009175330606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334950730042
                                         uncertainty =       0.009175330606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409186866
  error estimate for blocks of size 2^( 2) =       0.000418564457
  error estimate for blocks of size 2^( 3) =       0.000427696553
  error estimate for blocks of size 2^( 4) =       0.000433508001
  error estimate for blocks of size 2^( 5) =       0.000438454282
  error estimate for blocks of size 2^( 6) =       0.000439211104
  error estimate for blocks of size 2^( 7) =       0.000440709043

      target function =                  N/A
              le_mean =     -17.216249604182
             les_mean =     296.734118049225
             stat err =       0.000437970608
             autocorr =       1.145635757123
              std dev =       0.578677615927
             le_variance =       0.334867783175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721624960418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249604182       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216249999657       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216249742018       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216249830728       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216249946754       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216249912103       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216250239178       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216250613754       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216250581743       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216250449877       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 5.415284e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249604182       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216249802560       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216249673786       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216249814836       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216249779840       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216249877585       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216249920133       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.601588e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249604182       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216249670451       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216249627804       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216249674985       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216249692680       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216249715705       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216249719389       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 4.341405e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.403830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6380e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.907446e-01 1 1  ON 0
 uu_1                 2.899389e-02 1 1  ON 1
 uu_2                -6.458483e-02 1 1  ON 2
 uu_3                -1.201171e-01 1 1  ON 3
 uu_4                -1.562022e-01 1 1  ON 4
 uu_5                -1.683269e-01 1 1  ON 5
 uu_6                -1.559863e-01 1 1  ON 6
 uu_7                -1.088677e-01 1 1  ON 7
 uu_8                -3.898412e-02 1 1  ON 8
 uu_9                 2.017097e-01 1 1  ON 9
 ud_0                 3.487439e-01 1 1  ON 10
 ud_1                 9.362994e-02 1 1  ON 11
 ud_2                -1.116438e-02 1 1  ON 12
 ud_3                -7.117369e-02 1 1  ON 13
 ud_4                -1.230144e-01 1 1  ON 14
 ud_5                -1.632907e-01 1 1  ON 15
 ud_6                -1.786955e-01 1 1  ON 16
 ud_7                -1.586565e-01 1 1  ON 17
 ud_8                -1.109769e-01 1 1  ON 18
 ud_9                 3.276640e-02 1 1  ON 19
 eO_0                -9.077842e-01 1 1  ON 20
 eO_1                -5.924346e-01 1 1  ON 21
 eO_2                -1.894116e-01 1 1  ON 22
 eO_3                 7.668625e-02 1 1  ON 23
 eO_4                 2.046092e-01 1 1  ON 24
 eO_5                 2.984142e-01 1 1  ON 25
 eO_6                 3.262333e-01 1 1  ON 26
 eO_7                 5.334262e-01 1 1  ON 27
 eO_8                 1.578301e-01 1 1  ON 28
 eO_9                 5.322541e-02 1 1  ON 29
eH1_0                -2.213048e-01 1 1  ON 30
eH1_1                -1.428263e-01 1 1  ON 31
eH1_2                -1.021067e-01 1 1  ON 32
eH1_3                -6.517141e-02 1 1  ON 33
eH1_4                -1.866756e-02 1 1  ON 34
eH1_5                -5.195769e-03 1 1  ON 35
eH1_6                 3.549387e-02 1 1  ON 36
eH1_7                 8.014455e-02 1 1  ON 37
eH1_8                 2.646879e-01 1 1  ON 38
eH1_9                 1.134503e-01 1 1  ON 39
eH2_0                -2.098668e-01 1 1  ON 40
eH2_1                -1.314558e-01 1 1  ON 41
eH2_2                -9.085718e-02 1 1  ON 42
eH2_3                -5.365087e-02 1 1  ON 43
eH2_4                -7.072332e-03 1 1  ON 44
eH2_5                 5.601283e-03 1 1  ON 45
eH2_6                 4.815379e-02 1 1  ON 46
eH2_7                 3.852522e-02 1 1  ON 47
eH2_8                 2.482243e-01 1 1  ON 48
eH2_9                 1.153300e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1903
    reference variance = 0.16895
====================================================
  Execution time = 1.9998e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2054e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320492328907
                                         uncertainty =       0.003903857640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320492328907
                                         uncertainty =       0.003903857640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400345160
  error estimate for blocks of size 2^( 2) =       0.000409829772
  error estimate for blocks of size 2^( 3) =       0.000417491866
  error estimate for blocks of size 2^( 4) =       0.000423768561
  error estimate for blocks of size 2^( 5) =       0.000427265593
  error estimate for blocks of size 2^( 6) =       0.000428886507
  error estimate for blocks of size 2^( 7) =       0.000431342731

      target function =                  N/A
              le_mean =     -17.216824315539
             les_mean =     296.739591845596
             stat err =       0.000427815848
             autocorr =       1.141943384995
              std dev =       0.566173554434
             le_variance =       0.320552493741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320448227342
                                         uncertainty =       0.003899589783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320448227342
                                         uncertainty =       0.003899589783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400317593
  error estimate for blocks of size 2^( 2) =       0.000409805252
  error estimate for blocks of size 2^( 3) =       0.000417467306
  error estimate for blocks of size 2^( 4) =       0.000423740954
  error estimate for blocks of size 2^( 5) =       0.000427234128
  error estimate for blocks of size 2^( 6) =       0.000428855244
  error estimate for blocks of size 2^( 7) =       0.000431317955

      target function =                  N/A
              le_mean =     -17.216826992179
             les_mean =     296.739639869703
             stat err =       0.000427787070
             autocorr =       1.141947014911
              std dev =       0.566134569973
             le_variance =       0.320508351318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320464006858
                                         uncertainty =       0.003900171530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320464006858
                                         uncertainty =       0.003900171530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400327441
  error estimate for blocks of size 2^( 2) =       0.000409815761
  error estimate for blocks of size 2^( 3) =       0.000417477533
  error estimate for blocks of size 2^( 4) =       0.000423749912
  error estimate for blocks of size 2^( 5) =       0.000427242162
  error estimate for blocks of size 2^( 6) =       0.000428863817
  error estimate for blocks of size 2^( 7) =       0.000431326351

      target function =                  N/A
              le_mean =     -17.216827665107
             les_mean =     296.739678809861
             stat err =       0.000427795561
             autocorr =       1.141936160878
              std dev =       0.566148496527
             le_variance =       0.320524120119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320484035683
                                         uncertainty =       0.003903196952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320484035683
                                         uncertainty =       0.003903196952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400339975
  error estimate for blocks of size 2^( 2) =       0.000409825365
  error estimate for blocks of size 2^( 3) =       0.000417487416
  error estimate for blocks of size 2^( 4) =       0.000423763259
  error estimate for blocks of size 2^( 5) =       0.000427259525
  error estimate for blocks of size 2^( 6) =       0.000428880548
  error estimate for blocks of size 2^( 7) =       0.000431337784

      target function =                  N/A
              le_mean =     -17.216824861790
             les_mean =     296.739602351769
             stat err =       0.000427810279
             autocorr =       1.141943233378
              std dev =       0.566166221613
             le_variance =       0.320544190496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216824315539        initial
     1.4901e-01     1.4901e+00             5.4153e-04       -17.216826992179
     5.9605e-01     5.9605e+00             1.6016e-04       -17.216827665107  <--
     2.3842e+00     2.3842e+01             4.3414e-05       -17.216824861790

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.9205e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.907446e-01 1 1  ON 0
 uu_1                 2.899389e-02 1 1  ON 1
 uu_2                -6.458483e-02 1 1  ON 2
 uu_3                -1.201171e-01 1 1  ON 3
 uu_4                -1.562022e-01 1 1  ON 4
 uu_5                -1.683269e-01 1 1  ON 5
 uu_6                -1.559863e-01 1 1  ON 6
 uu_7                -1.088677e-01 1 1  ON 7
 uu_8                -3.898412e-02 1 1  ON 8
 uu_9                 2.017097e-01 1 1  ON 9
 ud_0                 3.487439e-01 1 1  ON 10
 ud_1                 9.362994e-02 1 1  ON 11
 ud_2                -1.116438e-02 1 1  ON 12
 ud_3                -7.117369e-02 1 1  ON 13
 ud_4                -1.230144e-01 1 1  ON 14
 ud_5                -1.632907e-01 1 1  ON 15
 ud_6                -1.786955e-01 1 1  ON 16
 ud_7                -1.586565e-01 1 1  ON 17
 ud_8                -1.109769e-01 1 1  ON 18
 ud_9                 3.276640e-02 1 1  ON 19
 eO_0                -9.077842e-01 1 1  ON 20
 eO_1                -5.924346e-01 1 1  ON 21
 eO_2                -1.894116e-01 1 1  ON 22
 eO_3                 7.668625e-02 1 1  ON 23
 eO_4                 2.046092e-01 1 1  ON 24
 eO_5                 2.984142e-01 1 1  ON 25
 eO_6                 3.262333e-01 1 1  ON 26
 eO_7                 5.334262e-01 1 1  ON 27
 eO_8                 1.578301e-01 1 1  ON 28
 eO_9                 5.322541e-02 1 1  ON 29
eH1_0                -2.213048e-01 1 1  ON 30
eH1_1                -1.428263e-01 1 1  ON 31
eH1_2                -1.021067e-01 1 1  ON 32
eH1_3                -6.517141e-02 1 1  ON 33
eH1_4                -1.866756e-02 1 1  ON 34
eH1_5                -5.195769e-03 1 1  ON 35
eH1_6                 3.549387e-02 1 1  ON 36
eH1_7                 8.014455e-02 1 1  ON 37
eH1_8                 2.646879e-01 1 1  ON 38
eH1_9                 1.134503e-01 1 1  ON 39
eH2_0                -2.098668e-01 1 1  ON 40
eH2_1                -1.314558e-01 1 1  ON 41
eH2_2                -9.085718e-02 1 1  ON 42
eH2_3                -5.365087e-02 1 1  ON 43
eH2_4                -7.072332e-03 1 1  ON 44
eH2_5                 5.601283e-03 1 1  ON 45
eH2_6                 4.815379e-02 1 1  ON 46
eH2_7                 3.852522e-02 1 1  ON 47
eH2_8                 2.482243e-01 1 1  ON 48
eH2_9                 1.153300e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5591e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1388
    reference variance = 0.340017
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332226584076
                                         uncertainty =       0.007220739409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332226584076
                                         uncertainty =       0.007220739409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407511983
  error estimate for blocks of size 2^( 2) =       0.000416880570
  error estimate for blocks of size 2^( 3) =       0.000424948762
  error estimate for blocks of size 2^( 4) =       0.000430913069
  error estimate for blocks of size 2^( 5) =       0.000434387824
  error estimate for blocks of size 2^( 6) =       0.000435779566
  error estimate for blocks of size 2^( 7) =       0.000435822778

      target function =                  N/A
              le_mean =     -17.216266681045
             les_mean =     296.731970298566
             stat err =       0.000434225809
             autocorr =       1.135404208206
              std dev =       0.576308972483
             le_variance =       0.332132031764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626668105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266681045       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266903285       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216267998020       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267148451       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216267069341       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216267696633       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216268461152       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216268596437       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216268637665       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216268772062       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 6.273003e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266681045       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266784911       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216267328294       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267032999       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266851579       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216267116111       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216267255956       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216267257662       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.041988e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216266681045       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216266714223       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216266893644       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216266821132       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266741827       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216266819834       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 5.599277e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6222e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.907429e-01 1 1  ON 0
 uu_1                 2.901786e-02 1 1  ON 1
 uu_2                -6.461693e-02 1 1  ON 2
 uu_3                -1.201418e-01 1 1  ON 3
 uu_4                -1.562053e-01 1 1  ON 4
 uu_5                -1.682396e-01 1 1  ON 5
 uu_6                -1.559510e-01 1 1  ON 6
 uu_7                -1.089037e-01 1 1  ON 7
 uu_8                -3.901761e-02 1 1  ON 8
 uu_9                 2.016596e-01 1 1  ON 9
 ud_0                 3.486910e-01 1 1  ON 10
 ud_1                 9.366447e-02 1 1  ON 11
 ud_2                -1.108181e-02 1 1  ON 12
 ud_3                -7.109078e-02 1 1  ON 13
 ud_4                -1.229925e-01 1 1  ON 14
 ud_5                -1.634254e-01 1 1  ON 15
 ud_6                -1.787556e-01 1 1  ON 16
 ud_7                -1.585903e-01 1 1  ON 17
 ud_8                -1.109931e-01 1 1  ON 18
 ud_9                 3.272029e-02 1 1  ON 19
 eO_0                -9.076699e-01 1 1  ON 20
 eO_1                -5.924114e-01 1 1  ON 21
 eO_2                -1.894796e-01 1 1  ON 22
 eO_3                 7.658437e-02 1 1  ON 23
 eO_4                 2.046665e-01 1 1  ON 24
 eO_5                 2.983987e-01 1 1  ON 25
 eO_6                 3.262385e-01 1 1  ON 26
 eO_7                 5.333849e-01 1 1  ON 27
 eO_8                 1.578496e-01 1 1  ON 28
 eO_9                 5.323157e-02 1 1  ON 29
eH1_0                -2.214163e-01 1 1  ON 30
eH1_1                -1.428900e-01 1 1  ON 31
eH1_2                -1.022162e-01 1 1  ON 32
eH1_3                -6.515937e-02 1 1  ON 33
eH1_4                -1.853036e-02 1 1  ON 34
eH1_5                -5.017427e-03 1 1  ON 35
eH1_6                 3.555934e-02 1 1  ON 36
eH1_7                 8.005060e-02 1 1  ON 37
eH1_8                 2.646549e-01 1 1  ON 38
eH1_9                 1.134582e-01 1 1  ON 39
eH2_0                -2.099097e-01 1 1  ON 40
eH2_1                -1.315400e-01 1 1  ON 41
eH2_2                -9.086149e-02 1 1  ON 42
eH2_3                -5.356993e-02 1 1  ON 43
eH2_4                -6.868133e-03 1 1  ON 44
eH2_5                 5.455483e-03 1 1  ON 45
eH2_6                 4.809954e-02 1 1  ON 46
eH2_7                 3.860300e-02 1 1  ON 47
eH2_8                 2.481965e-01 1 1  ON 48
eH2_9                 1.153256e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.157524
====================================================
  Execution time = 2.0163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3049e-01
  Total weights = 2.0000e+06
  Execution time = 1.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330660446909
                                         uncertainty =       0.008081413387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330660446909
                                         uncertainty =       0.008081413387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406555822
  error estimate for blocks of size 2^( 2) =       0.000415554232
  error estimate for blocks of size 2^( 3) =       0.000423530106
  error estimate for blocks of size 2^( 4) =       0.000429086685
  error estimate for blocks of size 2^( 5) =       0.000432972373
  error estimate for blocks of size 2^( 6) =       0.000434087548
  error estimate for blocks of size 2^( 7) =       0.000435255013

      target function =                  N/A
              le_mean =     -17.216582385816
             les_mean =     296.741284154440
             stat err =       0.000432850405
             autocorr =       1.133535921717
              std dev =       0.574956756761
             le_variance =       0.330575272145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330488428033
                                         uncertainty =       0.008074884289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330488428033
                                         uncertainty =       0.008074884289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406450049
  error estimate for blocks of size 2^( 2) =       0.000415452296
  error estimate for blocks of size 2^( 3) =       0.000423430621
  error estimate for blocks of size 2^( 4) =       0.000428990651
  error estimate for blocks of size 2^( 5) =       0.000432871801
  error estimate for blocks of size 2^( 6) =       0.000433989214
  error estimate for blocks of size 2^( 7) =       0.000435157243

      target function =                  N/A
              le_mean =     -17.216580706141
             les_mean =     296.741054330604
             stat err =       0.000432752227
             autocorr =       1.133611551184
              std dev =       0.574807171782
             le_variance =       0.330403284732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330494746528
                                         uncertainty =       0.008073124152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330494746528
                                         uncertainty =       0.008073124152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406453930
  error estimate for blocks of size 2^( 2) =       0.000415456563
  error estimate for blocks of size 2^( 3) =       0.000423435339
  error estimate for blocks of size 2^( 4) =       0.000428994893
  error estimate for blocks of size 2^( 5) =       0.000432876630
  error estimate for blocks of size 2^( 6) =       0.000433993858
  error estimate for blocks of size 2^( 7) =       0.000435161850

      target function =                  N/A
              le_mean =     -17.216580975564
             les_mean =     296.741069917076
             stat err =       0.000432756808
             autocorr =       1.133613901550
              std dev =       0.574812660017
             le_variance =       0.330409594116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330627947428
                                         uncertainty =       0.008079973852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330627947428
                                         uncertainty =       0.008079973852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406535839
  error estimate for blocks of size 2^( 2) =       0.000415535088
  error estimate for blocks of size 2^( 3) =       0.000423511533
  error estimate for blocks of size 2^( 4) =       0.000429068630
  error estimate for blocks of size 2^( 5) =       0.000432953633
  error estimate for blocks of size 2^( 6) =       0.000434069207
  error estimate for blocks of size 2^( 7) =       0.000435236783

      target function =                  N/A
              le_mean =     -17.216582128965
             les_mean =     296.741242815273
             stat err =       0.000432832063
             autocorr =       1.133551286165
              std dev =       0.574928497436
             le_variance =       0.330542777164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216582385816        initial  <--
     1.4901e-01     1.4901e+00             6.2730e-04       -17.216580706141
     5.9605e-01     5.9605e+00             2.0420e-04       -17.216580975564
     2.3842e+00     2.3842e+01             5.5993e-05       -17.216582128965

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3465
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.907446e-01 1 1  ON 0
 uu_1                 2.899389e-02 1 1  ON 1
 uu_2                -6.458483e-02 1 1  ON 2
 uu_3                -1.201171e-01 1 1  ON 3
 uu_4                -1.562022e-01 1 1  ON 4
 uu_5                -1.683269e-01 1 1  ON 5
 uu_6                -1.559863e-01 1 1  ON 6
 uu_7                -1.088677e-01 1 1  ON 7
 uu_8                -3.898412e-02 1 1  ON 8
 uu_9                 2.017097e-01 1 1  ON 9
 ud_0                 3.487439e-01 1 1  ON 10
 ud_1                 9.362994e-02 1 1  ON 11
 ud_2                -1.116438e-02 1 1  ON 12
 ud_3                -7.117369e-02 1 1  ON 13
 ud_4                -1.230144e-01 1 1  ON 14
 ud_5                -1.632907e-01 1 1  ON 15
 ud_6                -1.786955e-01 1 1  ON 16
 ud_7                -1.586565e-01 1 1  ON 17
 ud_8                -1.109769e-01 1 1  ON 18
 ud_9                 3.276640e-02 1 1  ON 19
 eO_0                -9.077842e-01 1 1  ON 20
 eO_1                -5.924346e-01 1 1  ON 21
 eO_2                -1.894116e-01 1 1  ON 22
 eO_3                 7.668625e-02 1 1  ON 23
 eO_4                 2.046092e-01 1 1  ON 24
 eO_5                 2.984142e-01 1 1  ON 25
 eO_6                 3.262333e-01 1 1  ON 26
 eO_7                 5.334262e-01 1 1  ON 27
 eO_8                 1.578301e-01 1 1  ON 28
 eO_9                 5.322541e-02 1 1  ON 29
eH1_0                -2.213048e-01 1 1  ON 30
eH1_1                -1.428263e-01 1 1  ON 31
eH1_2                -1.021067e-01 1 1  ON 32
eH1_3                -6.517141e-02 1 1  ON 33
eH1_4                -1.866756e-02 1 1  ON 34
eH1_5                -5.195769e-03 1 1  ON 35
eH1_6                 3.549387e-02 1 1  ON 36
eH1_7                 8.014455e-02 1 1  ON 37
eH1_8                 2.646879e-01 1 1  ON 38
eH1_9                 1.134503e-01 1 1  ON 39
eH2_0                -2.098668e-01 1 1  ON 40
eH2_1                -1.314558e-01 1 1  ON 41
eH2_2                -9.085718e-02 1 1  ON 42
eH2_3                -5.365087e-02 1 1  ON 43
eH2_4                -7.072332e-03 1 1  ON 44
eH2_5                 5.601283e-03 1 1  ON 45
eH2_6                 4.815379e-02 1 1  ON 46
eH2_7                 3.852522e-02 1 1  ON 47
eH2_8                 2.482243e-01 1 1  ON 48
eH2_9                 1.153300e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.112805
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4980e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349857869687
                                         uncertainty =       0.023309568789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349857869687
                                         uncertainty =       0.023309568789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418209488
  error estimate for blocks of size 2^( 2) =       0.000427112360
  error estimate for blocks of size 2^( 3) =       0.000435414391
  error estimate for blocks of size 2^( 4) =       0.000440936543
  error estimate for blocks of size 2^( 5) =       0.000445143543
  error estimate for blocks of size 2^( 6) =       0.000447021422
  error estimate for blocks of size 2^( 7) =       0.000449409946

      target function =                  N/A
              le_mean =     -17.216458923581
             les_mean =     296.756256044279
             stat err =       0.000445627863
             autocorr =       1.135420974019
              std dev =       0.591437529949
             le_variance =       0.349798351832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645892358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216458923581       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216458862508       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216458815767       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216458747030       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216458873129       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216458849630       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216458861444       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 9.341774e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216458923581       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216458906639       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216458891330       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216458872739       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216458909306       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216458901769       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216458903098       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.657558e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216458923581       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216458919226       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216458915094       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216458910340       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216458919876       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216458917897       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216458918045       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.892520e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6440e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.907394e-01 1 1  ON 0
 uu_1                 2.899672e-02 1 1  ON 1
 uu_2                -6.457764e-02 1 1  ON 2
 uu_3                -1.201053e-01 1 1  ON 3
 uu_4                -1.561997e-01 1 1  ON 4
 uu_5                -1.683365e-01 1 1  ON 5
 uu_6                -1.559927e-01 1 1  ON 6
 uu_7                -1.088720e-01 1 1  ON 7
 uu_8                -3.898276e-02 1 1  ON 8
 uu_9                 2.017057e-01 1 1  ON 9
 ud_0                 3.487512e-01 1 1  ON 10
 ud_1                 9.363729e-02 1 1  ON 11
 ud_2                -1.118368e-02 1 1  ON 12
 ud_3                -7.116974e-02 1 1  ON 13
 ud_4                -1.230273e-01 1 1  ON 14
 ud_5                -1.632892e-01 1 1  ON 15
 ud_6                -1.786859e-01 1 1  ON 16
 ud_7                -1.586545e-01 1 1  ON 17
 ud_8                -1.109758e-01 1 1  ON 18
 ud_9                 3.276262e-02 1 1  ON 19
 eO_0                -9.077734e-01 1 1  ON 20
 eO_1                -5.924611e-01 1 1  ON 21
 eO_2                -1.894084e-01 1 1  ON 22
 eO_3                 7.668480e-02 1 1  ON 23
 eO_4                 2.046168e-01 1 1  ON 24
 eO_5                 2.984223e-01 1 1  ON 25
 eO_6                 3.262315e-01 1 1  ON 26
 eO_7                 5.334224e-01 1 1  ON 27
 eO_8                 1.578329e-01 1 1  ON 28
 eO_9                 5.322597e-02 1 1  ON 29
eH1_0                -2.212947e-01 1 1  ON 30
eH1_1                -1.428433e-01 1 1  ON 31
eH1_2                -1.021061e-01 1 1  ON 32
eH1_3                -6.517152e-02 1 1  ON 33
eH1_4                -1.866058e-02 1 1  ON 34
eH1_5                -5.198094e-03 1 1  ON 35
eH1_6                 3.550029e-02 1 1  ON 36
eH1_7                 8.014152e-02 1 1  ON 37
eH1_8                 2.646847e-01 1 1  ON 38
eH1_9                 1.134513e-01 1 1  ON 39
eH2_0                -2.098835e-01 1 1  ON 40
eH2_1                -1.314740e-01 1 1  ON 41
eH2_2                -9.083916e-02 1 1  ON 42
eH2_3                -5.364668e-02 1 1  ON 43
eH2_4                -7.073230e-03 1 1  ON 44
eH2_5                 5.607331e-03 1 1  ON 45
eH2_6                 4.815330e-02 1 1  ON 46
eH2_7                 3.853372e-02 1 1  ON 47
eH2_8                 2.482223e-01 1 1  ON 48
eH2_9                 1.153306e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1953
    reference variance = 0.198829
====================================================
  Execution time = 2.2159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524105457
                                         uncertainty =       0.005949535349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524105457
                                         uncertainty =       0.005949535349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403982556
  error estimate for blocks of size 2^( 2) =       0.000413394107
  error estimate for blocks of size 2^( 3) =       0.000421920692
  error estimate for blocks of size 2^( 4) =       0.000426864097
  error estimate for blocks of size 2^( 5) =       0.000429786273
  error estimate for blocks of size 2^( 6) =       0.000431811170
  error estimate for blocks of size 2^( 7) =       0.000431899957

      target function =                  N/A
              le_mean =     -17.216164473654
             les_mean =     296.722722832190
             stat err =       0.000430090374
             autocorr =       1.133428737409
              std dev =       0.571317609978
             le_variance =       0.326403811471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326531041412
                                         uncertainty =       0.005950009481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326531041412
                                         uncertainty =       0.005950009481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403986844
  error estimate for blocks of size 2^( 2) =       0.000413397465
  error estimate for blocks of size 2^( 3) =       0.000421924181
  error estimate for blocks of size 2^( 4) =       0.000426866954
  error estimate for blocks of size 2^( 5) =       0.000429788311
  error estimate for blocks of size 2^( 6) =       0.000431813421
  error estimate for blocks of size 2^( 7) =       0.000431903231

      target function =                  N/A
              le_mean =     -17.216164710809
             les_mean =     296.722737926547
             stat err =       0.000430092979
             autocorr =       1.133418408963
              std dev =       0.571323673623
             le_variance =       0.326410740042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326529731774
                                         uncertainty =       0.005949756428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326529731774
                                         uncertainty =       0.005949756428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403986035
  error estimate for blocks of size 2^( 2) =       0.000413397011
  error estimate for blocks of size 2^( 3) =       0.000421923593
  error estimate for blocks of size 2^( 4) =       0.000426866606
  error estimate for blocks of size 2^( 5) =       0.000429788178
  error estimate for blocks of size 2^( 6) =       0.000431813116
  error estimate for blocks of size 2^( 7) =       0.000431902254

      target function =                  N/A
              le_mean =     -17.216164605290
             les_mean =     296.722732985700
             stat err =       0.000430092538
             autocorr =       1.133420625269
              std dev =       0.571322529295
             le_variance =       0.326409432480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524885968
                                         uncertainty =       0.005949562479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326524885968
                                         uncertainty =       0.005949562479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403983039
  error estimate for blocks of size 2^( 2) =       0.000413394513
  error estimate for blocks of size 2^( 3) =       0.000421921094
  error estimate for blocks of size 2^( 4) =       0.000426864447
  error estimate for blocks of size 2^( 5) =       0.000429786537
  error estimate for blocks of size 2^( 6) =       0.000431811437
  error estimate for blocks of size 2^( 7) =       0.000431900260

      target function =                  N/A
              le_mean =     -17.216164489000
             les_mean =     296.722724140357
             stat err =       0.000430090670
             autocorr =       1.133427589262
              std dev =       0.571318292418
             le_variance =       0.326404591252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216164473654        initial
     1.4901e+00     1.4901e+01             9.3418e-05       -17.216164710809  <--
     5.9605e+00     5.9605e+01             2.6576e-05       -17.216164605290
     2.3842e+01     2.3842e+02             6.8925e-06       -17.216164489000

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 3.1364e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.907237e-01 1 1  ON 0
 uu_1                 2.900656e-02 1 1  ON 1
 uu_2                -6.455752e-02 1 1  ON 2
 uu_3                -1.200744e-01 1 1  ON 3
 uu_4                -1.561900e-01 1 1  ON 4
 uu_5                -1.683634e-01 1 1  ON 5
 uu_6                -1.560111e-01 1 1  ON 6
 uu_7                -1.088843e-01 1 1  ON 7
 uu_8                -3.897890e-02 1 1  ON 8
 uu_9                 2.016945e-01 1 1  ON 9
 ud_0                 3.487688e-01 1 1  ON 10
 ud_1                 9.365038e-02 1 1  ON 11
 ud_2                -1.122545e-02 1 1  ON 12
 ud_3                -7.116728e-02 1 1  ON 13
 ud_4                -1.230566e-01 1 1  ON 14
 ud_5                -1.632868e-01 1 1  ON 15
 ud_6                -1.786585e-01 1 1  ON 16
 ud_7                -1.586483e-01 1 1  ON 17
 ud_8                -1.109726e-01 1 1  ON 18
 ud_9                 3.275205e-02 1 1  ON 19
 eO_0                -9.077489e-01 1 1  ON 20
 eO_1                -5.925280e-01 1 1  ON 21
 eO_2                -1.894041e-01 1 1  ON 22
 eO_3                 7.668347e-02 1 1  ON 23
 eO_4                 2.046385e-01 1 1  ON 24
 eO_5                 2.984448e-01 1 1  ON 25
 eO_6                 3.262267e-01 1 1  ON 26
 eO_7                 5.334120e-01 1 1  ON 27
 eO_8                 1.578408e-01 1 1  ON 28
 eO_9                 5.322756e-02 1 1  ON 29
eH1_0                -2.212680e-01 1 1  ON 30
eH1_1                -1.428897e-01 1 1  ON 31
eH1_2                -1.021053e-01 1 1  ON 32
eH1_3                -6.517083e-02 1 1  ON 33
eH1_4                -1.864191e-02 1 1  ON 34
eH1_5                -5.203704e-03 1 1  ON 35
eH1_6                 3.551841e-02 1 1  ON 36
eH1_7                 8.013305e-02 1 1  ON 37
eH1_8                 2.646758e-01 1 1  ON 38
eH1_9                 1.134540e-01 1 1  ON 39
eH2_0                -2.099308e-01 1 1  ON 40
eH2_1                -1.315192e-01 1 1  ON 41
eH2_2                -9.079512e-02 1 1  ON 42
eH2_3                -5.363317e-02 1 1  ON 43
eH2_4                -7.075084e-03 1 1  ON 44
eH2_5                 5.623347e-03 1 1  ON 45
eH2_6                 4.815162e-02 1 1  ON 46
eH2_7                 3.855759e-02 1 1  ON 47
eH2_8                 2.482168e-01 1 1  ON 48
eH2_9                 1.153322e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.340901
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319489628979
                                         uncertainty =       0.003495403070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319489628979
                                         uncertainty =       0.003495403070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400116533
  error estimate for blocks of size 2^( 2) =       0.000409415114
  error estimate for blocks of size 2^( 3) =       0.000417505575
  error estimate for blocks of size 2^( 4) =       0.000423184845
  error estimate for blocks of size 2^( 5) =       0.000427361061
  error estimate for blocks of size 2^( 6) =       0.000428778063
  error estimate for blocks of size 2^( 7) =       0.000432429760

      target function =                  N/A
              le_mean =     -17.216552154915
             les_mean =     296.729854422121
             stat err =       0.000427938432
             autocorr =       1.143904028067
              std dev =       0.565850226916
             le_variance =       0.320186479301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655215492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552154915       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553223139       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554721548       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554514116       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554088267       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554158067       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554084731       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216554158597       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 2.412346e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552154915       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552519069       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553154678       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553155782       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552996407       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216552976157       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552955538       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 8.027266e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552154915       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552255056       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552446286       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552455569       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552415283       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216552405023       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552401973       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.289318e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6118e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.907379e-01 1 1  ON 0
 uu_1                 2.894713e-02 1 1  ON 1
 uu_2                -6.457352e-02 1 1  ON 2
 uu_3                -1.201088e-01 1 1  ON 3
 uu_4                -1.561799e-01 1 1  ON 4
 uu_5                -1.683220e-01 1 1  ON 5
 uu_6                -1.559581e-01 1 1  ON 6
 uu_7                -1.089076e-01 1 1  ON 7
 uu_8                -3.898060e-02 1 1  ON 8
 uu_9                 2.016822e-01 1 1  ON 9
 ud_0                 3.487148e-01 1 1  ON 10
 ud_1                 9.359425e-02 1 1  ON 11
 ud_2                -1.118988e-02 1 1  ON 12
 ud_3                -7.112065e-02 1 1  ON 13
 ud_4                -1.230742e-01 1 1  ON 14
 ud_5                -1.633236e-01 1 1  ON 15
 ud_6                -1.786328e-01 1 1  ON 16
 ud_7                -1.585986e-01 1 1  ON 17
 ud_8                -1.109659e-01 1 1  ON 18
 ud_9                 3.273794e-02 1 1  ON 19
 eO_0                -9.077418e-01 1 1  ON 20
 eO_1                -5.924776e-01 1 1  ON 21
 eO_2                -1.894266e-01 1 1  ON 22
 eO_3                 7.661188e-02 1 1  ON 23
 eO_4                 2.046521e-01 1 1  ON 24
 eO_5                 2.984604e-01 1 1  ON 25
 eO_6                 3.262394e-01 1 1  ON 26
 eO_7                 5.333880e-01 1 1  ON 27
 eO_8                 1.578534e-01 1 1  ON 28
 eO_9                 5.323170e-02 1 1  ON 29
eH1_0                -2.213037e-01 1 1  ON 30
eH1_1                -1.429700e-01 1 1  ON 31
eH1_2                -1.020308e-01 1 1  ON 32
eH1_3                -6.517117e-02 1 1  ON 33
eH1_4                -1.860519e-02 1 1  ON 34
eH1_5                -5.196045e-03 1 1  ON 35
eH1_6                 3.553413e-02 1 1  ON 36
eH1_7                 8.010870e-02 1 1  ON 37
eH1_8                 2.646650e-01 1 1  ON 38
eH1_9                 1.134641e-01 1 1  ON 39
eH2_0                -2.099339e-01 1 1  ON 40
eH2_1                -1.315172e-01 1 1  ON 41
eH2_2                -9.077387e-02 1 1  ON 42
eH2_3                -5.362843e-02 1 1  ON 43
eH2_4                -7.094153e-03 1 1  ON 44
eH2_5                 5.599270e-03 1 1  ON 45
eH2_6                 4.816541e-02 1 1  ON 46
eH2_7                 3.857421e-02 1 1  ON 47
eH2_8                 2.482026e-01 1 1  ON 48
eH2_9                 1.153323e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.163223
====================================================
  Execution time = 2.0279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3350e-01
  Total weights = 2.0000e+06
  Execution time = 1.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333612865942
                                         uncertainty =       0.008581586873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333612865942
                                         uncertainty =       0.008581586873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408384873
  error estimate for blocks of size 2^( 2) =       0.000417718226
  error estimate for blocks of size 2^( 3) =       0.000426109407
  error estimate for blocks of size 2^( 4) =       0.000431437531
  error estimate for blocks of size 2^( 5) =       0.000434467733
  error estimate for blocks of size 2^( 6) =       0.000435516435
  error estimate for blocks of size 2^( 7) =       0.000438307743

      target function =                  N/A
              le_mean =     -17.216164349588
             les_mean =     296.729871153976
             stat err =       0.000434932361
             autocorr =       1.134237887906
              std dev =       0.577543425844
             le_variance =       0.333556408736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333446830743
                                         uncertainty =       0.008582378657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333446830743
                                         uncertainty =       0.008582378657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408283224
  error estimate for blocks of size 2^( 2) =       0.000417621426
  error estimate for blocks of size 2^( 3) =       0.000426019720
  error estimate for blocks of size 2^( 4) =       0.000431353120
  error estimate for blocks of size 2^( 5) =       0.000434385057
  error estimate for blocks of size 2^( 6) =       0.000435435556
  error estimate for blocks of size 2^( 7) =       0.000438225383

      target function =                  N/A
              le_mean =     -17.216163321237
             les_mean =     296.729669719083
             stat err =       0.000434849779
             autocorr =       1.134371837142
              std dev =       0.577399672892
             le_variance =       0.333390382256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333500847594
                                         uncertainty =       0.008582762083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333500847594
                                         uncertainty =       0.008582762083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408316290
  error estimate for blocks of size 2^( 2) =       0.000417653030
  error estimate for blocks of size 2^( 3) =       0.000426049302
  error estimate for blocks of size 2^( 4) =       0.000431381277
  error estimate for blocks of size 2^( 5) =       0.000434412583
  error estimate for blocks of size 2^( 6) =       0.000435462716
  error estimate for blocks of size 2^( 7) =       0.000438253001

      target function =                  N/A
              le_mean =     -17.216163349599
             les_mean =     296.729724698381
             stat err =       0.000434877394
             autocorr =       1.134332179519
              std dev =       0.577446434782
             le_variance =       0.333444385042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333597778335
                                         uncertainty =       0.008581839401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333597778335
                                         uncertainty =       0.008581839401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408375635
  error estimate for blocks of size 2^( 2) =       0.000417709460
  error estimate for blocks of size 2^( 3) =       0.000426101361
  error estimate for blocks of size 2^( 4) =       0.000431430011
  error estimate for blocks of size 2^( 5) =       0.000434460360
  error estimate for blocks of size 2^( 6) =       0.000435509266
  error estimate for blocks of size 2^( 7) =       0.000438300423

      target function =                  N/A
              le_mean =     -17.216164160292
             les_mean =     296.729849546590
             stat err =       0.000434925015
             autocorr =       1.134250887634
              std dev =       0.577530362170
             le_variance =       0.333541319228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216164349588        initial  <--
     3.7253e-01     3.7253e+00             2.4123e-04       -17.216163321237
     1.4901e+00     1.4901e+01             8.0273e-05       -17.216163349599
     5.9605e+00     5.9605e+01             2.2893e-05       -17.216164160292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5099
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.907237e-01 1 1  ON 0
 uu_1                 2.900656e-02 1 1  ON 1
 uu_2                -6.455752e-02 1 1  ON 2
 uu_3                -1.200744e-01 1 1  ON 3
 uu_4                -1.561900e-01 1 1  ON 4
 uu_5                -1.683634e-01 1 1  ON 5
 uu_6                -1.560111e-01 1 1  ON 6
 uu_7                -1.088843e-01 1 1  ON 7
 uu_8                -3.897890e-02 1 1  ON 8
 uu_9                 2.016945e-01 1 1  ON 9
 ud_0                 3.487688e-01 1 1  ON 10
 ud_1                 9.365038e-02 1 1  ON 11
 ud_2                -1.122545e-02 1 1  ON 12
 ud_3                -7.116728e-02 1 1  ON 13
 ud_4                -1.230566e-01 1 1  ON 14
 ud_5                -1.632868e-01 1 1  ON 15
 ud_6                -1.786585e-01 1 1  ON 16
 ud_7                -1.586483e-01 1 1  ON 17
 ud_8                -1.109726e-01 1 1  ON 18
 ud_9                 3.275205e-02 1 1  ON 19
 eO_0                -9.077489e-01 1 1  ON 20
 eO_1                -5.925280e-01 1 1  ON 21
 eO_2                -1.894041e-01 1 1  ON 22
 eO_3                 7.668347e-02 1 1  ON 23
 eO_4                 2.046385e-01 1 1  ON 24
 eO_5                 2.984448e-01 1 1  ON 25
 eO_6                 3.262267e-01 1 1  ON 26
 eO_7                 5.334120e-01 1 1  ON 27
 eO_8                 1.578408e-01 1 1  ON 28
 eO_9                 5.322756e-02 1 1  ON 29
eH1_0                -2.212680e-01 1 1  ON 30
eH1_1                -1.428897e-01 1 1  ON 31
eH1_2                -1.021053e-01 1 1  ON 32
eH1_3                -6.517083e-02 1 1  ON 33
eH1_4                -1.864191e-02 1 1  ON 34
eH1_5                -5.203704e-03 1 1  ON 35
eH1_6                 3.551841e-02 1 1  ON 36
eH1_7                 8.013305e-02 1 1  ON 37
eH1_8                 2.646758e-01 1 1  ON 38
eH1_9                 1.134540e-01 1 1  ON 39
eH2_0                -2.099308e-01 1 1  ON 40
eH2_1                -1.315192e-01 1 1  ON 41
eH2_2                -9.079512e-02 1 1  ON 42
eH2_3                -5.363317e-02 1 1  ON 43
eH2_4                -7.075084e-03 1 1  ON 44
eH2_5                 5.623347e-03 1 1  ON 45
eH2_6                 4.815162e-02 1 1  ON 46
eH2_7                 3.855759e-02 1 1  ON 47
eH2_8                 2.482168e-01 1 1  ON 48
eH2_9                 1.153322e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1964
    reference variance = 0.232269
====================================================
  Execution time = 2.0961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1952e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319579662088
                                         uncertainty =       0.003216549216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319579662088
                                         uncertainty =       0.003216549216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399697146
  error estimate for blocks of size 2^( 2) =       0.000408964093
  error estimate for blocks of size 2^( 3) =       0.000417614682
  error estimate for blocks of size 2^( 4) =       0.000424217433
  error estimate for blocks of size 2^( 5) =       0.000428284525
  error estimate for blocks of size 2^( 6) =       0.000430776978
  error estimate for blocks of size 2^( 7) =       0.000431936700

      target function =                  N/A
              le_mean =     -17.216709136969
             les_mean =     296.734588964417
             stat err =       0.000428803909
             autocorr =       1.150947136844
              std dev =       0.565257124828
             le_variance =       0.319515617169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670913697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709136969       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709087533       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709026989       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216709008394       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709033640       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216709025135       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216709009644       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.909449e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709136969       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709123793       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709107552       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216709101368       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709106907       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216709105015       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216709100436       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.028908e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709136969       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709133620       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709129484       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216709127830       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709129145       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216709128683       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216709127492       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 2.607348e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6548e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.907209e-01 1 1  ON 0
 uu_1                 2.900589e-02 1 1  ON 1
 uu_2                -6.455834e-02 1 1  ON 2
 uu_3                -1.200747e-01 1 1  ON 3
 uu_4                -1.561838e-01 1 1  ON 4
 uu_5                -1.683683e-01 1 1  ON 5
 uu_6                -1.560094e-01 1 1  ON 6
 uu_7                -1.088832e-01 1 1  ON 7
 uu_8                -3.897831e-02 1 1  ON 8
 uu_9                 2.016929e-01 1 1  ON 9
 ud_0                 3.487669e-01 1 1  ON 10
 ud_1                 9.364646e-02 1 1  ON 11
 ud_2                -1.121952e-02 1 1  ON 12
 ud_3                -7.116902e-02 1 1  ON 13
 ud_4                -1.230499e-01 1 1  ON 14
 ud_5                -1.632970e-01 1 1  ON 15
 ud_6                -1.786499e-01 1 1  ON 16
 ud_7                -1.586474e-01 1 1  ON 17
 ud_8                -1.109759e-01 1 1  ON 18
 ud_9                 3.274997e-02 1 1  ON 19
 eO_0                -9.077512e-01 1 1  ON 20
 eO_1                -5.925197e-01 1 1  ON 21
 eO_2                -1.894076e-01 1 1  ON 22
 eO_3                 7.668002e-02 1 1  ON 23
 eO_4                 2.046398e-01 1 1  ON 24
 eO_5                 2.984433e-01 1 1  ON 25
 eO_6                 3.262284e-01 1 1  ON 26
 eO_7                 5.334100e-01 1 1  ON 27
 eO_8                 1.578418e-01 1 1  ON 28
 eO_9                 5.322795e-02 1 1  ON 29
eH1_0                -2.212722e-01 1 1  ON 30
eH1_1                -1.428941e-01 1 1  ON 31
eH1_2                -1.021008e-01 1 1  ON 32
eH1_3                -6.517225e-02 1 1  ON 33
eH1_4                -1.863927e-02 1 1  ON 34
eH1_5                -5.197808e-03 1 1  ON 35
eH1_6                 3.552130e-02 1 1  ON 36
eH1_7                 8.012857e-02 1 1  ON 37
eH1_8                 2.646739e-01 1 1  ON 38
eH1_9                 1.134542e-01 1 1  ON 39
eH2_0                -2.099312e-01 1 1  ON 40
eH2_1                -1.315245e-01 1 1  ON 41
eH2_2                -9.078524e-02 1 1  ON 42
eH2_3                -5.363973e-02 1 1  ON 43
eH2_4                -7.073505e-03 1 1  ON 44
eH2_5                 5.620441e-03 1 1  ON 45
eH2_6                 4.815085e-02 1 1  ON 46
eH2_7                 3.856275e-02 1 1  ON 47
eH2_8                 2.482156e-01 1 1  ON 48
eH2_9                 1.153325e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.951
    reference variance = 8.03588
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2875e-01
  Total weights = 2.0000e+06
  Execution time = 1.8248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221675354
                                         uncertainty =       0.005104620897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328221675354
                                         uncertainty =       0.005104620897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405436461
  error estimate for blocks of size 2^( 2) =       0.000414275425
  error estimate for blocks of size 2^( 3) =       0.000423113582
  error estimate for blocks of size 2^( 4) =       0.000428400699
  error estimate for blocks of size 2^( 5) =       0.000432772122
  error estimate for blocks of size 2^( 6) =       0.000435687208
  error estimate for blocks of size 2^( 7) =       0.000435800332

      target function =                  N/A
              le_mean =     -17.216901843718
             les_mean =     296.750466379139
             stat err =       0.000433165090
             autocorr =       1.141461566926
              std dev =       0.573373741371
             le_variance =       0.328757447294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328200663010
                                         uncertainty =       0.005104552871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328200663010
                                         uncertainty =       0.005104552871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405423497
  error estimate for blocks of size 2^( 2) =       0.000414263039
  error estimate for blocks of size 2^( 3) =       0.000423102049
  error estimate for blocks of size 2^( 4) =       0.000428390392
  error estimate for blocks of size 2^( 5) =       0.000432761673
  error estimate for blocks of size 2^( 6) =       0.000435677428
  error estimate for blocks of size 2^( 7) =       0.000435790277

      target function =                  N/A
              le_mean =     -17.216901887732
             les_mean =     296.750446870969
             stat err =       0.000433154942
             autocorr =       1.141481081256
              std dev =       0.573355407708
             le_variance =       0.328736423548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328210570628
                                         uncertainty =       0.005104588110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328210570628
                                         uncertainty =       0.005104588110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405429609
  error estimate for blocks of size 2^( 2) =       0.000414268890
  error estimate for blocks of size 2^( 3) =       0.000423107510
  error estimate for blocks of size 2^( 4) =       0.000428395285
  error estimate for blocks of size 2^( 5) =       0.000432766629
  error estimate for blocks of size 2^( 6) =       0.000435682061
  error estimate for blocks of size 2^( 7) =       0.000435795040

      target function =                  N/A
              le_mean =     -17.216901857978
             les_mean =     296.750455759149
             stat err =       0.000433159754
             autocorr =       1.141472019932
              std dev =       0.573364052117
             le_variance =       0.328746336260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328220265286
                                         uncertainty =       0.005104616860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328220265286
                                         uncertainty =       0.005104616860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405435591
  error estimate for blocks of size 2^( 2) =       0.000414274595
  error estimate for blocks of size 2^( 3) =       0.000423112811
  error estimate for blocks of size 2^( 4) =       0.000428400012
  error estimate for blocks of size 2^( 5) =       0.000432771425
  error estimate for blocks of size 2^( 6) =       0.000435686555
  error estimate for blocks of size 2^( 7) =       0.000435799661

      target function =                  N/A
              le_mean =     -17.216901845013
             les_mean =     296.750465012845
             stat err =       0.000433164413
             autocorr =       1.141462897636
              std dev =       0.573372511039
             le_variance =       0.328756036415


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216901843718        initial
     3.7253e+00     3.7253e+01             3.9094e-05       -17.216901887732  <--
     1.4901e+01     1.4901e+02             1.0289e-05       -17.216901857978
     5.9605e+01     5.9605e+02             2.6073e-06       -17.216901845013

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.9320e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.907130e-01 1 1  ON 0
 uu_1                 2.900376e-02 1 1  ON 1
 uu_2                -6.456103e-02 1 1  ON 2
 uu_3                -1.200752e-01 1 1  ON 3
 uu_4                -1.561667e-01 1 1  ON 4
 uu_5                -1.683821e-01 1 1  ON 5
 uu_6                -1.560045e-01 1 1  ON 6
 uu_7                -1.088800e-01 1 1  ON 7
 uu_8                -3.897660e-02 1 1  ON 8
 uu_9                 2.016884e-01 1 1  ON 9
 ud_0                 3.487614e-01 1 1  ON 10
 ud_1                 9.363674e-02 1 1  ON 11
 ud_2                -1.120434e-02 1 1  ON 12
 ud_3                -7.117260e-02 1 1  ON 13
 ud_4                -1.230320e-01 1 1  ON 14
 ud_5                -1.633258e-01 1 1  ON 15
 ud_6                -1.786249e-01 1 1  ON 16
 ud_7                -1.586447e-01 1 1  ON 17
 ud_8                -1.109856e-01 1 1  ON 18
 ud_9                 3.274389e-02 1 1  ON 19
 eO_0                -9.077577e-01 1 1  ON 20
 eO_1                -5.924963e-01 1 1  ON 21
 eO_2                -1.894169e-01 1 1  ON 22
 eO_3                 7.666950e-02 1 1  ON 23
 eO_4                 2.046439e-01 1 1  ON 24
 eO_5                 2.984389e-01 1 1  ON 25
 eO_6                 3.262333e-01 1 1  ON 26
 eO_7                 5.334040e-01 1 1  ON 27
 eO_8                 1.578447e-01 1 1  ON 28
 eO_9                 5.322908e-02 1 1  ON 29
eH1_0                -2.212848e-01 1 1  ON 30
eH1_1                -1.429069e-01 1 1  ON 31
eH1_2                -1.020881e-01 1 1  ON 32
eH1_3                -6.517629e-02 1 1  ON 33
eH1_4                -1.863152e-02 1 1  ON 34
eH1_5                -5.180428e-03 1 1  ON 35
eH1_6                 3.552982e-02 1 1  ON 36
eH1_7                 8.011542e-02 1 1  ON 37
eH1_8                 2.646682e-01 1 1  ON 38
eH1_9                 1.134551e-01 1 1  ON 39
eH2_0                -2.099325e-01 1 1  ON 40
eH2_1                -1.315394e-01 1 1  ON 41
eH2_2                -9.075762e-02 1 1  ON 42
eH2_3                -5.365799e-02 1 1  ON 43
eH2_4                -7.069249e-03 1 1  ON 44
eH2_5                 5.611844e-03 1 1  ON 45
eH2_6                 4.814858e-02 1 1  ON 46
eH2_7                 3.857785e-02 1 1  ON 47
eH2_8                 2.482121e-01 1 1  ON 48
eH2_9                 1.153334e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.251108
====================================================
  Execution time = 2.0939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492182593
                                         uncertainty =       0.002787327870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318492182593
                                         uncertainty =       0.002787327870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399002738
  error estimate for blocks of size 2^( 2) =       0.000408486983
  error estimate for blocks of size 2^( 3) =       0.000416790630
  error estimate for blocks of size 2^( 4) =       0.000423262461
  error estimate for blocks of size 2^( 5) =       0.000426223929
  error estimate for blocks of size 2^( 6) =       0.000427058265
  error estimate for blocks of size 2^( 7) =       0.000426901785

      target function =                  N/A
              le_mean =     -17.216700311512
             les_mean =     296.733175826666
             stat err =       0.000425861610
             autocorr =       1.139161325668
              std dev =       0.564275083136
             le_variance =       0.318406369449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670031151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700311512       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216699956667       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700015595       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700029759       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216699856378       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216699928165       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700038411       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 1.230964e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700311512       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700204013       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700214992       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700225954       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700179641       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700192121       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700224222       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.644079e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216700311512       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700283135       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700285422       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216700288785       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216700277292       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700279887       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700288194       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 9.564444e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6493e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.906985e-01 1 1  ON 0
 uu_1                 2.899992e-02 1 1  ON 1
 uu_2                -6.455486e-02 1 1  ON 2
 uu_3                -1.200881e-01 1 1  ON 3
 uu_4                -1.561920e-01 1 1  ON 4
 uu_5                -1.683643e-01 1 1  ON 5
 uu_6                -1.559745e-01 1 1  ON 6
 uu_7                -1.088859e-01 1 1  ON 7
 uu_8                -3.897578e-02 1 1  ON 8
 uu_9                 2.016831e-01 1 1  ON 9
 ud_0                 3.487427e-01 1 1  ON 10
 ud_1                 9.362583e-02 1 1  ON 11
 ud_2                -1.119961e-02 1 1  ON 12
 ud_3                -7.116799e-02 1 1  ON 13
 ud_4                -1.230268e-01 1 1  ON 14
 ud_5                -1.633219e-01 1 1  ON 15
 ud_6                -1.786361e-01 1 1  ON 16
 ud_7                -1.586348e-01 1 1  ON 17
 ud_8                -1.109803e-01 1 1  ON 18
 ud_9                 3.274107e-02 1 1  ON 19
 eO_0                -9.077601e-01 1 1  ON 20
 eO_1                -5.924911e-01 1 1  ON 21
 eO_2                -1.894288e-01 1 1  ON 22
 eO_3                 7.667246e-02 1 1  ON 23
 eO_4                 2.046417e-01 1 1  ON 24
 eO_5                 2.984405e-01 1 1  ON 25
 eO_6                 3.262377e-01 1 1  ON 26
 eO_7                 5.333975e-01 1 1  ON 27
 eO_8                 1.578494e-01 1 1  ON 28
 eO_9                 5.323142e-02 1 1  ON 29
eH1_0                -2.212928e-01 1 1  ON 30
eH1_1                -1.429064e-01 1 1  ON 31
eH1_2                -1.020991e-01 1 1  ON 32
eH1_3                -6.513985e-02 1 1  ON 33
eH1_4                -1.864432e-02 1 1  ON 34
eH1_5                -5.179321e-03 1 1  ON 35
eH1_6                 3.553791e-02 1 1  ON 36
eH1_7                 8.010101e-02 1 1  ON 37
eH1_8                 2.646629e-01 1 1  ON 38
eH1_9                 1.134566e-01 1 1  ON 39
eH2_0                -2.099546e-01 1 1  ON 40
eH2_1                -1.315686e-01 1 1  ON 41
eH2_2                -9.074475e-02 1 1  ON 42
eH2_3                -5.364644e-02 1 1  ON 43
eH2_4                -7.050886e-03 1 1  ON 44
eH2_5                 5.606763e-03 1 1  ON 45
eH2_6                 4.814331e-02 1 1  ON 46
eH2_7                 3.859414e-02 1 1  ON 47
eH2_8                 2.482101e-01 1 1  ON 48
eH2_9                 1.153360e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.306
    reference variance = 0.579067
====================================================
  Execution time = 2.0213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2332e-01
  Total weights = 2.0000e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323336532661
                                         uncertainty =       0.004976791419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323336532661
                                         uncertainty =       0.004976791419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402081870
  error estimate for blocks of size 2^( 2) =       0.000411379157
  error estimate for blocks of size 2^( 3) =       0.000419387010
  error estimate for blocks of size 2^( 4) =       0.000425301586
  error estimate for blocks of size 2^( 5) =       0.000428718293
  error estimate for blocks of size 2^( 6) =       0.000430046466
  error estimate for blocks of size 2^( 7) =       0.000431098583

      target function =                  N/A
              le_mean =     -17.216467001834
             les_mean =     296.730075524336
             stat err =       0.000428791232
             autocorr =       1.137267974380
              std dev =       0.568629634080
             le_variance =       0.323339660754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323271542488
                                         uncertainty =       0.004976205394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323271542488
                                         uncertainty =       0.004976205394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402041473
  error estimate for blocks of size 2^( 2) =       0.000411339928
  error estimate for blocks of size 2^( 3) =       0.000419348908
  error estimate for blocks of size 2^( 4) =       0.000425264603
  error estimate for blocks of size 2^( 5) =       0.000428683016
  error estimate for blocks of size 2^( 6) =       0.000430009124
  error estimate for blocks of size 2^( 7) =       0.000431058407

      target function =                  N/A
              le_mean =     -17.216466488886
             les_mean =     296.729992894054
             stat err =       0.000428753788
             autocorr =       1.137297874352
              std dev =       0.568572504407
             le_variance =       0.323274692767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323298909837
                                         uncertainty =       0.004976488326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323298909837
                                         uncertainty =       0.004976488326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402058484
  error estimate for blocks of size 2^( 2) =       0.000411356421
  error estimate for blocks of size 2^( 3) =       0.000419364889
  error estimate for blocks of size 2^( 4) =       0.000425280105
  error estimate for blocks of size 2^( 5) =       0.000428697790
  error estimate for blocks of size 2^( 6) =       0.000430024698
  error estimate for blocks of size 2^( 7) =       0.000431075149

      target function =                  N/A
              le_mean =     -17.216466675893
             les_mean =     296.730026690294
             stat err =       0.000428769436
             autocorr =       1.137284648293
              std dev =       0.568596561552
             le_variance =       0.323302049809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323331589458
                                         uncertainty =       0.004976753523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323331589458
                                         uncertainty =       0.004976753523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402078798
  error estimate for blocks of size 2^( 2) =       0.000411376168
  error estimate for blocks of size 2^( 3) =       0.000419384100
  error estimate for blocks of size 2^( 4) =       0.000425298759
  error estimate for blocks of size 2^( 5) =       0.000428715594
  error estimate for blocks of size 2^( 6) =       0.000430043599
  error estimate for blocks of size 2^( 7) =       0.000431095498

      target function =                  N/A
              le_mean =     -17.216466955792
             les_mean =     296.730068997298
             stat err =       0.000428788362
             autocorr =       1.137270134782
              std dev =       0.568625288811
             le_variance =       0.323334719076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216467001834        initial  <--
     9.3132e-01     9.3132e+00             1.2310e-04       -17.216466488886
     3.7253e+00     3.7253e+01             3.6441e-05       -17.216466675893
     1.4901e+01     1.4901e+02             9.5644e-06       -17.216466955792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5619
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.907130e-01 1 1  ON 0
 uu_1                 2.900376e-02 1 1  ON 1
 uu_2                -6.456103e-02 1 1  ON 2
 uu_3                -1.200752e-01 1 1  ON 3
 uu_4                -1.561667e-01 1 1  ON 4
 uu_5                -1.683821e-01 1 1  ON 5
 uu_6                -1.560045e-01 1 1  ON 6
 uu_7                -1.088800e-01 1 1  ON 7
 uu_8                -3.897660e-02 1 1  ON 8
 uu_9                 2.016884e-01 1 1  ON 9
 ud_0                 3.487614e-01 1 1  ON 10
 ud_1                 9.363674e-02 1 1  ON 11
 ud_2                -1.120434e-02 1 1  ON 12
 ud_3                -7.117260e-02 1 1  ON 13
 ud_4                -1.230320e-01 1 1  ON 14
 ud_5                -1.633258e-01 1 1  ON 15
 ud_6                -1.786249e-01 1 1  ON 16
 ud_7                -1.586447e-01 1 1  ON 17
 ud_8                -1.109856e-01 1 1  ON 18
 ud_9                 3.274389e-02 1 1  ON 19
 eO_0                -9.077577e-01 1 1  ON 20
 eO_1                -5.924963e-01 1 1  ON 21
 eO_2                -1.894169e-01 1 1  ON 22
 eO_3                 7.666950e-02 1 1  ON 23
 eO_4                 2.046439e-01 1 1  ON 24
 eO_5                 2.984389e-01 1 1  ON 25
 eO_6                 3.262333e-01 1 1  ON 26
 eO_7                 5.334040e-01 1 1  ON 27
 eO_8                 1.578447e-01 1 1  ON 28
 eO_9                 5.322908e-02 1 1  ON 29
eH1_0                -2.212848e-01 1 1  ON 30
eH1_1                -1.429069e-01 1 1  ON 31
eH1_2                -1.020881e-01 1 1  ON 32
eH1_3                -6.517629e-02 1 1  ON 33
eH1_4                -1.863152e-02 1 1  ON 34
eH1_5                -5.180428e-03 1 1  ON 35
eH1_6                 3.552982e-02 1 1  ON 36
eH1_7                 8.011542e-02 1 1  ON 37
eH1_8                 2.646682e-01 1 1  ON 38
eH1_9                 1.134551e-01 1 1  ON 39
eH2_0                -2.099325e-01 1 1  ON 40
eH2_1                -1.315394e-01 1 1  ON 41
eH2_2                -9.075762e-02 1 1  ON 42
eH2_3                -5.365799e-02 1 1  ON 43
eH2_4                -7.069249e-03 1 1  ON 44
eH2_5                 5.611844e-03 1 1  ON 45
eH2_6                 4.814858e-02 1 1  ON 46
eH2_7                 3.857785e-02 1 1  ON 47
eH2_8                 2.482121e-01 1 1  ON 48
eH2_9                 1.153334e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2147
    reference variance = 0.18801
====================================================
  Execution time = 2.0450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2578e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325844247181
                                         uncertainty =       0.003285196995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325844247181
                                         uncertainty =       0.003285196995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403595943
  error estimate for blocks of size 2^( 2) =       0.000412791096
  error estimate for blocks of size 2^( 3) =       0.000420914359
  error estimate for blocks of size 2^( 4) =       0.000427261328
  error estimate for blocks of size 2^( 5) =       0.000431265261
  error estimate for blocks of size 2^( 6) =       0.000432689220
  error estimate for blocks of size 2^( 7) =       0.000432413502

      target function =                  N/A
              le_mean =     -17.216503292363
             les_mean =     296.733764823916
             stat err =       0.000430907328
             autocorr =       1.139919478343
              std dev =       0.570770856715
             le_variance =       0.325779370876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650329236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503292363       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503288220       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503294970       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503317361       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216503314026       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216503315084       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216503315424       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.407523e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503292363       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503291295       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503292899       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503298809       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216503298153       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216503298387       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216503298375       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.611421e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216503292363       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216503292094       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216503292489       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216503293987       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216503293835       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216503293892       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216503293882       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 9.088884e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5989e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.907120e-01 1 1  ON 0
 uu_1                 2.900308e-02 1 1  ON 1
 uu_2                -6.455923e-02 1 1  ON 2
 uu_3                -1.200743e-01 1 1  ON 3
 uu_4                -1.561690e-01 1 1  ON 4
 uu_5                -1.683800e-01 1 1  ON 5
 uu_6                -1.560044e-01 1 1  ON 6
 uu_7                -1.088813e-01 1 1  ON 7
 uu_8                -3.897639e-02 1 1  ON 8
 uu_9                 2.016879e-01 1 1  ON 9
 ud_0                 3.487616e-01 1 1  ON 10
 ud_1                 9.363494e-02 1 1  ON 11
 ud_2                -1.120306e-02 1 1  ON 12
 ud_3                -7.117318e-02 1 1  ON 13
 ud_4                -1.230301e-01 1 1  ON 14
 ud_5                -1.633252e-01 1 1  ON 15
 ud_6                -1.786244e-01 1 1  ON 16
 ud_7                -1.586455e-01 1 1  ON 17
 ud_8                -1.109866e-01 1 1  ON 18
 ud_9                 3.274305e-02 1 1  ON 19
 eO_0                -9.077597e-01 1 1  ON 20
 eO_1                -5.924927e-01 1 1  ON 21
 eO_2                -1.894182e-01 1 1  ON 22
 eO_3                 7.666962e-02 1 1  ON 23
 eO_4                 2.046444e-01 1 1  ON 24
 eO_5                 2.984389e-01 1 1  ON 25
 eO_6                 3.262329e-01 1 1  ON 26
 eO_7                 5.334029e-01 1 1  ON 27
 eO_8                 1.578450e-01 1 1  ON 28
 eO_9                 5.322924e-02 1 1  ON 29
eH1_0                -2.212837e-01 1 1  ON 30
eH1_1                -1.429057e-01 1 1  ON 31
eH1_2                -1.020877e-01 1 1  ON 32
eH1_3                -6.517815e-02 1 1  ON 33
eH1_4                -1.863120e-02 1 1  ON 34
eH1_5                -5.180389e-03 1 1  ON 35
eH1_6                 3.553008e-02 1 1  ON 36
eH1_7                 8.011446e-02 1 1  ON 37
eH1_8                 2.646676e-01 1 1  ON 38
eH1_9                 1.134552e-01 1 1  ON 39
eH2_0                -2.099333e-01 1 1  ON 40
eH2_1                -1.315391e-01 1 1  ON 41
eH2_2                -9.075745e-02 1 1  ON 42
eH2_3                -5.365908e-02 1 1  ON 43
eH2_4                -7.067300e-03 1 1  ON 44
eH2_5                 5.610183e-03 1 1  ON 45
eH2_6                 4.814817e-02 1 1  ON 46
eH2_7                 3.857935e-02 1 1  ON 47
eH2_8                 2.482118e-01 1 1  ON 48
eH2_9                 1.153335e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.263444
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2833e-01
  Total weights = 2.0000e+06
  Execution time = 1.8255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579959695
                                         uncertainty =       0.004022451250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579959695
                                         uncertainty =       0.004022451250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405172576
  error estimate for blocks of size 2^( 2) =       0.000414439999
  error estimate for blocks of size 2^( 3) =       0.000422502833
  error estimate for blocks of size 2^( 4) =       0.000427905695
  error estimate for blocks of size 2^( 5) =       0.000431525387
  error estimate for blocks of size 2^( 6) =       0.000433353398
  error estimate for blocks of size 2^( 7) =       0.000434018932

      target function =                  N/A
              le_mean =     -17.216633805684
             les_mean =     296.740809066755
             stat err =       0.000431700853
             autocorr =       1.135234887949
              std dev =       0.573000551403
             le_variance =       0.328329631909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327577961192
                                         uncertainty =       0.004022400229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327577961192
                                         uncertainty =       0.004022400229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405171341
  error estimate for blocks of size 2^( 2) =       0.000414438826
  error estimate for blocks of size 2^( 3) =       0.000422501828
  error estimate for blocks of size 2^( 4) =       0.000427904826
  error estimate for blocks of size 2^( 5) =       0.000431524609
  error estimate for blocks of size 2^( 6) =       0.000433352516
  error estimate for blocks of size 2^( 7) =       0.000434018272

      target function =                  N/A
              le_mean =     -17.216633865190
             les_mean =     296.740809115689
             stat err =       0.000431700056
             autocorr =       1.135237610649
              std dev =       0.572998806144
             le_variance =       0.328327631843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327578916579
                                         uncertainty =       0.004022423795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327578916579
                                         uncertainty =       0.004022423795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405171932
  error estimate for blocks of size 2^( 2) =       0.000414439387
  error estimate for blocks of size 2^( 3) =       0.000422502309
  error estimate for blocks of size 2^( 4) =       0.000427905241
  error estimate for blocks of size 2^( 5) =       0.000431524980
  error estimate for blocks of size 2^( 6) =       0.000433352935
  error estimate for blocks of size 2^( 7) =       0.000434018582

      target function =                  N/A
              le_mean =     -17.216633835609
             les_mean =     296.740809053507
             stat err =       0.000431700434
             autocorr =       1.135236295660
              std dev =       0.572999640692
             le_variance =       0.328328588233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579827588
                                         uncertainty =       0.004022447751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327579827588
                                         uncertainty =       0.004022447751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405172494
  error estimate for blocks of size 2^( 2) =       0.000414439921
  error estimate for blocks of size 2^( 3) =       0.000422502766
  error estimate for blocks of size 2^( 4) =       0.000427905638
  error estimate for blocks of size 2^( 5) =       0.000431525336
  error estimate for blocks of size 2^( 6) =       0.000433353339
  error estimate for blocks of size 2^( 7) =       0.000434018887

      target function =                  N/A
              le_mean =     -17.216633809405
             les_mean =     296.740809062710
             stat err =       0.000431700800
             autocorr =       1.135235065458
              std dev =       0.573000436072
             le_variance =       0.328329499739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216633805684        initial
     9.3132e+00     9.3132e+01             1.4075e-05       -17.216633865190  <--
     3.7253e+01     3.7253e+02             3.6114e-06       -17.216633835609
     1.4901e+02     1.4901e+03             9.0889e-07       -17.216633809405

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.9328e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.907091e-01 1 1  ON 0
 uu_1                 2.900126e-02 1 1  ON 1
 uu_2                -6.455416e-02 1 1  ON 2
 uu_3                -1.200717e-01 1 1  ON 3
 uu_4                -1.561760e-01 1 1  ON 4
 uu_5                -1.683739e-01 1 1  ON 5
 uu_6                -1.560042e-01 1 1  ON 6
 uu_7                -1.088850e-01 1 1  ON 7
 uu_8                -3.897577e-02 1 1  ON 8
 uu_9                 2.016865e-01 1 1  ON 9
 ud_0                 3.487622e-01 1 1  ON 10
 ud_1                 9.362991e-02 1 1  ON 11
 ud_2                -1.119951e-02 1 1  ON 12
 ud_3                -7.117467e-02 1 1  ON 13
 ud_4                -1.230245e-01 1 1  ON 14
 ud_5                -1.633232e-01 1 1  ON 15
 ud_6                -1.786230e-01 1 1  ON 16
 ud_7                -1.586480e-01 1 1  ON 17
 ud_8                -1.109897e-01 1 1  ON 18
 ud_9                 3.274057e-02 1 1  ON 19
 eO_0                -9.077655e-01 1 1  ON 20
 eO_1                -5.924822e-01 1 1  ON 21
 eO_2                -1.894218e-01 1 1  ON 22
 eO_3                 7.666987e-02 1 1  ON 23
 eO_4                 2.046460e-01 1 1  ON 24
 eO_5                 2.984387e-01 1 1  ON 25
 eO_6                 3.262318e-01 1 1  ON 26
 eO_7                 5.333998e-01 1 1  ON 27
 eO_8                 1.578460e-01 1 1  ON 28
 eO_9                 5.322969e-02 1 1  ON 29
eH1_0                -2.212805e-01 1 1  ON 30
eH1_1                -1.429024e-01 1 1  ON 31
eH1_2                -1.020868e-01 1 1  ON 32
eH1_3                -6.518358e-02 1 1  ON 33
eH1_4                -1.863028e-02 1 1  ON 34
eH1_5                -5.180280e-03 1 1  ON 35
eH1_6                 3.553086e-02 1 1  ON 36
eH1_7                 8.011161e-02 1 1  ON 37
eH1_8                 2.646660e-01 1 1  ON 38
eH1_9                 1.134554e-01 1 1  ON 39
eH2_0                -2.099358e-01 1 1  ON 40
eH2_1                -1.315384e-01 1 1  ON 41
eH2_2                -9.075695e-02 1 1  ON 42
eH2_3                -5.366228e-02 1 1  ON 43
eH2_4                -7.061545e-03 1 1  ON 44
eH2_5                 5.605254e-03 1 1  ON 45
eH2_6                 4.814693e-02 1 1  ON 46
eH2_7                 3.858382e-02 1 1  ON 47
eH2_8                 2.482112e-01 1 1  ON 48
eH2_9                 1.153339e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2359
    reference variance = 0.207894
====================================================
  Execution time = 2.0981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2546e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325409878401
                                         uncertainty =       0.005588765328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325409878401
                                         uncertainty =       0.005588765328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403398859
  error estimate for blocks of size 2^( 2) =       0.000412822912
  error estimate for blocks of size 2^( 3) =       0.000421210571
  error estimate for blocks of size 2^( 4) =       0.000427154342
  error estimate for blocks of size 2^( 5) =       0.000430907809
  error estimate for blocks of size 2^( 6) =       0.000433692633
  error estimate for blocks of size 2^( 7) =       0.000434411827

      target function =                  N/A
              le_mean =     -17.216441467217
             les_mean =     296.731317909817
             stat err =       0.000431541653
             autocorr =       1.144395418480
              std dev =       0.570492137058
             le_variance =       0.325461278445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644146722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441467217       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441510794       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441581086       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441632109       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441329829       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441266100       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441268896       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 5.215258e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441467217       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441479148       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441499523       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441518369       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441441566       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441424922       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441423277       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.437065e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441467217       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441470272       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441475576       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441480766       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441461600       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441457425       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441456823       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.685234e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6562e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.907072e-01 1 1  ON 0
 uu_1                 2.899739e-02 1 1  ON 1
 uu_2                -6.454843e-02 1 1  ON 2
 uu_3                -1.200752e-01 1 1  ON 3
 uu_4                -1.561793e-01 1 1  ON 4
 uu_5                -1.683695e-01 1 1  ON 5
 uu_6                -1.560017e-01 1 1  ON 6
 uu_7                -1.088853e-01 1 1  ON 7
 uu_8                -3.897567e-02 1 1  ON 8
 uu_9                 2.016839e-01 1 1  ON 9
 ud_0                 3.487765e-01 1 1  ON 10
 ud_1                 9.363371e-02 1 1  ON 11
 ud_2                -1.121189e-02 1 1  ON 12
 ud_3                -7.117144e-02 1 1  ON 13
 ud_4                -1.230322e-01 1 1  ON 14
 ud_5                -1.633298e-01 1 1  ON 15
 ud_6                -1.786203e-01 1 1  ON 16
 ud_7                -1.586440e-01 1 1  ON 17
 ud_8                -1.109900e-01 1 1  ON 18
 ud_9                 3.273777e-02 1 1  ON 19
 eO_0                -9.077575e-01 1 1  ON 20
 eO_1                -5.924906e-01 1 1  ON 21
 eO_2                -1.894237e-01 1 1  ON 22
 eO_3                 7.667935e-02 1 1  ON 23
 eO_4                 2.046425e-01 1 1  ON 24
 eO_5                 2.984350e-01 1 1  ON 25
 eO_6                 3.262326e-01 1 1  ON 26
 eO_7                 5.333969e-01 1 1  ON 27
 eO_8                 1.578473e-01 1 1  ON 28
 eO_9                 5.323012e-02 1 1  ON 29
eH1_0                -2.212856e-01 1 1  ON 30
eH1_1                -1.429125e-01 1 1  ON 31
eH1_2                -1.020855e-01 1 1  ON 32
eH1_3                -6.517897e-02 1 1  ON 33
eH1_4                -1.862028e-02 1 1  ON 34
eH1_5                -5.175713e-03 1 1  ON 35
eH1_6                 3.553327e-02 1 1  ON 36
eH1_7                 8.010610e-02 1 1  ON 37
eH1_8                 2.646634e-01 1 1  ON 38
eH1_9                 1.134554e-01 1 1  ON 39
eH2_0                -2.099281e-01 1 1  ON 40
eH2_1                -1.315443e-01 1 1  ON 41
eH2_2                -9.075413e-02 1 1  ON 42
eH2_3                -5.365762e-02 1 1  ON 43
eH2_4                -7.070771e-03 1 1  ON 44
eH2_5                 5.600463e-03 1 1  ON 45
eH2_6                 4.814738e-02 1 1  ON 46
eH2_7                 3.858778e-02 1 1  ON 47
eH2_8                 2.482104e-01 1 1  ON 48
eH2_9                 1.153347e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2425
    reference variance = 0.325003
====================================================
  Execution time = 1.9911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.5103e-01
  Total weights = 2.0000e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351172418868
                                         uncertainty =       0.027237675744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351172418868
                                         uncertainty =       0.027237675744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418936389
  error estimate for blocks of size 2^( 2) =       0.000427666617
  error estimate for blocks of size 2^( 3) =       0.000436179218
  error estimate for blocks of size 2^( 4) =       0.000442066550
  error estimate for blocks of size 2^( 5) =       0.000446110065
  error estimate for blocks of size 2^( 6) =       0.000449570149
  error estimate for blocks of size 2^( 7) =       0.000452538419

      target function =                  N/A
              le_mean =     -17.216157396937
             les_mean =     296.747090735890
             stat err =       0.000447571295
             autocorr =       1.141374806738
              std dev =       0.592465522455
             le_variance =       0.351015395297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351215205307
                                         uncertainty =       0.027236697242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351215205307
                                         uncertainty =       0.027236697242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418961917
  error estimate for blocks of size 2^( 2) =       0.000427690118
  error estimate for blocks of size 2^( 3) =       0.000436201099
  error estimate for blocks of size 2^( 4) =       0.000442088037
  error estimate for blocks of size 2^( 5) =       0.000446131436
  error estimate for blocks of size 2^( 6) =       0.000449590421
  error estimate for blocks of size 2^( 7) =       0.000452558320

      target function =                  N/A
              le_mean =     -17.216157761497
             les_mean =     296.747146068169
             stat err =       0.000447592054
             autocorr =       1.141341582342
              std dev =       0.592501624434
             le_variance =       0.351058174957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351196536938
                                         uncertainty =       0.027237126489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351196536938
                                         uncertainty =       0.027237126489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418950778
  error estimate for blocks of size 2^( 2) =       0.000427679847
  error estimate for blocks of size 2^( 3) =       0.000436191528
  error estimate for blocks of size 2^( 4) =       0.000442078640
  error estimate for blocks of size 2^( 5) =       0.000446122097
  error estimate for blocks of size 2^( 6) =       0.000449581543
  error estimate for blocks of size 2^( 7) =       0.000452549580

      target function =                  N/A
              le_mean =     -17.216157600295
             les_mean =     296.747121851878
             stat err =       0.000447582965
             autocorr =       1.141355916893
              std dev =       0.592485872577
             le_variance =       0.351039509203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351175526911
                                         uncertainty =       0.027237604733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351175526911
                                         uncertainty =       0.027237604733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418938243
  error estimate for blocks of size 2^( 2) =       0.000427668320
  error estimate for blocks of size 2^( 3) =       0.000436180803
  error estimate for blocks of size 2^( 4) =       0.000442068106
  error estimate for blocks of size 2^( 5) =       0.000446111613
  error estimate for blocks of size 2^( 6) =       0.000449571614
  error estimate for blocks of size 2^( 7) =       0.000452539853

      target function =                  N/A
              le_mean =     -17.216157422492
             les_mean =     296.747094723293
             stat err =       0.000447572797
             autocorr =       1.141372358960
              std dev =       0.592468144958
             le_variance =       0.351018502790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216157396937        initial
     2.3283e+00     2.3283e+01             5.2153e-05       -17.216157761497  <--
     9.3132e+00     9.3132e+01             1.4371e-05       -17.216157600295
     3.7253e+01     3.7253e+02             3.6852e-06       -17.216157422492

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.9130e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.907015e-01 1 1  ON 0
 uu_1                 2.898805e-02 1 1  ON 1
 uu_2                -6.453465e-02 1 1  ON 2
 uu_3                -1.200837e-01 1 1  ON 3
 uu_4                -1.561884e-01 1 1  ON 4
 uu_5                -1.683575e-01 1 1  ON 5
 uu_6                -1.559944e-01 1 1  ON 6
 uu_7                -1.088859e-01 1 1  ON 7
 uu_8                -3.897534e-02 1 1  ON 8
 uu_9                 2.016766e-01 1 1  ON 9
 ud_0                 3.488143e-01 1 1  ON 10
 ud_1                 9.364193e-02 1 1  ON 11
 ud_2                -1.124064e-02 1 1  ON 12
 ud_3                -7.116641e-02 1 1  ON 13
 ud_4                -1.230507e-01 1 1  ON 14
 ud_5                -1.633488e-01 1 1  ON 15
 ud_6                -1.786124e-01 1 1  ON 16
 ud_7                -1.586323e-01 1 1  ON 17
 ud_8                -1.109909e-01 1 1  ON 18
 ud_9                 3.272984e-02 1 1  ON 19
 eO_0                -9.077365e-01 1 1  ON 20
 eO_1                -5.925123e-01 1 1  ON 21
 eO_2                -1.894301e-01 1 1  ON 22
 eO_3                 7.670639e-02 1 1  ON 23
 eO_4                 2.046328e-01 1 1  ON 24
 eO_5                 2.984247e-01 1 1  ON 25
 eO_6                 3.262349e-01 1 1  ON 26
 eO_7                 5.333887e-01 1 1  ON 27
 eO_8                 1.578513e-01 1 1  ON 28
 eO_9                 5.323133e-02 1 1  ON 29
eH1_0                -2.213010e-01 1 1  ON 30
eH1_1                -1.429406e-01 1 1  ON 31
eH1_2                -1.020823e-01 1 1  ON 32
eH1_3                -6.516620e-02 1 1  ON 33
eH1_4                -1.859147e-02 1 1  ON 34
eH1_5                -5.162153e-03 1 1  ON 35
eH1_6                 3.554023e-02 1 1  ON 36
eH1_7                 8.009046e-02 1 1  ON 37
eH1_8                 2.646562e-01 1 1  ON 38
eH1_9                 1.134554e-01 1 1  ON 39
eH2_0                -2.099065e-01 1 1  ON 40
eH2_1                -1.315598e-01 1 1  ON 41
eH2_2                -9.074700e-02 1 1  ON 42
eH2_3                -5.364379e-02 1 1  ON 43
eH2_4                -7.096926e-03 1 1  ON 44
eH2_5                 5.586076e-03 1 1  ON 45
eH2_6                 4.814856e-02 1 1  ON 46
eH2_7                 3.859910e-02 1 1  ON 47
eH2_8                 2.482080e-01 1 1  ON 48
eH2_9                 1.153369e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2559
    reference variance = 0.280948
====================================================
  Execution time = 2.2542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1655e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316603643545
                                         uncertainty =       0.002472034034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316603643545
                                         uncertainty =       0.002472034034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397840290
  error estimate for blocks of size 2^( 2) =       0.000407121682
  error estimate for blocks of size 2^( 3) =       0.000415651732
  error estimate for blocks of size 2^( 4) =       0.000421780334
  error estimate for blocks of size 2^( 5) =       0.000425279901
  error estimate for blocks of size 2^( 6) =       0.000427832354
  error estimate for blocks of size 2^( 7) =       0.000428789468

      target function =                  N/A
              le_mean =     -17.216392026257
             les_mean =     296.720708036757
             stat err =       0.000425920514
             autocorr =       1.146145066714
              std dev =       0.562631134273
             le_variance =       0.316553793253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639202626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392026257       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391999884       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392071763       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392031871       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216392310309       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216392107909       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216392206186       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 1.672909e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392026257       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392017758       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392045466       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392036374       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216392128267       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216392086089       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216392097750       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 5.358292e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392026257       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392023967       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216392031866       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392029809       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216392055288       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216392045685       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216392047196       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.446035e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8047e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.907089e-01 1 1  ON 0
 uu_1                 2.897313e-02 1 1  ON 1
 uu_2                -6.452643e-02 1 1  ON 2
 uu_3                -1.200920e-01 1 1  ON 3
 uu_4                -1.562420e-01 1 1  ON 4
 uu_5                -1.683513e-01 1 1  ON 5
 uu_6                -1.559706e-01 1 1  ON 6
 uu_7                -1.088650e-01 1 1  ON 7
 uu_8                -3.896419e-02 1 1  ON 8
 uu_9                 2.016678e-01 1 1  ON 9
 ud_0                 3.487692e-01 1 1  ON 10
 ud_1                 9.362013e-02 1 1  ON 11
 ud_2                -1.123552e-02 1 1  ON 12
 ud_3                -7.118028e-02 1 1  ON 13
 ud_4                -1.230532e-01 1 1  ON 14
 ud_5                -1.633507e-01 1 1  ON 15
 ud_6                -1.785776e-01 1 1  ON 16
 ud_7                -1.585969e-01 1 1  ON 17
 ud_8                -1.109800e-01 1 1  ON 18
 ud_9                 3.272171e-02 1 1  ON 19
 eO_0                -9.077560e-01 1 1  ON 20
 eO_1                -5.925233e-01 1 1  ON 21
 eO_2                -1.894355e-01 1 1  ON 22
 eO_3                 7.671015e-02 1 1  ON 23
 eO_4                 2.046364e-01 1 1  ON 24
 eO_5                 2.984299e-01 1 1  ON 25
 eO_6                 3.262548e-01 1 1  ON 26
 eO_7                 5.333830e-01 1 1  ON 27
 eO_8                 1.578587e-01 1 1  ON 28
 eO_9                 5.323278e-02 1 1  ON 29
eH1_0                -2.212890e-01 1 1  ON 30
eH1_1                -1.429210e-01 1 1  ON 31
eH1_2                -1.021148e-01 1 1  ON 32
eH1_3                -6.516851e-02 1 1  ON 33
eH1_4                -1.857546e-02 1 1  ON 34
eH1_5                -5.146004e-03 1 1  ON 35
eH1_6                 3.554010e-02 1 1  ON 36
eH1_7                 8.006595e-02 1 1  ON 37
eH1_8                 2.646472e-01 1 1  ON 38
eH1_9                 1.134579e-01 1 1  ON 39
eH2_0                -2.099077e-01 1 1  ON 40
eH2_1                -1.315549e-01 1 1  ON 41
eH2_2                -9.076559e-02 1 1  ON 42
eH2_3                -5.365118e-02 1 1  ON 43
eH2_4                -7.091797e-03 1 1  ON 44
eH2_5                 5.571100e-03 1 1  ON 45
eH2_6                 4.814256e-02 1 1  ON 46
eH2_7                 3.863053e-02 1 1  ON 47
eH2_8                 2.482096e-01 1 1  ON 48
eH2_9                 1.153401e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.366018
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2091e-01
  Total weights = 2.0000e+06
  Execution time = 1.8399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320913273117
                                         uncertainty =       0.004837884672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320913273117
                                         uncertainty =       0.004837884672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400582147
  error estimate for blocks of size 2^( 2) =       0.000409697745
  error estimate for blocks of size 2^( 3) =       0.000417786390
  error estimate for blocks of size 2^( 4) =       0.000423326178
  error estimate for blocks of size 2^( 5) =       0.000425998907
  error estimate for blocks of size 2^( 6) =       0.000427684197
  error estimate for blocks of size 2^( 7) =       0.000428555116

      target function =                  N/A
              le_mean =     -17.215699752905
             les_mean =     296.701249934562
             stat err =       0.000426391099
             autocorr =       1.133008273353
              std dev =       0.566508704998
             le_variance =       0.320932112838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320847050745
                                         uncertainty =       0.004838313132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320847050745
                                         uncertainty =       0.004838313132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400540845
  error estimate for blocks of size 2^( 2) =       0.000409659467
  error estimate for blocks of size 2^( 3) =       0.000417750268
  error estimate for blocks of size 2^( 4) =       0.000423291564
  error estimate for blocks of size 2^( 5) =       0.000425966670
  error estimate for blocks of size 2^( 6) =       0.000427649406
  error estimate for blocks of size 2^( 7) =       0.000428519031

      target function =                  N/A
              le_mean =     -17.215701786458
             les_mean =     296.701253777247
             stat err =       0.000426356668
             autocorr =       1.133058932483
              std dev =       0.566450295645
             le_variance =       0.320865937436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320864972704
                                         uncertainty =       0.004838285606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320864972704
                                         uncertainty =       0.004838285606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400552020
  error estimate for blocks of size 2^( 2) =       0.000409669752
  error estimate for blocks of size 2^( 3) =       0.000417760062
  error estimate for blocks of size 2^( 4) =       0.000423300994
  error estimate for blocks of size 2^( 5) =       0.000425975312
  error estimate for blocks of size 2^( 6) =       0.000427658752
  error estimate for blocks of size 2^( 7) =       0.000428529216

      target function =                  N/A
              le_mean =     -17.215701206404
             les_mean =     296.701251708902
             stat err =       0.000426366068
             autocorr =       1.133045675970
              std dev =       0.566466098862
             le_variance =       0.320883841160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906413504
                                         uncertainty =       0.004837947989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320906413504
                                         uncertainty =       0.004837947989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400577868
  error estimate for blocks of size 2^( 2) =       0.000409693764
  error estimate for blocks of size 2^( 3) =       0.000417782649
  error estimate for blocks of size 2^( 4) =       0.000423322601
  error estimate for blocks of size 2^( 5) =       0.000425995546
  error estimate for blocks of size 2^( 6) =       0.000427680567
  error estimate for blocks of size 2^( 7) =       0.000428551443

      target function =                  N/A
              le_mean =     -17.215699952708
             les_mean =     296.701249958279
             stat err =       0.000426387539
             autocorr =       1.133013556236
              std dev =       0.566502654060
             le_variance =       0.320925257057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215699752905        initial
     5.8208e-01     5.8208e+00             1.6729e-04       -17.215701786458  <--
     2.3283e+00     2.3283e+01             5.3583e-05       -17.215701206404
     9.3132e+00     9.3132e+01             1.4460e-05       -17.215699952708

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 2.9245e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.907230e-01 1 1  ON 0
 uu_1                 2.895003e-02 1 1  ON 1
 uu_2                -6.452052e-02 1 1  ON 2
 uu_3                -1.201183e-01 1 1  ON 3
 uu_4                -1.563557e-01 1 1  ON 4
 uu_5                -1.683617e-01 1 1  ON 5
 uu_6                -1.559065e-01 1 1  ON 6
 uu_7                -1.088048e-01 1 1  ON 7
 uu_8                -3.893335e-02 1 1  ON 8
 uu_9                 2.016448e-01 1 1  ON 9
 ud_0                 3.486648e-01 1 1  ON 10
 ud_1                 9.357188e-02 1 1  ON 11
 ud_2                -1.124527e-02 1 1  ON 12
 ud_3                -7.121108e-02 1 1  ON 13
 ud_4                -1.230699e-01 1 1  ON 14
 ud_5                -1.633619e-01 1 1  ON 15
 ud_6                -1.784830e-01 1 1  ON 16
 ud_7                -1.584984e-01 1 1  ON 17
 ud_8                -1.109497e-01 1 1  ON 18
 ud_9                 3.270039e-02 1 1  ON 19
 eO_0                -9.078030e-01 1 1  ON 20
 eO_1                -5.925590e-01 1 1  ON 21
 eO_2                -1.894439e-01 1 1  ON 22
 eO_3                 7.672073e-02 1 1  ON 23
 eO_4                 2.046374e-01 1 1  ON 24
 eO_5                 2.984442e-01 1 1  ON 25
 eO_6                 3.263102e-01 1 1  ON 26
 eO_7                 5.333683e-01 1 1  ON 27
 eO_8                 1.578785e-01 1 1  ON 28
 eO_9                 5.323665e-02 1 1  ON 29
eH1_0                -2.212563e-01 1 1  ON 30
eH1_1                -1.428874e-01 1 1  ON 31
eH1_2                -1.021799e-01 1 1  ON 32
eH1_3                -6.517982e-02 1 1  ON 33
eH1_4                -1.853786e-02 1 1  ON 34
eH1_5                -5.099605e-03 1 1  ON 35
eH1_6                 3.554131e-02 1 1  ON 36
eH1_7                 8.000190e-02 1 1  ON 37
eH1_8                 2.646236e-01 1 1  ON 38
eH1_9                 1.134649e-01 1 1  ON 39
eH2_0                -2.099084e-01 1 1  ON 40
eH2_1                -1.315435e-01 1 1  ON 41
eH2_2                -9.080996e-02 1 1  ON 42
eH2_3                -5.367345e-02 1 1  ON 43
eH2_4                -7.080767e-03 1 1  ON 44
eH2_5                 5.529190e-03 1 1  ON 45
eH2_6                 4.812642e-02 1 1  ON 46
eH2_7                 3.871519e-02 1 1  ON 47
eH2_8                 2.482142e-01 1 1  ON 48
eH2_9                 1.153485e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2359
    reference variance = 0.18533
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2381e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323940497203
                                         uncertainty =       0.004704715313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323940497203
                                         uncertainty =       0.004704715313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402377023
  error estimate for blocks of size 2^( 2) =       0.000411624956
  error estimate for blocks of size 2^( 3) =       0.000419422410
  error estimate for blocks of size 2^( 4) =       0.000425489450
  error estimate for blocks of size 2^( 5) =       0.000428995233
  error estimate for blocks of size 2^( 6) =       0.000429381992
  error estimate for blocks of size 2^( 7) =       0.000429348725

      target function =                  N/A
              le_mean =     -17.215834704761
             les_mean =     296.708778956267
             stat err =       0.000428303850
             autocorr =       1.133020091552
              std dev =       0.569047042462
             le_variance =       0.323814536535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721583470476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215834704761       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215836600909       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215836927049       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215835888039       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215835121819       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215834627806       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215834319157       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215834747289       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215834906155       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 3.528131e-04

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215834704761       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215835539467       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215835895728       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215835566604       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215835143022       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215834808151       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215834705598       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 1.822850e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215834704761       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215834962453       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215835113677       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215835050155       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215834937237       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215834806041       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215834770772       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 5.970389e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5913e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.907289e-01 1 1  ON 0
 uu_1                 2.890946e-02 1 1  ON 1
 uu_2                -6.456383e-02 1 1  ON 2
 uu_3                -1.201338e-01 1 1  ON 3
 uu_4                -1.563251e-01 1 1  ON 4
 uu_5                -1.683906e-01 1 1  ON 5
 uu_6                -1.558160e-01 1 1  ON 6
 uu_7                -1.088221e-01 1 1  ON 7
 uu_8                -3.893249e-02 1 1  ON 8
 uu_9                 2.016131e-01 1 1  ON 9
 ud_0                 3.488470e-01 1 1  ON 10
 ud_1                 9.360602e-02 1 1  ON 11
 ud_2                -1.131785e-02 1 1  ON 12
 ud_3                -7.130041e-02 1 1  ON 13
 ud_4                -1.231368e-01 1 1  ON 14
 ud_5                -1.634734e-01 1 1  ON 15
 ud_6                -1.784322e-01 1 1  ON 16
 ud_7                -1.584459e-01 1 1  ON 17
 ud_8                -1.109299e-01 1 1  ON 18
 ud_9                 3.267518e-02 1 1  ON 19
 eO_0                -9.077998e-01 1 1  ON 20
 eO_1                -5.925519e-01 1 1  ON 21
 eO_2                -1.894103e-01 1 1  ON 22
 eO_3                 7.668896e-02 1 1  ON 23
 eO_4                 2.045946e-01 1 1  ON 24
 eO_5                 2.984145e-01 1 1  ON 25
 eO_6                 3.263622e-01 1 1  ON 26
 eO_7                 5.333375e-01 1 1  ON 27
 eO_8                 1.579078e-01 1 1  ON 28
 eO_9                 5.324589e-02 1 1  ON 29
eH1_0                -2.212971e-01 1 1  ON 30
eH1_1                -1.428517e-01 1 1  ON 31
eH1_2                -1.021395e-01 1 1  ON 32
eH1_3                -6.514340e-02 1 1  ON 33
eH1_4                -1.844205e-02 1 1  ON 34
eH1_5                -5.159986e-03 1 1  ON 35
eH1_6                 3.552626e-02 1 1  ON 36
eH1_7                 7.993152e-02 1 1  ON 37
eH1_8                 2.645906e-01 1 1  ON 38
eH1_9                 1.134701e-01 1 1  ON 39
eH2_0                -2.099125e-01 1 1  ON 40
eH2_1                -1.314941e-01 1 1  ON 41
eH2_2                -9.085722e-02 1 1  ON 42
eH2_3                -5.369597e-02 1 1  ON 43
eH2_4                -7.092641e-03 1 1  ON 44
eH2_5                 5.484350e-03 1 1  ON 45
eH2_6                 4.812010e-02 1 1  ON 46
eH2_7                 3.880373e-02 1 1  ON 47
eH2_8                 2.482078e-01 1 1  ON 48
eH2_9                 1.153517e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.2003
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2613e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325990233226
                                         uncertainty =       0.005834529184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325990233226
                                         uncertainty =       0.005834529184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403700784
  error estimate for blocks of size 2^( 2) =       0.000413143548
  error estimate for blocks of size 2^( 3) =       0.000421632108
  error estimate for blocks of size 2^( 4) =       0.000426831022
  error estimate for blocks of size 2^( 5) =       0.000430609727
  error estimate for blocks of size 2^( 6) =       0.000431581396
  error estimate for blocks of size 2^( 7) =       0.000434745466

      target function =                  N/A
              le_mean =     -17.216683662263
             les_mean =     296.740144809475
             stat err =       0.000430941903
             autocorr =       1.139510323230
              std dev =       0.570919123875
             le_variance =       0.325948646007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289993195
                                         uncertainty =       0.005838606477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289993195
                                         uncertainty =       0.005838606477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403886570
  error estimate for blocks of size 2^( 2) =       0.000413319838
  error estimate for blocks of size 2^( 3) =       0.000421800133
  error estimate for blocks of size 2^( 4) =       0.000426991871
  error estimate for blocks of size 2^( 5) =       0.000430767139
  error estimate for blocks of size 2^( 6) =       0.000431736271
  error estimate for blocks of size 2^( 7) =       0.000434896806

      target function =                  N/A
              le_mean =     -17.216682848215
             les_mean =     296.740416856423
             stat err =       0.000431098022
             autocorr =       1.139287241942
              std dev =       0.571181865552
             le_variance =       0.326248723535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326349016001
                                         uncertainty =       0.005840294517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326349016001
                                         uncertainty =       0.005840294517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403923071
  error estimate for blocks of size 2^( 2) =       0.000413354670
  error estimate for blocks of size 2^( 3) =       0.000421833462
  error estimate for blocks of size 2^( 4) =       0.000427024272
  error estimate for blocks of size 2^( 5) =       0.000430799786
  error estimate for blocks of size 2^( 6) =       0.000431768181
  error estimate for blocks of size 2^( 7) =       0.000434927623

      target function =                  N/A
              le_mean =     -17.216683147856
             les_mean =     296.740486144330
             stat err =       0.000431129966
             autocorr =       1.139250166496
              std dev =       0.571233484497
             le_variance =       0.326307693810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051140258
                                         uncertainty =       0.005835545216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326051140258
                                         uncertainty =       0.005835545216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403738529
  error estimate for blocks of size 2^( 2) =       0.000413179327
  error estimate for blocks of size 2^( 3) =       0.000421666118
  error estimate for blocks of size 2^( 4) =       0.000426863572
  error estimate for blocks of size 2^( 5) =       0.000430641730
  error estimate for blocks of size 2^( 6) =       0.000431612751
  error estimate for blocks of size 2^( 7) =       0.000434776046

      target function =                  N/A
              le_mean =     -17.216683513682
             les_mean =     296.740200647250
             stat err =       0.000430973525
             autocorr =       1.139464474989
              std dev =       0.570972503674
             le_variance =       0.326009599952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216683662263        initial  <--
     1.4552e-01     1.4552e+00             3.5281e-04       -17.216682848215
     5.8208e-01     5.8208e+00             1.8229e-04       -17.216683147856
     2.3283e+00     2.3283e+01             5.9704e-05       -17.216683513682

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4507
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.907230e-01 1 1  ON 0
 uu_1                 2.895003e-02 1 1  ON 1
 uu_2                -6.452052e-02 1 1  ON 2
 uu_3                -1.201183e-01 1 1  ON 3
 uu_4                -1.563557e-01 1 1  ON 4
 uu_5                -1.683617e-01 1 1  ON 5
 uu_6                -1.559065e-01 1 1  ON 6
 uu_7                -1.088048e-01 1 1  ON 7
 uu_8                -3.893335e-02 1 1  ON 8
 uu_9                 2.016448e-01 1 1  ON 9
 ud_0                 3.486648e-01 1 1  ON 10
 ud_1                 9.357188e-02 1 1  ON 11
 ud_2                -1.124527e-02 1 1  ON 12
 ud_3                -7.121108e-02 1 1  ON 13
 ud_4                -1.230699e-01 1 1  ON 14
 ud_5                -1.633619e-01 1 1  ON 15
 ud_6                -1.784830e-01 1 1  ON 16
 ud_7                -1.584984e-01 1 1  ON 17
 ud_8                -1.109497e-01 1 1  ON 18
 ud_9                 3.270039e-02 1 1  ON 19
 eO_0                -9.078030e-01 1 1  ON 20
 eO_1                -5.925590e-01 1 1  ON 21
 eO_2                -1.894439e-01 1 1  ON 22
 eO_3                 7.672073e-02 1 1  ON 23
 eO_4                 2.046374e-01 1 1  ON 24
 eO_5                 2.984442e-01 1 1  ON 25
 eO_6                 3.263102e-01 1 1  ON 26
 eO_7                 5.333683e-01 1 1  ON 27
 eO_8                 1.578785e-01 1 1  ON 28
 eO_9                 5.323665e-02 1 1  ON 29
eH1_0                -2.212563e-01 1 1  ON 30
eH1_1                -1.428874e-01 1 1  ON 31
eH1_2                -1.021799e-01 1 1  ON 32
eH1_3                -6.517982e-02 1 1  ON 33
eH1_4                -1.853786e-02 1 1  ON 34
eH1_5                -5.099605e-03 1 1  ON 35
eH1_6                 3.554131e-02 1 1  ON 36
eH1_7                 8.000190e-02 1 1  ON 37
eH1_8                 2.646236e-01 1 1  ON 38
eH1_9                 1.134649e-01 1 1  ON 39
eH2_0                -2.099084e-01 1 1  ON 40
eH2_1                -1.315435e-01 1 1  ON 41
eH2_2                -9.080996e-02 1 1  ON 42
eH2_3                -5.367345e-02 1 1  ON 43
eH2_4                -7.080767e-03 1 1  ON 44
eH2_5                 5.529190e-03 1 1  ON 45
eH2_6                 4.812642e-02 1 1  ON 46
eH2_7                 3.871519e-02 1 1  ON 47
eH2_8                 2.482142e-01 1 1  ON 48
eH2_9                 1.153485e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5371e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.197
    reference variance = 0.186058
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2918e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329222026842
                                         uncertainty =       0.007252967537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329222026842
                                         uncertainty =       0.007252967537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405698212
  error estimate for blocks of size 2^( 2) =       0.000415125816
  error estimate for blocks of size 2^( 3) =       0.000423566147
  error estimate for blocks of size 2^( 4) =       0.000429802959
  error estimate for blocks of size 2^( 5) =       0.000434588141
  error estimate for blocks of size 2^( 6) =       0.000435417783
  error estimate for blocks of size 2^( 7) =       0.000437021328

      target function =                  N/A
              le_mean =     -17.216859771723
             les_mean =     296.749442313404
             stat err =       0.000434207553
             autocorr =       1.145482765254
              std dev =       0.573743913986
             le_variance =       0.329182078836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685977172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216859771723       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216859846141       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216859936910       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216859749158       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216859808594       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216859842737       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216859777102       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 9.134404e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216859771723       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216859791848       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216859818925       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216859767308       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216859763759       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216859781032       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.405469e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216859771723       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216859776859       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216859783980       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216859771527       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216859768847       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216859773193       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.229559e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6028e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.906990e-01 1 1  ON 0
 uu_1                 2.894524e-02 1 1  ON 1
 uu_2                -6.451478e-02 1 1  ON 2
 uu_3                -1.201165e-01 1 1  ON 3
 uu_4                -1.563545e-01 1 1  ON 4
 uu_5                -1.683516e-01 1 1  ON 5
 uu_6                -1.558977e-01 1 1  ON 6
 uu_7                -1.088069e-01 1 1  ON 7
 uu_8                -3.892971e-02 1 1  ON 8
 uu_9                 2.016419e-01 1 1  ON 9
 ud_0                 3.486618e-01 1 1  ON 10
 ud_1                 9.356493e-02 1 1  ON 11
 ud_2                -1.124826e-02 1 1  ON 12
 ud_3                -7.120756e-02 1 1  ON 13
 ud_4                -1.230693e-01 1 1  ON 14
 ud_5                -1.633685e-01 1 1  ON 15
 ud_6                -1.784741e-01 1 1  ON 16
 ud_7                -1.584896e-01 1 1  ON 17
 ud_8                -1.109505e-01 1 1  ON 18
 ud_9                 3.269712e-02 1 1  ON 19
 eO_0                -9.078153e-01 1 1  ON 20
 eO_1                -5.925439e-01 1 1  ON 21
 eO_2                -1.894567e-01 1 1  ON 22
 eO_3                 7.672424e-02 1 1  ON 23
 eO_4                 2.046406e-01 1 1  ON 24
 eO_5                 2.984451e-01 1 1  ON 25
 eO_6                 3.263141e-01 1 1  ON 26
 eO_7                 5.333637e-01 1 1  ON 27
 eO_8                 1.578808e-01 1 1  ON 28
 eO_9                 5.323747e-02 1 1  ON 29
eH1_0                -2.212568e-01 1 1  ON 30
eH1_1                -1.428809e-01 1 1  ON 31
eH1_2                -1.021760e-01 1 1  ON 32
eH1_3                -6.518833e-02 1 1  ON 33
eH1_4                -1.853218e-02 1 1  ON 34
eH1_5                -5.104956e-03 1 1  ON 35
eH1_6                 3.554930e-02 1 1  ON 36
eH1_7                 7.999487e-02 1 1  ON 37
eH1_8                 2.646194e-01 1 1  ON 38
eH1_9                 1.134657e-01 1 1  ON 39
eH2_0                -2.099121e-01 1 1  ON 40
eH2_1                -1.315344e-01 1 1  ON 41
eH2_2                -9.081988e-02 1 1  ON 42
eH2_3                -5.367776e-02 1 1  ON 43
eH2_4                -7.088238e-03 1 1  ON 44
eH2_5                 5.531919e-03 1 1  ON 45
eH2_6                 4.813019e-02 1 1  ON 46
eH2_7                 3.872672e-02 1 1  ON 47
eH2_8                 2.482123e-01 1 1  ON 48
eH2_9                 1.153484e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.184826
====================================================
  Execution time = 1.9961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2326e-01
  Total weights = 2.0000e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323305081429
                                         uncertainty =       0.003675364496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323305081429
                                         uncertainty =       0.003675364496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402036061
  error estimate for blocks of size 2^( 2) =       0.000411688327
  error estimate for blocks of size 2^( 3) =       0.000420151032
  error estimate for blocks of size 2^( 4) =       0.000425445329
  error estimate for blocks of size 2^( 5) =       0.000429051492
  error estimate for blocks of size 2^( 6) =       0.000433085878
  error estimate for blocks of size 2^( 7) =       0.000433037671

      target function =                  N/A
              le_mean =     -17.216324976501
             les_mean =     296.725111522812
             stat err =       0.000430155092
             autocorr =       1.144774954790
              std dev =       0.568564849382
             le_variance =       0.323265987953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323289161770
                                         uncertainty =       0.003675505184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323289161770
                                         uncertainty =       0.003675505184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402026129
  error estimate for blocks of size 2^( 2) =       0.000411678666
  error estimate for blocks of size 2^( 3) =       0.000420141980
  error estimate for blocks of size 2^( 4) =       0.000425436937
  error estimate for blocks of size 2^( 5) =       0.000429043751
  error estimate for blocks of size 2^( 6) =       0.000433077080
  error estimate for blocks of size 2^( 7) =       0.000433029830

      target function =                  N/A
              le_mean =     -17.216325302849
             les_mean =     296.725106789271
             stat err =       0.000430146899
             autocorr =       1.144787905396
              std dev =       0.568550804556
             le_variance =       0.323250017361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323297471939
                                         uncertainty =       0.003675464371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323297471939
                                         uncertainty =       0.003675464371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402031310
  error estimate for blocks of size 2^( 2) =       0.000411683676
  error estimate for blocks of size 2^( 3) =       0.000420146701
  error estimate for blocks of size 2^( 4) =       0.000425441311
  error estimate for blocks of size 2^( 5) =       0.000429047707
  error estimate for blocks of size 2^( 6) =       0.000433081400
  error estimate for blocks of size 2^( 7) =       0.000433033737

      target function =                  N/A
              le_mean =     -17.216325158758
             les_mean =     296.725110158811
             stat err =       0.000430151039
             autocorr =       1.144780433758
              std dev =       0.568558131034
             le_variance =       0.323258348365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323304099578
                                         uncertainty =       0.003675378030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323304099578
                                         uncertainty =       0.003675378030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402035448
  error estimate for blocks of size 2^( 2) =       0.000411687726
  error estimate for blocks of size 2^( 3) =       0.000420150472
  error estimate for blocks of size 2^( 4) =       0.000425444807
  error estimate for blocks of size 2^( 5) =       0.000429051000
  error estimate for blocks of size 2^( 6) =       0.000433085294
  error estimate for blocks of size 2^( 7) =       0.000433037155

      target function =                  N/A
              le_mean =     -17.216324998014
             les_mean =     296.725111277757
             stat err =       0.000430154564
             autocorr =       1.144775633852
              std dev =       0.568563982447
             le_variance =       0.323265002136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216324976501        initial
     1.4552e+00     1.4552e+01             9.1344e-05       -17.216325302849  <--
     5.8208e+00     5.8208e+01             2.4055e-05       -17.216325158758
     2.3283e+01     2.3283e+02             6.2296e-06       -17.216324998014

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.9344e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.906317e-01 1 1  ON 0
 uu_1                 2.893975e-02 1 1  ON 1
 uu_2                -6.450693e-02 1 1  ON 2
 uu_3                -1.201139e-01 1 1  ON 3
 uu_4                -1.563531e-01 1 1  ON 4
 uu_5                -1.683221e-01 1 1  ON 5
 uu_6                -1.558701e-01 1 1  ON 6
 uu_7                -1.088140e-01 1 1  ON 7
 uu_8                -3.891754e-02 1 1  ON 8
 uu_9                 2.016320e-01 1 1  ON 9
 ud_0                 3.486507e-01 1 1  ON 10
 ud_1                 9.354543e-02 1 1  ON 11
 ud_2                -1.125306e-02 1 1  ON 12
 ud_3                -7.120055e-02 1 1  ON 13
 ud_4                -1.230662e-01 1 1  ON 14
 ud_5                -1.633886e-01 1 1  ON 15
 ud_6                -1.784484e-01 1 1  ON 16
 ud_7                -1.584619e-01 1 1  ON 17
 ud_8                -1.109534e-01 1 1  ON 18
 ud_9                 3.268604e-02 1 1  ON 19
 eO_0                -9.078437e-01 1 1  ON 20
 eO_1                -5.925126e-01 1 1  ON 21
 eO_2                -1.894860e-01 1 1  ON 22
 eO_3                 7.673208e-02 1 1  ON 23
 eO_4                 2.046490e-01 1 1  ON 24
 eO_5                 2.984477e-01 1 1  ON 25
 eO_6                 3.263266e-01 1 1  ON 26
 eO_7                 5.333481e-01 1 1  ON 27
 eO_8                 1.578887e-01 1 1  ON 28
 eO_9                 5.324024e-02 1 1  ON 29
eH1_0                -2.212560e-01 1 1  ON 30
eH1_1                -1.428649e-01 1 1  ON 31
eH1_2                -1.021665e-01 1 1  ON 32
eH1_3                -6.520619e-02 1 1  ON 33
eH1_4                -1.851497e-02 1 1  ON 34
eH1_5                -5.124299e-03 1 1  ON 35
eH1_6                 3.557591e-02 1 1  ON 36
eH1_7                 7.997098e-02 1 1  ON 37
eH1_8                 2.646049e-01 1 1  ON 38
eH1_9                 1.134685e-01 1 1  ON 39
eH2_0                -2.099238e-01 1 1  ON 40
eH2_1                -1.315165e-01 1 1  ON 41
eH2_2                -9.084560e-02 1 1  ON 42
eH2_3                -5.368829e-02 1 1  ON 43
eH2_4                -7.109342e-03 1 1  ON 44
eH2_5                 5.538641e-03 1 1  ON 45
eH2_6                 4.814186e-02 1 1  ON 46
eH2_7                 3.876524e-02 1 1  ON 47
eH2_8                 2.482061e-01 1 1  ON 48
eH2_9                 1.153478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.218076
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326679334076
                                         uncertainty =       0.003822598155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326679334076
                                         uncertainty =       0.003822598155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404108950
  error estimate for blocks of size 2^( 2) =       0.000413721393
  error estimate for blocks of size 2^( 3) =       0.000421317224
  error estimate for blocks of size 2^( 4) =       0.000427734997
  error estimate for blocks of size 2^( 5) =       0.000432302591
  error estimate for blocks of size 2^( 6) =       0.000434069003
  error estimate for blocks of size 2^( 7) =       0.000434937534

      target function =                  N/A
              le_mean =     -17.216631533639
             les_mean =     296.739009288772
             stat err =       0.000432261031
             autocorr =       1.144182318210
              std dev =       0.571496357808
             le_variance =       0.326608086988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663153364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216631533639       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216631580668       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216631599183       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216630951696       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216631175233       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216631048665       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631386249       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216631326888       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 2.059238e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216631533639       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216631549187       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216631562914       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216631276604       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216631293526       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216631348062       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631385137       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 7.049521e-05

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216631533639       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216631537867       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216631542448       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216631453217       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216631445679       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216631469654       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216631475871       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 1.957040e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.429604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6037e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.906311e-01 1 1  ON 0
 uu_1                 2.896088e-02 1 1  ON 1
 uu_2                -6.452114e-02 1 1  ON 2
 uu_3                -1.201249e-01 1 1  ON 3
 uu_4                -1.563294e-01 1 1  ON 4
 uu_5                -1.683477e-01 1 1  ON 5
 uu_6                -1.558819e-01 1 1  ON 6
 uu_7                -1.088014e-01 1 1  ON 7
 uu_8                -3.890815e-02 1 1  ON 8
 uu_9                 2.016158e-01 1 1  ON 9
 ud_0                 3.486088e-01 1 1  ON 10
 ud_1                 9.349766e-02 1 1  ON 11
 ud_2                -1.122756e-02 1 1  ON 12
 ud_3                -7.120063e-02 1 1  ON 13
 ud_4                -1.230662e-01 1 1  ON 14
 ud_5                -1.633688e-01 1 1  ON 15
 ud_6                -1.784198e-01 1 1  ON 16
 ud_7                -1.584357e-01 1 1  ON 17
 ud_8                -1.109533e-01 1 1  ON 18
 ud_9                 3.266908e-02 1 1  ON 19
 eO_0                -9.078667e-01 1 1  ON 20
 eO_1                -5.924691e-01 1 1  ON 21
 eO_2                -1.895565e-01 1 1  ON 22
 eO_3                 7.670025e-02 1 1  ON 23
 eO_4                 2.046960e-01 1 1  ON 24
 eO_5                 2.984704e-01 1 1  ON 25
 eO_6                 3.263376e-01 1 1  ON 26
 eO_7                 5.333352e-01 1 1  ON 27
 eO_8                 1.578998e-01 1 1  ON 28
 eO_9                 5.324241e-02 1 1  ON 29
eH1_0                -2.212864e-01 1 1  ON 30
eH1_1                -1.428754e-01 1 1  ON 31
eH1_2                -1.021863e-01 1 1  ON 32
eH1_3                -6.517609e-02 1 1  ON 33
eH1_4                -1.854596e-02 1 1  ON 34
eH1_5                -5.076967e-03 1 1  ON 35
eH1_6                 3.561537e-02 1 1  ON 36
eH1_7                 7.994950e-02 1 1  ON 37
eH1_8                 2.645936e-01 1 1  ON 38
eH1_9                 1.134726e-01 1 1  ON 39
eH2_0                -2.098658e-01 1 1  ON 40
eH2_1                -1.315684e-01 1 1  ON 41
eH2_2                -9.082860e-02 1 1  ON 42
eH2_3                -5.371204e-02 1 1  ON 43
eH2_4                -7.138013e-03 1 1  ON 44
eH2_5                 5.535799e-03 1 1  ON 45
eH2_6                 4.814802e-02 1 1  ON 46
eH2_7                 3.880564e-02 1 1  ON 47
eH2_8                 2.481906e-01 1 1  ON 48
eH2_9                 1.153475e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.377648
====================================================
  Execution time = 2.0144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2890e-01
  Total weights = 2.0000e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328934808393
                                         uncertainty =       0.008337631669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328934808393
                                         uncertainty =       0.008337631669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405533625
  error estimate for blocks of size 2^( 2) =       0.000414432668
  error estimate for blocks of size 2^( 3) =       0.000422779904
  error estimate for blocks of size 2^( 4) =       0.000428615394
  error estimate for blocks of size 2^( 5) =       0.000432005191
  error estimate for blocks of size 2^( 6) =       0.000434779176
  error estimate for blocks of size 2^( 7) =       0.000435583993

      target function =                  N/A
              le_mean =     -17.216763823102
             les_mean =     296.745871418526
             stat err =       0.000432745939
             autocorr =       1.138707710177
              std dev =       0.573511152908
             le_variance =       0.328915042510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328868838214
                                         uncertainty =       0.008336838332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328868838214
                                         uncertainty =       0.008336838332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405492901
  error estimate for blocks of size 2^( 2) =       0.000414393484
  error estimate for blocks of size 2^( 3) =       0.000422742196
  error estimate for blocks of size 2^( 4) =       0.000428578518
  error estimate for blocks of size 2^( 5) =       0.000431967719
  error estimate for blocks of size 2^( 6) =       0.000434742817
  error estimate for blocks of size 2^( 7) =       0.000435543470

      target function =                  N/A
              le_mean =     -17.216762778842
             les_mean =     296.745769403593
             stat err =       0.000432708131
             autocorr =       1.138737444196
              std dev =       0.573453559659
             le_variance =       0.328848985086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328896587284
                                         uncertainty =       0.008336976423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328896587284
                                         uncertainty =       0.008336976423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405510025
  error estimate for blocks of size 2^( 2) =       0.000414409972
  error estimate for blocks of size 2^( 3) =       0.000422758038
  error estimate for blocks of size 2^( 4) =       0.000428594000
  error estimate for blocks of size 2^( 5) =       0.000431983314
  error estimate for blocks of size 2^( 6) =       0.000434757886
  error estimate for blocks of size 2^( 7) =       0.000435558844

      target function =                  N/A
              le_mean =     -17.216762990715
             les_mean =     296.745804475322
             stat err =       0.000432723511
             autocorr =       1.138722215332
              std dev =       0.573477777508
             le_variance =       0.328876761296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328930288228
                                         uncertainty =       0.008337556043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328930288228
                                         uncertainty =       0.008337556043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405530833
  error estimate for blocks of size 2^( 2) =       0.000414429983
  error estimate for blocks of size 2^( 3) =       0.000422777312
  error estimate for blocks of size 2^( 4) =       0.000428612862
  error estimate for blocks of size 2^( 5) =       0.000432002588
  error estimate for blocks of size 2^( 6) =       0.000434776647
  error estimate for blocks of size 2^( 7) =       0.000435580871

      target function =                  N/A
              le_mean =     -17.216763685403
             les_mean =     296.745862148328
             stat err =       0.000432743242
             autocorr =       1.138709197883
              std dev =       0.573507204639
             le_variance =       0.328910513772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216763823102        initial  <--
     3.6380e-01     3.6380e+00             2.0592e-04       -17.216762778842
     1.4552e+00     1.4552e+01             7.0495e-05       -17.216762990715
     5.8208e+00     5.8208e+01             1.9570e-05       -17.216763685403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3647
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.906317e-01 1 1  ON 0
 uu_1                 2.893975e-02 1 1  ON 1
 uu_2                -6.450693e-02 1 1  ON 2
 uu_3                -1.201139e-01 1 1  ON 3
 uu_4                -1.563531e-01 1 1  ON 4
 uu_5                -1.683221e-01 1 1  ON 5
 uu_6                -1.558701e-01 1 1  ON 6
 uu_7                -1.088140e-01 1 1  ON 7
 uu_8                -3.891754e-02 1 1  ON 8
 uu_9                 2.016320e-01 1 1  ON 9
 ud_0                 3.486507e-01 1 1  ON 10
 ud_1                 9.354543e-02 1 1  ON 11
 ud_2                -1.125306e-02 1 1  ON 12
 ud_3                -7.120055e-02 1 1  ON 13
 ud_4                -1.230662e-01 1 1  ON 14
 ud_5                -1.633886e-01 1 1  ON 15
 ud_6                -1.784484e-01 1 1  ON 16
 ud_7                -1.584619e-01 1 1  ON 17
 ud_8                -1.109534e-01 1 1  ON 18
 ud_9                 3.268604e-02 1 1  ON 19
 eO_0                -9.078437e-01 1 1  ON 20
 eO_1                -5.925126e-01 1 1  ON 21
 eO_2                -1.894860e-01 1 1  ON 22
 eO_3                 7.673208e-02 1 1  ON 23
 eO_4                 2.046490e-01 1 1  ON 24
 eO_5                 2.984477e-01 1 1  ON 25
 eO_6                 3.263266e-01 1 1  ON 26
 eO_7                 5.333481e-01 1 1  ON 27
 eO_8                 1.578887e-01 1 1  ON 28
 eO_9                 5.324024e-02 1 1  ON 29
eH1_0                -2.212560e-01 1 1  ON 30
eH1_1                -1.428649e-01 1 1  ON 31
eH1_2                -1.021665e-01 1 1  ON 32
eH1_3                -6.520619e-02 1 1  ON 33
eH1_4                -1.851497e-02 1 1  ON 34
eH1_5                -5.124299e-03 1 1  ON 35
eH1_6                 3.557591e-02 1 1  ON 36
eH1_7                 7.997098e-02 1 1  ON 37
eH1_8                 2.646049e-01 1 1  ON 38
eH1_9                 1.134685e-01 1 1  ON 39
eH2_0                -2.099238e-01 1 1  ON 40
eH2_1                -1.315165e-01 1 1  ON 41
eH2_2                -9.084560e-02 1 1  ON 42
eH2_3                -5.368829e-02 1 1  ON 43
eH2_4                -7.109342e-03 1 1  ON 44
eH2_5                 5.538641e-03 1 1  ON 45
eH2_6                 4.814186e-02 1 1  ON 46
eH2_7                 3.876524e-02 1 1  ON 47
eH2_8                 2.482061e-01 1 1  ON 48
eH2_9                 1.153478e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.433656
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452553266
                                         uncertainty =       0.004083601759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452553266
                                         uncertainty =       0.004083601759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402759032
  error estimate for blocks of size 2^( 2) =       0.000412117604
  error estimate for blocks of size 2^( 3) =       0.000420230884
  error estimate for blocks of size 2^( 4) =       0.000426189576
  error estimate for blocks of size 2^( 5) =       0.000430889672
  error estimate for blocks of size 2^( 6) =       0.000433078764
  error estimate for blocks of size 2^( 7) =       0.000434787943

      target function =                  N/A
              le_mean =     -17.217026824853
             les_mean =     296.750442200789
             stat err =       0.000431236489
             autocorr =       1.146411216619
              std dev =       0.569587285049
             le_variance =       0.324429675289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702682485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217026824853       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217026887418       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217026918368       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217026870194       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217026850161       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217026859041       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217026886894       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.070821e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217026824853       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217026841240       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217026849847       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217026837077       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217026830320       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217026831960       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217026838236       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 7.757793e-06

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217026824853       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217026828999       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217026831211       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217026827970       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217026826154       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217026826516       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217026828034       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 1.944672e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6008e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.906336e-01 1 1  ON 0
 uu_1                 2.893916e-02 1 1  ON 1
 uu_2                -6.450571e-02 1 1  ON 2
 uu_3                -1.201157e-01 1 1  ON 3
 uu_4                -1.563490e-01 1 1  ON 4
 uu_5                -1.683292e-01 1 1  ON 5
 uu_6                -1.558691e-01 1 1  ON 6
 uu_7                -1.088125e-01 1 1  ON 7
 uu_8                -3.891699e-02 1 1  ON 8
 uu_9                 2.016295e-01 1 1  ON 9
 ud_0                 3.486558e-01 1 1  ON 10
 ud_1                 9.354103e-02 1 1  ON 11
 ud_2                -1.125104e-02 1 1  ON 12
 ud_3                -7.119933e-02 1 1  ON 13
 ud_4                -1.230686e-01 1 1  ON 14
 ud_5                -1.633855e-01 1 1  ON 15
 ud_6                -1.784551e-01 1 1  ON 16
 ud_7                -1.584612e-01 1 1  ON 17
 ud_8                -1.109526e-01 1 1  ON 18
 ud_9                 3.268502e-02 1 1  ON 19
 eO_0                -9.078439e-01 1 1  ON 20
 eO_1                -5.925115e-01 1 1  ON 21
 eO_2                -1.894896e-01 1 1  ON 22
 eO_3                 7.673358e-02 1 1  ON 23
 eO_4                 2.046539e-01 1 1  ON 24
 eO_5                 2.984473e-01 1 1  ON 25
 eO_6                 3.263244e-01 1 1  ON 26
 eO_7                 5.333452e-01 1 1  ON 27
 eO_8                 1.578898e-01 1 1  ON 28
 eO_9                 5.324074e-02 1 1  ON 29
eH1_0                -2.212550e-01 1 1  ON 30
eH1_1                -1.428664e-01 1 1  ON 31
eH1_2                -1.021633e-01 1 1  ON 32
eH1_3                -6.520751e-02 1 1  ON 33
eH1_4                -1.851617e-02 1 1  ON 34
eH1_5                -5.116541e-03 1 1  ON 35
eH1_6                 3.557646e-02 1 1  ON 36
eH1_7                 7.996426e-02 1 1  ON 37
eH1_8                 2.646025e-01 1 1  ON 38
eH1_9                 1.134688e-01 1 1  ON 39
eH2_0                -2.099261e-01 1 1  ON 40
eH2_1                -1.315218e-01 1 1  ON 41
eH2_2                -9.084160e-02 1 1  ON 42
eH2_3                -5.369068e-02 1 1  ON 43
eH2_4                -7.106229e-03 1 1  ON 44
eH2_5                 5.533705e-03 1 1  ON 45
eH2_6                 4.814266e-02 1 1  ON 46
eH2_7                 3.877135e-02 1 1  ON 47
eH2_8                 2.482056e-01 1 1  ON 48
eH2_9                 1.153487e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.299279
====================================================
  Execution time = 1.9980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1964e-01
  Total weights = 2.0000e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319741729764
                                         uncertainty =       0.003407451623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319741729764
                                         uncertainty =       0.003407451623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399770187
  error estimate for blocks of size 2^( 2) =       0.000409201613
  error estimate for blocks of size 2^( 3) =       0.000417933977
  error estimate for blocks of size 2^( 4) =       0.000424328901
  error estimate for blocks of size 2^( 5) =       0.000428540282
  error estimate for blocks of size 2^( 6) =       0.000431308948
  error estimate for blocks of size 2^( 7) =       0.000430876912

      target function =                  N/A
              le_mean =     -17.216238620355
             les_mean =     296.718504478490
             stat err =       0.000428763761
             autocorr =       1.150311167592
              std dev =       0.565360420712
             le_variance =       0.319632405308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319753553695
                                         uncertainty =       0.003407624416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319753553695
                                         uncertainty =       0.003407624416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399777576
  error estimate for blocks of size 2^( 2) =       0.000409208509
  error estimate for blocks of size 2^( 3) =       0.000417940973
  error estimate for blocks of size 2^( 4) =       0.000424335985
  error estimate for blocks of size 2^( 5) =       0.000428547598
  error estimate for blocks of size 2^( 6) =       0.000431316884
  error estimate for blocks of size 2^( 7) =       0.000430884196

      target function =                  N/A
              le_mean =     -17.216238763630
             les_mean =     296.718521227827
             stat err =       0.000428771166
             autocorr =       1.150308376302
              std dev =       0.565370870596
             le_variance =       0.319644221318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319748421788
                                         uncertainty =       0.003407545844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319748421788
                                         uncertainty =       0.003407545844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399774369
  error estimate for blocks of size 2^( 2) =       0.000409205523
  error estimate for blocks of size 2^( 3) =       0.000417937941
  error estimate for blocks of size 2^( 4) =       0.000424332909
  error estimate for blocks of size 2^( 5) =       0.000428544410
  error estimate for blocks of size 2^( 6) =       0.000431313427
  error estimate for blocks of size 2^( 7) =       0.000430881035

      target function =                  N/A
              le_mean =     -17.216238693532
             les_mean =     296.718513685647
             stat err =       0.000428767945
             autocorr =       1.150309553103
              std dev =       0.565366335050
             le_variance =       0.319639092808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319742593390
                                         uncertainty =       0.003407463671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319742593390
                                         uncertainty =       0.003407463671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399770727
  error estimate for blocks of size 2^( 2) =       0.000409202118
  error estimate for blocks of size 2^( 3) =       0.000417934489
  error estimate for blocks of size 2^( 4) =       0.000424329419
  error estimate for blocks of size 2^( 5) =       0.000428540815
  error estimate for blocks of size 2^( 6) =       0.000431309526
  error estimate for blocks of size 2^( 7) =       0.000430877444

      target function =                  N/A
              le_mean =     -17.216238629475
             les_mean =     296.718505655543
             stat err =       0.000428764301
             autocorr =       1.150310957934
              std dev =       0.565361183978
             le_variance =       0.319633268349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216238620355        initial
     3.6380e+00     3.6380e+01             3.0708e-05       -17.216238763630  <--
     1.4552e+01     1.4552e+02             7.7578e-06       -17.216238693532
     5.8208e+01     5.8208e+02             1.9447e-06       -17.216238629475

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 2.9169e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.906392e-01 1 1  ON 0
 uu_1                 2.893768e-02 1 1  ON 1
 uu_2                -6.450260e-02 1 1  ON 2
 uu_3                -1.201203e-01 1 1  ON 3
 uu_4                -1.563382e-01 1 1  ON 4
 uu_5                -1.683491e-01 1 1  ON 5
 uu_6                -1.558664e-01 1 1  ON 6
 uu_7                -1.088081e-01 1 1  ON 7
 uu_8                -3.891537e-02 1 1  ON 8
 uu_9                 2.016221e-01 1 1  ON 9
 ud_0                 3.486687e-01 1 1  ON 10
 ud_1                 9.353009e-02 1 1  ON 11
 ud_2                -1.124589e-02 1 1  ON 12
 ud_3                -7.119536e-02 1 1  ON 13
 ud_4                -1.230748e-01 1 1  ON 14
 ud_5                -1.633767e-01 1 1  ON 15
 ud_6                -1.784748e-01 1 1  ON 16
 ud_7                -1.584592e-01 1 1  ON 17
 ud_8                -1.109501e-01 1 1  ON 18
 ud_9                 3.268198e-02 1 1  ON 19
 eO_0                -9.078451e-01 1 1  ON 20
 eO_1                -5.925083e-01 1 1  ON 21
 eO_2                -1.894994e-01 1 1  ON 22
 eO_3                 7.673778e-02 1 1  ON 23
 eO_4                 2.046683e-01 1 1  ON 24
 eO_5                 2.984462e-01 1 1  ON 25
 eO_6                 3.263180e-01 1 1  ON 26
 eO_7                 5.333367e-01 1 1  ON 27
 eO_8                 1.578933e-01 1 1  ON 28
 eO_9                 5.324221e-02 1 1  ON 29
eH1_0                -2.212519e-01 1 1  ON 30
eH1_1                -1.428706e-01 1 1  ON 31
eH1_2                -1.021547e-01 1 1  ON 32
eH1_3                -6.521099e-02 1 1  ON 33
eH1_4                -1.851973e-02 1 1  ON 34
eH1_5                -5.093591e-03 1 1  ON 35
eH1_6                 3.557817e-02 1 1  ON 36
eH1_7                 7.994435e-02 1 1  ON 37
eH1_8                 2.645955e-01 1 1  ON 38
eH1_9                 1.134699e-01 1 1  ON 39
eH2_0                -2.099330e-01 1 1  ON 40
eH2_1                -1.315371e-01 1 1  ON 41
eH2_2                -9.083068e-02 1 1  ON 42
eH2_3                -5.369731e-02 1 1  ON 43
eH2_4                -7.097202e-03 1 1  ON 44
eH2_5                 5.519119e-03 1 1  ON 45
eH2_6                 4.814502e-02 1 1  ON 46
eH2_7                 3.878944e-02 1 1  ON 47
eH2_8                 2.482041e-01 1 1  ON 48
eH2_9                 1.153512e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.230485
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1686e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906432803
                                         uncertainty =       0.003810976084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906432803
                                         uncertainty =       0.003810976084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398032262
  error estimate for blocks of size 2^( 2) =       0.000407410578
  error estimate for blocks of size 2^( 3) =       0.000416056244
  error estimate for blocks of size 2^( 4) =       0.000421988274
  error estimate for blocks of size 2^( 5) =       0.000426119582
  error estimate for blocks of size 2^( 6) =       0.000428980378
  error estimate for blocks of size 2^( 7) =       0.000429422813

      target function =                  N/A
              le_mean =     -17.215705423590
             les_mean =     296.697372436150
             stat err =       0.000426627762
             autocorr =       1.148845630059
              std dev =       0.562902622813
             le_variance =       0.316859362769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570542359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215705423590       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215705258964       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215705004440       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215705123994       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215705404241       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215705438727       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215705420273       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.457632e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215705423590       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215705375759       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215705294610       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215705320009       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215705405659       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215705407742       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215705400590       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 3.844637e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215705423590       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215705411127       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215705389306       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215705395166       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215705417554       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215705417463       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215705415446       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 9.951966e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5881e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.906524e-01 1 1  ON 0
 uu_1                 2.896343e-02 1 1  ON 1
 uu_2                -6.451684e-02 1 1  ON 2
 uu_3                -1.201277e-01 1 1  ON 3
 uu_4                -1.563176e-01 1 1  ON 4
 uu_5                -1.683487e-01 1 1  ON 5
 uu_6                -1.558997e-01 1 1  ON 6
 uu_7                -1.088245e-01 1 1  ON 7
 uu_8                -3.891596e-02 1 1  ON 8
 uu_9                 2.016161e-01 1 1  ON 9
 ud_0                 3.486610e-01 1 1  ON 10
 ud_1                 9.354774e-02 1 1  ON 11
 ud_2                -1.123778e-02 1 1  ON 12
 ud_3                -7.118704e-02 1 1  ON 13
 ud_4                -1.230579e-01 1 1  ON 14
 ud_5                -1.633803e-01 1 1  ON 15
 ud_6                -1.785132e-01 1 1  ON 16
 ud_7                -1.584780e-01 1 1  ON 17
 ud_8                -1.109444e-01 1 1  ON 18
 ud_9                 3.268035e-02 1 1  ON 19
 eO_0                -9.078520e-01 1 1  ON 20
 eO_1                -5.925298e-01 1 1  ON 21
 eO_2                -1.894733e-01 1 1  ON 22
 eO_3                 7.674315e-02 1 1  ON 23
 eO_4                 2.046794e-01 1 1  ON 24
 eO_5                 2.984372e-01 1 1  ON 25
 eO_6                 3.263091e-01 1 1  ON 26
 eO_7                 5.333294e-01 1 1  ON 27
 eO_8                 1.578994e-01 1 1  ON 28
 eO_9                 5.324465e-02 1 1  ON 29
eH1_0                -2.212635e-01 1 1  ON 30
eH1_1                -1.428796e-01 1 1  ON 31
eH1_2                -1.021302e-01 1 1  ON 32
eH1_3                -6.519409e-02 1 1  ON 33
eH1_4                -1.851703e-02 1 1  ON 34
eH1_5                -5.096585e-03 1 1  ON 35
eH1_6                 3.557565e-02 1 1  ON 36
eH1_7                 7.992528e-02 1 1  ON 37
eH1_8                 2.645895e-01 1 1  ON 38
eH1_9                 1.134733e-01 1 1  ON 39
eH2_0                -2.099478e-01 1 1  ON 40
eH2_1                -1.315553e-01 1 1  ON 41
eH2_2                -9.079274e-02 1 1  ON 42
eH2_3                -5.368577e-02 1 1  ON 43
eH2_4                -7.109827e-03 1 1  ON 44
eH2_5                 5.505454e-03 1 1  ON 45
eH2_6                 4.814586e-02 1 1  ON 46
eH2_7                 3.879645e-02 1 1  ON 47
eH2_8                 2.482009e-01 1 1  ON 48
eH2_9                 1.153533e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.262581
====================================================
  Execution time = 2.2102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2605e-01
  Total weights = 2.0000e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326182641381
                                         uncertainty =       0.003952597775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326182641381
                                         uncertainty =       0.003952597775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403772512
  error estimate for blocks of size 2^( 2) =       0.000413125882
  error estimate for blocks of size 2^( 3) =       0.000420996906
  error estimate for blocks of size 2^( 4) =       0.000427244137
  error estimate for blocks of size 2^( 5) =       0.000429571681
  error estimate for blocks of size 2^( 6) =       0.000431217952
  error estimate for blocks of size 2^( 7) =       0.000433286765

      target function =                  N/A
              le_mean =     -17.215720242434
             les_mean =     296.707087785994
             stat err =       0.000430330134
             autocorr =       1.135873629325
              std dev =       0.571020562932
             le_variance =       0.326064483291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326143745895
                                         uncertainty =       0.003952602747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326143745895
                                         uncertainty =       0.003952602747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748439
  error estimate for blocks of size 2^( 2) =       0.000413103156
  error estimate for blocks of size 2^( 3) =       0.000420975489
  error estimate for blocks of size 2^( 4) =       0.000427223509
  error estimate for blocks of size 2^( 5) =       0.000429553586
  error estimate for blocks of size 2^( 6) =       0.000431202276
  error estimate for blocks of size 2^( 7) =       0.000433269034

      target function =                  N/A
              le_mean =     -17.215720830192
             les_mean =     296.707069144280
             stat err =       0.000430312101
             autocorr =       1.135913879282
              std dev =       0.570986518384
             le_variance =       0.326025604176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326155763573
                                         uncertainty =       0.003952552926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326155763573
                                         uncertainty =       0.003952552926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403755879
  error estimate for blocks of size 2^( 2) =       0.000413110182
  error estimate for blocks of size 2^( 3) =       0.000420982046
  error estimate for blocks of size 2^( 4) =       0.000427229725
  error estimate for blocks of size 2^( 5) =       0.000429558898
  error estimate for blocks of size 2^( 6) =       0.000431206785
  error estimate for blocks of size 2^( 7) =       0.000433274272

      target function =                  N/A
              le_mean =     -17.215720584448
             les_mean =     296.707072697698
             stat err =       0.000430317420
             autocorr =       1.135900100303
              std dev =       0.570997039326
             le_variance =       0.326037618919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326178942226
                                         uncertainty =       0.003952590119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326178942226
                                         uncertainty =       0.003952590119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403770223
  error estimate for blocks of size 2^( 2) =       0.000413123719
  error estimate for blocks of size 2^( 3) =       0.000420994855
  error estimate for blocks of size 2^( 4) =       0.000427242143
  error estimate for blocks of size 2^( 5) =       0.000429569907
  error estimate for blocks of size 2^( 6) =       0.000431216397
  error estimate for blocks of size 2^( 7) =       0.000433285030

      target function =                  N/A
              le_mean =     -17.215720283982
             les_mean =     296.707085519350
             stat err =       0.000430328369
             autocorr =       1.135877193345
              std dev =       0.571017325534
             le_variance =       0.326060786060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215720242434        initial
     9.0949e-01     9.0949e+00             1.4576e-04       -17.215720830192  <--
     3.6380e+00     3.6380e+01             3.8446e-05       -17.215720584448
     1.4552e+01     1.4552e+02             9.9520e-06       -17.215720283982

*****************************************************************************
Applying the update for shift_i =   9.0949e-01     and shift_s =   9.0949e+00
*****************************************************************************

  Execution time = 3.1315e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.906895e-01 1 1  ON 0
 uu_1                 2.901761e-02 1 1  ON 1
 uu_2                -6.453992e-02 1 1  ON 2
 uu_3                -1.201449e-01 1 1  ON 3
 uu_4                -1.562723e-01 1 1  ON 4
 uu_5                -1.683375e-01 1 1  ON 5
 uu_6                -1.559905e-01 1 1  ON 6
 uu_7                -1.088719e-01 1 1  ON 7
 uu_8                -3.891836e-02 1 1  ON 8
 uu_9                 2.015996e-01 1 1  ON 9
 ud_0                 3.486549e-01 1 1  ON 10
 ud_1                 9.358715e-02 1 1  ON 11
 ud_2                -1.121615e-02 1 1  ON 12
 ud_3                -7.116190e-02 1 1  ON 13
 ud_4                -1.230197e-01 1 1  ON 14
 ud_5                -1.633831e-01 1 1  ON 15
 ud_6                -1.786205e-01 1 1  ON 16
 ud_7                -1.585333e-01 1 1  ON 17
 ud_8                -1.109298e-01 1 1  ON 18
 ud_9                 3.267570e-02 1 1  ON 19
 eO_0                -9.078755e-01 1 1  ON 20
 eO_1                -5.925756e-01 1 1  ON 21
 eO_2                -1.894135e-01 1 1  ON 22
 eO_3                 7.676001e-02 1 1  ON 23
 eO_4                 2.047135e-01 1 1  ON 24
 eO_5                 2.984119e-01 1 1  ON 25
 eO_6                 3.262834e-01 1 1  ON 26
 eO_7                 5.333091e-01 1 1  ON 27
 eO_8                 1.579161e-01 1 1  ON 28
 eO_9                 5.325131e-02 1 1  ON 29
eH1_0                -2.212969e-01 1 1  ON 30
eH1_1                -1.428992e-01 1 1  ON 31
eH1_2                -1.020656e-01 1 1  ON 32
eH1_3                -6.514821e-02 1 1  ON 33
eH1_4                -1.850932e-02 1 1  ON 34
eH1_5                -5.103686e-03 1 1  ON 35
eH1_6                 3.556808e-02 1 1  ON 36
eH1_7                 7.987248e-02 1 1  ON 37
eH1_8                 2.645728e-01 1 1  ON 38
eH1_9                 1.134826e-01 1 1  ON 39
eH2_0                -2.099891e-01 1 1  ON 40
eH2_1                -1.315924e-01 1 1  ON 41
eH2_2                -9.070219e-02 1 1  ON 42
eH2_3                -5.365062e-02 1 1  ON 43
eH2_4                -7.142172e-03 1 1  ON 44
eH2_5                 5.466077e-03 1 1  ON 45
eH2_6                 4.814681e-02 1 1  ON 46
eH2_7                 3.881478e-02 1 1  ON 47
eH2_8                 2.481921e-01 1 1  ON 48
eH2_9                 1.153591e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3085
    reference variance = 0.307658
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2637e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326400391650
                                         uncertainty =       0.004714290682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326400391650
                                         uncertainty =       0.004714290682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403959257
  error estimate for blocks of size 2^( 2) =       0.000412782024
  error estimate for blocks of size 2^( 3) =       0.000420791639
  error estimate for blocks of size 2^( 4) =       0.000427010149
  error estimate for blocks of size 2^( 5) =       0.000431636952
  error estimate for blocks of size 2^( 6) =       0.000433992416
  error estimate for blocks of size 2^( 7) =       0.000434380050

      target function =                  N/A
              le_mean =     -17.216168845663
             les_mean =     296.722835721534
             stat err =       0.000431754892
             autocorr =       1.142350575285
              std dev =       0.571284659655
             le_variance =       0.326366162357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616884566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e-01, overlap shift 2.2737e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216168845663       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216168773213       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216168291643       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216168089783       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216167939501       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216167554972       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216167919271       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216167977352       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e-01 is 2.417634e-04

solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216168845663       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216168812000       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216168663630       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216168504784       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216168381522       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216168261276       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216168324056       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 6.956163e-05

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216168845663       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216168834947       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216168796025       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216168741596       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216168684681       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216168651999       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 2.347913e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6144e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.907114e-01 1 1  ON 0
 uu_1                 2.902470e-02 1 1  ON 1
 uu_2                -6.456711e-02 1 1  ON 2
 uu_3                -1.201295e-01 1 1  ON 3
 uu_4                -1.562468e-01 1 1  ON 4
 uu_5                -1.683959e-01 1 1  ON 5
 uu_6                -1.559923e-01 1 1  ON 6
 uu_7                -1.088707e-01 1 1  ON 7
 uu_8                -3.892661e-02 1 1  ON 8
 uu_9                 2.015768e-01 1 1  ON 9
 ud_0                 3.487126e-01 1 1  ON 10
 ud_1                 9.352725e-02 1 1  ON 11
 ud_2                -1.118836e-02 1 1  ON 12
 ud_3                -7.117068e-02 1 1  ON 13
 ud_4                -1.229989e-01 1 1  ON 14
 ud_5                -1.634172e-01 1 1  ON 15
 ud_6                -1.786649e-01 1 1  ON 16
 ud_7                -1.585238e-01 1 1  ON 17
 ud_8                -1.109148e-01 1 1  ON 18
 ud_9                 3.266345e-02 1 1  ON 19
 eO_0                -9.078457e-01 1 1  ON 20
 eO_1                -5.925937e-01 1 1  ON 21
 eO_2                -1.893841e-01 1 1  ON 22
 eO_3                 7.670191e-02 1 1  ON 23
 eO_4                 2.047621e-01 1 1  ON 24
 eO_5                 2.983857e-01 1 1  ON 25
 eO_6                 3.262754e-01 1 1  ON 26
 eO_7                 5.332882e-01 1 1  ON 27
 eO_8                 1.579286e-01 1 1  ON 28
 eO_9                 5.325630e-02 1 1  ON 29
eH1_0                -2.213162e-01 1 1  ON 30
eH1_1                -1.428562e-01 1 1  ON 31
eH1_2                -1.020127e-01 1 1  ON 32
eH1_3                -6.517615e-02 1 1  ON 33
eH1_4                -1.855012e-02 1 1  ON 34
eH1_5                -5.096936e-03 1 1  ON 35
eH1_6                 3.562201e-02 1 1  ON 36
eH1_7                 7.982051e-02 1 1  ON 37
eH1_8                 2.645448e-01 1 1  ON 38
eH1_9                 1.134879e-01 1 1  ON 39
eH2_0                -2.099548e-01 1 1  ON 40
eH2_1                -1.315406e-01 1 1  ON 41
eH2_2                -9.072049e-02 1 1  ON 42
eH2_3                -5.371508e-02 1 1  ON 43
eH2_4                -7.211734e-03 1 1  ON 44
eH2_5                 5.470000e-03 1 1  ON 45
eH2_6                 4.817258e-02 1 1  ON 46
eH2_7                 3.886402e-02 1 1  ON 47
eH2_8                 2.481683e-01 1 1  ON 48
eH2_9                 1.153591e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2356
    reference variance = 0.167975
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2171e-01
  Total weights = 2.0000e+06
  Execution time = 1.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321765182490
                                         uncertainty =       0.003769826273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321765182490
                                         uncertainty =       0.003769826273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401036420
  error estimate for blocks of size 2^( 2) =       0.000410510988
  error estimate for blocks of size 2^( 3) =       0.000418699811
  error estimate for blocks of size 2^( 4) =       0.000424349642
  error estimate for blocks of size 2^( 5) =       0.000427064145
  error estimate for blocks of size 2^( 6) =       0.000428570307
  error estimate for blocks of size 2^( 7) =       0.000430583981

      target function =                  N/A
              le_mean =     -17.216569502002
             les_mean =     296.731925676386
             stat err =       0.000427642019
             autocorr =       1.137085478715
              std dev =       0.567151143848
             le_variance =       0.321660419968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321826426117
                                         uncertainty =       0.003771118793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321826426117
                                         uncertainty =       0.003771118793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401074543
  error estimate for blocks of size 2^( 2) =       0.000410550620
  error estimate for blocks of size 2^( 3) =       0.000418739543
  error estimate for blocks of size 2^( 4) =       0.000424391292
  error estimate for blocks of size 2^( 5) =       0.000427105054
  error estimate for blocks of size 2^( 6) =       0.000428612330
  error estimate for blocks of size 2^( 7) =       0.000430627827

      target function =                  N/A
              le_mean =     -17.216568650717
             les_mean =     296.731957521813
             stat err =       0.000427684126
             autocorr =       1.137093213493
              std dev =       0.567205058002
             le_variance =       0.321721577823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321874514869
                                         uncertainty =       0.003771941690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321874514869
                                         uncertainty =       0.003771941690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401104511
  error estimate for blocks of size 2^( 2) =       0.000410579096
  error estimate for blocks of size 2^( 3) =       0.000418766684
  error estimate for blocks of size 2^( 4) =       0.000424417539
  error estimate for blocks of size 2^( 5) =       0.000427130328
  error estimate for blocks of size 2^( 6) =       0.000428636931
  error estimate for blocks of size 2^( 7) =       0.000430653887

      target function =                  N/A
              le_mean =     -17.216568424973
             les_mean =     296.731997827700
             stat err =       0.000427709671
             autocorr =       1.137059129547
              std dev =       0.567247438777
             le_variance =       0.321769656799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321783743362
                                         uncertainty =       0.003770201197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321783743362
                                         uncertainty =       0.003770201197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401047980
  error estimate for blocks of size 2^( 2) =       0.000410522538
  error estimate for blocks of size 2^( 3) =       0.000418711144
  error estimate for blocks of size 2^( 4) =       0.000424361209
  error estimate for blocks of size 2^( 5) =       0.000427075384
  error estimate for blocks of size 2^( 6) =       0.000428581607
  error estimate for blocks of size 2^( 7) =       0.000430595999

      target function =                  N/A
              le_mean =     -17.216569316121
             les_mean =     296.731937821233
             stat err =       0.000427653550
             autocorr =       1.137081240607
              std dev =       0.567167493150
             le_variance =       0.321678965286


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216569502002        initial  <--
     2.2737e-01     2.2737e+00             2.4176e-04       -17.216568650717
     9.0949e-01     9.0949e+00             6.9562e-05       -17.216568424973
     3.6380e+00     3.6380e+01             2.3479e-05       -17.216569316121

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3645
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.906895e-01 1 1  ON 0
 uu_1                 2.901761e-02 1 1  ON 1
 uu_2                -6.453992e-02 1 1  ON 2
 uu_3                -1.201449e-01 1 1  ON 3
 uu_4                -1.562723e-01 1 1  ON 4
 uu_5                -1.683375e-01 1 1  ON 5
 uu_6                -1.559905e-01 1 1  ON 6
 uu_7                -1.088719e-01 1 1  ON 7
 uu_8                -3.891836e-02 1 1  ON 8
 uu_9                 2.015996e-01 1 1  ON 9
 ud_0                 3.486549e-01 1 1  ON 10
 ud_1                 9.358715e-02 1 1  ON 11
 ud_2                -1.121615e-02 1 1  ON 12
 ud_3                -7.116190e-02 1 1  ON 13
 ud_4                -1.230197e-01 1 1  ON 14
 ud_5                -1.633831e-01 1 1  ON 15
 ud_6                -1.786205e-01 1 1  ON 16
 ud_7                -1.585333e-01 1 1  ON 17
 ud_8                -1.109298e-01 1 1  ON 18
 ud_9                 3.267570e-02 1 1  ON 19
 eO_0                -9.078755e-01 1 1  ON 20
 eO_1                -5.925756e-01 1 1  ON 21
 eO_2                -1.894135e-01 1 1  ON 22
 eO_3                 7.676001e-02 1 1  ON 23
 eO_4                 2.047135e-01 1 1  ON 24
 eO_5                 2.984119e-01 1 1  ON 25
 eO_6                 3.262834e-01 1 1  ON 26
 eO_7                 5.333091e-01 1 1  ON 27
 eO_8                 1.579161e-01 1 1  ON 28
 eO_9                 5.325131e-02 1 1  ON 29
eH1_0                -2.212969e-01 1 1  ON 30
eH1_1                -1.428992e-01 1 1  ON 31
eH1_2                -1.020656e-01 1 1  ON 32
eH1_3                -6.514821e-02 1 1  ON 33
eH1_4                -1.850932e-02 1 1  ON 34
eH1_5                -5.103686e-03 1 1  ON 35
eH1_6                 3.556808e-02 1 1  ON 36
eH1_7                 7.987248e-02 1 1  ON 37
eH1_8                 2.645728e-01 1 1  ON 38
eH1_9                 1.134826e-01 1 1  ON 39
eH2_0                -2.099891e-01 1 1  ON 40
eH2_1                -1.315924e-01 1 1  ON 41
eH2_2                -9.070219e-02 1 1  ON 42
eH2_3                -5.365062e-02 1 1  ON 43
eH2_4                -7.142172e-03 1 1  ON 44
eH2_5                 5.466077e-03 1 1  ON 45
eH2_6                 4.814681e-02 1 1  ON 46
eH2_7                 3.881478e-02 1 1  ON 47
eH2_8                 2.481921e-01 1 1  ON 48
eH2_9                 1.153591e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2918
    reference variance = 1.24221
====================================================
  Execution time = 2.0485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322645280575
                                         uncertainty =       0.004805316251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322645280575
                                         uncertainty =       0.004805316251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401635056
  error estimate for blocks of size 2^( 2) =       0.000411214555
  error estimate for blocks of size 2^( 3) =       0.000419741878
  error estimate for blocks of size 2^( 4) =       0.000425992153
  error estimate for blocks of size 2^( 5) =       0.000429532540
  error estimate for blocks of size 2^( 6) =       0.000430905587
  error estimate for blocks of size 2^( 7) =       0.000432152860

      target function =                  N/A
              le_mean =     -17.216110551662
             les_mean =     296.717083801619
             stat err =       0.000429645785
             autocorr =       1.144347398805
              std dev =       0.567997742860
             le_variance =       0.322621435894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611055166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216110551662       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216110604757       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216110656136       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216110921181       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216110862096       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216110902985       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+00 is 4.683281e-05

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216110551662       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216110565785       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216110578109       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216110655835       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216110647806       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216110652717       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 1.241095e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216110551662       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216110555250       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216110558295       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216110578581       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216110577186       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216110577961       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 3.150926e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.438332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6037e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.906887e-01 1 1  ON 0
 uu_1                 2.902219e-02 1 1  ON 1
 uu_2                -6.454297e-02 1 1  ON 2
 uu_3                -1.201439e-01 1 1  ON 3
 uu_4                -1.562758e-01 1 1  ON 4
 uu_5                -1.683482e-01 1 1  ON 5
 uu_6                -1.559882e-01 1 1  ON 6
 uu_7                -1.088696e-01 1 1  ON 7
 uu_8                -3.891410e-02 1 1  ON 8
 uu_9                 2.015981e-01 1 1  ON 9
 ud_0                 3.486603e-01 1 1  ON 10
 ud_1                 9.357655e-02 1 1  ON 11
 ud_2                -1.121666e-02 1 1  ON 12
 ud_3                -7.117351e-02 1 1  ON 13
 ud_4                -1.230130e-01 1 1  ON 14
 ud_5                -1.633882e-01 1 1  ON 15
 ud_6                -1.786141e-01 1 1  ON 16
 ud_7                -1.585286e-01 1 1  ON 17
 ud_8                -1.109284e-01 1 1  ON 18
 ud_9                 3.267471e-02 1 1  ON 19
 eO_0                -9.078707e-01 1 1  ON 20
 eO_1                -5.925799e-01 1 1  ON 21
 eO_2                -1.894100e-01 1 1  ON 22
 eO_3                 7.675342e-02 1 1  ON 23
 eO_4                 2.047108e-01 1 1  ON 24
 eO_5                 2.984121e-01 1 1  ON 25
 eO_6                 3.262860e-01 1 1  ON 26
 eO_7                 5.333073e-01 1 1  ON 27
 eO_8                 1.579189e-01 1 1  ON 28
 eO_9                 5.325222e-02 1 1  ON 29
eH1_0                -2.212845e-01 1 1  ON 30
eH1_1                -1.429086e-01 1 1  ON 31
eH1_2                -1.020622e-01 1 1  ON 32
eH1_3                -6.514894e-02 1 1  ON 33
eH1_4                -1.851139e-02 1 1  ON 34
eH1_5                -5.100920e-03 1 1  ON 35
eH1_6                 3.556460e-02 1 1  ON 36
eH1_7                 7.986824e-02 1 1  ON 37
eH1_8                 2.645719e-01 1 1  ON 38
eH1_9                 1.134841e-01 1 1  ON 39
eH2_0                -2.099961e-01 1 1  ON 40
eH2_1                -1.315893e-01 1 1  ON 41
eH2_2                -9.069187e-02 1 1  ON 42
eH2_3                -5.365102e-02 1 1  ON 43
eH2_4                -7.140243e-03 1 1  ON 44
eH2_5                 5.456560e-03 1 1  ON 45
eH2_6                 4.814118e-02 1 1  ON 46
eH2_7                 3.882121e-02 1 1  ON 47
eH2_8                 2.481911e-01 1 1  ON 48
eH2_9                 1.153597e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.224072
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1752e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317581602163
                                         uncertainty =       0.002517312772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317581602163
                                         uncertainty =       0.002517312772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398442721
  error estimate for blocks of size 2^( 2) =       0.000408099423
  error estimate for blocks of size 2^( 3) =       0.000415867263
  error estimate for blocks of size 2^( 4) =       0.000422523046
  error estimate for blocks of size 2^( 5) =       0.000426320772
  error estimate for blocks of size 2^( 6) =       0.000428516845
  error estimate for blocks of size 2^( 7) =       0.000431255414

      target function =                  N/A
              le_mean =     -17.215715620916
             les_mean =     296.698377384947
             stat err =       0.000427154019
             autocorr =       1.149310038421
              std dev =       0.563483099524
             le_variance =       0.317513203449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317605374005
                                         uncertainty =       0.002517663650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317605374005
                                         uncertainty =       0.002517663650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398457644
  error estimate for blocks of size 2^( 2) =       0.000408113509
  error estimate for blocks of size 2^( 3) =       0.000415881089
  error estimate for blocks of size 2^( 4) =       0.000422536852
  error estimate for blocks of size 2^( 5) =       0.000426334477
  error estimate for blocks of size 2^( 6) =       0.000428530827
  error estimate for blocks of size 2^( 7) =       0.000431269816

      target function =                  N/A
              le_mean =     -17.215715607778
             les_mean =     296.698400717909
             stat err =       0.000427167993
             autocorr =       1.149299139460
              std dev =       0.563504204759
             le_variance =       0.317536988782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317595232975
                                         uncertainty =       0.002517513336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317595232975
                                         uncertainty =       0.002517513336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398451278
  error estimate for blocks of size 2^( 2) =       0.000408107516
  error estimate for blocks of size 2^( 3) =       0.000415875211
  error estimate for blocks of size 2^( 4) =       0.000422530979
  error estimate for blocks of size 2^( 5) =       0.000426328619
  error estimate for blocks of size 2^( 6) =       0.000428524862
  error estimate for blocks of size 2^( 7) =       0.000431263678

      target function =                  N/A
              le_mean =     -17.215715608659
             les_mean =     296.698390601160
             stat err =       0.000427162035
             autocorr =       1.149303805347
              std dev =       0.563495201144
             le_variance =       0.317526841712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583368143
                                         uncertainty =       0.002517338798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583368143
                                         uncertainty =       0.002517338798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398443829
  error estimate for blocks of size 2^( 2) =       0.000408100472
  error estimate for blocks of size 2^( 3) =       0.000415868293
  error estimate for blocks of size 2^( 4) =       0.000422524074
  error estimate for blocks of size 2^( 5) =       0.000426321788
  error estimate for blocks of size 2^( 6) =       0.000428517883
  error estimate for blocks of size 2^( 7) =       0.000431256485

      target function =                  N/A
              le_mean =     -17.215715618810
             les_mean =     296.698379079354
             stat err =       0.000427155058
             autocorr =       1.149309230705
              std dev =       0.563484667393
             le_variance =       0.317514970387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215715620916        initial  <--
     2.2737e+00     2.2737e+01             4.6833e-05       -17.215715607778
     9.0949e+00     9.0949e+01             1.2411e-05       -17.215715608659
     3.6380e+01     3.6380e+02             3.1509e-06       -17.215715618810

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4418
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.906895e-01 1 1  ON 0
 uu_1                 2.901761e-02 1 1  ON 1
 uu_2                -6.453992e-02 1 1  ON 2
 uu_3                -1.201449e-01 1 1  ON 3
 uu_4                -1.562723e-01 1 1  ON 4
 uu_5                -1.683375e-01 1 1  ON 5
 uu_6                -1.559905e-01 1 1  ON 6
 uu_7                -1.088719e-01 1 1  ON 7
 uu_8                -3.891836e-02 1 1  ON 8
 uu_9                 2.015996e-01 1 1  ON 9
 ud_0                 3.486549e-01 1 1  ON 10
 ud_1                 9.358715e-02 1 1  ON 11
 ud_2                -1.121615e-02 1 1  ON 12
 ud_3                -7.116190e-02 1 1  ON 13
 ud_4                -1.230197e-01 1 1  ON 14
 ud_5                -1.633831e-01 1 1  ON 15
 ud_6                -1.786205e-01 1 1  ON 16
 ud_7                -1.585333e-01 1 1  ON 17
 ud_8                -1.109298e-01 1 1  ON 18
 ud_9                 3.267570e-02 1 1  ON 19
 eO_0                -9.078755e-01 1 1  ON 20
 eO_1                -5.925756e-01 1 1  ON 21
 eO_2                -1.894135e-01 1 1  ON 22
 eO_3                 7.676001e-02 1 1  ON 23
 eO_4                 2.047135e-01 1 1  ON 24
 eO_5                 2.984119e-01 1 1  ON 25
 eO_6                 3.262834e-01 1 1  ON 26
 eO_7                 5.333091e-01 1 1  ON 27
 eO_8                 1.579161e-01 1 1  ON 28
 eO_9                 5.325131e-02 1 1  ON 29
eH1_0                -2.212969e-01 1 1  ON 30
eH1_1                -1.428992e-01 1 1  ON 31
eH1_2                -1.020656e-01 1 1  ON 32
eH1_3                -6.514821e-02 1 1  ON 33
eH1_4                -1.850932e-02 1 1  ON 34
eH1_5                -5.103686e-03 1 1  ON 35
eH1_6                 3.556808e-02 1 1  ON 36
eH1_7                 7.987248e-02 1 1  ON 37
eH1_8                 2.645728e-01 1 1  ON 38
eH1_9                 1.134826e-01 1 1  ON 39
eH2_0                -2.099891e-01 1 1  ON 40
eH2_1                -1.315924e-01 1 1  ON 41
eH2_2                -9.070219e-02 1 1  ON 42
eH2_3                -5.365062e-02 1 1  ON 43
eH2_4                -7.142172e-03 1 1  ON 44
eH2_5                 5.466077e-03 1 1  ON 45
eH2_6                 4.814681e-02 1 1  ON 46
eH2_7                 3.881478e-02 1 1  ON 47
eH2_8                 2.481921e-01 1 1  ON 48
eH2_9                 1.153591e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5484e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1695
    reference variance = 0.198511
====================================================
  Execution time = 2.0295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328541220636
                                         uncertainty =       0.008072080892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328541220636
                                         uncertainty =       0.008072080892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405242898
  error estimate for blocks of size 2^( 2) =       0.000414656911
  error estimate for blocks of size 2^( 3) =       0.000422757437
  error estimate for blocks of size 2^( 4) =       0.000428999837
  error estimate for blocks of size 2^( 5) =       0.000433045820
  error estimate for blocks of size 2^( 6) =       0.000435169453
  error estimate for blocks of size 2^( 7) =       0.000437698038

      target function =                  N/A
              le_mean =     -17.216506573716
             les_mean =     296.736542051741
             stat err =       0.000433728287
             autocorr =       1.145525254949
              std dev =       0.573100002742
             le_variance =       0.328443613143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650657372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506573716       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506566416       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506547578       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506549607       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506570635       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506574144       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 1.015115e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506573716       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506571872       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506567104       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506567526       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506572807       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506573710       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.581782e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506573716       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506573254       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506572058       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506572158       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506573480       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506573707       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 6.482574e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.440259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5852e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.906906e-01 1 1  ON 0
 uu_1                 2.901800e-02 1 1  ON 1
 uu_2                -6.454008e-02 1 1  ON 2
 uu_3                -1.201441e-01 1 1  ON 3
 uu_4                -1.562726e-01 1 1  ON 4
 uu_5                -1.683389e-01 1 1  ON 5
 uu_6                -1.559913e-01 1 1  ON 6
 uu_7                -1.088720e-01 1 1  ON 7
 uu_8                -3.891813e-02 1 1  ON 8
 uu_9                 2.015995e-01 1 1  ON 9
 ud_0                 3.486575e-01 1 1  ON 10
 ud_1                 9.358570e-02 1 1  ON 11
 ud_2                -1.121622e-02 1 1  ON 12
 ud_3                -7.116259e-02 1 1  ON 13
 ud_4                -1.230204e-01 1 1  ON 14
 ud_5                -1.633823e-01 1 1  ON 15
 ud_6                -1.786205e-01 1 1  ON 16
 ud_7                -1.585338e-01 1 1  ON 17
 ud_8                -1.109300e-01 1 1  ON 18
 ud_9                 3.267546e-02 1 1  ON 19
 eO_0                -9.078734e-01 1 1  ON 20
 eO_1                -5.925762e-01 1 1  ON 21
 eO_2                -1.894150e-01 1 1  ON 22
 eO_3                 7.676026e-02 1 1  ON 23
 eO_4                 2.047133e-01 1 1  ON 24
 eO_5                 2.984118e-01 1 1  ON 25
 eO_6                 3.262836e-01 1 1  ON 26
 eO_7                 5.333088e-01 1 1  ON 27
 eO_8                 1.579163e-01 1 1  ON 28
 eO_9                 5.325136e-02 1 1  ON 29
eH1_0                -2.212965e-01 1 1  ON 30
eH1_1                -1.428998e-01 1 1  ON 31
eH1_2                -1.020664e-01 1 1  ON 32
eH1_3                -6.514765e-02 1 1  ON 33
eH1_4                -1.850877e-02 1 1  ON 34
eH1_5                -5.103493e-03 1 1  ON 35
eH1_6                 3.556819e-02 1 1  ON 36
eH1_7                 7.987216e-02 1 1  ON 37
eH1_8                 2.645725e-01 1 1  ON 38
eH1_9                 1.134826e-01 1 1  ON 39
eH2_0                -2.099896e-01 1 1  ON 40
eH2_1                -1.315934e-01 1 1  ON 41
eH2_2                -9.070156e-02 1 1  ON 42
eH2_3                -5.365098e-02 1 1  ON 43
eH2_4                -7.141984e-03 1 1  ON 44
eH2_5                 5.466373e-03 1 1  ON 45
eH2_6                 4.814675e-02 1 1  ON 46
eH2_7                 3.881539e-02 1 1  ON 47
eH2_8                 2.481921e-01 1 1  ON 48
eH2_9                 1.153592e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1817
    reference variance = 0.231895
====================================================
  Execution time = 2.0048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3121e-01
  Total weights = 2.0000e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331273756514
                                         uncertainty =       0.005697316738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331273756514
                                         uncertainty =       0.005697316738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406947167
  error estimate for blocks of size 2^( 2) =       0.000416044234
  error estimate for blocks of size 2^( 3) =       0.000424236416
  error estimate for blocks of size 2^( 4) =       0.000430398876
  error estimate for blocks of size 2^( 5) =       0.000434514228
  error estimate for blocks of size 2^( 6) =       0.000437412403
  error estimate for blocks of size 2^( 7) =       0.000438001217

      target function =                  N/A
              le_mean =     -17.216020957134
             les_mean =     296.722589424731
             stat err =       0.000435081681
             autocorr =       1.143050810926
              std dev =       0.575510203085
             le_variance =       0.331211993855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331283389393
                                         uncertainty =       0.005697375476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331283389393
                                         uncertainty =       0.005697375476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406953084
  error estimate for blocks of size 2^( 2) =       0.000416049853
  error estimate for blocks of size 2^( 3) =       0.000424241923
  error estimate for blocks of size 2^( 4) =       0.000430404266
  error estimate for blocks of size 2^( 5) =       0.000434519497
  error estimate for blocks of size 2^( 6) =       0.000437417497
  error estimate for blocks of size 2^( 7) =       0.000438006353

      target function =                  N/A
              le_mean =     -17.216020938332
             les_mean =     296.722598409265
             stat err =       0.000435086903
             autocorr =       1.143045010453
              std dev =       0.575518571189
             le_variance =       0.331221625784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331278659802
                                         uncertainty =       0.005697346929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331278659802
                                         uncertainty =       0.005697346929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406950179
  error estimate for blocks of size 2^( 2) =       0.000416047094
  error estimate for blocks of size 2^( 3) =       0.000424239220
  error estimate for blocks of size 2^( 4) =       0.000430401620
  error estimate for blocks of size 2^( 5) =       0.000434516910
  error estimate for blocks of size 2^( 6) =       0.000437414997
  error estimate for blocks of size 2^( 7) =       0.000438003832

      target function =                  N/A
              le_mean =     -17.216020947349
             les_mean =     296.722593990608
             stat err =       0.000435084339
             autocorr =       1.143047859866
              std dev =       0.575514462593
             le_variance =       0.331216896654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331274372110
                                         uncertainty =       0.005697320538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331274372110
                                         uncertainty =       0.005697320538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406947545
  error estimate for blocks of size 2^( 2) =       0.000416044593
  error estimate for blocks of size 2^( 3) =       0.000424236768
  error estimate for blocks of size 2^( 4) =       0.000430399220
  error estimate for blocks of size 2^( 5) =       0.000434514565
  error estimate for blocks of size 2^( 6) =       0.000437412729
  error estimate for blocks of size 2^( 7) =       0.000438001546

      target function =                  N/A
              le_mean =     -17.216020955890
             les_mean =     296.722589997419
             stat err =       0.000435082015
             autocorr =       1.143050440410
              std dev =       0.575510737857
             le_variance =       0.331212609389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216020957134        initial  <--
     2.2737e+01     2.2737e+02             1.0151e-05       -17.216020938332
     9.0949e+01     9.0949e+02             2.5818e-06       -17.216020947349
     3.6380e+02     3.6380e+03             6.4826e-07       -17.216020955890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2685
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.906895e-01 1 1  ON 0
 uu_1                 2.901761e-02 1 1  ON 1
 uu_2                -6.453992e-02 1 1  ON 2
 uu_3                -1.201449e-01 1 1  ON 3
 uu_4                -1.562723e-01 1 1  ON 4
 uu_5                -1.683375e-01 1 1  ON 5
 uu_6                -1.559905e-01 1 1  ON 6
 uu_7                -1.088719e-01 1 1  ON 7
 uu_8                -3.891836e-02 1 1  ON 8
 uu_9                 2.015996e-01 1 1  ON 9
 ud_0                 3.486549e-01 1 1  ON 10
 ud_1                 9.358715e-02 1 1  ON 11
 ud_2                -1.121615e-02 1 1  ON 12
 ud_3                -7.116190e-02 1 1  ON 13
 ud_4                -1.230197e-01 1 1  ON 14
 ud_5                -1.633831e-01 1 1  ON 15
 ud_6                -1.786205e-01 1 1  ON 16
 ud_7                -1.585333e-01 1 1  ON 17
 ud_8                -1.109298e-01 1 1  ON 18
 ud_9                 3.267570e-02 1 1  ON 19
 eO_0                -9.078755e-01 1 1  ON 20
 eO_1                -5.925756e-01 1 1  ON 21
 eO_2                -1.894135e-01 1 1  ON 22
 eO_3                 7.676001e-02 1 1  ON 23
 eO_4                 2.047135e-01 1 1  ON 24
 eO_5                 2.984119e-01 1 1  ON 25
 eO_6                 3.262834e-01 1 1  ON 26
 eO_7                 5.333091e-01 1 1  ON 27
 eO_8                 1.579161e-01 1 1  ON 28
 eO_9                 5.325131e-02 1 1  ON 29
eH1_0                -2.212969e-01 1 1  ON 30
eH1_1                -1.428992e-01 1 1  ON 31
eH1_2                -1.020656e-01 1 1  ON 32
eH1_3                -6.514821e-02 1 1  ON 33
eH1_4                -1.850932e-02 1 1  ON 34
eH1_5                -5.103686e-03 1 1  ON 35
eH1_6                 3.556808e-02 1 1  ON 36
eH1_7                 7.987248e-02 1 1  ON 37
eH1_8                 2.645728e-01 1 1  ON 38
eH1_9                 1.134826e-01 1 1  ON 39
eH2_0                -2.099891e-01 1 1  ON 40
eH2_1                -1.315924e-01 1 1  ON 41
eH2_2                -9.070219e-02 1 1  ON 42
eH2_3                -5.365062e-02 1 1  ON 43
eH2_4                -7.142172e-03 1 1  ON 44
eH2_5                 5.466077e-03 1 1  ON 45
eH2_6                 4.814681e-02 1 1  ON 46
eH2_7                 3.881478e-02 1 1  ON 47
eH2_8                 2.481921e-01 1 1  ON 48
eH2_9                 1.153591e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5125e+01 secs
  Total Execution time = 2.2393e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
