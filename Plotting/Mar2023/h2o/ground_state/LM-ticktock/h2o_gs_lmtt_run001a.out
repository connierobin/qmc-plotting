Rank =    0  Free Memory = 88078 MB
Rank =    1  Free Memory = 88078 MB
Rank =    2  Free Memory = 88078 MB
Rank =    3  Free Memory = 88077 MB
Rank =    4  Free Memory = 88077 MB
Rank =    5  Free Memory = 88077 MB
Rank =    6  Free Memory = 88076 MB
Rank =    7  Free Memory = 88076 MB
Rank =    8  Free Memory = 88076 MB
Rank =    9  Free Memory = 88076 MB
Rank =   10  Free Memory = 88076 MB
Rank =   11  Free Memory = 88076 MB
Rank =   12  Free Memory = 88076 MB
Rank =   13  Free Memory = 88076 MB
Rank =   14  Free Memory = 88076 MB
Rank =   15  Free Memory = 88062 MB
Rank =   16  Free Memory = 88061 MB
Rank =   17  Free Memory = 88061 MB
Rank =   18  Free Memory = 88061 MB
Rank =   19  Free Memory = 88061 MB
Rank =   20  Free Memory = 88061 MB
Rank =   21  Free Memory = 88061 MB
Rank =   22  Free Memory = 88061 MB
Rank =   23  Free Memory = 88061 MB
Rank =   24  Free Memory = 88061 MB
Rank =   25  Free Memory = 88061 MB
Rank =   26  Free Memory = 88061 MB
Rank =   27  Free Memory = 88061 MB
Rank =   28  Free Memory = 88061 MB
Rank =   29  Free Memory = 88061 MB
Rank =   30  Free Memory = 88061 MB
Rank =   31  Free Memory = 88061 MB
Rank =   32  Free Memory = 77355 MB
Rank =   33  Free Memory = 77355 MB
Rank =   34  Free Memory = 77355 MB
Rank =   35  Free Memory = 77355 MB
Rank =   36  Free Memory = 77355 MB
Rank =   37  Free Memory = 77355 MB
Rank =   38  Free Memory = 77355 MB
Rank =   39  Free Memory = 77355 MB
Rank =   40  Free Memory = 77355 MB
Rank =   41  Free Memory = 77355 MB
Rank =   42  Free Memory = 77355 MB
Rank =   43  Free Memory = 77355 MB
Rank =   44  Free Memory = 77355 MB
Rank =   45  Free Memory = 77355 MB
Rank =   46  Free Memory = 77355 MB
Rank =   47  Free Memory = 77355 MB
Rank =   48  Free Memory = 77355 MB
Rank =   49  Free Memory = 77355 MB
Rank =   50  Free Memory = 77355 MB
Rank =   51  Free Memory = 77355 MB
Rank =   52  Free Memory = 77355 MB
Rank =   53  Free Memory = 77355 MB
Rank =   54  Free Memory = 77355 MB
Rank =   55  Free Memory = 77355 MB
Rank =   56  Free Memory = 77355 MB
Rank =   57  Free Memory = 77355 MB
Rank =   58  Free Memory = 77355 MB
Rank =   59  Free Memory = 77355 MB
Rank =   60  Free Memory = 77355 MB
Rank =   61  Free Memory = 77355 MB
Rank =   62  Free Memory = 77355 MB
Rank =   63  Free Memory = 77355 MB
Rank =   64  Free Memory = 77772 MB
Rank =   65  Free Memory = 77772 MB
Rank =   66  Free Memory = 77772 MB
Rank =   67  Free Memory = 77772 MB
Rank =   68  Free Memory = 77772 MB
Rank =   69  Free Memory = 77772 MB
Rank =   70  Free Memory = 77771 MB
Rank =   71  Free Memory = 77771 MB
Rank =   72  Free Memory = 77771 MB
Rank =   73  Free Memory = 77771 MB
Rank =   74  Free Memory = 77771 MB
Rank =   75  Free Memory = 77771 MB
Rank =   76  Free Memory = 77771 MB
Rank =   77  Free Memory = 77771 MB
Rank =   78  Free Memory = 77771 MB
Rank =   79  Free Memory = 77771 MB
Rank =   80  Free Memory = 77771 MB
Rank =   81  Free Memory = 77771 MB
Rank =   82  Free Memory = 77771 MB
Rank =   83  Free Memory = 77771 MB
Rank =   84  Free Memory = 77771 MB
Rank =   85  Free Memory = 77771 MB
Rank =   86  Free Memory = 77771 MB
Rank =   87  Free Memory = 77771 MB
Rank =   88  Free Memory = 77771 MB
Rank =   89  Free Memory = 77771 MB
Rank =   90  Free Memory = 77771 MB
Rank =   91  Free Memory = 77771 MB
Rank =   92  Free Memory = 77771 MB
Rank =   93  Free Memory = 77771 MB
Rank =   94  Free Memory = 77771 MB
Rank =   95  Free Memory = 77771 MB
Rank =   96  Free Memory = 87185 MB
Rank =   97  Free Memory = 87185 MB
Rank =   98  Free Memory = 87185 MB
Rank =   99  Free Memory = 87185 MB
Rank =  100  Free Memory = 87185 MB
Rank =  101  Free Memory = 87185 MB
Rank =  102  Free Memory = 87185 MB
Rank =  103  Free Memory = 87185 MB
Rank =  104  Free Memory = 87185 MB
Rank =  105  Free Memory = 87185 MB
Rank =  106  Free Memory = 87185 MB
Rank =  107  Free Memory = 87185 MB
Rank =  108  Free Memory = 87185 MB
Rank =  109  Free Memory = 87185 MB
Rank =  110  Free Memory = 87185 MB
Rank =  111  Free Memory = 87185 MB
Rank =  112  Free Memory = 87185 MB
Rank =  113  Free Memory = 87185 MB
Rank =  114  Free Memory = 87185 MB
Rank =  115  Free Memory = 87185 MB
Rank =  116  Free Memory = 87185 MB
Rank =  117  Free Memory = 87185 MB
Rank =  118  Free Memory = 87185 MB
Rank =  119  Free Memory = 87185 MB
Rank =  120  Free Memory = 87185 MB
Rank =  121  Free Memory = 87185 MB
Rank =  122  Free Memory = 87184 MB
Rank =  123  Free Memory = 87184 MB
Rank =  124  Free Memory = 87184 MB
Rank =  125  Free Memory = 87184 MB
Rank =  126  Free Memory = 87184 MB
Rank =  127  Free Memory = 87184 MB
  Input file(s): opt_h2o_gs_lmtt_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001a.xml

  Project = H2O
  date    = 2023-03-01 21:08:23 PST
  host    = n0010.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 839

  Range of prime numbers to use as seeds over processors and threads = 6481-7639


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1 OFF
     uu_1                 3.590195e-02    1         1 OFF
     uu_2                -4.559320e-02    1         1 OFF
     uu_3                -9.369633e-02    1         1 OFF
     uu_4                -1.254424e-01    1         1 OFF
     uu_5                -1.327025e-01    1         1 OFF
     uu_6                -1.091659e-01    1         1 OFF
     uu_7                -3.320891e-02    1         1 OFF
     uu_8                 1.030981e-01    1         1 OFF
     uu_9                 1.188130e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1 OFF
     ud_1                 7.590189e-02    1         1 OFF
     ud_2                -7.338664e-03    1         1 OFF
     ud_3                -5.544926e-02    1         1 OFF
     ud_4                -1.064782e-01    1         1 OFF
     ud_5                -1.490405e-01    1         1 OFF
     ud_6                -1.574171e-01    1         1 OFF
     ud_7                -1.077761e-01    1         1 OFF
     ud_8                 9.772284e-03    1         1 OFF
     ud_9                 9.249491e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1 OFF
     eO_1                -4.031104e-01    1         1 OFF
     eO_2                -6.148616e-02    1         1 OFF
     eO_3                 1.622033e-01    1         1 OFF
     eO_4                 2.643764e-01    1         1 OFF
     eO_5                 3.070668e-01    1         1 OFF
     eO_6                 2.482256e-01    1         1 OFF
     eO_7                 1.081366e-01    1         1 OFF
     eO_8                 2.727328e-02    1         1 OFF
     eO_9                 1.812982e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1 OFF
     eH1_1                -9.847470e-02    1         1 OFF
     eH1_2                -6.212571e-02    1         1 OFF
     eH1_3                -2.890051e-02    1         1 OFF
     eH1_4                 1.766763e-02    1         1 OFF
     eH1_5                 3.105966e-02    1         1 OFF
     eH1_6                 7.793809e-02    1         1 OFF
     eH1_7                 1.115220e-01    1         1 OFF
     eH1_8                 8.853209e-02    1         1 OFF
     eH1_9                 2.358450e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1 OFF
     eH2_1                -1.001865e-01    1         1 OFF
     eH2_2                -6.424989e-02    1         1 OFF
     eH2_3                -3.037191e-02    1         1 OFF
     eH2_4                 1.621523e-02    1         1 OFF
     eH2_5                 3.146665e-02    1         1 OFF
     eH2_6                 8.031567e-02    1         1 OFF
     eH2_7                 1.152651e-01    1         1 OFF
     eH2_8                 9.158550e-02    1         1 OFF
     eH2_9                 2.561491e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2650e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.250388
====================================================
  Execution time = 1.4521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.1410e-01
  Total weights = 1.953691684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392547593850
                                         uncertainty =       0.003289995485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392547593850
                                         uncertainty =       0.003289995485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442987171
  error estimate for blocks of size 2^( 2) =       0.000454298532
  error estimate for blocks of size 2^( 3) =       0.000464127052
  error estimate for blocks of size 2^( 4) =       0.000470679881
  error estimate for blocks of size 2^( 5) =       0.000474896357
  error estimate for blocks of size 2^( 6) =       0.000476440223
  error estimate for blocks of size 2^( 7) =       0.000476989774

      target function =                  N/A
              le_mean =     -17.200199336247
             les_mean =     296.260955364892
             stat err =       0.000474751559
             autocorr =       1.148551569485
              std dev =       0.626478465718
             le_variance =       0.392475268009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720019933625e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200199336397       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.207524954269       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.207822385883       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.207829473416       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.207829262539       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.207829298811       residual = 2.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.742776e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200199336397       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.203413151379       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.203478336305       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.203479027535       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.203478991456       residual = 1.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 4.330676e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.200199336397       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201189390686       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201204180150       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201204472695       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201204474083       residual = 1.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.384831e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.004423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7041e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -6.266213e-02                3 1 ON  0
ci_002 -4.816946e-02                3 1 ON  1
ci_003 -3.523911e-02                3 1 ON  2
ci_004 3.441497e-02                 3 1 ON  3
ci_005 3.430777e-02                 3 1 ON  4
ci_006 -3.292356e-02                3 1 ON  5
ci_007 -3.285163e-02                3 1 ON  6
ci_008 -2.878035e-02                3 1 ON  7
ci_009 -2.738604e-02                3 1 ON  8
ci_010 -2.720036e-02                3 1 ON  9
ci_011 -2.654258e-02                3 1 ON  10
ci_012 -2.683746e-02                3 1 ON  11
ci_013 -2.590432e-02                3 1 ON  12
ci_014 2.481931e-02                 3 1 ON  13
ci_015 2.477052e-02                 3 1 ON  14
ci_016 2.363278e-02                 3 1 ON  15
ci_017 2.346517e-02                 3 1 ON  16
ci_018 2.276345e-02                 3 1 ON  17
ci_019 2.300193e-02                 3 1 ON  18
ci_020 2.309060e-02                 3 1 ON  19
ci_021 2.291878e-02                 3 1 ON  20
ci_022 2.003164e-02                 3 1 ON  21
ci_023 2.005055e-02                 3 1 ON  22
ci_024 2.060642e-02                 3 1 ON  23
ci_025 2.078606e-02                 3 1 ON  24
ci_026 2.004390e-02                 3 1 ON  25
ci_027 2.001011e-02                 3 1 ON  26
ci_028 -1.984444e-02                3 1 ON  27
ci_029 -1.977987e-02                3 1 ON  28
ci_030 -1.810478e-02                3 1 ON  29
ci_031 -1.803735e-02                3 1 ON  30
ci_032 -1.747735e-02                3 1 ON  31
ci_033 1.714614e-02                 3 1 ON  32
ci_034 1.697019e-02                 3 1 ON  33
ci_035 -1.495837e-02                3 1 ON  34
ci_036 -1.679783e-02                3 1 ON  35
ci_037 -1.724415e-02                3 1 ON  36
ci_038 1.337102e-02                 3 1 ON  37
ci_039 1.339071e-02                 3 1 ON  38
ci_040 -1.331476e-02                3 1 ON  39
ci_041 1.502050e-02                 3 1 ON  40
ci_042 1.498629e-02                 3 1 ON  41
ci_043 -1.308722e-02                3 1 ON  42
ci_044 -1.579209e-02                3 1 ON  43
ci_045 -1.217351e-02                3 1 ON  44
ci_046 1.340202e-02                 3 1 ON  45
ci_047 1.330136e-02                 3 1 ON  46
ci_048 -1.385680e-02                3 1 ON  47
ci_049 -1.366211e-02                3 1 ON  48
ci_050 1.223178e-02                 3 1 ON  49
ci_051 1.248875e-02                 3 1 ON  50
ci_052 -1.169860e-02                3 1 ON  51
ci_053 -1.151824e-02                3 1 ON  52
ci_054 -1.043314e-02                3 1 ON  53
ci_055 -1.044146e-02                3 1 ON  54
ci_056 1.096833e-02                 3 1 ON  55
ci_057 1.113434e-02                 3 1 ON  56
ci_058 -1.164784e-02                3 1 ON  57
ci_059 -1.157828e-02                3 1 ON  58
ci_060 1.134695e-02                 3 1 ON  59
ci_061 1.143530e-02                 3 1 ON  60
ci_062 -9.785213e-03                3 1 ON  61
ci_063 -9.720398e-03                3 1 ON  62
ci_064 -8.704329e-03                3 1 ON  63
ci_065 -8.955121e-03                3 1 ON  64
ci_066 9.827010e-03                 3 1 ON  65
ci_067 9.731580e-03                 3 1 ON  66
ci_068 -8.877507e-03                3 1 ON  67
ci_069 -8.926586e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1432
    reference variance = 0.208531
====================================================
  Execution time = 1.3698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.7713e-01
  Total weights = 1.9540e+06
  Execution time = 1.8563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      13.839364270727
                                         uncertainty =      13.362763732193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      13.839364270727
                                         uncertainty =      13.362763732193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.002630123926
  error estimate for blocks of size 2^( 2) =       0.002632273717
  error estimate for blocks of size 2^( 3) =       0.002634280712
  error estimate for blocks of size 2^( 4) =       0.002635423051
  error estimate for blocks of size 2^( 5) =       0.002638204744
  error estimate for blocks of size 2^( 6) =       0.002640348012
  error estimate for blocks of size 2^( 7) =       0.002642613058

      target function =                  N/A
              le_mean =     -17.208965065514
             les_mean =     329.505623043255
             stat err =       0.002639147216
             autocorr =       1.006873264124
              std dev =       3.719556927402
             le_variance =      13.835103736186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358884415548
                                         uncertainty =       0.029660471088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358884415548
                                         uncertainty =       0.029660471088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423525691
  error estimate for blocks of size 2^( 2) =       0.000435087668
  error estimate for blocks of size 2^( 3) =       0.000444517888
  error estimate for blocks of size 2^( 4) =       0.000450638912
  error estimate for blocks of size 2^( 5) =       0.000456531735
  error estimate for blocks of size 2^( 6) =       0.000458770701
  error estimate for blocks of size 2^( 7) =       0.000461742898

      target function =                  N/A
              le_mean =     -17.206899394955
             les_mean =     296.682467481344
             stat err =       0.000456921062
             autocorr =       1.163919204267
              std dev =       0.598955776808
             le_variance =       0.358748022571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329377477918
                                         uncertainty =       0.003060653871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329377477918
                                         uncertainty =       0.003060653871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405766899
  error estimate for blocks of size 2^( 2) =       0.000417060965
  error estimate for blocks of size 2^( 3) =       0.000426876533
  error estimate for blocks of size 2^( 4) =       0.000433234701
  error estimate for blocks of size 2^( 5) =       0.000439050837
  error estimate for blocks of size 2^( 6) =       0.000441701102
  error estimate for blocks of size 2^( 7) =       0.000445122471

      target function =                  N/A
              le_mean =     -17.206531276594
             les_mean =     296.418874295450
             stat err =       0.000439777278
             autocorr =       1.174660434656
              std dev =       0.573841052108
             le_variance =       0.329293553085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.303471633284
                                         uncertainty =       0.907939184394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.303471633284
                                         uncertainty =       0.907939184394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000807105222
  error estimate for blocks of size 2^( 2) =       0.000813502906
  error estimate for blocks of size 2^( 3) =       0.000819008052
  error estimate for blocks of size 2^( 4) =       0.000823338152
  error estimate for blocks of size 2^( 5) =       0.000828443674
  error estimate for blocks of size 2^( 6) =       0.000828917799
  error estimate for blocks of size 2^( 7) =       0.000832619210

      target function =                  N/A
              le_mean =     -17.205264668596
             les_mean =     324.014408967516
             stat err =       0.000828329709
             autocorr =       1.053285635681
              std dev =       1.141419151709
             le_variance =       1.302837679888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.208965065514        initial  <--
     2.5000e-01     2.5000e+00             9.7428e-03       -17.206899394955
     1.0000e+00     1.0000e+01             4.3307e-03       -17.206531276594
     4.0000e+00     4.0000e+01             1.3848e-03       -17.205264668596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0739
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -6.641070e-02 3 1  ON 0
ci_002                -5.176000e-02 3 1  ON 1
ci_003                -3.683340e-02 3 1  ON 2
ci_004                 3.648240e-02 3 1  ON 3
ci_005                 3.648240e-02 3 1  ON 4
ci_006                -3.547050e-02 3 1  ON 5
ci_007                -3.547050e-02 3 1  ON 6
ci_008                -3.153860e-02 3 1  ON 7
ci_009                -2.952820e-02 3 1  ON 8
ci_010                -2.905790e-02 3 1  ON 9
ci_011                -2.870030e-02 3 1  ON 10
ci_012                -2.870030e-02 3 1  ON 11
ci_013                -2.696840e-02 3 1  ON 12
ci_014                 2.671770e-02 3 1  ON 13
ci_015                 2.671770e-02 3 1  ON 14
ci_016                 2.559420e-02 3 1  ON 15
ci_017                 2.559420e-02 3 1  ON 16
ci_018                 2.511160e-02 3 1  ON 17
ci_019                 2.511160e-02 3 1  ON 18
ci_020                 2.472430e-02 3 1  ON 19
ci_021                 2.472430e-02 3 1  ON 20
ci_022                 2.207270e-02 3 1  ON 21
ci_023                 2.207270e-02 3 1  ON 22
ci_024                 2.194970e-02 3 1  ON 23
ci_025                 2.194970e-02 3 1  ON 24
ci_026                 2.175140e-02 3 1  ON 25
ci_027                 2.175140e-02 3 1  ON 26
ci_028                -2.123560e-02 3 1  ON 27
ci_029                -2.123560e-02 3 1  ON 28
ci_030                -2.010940e-02 3 1  ON 29
ci_031                -2.010940e-02 3 1  ON 30
ci_032                -1.870710e-02 3 1  ON 31
ci_033                 1.845890e-02 3 1  ON 32
ci_034                 1.845890e-02 3 1  ON 33
ci_035                -1.822570e-02 3 1  ON 34
ci_036                -1.816420e-02 3 1  ON 35
ci_037                -1.816420e-02 3 1  ON 36
ci_038                 1.770170e-02 3 1  ON 37
ci_039                 1.770170e-02 3 1  ON 38
ci_040                -1.683500e-02 3 1  ON 39
ci_041                 1.669000e-02 3 1  ON 40
ci_042                 1.669000e-02 3 1  ON 41
ci_043                -1.629260e-02 3 1  ON 42
ci_044                -1.611690e-02 3 1  ON 43
ci_045                -1.583700e-02 3 1  ON 44
ci_046                 1.508060e-02 3 1  ON 45
ci_047                 1.508060e-02 3 1  ON 46
ci_048                -1.453270e-02 3 1  ON 47
ci_049                -1.453270e-02 3 1  ON 48
ci_050                 1.365720e-02 3 1  ON 49
ci_051                 1.365720e-02 3 1  ON 50
ci_052                -1.287070e-02 3 1  ON 51
ci_053                -1.287070e-02 3 1  ON 52
ci_054                -1.273010e-02 3 1  ON 53
ci_055                -1.273010e-02 3 1  ON 54
ci_056                 1.253230e-02 3 1  ON 55
ci_057                 1.253230e-02 3 1  ON 56
ci_058                -1.251280e-02 3 1  ON 57
ci_059                -1.251280e-02 3 1  ON 58
ci_060                 1.194370e-02 3 1  ON 59
ci_061                 1.194370e-02 3 1  ON 60
ci_062                -1.152600e-02 3 1  ON 61
ci_063                -1.152600e-02 3 1  ON 62
ci_064                -1.108720e-02 3 1  ON 63
ci_065                -1.091250e-02 3 1  ON 64
ci_066                 1.078960e-02 3 1  ON 65
ci_067                 1.078960e-02 3 1  ON 66
ci_068                -1.012900e-02 3 1  ON 67
ci_069                -1.012900e-02 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7183e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.394465
====================================================
  Execution time = 1.4110e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.4234e-01
  Total weights = 1.953495173e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395398899960
                                         uncertainty =       0.003880714674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395398899960
                                         uncertainty =       0.003880714674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444642817
  error estimate for blocks of size 2^( 2) =       0.000456120306
  error estimate for blocks of size 2^( 3) =       0.000465783359
  error estimate for blocks of size 2^( 4) =       0.000472046337
  error estimate for blocks of size 2^( 5) =       0.000477644964
  error estimate for blocks of size 2^( 6) =       0.000480813263
  error estimate for blocks of size 2^( 7) =       0.000481182688

      target function =                  N/A
              le_mean =     -17.199771778000
             les_mean =     296.274489499029
             stat err =       0.000477921813
             autocorr =       1.155290345360
              std dev =       0.628819902099
             le_variance =       0.395414469276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.719977177800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199771778142       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.201320279026       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.201337134409       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.201336743837       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.201336719797       residual = 2.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.172335e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199771778142       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200196364640       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200200754759       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200200709504       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200200697086       residual = 3.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 6.074919e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199771778142       residual = 3.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.199880555332       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.199881679821       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.199881673439       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.199881670141       residual = 5.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 1.565089e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6632e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -6.594388e-02 3 1  ON 0
ci_002                -5.131378e-02 3 1  ON 1
ci_003                -3.665301e-02 3 1  ON 2
ci_004                 3.619010e-02 3 1  ON 3
ci_005                 3.622617e-02 3 1  ON 4
ci_006                -3.511772e-02 3 1  ON 5
ci_007                -3.515707e-02 3 1  ON 6
ci_008                -3.119843e-02 3 1  ON 7
ci_009                -2.923960e-02 3 1  ON 8
ci_010                -2.885187e-02 3 1  ON 9
ci_011                -2.847565e-02 3 1  ON 10
ci_012                -2.845448e-02 3 1  ON 11
ci_013                -2.684884e-02 3 1  ON 12
ci_014                 2.642394e-02 3 1  ON 13
ci_015                 2.646958e-02 3 1  ON 14
ci_016                 2.530444e-02 3 1  ON 15
ci_017                 2.530876e-02 3 1  ON 16
ci_018                 2.480438e-02 3 1  ON 17
ci_019                 2.482332e-02 3 1  ON 18
ci_020                 2.449259e-02 3 1  ON 19
ci_021                 2.450856e-02 3 1  ON 20
ci_022                 2.183448e-02 3 1  ON 21
ci_023                 2.181367e-02 3 1  ON 22
ci_024                 2.179340e-02 3 1  ON 23
ci_025                 2.182927e-02 3 1  ON 24
ci_026                 2.154455e-02 3 1  ON 25
ci_027                 2.152332e-02 3 1  ON 26
ci_028                -2.108979e-02 3 1  ON 27
ci_029                -2.105409e-02 3 1  ON 28
ci_030                -1.981211e-02 3 1  ON 29
ci_031                -1.985545e-02 3 1  ON 30
ci_032                -1.854137e-02 3 1  ON 31
ci_033                 1.831252e-02 3 1  ON 32
ci_034                 1.830065e-02 3 1  ON 33
ci_035                -1.777791e-02 3 1  ON 34
ci_036                -1.802367e-02 3 1  ON 35
ci_037                -1.798647e-02 3 1  ON 36
ci_038                 1.711228e-02 3 1  ON 37
ci_039                 1.709421e-02 3 1  ON 38
ci_040                -1.635986e-02 3 1  ON 39
ci_041                 1.648203e-02 3 1  ON 40
ci_042                 1.646373e-02 3 1  ON 41
ci_043                -1.586234e-02 3 1  ON 42
ci_044                -1.609211e-02 3 1  ON 43
ci_045                -1.533519e-02 3 1  ON 44
ci_046                 1.487328e-02 3 1  ON 45
ci_047                 1.484794e-02 3 1  ON 46
ci_048                -1.440970e-02 3 1  ON 47
ci_049                -1.442420e-02 3 1  ON 48
ci_050                 1.349466e-02 3 1  ON 49
ci_051                 1.341249e-02 3 1  ON 50
ci_052                -1.267449e-02 3 1  ON 51
ci_053                -1.272917e-02 3 1  ON 52
ci_054                -1.244928e-02 3 1  ON 53
ci_055                -1.244115e-02 3 1  ON 54
ci_056                 1.232206e-02 3 1  ON 55
ci_057                 1.234107e-02 3 1  ON 56
ci_058                -1.237238e-02 3 1  ON 57
ci_059                -1.234926e-02 3 1  ON 58
ci_060                 1.187258e-02 3 1  ON 59
ci_061                 1.189852e-02 3 1  ON 60
ci_062                -1.131113e-02 3 1  ON 61
ci_063                -1.133523e-02 3 1  ON 62
ci_064                -1.073108e-02 3 1  ON 63
ci_065                -1.065730e-02 3 1  ON 64
ci_066                 1.064035e-02 3 1  ON 65
ci_067                 1.064209e-02 3 1  ON 66
ci_068                -9.998731e-03 3 1  ON 67
ci_069                -9.950261e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1651
    reference variance = 0.296962
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7201e+01
  VMC Evar = 4.1220e-01
  Total weights = 1.9540e+06
  Execution time = 1.8520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396467154972
                                         uncertainty =       0.003107944808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396467154972
                                         uncertainty =       0.003107944808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445125504
  error estimate for blocks of size 2^( 2) =       0.000456715925
  error estimate for blocks of size 2^( 3) =       0.000466554735
  error estimate for blocks of size 2^( 4) =       0.000473295010
  error estimate for blocks of size 2^( 5) =       0.000476781007
  error estimate for blocks of size 2^( 6) =       0.000479335852
  error estimate for blocks of size 2^( 7) =       0.000480447196

      target function =                  N/A
              le_mean =     -17.201079777010
             les_mean =     296.459376952861
             stat err =       0.000477464766
             autocorr =       1.150582331587
              std dev =       0.629502524724
             le_variance =       0.396273428634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384282487848
                                         uncertainty =       0.008886671290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384282487848
                                         uncertainty =       0.008886671290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438231874
  error estimate for blocks of size 2^( 2) =       0.000449422996
  error estimate for blocks of size 2^( 3) =       0.000458986774
  error estimate for blocks of size 2^( 4) =       0.000465622734
  error estimate for blocks of size 2^( 5) =       0.000469087392
  error estimate for blocks of size 2^( 6) =       0.000471606708
  error estimate for blocks of size 2^( 7) =       0.000472724767

      target function =                  N/A
              le_mean =     -17.201268993216
             les_mean =     296.731996462764
             stat err =       0.000469760400
             autocorr =       1.149065757958
              std dev =       0.619753460134
             le_variance =       0.384094351349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384007439175
                                         uncertainty =       0.003081859315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384007439175
                                         uncertainty =       0.003081859315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438075817
  error estimate for blocks of size 2^( 2) =       0.000449510001
  error estimate for blocks of size 2^( 3) =       0.000459284921
  error estimate for blocks of size 2^( 4) =       0.000466007056
  error estimate for blocks of size 2^( 5) =       0.000469529198
  error estimate for blocks of size 2^( 6) =       0.000472030773
  error estimate for blocks of size 2^( 7) =       0.000473165538

      target function =                  N/A
              le_mean =     -17.201112355331
             les_mean =     296.326149413372
             stat err =       0.000470183141
             autocorr =       1.151955084939
              std dev =       0.619532762320
             le_variance =       0.383820843587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394386988982
                                         uncertainty =       0.003107686671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394386988982
                                         uncertainty =       0.003107686671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443956164
  error estimate for blocks of size 2^( 2) =       0.000455537154
  error estimate for blocks of size 2^( 3) =       0.000465363199
  error estimate for blocks of size 2^( 4) =       0.000472109824
  error estimate for blocks of size 2^( 5) =       0.000475618841
  error estimate for blocks of size 2^( 6) =       0.000478177991
  error estimate for blocks of size 2^( 7) =       0.000479293950

      target function =                  N/A
              le_mean =     -17.201089225273
             les_mean =     296.296161854379
             stat err =       0.000476300152
             autocorr =       1.151015730647
              std dev =       0.627848828084
             le_variance =       0.394194150926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.201079777010        initial
     2.5000e+00     2.5000e+01             2.1723e-03       -17.201268993216  <--
     1.0000e+01     1.0000e+02             6.0749e-04       -17.201112355331
     4.0000e+01     4.0000e+02             1.5651e-04       -17.201089225273

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3086e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -6.466431e-02 3 1  ON 0
ci_002                -5.010562e-02 3 1  ON 1
ci_003                -3.615542e-02 3 1  ON 2
ci_004                 3.538636e-02 3 1  ON 3
ci_005                 3.552206e-02 3 1  ON 4
ci_006                -3.416119e-02 3 1  ON 5
ci_007                -3.430890e-02 3 1  ON 6
ci_008                -3.029139e-02 3 1  ON 7
ci_009                -2.846979e-02 3 1  ON 8
ci_010                -2.828210e-02 3 1  ON 9
ci_011                -2.786138e-02 3 1  ON 10
ci_012                -2.778259e-02 3 1  ON 11
ci_013                -2.652113e-02 3 1  ON 12
ci_014                 2.562632e-02 3 1  ON 13
ci_015                 2.579566e-02 3 1  ON 14
ci_016                 2.452936e-02 3 1  ON 15
ci_017                 2.454655e-02 3 1  ON 16
ci_018                 2.398428e-02 3 1  ON 17
ci_019                 2.405310e-02 3 1  ON 18
ci_020                 2.386530e-02 3 1  ON 19
ci_021                 2.392500e-02 3 1  ON 20
ci_022                 2.119769e-02 3 1  ON 21
ci_023                 2.112030e-02 3 1  ON 22
ci_024                 2.135323e-02 3 1  ON 23
ci_025                 2.148904e-02 3 1  ON 24
ci_026                 2.099254e-02 3 1  ON 25
ci_027                 2.091386e-02 3 1  ON 26
ci_028                -2.070263e-02 3 1  ON 27
ci_029                -2.056998e-02 3 1  ON 28
ci_030                -1.901988e-02 3 1  ON 29
ci_031                -1.917928e-02 3 1  ON 30
ci_032                -1.810172e-02 3 1  ON 31
ci_033                 1.790895e-02 3 1  ON 32
ci_034                 1.786418e-02 3 1  ON 33
ci_035                -1.662591e-02 3 1  ON 34
ci_036                -1.764444e-02 3 1  ON 35
ci_037                -1.750490e-02 3 1  ON 36
ci_038                 1.559121e-02 3 1  ON 37
ci_039                 1.552936e-02 3 1  ON 38
ci_040                -1.515084e-02 3 1  ON 39
ci_041                 1.593400e-02 3 1  ON 40
ci_042                 1.586908e-02 3 1  ON 41
ci_043                -1.474698e-02 3 1  ON 42
ci_044                -1.602548e-02 3 1  ON 43
ci_045                -1.404823e-02 3 1  ON 44
ci_046                 1.431306e-02 3 1  ON 45
ci_047                 1.422103e-02 3 1  ON 46
ci_048                -1.408211e-02 3 1  ON 47
ci_049                -1.413954e-02 3 1  ON 48
ci_050                 1.306944e-02 3 1  ON 49
ci_051                 1.277787e-02 3 1  ON 50
ci_052                -1.215876e-02 3 1  ON 51
ci_053                -1.235635e-02 3 1  ON 52
ci_054                -1.170034e-02 3 1  ON 53
ci_055                -1.167204e-02 3 1  ON 54
ci_056                 1.176648e-02 3 1  ON 55
ci_057                 1.183697e-02 3 1  ON 56
ci_058                -1.200003e-02 3 1  ON 57
ci_059                -1.191602e-02 3 1  ON 58
ci_060                 1.167645e-02 3 1  ON 59
ci_061                 1.177034e-02 3 1  ON 60
ci_062                -1.073827e-02 3 1  ON 61
ci_063                -1.082607e-02 3 1  ON 62
ci_064                -9.852314e-03 3 1  ON 63
ci_065                -1.001900e-02 3 1  ON 64
ci_066                 1.024592e-02 3 1  ON 65
ci_067                 1.025242e-02 3 1  ON 66
ci_068                -9.656144e-03 3 1  ON 67
ci_069                -9.476795e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.713403
====================================================
  Execution time = 1.4088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.7203e+01
  VMC Evar = 4.0998e-01
  Total weights = 1.953802405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384174658782
                                         uncertainty =       0.006192885192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.384174658782
                                         uncertainty =       0.006192885192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438264684
  error estimate for blocks of size 2^( 2) =       0.000449089008
  error estimate for blocks of size 2^( 3) =       0.000458881122
  error estimate for blocks of size 2^( 4) =       0.000465002960
  error estimate for blocks of size 2^( 5) =       0.000468392996
  error estimate for blocks of size 2^( 6) =       0.000468431465
  error estimate for blocks of size 2^( 7) =       0.000469894023

      target function =                  N/A
              le_mean =     -17.202691074898
             les_mean =     296.342556937553
             stat err =       0.000467930361
             autocorr =       1.139959700797
              std dev =       0.619799859359
             le_variance =       0.384151865662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720269107490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.202691075007       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.206199924306       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.206283991060       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.206284615724       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.206284725965       residual = 3.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 5.179779e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.202691075007       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.203875933592       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.203896108573       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.203896056314       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.203896051343       residual = 9.87e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.840296e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.202691075007       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.203015733515       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.203020971762       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.203020987037       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.203020983093       residual = 3.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 5.141087e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007788 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6602e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -6.311834e-02 3 1  ON 0
ci_002                -4.871722e-02 3 1  ON 1
ci_003                -3.554211e-02 3 1  ON 2
ci_004                 3.452797e-02 3 1  ON 3
ci_005                 3.469452e-02 3 1  ON 4
ci_006                -3.316298e-02 3 1  ON 5
ci_007                -3.320606e-02 3 1  ON 6
ci_008                -2.906759e-02 3 1  ON 7
ci_009                -2.745274e-02 3 1  ON 8
ci_010                -2.757812e-02 3 1  ON 9
ci_011                -2.709936e-02 3 1  ON 10
ci_012                -2.694316e-02 3 1  ON 11
ci_013                -2.604713e-02 3 1  ON 12
ci_014                 2.475773e-02 3 1  ON 13
ci_015                 2.497602e-02 3 1  ON 14
ci_016                 2.374444e-02 3 1  ON 15
ci_017                 2.371294e-02 3 1  ON 16
ci_018                 2.310816e-02 3 1  ON 17
ci_019                 2.315891e-02 3 1  ON 18
ci_020                 2.320981e-02 3 1  ON 19
ci_021                 2.321954e-02 3 1  ON 20
ci_022                 2.037548e-02 3 1  ON 21
ci_023                 2.030086e-02 3 1  ON 22
ci_024                 2.084291e-02 3 1  ON 23
ci_025                 2.089028e-02 3 1  ON 24
ci_026                 2.022401e-02 3 1  ON 25
ci_027                 2.020845e-02 3 1  ON 26
ci_028                -2.005623e-02 3 1  ON 27
ci_029                -1.987251e-02 3 1  ON 28
ci_030                -1.818913e-02 3 1  ON 29
ci_031                -1.829384e-02 3 1  ON 30
ci_032                -1.764999e-02 3 1  ON 31
ci_033                 1.734077e-02 3 1  ON 32
ci_034                 1.718234e-02 3 1  ON 33
ci_035                -1.524931e-02 3 1  ON 34
ci_036                -1.706232e-02 3 1  ON 35
ci_037                -1.698738e-02 3 1  ON 36
ci_038                 1.375092e-02 3 1  ON 37
ci_039                 1.381417e-02 3 1  ON 38
ci_040                -1.363180e-02 3 1  ON 39
ci_041                 1.522054e-02 3 1  ON 40
ci_042                 1.514170e-02 3 1  ON 41
ci_043                -1.338905e-02 3 1  ON 42
ci_044                -1.600325e-02 3 1  ON 43
ci_045                -1.257637e-02 3 1  ON 44
ci_046                 1.352090e-02 3 1  ON 45
ci_047                 1.351929e-02 3 1  ON 46
ci_048                -1.377052e-02 3 1  ON 47
ci_049                -1.378410e-02 3 1  ON 48
ci_050                 1.243795e-02 3 1  ON 49
ci_051                 1.220608e-02 3 1  ON 50
ci_052                -1.167562e-02 3 1  ON 51
ci_053                -1.177116e-02 3 1  ON 52
ci_054                -1.072679e-02 3 1  ON 53
ci_055                -1.085687e-02 3 1  ON 54
ci_056                 1.112148e-02 3 1  ON 55
ci_057                 1.111417e-02 3 1  ON 56
ci_058                -1.157344e-02 3 1  ON 57
ci_059                -1.146066e-02 3 1  ON 58
ci_060                 1.140704e-02 3 1  ON 59
ci_061                 1.152382e-02 3 1  ON 60
ci_062                -1.006281e-02 3 1  ON 61
ci_063                -1.015450e-02 3 1  ON 62
ci_064                -8.814290e-03 3 1  ON 63
ci_065                -9.210348e-03 3 1  ON 64
ci_066                 9.676516e-03 3 1  ON 65
ci_067                 9.818675e-03 3 1  ON 66
ci_068                -9.166893e-03 3 1  ON 67
ci_069                -9.022269e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1574
    reference variance = 0.401801
====================================================
  Execution time = 1.4008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.7943e-01
  Total weights = 1.9540e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386990999347
                                         uncertainty =       0.008264584227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386990999347
                                         uncertainty =       0.008264584227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439825873
  error estimate for blocks of size 2^( 2) =       0.000451095346
  error estimate for blocks of size 2^( 3) =       0.000460439924
  error estimate for blocks of size 2^( 4) =       0.000467849039
  error estimate for blocks of size 2^( 5) =       0.000472147453
  error estimate for blocks of size 2^( 6) =       0.000474702382
  error estimate for blocks of size 2^( 7) =       0.000473985012

      target function =                  N/A
              le_mean =     -17.205530671025
             les_mean =     296.671785301600
             stat err =       0.000472170971
             autocorr =       1.152489616908
              std dev =       0.622007713977
             le_variance =       0.386893596247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347614644763
                                         uncertainty =       0.009163146210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347614644763
                                         uncertainty =       0.009163146210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416847677
  error estimate for blocks of size 2^( 2) =       0.000427723049
  error estimate for blocks of size 2^( 3) =       0.000437016868
  error estimate for blocks of size 2^( 4) =       0.000444443962
  error estimate for blocks of size 2^( 5) =       0.000448535699
  error estimate for blocks of size 2^( 6) =       0.000451012240
  error estimate for blocks of size 2^( 7) =       0.000451009623

      target function =                  N/A
              le_mean =     -17.206082995476
             les_mean =     296.570817851268
             stat err =       0.000448750381
             autocorr =       1.158923823500
              std dev =       0.589511637889
             le_variance =       0.347523971206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348141505440
                                         uncertainty =       0.002571193860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348141505440
                                         uncertainty =       0.002571193860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417172392
  error estimate for blocks of size 2^( 2) =       0.000428309641
  error estimate for blocks of size 2^( 3) =       0.000437541707
  error estimate for blocks of size 2^( 4) =       0.000445017605
  error estimate for blocks of size 2^( 5) =       0.000449329075
  error estimate for blocks of size 2^( 6) =       0.000451980335
  error estimate for blocks of size 2^( 7) =       0.000451831227

      target function =                  N/A
              le_mean =     -17.205581610388
             les_mean =     296.433175191900
             stat err =       0.000449539560
             autocorr =       1.161193815901
              std dev =       0.589970854314
             le_variance =       0.348065608940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377175389886
                                         uncertainty =       0.003868203499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.377175389886
                                         uncertainty =       0.003868203499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434213134
  error estimate for blocks of size 2^( 2) =       0.000445575100
  error estimate for blocks of size 2^( 3) =       0.000454905932
  error estimate for blocks of size 2^( 4) =       0.000462261269
  error estimate for blocks of size 2^( 5) =       0.000466670071
  error estimate for blocks of size 2^( 6) =       0.000469184554
  error estimate for blocks of size 2^( 7) =       0.000468705585

      target function =                  N/A
              le_mean =     -17.205400110694
             les_mean =     297.215291865741
             stat err =       0.000466705370
             autocorr =       1.155259857292
              std dev =       0.614070103757
             le_variance =       0.377082092328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.205530671025        initial
     6.2500e-01     6.2500e+00             5.1798e-03       -17.206082995476  <--
     2.5000e+00     2.5000e+01             1.8403e-03       -17.205581610388
     1.0000e+01     1.0000e+02             5.1411e-04       -17.205400110694

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.7258e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -5.969812e-02 3 1  ON 0
ci_002                -4.577929e-02 3 1  ON 1
ci_003                -3.415878e-02 3 1  ON 2
ci_004                 3.261418e-02 3 1  ON 3
ci_005                 3.285295e-02 3 1  ON 4
ci_006                -3.105618e-02 3 1  ON 5
ci_007                -3.087701e-02 3 1  ON 6
ci_008                -2.663640e-02 3 1  ON 7
ci_009                -2.539055e-02 3 1  ON 8
ci_010                -2.596875e-02 3 1  ON 9
ci_011                -2.543886e-02 3 1  ON 10
ci_012                -2.511696e-02 3 1  ON 11
ci_013                -2.499682e-02 3 1  ON 12
ci_014                 2.293004e-02 3 1  ON 13
ci_015                 2.324713e-02 3 1  ON 14
ci_016                 2.218317e-02 3 1  ON 15
ci_017                 2.203829e-02 3 1  ON 16
ci_018                 2.133089e-02 3 1  ON 17
ci_019                 2.136147e-02 3 1  ON 18
ci_020                 2.180862e-02 3 1  ON 19
ci_021                 2.170499e-02 3 1  ON 20
ci_022                 1.871907e-02 3 1  ON 21
ci_023                 1.863661e-02 3 1  ON 22
ci_024                 1.962497e-02 3 1  ON 23
ci_025                 1.948035e-02 3 1  ON 24
ci_026                 1.868730e-02 3 1  ON 25
ci_027                 1.880232e-02 3 1  ON 26
ci_028                -1.873129e-02 3 1  ON 27
ci_029                -1.840429e-02 3 1  ON 28
ci_030                -1.653074e-02 3 1  ON 29
ci_031                -1.652308e-02 3 1  ON 30
ci_032                -1.677402e-02 3 1  ON 31
ci_033                 1.609066e-02 3 1  ON 32
ci_034                 1.568253e-02 3 1  ON 33
ci_035                -1.276880e-02 3 1  ON 34
ci_036                -1.583690e-02 3 1  ON 35
ci_037                -1.589897e-02 3 1  ON 36
ci_038                 1.041144e-02 3 1  ON 37
ci_039                 1.069844e-02 3 1  ON 38
ci_040                -1.100080e-02 3 1  ON 39
ci_041                 1.384520e-02 3 1  ON 40
ci_042                 1.373678e-02 3 1  ON 41
ci_043                -1.089842e-02 3 1  ON 42
ci_044                -1.597171e-02 3 1  ON 43
ci_045                -9.949552e-03 3 1  ON 44
ci_046                 1.186743e-02 3 1  ON 45
ci_047                 1.206024e-02 3 1  ON 46
ci_048                -1.318151e-02 3 1  ON 47
ci_049                -1.309468e-02 3 1  ON 48
ci_050                 1.125277e-02 3 1  ON 49
ci_051                 1.111842e-02 3 1  ON 50
ci_052                -1.072590e-02 3 1  ON 51
ci_053                -1.064109e-02 3 1  ON 52
ci_054                -8.779411e-03 3 1  ON 53
ci_055                -9.234994e-03 3 1  ON 54
ci_056                 9.867047e-03 3 1  ON 55
ci_057                 9.723612e-03 3 1  ON 56
ci_058                -1.072958e-02 3 1  ON 57
ci_059                -1.055859e-02 3 1  ON 58
ci_060                 1.083252e-02 3 1  ON 59
ci_061                 1.099489e-02 3 1  ON 60
ci_062                -8.706454e-03 3 1  ON 61
ci_063                -8.793419e-03 3 1  ON 62
ci_064                -7.155682e-03 3 1  ON 63
ci_065                -7.883371e-03 3 1  ON 64
ci_066                 8.604305e-03 3 1  ON 65
ci_067                 8.975601e-03 3 1  ON 66
ci_068                -8.218203e-03 3 1  ON 67
ci_069                -8.169618e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2387
    reference variance = 0.374796
====================================================
  Execution time = 1.4138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.7209e+01
  VMC Evar = 3.5262e-01
  Total weights = 1.954638897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337148870486
                                         uncertainty =       0.002492391180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337148870486
                                         uncertainty =       0.002492391180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410546324
  error estimate for blocks of size 2^( 2) =       0.000421781245
  error estimate for blocks of size 2^( 3) =       0.000431150258
  error estimate for blocks of size 2^( 4) =       0.000437673826
  error estimate for blocks of size 2^( 5) =       0.000442116780
  error estimate for blocks of size 2^( 6) =       0.000444486406
  error estimate for blocks of size 2^( 7) =       0.000447111162

      target function =                  N/A
              le_mean =     -17.208947612445
             les_mean =     296.500500855175
             stat err =       0.000442847043
             autocorr =       1.163544944079
              std dev =       0.580600179306
             le_variance =       0.337096568210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720894761245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.208947612466       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212196574578       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212302213662       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212303838203       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212304787967       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212304761360       residual = 3.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 8.215890e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.208947612466       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.210571229366       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.210588585859       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.210588673633       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.210588723664       residual = 2.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.646031e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.208947612466       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.209488534160       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.209491365137       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.209491414068       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.137869e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6673e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -5.605209e-02 3 1  ON 0
ci_002                -4.234221e-02 3 1  ON 1
ci_003                -3.228966e-02 3 1  ON 2
ci_004                 3.058007e-02 3 1  ON 3
ci_005                 3.055772e-02 3 1  ON 4
ci_006                -2.856255e-02 3 1  ON 5
ci_007                -2.844624e-02 3 1  ON 6
ci_008                -2.457997e-02 3 1  ON 7
ci_009                -2.367552e-02 3 1  ON 8
ci_010                -2.386187e-02 3 1  ON 9
ci_011                -2.355146e-02 3 1  ON 10
ci_012                -2.317976e-02 3 1  ON 11
ci_013                -2.376617e-02 3 1  ON 12
ci_014                 2.073196e-02 3 1  ON 13
ci_015                 2.145741e-02 3 1  ON 14
ci_016                 2.028242e-02 3 1  ON 15
ci_017                 2.030022e-02 3 1  ON 16
ci_018                 1.926360e-02 3 1  ON 17
ci_019                 1.938809e-02 3 1  ON 18
ci_020                 2.002814e-02 3 1  ON 19
ci_021                 2.019435e-02 3 1  ON 20
ci_022                 1.709392e-02 3 1  ON 21
ci_023                 1.711117e-02 3 1  ON 22
ci_024                 1.816674e-02 3 1  ON 23
ci_025                 1.799752e-02 3 1  ON 24
ci_026                 1.716862e-02 3 1  ON 25
ci_027                 1.707633e-02 3 1  ON 26
ci_028                -1.730973e-02 3 1  ON 27
ci_029                -1.725780e-02 3 1  ON 28
ci_030                -1.475468e-02 3 1  ON 29
ci_031                -1.509243e-02 3 1  ON 30
ci_032                -1.619215e-02 3 1  ON 31
ci_033                 1.492048e-02 3 1  ON 32
ci_034                 1.449726e-02 3 1  ON 33
ci_035                -1.055527e-02 3 1  ON 34
ci_036                -1.483845e-02 3 1  ON 35
ci_037                -1.465519e-02 3 1  ON 36
ci_038                 7.327853e-03 3 1  ON 37
ci_039                 7.779170e-03 3 1  ON 38
ci_040                -8.732713e-03 3 1  ON 39
ci_041                 1.240571e-02 3 1  ON 40
ci_042                 1.241928e-02 3 1  ON 41
ci_043                -8.600920e-03 3 1  ON 42
ci_044                -1.550337e-02 3 1  ON 43
ci_045                -7.453725e-03 3 1  ON 44
ci_046                 1.042109e-02 3 1  ON 45
ci_047                 1.051632e-02 3 1  ON 46
ci_048                -1.239012e-02 3 1  ON 47
ci_049                -1.242752e-02 3 1  ON 48
ci_050                 1.021249e-02 3 1  ON 49
ci_051                 1.033500e-02 3 1  ON 50
ci_052                -9.675351e-03 3 1  ON 51
ci_053                -9.602318e-03 3 1  ON 52
ci_054                -7.169713e-03 3 1  ON 53
ci_055                -7.366505e-03 3 1  ON 54
ci_056                 8.711449e-03 3 1  ON 55
ci_057                 8.420213e-03 3 1  ON 56
ci_058                -9.852688e-03 3 1  ON 57
ci_059                -9.722833e-03 3 1  ON 58
ci_060                 1.027643e-02 3 1  ON 59
ci_061                 1.075112e-02 3 1  ON 60
ci_062                -7.233182e-03 3 1  ON 61
ci_063                -7.395375e-03 3 1  ON 62
ci_064                -5.840790e-03 3 1  ON 63
ci_065                -6.456831e-03 3 1  ON 64
ci_066                 7.757820e-03 3 1  ON 65
ci_067                 8.315972e-03 3 1  ON 66
ci_068                -6.902930e-03 3 1  ON 67
ci_069                -6.990111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.273
    reference variance = 0.209267
====================================================
  Execution time = 1.3807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3201e-01
  Total weights = 1.9553e+06
  Execution time = 1.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394764676942
                                         uncertainty =       0.046337899382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394764676942
                                         uncertainty =       0.046337899382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444377080
  error estimate for blocks of size 2^( 2) =       0.000455058414
  error estimate for blocks of size 2^( 3) =       0.000464487846
  error estimate for blocks of size 2^( 4) =       0.000471128377
  error estimate for blocks of size 2^( 5) =       0.000475143346
  error estimate for blocks of size 2^( 6) =       0.000478473547
  error estimate for blocks of size 2^( 7) =       0.000476807889

      target function =                  N/A
              le_mean =     -17.211644184942
             les_mean =     296.785697357644
             stat err =       0.000475388290
             autocorr =       1.144441656952
              std dev =       0.628444093245
             le_variance =       0.394941978335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305279560647
                                         uncertainty =       0.003663822080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305279560647
                                         uncertainty =       0.003663822080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390828529
  error estimate for blocks of size 2^( 2) =       0.000401924115
  error estimate for blocks of size 2^( 3) =       0.000412110460
  error estimate for blocks of size 2^( 4) =       0.000419450023
  error estimate for blocks of size 2^( 5) =       0.000423636897
  error estimate for blocks of size 2^( 6) =       0.000426852799
  error estimate for blocks of size 2^( 7) =       0.000425130086

      target function =                  N/A
              le_mean =     -17.211980245749
             les_mean =     297.061490438097
             stat err =       0.000423767451
             autocorr =       1.175662530408
              std dev =       0.552715006118
             le_variance =       0.305493877988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412695132313
                                         uncertainty =       0.105943394209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412695132313
                                         uncertainty =       0.105943394209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454229901
  error estimate for blocks of size 2^( 2) =       0.000463780153
  error estimate for blocks of size 2^( 3) =       0.000472676151
  error estimate for blocks of size 2^( 4) =       0.000479182500
  error estimate for blocks of size 2^( 5) =       0.000482022086
  error estimate for blocks of size 2^( 6) =       0.000485390373
  error estimate for blocks of size 2^( 7) =       0.000483683866

      target function =                  N/A
              le_mean =     -17.212153082205
             les_mean =     298.408586552298
             stat err =       0.000482569706
             autocorr =       1.128674393117
              std dev =       0.642378085950
             le_variance =       0.412649605309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081931125
                                         uncertainty =       0.004589906628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081931125
                                         uncertainty =       0.004589906628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411264468
  error estimate for blocks of size 2^( 2) =       0.000422241102
  error estimate for blocks of size 2^( 3) =       0.000432053148
  error estimate for blocks of size 2^( 4) =       0.000439310554
  error estimate for blocks of size 2^( 5) =       0.000443643407
  error estimate for blocks of size 2^( 6) =       0.000446377995
  error estimate for blocks of size 2^( 7) =       0.000444210883

      target function =                  N/A
              le_mean =     -17.211547014451
             les_mean =     296.621884075282
             stat err =       0.000443385710
             autocorr =       1.162307406077
              std dev =       0.581615787962
             le_variance =       0.338276924807


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.211644184942        initial
     1.5625e-01     1.5625e+00             8.2159e-03       -17.211980245749
     6.2500e-01     6.2500e+00             3.6460e-03       -17.212153082205  <--
     2.5000e+00     2.5000e+01             1.1379e-03       -17.211547014451

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.3076e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -5.605209e-02 3 1  ON 0
ci_002                -4.234221e-02 3 1  ON 1
ci_003                -3.228966e-02 3 1  ON 2
ci_004                 3.058007e-02 3 1  ON 3
ci_005                 3.055772e-02 3 1  ON 4
ci_006                -2.856255e-02 3 1  ON 5
ci_007                -2.844624e-02 3 1  ON 6
ci_008                -2.457997e-02 3 1  ON 7
ci_009                -2.367552e-02 3 1  ON 8
ci_010                -2.386187e-02 3 1  ON 9
ci_011                -2.355146e-02 3 1  ON 10
ci_012                -2.317976e-02 3 1  ON 11
ci_013                -2.376617e-02 3 1  ON 12
ci_014                 2.073196e-02 3 1  ON 13
ci_015                 2.145741e-02 3 1  ON 14
ci_016                 2.028242e-02 3 1  ON 15
ci_017                 2.030022e-02 3 1  ON 16
ci_018                 1.926360e-02 3 1  ON 17
ci_019                 1.938809e-02 3 1  ON 18
ci_020                 2.002814e-02 3 1  ON 19
ci_021                 2.019435e-02 3 1  ON 20
ci_022                 1.709392e-02 3 1  ON 21
ci_023                 1.711117e-02 3 1  ON 22
ci_024                 1.816674e-02 3 1  ON 23
ci_025                 1.799752e-02 3 1  ON 24
ci_026                 1.716862e-02 3 1  ON 25
ci_027                 1.707633e-02 3 1  ON 26
ci_028                -1.730973e-02 3 1  ON 27
ci_029                -1.725780e-02 3 1  ON 28
ci_030                -1.475468e-02 3 1  ON 29
ci_031                -1.509243e-02 3 1  ON 30
ci_032                -1.619215e-02 3 1  ON 31
ci_033                 1.492048e-02 3 1  ON 32
ci_034                 1.449726e-02 3 1  ON 33
ci_035                -1.055527e-02 3 1  ON 34
ci_036                -1.483845e-02 3 1  ON 35
ci_037                -1.465519e-02 3 1  ON 36
ci_038                 7.327853e-03 3 1  ON 37
ci_039                 7.779170e-03 3 1  ON 38
ci_040                -8.732713e-03 3 1  ON 39
ci_041                 1.240571e-02 3 1  ON 40
ci_042                 1.241928e-02 3 1  ON 41
ci_043                -8.600920e-03 3 1  ON 42
ci_044                -1.550337e-02 3 1  ON 43
ci_045                -7.453725e-03 3 1  ON 44
ci_046                 1.042109e-02 3 1  ON 45
ci_047                 1.051632e-02 3 1  ON 46
ci_048                -1.239012e-02 3 1  ON 47
ci_049                -1.242752e-02 3 1  ON 48
ci_050                 1.021249e-02 3 1  ON 49
ci_051                 1.033500e-02 3 1  ON 50
ci_052                -9.675351e-03 3 1  ON 51
ci_053                -9.602318e-03 3 1  ON 52
ci_054                -7.169713e-03 3 1  ON 53
ci_055                -7.366505e-03 3 1  ON 54
ci_056                 8.711449e-03 3 1  ON 55
ci_057                 8.420213e-03 3 1  ON 56
ci_058                -9.852688e-03 3 1  ON 57
ci_059                -9.722833e-03 3 1  ON 58
ci_060                 1.027643e-02 3 1  ON 59
ci_061                 1.075112e-02 3 1  ON 60
ci_062                -7.233182e-03 3 1  ON 61
ci_063                -7.395375e-03 3 1  ON 62
ci_064                -5.840790e-03 3 1  ON 63
ci_065                -6.456831e-03 3 1  ON 64
ci_066                 7.757820e-03 3 1  ON 65
ci_067                 8.315972e-03 3 1  ON 66
ci_068                -6.902930e-03 3 1  ON 67
ci_069                -6.990111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2271
    reference variance = 0.334037
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3044e-01
  Total weights = 1.954842050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317290115720
                                         uncertainty =       0.002256763310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317290115720
                                         uncertainty =       0.002256763310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398277832
  error estimate for blocks of size 2^( 2) =       0.000409217783
  error estimate for blocks of size 2^( 3) =       0.000418933019
  error estimate for blocks of size 2^( 4) =       0.000425589622
  error estimate for blocks of size 2^( 5) =       0.000429513783
  error estimate for blocks of size 2^( 6) =       0.000430896727
  error estimate for blocks of size 2^( 7) =       0.000432602332

      target function =                  N/A
              le_mean =     -17.212005793643
             les_mean =     296.583581010925
             stat err =       0.000429650616
             autocorr =       1.163747089490
              std dev =       0.563249912134
             le_variance =       0.317250463519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200579364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212005793664       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213523953712       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213541075996       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213540806423       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213540834362       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.668315e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212005793664       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212749033581       residual = 8.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212750583898       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212750367718       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.917092e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212005793664       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212250120855       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212251654610       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212251424031       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 9.027062e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6751e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.313500e-02 3 1  ON 0
ci_002                -4.015016e-02 3 1  ON 1
ci_003                -3.098738e-02 3 1  ON 2
ci_004                 2.904798e-02 3 1  ON 3
ci_005                 2.891374e-02 3 1  ON 4
ci_006                -2.680906e-02 3 1  ON 5
ci_007                -2.659361e-02 3 1  ON 6
ci_008                -2.308908e-02 3 1  ON 7
ci_009                -2.242808e-02 3 1  ON 8
ci_010                -2.250201e-02 3 1  ON 9
ci_011                -2.219416e-02 3 1  ON 10
ci_012                -2.194677e-02 3 1  ON 11
ci_013                -2.285392e-02 3 1  ON 12
ci_014                 1.941206e-02 3 1  ON 13
ci_015                 2.008299e-02 3 1  ON 14
ci_016                 1.901790e-02 3 1  ON 15
ci_017                 1.908480e-02 3 1  ON 16
ci_018                 1.821126e-02 3 1  ON 17
ci_019                 1.808715e-02 3 1  ON 18
ci_020                 1.853514e-02 3 1  ON 19
ci_021                 1.879431e-02 3 1  ON 20
ci_022                 1.596183e-02 3 1  ON 21
ci_023                 1.620466e-02 3 1  ON 22
ci_024                 1.691704e-02 3 1  ON 23
ci_025                 1.698311e-02 3 1  ON 24
ci_026                 1.593499e-02 3 1  ON 25
ci_027                 1.626159e-02 3 1  ON 26
ci_028                -1.658316e-02 3 1  ON 27
ci_029                -1.659105e-02 3 1  ON 28
ci_030                -1.385152e-02 3 1  ON 29
ci_031                -1.390981e-02 3 1  ON 30
ci_032                -1.564648e-02 3 1  ON 31
ci_033                 1.396584e-02 3 1  ON 32
ci_034                 1.333765e-02 3 1  ON 33
ci_035                -9.161322e-03 3 1  ON 34
ci_036                -1.410391e-02 3 1  ON 35
ci_037                -1.388415e-02 3 1  ON 36
ci_038                 5.648033e-03 3 1  ON 37
ci_039                 5.934287e-03 3 1  ON 38
ci_040                -7.445573e-03 3 1  ON 39
ci_041                 1.144872e-02 3 1  ON 40
ci_042                 1.157929e-02 3 1  ON 41
ci_043                -7.287776e-03 3 1  ON 42
ci_044                -1.513868e-02 3 1  ON 43
ci_045                -5.977871e-03 3 1  ON 44
ci_046                 9.242785e-03 3 1  ON 45
ci_047                 9.347225e-03 3 1  ON 46
ci_048                -1.216313e-02 3 1  ON 47
ci_049                -1.217785e-02 3 1  ON 48
ci_050                 9.486749e-03 3 1  ON 49
ci_051                 9.455926e-03 3 1  ON 50
ci_052                -9.213658e-03 3 1  ON 51
ci_053                -9.023203e-03 3 1  ON 52
ci_054                -6.068632e-03 3 1  ON 53
ci_055                -5.905628e-03 3 1  ON 54
ci_056                 7.880239e-03 3 1  ON 55
ci_057                 7.563182e-03 3 1  ON 56
ci_058                -9.356623e-03 3 1  ON 57
ci_059                -9.464447e-03 3 1  ON 58
ci_060                 9.696272e-03 3 1  ON 59
ci_061                 1.020477e-02 3 1  ON 60
ci_062                -6.265638e-03 3 1  ON 61
ci_063                -6.321578e-03 3 1  ON 62
ci_064                -5.048475e-03 3 1  ON 63
ci_065                -5.752761e-03 3 1  ON 64
ci_066                 7.368861e-03 3 1  ON 65
ci_067                 7.563927e-03 3 1  ON 66
ci_068                -6.160234e-03 3 1  ON 67
ci_069                -6.338064e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.327194
====================================================
  Execution time = 1.3724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.3136e-01
  Total weights = 1.9555e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.139387
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330946158267
                                         uncertainty =       0.005673175258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330946158267
                                         uncertainty =       0.005673175258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406749058
  error estimate for blocks of size 2^( 2) =       0.000417749131
  error estimate for blocks of size 2^( 3) =       0.000427440119
  error estimate for blocks of size 2^( 4) =       0.000433974301
  error estimate for blocks of size 2^( 5) =       0.000437914939
  error estimate for blocks of size 2^( 6) =       0.000441112271
  error estimate for blocks of size 2^( 7) =       0.000441393501

      target function =                  N/A
              le_mean =     -17.212696707343
             les_mean =     296.884666470748
             stat err =       0.000438598753
             autocorr =       1.162737485704
              std dev =       0.575230034177
             le_variance =       0.330889592220

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.110009
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326506111034
                                         uncertainty =       0.020978342850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326506111034
                                         uncertainty =       0.020978342850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404003423
  error estimate for blocks of size 2^( 2) =       0.000414531331
  error estimate for blocks of size 2^( 3) =       0.000424457311
  error estimate for blocks of size 2^( 4) =       0.000431243288
  error estimate for blocks of size 2^( 5) =       0.000435444502
  error estimate for blocks of size 2^( 6) =       0.000438199928
  error estimate for blocks of size 2^( 7) =       0.000438700664

      target function =                  N/A
              le_mean =     -17.212626666770
             les_mean =     300.368684618767
             stat err =       0.000435897096
             autocorr =       1.164120297060
              std dev =       0.571347120035
             le_variance =       0.326437531572

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.131755
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309701524084
                                         uncertainty =       0.007260735542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309701524084
                                         uncertainty =       0.007260735542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393484219
  error estimate for blocks of size 2^( 2) =       0.000404468872
  error estimate for blocks of size 2^( 3) =       0.000414609049
  error estimate for blocks of size 2^( 4) =       0.000421553880
  error estimate for blocks of size 2^( 5) =       0.000425769033
  error estimate for blocks of size 2^( 6) =       0.000428822624
  error estimate for blocks of size 2^( 7) =       0.000429164468

      target function =                  N/A
              le_mean =     -17.212652770594
             les_mean =     296.865501238504
             stat err =       0.000426327501
             autocorr =       1.173902585297
              std dev =       0.556470718591
             le_variance =       0.309659660649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323107454443
                                         uncertainty =       0.003990216964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323107454443
                                         uncertainty =       0.003990216964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401910443
  error estimate for blocks of size 2^( 2) =       0.000412953170
  error estimate for blocks of size 2^( 3) =       0.000422770412
  error estimate for blocks of size 2^( 4) =       0.000429535390
  error estimate for blocks of size 2^( 5) =       0.000433596365
  error estimate for blocks of size 2^( 6) =       0.000436916955
  error estimate for blocks of size 2^( 7) =       0.000437209298

      target function =                  N/A
              le_mean =     -17.212586294732
             les_mean =     296.728016990804
             stat err =       0.000434314502
             autocorr =       1.167750550353
              std dev =       0.568387199079
             le_variance =       0.323064008077


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212696707343        initial  <--
     1.5625e-01     1.5625e+00             6.6683e-03       -17.212626666770
     6.2500e-01     6.2500e+00             2.9171e-03       -17.212652770594
     2.5000e+00     2.5000e+01             9.0271e-04       -17.212586294732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9881
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.605209e-02 3 1  ON 0
ci_002                -4.234221e-02 3 1  ON 1
ci_003                -3.228966e-02 3 1  ON 2
ci_004                 3.058007e-02 3 1  ON 3
ci_005                 3.055772e-02 3 1  ON 4
ci_006                -2.856255e-02 3 1  ON 5
ci_007                -2.844624e-02 3 1  ON 6
ci_008                -2.457997e-02 3 1  ON 7
ci_009                -2.367552e-02 3 1  ON 8
ci_010                -2.386187e-02 3 1  ON 9
ci_011                -2.355146e-02 3 1  ON 10
ci_012                -2.317976e-02 3 1  ON 11
ci_013                -2.376617e-02 3 1  ON 12
ci_014                 2.073196e-02 3 1  ON 13
ci_015                 2.145741e-02 3 1  ON 14
ci_016                 2.028242e-02 3 1  ON 15
ci_017                 2.030022e-02 3 1  ON 16
ci_018                 1.926360e-02 3 1  ON 17
ci_019                 1.938809e-02 3 1  ON 18
ci_020                 2.002814e-02 3 1  ON 19
ci_021                 2.019435e-02 3 1  ON 20
ci_022                 1.709392e-02 3 1  ON 21
ci_023                 1.711117e-02 3 1  ON 22
ci_024                 1.816674e-02 3 1  ON 23
ci_025                 1.799752e-02 3 1  ON 24
ci_026                 1.716862e-02 3 1  ON 25
ci_027                 1.707633e-02 3 1  ON 26
ci_028                -1.730973e-02 3 1  ON 27
ci_029                -1.725780e-02 3 1  ON 28
ci_030                -1.475468e-02 3 1  ON 29
ci_031                -1.509243e-02 3 1  ON 30
ci_032                -1.619215e-02 3 1  ON 31
ci_033                 1.492048e-02 3 1  ON 32
ci_034                 1.449726e-02 3 1  ON 33
ci_035                -1.055527e-02 3 1  ON 34
ci_036                -1.483845e-02 3 1  ON 35
ci_037                -1.465519e-02 3 1  ON 36
ci_038                 7.327853e-03 3 1  ON 37
ci_039                 7.779170e-03 3 1  ON 38
ci_040                -8.732713e-03 3 1  ON 39
ci_041                 1.240571e-02 3 1  ON 40
ci_042                 1.241928e-02 3 1  ON 41
ci_043                -8.600920e-03 3 1  ON 42
ci_044                -1.550337e-02 3 1  ON 43
ci_045                -7.453725e-03 3 1  ON 44
ci_046                 1.042109e-02 3 1  ON 45
ci_047                 1.051632e-02 3 1  ON 46
ci_048                -1.239012e-02 3 1  ON 47
ci_049                -1.242752e-02 3 1  ON 48
ci_050                 1.021249e-02 3 1  ON 49
ci_051                 1.033500e-02 3 1  ON 50
ci_052                -9.675351e-03 3 1  ON 51
ci_053                -9.602318e-03 3 1  ON 52
ci_054                -7.169713e-03 3 1  ON 53
ci_055                -7.366505e-03 3 1  ON 54
ci_056                 8.711449e-03 3 1  ON 55
ci_057                 8.420213e-03 3 1  ON 56
ci_058                -9.852688e-03 3 1  ON 57
ci_059                -9.722833e-03 3 1  ON 58
ci_060                 1.027643e-02 3 1  ON 59
ci_061                 1.075112e-02 3 1  ON 60
ci_062                -7.233182e-03 3 1  ON 61
ci_063                -7.395375e-03 3 1  ON 62
ci_064                -5.840790e-03 3 1  ON 63
ci_065                -6.456831e-03 3 1  ON 64
ci_066                 7.757820e-03 3 1  ON 65
ci_067                 8.315972e-03 3 1  ON 66
ci_068                -6.902930e-03 3 1  ON 67
ci_069                -6.990111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9749e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2761
    reference variance = 0.402793
====================================================
  Execution time = 1.4280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.7973e-01
  Total weights = 1.954988121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323588057623
                                         uncertainty =       0.003645115545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323588057623
                                         uncertainty =       0.003645115545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402221114
  error estimate for blocks of size 2^( 2) =       0.000413382636
  error estimate for blocks of size 2^( 3) =       0.000422462689
  error estimate for blocks of size 2^( 4) =       0.000429049017
  error estimate for blocks of size 2^( 5) =       0.000433248488
  error estimate for blocks of size 2^( 6) =       0.000434957788
  error estimate for blocks of size 2^( 7) =       0.000434202809

      target function =                  N/A
              le_mean =     -17.211551611786
             les_mean =     296.617235675327
             stat err =       0.000432864526
             autocorr =       1.158175202375
              std dev =       0.568826554734
             le_variance =       0.323563649371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721155161179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211551611814       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211908957673       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211916320289       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211916370041       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.281346e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211551611814       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211652919241       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211655200406       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211655223147       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.593739e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.211551611814       residual = 6.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.211577816432       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.211578429565       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211578436605       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.267436e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6805e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.570205e-02 3 1  ON 0
ci_002                -4.198283e-02 3 1  ON 1
ci_003                -3.211646e-02 3 1  ON 2
ci_004                 3.042843e-02 3 1  ON 3
ci_005                 3.037651e-02 3 1  ON 4
ci_006                -2.829169e-02 3 1  ON 5
ci_007                -2.818157e-02 3 1  ON 6
ci_008                -2.435848e-02 3 1  ON 7
ci_009                -2.349635e-02 3 1  ON 8
ci_010                -2.364357e-02 3 1  ON 9
ci_011                -2.339701e-02 3 1  ON 10
ci_012                -2.296198e-02 3 1  ON 11
ci_013                -2.366030e-02 3 1  ON 12
ci_014                 2.057357e-02 3 1  ON 13
ci_015                 2.123432e-02 3 1  ON 14
ci_016                 2.008581e-02 3 1  ON 15
ci_017                 2.011525e-02 3 1  ON 16
ci_018                 1.908740e-02 3 1  ON 17
ci_019                 1.916014e-02 3 1  ON 18
ci_020                 1.985507e-02 3 1  ON 19
ci_021                 2.001460e-02 3 1  ON 20
ci_022                 1.692634e-02 3 1  ON 21
ci_023                 1.696463e-02 3 1  ON 22
ci_024                 1.798708e-02 3 1  ON 23
ci_025                 1.787527e-02 3 1  ON 24
ci_026                 1.701555e-02 3 1  ON 25
ci_027                 1.692096e-02 3 1  ON 26
ci_028                -1.720494e-02 3 1  ON 27
ci_029                -1.712782e-02 3 1  ON 28
ci_030                -1.460174e-02 3 1  ON 29
ci_031                -1.491732e-02 3 1  ON 30
ci_032                -1.608773e-02 3 1  ON 31
ci_033                 1.481097e-02 3 1  ON 32
ci_034                 1.420808e-02 3 1  ON 33
ci_035                -1.038744e-02 3 1  ON 34
ci_036                -1.472922e-02 3 1  ON 35
ci_037                -1.455074e-02 3 1  ON 36
ci_038                 7.049851e-03 3 1  ON 37
ci_039                 7.469249e-03 3 1  ON 38
ci_040                -8.551782e-03 3 1  ON 39
ci_041                 1.228233e-02 3 1  ON 40
ci_042                 1.227444e-02 3 1  ON 41
ci_043                -8.391404e-03 3 1  ON 42
ci_044                -1.552405e-02 3 1  ON 43
ci_045                -7.182517e-03 3 1  ON 44
ci_046                 1.024426e-02 3 1  ON 45
ci_047                 1.034724e-02 3 1  ON 46
ci_048                -1.233241e-02 3 1  ON 47
ci_049                -1.235987e-02 3 1  ON 48
ci_050                 1.010354e-02 3 1  ON 49
ci_051                 1.023747e-02 3 1  ON 50
ci_052                -9.585029e-03 3 1  ON 51
ci_053                -9.545073e-03 3 1  ON 52
ci_054                -7.037025e-03 3 1  ON 53
ci_055                -7.212992e-03 3 1  ON 54
ci_056                 8.563743e-03 3 1  ON 55
ci_057                 8.306608e-03 3 1  ON 56
ci_058                -9.789883e-03 3 1  ON 57
ci_059                -9.649809e-03 3 1  ON 58
ci_060                 1.020781e-02 3 1  ON 59
ci_061                 1.067024e-02 3 1  ON 60
ci_062                -7.066818e-03 3 1  ON 61
ci_063                -7.267997e-03 3 1  ON 62
ci_064                -5.715952e-03 3 1  ON 63
ci_065                -6.376603e-03 3 1  ON 64
ci_066                 7.683566e-03 3 1  ON 65
ci_067                 8.219672e-03 3 1  ON 66
ci_068                -6.798567e-03 3 1  ON 67
ci_069                -6.889533e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.178
    reference variance = 0.260813
====================================================
  Execution time = 1.3792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3002e-01
  Total weights = 1.9552e+06
  Execution time = 1.8357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315961375943
                                         uncertainty =       0.002380619815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315961375943
                                         uncertainty =       0.002380619815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397420558
  error estimate for blocks of size 2^( 2) =       0.000408690533
  error estimate for blocks of size 2^( 3) =       0.000417944418
  error estimate for blocks of size 2^( 4) =       0.000424712618
  error estimate for blocks of size 2^( 5) =       0.000428942837
  error estimate for blocks of size 2^( 6) =       0.000431864508
  error estimate for blocks of size 2^( 7) =       0.000433998551

      target function =                  N/A
              le_mean =     -17.212705046990
             les_mean =     296.610846183250
             stat err =       0.000429879629
             autocorr =       1.170019425256
              std dev =       0.562037543210
             le_variance =       0.315886199977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310048247202
                                         uncertainty =       0.002430849070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310048247202
                                         uncertainty =       0.002430849070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393685540
  error estimate for blocks of size 2^( 2) =       0.000404963999
  error estimate for blocks of size 2^( 3) =       0.000414300589
  error estimate for blocks of size 2^( 4) =       0.000421146946
  error estimate for blocks of size 2^( 5) =       0.000425370998
  error estimate for blocks of size 2^( 6) =       0.000428289789
  error estimate for blocks of size 2^( 7) =       0.000430366295

      target function =                  N/A
              le_mean =     -17.212758177875
             les_mean =     296.618429687714
             stat err =       0.000426293507
             autocorr =       1.172515272113
              std dev =       0.556755430301
             le_variance =       0.309976609170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312398587097
                                         uncertainty =       0.002402513632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312398587097
                                         uncertainty =       0.002402513632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395174404
  error estimate for blocks of size 2^( 2) =       0.000406446720
  error estimate for blocks of size 2^( 3) =       0.000415748606
  error estimate for blocks of size 2^( 4) =       0.000422562484
  error estimate for blocks of size 2^( 5) =       0.000426790003
  error estimate for blocks of size 2^( 6) =       0.000429709411
  error estimate for blocks of size 2^( 7) =       0.000431819397

      target function =                  N/A
              le_mean =     -17.212719306360
             les_mean =     296.606651985337
             stat err =       0.000427720324
             autocorr =       1.171499644117
              std dev =       0.558861001155
             le_variance =       0.312325618612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315476610793
                                         uncertainty =       0.002382867565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315476610793
                                         uncertainty =       0.002382867565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397115683
  error estimate for blocks of size 2^( 2) =       0.000408385700
  error estimate for blocks of size 2^( 3) =       0.000417645254
  error estimate for blocks of size 2^( 4) =       0.000424419407
  error estimate for blocks of size 2^( 5) =       0.000428648451
  error estimate for blocks of size 2^( 6) =       0.000431569778
  error estimate for blocks of size 2^( 7) =       0.000433701258

      target function =                  N/A
              le_mean =     -17.212704648653
             les_mean =     296.609382904265
             stat err =       0.000429584724
             autocorr =       1.170209395669
              std dev =       0.561606384717
             le_variance =       0.315401731355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.212705046990        initial
     1.5625e+00     1.5625e+01             1.2813e-03       -17.212758177875  <--
     6.2500e+00     6.2500e+01             3.5937e-04       -17.212719306360
     2.5000e+01     2.5000e+02             9.2674e-05       -17.212704648653

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3087e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.478277e-02 3 1  ON 0
ci_002                -4.106086e-02 3 1  ON 1
ci_003                -3.165959e-02 3 1  ON 2
ci_004                 3.003063e-02 3 1  ON 3
ci_005                 2.990172e-02 3 1  ON 4
ci_006                -2.759664e-02 3 1  ON 5
ci_007                -2.750148e-02 3 1  ON 6
ci_008                -2.380477e-02 3 1  ON 7
ci_009                -2.304242e-02 3 1  ON 8
ci_010                -2.306358e-02 3 1  ON 9
ci_011                -2.299455e-02 3 1  ON 10
ci_012                -2.239676e-02 3 1  ON 11
ci_013                -2.338044e-02 3 1  ON 12
ci_014                 2.016920e-02 3 1  ON 13
ci_015                 2.066157e-02 3 1  ON 14
ci_016                 1.959641e-02 3 1  ON 15
ci_017                 1.965077e-02 3 1  ON 16
ci_018                 1.864492e-02 3 1  ON 17
ci_019                 1.858712e-02 3 1  ON 18
ci_020                 1.940887e-02 3 1  ON 19
ci_021                 1.954783e-02 3 1  ON 20
ci_022                 1.650670e-02 3 1  ON 21
ci_023                 1.659677e-02 3 1  ON 22
ci_024                 1.749756e-02 3 1  ON 23
ci_025                 1.754143e-02 3 1  ON 24
ci_026                 1.663051e-02 3 1  ON 25
ci_027                 1.653143e-02 3 1  ON 26
ci_028                -1.694420e-02 3 1  ON 27
ci_029                -1.680076e-02 3 1  ON 28
ci_030                -1.422139e-02 3 1  ON 29
ci_031                -1.448010e-02 3 1  ON 30
ci_032                -1.582572e-02 3 1  ON 31
ci_033                 1.452205e-02 3 1  ON 32
ci_034                 1.345620e-02 3 1  ON 33
ci_035                -9.989467e-03 3 1  ON 34
ci_036                -1.444922e-02 3 1  ON 35
ci_037                -1.428407e-02 3 1  ON 36
ci_038                 6.391638e-03 3 1  ON 37
ci_039                 6.732804e-03 3 1  ON 38
ci_040                -8.134793e-03 3 1  ON 39
ci_041                 1.198294e-02 3 1  ON 40
ci_042                 1.192036e-02 3 1  ON 41
ci_043                -7.890396e-03 3 1  ON 42
ci_044                -1.558257e-02 3 1  ON 43
ci_045                -6.544134e-03 3 1  ON 44
ci_046                 9.795839e-03 3 1  ON 45
ci_047                 9.916260e-03 3 1  ON 46
ci_048                -1.219317e-02 3 1  ON 47
ci_049                -1.219627e-02 3 1  ON 48
ci_050                 9.837736e-03 3 1  ON 49
ci_051                 1.000103e-02 3 1  ON 50
ci_052                -9.363492e-03 3 1  ON 51
ci_053                -9.404572e-03 3 1  ON 52
ci_054                -6.706020e-03 3 1  ON 53
ci_055                -6.830620e-03 3 1  ON 54
ci_056                 8.202087e-03 3 1  ON 55
ci_057                 8.026884e-03 3 1  ON 56
ci_058                -9.635711e-03 3 1  ON 57
ci_059                -9.466810e-03 3 1  ON 58
ci_060                 1.002789e-02 3 1  ON 59
ci_061                 1.045937e-02 3 1  ON 60
ci_062                -6.648383e-03 3 1  ON 61
ci_063                -6.948164e-03 3 1  ON 62
ci_064                -5.440785e-03 3 1  ON 63
ci_065                -6.196467e-03 3 1  ON 64
ci_066                 7.501645e-03 3 1  ON 65
ci_067                 7.983766e-03 3 1  ON 66
ci_068                -6.545115e-03 3 1  ON 67
ci_069                -6.644834e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1604
    reference variance = 0.56567
====================================================
  Execution time = 1.4267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.2112e-01
  Total weights = 1.954936687e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307318475145
                                         uncertainty =       0.002045419715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307318475145
                                         uncertainty =       0.002045419715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391985363
  error estimate for blocks of size 2^( 2) =       0.000403271403
  error estimate for blocks of size 2^( 3) =       0.000413638142
  error estimate for blocks of size 2^( 4) =       0.000420620958
  error estimate for blocks of size 2^( 5) =       0.000424176332
  error estimate for blocks of size 2^( 6) =       0.000427251197
  error estimate for blocks of size 2^( 7) =       0.000428501694

      target function =                  N/A
              le_mean =     -17.212234588507
             les_mean =     296.582136780932
             stat err =       0.000425137545
             autocorr =       1.176303043743
              std dev =       0.554351016282
             le_variance =       0.307305049253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721223458851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212234588553       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212913992667       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212936716119       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212936176785       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212936239795       residual = 3.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.077273e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212234588553       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212484929133       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212490998529       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212490875170       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.047218e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212234588553       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212305583187       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212307204629       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212307227722       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.883863e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6802e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.373555e-02 3 1  ON 0
ci_002                -4.019098e-02 3 1  ON 1
ci_003                -3.112965e-02 3 1  ON 2
ci_004                 2.946980e-02 3 1  ON 3
ci_005                 2.932084e-02 3 1  ON 4
ci_006                -2.693410e-02 3 1  ON 5
ci_007                -2.680587e-02 3 1  ON 6
ci_008                -2.316036e-02 3 1  ON 7
ci_009                -2.243946e-02 3 1  ON 8
ci_010                -2.254470e-02 3 1  ON 9
ci_011                -2.229257e-02 3 1  ON 10
ci_012                -2.192546e-02 3 1  ON 11
ci_013                -2.300467e-02 3 1  ON 12
ci_014                 1.966871e-02 3 1  ON 13
ci_015                 2.014863e-02 3 1  ON 14
ci_016                 1.911723e-02 3 1  ON 15
ci_017                 1.916443e-02 3 1  ON 16
ci_018                 1.812655e-02 3 1  ON 17
ci_019                 1.813947e-02 3 1  ON 18
ci_020                 1.879138e-02 3 1  ON 19
ci_021                 1.903898e-02 3 1  ON 20
ci_022                 1.616454e-02 3 1  ON 21
ci_023                 1.615788e-02 3 1  ON 22
ci_024                 1.712791e-02 3 1  ON 23
ci_025                 1.701238e-02 3 1  ON 24
ci_026                 1.613361e-02 3 1  ON 25
ci_027                 1.619118e-02 3 1  ON 26
ci_028                -1.662870e-02 3 1  ON 27
ci_029                -1.645315e-02 3 1  ON 28
ci_030                -1.381913e-02 3 1  ON 29
ci_031                -1.402430e-02 3 1  ON 30
ci_032                -1.545923e-02 3 1  ON 31
ci_033                 1.411115e-02 3 1  ON 32
ci_034                 1.317912e-02 3 1  ON 33
ci_035                -9.446422e-03 3 1  ON 34
ci_036                -1.413224e-02 3 1  ON 35
ci_037                -1.392476e-02 3 1  ON 36
ci_038                 5.618946e-03 3 1  ON 37
ci_039                 5.938952e-03 3 1  ON 38
ci_040                -7.593236e-03 3 1  ON 39
ci_041                 1.158324e-02 3 1  ON 40
ci_042                 1.153071e-02 3 1  ON 41
ci_043                -7.351375e-03 3 1  ON 42
ci_044                -1.537793e-02 3 1  ON 43
ci_045                -5.814573e-03 3 1  ON 44
ci_046                 9.288121e-03 3 1  ON 45
ci_047                 9.437685e-03 3 1  ON 46
ci_048                -1.203908e-02 3 1  ON 47
ci_049                -1.199812e-02 3 1  ON 48
ci_050                 9.575196e-03 3 1  ON 49
ci_051                 9.764005e-03 3 1  ON 50
ci_052                -9.142895e-03 3 1  ON 51
ci_053                -9.091049e-03 3 1  ON 52
ci_054                -6.168882e-03 3 1  ON 53
ci_055                -6.291723e-03 3 1  ON 54
ci_056                 7.851507e-03 3 1  ON 55
ci_057                 7.636115e-03 3 1  ON 56
ci_058                -9.276604e-03 3 1  ON 57
ci_059                -9.276424e-03 3 1  ON 58
ci_060                 9.768878e-03 3 1  ON 59
ci_061                 1.036123e-02 3 1  ON 60
ci_062                -6.255409e-03 3 1  ON 61
ci_063                -6.582358e-03 3 1  ON 62
ci_064                -5.244227e-03 3 1  ON 63
ci_065                -6.001496e-03 3 1  ON 64
ci_066                 7.391863e-03 3 1  ON 65
ci_067                 7.670727e-03 3 1  ON 66
ci_068                -6.259966e-03 3 1  ON 67
ci_069                -6.319492e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.293
    reference variance = 0.205853
====================================================
  Execution time = 1.3722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2112e-01
  Total weights = 1.9555e+06
  Execution time = 1.8413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451142373326
                                         uncertainty =       0.137933088454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.451142373326
                                         uncertainty =       0.137933088454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474789143
  error estimate for blocks of size 2^( 2) =       0.000483709079
  error estimate for blocks of size 2^( 3) =       0.000491356876
  error estimate for blocks of size 2^( 4) =       0.000496972683
  error estimate for blocks of size 2^( 5) =       0.000500946071
  error estimate for blocks of size 2^( 6) =       0.000502068360
  error estimate for blocks of size 2^( 7) =       0.000501748080

      target function =                  N/A
              le_mean =     -17.213034508173
             les_mean =     410.898592391270
             stat err =       0.000500433799
             autocorr =       1.110942826564
              std dev =       0.671453244791
             le_variance =       0.450849459941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301543673320
                                         uncertainty =       0.003789403073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301543673320
                                         uncertainty =       0.003789403073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388263886
  error estimate for blocks of size 2^( 2) =       0.000399004313
  error estimate for blocks of size 2^( 3) =       0.000408309975
  error estimate for blocks of size 2^( 4) =       0.000415322421
  error estimate for blocks of size 2^( 5) =       0.000419793379
  error estimate for blocks of size 2^( 6) =       0.000421968426
  error estimate for blocks of size 2^( 7) =       0.000422738027

      target function =                  N/A
              le_mean =     -17.213369788587
             les_mean =     296.814732754182
             stat err =       0.000419955563
             autocorr =       1.169910622686
              std dev =       0.549088053178
             le_variance =       0.301497690143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303697181325
                                         uncertainty =       0.003876972546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303697181325
                                         uncertainty =       0.003876972546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389647592
  error estimate for blocks of size 2^( 2) =       0.000400355048
  error estimate for blocks of size 2^( 3) =       0.000409586003
  error estimate for blocks of size 2^( 4) =       0.000416563200
  error estimate for blocks of size 2^( 5) =       0.000420959334
  error estimate for blocks of size 2^( 6) =       0.000423111747
  error estimate for blocks of size 2^( 7) =       0.000423872722

      target function =                  N/A
              le_mean =     -17.213318480845
             les_mean =     296.703544414601
             stat err =       0.000421126751
             autocorr =       1.168104418414
              std dev =       0.551044908684
             le_variance =       0.303650491387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310985191798
                                         uncertainty =       0.004025727716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310985191798
                                         uncertainty =       0.004025727716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394294166
  error estimate for blocks of size 2^( 2) =       0.000404879859
  error estimate for blocks of size 2^( 3) =       0.000413978465
  error estimate for blocks of size 2^( 4) =       0.000420881655
  error estimate for blocks of size 2^( 5) =       0.000425236463
  error estimate for blocks of size 2^( 6) =       0.000427463527
  error estimate for blocks of size 2^( 7) =       0.000428274280

      target function =                  N/A
              le_mean =     -17.213278815617
             les_mean =     296.626152132276
             stat err =       0.000425463981
             autocorr =       1.164353616318
              std dev =       0.557616157645
             le_variance =       0.310935779267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213034508173        initial
     3.9062e-01     3.9062e+00             3.0773e-03       -17.213369788587  <--
     1.5625e+00     1.5625e+01             1.0472e-03       -17.213318480845
     6.2500e+00     6.2500e+01             2.8839e-04       -17.213278815617

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.3007e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.170549e-02 3 1  ON 0
ci_002                -3.863432e-02 3 1  ON 1
ci_003                -3.008176e-02 3 1  ON 2
ci_004                 2.838457e-02 3 1  ON 3
ci_005                 2.819582e-02 3 1  ON 4
ci_006                -2.575279e-02 3 1  ON 5
ci_007                -2.555107e-02 3 1  ON 6
ci_008                -2.209197e-02 3 1  ON 7
ci_009                -2.142379e-02 3 1  ON 8
ci_010                -2.150346e-02 3 1  ON 9
ci_011                -2.097009e-02 3 1  ON 10
ci_012                -2.104661e-02 3 1  ON 11
ci_013                -2.226522e-02 3 1  ON 12
ci_014                 1.876906e-02 3 1  ON 13
ci_015                 1.922188e-02 3 1  ON 14
ci_016                 1.833925e-02 3 1  ON 15
ci_017                 1.836086e-02 3 1  ON 16
ci_018                 1.725341e-02 3 1  ON 17
ci_019                 1.738252e-02 3 1  ON 18
ci_020                 1.763774e-02 3 1  ON 19
ci_021                 1.810217e-02 3 1  ON 20
ci_022                 1.559249e-02 3 1  ON 21
ci_023                 1.541148e-02 3 1  ON 22
ci_024                 1.633296e-02 3 1  ON 23
ci_025                 1.588435e-02 3 1  ON 24
ci_026                 1.528540e-02 3 1  ON 25
ci_027                 1.562807e-02 3 1  ON 26
ci_028                -1.611669e-02 3 1  ON 27
ci_029                -1.588194e-02 3 1  ON 28
ci_030                -1.315661e-02 3 1  ON 29
ci_031                -1.327256e-02 3 1  ON 30
ci_032                -1.485110e-02 3 1  ON 31
ci_033                 1.330635e-02 3 1  ON 32
ci_034                 1.262863e-02 3 1  ON 33
ci_035                -8.660610e-03 3 1  ON 34
ci_036                -1.356798e-02 3 1  ON 35
ci_037                -1.326857e-02 3 1  ON 36
ci_038                 4.491453e-03 3 1  ON 37
ci_039                 4.773252e-03 3 1  ON 38
ci_040                -6.848107e-03 3 1  ON 39
ci_041                 1.094175e-02 3 1  ON 40
ci_042                 1.091241e-02 3 1  ON 41
ci_043                -6.541590e-03 3 1  ON 42
ci_044                -1.496361e-02 3 1  ON 43
ci_045                -4.767161e-03 3 1  ON 44
ci_046                 8.394618e-03 3 1  ON 45
ci_047                 8.597193e-03 3 1  ON 46
ci_048                -1.184424e-02 3 1  ON 47
ci_049                -1.170550e-02 3 1  ON 48
ci_050                 9.161985e-03 3 1  ON 49
ci_051                 9.397991e-03 3 1  ON 50
ci_052                -8.795572e-03 3 1  ON 51
ci_053                -8.585422e-03 3 1  ON 52
ci_054                -5.272448e-03 3 1  ON 53
ci_055                -5.390243e-03 3 1  ON 54
ci_056                 7.287244e-03 3 1  ON 55
ci_057                 7.010058e-03 3 1  ON 56
ci_058                -8.680353e-03 3 1  ON 57
ci_059                -8.959365e-03 3 1  ON 58
ci_060                 9.274877e-03 3 1  ON 59
ci_061                 1.016940e-02 3 1  ON 60
ci_062                -5.591313e-03 3 1  ON 61
ci_063                -5.966690e-03 3 1  ON 62
ci_064                -5.004486e-03 3 1  ON 63
ci_065                -5.746547e-03 3 1  ON 64
ci_066                 7.217329e-03 3 1  ON 65
ci_067                 7.169611e-03 3 1  ON 66
ci_068                -5.815021e-03 3 1  ON 67
ci_069                -5.793507e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.283633
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1971e-01
  Total weights = 1.955964587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302213020069
                                         uncertainty =       0.002068375831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302213020069
                                         uncertainty =       0.002068375831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388726180
  error estimate for blocks of size 2^( 2) =       0.000400168836
  error estimate for blocks of size 2^( 3) =       0.000409945109
  error estimate for blocks of size 2^( 4) =       0.000416576499
  error estimate for blocks of size 2^( 5) =       0.000420839120
  error estimate for blocks of size 2^( 6) =       0.000423943576
  error estimate for blocks of size 2^( 7) =       0.000423638101

      target function =                  N/A
              le_mean =     -17.213925079575
             les_mean =     296.638930344400
             stat err =       0.000421249324
             autocorr =       1.174331883874
              std dev =       0.549741835930
             le_variance =       0.302216086172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721392507957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925079615       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214326812049       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214348328893       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214348490043       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214349076235       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 4.661692e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925079615       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214147543990       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214155381179       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214155110354       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.347186e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925079615       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214004958305       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214007493174       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214007403140       residual = 7.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.920978e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6747e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.935831e-02 3 1  ON 0
ci_002                -3.694094e-02 3 1  ON 1
ci_003                -2.896133e-02 3 1  ON 2
ci_004                 2.720891e-02 3 1  ON 3
ci_005                 2.697966e-02 3 1  ON 4
ci_006                -2.413220e-02 3 1  ON 5
ci_007                -2.467012e-02 3 1  ON 6
ci_008                -2.128514e-02 3 1  ON 7
ci_009                -2.062496e-02 3 1  ON 8
ci_010                -2.050796e-02 3 1  ON 9
ci_011                -1.989387e-02 3 1  ON 10
ci_012                -1.998708e-02 3 1  ON 11
ci_013                -2.154069e-02 3 1  ON 12
ci_014                 1.757101e-02 3 1  ON 13
ci_015                 1.810203e-02 3 1  ON 14
ci_016                 1.754594e-02 3 1  ON 15
ci_017                 1.777792e-02 3 1  ON 16
ci_018                 1.665711e-02 3 1  ON 17
ci_019                 1.656262e-02 3 1  ON 18
ci_020                 1.690016e-02 3 1  ON 19
ci_021                 1.755900e-02 3 1  ON 20
ci_022                 1.515606e-02 3 1  ON 21
ci_023                 1.472805e-02 3 1  ON 22
ci_024                 1.548043e-02 3 1  ON 23
ci_025                 1.487933e-02 3 1  ON 24
ci_026                 1.473804e-02 3 1  ON 25
ci_027                 1.521337e-02 3 1  ON 26
ci_028                -1.563065e-02 3 1  ON 27
ci_029                -1.537957e-02 3 1  ON 28
ci_030                -1.220044e-02 3 1  ON 29
ci_031                -1.265220e-02 3 1  ON 30
ci_032                -1.430560e-02 3 1  ON 31
ci_033                 1.236594e-02 3 1  ON 32
ci_034                 1.190217e-02 3 1  ON 33
ci_035                -7.759240e-03 3 1  ON 34
ci_036                -1.331729e-02 3 1  ON 35
ci_037                -1.260909e-02 3 1  ON 36
ci_038                 3.659646e-03 3 1  ON 37
ci_039                 3.716721e-03 3 1  ON 38
ci_040                -6.571913e-03 3 1  ON 39
ci_041                 1.098479e-02 3 1  ON 40
ci_042                 1.063870e-02 3 1  ON 41
ci_043                -5.754726e-03 3 1  ON 42
ci_044                -1.503124e-02 3 1  ON 43
ci_045                -4.282564e-03 3 1  ON 44
ci_046                 7.633275e-03 3 1  ON 45
ci_047                 7.654322e-03 3 1  ON 46
ci_048                -1.165461e-02 3 1  ON 47
ci_049                -1.184307e-02 3 1  ON 48
ci_050                 8.920765e-03 3 1  ON 49
ci_051                 8.735123e-03 3 1  ON 50
ci_052                -8.571419e-03 3 1  ON 51
ci_053                -8.187778e-03 3 1  ON 52
ci_054                -4.602028e-03 3 1  ON 53
ci_055                -4.825533e-03 3 1  ON 54
ci_056                 6.543057e-03 3 1  ON 55
ci_057                 6.676904e-03 3 1  ON 56
ci_058                -8.360589e-03 3 1  ON 57
ci_059                -8.616186e-03 3 1  ON 58
ci_060                 8.672808e-03 3 1  ON 59
ci_061                 9.684238e-03 3 1  ON 60
ci_062                -4.965916e-03 3 1  ON 61
ci_063                -5.090084e-03 3 1  ON 62
ci_064                -4.596102e-03 3 1  ON 63
ci_065                -5.375515e-03 3 1  ON 64
ci_066                 6.834682e-03 3 1  ON 65
ci_067                 7.144482e-03 3 1  ON 66
ci_068                -5.362992e-03 3 1  ON 67
ci_069                -5.427731e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2883
    reference variance = 0.341206
====================================================
  Execution time = 1.3704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1161e-01
  Total weights = 1.9562e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406676045071
                                         uncertainty =       0.104332425180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406676045071
                                         uncertainty =       0.104332425180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000450568799
  error estimate for blocks of size 2^( 2) =       0.000460657255
  error estimate for blocks of size 2^( 3) =       0.000469198494
  error estimate for blocks of size 2^( 4) =       0.000475712171
  error estimate for blocks of size 2^( 5) =       0.000479552870
  error estimate for blocks of size 2^( 6) =       0.000482781756
  error estimate for blocks of size 2^( 7) =       0.000484833248

      target function =                  N/A
              le_mean =     -17.214325779806
             les_mean =     310.824551931603
             stat err =       0.000480720011
             autocorr =       1.138314252460
              std dev =       0.637200505994
             le_variance =       0.406024484839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292399787467
                                         uncertainty =       0.002089368389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292399787467
                                         uncertainty =       0.002089368389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382322963
  error estimate for blocks of size 2^( 2) =       0.000394045045
  error estimate for blocks of size 2^( 3) =       0.000404018214
  error estimate for blocks of size 2^( 4) =       0.000411580066
  error estimate for blocks of size 2^( 5) =       0.000415825633
  error estimate for blocks of size 2^( 6) =       0.000418844899
  error estimate for blocks of size 2^( 7) =       0.000420012947

      target function =                  N/A
              le_mean =     -17.214515120890
             les_mean =     296.925499894594
             stat err =       0.000416565886
             autocorr =       1.187152841887
              std dev =       0.540686319522
             le_variance =       0.292341696118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291532840027
                                         uncertainty =       0.002089483170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291532840027
                                         uncertainty =       0.002089483170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381755510
  error estimate for blocks of size 2^( 2) =       0.000393535655
  error estimate for blocks of size 2^( 3) =       0.000403557720
  error estimate for blocks of size 2^( 4) =       0.000411147599
  error estimate for blocks of size 2^( 5) =       0.000415404401
  error estimate for blocks of size 2^( 6) =       0.000418418473
  error estimate for blocks of size 2^( 7) =       0.000419571855

      target function =                  N/A
              le_mean =     -17.214544586836
             les_mean =     296.655995455467
             stat err =       0.000416135582
             autocorr =       1.188226069443
              std dev =       0.539883819475
             le_variance =       0.291474538531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314717021266
                                         uncertainty =       0.015305515052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314717021266
                                         uncertainty =       0.015305515052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396647591
  error estimate for blocks of size 2^( 2) =       0.000407838301
  error estimate for blocks of size 2^( 3) =       0.000417477788
  error estimate for blocks of size 2^( 4) =       0.000424603949
  error estimate for blocks of size 2^( 5) =       0.000428793568
  error estimate for blocks of size 2^( 6) =       0.000431677118
  error estimate for blocks of size 2^( 7) =       0.000433283018

      target function =                  N/A
              le_mean =     -17.214566057248
             les_mean =     301.525614499590
             stat err =       0.000429589413
             autocorr =       1.172998612805
              std dev =       0.560944402636
             le_variance =       0.314658622848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214325779806        initial
     9.7656e-02     9.7656e-01             4.6617e-03       -17.214515120890
     3.9062e-01     3.9062e+00             2.3472e-03       -17.214544586836
     1.5625e+00     1.5625e+01             7.9210e-04       -17.214566057248  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2976e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -5.091340e-02 3 1  ON 0
ci_002                -3.803477e-02 3 1  ON 1
ci_003                -2.971146e-02 3 1  ON 2
ci_004                 2.799045e-02 3 1  ON 3
ci_005                 2.778312e-02 3 1  ON 4
ci_006                -2.518499e-02 3 1  ON 5
ci_007                -2.522935e-02 3 1  ON 6
ci_008                -2.178895e-02 3 1  ON 7
ci_009                -2.112630e-02 3 1  ON 8
ci_010                -2.117416e-02 3 1  ON 9
ci_011                -2.059823e-02 3 1  ON 10
ci_012                -2.068090e-02 3 1  ON 11
ci_013                -2.202050e-02 3 1  ON 12
ci_014                 1.834478e-02 3 1  ON 13
ci_015                 1.882464e-02 3 1  ON 14
ci_016                 1.803793e-02 3 1  ON 15
ci_017                 1.812985e-02 3 1  ON 16
ci_018                 1.703154e-02 3 1  ON 17
ci_019                 1.708224e-02 3 1  ON 18
ci_020                 1.737915e-02 3 1  ON 19
ci_021                 1.790646e-02 3 1  ON 20
ci_022                 1.542577e-02 3 1  ON 21
ci_023                 1.515559e-02 3 1  ON 22
ci_024                 1.606425e-02 3 1  ON 23
ci_025                 1.556446e-02 3 1  ON 24
ci_026                 1.507890e-02 3 1  ON 25
ci_027                 1.546785e-02 3 1  ON 26
ci_028                -1.593091e-02 3 1  ON 27
ci_029                -1.569342e-02 3 1  ON 28
ci_030                -1.280653e-02 3 1  ON 29
ci_031                -1.303439e-02 3 1  ON 30
ci_032                -1.464426e-02 3 1  ON 31
ci_033                 1.298689e-02 3 1  ON 32
ci_034                 1.238201e-02 3 1  ON 33
ci_035                -8.292250e-03 3 1  ON 34
ci_036                -1.347498e-02 3 1  ON 35
ci_037                -1.303360e-02 3 1  ON 36
ci_038                 4.152571e-03 3 1  ON 37
ci_039                 4.344110e-03 3 1  ON 38
ci_040                -6.727905e-03 3 1  ON 39
ci_041                 1.093827e-02 3 1  ON 40
ci_042                 1.079676e-02 3 1  ON 41
ci_043                -6.225575e-03 3 1  ON 42
ci_044                -1.497977e-02 3 1  ON 43
ci_045                -4.566378e-03 3 1  ON 44
ci_046                 8.119914e-03 3 1  ON 45
ci_047                 8.256459e-03 3 1  ON 46
ci_048                -1.175549e-02 3 1  ON 47
ci_049                -1.172282e-02 3 1  ON 48
ci_050                 9.068225e-03 3 1  ON 49
ci_051                 9.140614e-03 3 1  ON 50
ci_052                -8.706163e-03 3 1  ON 51
ci_053                -8.432208e-03 3 1  ON 52
ci_054                -5.022463e-03 3 1  ON 53
ci_055                -5.178661e-03 3 1  ON 54
ci_056                 7.000648e-03 3 1  ON 55
ci_057                 6.882624e-03 3 1  ON 56
ci_058                -8.559139e-03 3 1  ON 57
ci_059                -8.828816e-03 3 1  ON 58
ci_060                 9.066504e-03 3 1  ON 59
ci_061                 1.000228e-02 3 1  ON 60
ci_062                -5.356483e-03 3 1  ON 61
ci_063                -5.643234e-03 3 1  ON 62
ci_064                -4.825118e-03 3 1  ON 63
ci_065                -5.583295e-03 3 1  ON 64
ci_066                 7.068624e-03 3 1  ON 65
ci_067                 7.159596e-03 3 1  ON 66
ci_068                -5.639293e-03 3 1  ON 67
ci_069                -5.649090e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.219413
====================================================
  Execution time = 1.4113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1102e-01
  Total weights = 1.955949992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297383082675
                                         uncertainty =       0.001934617165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297383082675
                                         uncertainty =       0.001934617165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385561324
  error estimate for blocks of size 2^( 2) =       0.000397392227
  error estimate for blocks of size 2^( 3) =       0.000407404996
  error estimate for blocks of size 2^( 4) =       0.000414244070
  error estimate for blocks of size 2^( 5) =       0.000417965018
  error estimate for blocks of size 2^( 6) =       0.000418888842
  error estimate for blocks of size 2^( 7) =       0.000419595053

      target function =                  N/A
              le_mean =     -17.213635317712
             les_mean =     296.620262490988
             stat err =       0.000417673246
             autocorr =       1.173508900378
              std dev =       0.545266054136
             le_variance =       0.297315069793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721363531771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213635317719       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213815268916       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213818113134       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213818268140       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.165229e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213635317719       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213699055771       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213700882713       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213700797105       residual = 5.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.262593e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213635317719       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213653105569       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213653761222       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213653746197       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.987610e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6640e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -5.018714e-02 3 1  ON 0
ci_002                -3.751788e-02 3 1  ON 1
ci_003                -2.947449e-02 3 1  ON 2
ci_004                 2.745007e-02 3 1  ON 3
ci_005                 2.738274e-02 3 1  ON 4
ci_006                -2.484552e-02 3 1  ON 5
ci_007                -2.487872e-02 3 1  ON 6
ci_008                -2.160178e-02 3 1  ON 7
ci_009                -2.088462e-02 3 1  ON 8
ci_010                -2.098601e-02 3 1  ON 9
ci_011                -2.035941e-02 3 1  ON 10
ci_012                -2.038513e-02 3 1  ON 11
ci_013                -2.174192e-02 3 1  ON 12
ci_014                 1.810708e-02 3 1  ON 13
ci_015                 1.848327e-02 3 1  ON 14
ci_016                 1.777717e-02 3 1  ON 15
ci_017                 1.798762e-02 3 1  ON 16
ci_018                 1.680613e-02 3 1  ON 17
ci_019                 1.687271e-02 3 1  ON 18
ci_020                 1.719593e-02 3 1  ON 19
ci_021                 1.765073e-02 3 1  ON 20
ci_022                 1.521550e-02 3 1  ON 21
ci_023                 1.491031e-02 3 1  ON 22
ci_024                 1.583398e-02 3 1  ON 23
ci_025                 1.516163e-02 3 1  ON 24
ci_026                 1.485424e-02 3 1  ON 25
ci_027                 1.516509e-02 3 1  ON 26
ci_028                -1.588401e-02 3 1  ON 27
ci_029                -1.556600e-02 3 1  ON 28
ci_030                -1.247416e-02 3 1  ON 29
ci_031                -1.287672e-02 3 1  ON 30
ci_032                -1.459755e-02 3 1  ON 31
ci_033                 1.267405e-02 3 1  ON 32
ci_034                 1.219726e-02 3 1  ON 33
ci_035                -8.178202e-03 3 1  ON 34
ci_036                -1.344126e-02 3 1  ON 35
ci_037                -1.292817e-02 3 1  ON 36
ci_038                 3.838806e-03 3 1  ON 37
ci_039                 4.082897e-03 3 1  ON 38
ci_040                -6.540147e-03 3 1  ON 39
ci_041                 1.084183e-02 3 1  ON 40
ci_042                 1.063432e-02 3 1  ON 41
ci_043                -6.015214e-03 3 1  ON 42
ci_044                -1.487878e-02 3 1  ON 43
ci_045                -4.402979e-03 3 1  ON 44
ci_046                 7.885142e-03 3 1  ON 45
ci_047                 8.098885e-03 3 1  ON 46
ci_048                -1.177116e-02 3 1  ON 47
ci_049                -1.169538e-02 3 1  ON 48
ci_050                 8.910232e-03 3 1  ON 49
ci_051                 9.110861e-03 3 1  ON 50
ci_052                -8.592869e-03 3 1  ON 51
ci_053                -8.355704e-03 3 1  ON 52
ci_054                -4.829507e-03 3 1  ON 53
ci_055                -4.921493e-03 3 1  ON 54
ci_056                 6.770823e-03 3 1  ON 55
ci_057                 6.799357e-03 3 1  ON 56
ci_058                -8.584431e-03 3 1  ON 57
ci_059                -8.711190e-03 3 1  ON 58
ci_060                 9.048838e-03 3 1  ON 59
ci_061                 9.910526e-03 3 1  ON 60
ci_062                -5.208934e-03 3 1  ON 61
ci_063                -5.395938e-03 3 1  ON 62
ci_064                -4.570453e-03 3 1  ON 63
ci_065                -5.460453e-03 3 1  ON 64
ci_066                 7.023828e-03 3 1  ON 65
ci_067                 6.975129e-03 3 1  ON 66
ci_068                -5.519559e-03 3 1  ON 67
ci_069                -5.532006e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2185
    reference variance = 0.151249
====================================================
  Execution time = 1.3715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1373e-01
  Total weights = 1.9556e+06
  Execution time = 1.8265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301100497823
                                         uncertainty =       0.002486034100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301100497823
                                         uncertainty =       0.002486034100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387970911
  error estimate for blocks of size 2^( 2) =       0.000399527706
  error estimate for blocks of size 2^( 3) =       0.000409878326
  error estimate for blocks of size 2^( 4) =       0.000417298526
  error estimate for blocks of size 2^( 5) =       0.000421936217
  error estimate for blocks of size 2^( 6) =       0.000424439712
  error estimate for blocks of size 2^( 7) =       0.000427809494

      target function =                  N/A
              le_mean =     -17.214088640563
             les_mean =     296.641031029843
             stat err =       0.000422870987
             autocorr =       1.188002759393
              std dev =       0.548673724534
             le_variance =       0.301042855994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297234131868
                                         uncertainty =       0.002458134942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297234131868
                                         uncertainty =       0.002458134942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385471281
  error estimate for blocks of size 2^( 2) =       0.000397131779
  error estimate for blocks of size 2^( 3) =       0.000407610924
  error estimate for blocks of size 2^( 4) =       0.000415138737
  error estimate for blocks of size 2^( 5) =       0.000419882577
  error estimate for blocks of size 2^( 6) =       0.000422468724
  error estimate for blocks of size 2^( 7) =       0.000425855460

      target function =                  N/A
              le_mean =     -17.214135348086
             les_mean =     296.724235194110
             stat err =       0.000420836374
             autocorr =       1.191907315745
              std dev =       0.545138713977
             le_variance =       0.297176217477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298078241189
                                         uncertainty =       0.002476101055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298078241189
                                         uncertainty =       0.002476101055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386018374
  error estimate for blocks of size 2^( 2) =       0.000397656214
  error estimate for blocks of size 2^( 3) =       0.000408102535
  error estimate for blocks of size 2^( 4) =       0.000415609402
  error estimate for blocks of size 2^( 5) =       0.000420312569
  error estimate for blocks of size 2^( 6) =       0.000422839632
  error estimate for blocks of size 2^( 7) =       0.000426273524

      target function =                  N/A
              le_mean =     -17.214102720058
             les_mean =     296.638090184257
             stat err =       0.000421258782
             autocorr =       1.190918336834
              std dev =       0.545912419288
             le_variance =       0.298020369533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300642505649
                                         uncertainty =       0.002484912318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300642505649
                                         uncertainty =       0.002484912318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387675661
  error estimate for blocks of size 2^( 2) =       0.000399243228
  error estimate for blocks of size 2^( 3) =       0.000409606868
  error estimate for blocks of size 2^( 4) =       0.000417036829
  error estimate for blocks of size 2^( 5) =       0.000421684226
  error estimate for blocks of size 2^( 6) =       0.000424192682
  error estimate for blocks of size 2^( 7) =       0.000427566090

      target function =                  N/A
              le_mean =     -17.214085755586
             les_mean =     296.672811527415
             stat err =       0.000422619957
             autocorr =       1.188400785750
              std dev =       0.548256177488
             le_variance =       0.300584836154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214088640563        initial
     3.9062e-01     3.9062e+00             2.1652e-03       -17.214135348086  <--
     1.5625e+00     1.5625e+01             7.2626e-04       -17.214102720058
     6.2500e+00     6.2500e+01             1.9876e-04       -17.214085755586

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2924e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.874817e-02 3 1  ON 0
ci_002                -3.657435e-02 3 1  ON 1
ci_003                -2.900193e-02 3 1  ON 2
ci_004                 2.635953e-02 3 1  ON 3
ci_005                 2.658514e-02 3 1  ON 4
ci_006                -2.423236e-02 3 1  ON 5
ci_007                -2.425304e-02 3 1  ON 6
ci_008                -2.129964e-02 3 1  ON 7
ci_009                -2.047299e-02 3 1  ON 8
ci_010                -2.060337e-02 3 1  ON 9
ci_011                -1.989945e-02 3 1  ON 10
ci_012                -1.982421e-02 3 1  ON 11
ci_013                -2.116479e-02 3 1  ON 12
ci_014                 1.768323e-02 3 1  ON 13
ci_015                 1.786694e-02 3 1  ON 14
ci_016                 1.735242e-02 3 1  ON 15
ci_017                 1.779442e-02 3 1  ON 16
ci_018                 1.642181e-02 3 1  ON 17
ci_019                 1.652255e-02 3 1  ON 18
ci_020                 1.686803e-02 3 1  ON 19
ci_021                 1.717203e-02 3 1  ON 20
ci_022                 1.485532e-02 3 1  ON 21
ci_023                 1.448599e-02 3 1  ON 22
ci_024                 1.534466e-02 3 1  ON 23
ci_025                 1.430808e-02 3 1  ON 24
ci_026                 1.446584e-02 3 1  ON 25
ci_027                 1.463867e-02 3 1  ON 26
ci_028                -1.584988e-02 3 1  ON 27
ci_029                -1.537245e-02 3 1  ON 28
ci_030                -1.190336e-02 3 1  ON 29
ci_031                -1.263393e-02 3 1  ON 30
ci_032                -1.453873e-02 3 1  ON 31
ci_033                 1.207282e-02 3 1  ON 32
ci_034                 1.183868e-02 3 1  ON 33
ci_035                -8.021452e-03 3 1  ON 34
ci_036                -1.340155e-02 3 1  ON 35
ci_037                -1.273735e-02 3 1  ON 36
ci_038                 3.379913e-03 3 1  ON 37
ci_039                 3.700661e-03 3 1  ON 38
ci_040                -6.289876e-03 3 1  ON 39
ci_041                 1.071632e-02 3 1  ON 40
ci_042                 1.038115e-02 3 1  ON 41
ci_043                -5.704800e-03 3 1  ON 42
ci_044                -1.467055e-02 3 1  ON 43
ci_045                -4.176321e-03 3 1  ON 44
ci_046                 7.467367e-03 3 1  ON 45
ci_047                 7.822282e-03 3 1  ON 46
ci_048                -1.186733e-02 3 1  ON 47
ci_049                -1.171680e-02 3 1  ON 48
ci_050                 8.663157e-03 3 1  ON 49
ci_051                 9.060799e-03 3 1  ON 50
ci_052                -8.405856e-03 3 1  ON 51
ci_053                -8.234107e-03 3 1  ON 52
ci_054                -4.505317e-03 3 1  ON 53
ci_055                -4.492694e-03 3 1  ON 54
ci_056                 6.399040e-03 3 1  ON 55
ci_057                 6.666590e-03 3 1  ON 56
ci_058                -8.626897e-03 3 1  ON 57
ci_059                -8.522772e-03 3 1  ON 58
ci_060                 9.009976e-03 3 1  ON 59
ci_061                 9.732268e-03 3 1  ON 60
ci_062                -4.961352e-03 3 1  ON 61
ci_063                -4.973138e-03 3 1  ON 62
ci_064                -4.243683e-03 3 1  ON 63
ci_065                -5.300980e-03 3 1  ON 64
ci_066                 6.952459e-03 3 1  ON 65
ci_067                 6.682329e-03 3 1  ON 66
ci_068                -5.340212e-03 3 1  ON 67
ci_069                -5.355353e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1562
    reference variance = 0.250231
====================================================
  Execution time = 1.4126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1306e-01
  Total weights = 1.955961942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296975800895
                                         uncertainty =       0.002359343420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296975800895
                                         uncertainty =       0.002359343420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385309774
  error estimate for blocks of size 2^( 2) =       0.000396695067
  error estimate for blocks of size 2^( 3) =       0.000406813323
  error estimate for blocks of size 2^( 4) =       0.000415321629
  error estimate for blocks of size 2^( 5) =       0.000419932488
  error estimate for blocks of size 2^( 6) =       0.000423516943
  error estimate for blocks of size 2^( 7) =       0.000425544478

      target function =                  N/A
              le_mean =     -17.214000682090
             les_mean =     296.634874575716
             stat err =       0.000421078885
             autocorr =       1.194281973493
              std dev =       0.544910307559
             le_variance =       0.296927243284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721400068209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214000682114       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214128950166       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214134255693       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214134356840       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214134307944       residual = 7.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.480367e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214000682114       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214070426174       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214071977311       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214071975660       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.258868e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214000682114       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214025369585       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214025840572       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214025869368       residual = 2.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 4.266259e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6662e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.748930e-02 3 1  ON 0
ci_002                -3.605530e-02 3 1  ON 1
ci_003                -2.876391e-02 3 1  ON 2
ci_004                 2.544684e-02 3 1  ON 3
ci_005                 2.569020e-02 3 1  ON 4
ci_006                -2.356958e-02 3 1  ON 5
ci_007                -2.349719e-02 3 1  ON 6
ci_008                -2.081079e-02 3 1  ON 7
ci_009                -1.985400e-02 3 1  ON 8
ci_010                -1.973929e-02 3 1  ON 9
ci_011                -1.915048e-02 3 1  ON 10
ci_012                -1.955848e-02 3 1  ON 11
ci_013                -2.117036e-02 3 1  ON 12
ci_014                 1.690870e-02 3 1  ON 13
ci_015                 1.751533e-02 3 1  ON 14
ci_016                 1.730174e-02 3 1  ON 15
ci_017                 1.731757e-02 3 1  ON 16
ci_018                 1.595968e-02 3 1  ON 17
ci_019                 1.627259e-02 3 1  ON 18
ci_020                 1.670336e-02 3 1  ON 19
ci_021                 1.690041e-02 3 1  ON 20
ci_022                 1.456219e-02 3 1  ON 21
ci_023                 1.409386e-02 3 1  ON 22
ci_024                 1.451546e-02 3 1  ON 23
ci_025                 1.374018e-02 3 1  ON 24
ci_026                 1.436196e-02 3 1  ON 25
ci_027                 1.429853e-02 3 1  ON 26
ci_028                -1.588538e-02 3 1  ON 27
ci_029                -1.527594e-02 3 1  ON 28
ci_030                -1.171120e-02 3 1  ON 29
ci_031                -1.243833e-02 3 1  ON 30
ci_032                -1.401760e-02 3 1  ON 31
ci_033                 1.190379e-02 3 1  ON 32
ci_034                 1.166062e-02 3 1  ON 33
ci_035                -7.756727e-03 3 1  ON 34
ci_036                -1.284612e-02 3 1  ON 35
ci_037                -1.259188e-02 3 1  ON 36
ci_038                 2.890432e-03 3 1  ON 37
ci_039                 3.162764e-03 3 1  ON 38
ci_040                -6.092477e-03 3 1  ON 39
ci_041                 1.053291e-02 3 1  ON 40
ci_042                 1.040610e-02 3 1  ON 41
ci_043                -5.753463e-03 3 1  ON 42
ci_044                -1.472481e-02 3 1  ON 43
ci_045                -4.016299e-03 3 1  ON 44
ci_046                 7.031349e-03 3 1  ON 45
ci_047                 7.260632e-03 3 1  ON 46
ci_048                -1.163538e-02 3 1  ON 47
ci_049                -1.168244e-02 3 1  ON 48
ci_050                 8.431510e-03 3 1  ON 49
ci_051                 8.713503e-03 3 1  ON 50
ci_052                -8.299302e-03 3 1  ON 51
ci_053                -7.930093e-03 3 1  ON 52
ci_054                -4.191441e-03 3 1  ON 53
ci_055                -4.054673e-03 3 1  ON 54
ci_056                 5.937565e-03 3 1  ON 55
ci_057                 6.531485e-03 3 1  ON 56
ci_058                -8.698682e-03 3 1  ON 57
ci_059                -8.446208e-03 3 1  ON 58
ci_060                 9.311096e-03 3 1  ON 59
ci_061                 9.319401e-03 3 1  ON 60
ci_062                -4.915869e-03 3 1  ON 61
ci_063                -4.503699e-03 3 1  ON 62
ci_064                -4.282263e-03 3 1  ON 63
ci_065                -5.111875e-03 3 1  ON 64
ci_066                 6.576236e-03 3 1  ON 65
ci_067                 6.328138e-03 3 1  ON 66
ci_068                -5.342566e-03 3 1  ON 67
ci_069                -5.383262e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.219135
====================================================
  Execution time = 1.3912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0933e-01
  Total weights = 1.9561e+06
  Execution time = 1.8287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298511489467
                                         uncertainty =       0.002041367761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298511489467
                                         uncertainty =       0.002041367761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386318546
  error estimate for blocks of size 2^( 2) =       0.000397703987
  error estimate for blocks of size 2^( 3) =       0.000407842300
  error estimate for blocks of size 2^( 4) =       0.000415980298
  error estimate for blocks of size 2^( 5) =       0.000419800703
  error estimate for blocks of size 2^( 6) =       0.000422554133
  error estimate for blocks of size 2^( 7) =       0.000423807709

      target function =                  N/A
              le_mean =     -17.214847418935
             les_mean =     296.669329559449
             stat err =       0.000420535711
             autocorr =       1.184989893433
              std dev =       0.546336926796
             le_variance =       0.298484037581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294594724689
                                         uncertainty =       0.002003745317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294594724689
                                         uncertainty =       0.002003745317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383777069
  error estimate for blocks of size 2^( 2) =       0.000395363877
  error estimate for blocks of size 2^( 3) =       0.000405676804
  error estimate for blocks of size 2^( 4) =       0.000414002726
  error estimate for blocks of size 2^( 5) =       0.000417898718
  error estimate for blocks of size 2^( 6) =       0.000420598357
  error estimate for blocks of size 2^( 7) =       0.000421961162

      target function =                  N/A
              le_mean =     -17.214829844126
             les_mean =     296.659343689814
             stat err =       0.000418615241
             autocorr =       1.189794696579
              std dev =       0.542742735386
             le_variance =       0.294569676814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294204843310
                                         uncertainty =       0.002001238035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294204843310
                                         uncertainty =       0.002001238035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383523174
  error estimate for blocks of size 2^( 2) =       0.000395138222
  error estimate for blocks of size 2^( 3) =       0.000405477180
  error estimate for blocks of size 2^( 4) =       0.000413822231
  error estimate for blocks of size 2^( 5) =       0.000417724912
  error estimate for blocks of size 2^( 6) =       0.000420406126
  error estimate for blocks of size 2^( 7) =       0.000421769043

      target function =                  N/A
              le_mean =     -17.214836437011
             les_mean =     296.664750779293
             stat err =       0.000418430578
             autocorr =       1.190319664351
              std dev =       0.542383673513
             le_variance =       0.294180049293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297636283430
                                         uncertainty =       0.002027547777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297636283430
                                         uncertainty =       0.002027547777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385752129
  error estimate for blocks of size 2^( 2) =       0.000397177417
  error estimate for blocks of size 2^( 3) =       0.000407343514
  error estimate for blocks of size 2^( 4) =       0.000415515719
  error estimate for blocks of size 2^( 5) =       0.000419349865
  error estimate for blocks of size 2^( 6) =       0.000422082025
  error estimate for blocks of size 2^( 7) =       0.000423371589

      target function =                  N/A
              le_mean =     -17.214821484886
             les_mean =     296.688872196331
             stat err =       0.000420079800
             autocorr =       1.185896899796
              std dev =       0.545535892212
             le_variance =       0.297609409691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214847418935        initial  <--
     9.7656e-02     9.7656e-01             2.4804e-03       -17.214829844126
     3.9062e-01     3.9062e+00             1.2589e-03       -17.214836437011
     1.5625e+00     1.5625e+01             4.2663e-04       -17.214821484886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1530
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.874817e-02 3 1  ON 0
ci_002                -3.657435e-02 3 1  ON 1
ci_003                -2.900193e-02 3 1  ON 2
ci_004                 2.635953e-02 3 1  ON 3
ci_005                 2.658514e-02 3 1  ON 4
ci_006                -2.423236e-02 3 1  ON 5
ci_007                -2.425304e-02 3 1  ON 6
ci_008                -2.129964e-02 3 1  ON 7
ci_009                -2.047299e-02 3 1  ON 8
ci_010                -2.060337e-02 3 1  ON 9
ci_011                -1.989945e-02 3 1  ON 10
ci_012                -1.982421e-02 3 1  ON 11
ci_013                -2.116479e-02 3 1  ON 12
ci_014                 1.768323e-02 3 1  ON 13
ci_015                 1.786694e-02 3 1  ON 14
ci_016                 1.735242e-02 3 1  ON 15
ci_017                 1.779442e-02 3 1  ON 16
ci_018                 1.642181e-02 3 1  ON 17
ci_019                 1.652255e-02 3 1  ON 18
ci_020                 1.686803e-02 3 1  ON 19
ci_021                 1.717203e-02 3 1  ON 20
ci_022                 1.485532e-02 3 1  ON 21
ci_023                 1.448599e-02 3 1  ON 22
ci_024                 1.534466e-02 3 1  ON 23
ci_025                 1.430808e-02 3 1  ON 24
ci_026                 1.446584e-02 3 1  ON 25
ci_027                 1.463867e-02 3 1  ON 26
ci_028                -1.584988e-02 3 1  ON 27
ci_029                -1.537245e-02 3 1  ON 28
ci_030                -1.190336e-02 3 1  ON 29
ci_031                -1.263393e-02 3 1  ON 30
ci_032                -1.453873e-02 3 1  ON 31
ci_033                 1.207282e-02 3 1  ON 32
ci_034                 1.183868e-02 3 1  ON 33
ci_035                -8.021452e-03 3 1  ON 34
ci_036                -1.340155e-02 3 1  ON 35
ci_037                -1.273735e-02 3 1  ON 36
ci_038                 3.379913e-03 3 1  ON 37
ci_039                 3.700661e-03 3 1  ON 38
ci_040                -6.289876e-03 3 1  ON 39
ci_041                 1.071632e-02 3 1  ON 40
ci_042                 1.038115e-02 3 1  ON 41
ci_043                -5.704800e-03 3 1  ON 42
ci_044                -1.467055e-02 3 1  ON 43
ci_045                -4.176321e-03 3 1  ON 44
ci_046                 7.467367e-03 3 1  ON 45
ci_047                 7.822282e-03 3 1  ON 46
ci_048                -1.186733e-02 3 1  ON 47
ci_049                -1.171680e-02 3 1  ON 48
ci_050                 8.663157e-03 3 1  ON 49
ci_051                 9.060799e-03 3 1  ON 50
ci_052                -8.405856e-03 3 1  ON 51
ci_053                -8.234107e-03 3 1  ON 52
ci_054                -4.505317e-03 3 1  ON 53
ci_055                -4.492694e-03 3 1  ON 54
ci_056                 6.399040e-03 3 1  ON 55
ci_057                 6.666590e-03 3 1  ON 56
ci_058                -8.626897e-03 3 1  ON 57
ci_059                -8.522772e-03 3 1  ON 58
ci_060                 9.009976e-03 3 1  ON 59
ci_061                 9.732268e-03 3 1  ON 60
ci_062                -4.961352e-03 3 1  ON 61
ci_063                -4.973138e-03 3 1  ON 62
ci_064                -4.243683e-03 3 1  ON 63
ci_065                -5.300980e-03 3 1  ON 64
ci_066                 6.952459e-03 3 1  ON 65
ci_067                 6.682329e-03 3 1  ON 66
ci_068                -5.340212e-03 3 1  ON 67
ci_069                -5.355353e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.574137
====================================================
  Execution time = 1.4857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0602e-01
  Total weights = 1.955912336e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292699066290
                                         uncertainty =       0.001535110258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292699066290
                                         uncertainty =       0.001535110258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382574583
  error estimate for blocks of size 2^( 2) =       0.000394086676
  error estimate for blocks of size 2^( 3) =       0.000404256161
  error estimate for blocks of size 2^( 4) =       0.000412154899
  error estimate for blocks of size 2^( 5) =       0.000416257487
  error estimate for blocks of size 2^( 6) =       0.000418719946
  error estimate for blocks of size 2^( 7) =       0.000418646618

      target function =                  N/A
              le_mean =     -17.213911473251
             les_mean =     296.624766205027
             stat err =       0.000416444737
             autocorr =       1.184902263263
              std dev =       0.541042164063
             le_variance =       0.292726623294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721391147325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213911473266       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213952630366       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213953698283       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213953673336       residual = 3.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 7.735674e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213911473266       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213923507366       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213923941431       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213923942183       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.223598e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213911473266       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213914614980       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213914740155       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213914741812       residual = 7.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.777134e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7785e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.852581e-02 3 1  ON 0
ci_002                -3.646970e-02 3 1  ON 1
ci_003                -2.889531e-02 3 1  ON 2
ci_004                 2.627461e-02 3 1  ON 3
ci_005                 2.648270e-02 3 1  ON 4
ci_006                -2.414495e-02 3 1  ON 5
ci_007                -2.415712e-02 3 1  ON 6
ci_008                -2.122422e-02 3 1  ON 7
ci_009                -2.048276e-02 3 1  ON 8
ci_010                -2.047141e-02 3 1  ON 9
ci_011                -1.979456e-02 3 1  ON 10
ci_012                -1.968004e-02 3 1  ON 11
ci_013                -2.110197e-02 3 1  ON 12
ci_014                 1.764703e-02 3 1  ON 13
ci_015                 1.782569e-02 3 1  ON 14
ci_016                 1.732111e-02 3 1  ON 15
ci_017                 1.773645e-02 3 1  ON 16
ci_018                 1.638064e-02 3 1  ON 17
ci_019                 1.648102e-02 3 1  ON 18
ci_020                 1.687439e-02 3 1  ON 19
ci_021                 1.703447e-02 3 1  ON 20
ci_022                 1.482783e-02 3 1  ON 21
ci_023                 1.444700e-02 3 1  ON 22
ci_024                 1.518558e-02 3 1  ON 23
ci_025                 1.428457e-02 3 1  ON 24
ci_026                 1.439892e-02 3 1  ON 25
ci_027                 1.458866e-02 3 1  ON 26
ci_028                -1.577327e-02 3 1  ON 27
ci_029                -1.535301e-02 3 1  ON 28
ci_030                -1.193313e-02 3 1  ON 29
ci_031                -1.256621e-02 3 1  ON 30
ci_032                -1.448862e-02 3 1  ON 31
ci_033                 1.203191e-02 3 1  ON 32
ci_034                 1.177327e-02 3 1  ON 33
ci_035                -7.972021e-03 3 1  ON 34
ci_036                -1.330596e-02 3 1  ON 35
ci_037                -1.271925e-02 3 1  ON 36
ci_038                 3.346385e-03 3 1  ON 37
ci_039                 3.638594e-03 3 1  ON 38
ci_040                -6.236318e-03 3 1  ON 39
ci_041                 1.069964e-02 3 1  ON 40
ci_042                 1.035018e-02 3 1  ON 41
ci_043                -5.682853e-03 3 1  ON 42
ci_044                -1.467568e-02 3 1  ON 43
ci_045                -4.117342e-03 3 1  ON 44
ci_046                 7.420284e-03 3 1  ON 45
ci_047                 7.733247e-03 3 1  ON 46
ci_048                -1.185838e-02 3 1  ON 47
ci_049                -1.171163e-02 3 1  ON 48
ci_050                 8.672203e-03 3 1  ON 49
ci_051                 8.968450e-03 3 1  ON 50
ci_052                -8.389390e-03 3 1  ON 51
ci_053                -8.216656e-03 3 1  ON 52
ci_054                -4.474956e-03 3 1  ON 53
ci_055                -4.410832e-03 3 1  ON 54
ci_056                 6.369460e-03 3 1  ON 55
ci_057                 6.626442e-03 3 1  ON 56
ci_058                -8.591756e-03 3 1  ON 57
ci_059                -8.503516e-03 3 1  ON 58
ci_060                 9.045784e-03 3 1  ON 59
ci_061                 9.621957e-03 3 1  ON 60
ci_062                -4.903052e-03 3 1  ON 61
ci_063                -4.956407e-03 3 1  ON 62
ci_064                -4.229768e-03 3 1  ON 63
ci_065                -5.224154e-03 3 1  ON 64
ci_066                 6.862921e-03 3 1  ON 65
ci_067                 6.732630e-03 3 1  ON 66
ci_068                -5.302966e-03 3 1  ON 67
ci_069                -5.354641e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.157
    reference variance = 0.387108
====================================================
  Execution time = 1.3904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0711e-01
  Total weights = 1.9556e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294858138827
                                         uncertainty =       0.001711304413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294858138827
                                         uncertainty =       0.001711304413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383904379
  error estimate for blocks of size 2^( 2) =       0.000395743501
  error estimate for blocks of size 2^( 3) =       0.000406419449
  error estimate for blocks of size 2^( 4) =       0.000413870610
  error estimate for blocks of size 2^( 5) =       0.000418765795
  error estimate for blocks of size 2^( 6) =       0.000421308040
  error estimate for blocks of size 2^( 7) =       0.000419755926

      target function =                  N/A
              le_mean =     -17.213740085566
             les_mean =     296.621195074312
             stat err =       0.000418425093
             autocorr =       1.187925787854
              std dev =       0.542922779293
             le_variance =       0.294765144275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293715538404
                                         uncertainty =       0.001705664439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293715538404
                                         uncertainty =       0.001705664439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383160272
  error estimate for blocks of size 2^( 2) =       0.000395047611
  error estimate for blocks of size 2^( 3) =       0.000405770601
  error estimate for blocks of size 2^( 4) =       0.000413266105
  error estimate for blocks of size 2^( 5) =       0.000418198784
  error estimate for blocks of size 2^( 6) =       0.000420762975
  error estimate for blocks of size 2^( 7) =       0.000419218460

      target function =                  N/A
              le_mean =     -17.213753067112
             les_mean =     296.622229310193
             stat err =       0.000417861581
             autocorr =       1.189334292425
              std dev =       0.541870452572
             le_variance =       0.293623587370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294153713631
                                         uncertainty =       0.001707307140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294153713631
                                         uncertainty =       0.001707307140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383445809
  error estimate for blocks of size 2^( 2) =       0.000395313877
  error estimate for blocks of size 2^( 3) =       0.000406018733
  error estimate for blocks of size 2^( 4) =       0.000413495926
  error estimate for blocks of size 2^( 5) =       0.000418416426
  error estimate for blocks of size 2^( 6) =       0.000420970888
  error estimate for blocks of size 2^( 7) =       0.000419423334

      target function =                  N/A
              le_mean =     -17.213745676197
             les_mean =     296.619970213232
             stat err =       0.000418076644
             autocorr =       1.188786381857
              std dev =       0.542274263151
             le_variance =       0.294061376476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294762690732
                                         uncertainty =       0.001710720254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294762690732
                                         uncertainty =       0.001710720254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383842276
  error estimate for blocks of size 2^( 2) =       0.000395685154
  error estimate for blocks of size 2^( 3) =       0.000406364855
  error estimate for blocks of size 2^( 4) =       0.000413819431
  error estimate for blocks of size 2^( 5) =       0.000418717788
  error estimate for blocks of size 2^( 6) =       0.000421261626
  error estimate for blocks of size 2^( 7) =       0.000419709952

      target function =                  N/A
              le_mean =     -17.213740502739
             les_mean =     296.620638495912
             stat err =       0.000418377199
             autocorr =       1.188038199016
              std dev =       0.542834952431
             le_variance =       0.294669785581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213740085566        initial
     9.7656e-01     9.7656e+00             7.7357e-04       -17.213753067112  <--
     3.9062e+00     3.9062e+01             2.2236e-04       -17.213745676197
     1.5625e+01     1.5625e+02             5.7771e-05       -17.213740502739

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3200e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.797460e-02 3 1  ON 0
ci_002                -3.622125e-02 3 1  ON 1
ci_003                -2.862331e-02 3 1  ON 2
ci_004                 2.606580e-02 3 1  ON 3
ci_005                 2.622871e-02 3 1  ON 4
ci_006                -2.393852e-02 3 1  ON 5
ci_007                -2.392547e-02 3 1  ON 6
ci_008                -2.105187e-02 3 1  ON 7
ci_009                -2.050833e-02 3 1  ON 8
ci_010                -2.013967e-02 3 1  ON 9
ci_011                -1.953970e-02 3 1  ON 10
ci_012                -1.933019e-02 3 1  ON 11
ci_013                -2.094494e-02 3 1  ON 12
ci_014                 1.756077e-02 3 1  ON 13
ci_015                 1.772756e-02 3 1  ON 14
ci_016                 1.725673e-02 3 1  ON 15
ci_017                 1.760644e-02 3 1  ON 16
ci_018                 1.628835e-02 3 1  ON 17
ci_019                 1.638559e-02 3 1  ON 18
ci_020                 1.689774e-02 3 1  ON 19
ci_021                 1.669697e-02 3 1  ON 20
ci_022                 1.476855e-02 3 1  ON 21
ci_023                 1.435730e-02 3 1  ON 22
ci_024                 1.477276e-02 3 1  ON 23
ci_025                 1.422106e-02 3 1  ON 24
ci_026                 1.424307e-02 3 1  ON 25
ci_027                 1.447115e-02 3 1  ON 26
ci_028                -1.559022e-02 3 1  ON 27
ci_029                -1.531704e-02 3 1  ON 28
ci_030                -1.201481e-02 3 1  ON 29
ci_031                -1.241153e-02 3 1  ON 30
ci_032                -1.437588e-02 3 1  ON 31
ci_033                 1.193103e-02 3 1  ON 32
ci_034                 1.160864e-02 3 1  ON 33
ci_035                -7.868672e-03 3 1  ON 34
ci_036                -1.307372e-02 3 1  ON 35
ci_037                -1.267829e-02 3 1  ON 36
ci_038                 3.276472e-03 3 1  ON 37
ci_039                 3.506540e-03 3 1  ON 38
ci_040                -6.127805e-03 3 1  ON 39
ci_041                 1.066721e-02 3 1  ON 40
ci_042                 1.028349e-02 3 1  ON 41
ci_043                -5.638188e-03 3 1  ON 42
ci_044                -1.468965e-02 3 1  ON 43
ci_045                -3.994223e-03 3 1  ON 44
ci_046                 7.309785e-03 3 1  ON 45
ci_047                 7.523987e-03 3 1  ON 46
ci_048                -1.184534e-02 3 1  ON 47
ci_049                -1.171140e-02 3 1  ON 48
ci_050                 8.692498e-03 3 1  ON 49
ci_051                 8.765569e-03 3 1  ON 50
ci_052                -8.353345e-03 3 1  ON 51
ci_053                -8.177478e-03 3 1  ON 52
ci_054                -4.405698e-03 3 1  ON 53
ci_055                -4.223560e-03 3 1  ON 54
ci_056                 6.303593e-03 3 1  ON 55
ci_057                 6.535867e-03 3 1  ON 56
ci_058                -8.514150e-03 3 1  ON 57
ci_059                -8.458875e-03 3 1  ON 58
ci_060                 9.132475e-03 3 1  ON 59
ci_061                 9.355549e-03 3 1  ON 60
ci_062                -4.768849e-03 3 1  ON 61
ci_063                -4.919377e-03 3 1  ON 62
ci_064                -4.203558e-03 3 1  ON 63
ci_065                -5.071845e-03 3 1  ON 64
ci_066                 6.664027e-03 3 1  ON 65
ci_067                 6.842974e-03 3 1  ON 66
ci_068                -5.220042e-03 3 1  ON 67
ci_069                -5.357265e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0999e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2555
    reference variance = 0.190536
====================================================
  Execution time = 1.4122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0929e-01
  Total weights = 1.956293708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295148961604
                                         uncertainty =       0.002106935359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295148961604
                                         uncertainty =       0.002106935359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384112826
  error estimate for blocks of size 2^( 2) =       0.000395610193
  error estimate for blocks of size 2^( 3) =       0.000406223868
  error estimate for blocks of size 2^( 4) =       0.000413485611
  error estimate for blocks of size 2^( 5) =       0.000417284034
  error estimate for blocks of size 2^( 6) =       0.000419315265
  error estimate for blocks of size 2^( 7) =       0.000422649739

      target function =                  N/A
              le_mean =     -17.214236415634
             les_mean =     296.639228967128
             stat err =       0.000418183662
             autocorr =       1.185267855579
              std dev =       0.543217567347
             le_variance =       0.295085325474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721423641563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214236415629       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214301833373       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214303530051       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214303173971       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.347097e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214236415629       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214262521337       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214263059719       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214262798796       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 4.969424e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214236415629       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214244085288       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214244270569       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214244191668       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.411401e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6661e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.767443e-02 3 1  ON 0
ci_002                -3.595197e-02 3 1  ON 1
ci_003                -2.836860e-02 3 1  ON 2
ci_004                 2.567378e-02 3 1  ON 3
ci_005                 2.573177e-02 3 1  ON 4
ci_006                -2.373546e-02 3 1  ON 5
ci_007                -2.373313e-02 3 1  ON 6
ci_008                -2.069305e-02 3 1  ON 7
ci_009                -2.043247e-02 3 1  ON 8
ci_010                -1.966965e-02 3 1  ON 9
ci_011                -1.945228e-02 3 1  ON 10
ci_012                -1.910222e-02 3 1  ON 11
ci_013                -2.096083e-02 3 1  ON 12
ci_014                 1.730107e-02 3 1  ON 13
ci_015                 1.738824e-02 3 1  ON 14
ci_016                 1.718868e-02 3 1  ON 15
ci_017                 1.747906e-02 3 1  ON 16
ci_018                 1.618113e-02 3 1  ON 17
ci_019                 1.629988e-02 3 1  ON 18
ci_020                 1.647770e-02 3 1  ON 19
ci_021                 1.674439e-02 3 1  ON 20
ci_022                 1.438296e-02 3 1  ON 21
ci_023                 1.412451e-02 3 1  ON 22
ci_024                 1.439895e-02 3 1  ON 23
ci_025                 1.407938e-02 3 1  ON 24
ci_026                 1.407550e-02 3 1  ON 25
ci_027                 1.428701e-02 3 1  ON 26
ci_028                -1.535825e-02 3 1  ON 27
ci_029                -1.517422e-02 3 1  ON 28
ci_030                -1.200847e-02 3 1  ON 29
ci_031                -1.213260e-02 3 1  ON 30
ci_032                -1.429351e-02 3 1  ON 31
ci_033                 1.171170e-02 3 1  ON 32
ci_034                 1.152000e-02 3 1  ON 33
ci_035                -7.612919e-03 3 1  ON 34
ci_036                -1.280982e-02 3 1  ON 35
ci_037                -1.253205e-02 3 1  ON 36
ci_038                 3.196742e-03 3 1  ON 37
ci_039                 3.270824e-03 3 1  ON 38
ci_040                -6.015840e-03 3 1  ON 39
ci_041                 1.045988e-02 3 1  ON 40
ci_042                 1.029695e-02 3 1  ON 41
ci_043                -5.461143e-03 3 1  ON 42
ci_044                -1.480788e-02 3 1  ON 43
ci_045                -3.863332e-03 3 1  ON 44
ci_046                 7.188452e-03 3 1  ON 45
ci_047                 7.228131e-03 3 1  ON 46
ci_048                -1.190323e-02 3 1  ON 47
ci_049                -1.187703e-02 3 1  ON 48
ci_050                 8.557839e-03 3 1  ON 49
ci_051                 8.849834e-03 3 1  ON 50
ci_052                -8.274980e-03 3 1  ON 51
ci_053                -7.896347e-03 3 1  ON 52
ci_054                -4.271125e-03 3 1  ON 53
ci_055                -4.060948e-03 3 1  ON 54
ci_056                 6.359620e-03 3 1  ON 55
ci_057                 6.315998e-03 3 1  ON 56
ci_058                -8.452068e-03 3 1  ON 57
ci_059                -8.187326e-03 3 1  ON 58
ci_060                 9.044136e-03 3 1  ON 59
ci_061                 9.158272e-03 3 1  ON 60
ci_062                -4.679578e-03 3 1  ON 61
ci_063                -4.790264e-03 3 1  ON 62
ci_064                -4.123507e-03 3 1  ON 63
ci_065                -4.917764e-03 3 1  ON 64
ci_066                 6.513808e-03 3 1  ON 65
ci_067                 6.762521e-03 3 1  ON 66
ci_068                -5.178112e-03 3 1  ON 67
ci_069                -5.279261e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2682
    reference variance = 0.326686
====================================================
  Execution time = 1.3713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0656e-01
  Total weights = 1.9562e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00030237
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295331635848
                                         uncertainty =       0.002546537754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295331635848
                                         uncertainty =       0.002546537754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384304053
  error estimate for blocks of size 2^( 2) =       0.000395568546
  error estimate for blocks of size 2^( 3) =       0.000405776811
  error estimate for blocks of size 2^( 4) =       0.000412434836
  error estimate for blocks of size 2^( 5) =       0.000416439553
  error estimate for blocks of size 2^( 6) =       0.000417872188
  error estimate for blocks of size 2^( 7) =       0.000419393928

      target function =                  N/A
              le_mean =     -17.214429703695
             les_mean =     296.646776449552
             stat err =       0.000416535126
             autocorr =       1.174771311194
              std dev =       0.543488004203
             le_variance =       0.295379210713

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000143673
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292572120181
                                         uncertainty =       0.002494759318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292572120181
                                         uncertainty =       0.002494759318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382503796
  error estimate for blocks of size 2^( 2) =       0.000393907942
  error estimate for blocks of size 2^( 3) =       0.000404274423
  error estimate for blocks of size 2^( 4) =       0.000411021465
  error estimate for blocks of size 2^( 5) =       0.000415124580
  error estimate for blocks of size 2^( 6) =       0.000416612818
  error estimate for blocks of size 2^( 7) =       0.000418123164

      target function =                  N/A
              le_mean =     -17.214457838519
             les_mean =     296.643351355803
             stat err =       0.000415220507
             autocorr =       1.178381972777
              std dev =       0.540942055800
             le_variance =       0.292618307733

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000302901
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292982025462
                                         uncertainty =       0.002501933580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292982025462
                                         uncertainty =       0.002501933580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382771729
  error estimate for blocks of size 2^( 2) =       0.000394154706
  error estimate for blocks of size 2^( 3) =       0.000404493344
  error estimate for blocks of size 2^( 4) =       0.000411224641
  error estimate for blocks of size 2^( 5) =       0.000415307025
  error estimate for blocks of size 2^( 6) =       0.000416779298
  error estimate for blocks of size 2^( 7) =       0.000418294208

      target function =                  N/A
              le_mean =     -17.214448724426
             les_mean =     296.657449381386
             stat err =       0.000415401293
             autocorr =       1.177757777483
              std dev =       0.541320969996
             le_variance =       0.293028392558

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000719254
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294948486993
                                         uncertainty =       0.002539550672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294948486993
                                         uncertainty =       0.002539550672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384054613
  error estimate for blocks of size 2^( 2) =       0.000395336180
  error estimate for blocks of size 2^( 3) =       0.000405563610
  error estimate for blocks of size 2^( 4) =       0.000412232108
  error estimate for blocks of size 2^( 5) =       0.000416248721
  error estimate for blocks of size 2^( 6) =       0.000417688830
  error estimate for blocks of size 2^( 7) =       0.000419209915

      target function =                  N/A
              le_mean =     -17.214428995177
             les_mean =     296.645789485833
             stat err =       0.000416344894
             autocorr =       1.175223622190
              std dev =       0.543135242851
             le_variance =       0.294995892027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214429703695        initial
     2.4414e-01     2.4414e+00             1.3471e-03       -17.214457838519  <--
     9.7656e-01     9.7656e+00             4.9694e-04       -17.214448724426
     3.9062e+00     3.9062e+01             1.4114e-04       -17.214428995177

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.2963e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.719391e-02 3 1  ON 0
ci_002                -3.556741e-02 3 1  ON 1
ci_003                -2.792731e-02 3 1  ON 2
ci_004                 2.499210e-02 3 1  ON 3
ci_005                 2.488161e-02 3 1  ON 4
ci_006                -2.344567e-02 3 1  ON 5
ci_007                -2.345298e-02 3 1  ON 6
ci_008                -2.020977e-02 3 1  ON 7
ci_009                -2.033486e-02 3 1  ON 8
ci_010                -1.885190e-02 3 1  ON 9
ci_011                -1.933006e-02 3 1  ON 10
ci_012                -1.874666e-02 3 1  ON 11
ci_013                -2.100711e-02 3 1  ON 12
ci_014                 1.690964e-02 3 1  ON 13
ci_015                 1.687370e-02 3 1  ON 14
ci_016                 1.714576e-02 3 1  ON 15
ci_017                 1.733622e-02 3 1  ON 16
ci_018                 1.604367e-02 3 1  ON 17
ci_019                 1.619253e-02 3 1  ON 18
ci_020                 1.579540e-02 3 1  ON 19
ci_021                 1.685773e-02 3 1  ON 20
ci_022                 1.384192e-02 3 1  ON 21
ci_023                 1.380769e-02 3 1  ON 22
ci_024                 1.372679e-02 3 1  ON 23
ci_025                 1.383333e-02 3 1  ON 24
ci_026                 1.383987e-02 3 1  ON 25
ci_027                 1.402385e-02 3 1  ON 26
ci_028                -1.502804e-02 3 1  ON 27
ci_029                -1.497921e-02 3 1  ON 28
ci_030                -1.204948e-02 3 1  ON 29
ci_031                -1.173698e-02 3 1  ON 30
ci_032                -1.417124e-02 3 1  ON 31
ci_033                 1.137646e-02 3 1  ON 32
ci_034                 1.138009e-02 3 1  ON 33
ci_035                -7.330739e-03 3 1  ON 34
ci_036                -1.240341e-02 3 1  ON 35
ci_037                -1.233012e-02 3 1  ON 36
ci_038                 3.112893e-03 3 1  ON 37
ci_039                 3.007084e-03 3 1  ON 38
ci_040                -5.905419e-03 3 1  ON 39
ci_041                 1.018536e-02 3 1  ON 40
ci_042                 1.035075e-02 3 1  ON 41
ci_043                -5.263150e-03 3 1  ON 42
ci_044                -1.502884e-02 3 1  ON 43
ci_045                -3.725651e-03 3 1  ON 44
ci_046                 7.019785e-03 3 1  ON 45
ci_047                 6.800550e-03 3 1  ON 46
ci_048                -1.208438e-02 3 1  ON 47
ci_049                -1.223770e-02 3 1  ON 48
ci_050                 8.394437e-03 3 1  ON 49
ci_051                 8.948951e-03 3 1  ON 50
ci_052                -8.173558e-03 3 1  ON 51
ci_053                -7.539568e-03 3 1  ON 52
ci_054                -4.084547e-03 3 1  ON 53
ci_055                -3.844286e-03 3 1  ON 54
ci_056                 6.426155e-03 3 1  ON 55
ci_057                 6.041034e-03 3 1  ON 56
ci_058                -8.376260e-03 3 1  ON 57
ci_059                -7.829706e-03 3 1  ON 58
ci_060                 8.909445e-03 3 1  ON 59
ci_061                 8.867265e-03 3 1  ON 60
ci_062                -4.563424e-03 3 1  ON 61
ci_063                -4.615208e-03 3 1  ON 62
ci_064                -4.042858e-03 3 1  ON 63
ci_065                -4.769548e-03 3 1  ON 64
ci_066                 6.325398e-03 3 1  ON 65
ci_067                 6.663683e-03 3 1  ON 66
ci_068                -5.152157e-03 3 1  ON 67
ci_069                -5.200527e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1411
    reference variance = 0.314187
====================================================
  Execution time = 1.4149e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0751e-01
  Total weights = 1.955746066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292729913804
                                         uncertainty =       0.002155127266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292729913804
                                         uncertainty =       0.002155127266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382555199
  error estimate for blocks of size 2^( 2) =       0.000394479551
  error estimate for blocks of size 2^( 3) =       0.000404699997
  error estimate for blocks of size 2^( 4) =       0.000412029850
  error estimate for blocks of size 2^( 5) =       0.000415998394
  error estimate for blocks of size 2^( 6) =       0.000419315041
  error estimate for blocks of size 2^( 7) =       0.000420556696

      target function =                  N/A
              le_mean =     -17.214587711438
             les_mean =     296.649537542098
             stat err =       0.000416974995
             autocorr =       1.188042036970
              std dev =       0.541014750672
             le_variance =       0.292696960445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721458771144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587711420       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214615183022       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214615917505       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214616540689       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214616792433       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.500687e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587711420       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214604788952       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214605101698       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214605329524       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 8.649090e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214587711420       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214594505924       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214594681581       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214594715049       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.236441e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6642e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.632900e-02 3 1  ON 0
ci_002                -3.497779e-02 3 1  ON 1
ci_003                -2.733388e-02 3 1  ON 2
ci_004                 2.468264e-02 3 1  ON 3
ci_005                 2.457735e-02 3 1  ON 4
ci_006                -2.314225e-02 3 1  ON 5
ci_007                -2.376256e-02 3 1  ON 6
ci_008                -2.026617e-02 3 1  ON 7
ci_009                -1.976898e-02 3 1  ON 8
ci_010                -1.833915e-02 3 1  ON 9
ci_011                -1.873935e-02 3 1  ON 10
ci_012                -1.831492e-02 3 1  ON 11
ci_013                -2.077873e-02 3 1  ON 12
ci_014                 1.633117e-02 3 1  ON 13
ci_015                 1.683826e-02 3 1  ON 14
ci_016                 1.746697e-02 3 1  ON 15
ci_017                 1.749900e-02 3 1  ON 16
ci_018                 1.591502e-02 3 1  ON 17
ci_019                 1.582110e-02 3 1  ON 18
ci_020                 1.589152e-02 3 1  ON 19
ci_021                 1.647967e-02 3 1  ON 20
ci_022                 1.395780e-02 3 1  ON 21
ci_023                 1.379793e-02 3 1  ON 22
ci_024                 1.323065e-02 3 1  ON 23
ci_025                 1.348471e-02 3 1  ON 24
ci_026                 1.399098e-02 3 1  ON 25
ci_027                 1.390913e-02 3 1  ON 26
ci_028                -1.471837e-02 3 1  ON 27
ci_029                -1.493635e-02 3 1  ON 28
ci_030                -1.166563e-02 3 1  ON 29
ci_031                -1.154363e-02 3 1  ON 30
ci_032                -1.428486e-02 3 1  ON 31
ci_033                 1.136716e-02 3 1  ON 32
ci_034                 1.085139e-02 3 1  ON 33
ci_035                -7.002138e-03 3 1  ON 34
ci_036                -1.240375e-02 3 1  ON 35
ci_037                -1.227540e-02 3 1  ON 36
ci_038                 2.917169e-03 3 1  ON 37
ci_039                 3.060977e-03 3 1  ON 38
ci_040                -5.812630e-03 3 1  ON 39
ci_041                 1.066549e-02 3 1  ON 40
ci_042                 1.015175e-02 3 1  ON 41
ci_043                -5.272840e-03 3 1  ON 42
ci_044                -1.488682e-02 3 1  ON 43
ci_045                -3.761609e-03 3 1  ON 44
ci_046                 6.898552e-03 3 1  ON 45
ci_047                 6.449960e-03 3 1  ON 46
ci_048                -1.162725e-02 3 1  ON 47
ci_049                -1.183127e-02 3 1  ON 48
ci_050                 8.448804e-03 3 1  ON 49
ci_051                 8.983641e-03 3 1  ON 50
ci_052                -8.660519e-03 3 1  ON 51
ci_053                -7.835376e-03 3 1  ON 52
ci_054                -4.014798e-03 3 1  ON 53
ci_055                -3.577346e-03 3 1  ON 54
ci_056                 6.617916e-03 3 1  ON 55
ci_057                 5.942886e-03 3 1  ON 56
ci_058                -8.188350e-03 3 1  ON 57
ci_059                -8.161680e-03 3 1  ON 58
ci_060                 8.739013e-03 3 1  ON 59
ci_061                 8.693905e-03 3 1  ON 60
ci_062                -4.488598e-03 3 1  ON 61
ci_063                -4.452622e-03 3 1  ON 62
ci_064                -4.308374e-03 3 1  ON 63
ci_065                -4.712415e-03 3 1  ON 64
ci_066                 6.456571e-03 3 1  ON 65
ci_067                 6.440869e-03 3 1  ON 66
ci_068                -5.328759e-03 3 1  ON 67
ci_069                -5.249500e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1601
    reference variance = 0.164905
====================================================
  Execution time = 1.3709e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0928e-01
  Total weights = 1.9561e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296565106284
                                         uncertainty =       0.002858319329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296565106284
                                         uncertainty =       0.002858319329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385046024
  error estimate for blocks of size 2^( 2) =       0.000396445912
  error estimate for blocks of size 2^( 3) =       0.000406521275
  error estimate for blocks of size 2^( 4) =       0.000413990555
  error estimate for blocks of size 2^( 5) =       0.000417363664
  error estimate for blocks of size 2^( 6) =       0.000419851506
  error estimate for blocks of size 2^( 7) =       0.000420624888

      target function =                  N/A
              le_mean =     -17.214229533103
             les_mean =     298.288539090027
             stat err =       0.000417957653
             autocorr =       1.178254964414
              std dev =       0.544537308901
             le_variance =       0.296520880785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293705231369
                                         uncertainty =       0.002070120738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293705231369
                                         uncertainty =       0.002070120738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383185387
  error estimate for blocks of size 2^( 2) =       0.000394705509
  error estimate for blocks of size 2^( 3) =       0.000404924527
  error estimate for blocks of size 2^( 4) =       0.000412427851
  error estimate for blocks of size 2^( 5) =       0.000415925364
  error estimate for blocks of size 2^( 6) =       0.000418551278
  error estimate for blocks of size 2^( 7) =       0.000419298039

      target function =                  N/A
              le_mean =     -17.214182890263
             les_mean =     296.742046378291
             stat err =       0.000416550633
             autocorr =       1.181728530753
              std dev =       0.541905971024
             le_variance =       0.293662081432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293586410465
                                         uncertainty =       0.002061618830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293586410465
                                         uncertainty =       0.002061618830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383108217
  error estimate for blocks of size 2^( 2) =       0.000394647058
  error estimate for blocks of size 2^( 3) =       0.000404896202
  error estimate for blocks of size 2^( 4) =       0.000412418046
  error estimate for blocks of size 2^( 5) =       0.000415920593
  error estimate for blocks of size 2^( 6) =       0.000418592781
  error estimate for blocks of size 2^( 7) =       0.000419375529

      target function =                  N/A
              le_mean =     -17.214197585093
             les_mean =     296.647337269875
             stat err =       0.000416576737
             autocorr =       1.182352829695
              std dev =       0.541796836168
             le_variance =       0.293543811682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294248751693
                                         uncertainty =       0.002077566801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294248751693
                                         uncertainty =       0.002077566801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383539553
  error estimate for blocks of size 2^( 2) =       0.000394997903
  error estimate for blocks of size 2^( 3) =       0.000405153954
  error estimate for blocks of size 2^( 4) =       0.000412600295
  error estimate for blocks of size 2^( 5) =       0.000416066409
  error estimate for blocks of size 2^( 6) =       0.000418668473
  error estimate for blocks of size 2^( 7) =       0.000419464638

      target function =                  N/A
              le_mean =     -17.214186199956
             les_mean =     296.638368824002
             stat err =       0.000416699954
             autocorr =       1.180392898839
              std dev =       0.542406838144
             le_variance =       0.294205178065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214229533103        initial  <--
     6.1035e-02     6.1035e-01             1.5007e-03       -17.214182890263
     2.4414e-01     2.4414e+00             8.6491e-04       -17.214197585093
     9.7656e-01     9.7656e+00             3.2364e-04       -17.214186199956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9770
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.719391e-02 3 1  ON 0
ci_002                -3.556741e-02 3 1  ON 1
ci_003                -2.792731e-02 3 1  ON 2
ci_004                 2.499210e-02 3 1  ON 3
ci_005                 2.488161e-02 3 1  ON 4
ci_006                -2.344567e-02 3 1  ON 5
ci_007                -2.345298e-02 3 1  ON 6
ci_008                -2.020977e-02 3 1  ON 7
ci_009                -2.033486e-02 3 1  ON 8
ci_010                -1.885190e-02 3 1  ON 9
ci_011                -1.933006e-02 3 1  ON 10
ci_012                -1.874666e-02 3 1  ON 11
ci_013                -2.100711e-02 3 1  ON 12
ci_014                 1.690964e-02 3 1  ON 13
ci_015                 1.687370e-02 3 1  ON 14
ci_016                 1.714576e-02 3 1  ON 15
ci_017                 1.733622e-02 3 1  ON 16
ci_018                 1.604367e-02 3 1  ON 17
ci_019                 1.619253e-02 3 1  ON 18
ci_020                 1.579540e-02 3 1  ON 19
ci_021                 1.685773e-02 3 1  ON 20
ci_022                 1.384192e-02 3 1  ON 21
ci_023                 1.380769e-02 3 1  ON 22
ci_024                 1.372679e-02 3 1  ON 23
ci_025                 1.383333e-02 3 1  ON 24
ci_026                 1.383987e-02 3 1  ON 25
ci_027                 1.402385e-02 3 1  ON 26
ci_028                -1.502804e-02 3 1  ON 27
ci_029                -1.497921e-02 3 1  ON 28
ci_030                -1.204948e-02 3 1  ON 29
ci_031                -1.173698e-02 3 1  ON 30
ci_032                -1.417124e-02 3 1  ON 31
ci_033                 1.137646e-02 3 1  ON 32
ci_034                 1.138009e-02 3 1  ON 33
ci_035                -7.330739e-03 3 1  ON 34
ci_036                -1.240341e-02 3 1  ON 35
ci_037                -1.233012e-02 3 1  ON 36
ci_038                 3.112893e-03 3 1  ON 37
ci_039                 3.007084e-03 3 1  ON 38
ci_040                -5.905419e-03 3 1  ON 39
ci_041                 1.018536e-02 3 1  ON 40
ci_042                 1.035075e-02 3 1  ON 41
ci_043                -5.263150e-03 3 1  ON 42
ci_044                -1.502884e-02 3 1  ON 43
ci_045                -3.725651e-03 3 1  ON 44
ci_046                 7.019785e-03 3 1  ON 45
ci_047                 6.800550e-03 3 1  ON 46
ci_048                -1.208438e-02 3 1  ON 47
ci_049                -1.223770e-02 3 1  ON 48
ci_050                 8.394437e-03 3 1  ON 49
ci_051                 8.948951e-03 3 1  ON 50
ci_052                -8.173558e-03 3 1  ON 51
ci_053                -7.539568e-03 3 1  ON 52
ci_054                -4.084547e-03 3 1  ON 53
ci_055                -3.844286e-03 3 1  ON 54
ci_056                 6.426155e-03 3 1  ON 55
ci_057                 6.041034e-03 3 1  ON 56
ci_058                -8.376260e-03 3 1  ON 57
ci_059                -7.829706e-03 3 1  ON 58
ci_060                 8.909445e-03 3 1  ON 59
ci_061                 8.867265e-03 3 1  ON 60
ci_062                -4.563424e-03 3 1  ON 61
ci_063                -4.615208e-03 3 1  ON 62
ci_064                -4.042858e-03 3 1  ON 63
ci_065                -4.769548e-03 3 1  ON 64
ci_066                 6.325398e-03 3 1  ON 65
ci_067                 6.663683e-03 3 1  ON 66
ci_068                -5.152157e-03 3 1  ON 67
ci_069                -5.200527e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.199054
====================================================
  Execution time = 1.4063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0759e-01
  Total weights = 1.955972214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292863194431
                                         uncertainty =       0.001805543562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292863194431
                                         uncertainty =       0.001805543562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382597586
  error estimate for blocks of size 2^( 2) =       0.000394477594
  error estimate for blocks of size 2^( 3) =       0.000404519387
  error estimate for blocks of size 2^( 4) =       0.000412511003
  error estimate for blocks of size 2^( 5) =       0.000417380087
  error estimate for blocks of size 2^( 6) =       0.000419423871
  error estimate for blocks of size 2^( 7) =       0.000421669401

      target function =                  N/A
              le_mean =     -17.213459359212
             les_mean =     296.610776417504
             stat err =       0.000417746091
             autocorr =       1.192175895065
              std dev =       0.541074695753
             le_variance =       0.292761826385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721345935921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213459359199       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213476585570       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213477017346       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213477051871       residual = 8.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 5.581550e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213459359199       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213464871727       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213464895243       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213464929198       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.740674e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213459359199       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213460841069       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213460839449       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213460848933       residual = 4.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 4.639668e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6546e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.705572e-02 3 1  ON 0
ci_002                -3.548577e-02 3 1  ON 1
ci_003                -2.778250e-02 3 1  ON 2
ci_004                 2.486757e-02 3 1  ON 3
ci_005                 2.486556e-02 3 1  ON 4
ci_006                -2.344630e-02 3 1  ON 5
ci_007                -2.332944e-02 3 1  ON 6
ci_008                -2.013542e-02 3 1  ON 7
ci_009                -2.028545e-02 3 1  ON 8
ci_010                -1.885106e-02 3 1  ON 9
ci_011                -1.915599e-02 3 1  ON 10
ci_012                -1.874248e-02 3 1  ON 11
ci_013                -2.095430e-02 3 1  ON 12
ci_014                 1.689576e-02 3 1  ON 13
ci_015                 1.678517e-02 3 1  ON 14
ci_016                 1.720339e-02 3 1  ON 15
ci_017                 1.726711e-02 3 1  ON 16
ci_018                 1.604422e-02 3 1  ON 17
ci_019                 1.613526e-02 3 1  ON 18
ci_020                 1.583516e-02 3 1  ON 19
ci_021                 1.675076e-02 3 1  ON 20
ci_022                 1.380048e-02 3 1  ON 21
ci_023                 1.378840e-02 3 1  ON 22
ci_024                 1.363488e-02 3 1  ON 23
ci_025                 1.378944e-02 3 1  ON 24
ci_026                 1.382793e-02 3 1  ON 25
ci_027                 1.404646e-02 3 1  ON 26
ci_028                -1.489585e-02 3 1  ON 27
ci_029                -1.494747e-02 3 1  ON 28
ci_030                -1.206754e-02 3 1  ON 29
ci_031                -1.172429e-02 3 1  ON 30
ci_032                -1.409862e-02 3 1  ON 31
ci_033                 1.135404e-02 3 1  ON 32
ci_034                 1.135355e-02 3 1  ON 33
ci_035                -7.320324e-03 3 1  ON 34
ci_036                -1.239690e-02 3 1  ON 35
ci_037                -1.232084e-02 3 1  ON 36
ci_038                 3.100788e-03 3 1  ON 37
ci_039                 3.039135e-03 3 1  ON 38
ci_040                -5.876574e-03 3 1  ON 39
ci_041                 1.025186e-02 3 1  ON 40
ci_042                 1.036790e-02 3 1  ON 41
ci_043                -5.198222e-03 3 1  ON 42
ci_044                -1.505679e-02 3 1  ON 43
ci_045                -3.746557e-03 3 1  ON 44
ci_046                 7.037754e-03 3 1  ON 45
ci_047                 6.783191e-03 3 1  ON 46
ci_048                -1.206782e-02 3 1  ON 47
ci_049                -1.219197e-02 3 1  ON 48
ci_050                 8.404863e-03 3 1  ON 49
ci_051                 8.990234e-03 3 1  ON 50
ci_052                -8.181130e-03 3 1  ON 51
ci_053                -7.618150e-03 3 1  ON 52
ci_054                -3.996366e-03 3 1  ON 53
ci_055                -3.811233e-03 3 1  ON 54
ci_056                 6.430414e-03 3 1  ON 55
ci_057                 6.125276e-03 3 1  ON 56
ci_058                -8.423770e-03 3 1  ON 57
ci_059                -7.931329e-03 3 1  ON 58
ci_060                 8.862897e-03 3 1  ON 59
ci_061                 8.812957e-03 3 1  ON 60
ci_062                -4.473411e-03 3 1  ON 61
ci_063                -4.506847e-03 3 1  ON 62
ci_064                -4.172475e-03 3 1  ON 63
ci_065                -4.789278e-03 3 1  ON 64
ci_066                 6.384667e-03 3 1  ON 65
ci_067                 6.634002e-03 3 1  ON 66
ci_068                -5.208047e-03 3 1  ON 67
ci_069                -5.110475e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1759
    reference variance = 0.224853
====================================================
  Execution time = 1.3760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0571e-01
  Total weights = 1.9560e+06
  Execution time = 1.8429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292925574633
                                         uncertainty =       0.001819064658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292925574633
                                         uncertainty =       0.001819064658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382740641
  error estimate for blocks of size 2^( 2) =       0.000394511931
  error estimate for blocks of size 2^( 3) =       0.000404835122
  error estimate for blocks of size 2^( 4) =       0.000412205998
  error estimate for blocks of size 2^( 5) =       0.000417130730
  error estimate for blocks of size 2^( 6) =       0.000418971179
  error estimate for blocks of size 2^( 7) =       0.000419760859

      target function =                  N/A
              le_mean =     -17.214616220143
             les_mean =     296.649021459198
             stat err =       0.000417017191
             autocorr =       1.187131308600
              std dev =       0.541277004733
             le_variance =       0.292980795853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292719118643
                                         uncertainty =       0.001816001228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292719118643
                                         uncertainty =       0.001816001228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382606566
  error estimate for blocks of size 2^( 2) =       0.000394395717
  error estimate for blocks of size 2^( 3) =       0.000404736298
  error estimate for blocks of size 2^( 4) =       0.000412134011
  error estimate for blocks of size 2^( 5) =       0.000417077360
  error estimate for blocks of size 2^( 6) =       0.000418901802
  error estimate for blocks of size 2^( 7) =       0.000419705077

      target function =                  N/A
              le_mean =     -17.214623087844
             les_mean =     296.649321224936
             stat err =       0.000416954563
             autocorr =       1.187606659562
              std dev =       0.541087394215
             le_variance =       0.292775568179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292790752696
                                         uncertainty =       0.001816162172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292790752696
                                         uncertainty =       0.001816162172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382653081
  error estimate for blocks of size 2^( 2) =       0.000394435035
  error estimate for blocks of size 2^( 3) =       0.000404768447
  error estimate for blocks of size 2^( 4) =       0.000412155506
  error estimate for blocks of size 2^( 5) =       0.000417091714
  error estimate for blocks of size 2^( 6) =       0.000418921583
  error estimate for blocks of size 2^( 7) =       0.000419720445

      target function =                  N/A
              le_mean =     -17.214618860320
             les_mean =     296.649046515237
             stat err =       0.000416972312
             autocorr =       1.187419034337
              std dev =       0.541153176825
             le_variance =       0.292846760788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292905311326
                                         uncertainty =       0.001818597918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292905311326
                                         uncertainty =       0.001818597918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382727475
  error estimate for blocks of size 2^( 2) =       0.000394500162
  error estimate for blocks of size 2^( 3) =       0.000404824655
  error estimate for blocks of size 2^( 4) =       0.000412197684
  error estimate for blocks of size 2^( 5) =       0.000417123949
  error estimate for blocks of size 2^( 6) =       0.000418963053
  error estimate for blocks of size 2^( 7) =       0.000419754152

      target function =                  N/A
              le_mean =     -17.214616265986
             les_mean =     296.648854027943
             stat err =       0.000417009710
             autocorr =       1.187170383519
              std dev =       0.541258385956
             le_variance =       0.292960640368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214616220143        initial
     6.1035e-01     6.1035e+00             5.5816e-04       -17.214623087844  <--
     2.4414e+00     2.4414e+01             1.7407e-04       -17.214618860320
     9.7656e+00     9.7656e+01             4.6397e-05       -17.214616265986

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.2988e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.674146e-02 3 1  ON 0
ci_002                -3.530880e-02 3 1  ON 1
ci_003                -2.744978e-02 3 1  ON 2
ci_004                 2.458493e-02 3 1  ON 3
ci_005                 2.483699e-02 3 1  ON 4
ci_006                -2.345204e-02 3 1  ON 5
ci_007                -2.305746e-02 3 1  ON 6
ci_008                -1.998403e-02 3 1  ON 7
ci_009                -2.018435e-02 3 1  ON 8
ci_010                -1.885182e-02 3 1  ON 9
ci_011                -1.877190e-02 3 1  ON 10
ci_012                -1.873186e-02 3 1  ON 11
ci_013                -2.083925e-02 3 1  ON 12
ci_014                 1.686990e-02 3 1  ON 13
ci_015                 1.659140e-02 3 1  ON 14
ci_016                 1.734426e-02 3 1  ON 15
ci_017                 1.712223e-02 3 1  ON 16
ci_018                 1.604829e-02 3 1  ON 17
ci_019                 1.601382e-02 3 1  ON 18
ci_020                 1.593679e-02 3 1  ON 19
ci_021                 1.651462e-02 3 1  ON 20
ci_022                 1.372025e-02 3 1  ON 21
ci_023                 1.375064e-02 3 1  ON 22
ci_024                 1.341108e-02 3 1  ON 23
ci_025                 1.368207e-02 3 1  ON 24
ci_026                 1.380880e-02 3 1  ON 25
ci_027                 1.409951e-02 3 1  ON 26
ci_028                -1.460002e-02 3 1  ON 27
ci_029                -1.488664e-02 3 1  ON 28
ci_030                -1.211117e-02 3 1  ON 29
ci_031                -1.169763e-02 3 1  ON 30
ci_032                -1.395207e-02 3 1  ON 31
ci_033                 1.129997e-02 3 1  ON 32
ci_034                 1.129394e-02 3 1  ON 33
ci_035                -7.302459e-03 3 1  ON 34
ci_036                -1.238279e-02 3 1  ON 35
ci_037                -1.230021e-02 3 1  ON 36
ci_038                 3.080114e-03 3 1  ON 37
ci_039                 3.098642e-03 3 1  ON 38
ci_040                -5.824129e-03 3 1  ON 39
ci_041                 1.039696e-02 3 1  ON 40
ci_042                 1.041040e-02 3 1  ON 41
ci_043                -5.076455e-03 3 1  ON 42
ci_044                -1.512533e-02 3 1  ON 43
ci_045                -3.781085e-03 3 1  ON 44
ci_046                 7.077332e-03 3 1  ON 45
ci_047                 6.747078e-03 3 1  ON 46
ci_048                -1.204107e-02 3 1  ON 47
ci_049                -1.209493e-02 3 1  ON 48
ci_050                 8.420150e-03 3 1  ON 49
ci_051                 9.067476e-03 3 1  ON 50
ci_052                -8.194149e-03 3 1  ON 51
ci_053                -7.775279e-03 3 1  ON 52
ci_054                -3.819231e-03 3 1  ON 53
ci_055                -3.746915e-03 3 1  ON 54
ci_056                 6.441390e-03 3 1  ON 55
ci_057                 6.287961e-03 3 1  ON 56
ci_058                -8.519385e-03 3 1  ON 57
ci_059                -8.135899e-03 3 1  ON 58
ci_060                 8.763092e-03 3 1  ON 59
ci_061                 8.694960e-03 3 1  ON 60
ci_062                -4.290394e-03 3 1  ON 61
ci_063                -4.285904e-03 3 1  ON 62
ci_064                -4.383077e-03 3 1  ON 63
ci_065                -4.823599e-03 3 1  ON 64
ci_066                 6.498205e-03 3 1  ON 65
ci_067                 6.578278e-03 3 1  ON 66
ci_068                -5.330589e-03 3 1  ON 67
ci_069                -4.923779e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9548e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2596
    reference variance = 0.276495
====================================================
  Execution time = 1.4084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0353e-01
  Total weights = 1.955816922e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291019528123
                                         uncertainty =       0.001683178660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291019528123
                                         uncertainty =       0.001683178660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381435031
  error estimate for blocks of size 2^( 2) =       0.000393047807
  error estimate for blocks of size 2^( 3) =       0.000402875984
  error estimate for blocks of size 2^( 4) =       0.000410745159
  error estimate for blocks of size 2^( 5) =       0.000415530636
  error estimate for blocks of size 2^( 6) =       0.000417611514
  error estimate for blocks of size 2^( 7) =       0.000419477989

      target function =                  N/A
              le_mean =     -17.213915719760
             les_mean =     296.622426347756
             stat err =       0.000415841324
             autocorr =       1.188540922268
              std dev =       0.539430593379
             le_variance =       0.290985365073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721391571976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213915719760       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213940594659       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213940145683       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213940346754       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.134076e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213915719760       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213927127425       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213927134036       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213927179081       residual = 3.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.817909e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213915719760       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213919323396       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213919402576       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213919414063       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.464597e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6579e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.625967e-02 3 1  ON 0
ci_002                -3.517369e-02 3 1  ON 1
ci_003                -2.731932e-02 3 1  ON 2
ci_004                 2.425485e-02 3 1  ON 3
ci_005                 2.448581e-02 3 1  ON 4
ci_006                -2.339529e-02 3 1  ON 5
ci_007                -2.297364e-02 3 1  ON 6
ci_008                -2.010323e-02 3 1  ON 7
ci_009                -1.978560e-02 3 1  ON 8
ci_010                -1.880493e-02 3 1  ON 9
ci_011                -1.846805e-02 3 1  ON 10
ci_012                -1.865685e-02 3 1  ON 11
ci_013                -2.078768e-02 3 1  ON 12
ci_014                 1.665667e-02 3 1  ON 13
ci_015                 1.670609e-02 3 1  ON 14
ci_016                 1.740207e-02 3 1  ON 15
ci_017                 1.709228e-02 3 1  ON 16
ci_018                 1.607580e-02 3 1  ON 17
ci_019                 1.574288e-02 3 1  ON 18
ci_020                 1.600173e-02 3 1  ON 19
ci_021                 1.643731e-02 3 1  ON 20
ci_022                 1.380644e-02 3 1  ON 21
ci_023                 1.366634e-02 3 1  ON 22
ci_024                 1.303788e-02 3 1  ON 23
ci_025                 1.359305e-02 3 1  ON 24
ci_026                 1.377065e-02 3 1  ON 25
ci_027                 1.411519e-02 3 1  ON 26
ci_028                -1.464974e-02 3 1  ON 27
ci_029                -1.493893e-02 3 1  ON 28
ci_030                -1.230287e-02 3 1  ON 29
ci_031                -1.182646e-02 3 1  ON 30
ci_032                -1.375880e-02 3 1  ON 31
ci_033                 1.123702e-02 3 1  ON 32
ci_034                 1.109111e-02 3 1  ON 33
ci_035                -7.240402e-03 3 1  ON 34
ci_036                -1.201503e-02 3 1  ON 35
ci_037                -1.203057e-02 3 1  ON 36
ci_038                 2.945549e-03 3 1  ON 37
ci_039                 3.015647e-03 3 1  ON 38
ci_040                -5.642666e-03 3 1  ON 39
ci_041                 1.040801e-02 3 1  ON 40
ci_042                 1.047191e-02 3 1  ON 41
ci_043                -5.031616e-03 3 1  ON 42
ci_044                -1.527141e-02 3 1  ON 43
ci_045                -3.750768e-03 3 1  ON 44
ci_046                 6.986398e-03 3 1  ON 45
ci_047                 6.650828e-03 3 1  ON 46
ci_048                -1.180312e-02 3 1  ON 47
ci_049                -1.209943e-02 3 1  ON 48
ci_050                 8.463487e-03 3 1  ON 49
ci_051                 8.789370e-03 3 1  ON 50
ci_052                -8.065215e-03 3 1  ON 51
ci_053                -7.813226e-03 3 1  ON 52
ci_054                -3.915645e-03 3 1  ON 53
ci_055                -3.918543e-03 3 1  ON 54
ci_056                 6.291913e-03 3 1  ON 55
ci_057                 6.340122e-03 3 1  ON 56
ci_058                -8.552364e-03 3 1  ON 57
ci_059                -8.291291e-03 3 1  ON 58
ci_060                 8.752903e-03 3 1  ON 59
ci_061                 8.551186e-03 3 1  ON 60
ci_062                -4.287803e-03 3 1  ON 61
ci_063                -4.447652e-03 3 1  ON 62
ci_064                -4.383971e-03 3 1  ON 63
ci_065                -4.813879e-03 3 1  ON 64
ci_066                 6.521609e-03 3 1  ON 65
ci_067                 6.432337e-03 3 1  ON 66
ci_068                -5.089915e-03 3 1  ON 67
ci_069                -4.849224e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.197287
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0826e-01
  Total weights = 1.9557e+06
  Execution time = 1.8521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293495922246
                                         uncertainty =       0.001763846945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293495922246
                                         uncertainty =       0.001763846945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383060607
  error estimate for blocks of size 2^( 2) =       0.000394662322
  error estimate for blocks of size 2^( 3) =       0.000405086886
  error estimate for blocks of size 2^( 4) =       0.000411531928
  error estimate for blocks of size 2^( 5) =       0.000416520748
  error estimate for blocks of size 2^( 6) =       0.000419116351
  error estimate for blocks of size 2^( 7) =       0.000420314033

      target function =                  N/A
              le_mean =     -17.214333740646
             les_mean =     296.642531443517
             stat err =       0.000416870765
             autocorr =       1.184316806727
              std dev =       0.541729506107
             le_variance =       0.293470857787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293249865106
                                         uncertainty =       0.001770955691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293249865106
                                         uncertainty =       0.001770955691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382900376
  error estimate for blocks of size 2^( 2) =       0.000394545637
  error estimate for blocks of size 2^( 3) =       0.000405026164
  error estimate for blocks of size 2^( 4) =       0.000411507750
  error estimate for blocks of size 2^( 5) =       0.000416512299
  error estimate for blocks of size 2^( 6) =       0.000419104379
  error estimate for blocks of size 2^( 7) =       0.000420282981

      target function =                  N/A
              le_mean =     -17.214333799827
             les_mean =     296.645043982075
             stat err =       0.000416851852
             autocorr =       1.185200658899
              std dev =       0.541502905432
             le_variance =       0.293225396592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293278655951
                                         uncertainty =       0.001767956184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293278655951
                                         uncertainty =       0.001767956184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382919166
  error estimate for blocks of size 2^( 2) =       0.000394563569
  error estimate for blocks of size 2^( 3) =       0.000405041470
  error estimate for blocks of size 2^( 4) =       0.000411521287
  error estimate for blocks of size 2^( 5) =       0.000416535901
  error estimate for blocks of size 2^( 6) =       0.000419111998
  error estimate for blocks of size 2^( 7) =       0.000420280045

      target function =                  N/A
              le_mean =     -17.214340057429
             les_mean =     296.747971441877
             stat err =       0.000416862308
             autocorr =       1.185143799738
              std dev =       0.541529477233
             le_variance =       0.293254174713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293427574828
                                         uncertainty =       0.001764424951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293427574828
                                         uncertainty =       0.001764424951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383016060
  error estimate for blocks of size 2^( 2) =       0.000394624496
  error estimate for blocks of size 2^( 3) =       0.000405057667
  error estimate for blocks of size 2^( 4) =       0.000411507754
  error estimate for blocks of size 2^( 5) =       0.000416498932
  error estimate for blocks of size 2^( 6) =       0.000419092061
  error estimate for blocks of size 2^( 7) =       0.000420290849

      target function =                  N/A
              le_mean =     -17.214331787954
             les_mean =     296.641739952248
             stat err =       0.000416847399
             autocorr =       1.184459516138
              std dev =       0.541666507303
             le_variance =       0.293402605133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214333740646        initial
     1.5259e-01     1.5259e+00             1.1341e-03       -17.214333799827
     6.1035e-01     6.1035e+00             4.8179e-04       -17.214340057429  <--
     2.4414e+00     2.4414e+01             1.4646e-04       -17.214331787954

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.2983e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.625967e-02 3 1  ON 0
ci_002                -3.517369e-02 3 1  ON 1
ci_003                -2.731932e-02 3 1  ON 2
ci_004                 2.425485e-02 3 1  ON 3
ci_005                 2.448581e-02 3 1  ON 4
ci_006                -2.339529e-02 3 1  ON 5
ci_007                -2.297364e-02 3 1  ON 6
ci_008                -2.010323e-02 3 1  ON 7
ci_009                -1.978560e-02 3 1  ON 8
ci_010                -1.880493e-02 3 1  ON 9
ci_011                -1.846805e-02 3 1  ON 10
ci_012                -1.865685e-02 3 1  ON 11
ci_013                -2.078768e-02 3 1  ON 12
ci_014                 1.665667e-02 3 1  ON 13
ci_015                 1.670609e-02 3 1  ON 14
ci_016                 1.740207e-02 3 1  ON 15
ci_017                 1.709228e-02 3 1  ON 16
ci_018                 1.607580e-02 3 1  ON 17
ci_019                 1.574288e-02 3 1  ON 18
ci_020                 1.600173e-02 3 1  ON 19
ci_021                 1.643731e-02 3 1  ON 20
ci_022                 1.380644e-02 3 1  ON 21
ci_023                 1.366634e-02 3 1  ON 22
ci_024                 1.303788e-02 3 1  ON 23
ci_025                 1.359305e-02 3 1  ON 24
ci_026                 1.377065e-02 3 1  ON 25
ci_027                 1.411519e-02 3 1  ON 26
ci_028                -1.464974e-02 3 1  ON 27
ci_029                -1.493893e-02 3 1  ON 28
ci_030                -1.230287e-02 3 1  ON 29
ci_031                -1.182646e-02 3 1  ON 30
ci_032                -1.375880e-02 3 1  ON 31
ci_033                 1.123702e-02 3 1  ON 32
ci_034                 1.109111e-02 3 1  ON 33
ci_035                -7.240402e-03 3 1  ON 34
ci_036                -1.201503e-02 3 1  ON 35
ci_037                -1.203057e-02 3 1  ON 36
ci_038                 2.945549e-03 3 1  ON 37
ci_039                 3.015647e-03 3 1  ON 38
ci_040                -5.642666e-03 3 1  ON 39
ci_041                 1.040801e-02 3 1  ON 40
ci_042                 1.047191e-02 3 1  ON 41
ci_043                -5.031616e-03 3 1  ON 42
ci_044                -1.527141e-02 3 1  ON 43
ci_045                -3.750768e-03 3 1  ON 44
ci_046                 6.986398e-03 3 1  ON 45
ci_047                 6.650828e-03 3 1  ON 46
ci_048                -1.180312e-02 3 1  ON 47
ci_049                -1.209943e-02 3 1  ON 48
ci_050                 8.463487e-03 3 1  ON 49
ci_051                 8.789370e-03 3 1  ON 50
ci_052                -8.065215e-03 3 1  ON 51
ci_053                -7.813226e-03 3 1  ON 52
ci_054                -3.915645e-03 3 1  ON 53
ci_055                -3.918543e-03 3 1  ON 54
ci_056                 6.291913e-03 3 1  ON 55
ci_057                 6.340122e-03 3 1  ON 56
ci_058                -8.552364e-03 3 1  ON 57
ci_059                -8.291291e-03 3 1  ON 58
ci_060                 8.752903e-03 3 1  ON 59
ci_061                 8.551186e-03 3 1  ON 60
ci_062                -4.287803e-03 3 1  ON 61
ci_063                -4.447652e-03 3 1  ON 62
ci_064                -4.383971e-03 3 1  ON 63
ci_065                -4.813879e-03 3 1  ON 64
ci_066                 6.521609e-03 3 1  ON 65
ci_067                 6.432337e-03 3 1  ON 66
ci_068                -5.089915e-03 3 1  ON 67
ci_069                -4.849224e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.283875
====================================================
  Execution time = 1.4193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0353e-01
  Total weights = 1.955850309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291356183640
                                         uncertainty =       0.001862151289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291356183640
                                         uncertainty =       0.001862151289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381651245
  error estimate for blocks of size 2^( 2) =       0.000393523493
  error estimate for blocks of size 2^( 3) =       0.000403942641
  error estimate for blocks of size 2^( 4) =       0.000411825854
  error estimate for blocks of size 2^( 5) =       0.000417013229
  error estimate for blocks of size 2^( 6) =       0.000420455440
  error estimate for blocks of size 2^( 7) =       0.000423016254

      target function =                  N/A
              le_mean =     -17.213844118118
             les_mean =     296.619954489737
             stat err =       0.000418077694
             autocorr =       1.199998292140
              std dev =       0.539736366678
             le_variance =       0.291315345515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721384411812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213844118057       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213867319491       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213867660608       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213867639863       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.230271e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213844118057       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213855418772       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213855405146       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213855385828       residual = 2.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 5.272031e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213844118057       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213847821115       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213847848284       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.601813e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6681e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.573247e-02 3 1  ON 0
ci_002                -3.486692e-02 3 1  ON 1
ci_003                -2.722345e-02 3 1  ON 2
ci_004                 2.432920e-02 3 1  ON 3
ci_005                 2.433293e-02 3 1  ON 4
ci_006                -2.334516e-02 3 1  ON 5
ci_007                -2.299679e-02 3 1  ON 6
ci_008                -2.017155e-02 3 1  ON 7
ci_009                -1.962835e-02 3 1  ON 8
ci_010                -1.860399e-02 3 1  ON 9
ci_011                -1.854561e-02 3 1  ON 10
ci_012                -1.865949e-02 3 1  ON 11
ci_013                -2.050142e-02 3 1  ON 12
ci_014                 1.670370e-02 3 1  ON 13
ci_015                 1.669294e-02 3 1  ON 14
ci_016                 1.741352e-02 3 1  ON 15
ci_017                 1.720670e-02 3 1  ON 16
ci_018                 1.602032e-02 3 1  ON 17
ci_019                 1.567301e-02 3 1  ON 18
ci_020                 1.602140e-02 3 1  ON 19
ci_021                 1.634599e-02 3 1  ON 20
ci_022                 1.406060e-02 3 1  ON 21
ci_023                 1.371154e-02 3 1  ON 22
ci_024                 1.284150e-02 3 1  ON 23
ci_025                 1.356944e-02 3 1  ON 24
ci_026                 1.397491e-02 3 1  ON 25
ci_027                 1.414341e-02 3 1  ON 26
ci_028                -1.469629e-02 3 1  ON 27
ci_029                -1.523498e-02 3 1  ON 28
ci_030                -1.229373e-02 3 1  ON 29
ci_031                -1.176696e-02 3 1  ON 30
ci_032                -1.361848e-02 3 1  ON 31
ci_033                 1.127878e-02 3 1  ON 32
ci_034                 1.108533e-02 3 1  ON 33
ci_035                -7.087070e-03 3 1  ON 34
ci_036                -1.226174e-02 3 1  ON 35
ci_037                -1.207988e-02 3 1  ON 36
ci_038                 2.835686e-03 3 1  ON 37
ci_039                 3.039918e-03 3 1  ON 38
ci_040                -5.750031e-03 3 1  ON 39
ci_041                 1.040704e-02 3 1  ON 40
ci_042                 1.046239e-02 3 1  ON 41
ci_043                -5.006468e-03 3 1  ON 42
ci_044                -1.522193e-02 3 1  ON 43
ci_045                -3.616912e-03 3 1  ON 44
ci_046                 7.141888e-03 3 1  ON 45
ci_047                 6.905555e-03 3 1  ON 46
ci_048                -1.198785e-02 3 1  ON 47
ci_049                -1.206716e-02 3 1  ON 48
ci_050                 8.582311e-03 3 1  ON 49
ci_051                 8.523193e-03 3 1  ON 50
ci_052                -7.925695e-03 3 1  ON 51
ci_053                -7.846566e-03 3 1  ON 52
ci_054                -3.828220e-03 3 1  ON 53
ci_055                -3.857354e-03 3 1  ON 54
ci_056                 6.200347e-03 3 1  ON 55
ci_057                 6.339914e-03 3 1  ON 56
ci_058                -8.275206e-03 3 1  ON 57
ci_059                -8.306193e-03 3 1  ON 58
ci_060                 8.851172e-03 3 1  ON 59
ci_061                 8.515191e-03 3 1  ON 60
ci_062                -4.195999e-03 3 1  ON 61
ci_063                -4.487106e-03 3 1  ON 62
ci_064                -4.011638e-03 3 1  ON 63
ci_065                -4.951944e-03 3 1  ON 64
ci_066                 6.539981e-03 3 1  ON 65
ci_067                 6.428557e-03 3 1  ON 66
ci_068                -5.243892e-03 3 1  ON 67
ci_069                -4.936554e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1602
    reference variance = 0.348227
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0337e-01
  Total weights = 1.9562e+06
  Execution time = 1.8479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290125059508
                                         uncertainty =       0.001911971062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290125059508
                                         uncertainty =       0.001911971062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380850870
  error estimate for blocks of size 2^( 2) =       0.000392313222
  error estimate for blocks of size 2^( 3) =       0.000402927518
  error estimate for blocks of size 2^( 4) =       0.000411103937
  error estimate for blocks of size 2^( 5) =       0.000415802369
  error estimate for blocks of size 2^( 6) =       0.000417530040
  error estimate for blocks of size 2^( 7) =       0.000417728841

      target function =                  N/A
              le_mean =     -17.214468961400
             les_mean =     296.641587298217
             stat err =       0.000415541297
             autocorr =       1.190470060755
              std dev =       0.538604465516
             le_variance =       0.290094770274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289744996088
                                         uncertainty =       0.001906302418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289744996088
                                         uncertainty =       0.001906302418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380600868
  error estimate for blocks of size 2^( 2) =       0.000392091895
  error estimate for blocks of size 2^( 3) =       0.000402742768
  error estimate for blocks of size 2^( 4) =       0.000410956520
  error estimate for blocks of size 2^( 5) =       0.000415680592
  error estimate for blocks of size 2^( 6) =       0.000417398802
  error estimate for blocks of size 2^( 7) =       0.000417577821

      target function =                  N/A
              le_mean =     -17.214484439054
             les_mean =     296.645253949181
             stat err =       0.000415403434
             autocorr =       1.191243698318
              std dev =       0.538250908953
             le_variance =       0.289714040989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289768403010
                                         uncertainty =       0.001906118137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289768403010
                                         uncertainty =       0.001906118137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380616249
  error estimate for blocks of size 2^( 2) =       0.000392107681
  error estimate for blocks of size 2^( 3) =       0.000402757453
  error estimate for blocks of size 2^( 4) =       0.000410968382
  error estimate for blocks of size 2^( 5) =       0.000415690500
  error estimate for blocks of size 2^( 6) =       0.000417405806
  error estimate for blocks of size 2^( 7) =       0.000417590663

      target function =                  N/A
              le_mean =     -17.214486304068
             les_mean =     296.644898836874
             stat err =       0.000415413838
             autocorr =       1.191207085803
              std dev =       0.538272661710
             le_variance =       0.289737458344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290049760318
                                         uncertainty =       0.001910444966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290049760318
                                         uncertainty =       0.001910444966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380801374
  error estimate for blocks of size 2^( 2) =       0.000392268685
  error estimate for blocks of size 2^( 3) =       0.000402888816
  error estimate for blocks of size 2^( 4) =       0.000411070958
  error estimate for blocks of size 2^( 5) =       0.000415773062
  error estimate for blocks of size 2^( 6) =       0.000417497932
  error estimate for blocks of size 2^( 7) =       0.000417693793

      target function =                  N/A
              le_mean =     -17.214469645505
             les_mean =     296.641445964113
             stat err =       0.000415508936
             autocorr =       1.190594093983
              std dev =       0.538534467465
             le_variance =       0.290019372648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214468961400        initial
     1.5259e-01     1.5259e+00             1.2303e-03       -17.214484439054
     6.1035e-01     6.1035e+00             5.2720e-04       -17.214486304068  <--
     2.4414e+00     2.4414e+01             1.6018e-04       -17.214469645505

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.2961e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.573247e-02 3 1  ON 0
ci_002                -3.486692e-02 3 1  ON 1
ci_003                -2.722345e-02 3 1  ON 2
ci_004                 2.432920e-02 3 1  ON 3
ci_005                 2.433293e-02 3 1  ON 4
ci_006                -2.334516e-02 3 1  ON 5
ci_007                -2.299679e-02 3 1  ON 6
ci_008                -2.017155e-02 3 1  ON 7
ci_009                -1.962835e-02 3 1  ON 8
ci_010                -1.860399e-02 3 1  ON 9
ci_011                -1.854561e-02 3 1  ON 10
ci_012                -1.865949e-02 3 1  ON 11
ci_013                -2.050142e-02 3 1  ON 12
ci_014                 1.670370e-02 3 1  ON 13
ci_015                 1.669294e-02 3 1  ON 14
ci_016                 1.741352e-02 3 1  ON 15
ci_017                 1.720670e-02 3 1  ON 16
ci_018                 1.602032e-02 3 1  ON 17
ci_019                 1.567301e-02 3 1  ON 18
ci_020                 1.602140e-02 3 1  ON 19
ci_021                 1.634599e-02 3 1  ON 20
ci_022                 1.406060e-02 3 1  ON 21
ci_023                 1.371154e-02 3 1  ON 22
ci_024                 1.284150e-02 3 1  ON 23
ci_025                 1.356944e-02 3 1  ON 24
ci_026                 1.397491e-02 3 1  ON 25
ci_027                 1.414341e-02 3 1  ON 26
ci_028                -1.469629e-02 3 1  ON 27
ci_029                -1.523498e-02 3 1  ON 28
ci_030                -1.229373e-02 3 1  ON 29
ci_031                -1.176696e-02 3 1  ON 30
ci_032                -1.361848e-02 3 1  ON 31
ci_033                 1.127878e-02 3 1  ON 32
ci_034                 1.108533e-02 3 1  ON 33
ci_035                -7.087070e-03 3 1  ON 34
ci_036                -1.226174e-02 3 1  ON 35
ci_037                -1.207988e-02 3 1  ON 36
ci_038                 2.835686e-03 3 1  ON 37
ci_039                 3.039918e-03 3 1  ON 38
ci_040                -5.750031e-03 3 1  ON 39
ci_041                 1.040704e-02 3 1  ON 40
ci_042                 1.046239e-02 3 1  ON 41
ci_043                -5.006468e-03 3 1  ON 42
ci_044                -1.522193e-02 3 1  ON 43
ci_045                -3.616912e-03 3 1  ON 44
ci_046                 7.141888e-03 3 1  ON 45
ci_047                 6.905555e-03 3 1  ON 46
ci_048                -1.198785e-02 3 1  ON 47
ci_049                -1.206716e-02 3 1  ON 48
ci_050                 8.582311e-03 3 1  ON 49
ci_051                 8.523193e-03 3 1  ON 50
ci_052                -7.925695e-03 3 1  ON 51
ci_053                -7.846566e-03 3 1  ON 52
ci_054                -3.828220e-03 3 1  ON 53
ci_055                -3.857354e-03 3 1  ON 54
ci_056                 6.200347e-03 3 1  ON 55
ci_057                 6.339914e-03 3 1  ON 56
ci_058                -8.275206e-03 3 1  ON 57
ci_059                -8.306193e-03 3 1  ON 58
ci_060                 8.851172e-03 3 1  ON 59
ci_061                 8.515191e-03 3 1  ON 60
ci_062                -4.195999e-03 3 1  ON 61
ci_063                -4.487106e-03 3 1  ON 62
ci_064                -4.011638e-03 3 1  ON 63
ci_065                -4.951944e-03 3 1  ON 64
ci_066                 6.539981e-03 3 1  ON 65
ci_067                 6.428557e-03 3 1  ON 66
ci_068                -5.243892e-03 3 1  ON 67
ci_069                -4.936554e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.3438
    reference variance = 0.430889
====================================================
  Execution time = 1.4064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0690e-01
  Total weights = 1.956018379e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293779568023
                                         uncertainty =       0.001891536937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293779568023
                                         uncertainty =       0.001891536937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383221597
  error estimate for blocks of size 2^( 2) =       0.000395159385
  error estimate for blocks of size 2^( 3) =       0.000405516976
  error estimate for blocks of size 2^( 4) =       0.000413044886
  error estimate for blocks of size 2^( 5) =       0.000417038077
  error estimate for blocks of size 2^( 6) =       0.000418924320
  error estimate for blocks of size 2^( 7) =       0.000418942539

      target function =                  N/A
              le_mean =     -17.214165564384
             les_mean =     296.634396451608
             stat err =       0.000416987455
             autocorr =       1.183984529536
              std dev =       0.541957179494
             le_variance =       0.293717584405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721416556438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214165564380       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214177307926       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214178831686       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214178615914       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.000117e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214165564380       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214171044472       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214171709253       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214171691983       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.500844e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214165564380       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214167313301       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214167517782       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214167528795       residual = 1.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.409669e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6551e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.560113e-02 3 1  ON 0
ci_002                -3.454003e-02 3 1  ON 1
ci_003                -2.717969e-02 3 1  ON 2
ci_004                 2.424720e-02 3 1  ON 3
ci_005                 2.407786e-02 3 1  ON 4
ci_006                -2.352690e-02 3 1  ON 5
ci_007                -2.278951e-02 3 1  ON 6
ci_008                -2.021775e-02 3 1  ON 7
ci_009                -1.961219e-02 3 1  ON 8
ci_010                -1.833174e-02 3 1  ON 9
ci_011                -1.855620e-02 3 1  ON 10
ci_012                -1.820941e-02 3 1  ON 11
ci_013                -2.054239e-02 3 1  ON 12
ci_014                 1.658570e-02 3 1  ON 13
ci_015                 1.651162e-02 3 1  ON 14
ci_016                 1.738294e-02 3 1  ON 15
ci_017                 1.716989e-02 3 1  ON 16
ci_018                 1.597681e-02 3 1  ON 17
ci_019                 1.556726e-02 3 1  ON 18
ci_020                 1.590276e-02 3 1  ON 19
ci_021                 1.625221e-02 3 1  ON 20
ci_022                 1.418018e-02 3 1  ON 21
ci_023                 1.393296e-02 3 1  ON 22
ci_024                 1.282514e-02 3 1  ON 23
ci_025                 1.346812e-02 3 1  ON 24
ci_026                 1.368879e-02 3 1  ON 25
ci_027                 1.397724e-02 3 1  ON 26
ci_028                -1.477083e-02 3 1  ON 27
ci_029                -1.509971e-02 3 1  ON 28
ci_030                -1.228815e-02 3 1  ON 29
ci_031                -1.154323e-02 3 1  ON 30
ci_032                -1.395999e-02 3 1  ON 31
ci_033                 1.151258e-02 3 1  ON 32
ci_034                 1.096490e-02 3 1  ON 33
ci_035                -6.924304e-03 3 1  ON 34
ci_036                -1.244412e-02 3 1  ON 35
ci_037                -1.210099e-02 3 1  ON 36
ci_038                 2.857011e-03 3 1  ON 37
ci_039                 3.023921e-03 3 1  ON 38
ci_040                -5.795560e-03 3 1  ON 39
ci_041                 1.026255e-02 3 1  ON 40
ci_042                 1.052430e-02 3 1  ON 41
ci_043                -4.992761e-03 3 1  ON 42
ci_044                -1.516872e-02 3 1  ON 43
ci_045                -3.510236e-03 3 1  ON 44
ci_046                 6.973498e-03 3 1  ON 45
ci_047                 6.659446e-03 3 1  ON 46
ci_048                -1.226092e-02 3 1  ON 47
ci_049                -1.208162e-02 3 1  ON 48
ci_050                 8.521781e-03 3 1  ON 49
ci_051                 8.392652e-03 3 1  ON 50
ci_052                -7.930907e-03 3 1  ON 51
ci_053                -7.648716e-03 3 1  ON 52
ci_054                -3.706663e-03 3 1  ON 53
ci_055                -3.630722e-03 3 1  ON 54
ci_056                 6.261944e-03 3 1  ON 55
ci_057                 6.424714e-03 3 1  ON 56
ci_058                -8.477595e-03 3 1  ON 57
ci_059                -8.288136e-03 3 1  ON 58
ci_060                 9.124517e-03 3 1  ON 59
ci_061                 8.746691e-03 3 1  ON 60
ci_062                -4.313046e-03 3 1  ON 61
ci_063                -4.273988e-03 3 1  ON 62
ci_064                -4.061720e-03 3 1  ON 63
ci_065                -4.925518e-03 3 1  ON 64
ci_066                 6.191734e-03 3 1  ON 65
ci_067                 6.545995e-03 3 1  ON 66
ci_068                -5.410314e-03 3 1  ON 67
ci_069                -5.176547e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.202248
====================================================
  Execution time = 1.3727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0466e-01
  Total weights = 1.9561e+06
  Execution time = 1.8448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290927752239
                                         uncertainty =       0.001893894296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290927752239
                                         uncertainty =       0.001893894296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381375436
  error estimate for blocks of size 2^( 2) =       0.000393108219
  error estimate for blocks of size 2^( 3) =       0.000403520826
  error estimate for blocks of size 2^( 4) =       0.000410794038
  error estimate for blocks of size 2^( 5) =       0.000415326938
  error estimate for blocks of size 2^( 6) =       0.000416749383
  error estimate for blocks of size 2^( 7) =       0.000419863679

      target function =                  N/A
              le_mean =     -17.213330350212
             les_mean =     296.611024119209
             stat err =       0.000415683509
             autocorr =       1.188010166305
              std dev =       0.539346314033
             le_variance =       0.290894446461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290343082256
                                         uncertainty =       0.001893132596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290343082256
                                         uncertainty =       0.001893132596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380991864
  error estimate for blocks of size 2^( 2) =       0.000392748389
  error estimate for blocks of size 2^( 3) =       0.000403201925
  error estimate for blocks of size 2^( 4) =       0.000410512983
  error estimate for blocks of size 2^( 5) =       0.000415069182
  error estimate for blocks of size 2^( 6) =       0.000416516469
  error estimate for blocks of size 2^( 7) =       0.000419656429

      target function =                  N/A
              le_mean =     -17.213336144085
             les_mean =     296.605683909772
             stat err =       0.000415438765
             autocorr =       1.189002138667
              std dev =       0.538803860793
             le_variance =       0.290309600406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290385185052
                                         uncertainty =       0.001894101491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290385185052
                                         uncertainty =       0.001894101491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381019572
  error estimate for blocks of size 2^( 2) =       0.000392775348
  error estimate for blocks of size 2^( 3) =       0.000403226597
  error estimate for blocks of size 2^( 4) =       0.000410532278
  error estimate for blocks of size 2^( 5) =       0.000415092589
  error estimate for blocks of size 2^( 6) =       0.000416534985
  error estimate for blocks of size 2^( 7) =       0.000419675988

      target function =                  N/A
              le_mean =     -17.213330194573
             les_mean =     296.620020326707
             stat err =       0.000415458960
             autocorr =       1.188944795726
              std dev =       0.538843045881
             le_variance =       0.290351828095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290816832882
                                         uncertainty =       0.001893950795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290816832882
                                         uncertainty =       0.001893950795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381302735
  error estimate for blocks of size 2^( 2) =       0.000393038792
  error estimate for blocks of size 2^( 3) =       0.000403461882
  error estimate for blocks of size 2^( 4) =       0.000410740007
  error estimate for blocks of size 2^( 5) =       0.000415274771
  error estimate for blocks of size 2^( 6) =       0.000416702155
  error estimate for blocks of size 2^( 7) =       0.000419826128

      target function =                  N/A
              le_mean =     -17.213325988094
             les_mean =     296.605745534104
             stat err =       0.000415635765
             autocorr =       1.188190242527
              std dev =       0.539243499413
             le_variance =       0.290783551659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213330350212        initial
     1.5259e-01     1.5259e+00             1.0001e-03       -17.213336144085  <--
     6.1035e-01     6.1035e+00             4.5008e-04       -17.213330194573
     2.4414e+00     2.4414e+01             1.4097e-04       -17.213325988094

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.2942e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.542810e-02 3 1  ON 0
ci_002                -3.414212e-02 3 1  ON 1
ci_003                -2.709755e-02 3 1  ON 2
ci_004                 2.412752e-02 3 1  ON 3
ci_005                 2.370026e-02 3 1  ON 4
ci_006                -2.378447e-02 3 1  ON 5
ci_007                -2.252926e-02 3 1  ON 6
ci_008                -2.027688e-02 3 1  ON 7
ci_009                -1.958785e-02 3 1  ON 8
ci_010                -1.796415e-02 3 1  ON 9
ci_011                -1.857098e-02 3 1  ON 10
ci_012                -1.765937e-02 3 1  ON 11
ci_013                -2.059932e-02 3 1  ON 12
ci_014                 1.643663e-02 3 1  ON 13
ci_015                 1.628733e-02 3 1  ON 14
ci_016                 1.736891e-02 3 1  ON 15
ci_017                 1.714179e-02 3 1  ON 16
ci_018                 1.593423e-02 3 1  ON 17
ci_019                 1.545121e-02 3 1  ON 18
ci_020                 1.574850e-02 3 1  ON 19
ci_021                 1.613915e-02 3 1  ON 20
ci_022                 1.430293e-02 3 1  ON 21
ci_023                 1.417941e-02 3 1  ON 22
ci_024                 1.281877e-02 3 1  ON 23
ci_025                 1.333028e-02 3 1  ON 24
ci_026                 1.335046e-02 3 1  ON 25
ci_027                 1.378781e-02 3 1  ON 26
ci_028                -1.487722e-02 3 1  ON 27
ci_029                -1.494187e-02 3 1  ON 28
ci_030                -1.230622e-02 3 1  ON 29
ci_031                -1.129043e-02 3 1  ON 30
ci_032                -1.431561e-02 3 1  ON 31
ci_033                 1.180895e-02 3 1  ON 32
ci_034                 1.081973e-02 3 1  ON 33
ci_035                -6.789159e-03 3 1  ON 34
ci_036                -1.268583e-02 3 1  ON 35
ci_037                -1.213651e-02 3 1  ON 36
ci_038                 2.876524e-03 3 1  ON 37
ci_039                 3.016402e-03 3 1  ON 38
ci_040                -5.833374e-03 3 1  ON 39
ci_041                 1.010435e-02 3 1  ON 40
ci_042                 1.061539e-02 3 1  ON 41
ci_043                -4.983969e-03 3 1  ON 42
ci_044                -1.511096e-02 3 1  ON 43
ci_045                -3.421975e-03 3 1  ON 44
ci_046                 6.788447e-03 3 1  ON 45
ci_047                 6.385970e-03 3 1  ON 46
ci_048                -1.268157e-02 3 1  ON 47
ci_049                -1.212753e-02 3 1  ON 48
ci_050                 8.470103e-03 3 1  ON 49
ci_051                 8.275376e-03 3 1  ON 50
ci_052                -7.933060e-03 3 1  ON 51
ci_053                -7.457156e-03 3 1  ON 52
ci_054                -3.584547e-03 3 1  ON 53
ci_055                -3.399788e-03 3 1  ON 54
ci_056                 6.313529e-03 3 1  ON 55
ci_057                 6.501773e-03 3 1  ON 56
ci_058                -8.689893e-03 3 1  ON 57
ci_059                -8.267211e-03 3 1  ON 58
ci_060                 9.445110e-03 3 1  ON 59
ci_061                 9.010045e-03 3 1  ON 60
ci_062                -4.443191e-03 3 1  ON 61
ci_063                -4.058127e-03 3 1  ON 62
ci_064                -4.098894e-03 3 1  ON 63
ci_065                -4.908107e-03 3 1  ON 64
ci_066                 5.872308e-03 3 1  ON 65
ci_067                 6.652744e-03 3 1  ON 66
ci_068                -5.611218e-03 3 1  ON 67
ci_069                -5.461021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1755
    reference variance = 0.260931
====================================================
  Execution time = 1.4146e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0675e-01
  Total weights = 1.955781599e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292722816789
                                         uncertainty =       0.002244246360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292722816789
                                         uncertainty =       0.002244246360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382604413
  error estimate for blocks of size 2^( 2) =       0.000394578777
  error estimate for blocks of size 2^( 3) =       0.000404786280
  error estimate for blocks of size 2^( 4) =       0.000412229625
  error estimate for blocks of size 2^( 5) =       0.000416909165
  error estimate for blocks of size 2^( 6) =       0.000419842925
  error estimate for blocks of size 2^( 7) =       0.000420093045

      target function =                  N/A
              le_mean =     -17.214079245512
             les_mean =     296.631278362439
             stat err =       0.000417268690
             autocorr =       1.189410169667
              std dev =       0.541084349505
             le_variance =       0.292772273279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721407924551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214079245502       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214084936046       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214083944484       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214083722273       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214083797527       residual = 7.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.227262e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214079245502       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214083346048       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214082704889       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214082597325       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 8.549325e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214079245502       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214081181875       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214080938968       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214080920983       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.064580e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6626e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.574499e-02 3 1  ON 0
ci_002                -3.394490e-02 3 1  ON 1
ci_003                -2.692686e-02 3 1  ON 2
ci_004                 2.410319e-02 3 1  ON 3
ci_005                 2.290626e-02 3 1  ON 4
ci_006                -2.299828e-02 3 1  ON 5
ci_007                -2.319117e-02 3 1  ON 6
ci_008                -2.019181e-02 3 1  ON 7
ci_009                -1.943953e-02 3 1  ON 8
ci_010                -1.826700e-02 3 1  ON 9
ci_011                -1.878179e-02 3 1  ON 10
ci_012                -1.775330e-02 3 1  ON 11
ci_013                -2.055746e-02 3 1  ON 12
ci_014                 1.659277e-02 3 1  ON 13
ci_015                 1.611584e-02 3 1  ON 14
ci_016                 1.757590e-02 3 1  ON 15
ci_017                 1.700424e-02 3 1  ON 16
ci_018                 1.554242e-02 3 1  ON 17
ci_019                 1.538894e-02 3 1  ON 18
ci_020                 1.560339e-02 3 1  ON 19
ci_021                 1.627941e-02 3 1  ON 20
ci_022                 1.390640e-02 3 1  ON 21
ci_023                 1.357589e-02 3 1  ON 22
ci_024                 1.252976e-02 3 1  ON 23
ci_025                 1.346764e-02 3 1  ON 24
ci_026                 1.356323e-02 3 1  ON 25
ci_027                 1.342395e-02 3 1  ON 26
ci_028                -1.488137e-02 3 1  ON 27
ci_029                -1.491158e-02 3 1  ON 28
ci_030                -1.150836e-02 3 1  ON 29
ci_031                -1.138096e-02 3 1  ON 30
ci_032                -1.385481e-02 3 1  ON 31
ci_033                 1.108538e-02 3 1  ON 32
ci_034                 1.060236e-02 3 1  ON 33
ci_035                -7.159313e-03 3 1  ON 34
ci_036                -1.309274e-02 3 1  ON 35
ci_037                -1.243305e-02 3 1  ON 36
ci_038                 2.854719e-03 3 1  ON 37
ci_039                 2.997307e-03 3 1  ON 38
ci_040                -5.790563e-03 3 1  ON 39
ci_041                 1.073592e-02 3 1  ON 40
ci_042                 1.025712e-02 3 1  ON 41
ci_043                -4.889837e-03 3 1  ON 42
ci_044                -1.523613e-02 3 1  ON 43
ci_045                -3.622724e-03 3 1  ON 44
ci_046                 6.753130e-03 3 1  ON 45
ci_047                 7.240903e-03 3 1  ON 46
ci_048                -1.288171e-02 3 1  ON 47
ci_049                -1.206992e-02 3 1  ON 48
ci_050                 8.184868e-03 3 1  ON 49
ci_051                 8.985295e-03 3 1  ON 50
ci_052                -7.454307e-03 3 1  ON 51
ci_053                -7.805825e-03 3 1  ON 52
ci_054                -3.280831e-03 3 1  ON 53
ci_055                -3.331430e-03 3 1  ON 54
ci_056                 6.337848e-03 3 1  ON 55
ci_057                 6.314917e-03 3 1  ON 56
ci_058                -8.374943e-03 3 1  ON 57
ci_059                -8.060272e-03 3 1  ON 58
ci_060                 8.706317e-03 3 1  ON 59
ci_061                 9.056466e-03 3 1  ON 60
ci_062                -4.706310e-03 3 1  ON 61
ci_063                -3.963476e-03 3 1  ON 62
ci_064                -4.103075e-03 3 1  ON 63
ci_065                -5.027859e-03 3 1  ON 64
ci_066                 6.343043e-03 3 1  ON 65
ci_067                 6.405184e-03 3 1  ON 66
ci_068                -5.160085e-03 3 1  ON 67
ci_069                -5.164852e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2938
    reference variance = 0.283087
====================================================
  Execution time = 1.3775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0615e-01
  Total weights = 1.9560e+06
  Execution time = 1.8507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308188993366
                                         uncertainty =       0.017123492261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308188993366
                                         uncertainty =       0.017123492261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392500795
  error estimate for blocks of size 2^( 2) =       0.000404066999
  error estimate for blocks of size 2^( 3) =       0.000414533113
  error estimate for blocks of size 2^( 4) =       0.000421682414
  error estimate for blocks of size 2^( 5) =       0.000426634138
  error estimate for blocks of size 2^( 6) =       0.000429047505
  error estimate for blocks of size 2^( 7) =       0.000428570437

      target function =                  N/A
              le_mean =     -17.214588421911
             les_mean =     306.701769196644
             stat err =       0.000426483624
             autocorr =       1.180656701850
              std dev =       0.555079948230
             le_variance =       0.308113748927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290426387128
                                         uncertainty =       0.002562801532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290426387128
                                         uncertainty =       0.002562801532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381035253
  error estimate for blocks of size 2^( 2) =       0.000392914226
  error estimate for blocks of size 2^( 3) =       0.000403734445
  error estimate for blocks of size 2^( 4) =       0.000411103175
  error estimate for blocks of size 2^( 5) =       0.000416158506
  error estimate for blocks of size 2^( 6) =       0.000418450912
  error estimate for blocks of size 2^( 7) =       0.000418088603

      target function =                  N/A
              le_mean =     -17.214652606805
             les_mean =     296.653829930032
             stat err =       0.000415950299
             autocorr =       1.191660559905
              std dev =       0.538865222025
             le_variance =       0.290375727508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290308552397
                                         uncertainty =       0.002582395035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290308552397
                                         uncertainty =       0.002582395035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380957755
  error estimate for blocks of size 2^( 2) =       0.000392853934
  error estimate for blocks of size 2^( 3) =       0.000403688124
  error estimate for blocks of size 2^( 4) =       0.000411089305
  error estimate for blocks of size 2^( 5) =       0.000416160193
  error estimate for blocks of size 2^( 6) =       0.000418463162
  error estimate for blocks of size 2^( 7) =       0.000418075707

      target function =                  N/A
              le_mean =     -17.214666606529
             les_mean =     296.657053417267
             stat err =       0.000415947092
             autocorr =       1.192127061231
              std dev =       0.538755623614
             le_variance =       0.290257621976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290918018451
                                         uncertainty =       0.002563686555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290918018451
                                         uncertainty =       0.002563686555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381357967
  error estimate for blocks of size 2^( 2) =       0.000393207862
  error estimate for blocks of size 2^( 3) =       0.000404006346
  error estimate for blocks of size 2^( 4) =       0.000411339500
  error estimate for blocks of size 2^( 5) =       0.000416384324
  error estimate for blocks of size 2^( 6) =       0.000418662609
  error estimate for blocks of size 2^( 7) =       0.000418341256

      target function =                  N/A
              le_mean =     -17.214656802076
             les_mean =     296.652232418370
             stat err =       0.000416181922
             autocorr =       1.190969871571
              std dev =       0.539321609693
             le_variance =       0.290867798682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214588421911        initial
     3.8147e-02     3.8147e-01             1.2273e-03       -17.214652606805
     1.5259e-01     1.5259e+00             8.5493e-04       -17.214666606529  <--
     6.1035e-01     6.1035e+00             4.0646e-04       -17.214656802076

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.6345e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.574499e-02 3 1  ON 0
ci_002                -3.394490e-02 3 1  ON 1
ci_003                -2.692686e-02 3 1  ON 2
ci_004                 2.410319e-02 3 1  ON 3
ci_005                 2.290626e-02 3 1  ON 4
ci_006                -2.299828e-02 3 1  ON 5
ci_007                -2.319117e-02 3 1  ON 6
ci_008                -2.019181e-02 3 1  ON 7
ci_009                -1.943953e-02 3 1  ON 8
ci_010                -1.826700e-02 3 1  ON 9
ci_011                -1.878179e-02 3 1  ON 10
ci_012                -1.775330e-02 3 1  ON 11
ci_013                -2.055746e-02 3 1  ON 12
ci_014                 1.659277e-02 3 1  ON 13
ci_015                 1.611584e-02 3 1  ON 14
ci_016                 1.757590e-02 3 1  ON 15
ci_017                 1.700424e-02 3 1  ON 16
ci_018                 1.554242e-02 3 1  ON 17
ci_019                 1.538894e-02 3 1  ON 18
ci_020                 1.560339e-02 3 1  ON 19
ci_021                 1.627941e-02 3 1  ON 20
ci_022                 1.390640e-02 3 1  ON 21
ci_023                 1.357589e-02 3 1  ON 22
ci_024                 1.252976e-02 3 1  ON 23
ci_025                 1.346764e-02 3 1  ON 24
ci_026                 1.356323e-02 3 1  ON 25
ci_027                 1.342395e-02 3 1  ON 26
ci_028                -1.488137e-02 3 1  ON 27
ci_029                -1.491158e-02 3 1  ON 28
ci_030                -1.150836e-02 3 1  ON 29
ci_031                -1.138096e-02 3 1  ON 30
ci_032                -1.385481e-02 3 1  ON 31
ci_033                 1.108538e-02 3 1  ON 32
ci_034                 1.060236e-02 3 1  ON 33
ci_035                -7.159313e-03 3 1  ON 34
ci_036                -1.309274e-02 3 1  ON 35
ci_037                -1.243305e-02 3 1  ON 36
ci_038                 2.854719e-03 3 1  ON 37
ci_039                 2.997307e-03 3 1  ON 38
ci_040                -5.790563e-03 3 1  ON 39
ci_041                 1.073592e-02 3 1  ON 40
ci_042                 1.025712e-02 3 1  ON 41
ci_043                -4.889837e-03 3 1  ON 42
ci_044                -1.523613e-02 3 1  ON 43
ci_045                -3.622724e-03 3 1  ON 44
ci_046                 6.753130e-03 3 1  ON 45
ci_047                 7.240903e-03 3 1  ON 46
ci_048                -1.288171e-02 3 1  ON 47
ci_049                -1.206992e-02 3 1  ON 48
ci_050                 8.184868e-03 3 1  ON 49
ci_051                 8.985295e-03 3 1  ON 50
ci_052                -7.454307e-03 3 1  ON 51
ci_053                -7.805825e-03 3 1  ON 52
ci_054                -3.280831e-03 3 1  ON 53
ci_055                -3.331430e-03 3 1  ON 54
ci_056                 6.337848e-03 3 1  ON 55
ci_057                 6.314917e-03 3 1  ON 56
ci_058                -8.374943e-03 3 1  ON 57
ci_059                -8.060272e-03 3 1  ON 58
ci_060                 8.706317e-03 3 1  ON 59
ci_061                 9.056466e-03 3 1  ON 60
ci_062                -4.706310e-03 3 1  ON 61
ci_063                -3.963476e-03 3 1  ON 62
ci_064                -4.103075e-03 3 1  ON 63
ci_065                -5.027859e-03 3 1  ON 64
ci_066                 6.343043e-03 3 1  ON 65
ci_067                 6.405184e-03 3 1  ON 66
ci_068                -5.160085e-03 3 1  ON 67
ci_069                -5.164852e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2337
    reference variance = 0.158008
====================================================
  Execution time = 1.4084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0831e-01
  Total weights = 1.956073783e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294533381995
                                         uncertainty =       0.002788590324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294533381995
                                         uncertainty =       0.002788590324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383691360
  error estimate for blocks of size 2^( 2) =       0.000395091997
  error estimate for blocks of size 2^( 3) =       0.000405635293
  error estimate for blocks of size 2^( 4) =       0.000413637711
  error estimate for blocks of size 2^( 5) =       0.000418331962
  error estimate for blocks of size 2^( 6) =       0.000419862480
  error estimate for blocks of size 2^( 7) =       0.000421994966

      target function =                  N/A
              le_mean =     -17.214413188770
             les_mean =     296.644327298321
             stat err =       0.000418456780
             autocorr =       1.189425313101
              std dev =       0.542621525507
             le_variance =       0.294438119943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721441318877e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214413188775       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214436171907       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214436117127       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214435703110       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214435705649       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.496069e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214413188775       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214429942803       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214430034570       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214429902501       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.056473e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214413188775       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214421227669       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214421453371       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214421434856       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.864764e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6576e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.489441e-02 3 1  ON 0
ci_002                -3.388560e-02 3 1  ON 1
ci_003                -2.746481e-02 3 1  ON 2
ci_004                 2.417637e-02 3 1  ON 3
ci_005                 2.324150e-02 3 1  ON 4
ci_006                -2.340738e-02 3 1  ON 5
ci_007                -2.298893e-02 3 1  ON 6
ci_008                -2.032731e-02 3 1  ON 7
ci_009                -1.977867e-02 3 1  ON 8
ci_010                -1.844258e-02 3 1  ON 9
ci_011                -1.772532e-02 3 1  ON 10
ci_012                -1.769010e-02 3 1  ON 11
ci_013                -2.072067e-02 3 1  ON 12
ci_014                 1.592995e-02 3 1  ON 13
ci_015                 1.639157e-02 3 1  ON 14
ci_016                 1.722610e-02 3 1  ON 15
ci_017                 1.668971e-02 3 1  ON 16
ci_018                 1.470208e-02 3 1  ON 17
ci_019                 1.510724e-02 3 1  ON 18
ci_020                 1.562455e-02 3 1  ON 19
ci_021                 1.559500e-02 3 1  ON 20
ci_022                 1.375604e-02 3 1  ON 21
ci_023                 1.358339e-02 3 1  ON 22
ci_024                 1.213684e-02 3 1  ON 23
ci_025                 1.307626e-02 3 1  ON 24
ci_026                 1.381086e-02 3 1  ON 25
ci_027                 1.338464e-02 3 1  ON 26
ci_028                -1.474396e-02 3 1  ON 27
ci_029                -1.508069e-02 3 1  ON 28
ci_030                -1.185877e-02 3 1  ON 29
ci_031                -1.162183e-02 3 1  ON 30
ci_032                -1.395531e-02 3 1  ON 31
ci_033                 1.095276e-02 3 1  ON 32
ci_034                 1.062000e-02 3 1  ON 33
ci_035                -7.038319e-03 3 1  ON 34
ci_036                -1.300311e-02 3 1  ON 35
ci_037                -1.230619e-02 3 1  ON 36
ci_038                 3.001443e-03 3 1  ON 37
ci_039                 2.869694e-03 3 1  ON 38
ci_040                -5.624850e-03 3 1  ON 39
ci_041                 1.075788e-02 3 1  ON 40
ci_042                 1.018059e-02 3 1  ON 41
ci_043                -5.652722e-03 3 1  ON 42
ci_044                -1.546635e-02 3 1  ON 43
ci_045                -3.730596e-03 3 1  ON 44
ci_046                 6.873694e-03 3 1  ON 45
ci_047                 6.684840e-03 3 1  ON 46
ci_048                -1.284372e-02 3 1  ON 47
ci_049                -1.171255e-02 3 1  ON 48
ci_050                 8.334447e-03 3 1  ON 49
ci_051                 9.008141e-03 3 1  ON 50
ci_052                -8.408697e-03 3 1  ON 51
ci_053                -7.688257e-03 3 1  ON 52
ci_054                -3.191635e-03 3 1  ON 53
ci_055                -3.824910e-03 3 1  ON 54
ci_056                 5.614679e-03 3 1  ON 55
ci_057                 6.066551e-03 3 1  ON 56
ci_058                -9.106482e-03 3 1  ON 57
ci_059                -8.183996e-03 3 1  ON 58
ci_060                 8.507717e-03 3 1  ON 59
ci_061                 8.171360e-03 3 1  ON 60
ci_062                -4.494884e-03 3 1  ON 61
ci_063                -4.267390e-03 3 1  ON 62
ci_064                -4.116185e-03 3 1  ON 63
ci_065                -5.083423e-03 3 1  ON 64
ci_066                 6.211765e-03 3 1  ON 65
ci_067                 6.131906e-03 3 1  ON 66
ci_068                -5.243511e-03 3 1  ON 67
ci_069                -5.314643e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.228415
====================================================
  Execution time = 1.3857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1010e-01
  Total weights = 1.9560e+06
  Execution time = 1.8379e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290203674207
                                         uncertainty =       0.001678735002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290203674207
                                         uncertainty =       0.001678735002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380859612
  error estimate for blocks of size 2^( 2) =       0.000392769383
  error estimate for blocks of size 2^( 3) =       0.000403222995
  error estimate for blocks of size 2^( 4) =       0.000410992857
  error estimate for blocks of size 2^( 5) =       0.000414524742
  error estimate for blocks of size 2^( 6) =       0.000418048580
  error estimate for blocks of size 2^( 7) =       0.000420963251

      target function =                  N/A
              le_mean =     -17.213889962123
             les_mean =     296.638289921017
             stat err =       0.000416132358
             autocorr =       1.193804285363
              std dev =       0.538616828323
             le_variance =       0.290108087753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290491534895
                                         uncertainty =       0.001672268067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290491534895
                                         uncertainty =       0.001672268067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381049579
  error estimate for blocks of size 2^( 2) =       0.000392980689
  error estimate for blocks of size 2^( 3) =       0.000403438410
  error estimate for blocks of size 2^( 4) =       0.000411275809
  error estimate for blocks of size 2^( 5) =       0.000414833551
  error estimate for blocks of size 2^( 6) =       0.000418351456
  error estimate for blocks of size 2^( 7) =       0.000421280915

      target function =                  N/A
              le_mean =     -17.213853078522
             les_mean =     296.679060909857
             stat err =       0.000416435433
             autocorr =       1.194352098286
              std dev =       0.538885482696
             le_variance =       0.290397563460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919876401
                                         uncertainty =       0.001679023691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290919876401
                                         uncertainty =       0.001679023691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381331024
  error estimate for blocks of size 2^( 2) =       0.000393267716
  error estimate for blocks of size 2^( 3) =       0.000403729693
  error estimate for blocks of size 2^( 4) =       0.000411580826
  error estimate for blocks of size 2^( 5) =       0.000415132954
  error estimate for blocks of size 2^( 6) =       0.000418658993
  error estimate for blocks of size 2^( 7) =       0.000421630096

      target function =                  N/A
              le_mean =     -17.213867898197
             les_mean =     296.634241735021
             stat err =       0.000416750717
             autocorr =       1.194396251721
              std dev =       0.539283506541
             le_variance =       0.290826700427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290226060543
                                         uncertainty =       0.001676225260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290226060543
                                         uncertainty =       0.001676225260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380874709
  error estimate for blocks of size 2^( 2) =       0.000392790308
  error estimate for blocks of size 2^( 3) =       0.000403242746
  error estimate for blocks of size 2^( 4) =       0.000411038299
  error estimate for blocks of size 2^( 5) =       0.000414581399
  error estimate for blocks of size 2^( 6) =       0.000418104587
  error estimate for blocks of size 2^( 7) =       0.000421029278

      target function =                  N/A
              le_mean =     -17.213861500027
             les_mean =     296.666157437655
             stat err =       0.000416188391
             autocorr =       1.194031136647
              std dev =       0.538638179321
             le_variance =       0.290131088222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213889962123        initial  <--
     3.8147e-02     3.8147e-01             1.4961e-03       -17.213853078522
     1.5259e-01     1.5259e+00             1.0565e-03       -17.213867898197
     6.1035e-01     6.1035e+00             4.8648e-04       -17.213861500027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0907
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.574499e-02 3 1  ON 0
ci_002                -3.394490e-02 3 1  ON 1
ci_003                -2.692686e-02 3 1  ON 2
ci_004                 2.410319e-02 3 1  ON 3
ci_005                 2.290626e-02 3 1  ON 4
ci_006                -2.299828e-02 3 1  ON 5
ci_007                -2.319117e-02 3 1  ON 6
ci_008                -2.019181e-02 3 1  ON 7
ci_009                -1.943953e-02 3 1  ON 8
ci_010                -1.826700e-02 3 1  ON 9
ci_011                -1.878179e-02 3 1  ON 10
ci_012                -1.775330e-02 3 1  ON 11
ci_013                -2.055746e-02 3 1  ON 12
ci_014                 1.659277e-02 3 1  ON 13
ci_015                 1.611584e-02 3 1  ON 14
ci_016                 1.757590e-02 3 1  ON 15
ci_017                 1.700424e-02 3 1  ON 16
ci_018                 1.554242e-02 3 1  ON 17
ci_019                 1.538894e-02 3 1  ON 18
ci_020                 1.560339e-02 3 1  ON 19
ci_021                 1.627941e-02 3 1  ON 20
ci_022                 1.390640e-02 3 1  ON 21
ci_023                 1.357589e-02 3 1  ON 22
ci_024                 1.252976e-02 3 1  ON 23
ci_025                 1.346764e-02 3 1  ON 24
ci_026                 1.356323e-02 3 1  ON 25
ci_027                 1.342395e-02 3 1  ON 26
ci_028                -1.488137e-02 3 1  ON 27
ci_029                -1.491158e-02 3 1  ON 28
ci_030                -1.150836e-02 3 1  ON 29
ci_031                -1.138096e-02 3 1  ON 30
ci_032                -1.385481e-02 3 1  ON 31
ci_033                 1.108538e-02 3 1  ON 32
ci_034                 1.060236e-02 3 1  ON 33
ci_035                -7.159313e-03 3 1  ON 34
ci_036                -1.309274e-02 3 1  ON 35
ci_037                -1.243305e-02 3 1  ON 36
ci_038                 2.854719e-03 3 1  ON 37
ci_039                 2.997307e-03 3 1  ON 38
ci_040                -5.790563e-03 3 1  ON 39
ci_041                 1.073592e-02 3 1  ON 40
ci_042                 1.025712e-02 3 1  ON 41
ci_043                -4.889837e-03 3 1  ON 42
ci_044                -1.523613e-02 3 1  ON 43
ci_045                -3.622724e-03 3 1  ON 44
ci_046                 6.753130e-03 3 1  ON 45
ci_047                 7.240903e-03 3 1  ON 46
ci_048                -1.288171e-02 3 1  ON 47
ci_049                -1.206992e-02 3 1  ON 48
ci_050                 8.184868e-03 3 1  ON 49
ci_051                 8.985295e-03 3 1  ON 50
ci_052                -7.454307e-03 3 1  ON 51
ci_053                -7.805825e-03 3 1  ON 52
ci_054                -3.280831e-03 3 1  ON 53
ci_055                -3.331430e-03 3 1  ON 54
ci_056                 6.337848e-03 3 1  ON 55
ci_057                 6.314917e-03 3 1  ON 56
ci_058                -8.374943e-03 3 1  ON 57
ci_059                -8.060272e-03 3 1  ON 58
ci_060                 8.706317e-03 3 1  ON 59
ci_061                 9.056466e-03 3 1  ON 60
ci_062                -4.706310e-03 3 1  ON 61
ci_063                -3.963476e-03 3 1  ON 62
ci_064                -4.103075e-03 3 1  ON 63
ci_065                -5.027859e-03 3 1  ON 64
ci_066                 6.343043e-03 3 1  ON 65
ci_067                 6.405184e-03 3 1  ON 66
ci_068                -5.160085e-03 3 1  ON 67
ci_069                -5.164852e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2771
    reference variance = 0.175196
====================================================
  Execution time = 1.4084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1267e-01
  Total weights = 1.956021983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295309974261
                                         uncertainty =       0.002678440701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295309974261
                                         uncertainty =       0.002678440701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384215401
  error estimate for blocks of size 2^( 2) =       0.000396085396
  error estimate for blocks of size 2^( 3) =       0.000406580812
  error estimate for blocks of size 2^( 4) =       0.000414052955
  error estimate for blocks of size 2^( 5) =       0.000417687903
  error estimate for blocks of size 2^( 6) =       0.000419827197
  error estimate for blocks of size 2^( 7) =       0.000422556339

      target function =                  N/A
              le_mean =     -17.213365143172
             les_mean =     296.612607993448
             stat err =       0.000418531098
             autocorr =       1.186604327783
              std dev =       0.543362630815
             le_variance =       0.295242948566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721336514317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213365143129       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213374132445       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213375262567       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213375226278       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 1.279116e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213365143129       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213368338802       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213368353988       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213368319686       residual = 2.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 4.568721e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213365143129       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213366036271       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213365996420       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213365988889       residual = 3.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 1.278937e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6568e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.545582e-02 3 1  ON 0
ci_002                -3.382831e-02 3 1  ON 1
ci_003                -2.704522e-02 3 1  ON 2
ci_004                 2.409789e-02 3 1  ON 3
ci_005                 2.267339e-02 3 1  ON 4
ci_006                -2.275419e-02 3 1  ON 5
ci_007                -2.297127e-02 3 1  ON 6
ci_008                -2.020874e-02 3 1  ON 7
ci_009                -1.962611e-02 3 1  ON 8
ci_010                -1.837027e-02 3 1  ON 9
ci_011                -1.832492e-02 3 1  ON 10
ci_012                -1.775417e-02 3 1  ON 11
ci_013                -2.038504e-02 3 1  ON 12
ci_014                 1.638204e-02 3 1  ON 13
ci_015                 1.624061e-02 3 1  ON 14
ci_016                 1.730026e-02 3 1  ON 15
ci_017                 1.701417e-02 3 1  ON 16
ci_018                 1.553573e-02 3 1  ON 17
ci_019                 1.541665e-02 3 1  ON 18
ci_020                 1.556167e-02 3 1  ON 19
ci_021                 1.619697e-02 3 1  ON 20
ci_022                 1.368095e-02 3 1  ON 21
ci_023                 1.355096e-02 3 1  ON 22
ci_024                 1.256307e-02 3 1  ON 23
ci_025                 1.335579e-02 3 1  ON 24
ci_026                 1.367810e-02 3 1  ON 25
ci_027                 1.364197e-02 3 1  ON 26
ci_028                -1.471779e-02 3 1  ON 27
ci_029                -1.496912e-02 3 1  ON 28
ci_030                -1.158464e-02 3 1  ON 29
ci_031                -1.137065e-02 3 1  ON 30
ci_032                -1.371445e-02 3 1  ON 31
ci_033                 1.117761e-02 3 1  ON 32
ci_034                 1.065568e-02 3 1  ON 33
ci_035                -7.120720e-03 3 1  ON 34
ci_036                -1.295024e-02 3 1  ON 35
ci_037                -1.234040e-02 3 1  ON 36
ci_038                 2.863942e-03 3 1  ON 37
ci_039                 3.001388e-03 3 1  ON 38
ci_040                -5.732333e-03 3 1  ON 39
ci_041                 1.080690e-02 3 1  ON 40
ci_042                 1.044186e-02 3 1  ON 41
ci_043                -4.954342e-03 3 1  ON 42
ci_044                -1.509846e-02 3 1  ON 43
ci_045                -3.720323e-03 3 1  ON 44
ci_046                 6.796952e-03 3 1  ON 45
ci_047                 7.151466e-03 3 1  ON 46
ci_048                -1.257843e-02 3 1  ON 47
ci_049                -1.207631e-02 3 1  ON 48
ci_050                 8.446047e-03 3 1  ON 49
ci_051                 8.888890e-03 3 1  ON 50
ci_052                -7.563239e-03 3 1  ON 51
ci_053                -7.888714e-03 3 1  ON 52
ci_054                -3.363003e-03 3 1  ON 53
ci_055                -3.283227e-03 3 1  ON 54
ci_056                 6.206981e-03 3 1  ON 55
ci_057                 6.302080e-03 3 1  ON 56
ci_058                -8.387890e-03 3 1  ON 57
ci_059                -8.155372e-03 3 1  ON 58
ci_060                 8.835692e-03 3 1  ON 59
ci_061                 9.000961e-03 3 1  ON 60
ci_062                -4.728495e-03 3 1  ON 61
ci_063                -3.975260e-03 3 1  ON 62
ci_064                -4.159002e-03 3 1  ON 63
ci_065                -5.013528e-03 3 1  ON 64
ci_066                 6.421541e-03 3 1  ON 65
ci_067                 6.660222e-03 3 1  ON 66
ci_068                -5.288102e-03 3 1  ON 67
ci_069                -5.171490e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.3269
    reference variance = 0.307886
====================================================
  Execution time = 1.3700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1246e-01
  Total weights = 1.9560e+06
  Execution time = 1.8499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294221124524
                                         uncertainty =       0.002537992620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294221124524
                                         uncertainty =       0.002537992620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383545969
  error estimate for blocks of size 2^( 2) =       0.000395590716
  error estimate for blocks of size 2^( 3) =       0.000405844730
  error estimate for blocks of size 2^( 4) =       0.000413064643
  error estimate for blocks of size 2^( 5) =       0.000417378892
  error estimate for blocks of size 2^( 6) =       0.000420126708
  error estimate for blocks of size 2^( 7) =       0.000421395386

      target function =                  N/A
              le_mean =     -17.213638732231
             les_mean =     296.693356537190
             stat err =       0.000417991407
             autocorr =       1.187681147014
              std dev =       0.542415910747
             le_variance =       0.294215020232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294540339528
                                         uncertainty =       0.002538848914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294540339528
                                         uncertainty =       0.002538848914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383754018
  error estimate for blocks of size 2^( 2) =       0.000395800901
  error estimate for blocks of size 2^( 3) =       0.000406066702
  error estimate for blocks of size 2^( 4) =       0.000413289777
  error estimate for blocks of size 2^( 5) =       0.000417631059
  error estimate for blocks of size 2^( 6) =       0.000420377682
  error estimate for blocks of size 2^( 7) =       0.000421668733

      target function =                  N/A
              le_mean =     -17.213639773089
             les_mean =     296.646874419209
             stat err =       0.000418241813
             autocorr =       1.187815597687
              std dev =       0.542710137557
             le_variance =       0.294534293407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294405197717
                                         uncertainty =       0.002539120494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294405197717
                                         uncertainty =       0.002539120494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383666040
  error estimate for blocks of size 2^( 2) =       0.000395712902
  error estimate for blocks of size 2^( 3) =       0.000405976534
  error estimate for blocks of size 2^( 4) =       0.000413191836
  error estimate for blocks of size 2^( 5) =       0.000417518337
  error estimate for blocks of size 2^( 6) =       0.000420266324
  error estimate for blocks of size 2^( 7) =       0.000421558129

      target function =                  N/A
              le_mean =     -17.213640016131
             les_mean =     296.621734626596
             stat err =       0.000418133656
             autocorr =       1.187745883417
              std dev =       0.542585716832
             le_variance =       0.294399260110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294232066239
                                         uncertainty =       0.002537643336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294232066239
                                         uncertainty =       0.002537643336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383553123
  error estimate for blocks of size 2^( 2) =       0.000395598771
  error estimate for blocks of size 2^( 3) =       0.000405852700
  error estimate for blocks of size 2^( 4) =       0.000413067814
  error estimate for blocks of size 2^( 5) =       0.000417380675
  error estimate for blocks of size 2^( 6) =       0.000420129760
  error estimate for blocks of size 2^( 7) =       0.000421407304

      target function =                  N/A
              le_mean =     -17.213636917323
             les_mean =     296.624037895102
             stat err =       0.000417996388
             autocorr =       1.187665146314
              std dev =       0.542426028411
             le_variance =       0.294225996298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213638732231        initial
     3.8147e-01     3.8147e+00             1.2791e-03       -17.213639773089
     1.5259e+00     1.5259e+01             4.5687e-04       -17.213640016131  <--
     6.1035e+00     6.1035e+01             1.2789e-04       -17.213636917323

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.2947e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.545582e-02 3 1  ON 0
ci_002                -3.382831e-02 3 1  ON 1
ci_003                -2.704522e-02 3 1  ON 2
ci_004                 2.409789e-02 3 1  ON 3
ci_005                 2.267339e-02 3 1  ON 4
ci_006                -2.275419e-02 3 1  ON 5
ci_007                -2.297127e-02 3 1  ON 6
ci_008                -2.020874e-02 3 1  ON 7
ci_009                -1.962611e-02 3 1  ON 8
ci_010                -1.837027e-02 3 1  ON 9
ci_011                -1.832492e-02 3 1  ON 10
ci_012                -1.775417e-02 3 1  ON 11
ci_013                -2.038504e-02 3 1  ON 12
ci_014                 1.638204e-02 3 1  ON 13
ci_015                 1.624061e-02 3 1  ON 14
ci_016                 1.730026e-02 3 1  ON 15
ci_017                 1.701417e-02 3 1  ON 16
ci_018                 1.553573e-02 3 1  ON 17
ci_019                 1.541665e-02 3 1  ON 18
ci_020                 1.556167e-02 3 1  ON 19
ci_021                 1.619697e-02 3 1  ON 20
ci_022                 1.368095e-02 3 1  ON 21
ci_023                 1.355096e-02 3 1  ON 22
ci_024                 1.256307e-02 3 1  ON 23
ci_025                 1.335579e-02 3 1  ON 24
ci_026                 1.367810e-02 3 1  ON 25
ci_027                 1.364197e-02 3 1  ON 26
ci_028                -1.471779e-02 3 1  ON 27
ci_029                -1.496912e-02 3 1  ON 28
ci_030                -1.158464e-02 3 1  ON 29
ci_031                -1.137065e-02 3 1  ON 30
ci_032                -1.371445e-02 3 1  ON 31
ci_033                 1.117761e-02 3 1  ON 32
ci_034                 1.065568e-02 3 1  ON 33
ci_035                -7.120720e-03 3 1  ON 34
ci_036                -1.295024e-02 3 1  ON 35
ci_037                -1.234040e-02 3 1  ON 36
ci_038                 2.863942e-03 3 1  ON 37
ci_039                 3.001388e-03 3 1  ON 38
ci_040                -5.732333e-03 3 1  ON 39
ci_041                 1.080690e-02 3 1  ON 40
ci_042                 1.044186e-02 3 1  ON 41
ci_043                -4.954342e-03 3 1  ON 42
ci_044                -1.509846e-02 3 1  ON 43
ci_045                -3.720323e-03 3 1  ON 44
ci_046                 6.796952e-03 3 1  ON 45
ci_047                 7.151466e-03 3 1  ON 46
ci_048                -1.257843e-02 3 1  ON 47
ci_049                -1.207631e-02 3 1  ON 48
ci_050                 8.446047e-03 3 1  ON 49
ci_051                 8.888890e-03 3 1  ON 50
ci_052                -7.563239e-03 3 1  ON 51
ci_053                -7.888714e-03 3 1  ON 52
ci_054                -3.363003e-03 3 1  ON 53
ci_055                -3.283227e-03 3 1  ON 54
ci_056                 6.206981e-03 3 1  ON 55
ci_057                 6.302080e-03 3 1  ON 56
ci_058                -8.387890e-03 3 1  ON 57
ci_059                -8.155372e-03 3 1  ON 58
ci_060                 8.835692e-03 3 1  ON 59
ci_061                 9.000961e-03 3 1  ON 60
ci_062                -4.728495e-03 3 1  ON 61
ci_063                -3.975260e-03 3 1  ON 62
ci_064                -4.159002e-03 3 1  ON 63
ci_065                -5.013528e-03 3 1  ON 64
ci_066                 6.421541e-03 3 1  ON 65
ci_067                 6.660222e-03 3 1  ON 66
ci_068                -5.288102e-03 3 1  ON 67
ci_069                -5.171490e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.207902
====================================================
  Execution time = 1.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1755e-01
  Total weights = 1.955963470e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291055953726
                                         uncertainty =       0.002055696597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291055953726
                                         uncertainty =       0.002055696597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381523419
  error estimate for blocks of size 2^( 2) =       0.000393117092
  error estimate for blocks of size 2^( 3) =       0.000403554968
  error estimate for blocks of size 2^( 4) =       0.000411346136
  error estimate for blocks of size 2^( 5) =       0.000415808085
  error estimate for blocks of size 2^( 6) =       0.000417034961
  error estimate for blocks of size 2^( 7) =       0.000418776052

      target function =                  N/A
              le_mean =     -17.213662834324
             les_mean =     296.627740815988
             stat err =       0.000415741309
             autocorr =       1.187418890708
              std dev =       0.539555593975
             le_variance =       0.291120238990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721366283432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662834324       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213656102356       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213657073694       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213657145323       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 9.665561e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662834324       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213660355140       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213660389958       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 3.356772e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213662834324       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213662131392       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213662099806       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 9.296770e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6649e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.546430e-02 3 1  ON 0
ci_002                -3.392880e-02 3 1  ON 1
ci_003                -2.705110e-02 3 1  ON 2
ci_004                 2.407852e-02 3 1  ON 3
ci_005                 2.281857e-02 3 1  ON 4
ci_006                -2.271512e-02 3 1  ON 5
ci_007                -2.287019e-02 3 1  ON 6
ci_008                -1.998940e-02 3 1  ON 7
ci_009                -1.961821e-02 3 1  ON 8
ci_010                -1.838007e-02 3 1  ON 9
ci_011                -1.832122e-02 3 1  ON 10
ci_012                -1.772918e-02 3 1  ON 11
ci_013                -2.041405e-02 3 1  ON 12
ci_014                 1.644216e-02 3 1  ON 13
ci_015                 1.630844e-02 3 1  ON 14
ci_016                 1.733579e-02 3 1  ON 15
ci_017                 1.698889e-02 3 1  ON 16
ci_018                 1.550557e-02 3 1  ON 17
ci_019                 1.546212e-02 3 1  ON 18
ci_020                 1.561677e-02 3 1  ON 19
ci_021                 1.619214e-02 3 1  ON 20
ci_022                 1.372754e-02 3 1  ON 21
ci_023                 1.344685e-02 3 1  ON 22
ci_024                 1.261669e-02 3 1  ON 23
ci_025                 1.336015e-02 3 1  ON 24
ci_026                 1.355118e-02 3 1  ON 25
ci_027                 1.359522e-02 3 1  ON 26
ci_028                -1.471801e-02 3 1  ON 27
ci_029                -1.500435e-02 3 1  ON 28
ci_030                -1.192032e-02 3 1  ON 29
ci_031                -1.136012e-02 3 1  ON 30
ci_032                -1.380809e-02 3 1  ON 31
ci_033                 1.111801e-02 3 1  ON 32
ci_034                 1.079383e-02 3 1  ON 33
ci_035                -7.064709e-03 3 1  ON 34
ci_036                -1.294355e-02 3 1  ON 35
ci_037                -1.231308e-02 3 1  ON 36
ci_038                 2.983250e-03 3 1  ON 37
ci_039                 2.901146e-03 3 1  ON 38
ci_040                -5.785949e-03 3 1  ON 39
ci_041                 1.073140e-02 3 1  ON 40
ci_042                 1.041163e-02 3 1  ON 41
ci_043                -5.016662e-03 3 1  ON 42
ci_044                -1.506491e-02 3 1  ON 43
ci_045                -3.804113e-03 3 1  ON 44
ci_046                 6.749282e-03 3 1  ON 45
ci_047                 7.075078e-03 3 1  ON 46
ci_048                -1.255672e-02 3 1  ON 47
ci_049                -1.202143e-02 3 1  ON 48
ci_050                 8.272700e-03 3 1  ON 49
ci_051                 8.585909e-03 3 1  ON 50
ci_052                -7.800313e-03 3 1  ON 51
ci_053                -7.855287e-03 3 1  ON 52
ci_054                -3.292730e-03 3 1  ON 53
ci_055                -3.434866e-03 3 1  ON 54
ci_056                 6.141475e-03 3 1  ON 55
ci_057                 6.188716e-03 3 1  ON 56
ci_058                -8.325086e-03 3 1  ON 57
ci_059                -8.079381e-03 3 1  ON 58
ci_060                 8.800370e-03 3 1  ON 59
ci_061                 9.088084e-03 3 1  ON 60
ci_062                -4.679420e-03 3 1  ON 61
ci_063                -3.951409e-03 3 1  ON 62
ci_064                -4.207573e-03 3 1  ON 63
ci_065                -4.954351e-03 3 1  ON 64
ci_066                 6.513121e-03 3 1  ON 65
ci_067                 6.649182e-03 3 1  ON 66
ci_068                -5.326789e-03 3 1  ON 67
ci_069                -5.241393e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1459
    reference variance = 0.240474
====================================================
  Execution time = 1.3693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0893e-01
  Total weights = 1.9563e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294140346786
                                         uncertainty =       0.001967314804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294140346786
                                         uncertainty =       0.001967314804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383645261
  error estimate for blocks of size 2^( 2) =       0.000395132409
  error estimate for blocks of size 2^( 3) =       0.000405800549
  error estimate for blocks of size 2^( 4) =       0.000412931878
  error estimate for blocks of size 2^( 5) =       0.000417090694
  error estimate for blocks of size 2^( 6) =       0.000419577463
  error estimate for blocks of size 2^( 7) =       0.000422289522

      target function =                  N/A
              le_mean =     -17.213566010112
             les_mean =     296.625144619729
             stat err =       0.000417972389
             autocorr =       1.186958438295
              std dev =       0.542556330671
             le_variance =       0.294367371951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293504788226
                                         uncertainty =       0.001956071956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293504788226
                                         uncertainty =       0.001956071956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383228146
  error estimate for blocks of size 2^( 2) =       0.000394727137
  error estimate for blocks of size 2^( 3) =       0.000405420276
  error estimate for blocks of size 2^( 4) =       0.000412584943
  error estimate for blocks of size 2^( 5) =       0.000416750920
  error estimate for blocks of size 2^( 6) =       0.000419241964
  error estimate for blocks of size 2^( 7) =       0.000421988662

      target function =                  N/A
              le_mean =     -17.213568267003
             les_mean =     296.616044223784
             stat err =       0.000417641622
             autocorr =       1.187661703728
              std dev =       0.541966441100
             le_variance =       0.293727623278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293630901037
                                         uncertainty =       0.001958216500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293630901037
                                         uncertainty =       0.001958216500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383310918
  error estimate for blocks of size 2^( 2) =       0.000394807727
  error estimate for blocks of size 2^( 3) =       0.000405495801
  error estimate for blocks of size 2^( 4) =       0.000412653282
  error estimate for blocks of size 2^( 5) =       0.000416819064
  error estimate for blocks of size 2^( 6) =       0.000419308706
  error estimate for blocks of size 2^( 7) =       0.000422045316

      target function =                  N/A
              le_mean =     -17.213565127771
             les_mean =     296.615507700643
             stat err =       0.000417706592
             autocorr =       1.187518212664
              std dev =       0.542083498830
             le_variance =       0.293854519704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294057404618
                                         uncertainty =       0.001965988884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294057404618
                                         uncertainty =       0.001965988884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383590880
  error estimate for blocks of size 2^( 2) =       0.000395079265
  error estimate for blocks of size 2^( 3) =       0.000405750141
  error estimate for blocks of size 2^( 4) =       0.000412885358
  error estimate for blocks of size 2^( 5) =       0.000417046111
  error estimate for blocks of size 2^( 6) =       0.000419533316
  error estimate for blocks of size 2^( 7) =       0.000422249680

      target function =                  N/A
              le_mean =     -17.213565436714
             les_mean =     296.616954363301
             stat err =       0.000417928617
             autocorr =       1.187046339703
              std dev =       0.542479424396
             le_variance =       0.294283925893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213566010112        initial
     3.8147e-01     3.8147e+00             9.6656e-04       -17.213568267003  <--
     1.5259e+00     1.5259e+01             3.3568e-04       -17.213565127771
     6.1035e+00     6.1035e+01             9.2968e-05       -17.213565436714

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.2961e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.547997e-02 3 1  ON 0
ci_002                -3.412400e-02 3 1  ON 1
ci_003                -2.706187e-02 3 1  ON 2
ci_004                 2.403608e-02 3 1  ON 3
ci_005                 2.312065e-02 3 1  ON 4
ci_006                -2.263884e-02 3 1  ON 5
ci_007                -2.265589e-02 3 1  ON 6
ci_008                -1.962133e-02 3 1  ON 7
ci_009                -1.960632e-02 3 1  ON 8
ci_010                -1.840487e-02 3 1  ON 9
ci_011                -1.831163e-02 3 1  ON 10
ci_012                -1.768647e-02 3 1  ON 11
ci_013                -2.047415e-02 3 1  ON 12
ci_014                 1.655298e-02 3 1  ON 13
ci_015                 1.643681e-02 3 1  ON 14
ci_016                 1.740770e-02 3 1  ON 15
ci_017                 1.694513e-02 3 1  ON 16
ci_018                 1.545612e-02 3 1  ON 17
ci_019                 1.553670e-02 3 1  ON 18
ci_020                 1.572195e-02 3 1  ON 19
ci_021                 1.618764e-02 3 1  ON 20
ci_022                 1.380287e-02 3 1  ON 21
ci_023                 1.325092e-02 3 1  ON 22
ci_024                 1.271604e-02 3 1  ON 23
ci_025                 1.335994e-02 3 1  ON 24
ci_026                 1.331240e-02 3 1  ON 25
ci_027                 1.350372e-02 3 1  ON 26
ci_028                -1.471742e-02 3 1  ON 27
ci_029                -1.507729e-02 3 1  ON 28
ci_030                -1.255120e-02 3 1  ON 29
ci_031                -1.135447e-02 3 1  ON 30
ci_032                -1.397032e-02 3 1  ON 31
ci_033                 1.100163e-02 3 1  ON 32
ci_034                 1.105404e-02 3 1  ON 33
ci_035                -6.984275e-03 3 1  ON 34
ci_036                -1.291987e-02 3 1  ON 35
ci_037                -1.226199e-02 3 1  ON 36
ci_038                 3.157983e-03 3 1  ON 37
ci_039                 2.757005e-03 3 1  ON 38
ci_040                -5.860428e-03 3 1  ON 39
ci_041                 1.059345e-02 3 1  ON 40
ci_042                 1.036027e-02 3 1  ON 41
ci_043                -5.116648e-03 3 1  ON 42
ci_044                -1.499503e-02 3 1  ON 43
ci_045                -3.922247e-03 3 1  ON 44
ci_046                 6.664942e-03 3 1  ON 45
ci_047                 6.937437e-03 3 1  ON 46
ci_048                -1.250779e-02 3 1  ON 47
ci_049                -1.190328e-02 3 1  ON 48
ci_050                 8.005152e-03 3 1  ON 49
ci_051                 8.121176e-03 3 1  ON 50
ci_052                -8.185059e-03 3 1  ON 51
ci_053                -7.802894e-03 3 1  ON 52
ci_054                -3.173119e-03 3 1  ON 53
ci_055                -3.692145e-03 3 1  ON 54
ci_056                 6.035523e-03 3 1  ON 55
ci_057                 6.007929e-03 3 1  ON 56
ci_058                -8.221436e-03 3 1  ON 57
ci_059                -7.950892e-03 3 1  ON 58
ci_060                 8.739495e-03 3 1  ON 59
ci_061                 9.246556e-03 3 1  ON 60
ci_062                -4.591149e-03 3 1  ON 61
ci_063                -3.912951e-03 3 1  ON 62
ci_064                -4.264011e-03 3 1  ON 63
ci_065                -4.874668e-03 3 1  ON 64
ci_066                 6.657463e-03 3 1  ON 65
ci_067                 6.633131e-03 3 1  ON 66
ci_068                -5.395238e-03 3 1  ON 67
ci_069                -5.370107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2702
    reference variance = 0.362221
====================================================
  Execution time = 1.4195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1191e-01
  Total weights = 1.956130370e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292893907229
                                         uncertainty =       0.003596235061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292893907229
                                         uncertainty =       0.003596235061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382705152
  error estimate for blocks of size 2^( 2) =       0.000394586703
  error estimate for blocks of size 2^( 3) =       0.000405363476
  error estimate for blocks of size 2^( 4) =       0.000412923356
  error estimate for blocks of size 2^( 5) =       0.000417265101
  error estimate for blocks of size 2^( 6) =       0.000420496203
  error estimate for blocks of size 2^( 7) =       0.000421736454

      target function =                  N/A
              le_mean =     -17.214496285730
             les_mean =     296.650788894574
             stat err =       0.000418105279
             autocorr =       1.193555680325
              std dev =       0.541226816133
             le_variance =       0.292926466501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721449628573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214496285752       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214509346496       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214510223428       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214510543112       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.305410e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214496285752       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214503509468       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214503858625       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214503882240       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 7.447917e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214496285752       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214498877072       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214498987211       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.769973e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6689e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.535208e-02 3 1  ON 0
ci_002                -3.429252e-02 3 1  ON 1
ci_003                -2.695282e-02 3 1  ON 2
ci_004                 2.373096e-02 3 1  ON 3
ci_005                 2.352408e-02 3 1  ON 4
ci_006                -2.279160e-02 3 1  ON 5
ci_007                -2.248177e-02 3 1  ON 6
ci_008                -1.981978e-02 3 1  ON 7
ci_009                -1.942856e-02 3 1  ON 8
ci_010                -1.834468e-02 3 1  ON 9
ci_011                -1.807176e-02 3 1  ON 10
ci_012                -1.752407e-02 3 1  ON 11
ci_013                -2.056873e-02 3 1  ON 12
ci_014                 1.650499e-02 3 1  ON 13
ci_015                 1.617390e-02 3 1  ON 14
ci_016                 1.718330e-02 3 1  ON 15
ci_017                 1.680762e-02 3 1  ON 16
ci_018                 1.536458e-02 3 1  ON 17
ci_019                 1.558695e-02 3 1  ON 18
ci_020                 1.567738e-02 3 1  ON 19
ci_021                 1.613361e-02 3 1  ON 20
ci_022                 1.408120e-02 3 1  ON 21
ci_023                 1.396482e-02 3 1  ON 22
ci_024                 1.297354e-02 3 1  ON 23
ci_025                 1.349929e-02 3 1  ON 24
ci_026                 1.340016e-02 3 1  ON 25
ci_027                 1.367263e-02 3 1  ON 26
ci_028                -1.471520e-02 3 1  ON 27
ci_029                -1.513958e-02 3 1  ON 28
ci_030                -1.215890e-02 3 1  ON 29
ci_031                -1.108208e-02 3 1  ON 30
ci_032                -1.379424e-02 3 1  ON 31
ci_033                 1.126597e-02 3 1  ON 32
ci_034                 1.099282e-02 3 1  ON 33
ci_035                -6.997430e-03 3 1  ON 34
ci_036                -1.276562e-02 3 1  ON 35
ci_037                -1.243482e-02 3 1  ON 36
ci_038                 2.712923e-03 3 1  ON 37
ci_039                 2.776062e-03 3 1  ON 38
ci_040                -5.873262e-03 3 1  ON 39
ci_041                 1.050066e-02 3 1  ON 40
ci_042                 1.020496e-02 3 1  ON 41
ci_043                -4.903437e-03 3 1  ON 42
ci_044                -1.507608e-02 3 1  ON 43
ci_045                -3.820734e-03 3 1  ON 44
ci_046                 6.845682e-03 3 1  ON 45
ci_047                 7.088568e-03 3 1  ON 46
ci_048                -1.203338e-02 3 1  ON 47
ci_049                -1.219954e-02 3 1  ON 48
ci_050                 8.349371e-03 3 1  ON 49
ci_051                 8.302834e-03 3 1  ON 50
ci_052                -8.032860e-03 3 1  ON 51
ci_053                -7.766422e-03 3 1  ON 52
ci_054                -3.917911e-03 3 1  ON 53
ci_055                -3.954334e-03 3 1  ON 54
ci_056                 6.180477e-03 3 1  ON 55
ci_057                 6.023670e-03 3 1  ON 56
ci_058                -8.181038e-03 3 1  ON 57
ci_059                -7.908690e-03 3 1  ON 58
ci_060                 8.380131e-03 3 1  ON 59
ci_061                 8.959719e-03 3 1  ON 60
ci_062                -4.415934e-03 3 1  ON 61
ci_063                -4.282787e-03 3 1  ON 62
ci_064                -4.295368e-03 3 1  ON 63
ci_065                -4.774838e-03 3 1  ON 64
ci_066                 6.456649e-03 3 1  ON 65
ci_067                 6.431272e-03 3 1  ON 66
ci_068                -5.730728e-03 3 1  ON 67
ci_069                -5.705668e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.189015
====================================================
  Execution time = 1.3772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1107e-01
  Total weights = 1.9560e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558776285
                                         uncertainty =       0.002043458339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558776285
                                         uncertainty =       0.002043458339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383076236
  error estimate for blocks of size 2^( 2) =       0.000394519853
  error estimate for blocks of size 2^( 3) =       0.000404620655
  error estimate for blocks of size 2^( 4) =       0.000412121158
  error estimate for blocks of size 2^( 5) =       0.000417260380
  error estimate for blocks of size 2^( 6) =       0.000418808973
  error estimate for blocks of size 2^( 7) =       0.000420336122

      target function =                  N/A
              le_mean =     -17.214559246837
             les_mean =     296.671003730251
             stat err =       0.000417131658
             autocorr =       1.185702895554
              std dev =       0.541751608595
             le_variance =       0.293494805415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297648903886
                                         uncertainty =       0.004550005420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297648903886
                                         uncertainty =       0.004550005420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385727089
  error estimate for blocks of size 2^( 2) =       0.000397113409
  error estimate for blocks of size 2^( 3) =       0.000407097348
  error estimate for blocks of size 2^( 4) =       0.000414535117
  error estimate for blocks of size 2^( 5) =       0.000419713839
  error estimate for blocks of size 2^( 6) =       0.000421247421
  error estimate for blocks of size 2^( 7) =       0.000422682660

      target function =                  N/A
              le_mean =     -17.214590200295
             les_mean =     298.394192453964
             stat err =       0.000419544759
             autocorr =       1.183031537596
              std dev =       0.545500480085
             le_variance =       0.297570773772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293776661636
                                         uncertainty =       0.002004167081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293776661636
                                         uncertainty =       0.002004167081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383219758
  error estimate for blocks of size 2^( 2) =       0.000394667384
  error estimate for blocks of size 2^( 3) =       0.000404778009
  error estimate for blocks of size 2^( 4) =       0.000412304105
  error estimate for blocks of size 2^( 5) =       0.000417473933
  error estimate for blocks of size 2^( 6) =       0.000419069178
  error estimate for blocks of size 2^( 7) =       0.000420574126

      target function =                  N/A
              le_mean =     -17.214554876980
             les_mean =     296.659839598626
             stat err =       0.000417355336
             autocorr =       1.186085932759
              std dev =       0.541954579818
             le_variance =       0.293714766585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293528887098
                                         uncertainty =       0.002033022670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293528887098
                                         uncertainty =       0.002033022670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383057006
  error estimate for blocks of size 2^( 2) =       0.000394499527
  error estimate for blocks of size 2^( 3) =       0.000404603104
  error estimate for blocks of size 2^( 4) =       0.000412109725
  error estimate for blocks of size 2^( 5) =       0.000417255913
  error estimate for blocks of size 2^( 6) =       0.000418815176
  error estimate for blocks of size 2^( 7) =       0.000420342686

      target function =                  N/A
              le_mean =     -17.214548068001
             les_mean =     296.653942759533
             stat err =       0.000417130875
             autocorr =       1.185817493703
              std dev =       0.541724413430
             le_variance =       0.293465340106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214559246837        initial
     9.5367e-02     9.5367e-01             1.3054e-03       -17.214590200295  <--
     3.8147e-01     3.8147e+00             7.4479e-04       -17.214554876980
     1.5259e+00     1.5259e+01             2.7700e-04       -17.214548068001

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 2.2998e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.525414e-02 3 1  ON 0
ci_002                -3.444045e-02 3 1  ON 1
ci_003                -2.683130e-02 3 1  ON 2
ci_004                 2.340016e-02 3 1  ON 3
ci_005                 2.396713e-02 3 1  ON 4
ci_006                -2.294538e-02 3 1  ON 5
ci_007                -2.233438e-02 3 1  ON 6
ci_008                -1.998213e-02 3 1  ON 7
ci_009                -1.928748e-02 3 1  ON 8
ci_010                -1.828699e-02 3 1  ON 9
ci_011                -1.787457e-02 3 1  ON 10
ci_012                -1.736568e-02 3 1  ON 11
ci_013                -2.068116e-02 3 1  ON 12
ci_014                 1.646519e-02 3 1  ON 13
ci_015                 1.591758e-02 3 1  ON 14
ci_016                 1.694420e-02 3 1  ON 15
ci_017                 1.669035e-02 3 1  ON 16
ci_018                 1.528626e-02 3 1  ON 17
ci_019                 1.562933e-02 3 1  ON 18
ci_020                 1.563597e-02 3 1  ON 19
ci_021                 1.606931e-02 3 1  ON 20
ci_022                 1.431201e-02 3 1  ON 21
ci_023                 1.455633e-02 3 1  ON 22
ci_024                 1.323820e-02 3 1  ON 23
ci_025                 1.365204e-02 3 1  ON 24
ci_026                 1.351343e-02 3 1  ON 25
ci_027                 1.384526e-02 3 1  ON 26
ci_028                -1.470932e-02 3 1  ON 27
ci_029                -1.519708e-02 3 1  ON 28
ci_030                -1.180912e-02 3 1  ON 29
ci_031                -1.082495e-02 3 1  ON 30
ci_032                -1.366041e-02 3 1  ON 31
ci_033                 1.150826e-02 3 1  ON 32
ci_034                 1.093787e-02 3 1  ON 33
ci_035                -7.010969e-03 3 1  ON 34
ci_036                -1.263215e-02 3 1  ON 35
ci_037                -1.261305e-02 3 1  ON 36
ci_038                 2.455490e-03 3 1  ON 37
ci_039                 2.784900e-03 3 1  ON 38
ci_040                -5.880749e-03 3 1  ON 39
ci_041                 1.041521e-02 3 1  ON 40
ci_042                 1.007416e-02 3 1  ON 41
ci_043                -4.777206e-03 3 1  ON 42
ci_044                -1.519297e-02 3 1  ON 43
ci_045                -3.760199e-03 3 1  ON 44
ci_046                 6.989558e-03 3 1  ON 45
ci_047                 7.213371e-03 3 1  ON 46
ci_048                -1.152645e-02 3 1  ON 47
ci_049                -1.255895e-02 3 1  ON 48
ci_050                 8.578313e-03 3 1  ON 49
ci_051                 8.415763e-03 3 1  ON 50
ci_052                -7.925540e-03 3 1  ON 51
ci_053                -7.738937e-03 3 1  ON 52
ci_054                -4.463165e-03 3 1  ON 53
ci_055                -4.147640e-03 3 1  ON 54
ci_056                 6.273488e-03 3 1  ON 55
ci_057                 6.038558e-03 3 1  ON 56
ci_058                -8.160643e-03 3 1  ON 57
ci_059                -7.878387e-03 3 1  ON 58
ci_060                 8.052865e-03 3 1  ON 59
ci_061                 8.702804e-03 3 1  ON 60
ci_062                -4.274880e-03 3 1  ON 61
ci_063                -4.544364e-03 3 1  ON 62
ci_064                -4.315137e-03 3 1  ON 63
ci_065                -4.725152e-03 3 1  ON 64
ci_066                 6.326656e-03 3 1  ON 65
ci_067                 6.304572e-03 3 1  ON 66
ci_068                -5.994123e-03 3 1  ON 67
ci_069                -5.970247e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.220881
====================================================
  Execution time = 1.4308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1016e-01
  Total weights = 1.956247919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294218408897
                                         uncertainty =       0.002151025344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294218408897
                                         uncertainty =       0.002151025344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383511620
  error estimate for blocks of size 2^( 2) =       0.000395652058
  error estimate for blocks of size 2^( 3) =       0.000406268261
  error estimate for blocks of size 2^( 4) =       0.000413836423
  error estimate for blocks of size 2^( 5) =       0.000417446255
  error estimate for blocks of size 2^( 6) =       0.000419046818
  error estimate for blocks of size 2^( 7) =       0.000421300778

      target function =                  N/A
              le_mean =     -17.214409583182
             les_mean =     296.646060736278
             stat err =       0.000417907568
             autocorr =       1.187417428146
              std dev =       0.542367334127
             le_variance =       0.294162325128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721440958318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214409583185       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214448548327       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214448413883       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214447540563       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214447465485       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-02 is 1.501595e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214409583185       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214440761412       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214440220124       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214439715321       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214439662621       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.229817e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214409583185       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214426910421       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214426375433       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214426231270       residual = 8.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 7.107064e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6793e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.483484e-02 3 1  ON 0
ci_002                -3.407699e-02 3 1  ON 1
ci_003                -2.766234e-02 3 1  ON 2
ci_004                 2.387164e-02 3 1  ON 3
ci_005                 2.473910e-02 3 1  ON 4
ci_006                -2.291667e-02 3 1  ON 5
ci_007                -2.313514e-02 3 1  ON 6
ci_008                -1.966528e-02 3 1  ON 7
ci_009                -1.987054e-02 3 1  ON 8
ci_010                -1.896167e-02 3 1  ON 9
ci_011                -1.751776e-02 3 1  ON 10
ci_012                -1.699644e-02 3 1  ON 11
ci_013                -2.040213e-02 3 1  ON 12
ci_014                 1.574104e-02 3 1  ON 13
ci_015                 1.597840e-02 3 1  ON 14
ci_016                 1.687887e-02 3 1  ON 15
ci_017                 1.752371e-02 3 1  ON 16
ci_018                 1.499724e-02 3 1  ON 17
ci_019                 1.523264e-02 3 1  ON 18
ci_020                 1.517142e-02 3 1  ON 19
ci_021                 1.652853e-02 3 1  ON 20
ci_022                 1.380174e-02 3 1  ON 21
ci_023                 1.431206e-02 3 1  ON 22
ci_024                 1.292723e-02 3 1  ON 23
ci_025                 1.304943e-02 3 1  ON 24
ci_026                 1.342462e-02 3 1  ON 25
ci_027                 1.441811e-02 3 1  ON 26
ci_028                -1.485620e-02 3 1  ON 27
ci_029                -1.457882e-02 3 1  ON 28
ci_030                -1.191817e-02 3 1  ON 29
ci_031                -1.124776e-02 3 1  ON 30
ci_032                -1.384881e-02 3 1  ON 31
ci_033                 1.123798e-02 3 1  ON 32
ci_034                 1.056177e-02 3 1  ON 33
ci_035                -7.427794e-03 3 1  ON 34
ci_036                -1.296013e-02 3 1  ON 35
ci_037                -1.260460e-02 3 1  ON 36
ci_038                 2.883283e-03 3 1  ON 37
ci_039                 3.268874e-03 3 1  ON 38
ci_040                -5.799214e-03 3 1  ON 39
ci_041                 1.051556e-02 3 1  ON 40
ci_042                 1.035120e-02 3 1  ON 41
ci_043                -5.265932e-03 3 1  ON 42
ci_044                -1.573347e-02 3 1  ON 43
ci_045                -3.650915e-03 3 1  ON 44
ci_046                 6.989440e-03 3 1  ON 45
ci_047                 6.378377e-03 3 1  ON 46
ci_048                -1.245726e-02 3 1  ON 47
ci_049                -1.209196e-02 3 1  ON 48
ci_050                 8.395162e-03 3 1  ON 49
ci_051                 8.692755e-03 3 1  ON 50
ci_052                -7.630744e-03 3 1  ON 51
ci_053                -7.734686e-03 3 1  ON 52
ci_054                -3.233348e-03 3 1  ON 53
ci_055                -4.030004e-03 3 1  ON 54
ci_056                 6.547601e-03 3 1  ON 55
ci_057                 6.742131e-03 3 1  ON 56
ci_058                -8.293658e-03 3 1  ON 57
ci_059                -8.730000e-03 3 1  ON 58
ci_060                 8.805374e-03 3 1  ON 59
ci_061                 9.196987e-03 3 1  ON 60
ci_062                -4.283465e-03 3 1  ON 61
ci_063                -4.034151e-03 3 1  ON 62
ci_064                -4.263958e-03 3 1  ON 63
ci_065                -4.980291e-03 3 1  ON 64
ci_066                 6.235063e-03 3 1  ON 65
ci_067                 6.041416e-03 3 1  ON 66
ci_068                -5.763258e-03 3 1  ON 67
ci_069                -6.389495e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.14661
====================================================
  Execution time = 1.3680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0519e-01
  Total weights = 1.9563e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292881230961
                                         uncertainty =       0.002042258810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292881230961
                                         uncertainty =       0.002042258810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382712276
  error estimate for blocks of size 2^( 2) =       0.000394464896
  error estimate for blocks of size 2^( 3) =       0.000404811893
  error estimate for blocks of size 2^( 4) =       0.000412697559
  error estimate for blocks of size 2^( 5) =       0.000416612476
  error estimate for blocks of size 2^( 6) =       0.000418814819
  error estimate for blocks of size 2^( 7) =       0.000421947819

      target function =                  N/A
              le_mean =     -17.215132769260
             les_mean =     296.685726543246
             stat err =       0.000417518168
             autocorr =       1.190161704582
              std dev =       0.541236890740
             le_variance =       0.292937371898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292554711674
                                         uncertainty =       0.002007144515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292554711674
                                         uncertainty =       0.002007144515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382502991
  error estimate for blocks of size 2^( 2) =       0.000394217810
  error estimate for blocks of size 2^( 3) =       0.000404517504
  error estimate for blocks of size 2^( 4) =       0.000412368317
  error estimate for blocks of size 2^( 5) =       0.000416291518
  error estimate for blocks of size 2^( 6) =       0.000418517839
  error estimate for blocks of size 2^( 7) =       0.000421808536

      target function =                  N/A
              le_mean =     -17.215113437522
             les_mean =     296.666123735640
             stat err =       0.000417246553
             autocorr =       1.189914735420
              std dev =       0.540940917949
             le_variance =       0.292617076712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293315885735
                                         uncertainty =       0.002000299625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293315885735
                                         uncertainty =       0.002000299625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383001842
  error estimate for blocks of size 2^( 2) =       0.000394688292
  error estimate for blocks of size 2^( 3) =       0.000404954595
  error estimate for blocks of size 2^( 4) =       0.000412780865
  error estimate for blocks of size 2^( 5) =       0.000416727358
  error estimate for blocks of size 2^( 6) =       0.000418948157
  error estimate for blocks of size 2^( 7) =       0.000422417968

      target function =                  N/A
              le_mean =     -17.215177532256
             les_mean =     297.030861934147
             stat err =       0.000417718587
             autocorr =       1.189503911870
              std dev =       0.541646399806
             le_variance =       0.293380822423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292576310311
                                         uncertainty =       0.002017209896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292576310311
                                         uncertainty =       0.002017209896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382514671
  error estimate for blocks of size 2^( 2) =       0.000394250341
  error estimate for blocks of size 2^( 3) =       0.000404562980
  error estimate for blocks of size 2^( 4) =       0.000412426456
  error estimate for blocks of size 2^( 5) =       0.000416334493
  error estimate for blocks of size 2^( 6) =       0.000418527922
  error estimate for blocks of size 2^( 7) =       0.000421763574

      target function =                  N/A
              le_mean =     -17.215119104899
             les_mean =     296.715719529035
             stat err =       0.000417263111
             autocorr =       1.189936512303
              std dev =       0.540957435127
             le_variance =       0.292634946620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215132769260        initial
     2.3842e-02     2.3842e-01             1.5016e-03       -17.215113437522
     9.5367e-02     9.5367e-01             1.2298e-03       -17.215177532256  <--
     3.8147e-01     3.8147e+00             7.1071e-04       -17.215119104899

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 2.2886e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.483484e-02 3 1  ON 0
ci_002                -3.407699e-02 3 1  ON 1
ci_003                -2.766234e-02 3 1  ON 2
ci_004                 2.387164e-02 3 1  ON 3
ci_005                 2.473910e-02 3 1  ON 4
ci_006                -2.291667e-02 3 1  ON 5
ci_007                -2.313514e-02 3 1  ON 6
ci_008                -1.966528e-02 3 1  ON 7
ci_009                -1.987054e-02 3 1  ON 8
ci_010                -1.896167e-02 3 1  ON 9
ci_011                -1.751776e-02 3 1  ON 10
ci_012                -1.699644e-02 3 1  ON 11
ci_013                -2.040213e-02 3 1  ON 12
ci_014                 1.574104e-02 3 1  ON 13
ci_015                 1.597840e-02 3 1  ON 14
ci_016                 1.687887e-02 3 1  ON 15
ci_017                 1.752371e-02 3 1  ON 16
ci_018                 1.499724e-02 3 1  ON 17
ci_019                 1.523264e-02 3 1  ON 18
ci_020                 1.517142e-02 3 1  ON 19
ci_021                 1.652853e-02 3 1  ON 20
ci_022                 1.380174e-02 3 1  ON 21
ci_023                 1.431206e-02 3 1  ON 22
ci_024                 1.292723e-02 3 1  ON 23
ci_025                 1.304943e-02 3 1  ON 24
ci_026                 1.342462e-02 3 1  ON 25
ci_027                 1.441811e-02 3 1  ON 26
ci_028                -1.485620e-02 3 1  ON 27
ci_029                -1.457882e-02 3 1  ON 28
ci_030                -1.191817e-02 3 1  ON 29
ci_031                -1.124776e-02 3 1  ON 30
ci_032                -1.384881e-02 3 1  ON 31
ci_033                 1.123798e-02 3 1  ON 32
ci_034                 1.056177e-02 3 1  ON 33
ci_035                -7.427794e-03 3 1  ON 34
ci_036                -1.296013e-02 3 1  ON 35
ci_037                -1.260460e-02 3 1  ON 36
ci_038                 2.883283e-03 3 1  ON 37
ci_039                 3.268874e-03 3 1  ON 38
ci_040                -5.799214e-03 3 1  ON 39
ci_041                 1.051556e-02 3 1  ON 40
ci_042                 1.035120e-02 3 1  ON 41
ci_043                -5.265932e-03 3 1  ON 42
ci_044                -1.573347e-02 3 1  ON 43
ci_045                -3.650915e-03 3 1  ON 44
ci_046                 6.989440e-03 3 1  ON 45
ci_047                 6.378377e-03 3 1  ON 46
ci_048                -1.245726e-02 3 1  ON 47
ci_049                -1.209196e-02 3 1  ON 48
ci_050                 8.395162e-03 3 1  ON 49
ci_051                 8.692755e-03 3 1  ON 50
ci_052                -7.630744e-03 3 1  ON 51
ci_053                -7.734686e-03 3 1  ON 52
ci_054                -3.233348e-03 3 1  ON 53
ci_055                -4.030004e-03 3 1  ON 54
ci_056                 6.547601e-03 3 1  ON 55
ci_057                 6.742131e-03 3 1  ON 56
ci_058                -8.293658e-03 3 1  ON 57
ci_059                -8.730000e-03 3 1  ON 58
ci_060                 8.805374e-03 3 1  ON 59
ci_061                 9.196987e-03 3 1  ON 60
ci_062                -4.283465e-03 3 1  ON 61
ci_063                -4.034151e-03 3 1  ON 62
ci_064                -4.263958e-03 3 1  ON 63
ci_065                -4.980291e-03 3 1  ON 64
ci_066                 6.235063e-03 3 1  ON 65
ci_067                 6.041416e-03 3 1  ON 66
ci_068                -5.763258e-03 3 1  ON 67
ci_069                -6.389495e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.144169
====================================================
  Execution time = 1.4397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0454e-01
  Total weights = 1.955931661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290241061370
                                         uncertainty =       0.001762300141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290241061370
                                         uncertainty =       0.001762300141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380990370
  error estimate for blocks of size 2^( 2) =       0.000393392473
  error estimate for blocks of size 2^( 3) =       0.000403677566
  error estimate for blocks of size 2^( 4) =       0.000411815002
  error estimate for blocks of size 2^( 5) =       0.000415973429
  error estimate for blocks of size 2^( 6) =       0.000419427590
  error estimate for blocks of size 2^( 7) =       0.000421799690

      target function =                  N/A
              le_mean =     -17.214005184072
             les_mean =     296.626517958100
             stat err =       0.000417253928
             autocorr =       1.199424378914
              std dev =       0.538801747707
             le_variance =       0.290307323332


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721400518407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214005184034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214038034591       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214037177757       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214037525162       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214037816015       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-02 is 1.945704e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214005184034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214031029925       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214030252502       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214030376629       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.523346e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214005184034       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214019132791       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214018734563       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214018720834       residual = 7.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 8.099345e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067720 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6887e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.433298e-02 3 1  ON 0
ci_002                -3.430923e-02 3 1  ON 1
ci_003                -2.713086e-02 3 1  ON 2
ci_004                 2.449994e-02 3 1  ON 3
ci_005                 2.360693e-02 3 1  ON 4
ci_006                -2.254031e-02 3 1  ON 5
ci_007                -2.196858e-02 3 1  ON 6
ci_008                -1.977292e-02 3 1  ON 7
ci_009                -1.898907e-02 3 1  ON 8
ci_010                -1.924523e-02 3 1  ON 9
ci_011                -1.816579e-02 3 1  ON 10
ci_012                -1.851979e-02 3 1  ON 11
ci_013                -1.986575e-02 3 1  ON 12
ci_014                 1.599725e-02 3 1  ON 13
ci_015                 1.652930e-02 3 1  ON 14
ci_016                 1.668395e-02 3 1  ON 15
ci_017                 1.715064e-02 3 1  ON 16
ci_018                 1.595905e-02 3 1  ON 17
ci_019                 1.534779e-02 3 1  ON 18
ci_020                 1.593399e-02 3 1  ON 19
ci_021                 1.558144e-02 3 1  ON 20
ci_022                 1.395376e-02 3 1  ON 21
ci_023                 1.446409e-02 3 1  ON 22
ci_024                 1.268500e-02 3 1  ON 23
ci_025                 1.302553e-02 3 1  ON 24
ci_026                 1.364572e-02 3 1  ON 25
ci_027                 1.434764e-02 3 1  ON 26
ci_028                -1.506577e-02 3 1  ON 27
ci_029                -1.490546e-02 3 1  ON 28
ci_030                -1.177520e-02 3 1  ON 29
ci_031                -1.157924e-02 3 1  ON 30
ci_032                -1.411158e-02 3 1  ON 31
ci_033                 1.076064e-02 3 1  ON 32
ci_034                 1.042403e-02 3 1  ON 33
ci_035                -7.156433e-03 3 1  ON 34
ci_036                -1.247163e-02 3 1  ON 35
ci_037                -1.262466e-02 3 1  ON 36
ci_038                 2.705956e-03 3 1  ON 37
ci_039                 2.840253e-03 3 1  ON 38
ci_040                -5.877040e-03 3 1  ON 39
ci_041                 1.009604e-02 3 1  ON 40
ci_042                 1.041858e-02 3 1  ON 41
ci_043                -4.833233e-03 3 1  ON 42
ci_044                -1.560318e-02 3 1  ON 43
ci_045                -3.853963e-03 3 1  ON 44
ci_046                 6.824203e-03 3 1  ON 45
ci_047                 7.022482e-03 3 1  ON 46
ci_048                -1.230295e-02 3 1  ON 47
ci_049                -1.219160e-02 3 1  ON 48
ci_050                 8.516891e-03 3 1  ON 49
ci_051                 8.829174e-03 3 1  ON 50
ci_052                -7.592749e-03 3 1  ON 51
ci_053                -7.547322e-03 3 1  ON 52
ci_054                -3.108073e-03 3 1  ON 53
ci_055                -3.936115e-03 3 1  ON 54
ci_056                 6.284236e-03 3 1  ON 55
ci_057                 6.233355e-03 3 1  ON 56
ci_058                -8.090015e-03 3 1  ON 57
ci_059                -8.523200e-03 3 1  ON 58
ci_060                 8.762296e-03 3 1  ON 59
ci_061                 8.374341e-03 3 1  ON 60
ci_062                -3.807261e-03 3 1  ON 61
ci_063                -4.177090e-03 3 1  ON 62
ci_064                -4.266313e-03 3 1  ON 63
ci_065                -5.113555e-03 3 1  ON 64
ci_066                 6.489266e-03 3 1  ON 65
ci_067                 6.046468e-03 3 1  ON 66
ci_068                -5.115032e-03 3 1  ON 67
ci_069                -5.426214e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.202058
====================================================
  Execution time = 1.3696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0671e-01
  Total weights = 1.9561e+06
  Execution time = 1.8557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.02255e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294215732104
                                         uncertainty =       0.002262054086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294215732104
                                         uncertainty =       0.002262054086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383611988
  error estimate for blocks of size 2^( 2) =       0.000394909996
  error estimate for blocks of size 2^( 3) =       0.000405641862
  error estimate for blocks of size 2^( 4) =       0.000413466174
  error estimate for blocks of size 2^( 5) =       0.000417485117
  error estimate for blocks of size 2^( 6) =       0.000420205842
  error estimate for blocks of size 2^( 7) =       0.000422257132

      target function =                  N/A
              le_mean =     -17.214306124738
             les_mean =     297.464706477601
             stat err =       0.000418353566
             autocorr =       1.189330643034
              std dev =       0.542509276707
             le_variance =       0.294316315313

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000127546
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293996196565
                                         uncertainty =       0.002137911922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293996196565
                                         uncertainty =       0.002137911922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383468565
  error estimate for blocks of size 2^( 2) =       0.000394769257
  error estimate for blocks of size 2^( 3) =       0.000405519047
  error estimate for blocks of size 2^( 4) =       0.000413405058
  error estimate for blocks of size 2^( 5) =       0.000417515507
  error estimate for blocks of size 2^( 6) =       0.000420242223
  error estimate for blocks of size 2^( 7) =       0.000422274480

      target function =                  N/A
              le_mean =     -17.214231338306
             les_mean =     296.637804104729
             stat err =       0.000418359317
             autocorr =       1.190253189649
              std dev =       0.542306445463
             le_variance =       0.294096280791

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.0217e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295020613328
                                         uncertainty =       0.002204194249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295020613328
                                         uncertainty =       0.002204194249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384135511
  error estimate for blocks of size 2^( 2) =       0.000395423126
  error estimate for blocks of size 2^( 3) =       0.000406172692
  error estimate for blocks of size 2^( 4) =       0.000414037587
  error estimate for blocks of size 2^( 5) =       0.000418177499
  error estimate for blocks of size 2^( 6) =       0.000420936546
  error estimate for blocks of size 2^( 7) =       0.000423047461

      target function =                  N/A
              le_mean =     -17.214253041440
             les_mean =     296.645285497065
             stat err =       0.000419049773
             autocorr =       1.190042045205
              std dev =       0.543249649721
             le_variance =       0.295120181922

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 9.14245e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293332670209
                                         uncertainty =       0.002075979365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293332670209
                                         uncertainty =       0.002075979365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383035866
  error estimate for blocks of size 2^( 2) =       0.000394351774
  error estimate for blocks of size 2^( 3) =       0.000405103379
  error estimate for blocks of size 2^( 4) =       0.000412997017
  error estimate for blocks of size 2^( 5) =       0.000417086712
  error estimate for blocks of size 2^( 6) =       0.000419804595
  error estimate for blocks of size 2^( 7) =       0.000421827799

      target function =                  N/A
              le_mean =     -17.214244698741
             les_mean =     296.639420909057
             stat err =       0.000417929031
             autocorr =       1.190491218122
              std dev =       0.541694517049
             le_variance =       0.293432949801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214306124738        initial  <--
     2.3842e-02     2.3842e-01             1.9457e-03       -17.214231338306
     9.5367e-02     9.5367e-01             1.5233e-03       -17.214253041440
     3.8147e-01     3.8147e+00             8.0993e-04       -17.214244698741

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9636
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.483484e-02 3 1  ON 0
ci_002                -3.407699e-02 3 1  ON 1
ci_003                -2.766234e-02 3 1  ON 2
ci_004                 2.387164e-02 3 1  ON 3
ci_005                 2.473910e-02 3 1  ON 4
ci_006                -2.291667e-02 3 1  ON 5
ci_007                -2.313514e-02 3 1  ON 6
ci_008                -1.966528e-02 3 1  ON 7
ci_009                -1.987054e-02 3 1  ON 8
ci_010                -1.896167e-02 3 1  ON 9
ci_011                -1.751776e-02 3 1  ON 10
ci_012                -1.699644e-02 3 1  ON 11
ci_013                -2.040213e-02 3 1  ON 12
ci_014                 1.574104e-02 3 1  ON 13
ci_015                 1.597840e-02 3 1  ON 14
ci_016                 1.687887e-02 3 1  ON 15
ci_017                 1.752371e-02 3 1  ON 16
ci_018                 1.499724e-02 3 1  ON 17
ci_019                 1.523264e-02 3 1  ON 18
ci_020                 1.517142e-02 3 1  ON 19
ci_021                 1.652853e-02 3 1  ON 20
ci_022                 1.380174e-02 3 1  ON 21
ci_023                 1.431206e-02 3 1  ON 22
ci_024                 1.292723e-02 3 1  ON 23
ci_025                 1.304943e-02 3 1  ON 24
ci_026                 1.342462e-02 3 1  ON 25
ci_027                 1.441811e-02 3 1  ON 26
ci_028                -1.485620e-02 3 1  ON 27
ci_029                -1.457882e-02 3 1  ON 28
ci_030                -1.191817e-02 3 1  ON 29
ci_031                -1.124776e-02 3 1  ON 30
ci_032                -1.384881e-02 3 1  ON 31
ci_033                 1.123798e-02 3 1  ON 32
ci_034                 1.056177e-02 3 1  ON 33
ci_035                -7.427794e-03 3 1  ON 34
ci_036                -1.296013e-02 3 1  ON 35
ci_037                -1.260460e-02 3 1  ON 36
ci_038                 2.883283e-03 3 1  ON 37
ci_039                 3.268874e-03 3 1  ON 38
ci_040                -5.799214e-03 3 1  ON 39
ci_041                 1.051556e-02 3 1  ON 40
ci_042                 1.035120e-02 3 1  ON 41
ci_043                -5.265932e-03 3 1  ON 42
ci_044                -1.573347e-02 3 1  ON 43
ci_045                -3.650915e-03 3 1  ON 44
ci_046                 6.989440e-03 3 1  ON 45
ci_047                 6.378377e-03 3 1  ON 46
ci_048                -1.245726e-02 3 1  ON 47
ci_049                -1.209196e-02 3 1  ON 48
ci_050                 8.395162e-03 3 1  ON 49
ci_051                 8.692755e-03 3 1  ON 50
ci_052                -7.630744e-03 3 1  ON 51
ci_053                -7.734686e-03 3 1  ON 52
ci_054                -3.233348e-03 3 1  ON 53
ci_055                -4.030004e-03 3 1  ON 54
ci_056                 6.547601e-03 3 1  ON 55
ci_057                 6.742131e-03 3 1  ON 56
ci_058                -8.293658e-03 3 1  ON 57
ci_059                -8.730000e-03 3 1  ON 58
ci_060                 8.805374e-03 3 1  ON 59
ci_061                 9.196987e-03 3 1  ON 60
ci_062                -4.283465e-03 3 1  ON 61
ci_063                -4.034151e-03 3 1  ON 62
ci_064                -4.263958e-03 3 1  ON 63
ci_065                -4.980291e-03 3 1  ON 64
ci_066                 6.235063e-03 3 1  ON 65
ci_067                 6.041416e-03 3 1  ON 66
ci_068                -5.763258e-03 3 1  ON 67
ci_069                -6.389495e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.180593
====================================================
  Execution time = 1.4070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0012e-01
  Total weights = 1.956369183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288778064574
                                         uncertainty =       0.001910923237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288778064574
                                         uncertainty =       0.001910923237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380020529
  error estimate for blocks of size 2^( 2) =       0.000391885443
  error estimate for blocks of size 2^( 3) =       0.000402415118
  error estimate for blocks of size 2^( 4) =       0.000409211798
  error estimate for blocks of size 2^( 5) =       0.000413250315
  error estimate for blocks of size 2^( 6) =       0.000416478483
  error estimate for blocks of size 2^( 7) =       0.000415674709

      target function =                  N/A
              le_mean =     -17.214397125547
             les_mean =     296.635588697560
             stat err =       0.000413653826
             autocorr =       1.184840732366
              std dev =       0.537430185907
             le_variance =       0.288831204724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721439712555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214397125552       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214406987704       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214408744415       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214408700445       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 7.551650e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214397125552       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214401178924       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214401621999       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.076158e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214397125552       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214398333354       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214398419528       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 9.114884e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6543e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.497513e-02 3 1  ON 0
ci_002                -3.405841e-02 3 1  ON 1
ci_003                -2.758683e-02 3 1  ON 2
ci_004                 2.386121e-02 3 1  ON 3
ci_005                 2.459357e-02 3 1  ON 4
ci_006                -2.273323e-02 3 1  ON 5
ci_007                -2.301857e-02 3 1  ON 6
ci_008                -1.988844e-02 3 1  ON 7
ci_009                -1.971425e-02 3 1  ON 8
ci_010                -1.888112e-02 3 1  ON 9
ci_011                -1.744643e-02 3 1  ON 10
ci_012                -1.723659e-02 3 1  ON 11
ci_013                -2.026489e-02 3 1  ON 12
ci_014                 1.584656e-02 3 1  ON 13
ci_015                 1.603723e-02 3 1  ON 14
ci_016                 1.689838e-02 3 1  ON 15
ci_017                 1.751340e-02 3 1  ON 16
ci_018                 1.524211e-02 3 1  ON 17
ci_019                 1.538146e-02 3 1  ON 18
ci_020                 1.509639e-02 3 1  ON 19
ci_021                 1.637508e-02 3 1  ON 20
ci_022                 1.375210e-02 3 1  ON 21
ci_023                 1.431753e-02 3 1  ON 22
ci_024                 1.291904e-02 3 1  ON 23
ci_025                 1.280054e-02 3 1  ON 24
ci_026                 1.351825e-02 3 1  ON 25
ci_027                 1.425664e-02 3 1  ON 26
ci_028                -1.482737e-02 3 1  ON 27
ci_029                -1.464287e-02 3 1  ON 28
ci_030                -1.200537e-02 3 1  ON 29
ci_031                -1.139481e-02 3 1  ON 30
ci_032                -1.397185e-02 3 1  ON 31
ci_033                 1.120508e-02 3 1  ON 32
ci_034                 1.058430e-02 3 1  ON 33
ci_035                -7.210334e-03 3 1  ON 34
ci_036                -1.280413e-02 3 1  ON 35
ci_037                -1.243799e-02 3 1  ON 36
ci_038                 2.951003e-03 3 1  ON 37
ci_039                 3.129489e-03 3 1  ON 38
ci_040                -5.960871e-03 3 1  ON 39
ci_041                 1.045747e-02 3 1  ON 40
ci_042                 1.036587e-02 3 1  ON 41
ci_043                -5.266926e-03 3 1  ON 42
ci_044                -1.569502e-02 3 1  ON 43
ci_045                -3.651251e-03 3 1  ON 44
ci_046                 7.031793e-03 3 1  ON 45
ci_047                 6.628539e-03 3 1  ON 46
ci_048                -1.235381e-02 3 1  ON 47
ci_049                -1.204471e-02 3 1  ON 48
ci_050                 8.491471e-03 3 1  ON 49
ci_051                 8.576658e-03 3 1  ON 50
ci_052                -7.812843e-03 3 1  ON 51
ci_053                -7.641909e-03 3 1  ON 52
ci_054                -3.206944e-03 3 1  ON 53
ci_055                -3.933492e-03 3 1  ON 54
ci_056                 6.492882e-03 3 1  ON 55
ci_057                 6.746849e-03 3 1  ON 56
ci_058                -8.357113e-03 3 1  ON 57
ci_059                -8.731793e-03 3 1  ON 58
ci_060                 8.922804e-03 3 1  ON 59
ci_061                 9.077799e-03 3 1  ON 60
ci_062                -4.194013e-03 3 1  ON 61
ci_063                -4.045775e-03 3 1  ON 62
ci_064                -4.324405e-03 3 1  ON 63
ci_065                -5.064087e-03 3 1  ON 64
ci_066                 6.154232e-03 3 1  ON 65
ci_067                 6.176544e-03 3 1  ON 66
ci_068                -5.639815e-03 3 1  ON 67
ci_069                -6.081879e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2938
    reference variance = 0.343459
====================================================
  Execution time = 1.3785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0241e-01
  Total weights = 1.9562e+06
  Execution time = 1.8506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288739918919
                                         uncertainty =       0.001633858565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288739918919
                                         uncertainty =       0.001633858565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379895617
  error estimate for blocks of size 2^( 2) =       0.000391649524
  error estimate for blocks of size 2^( 3) =       0.000402019894
  error estimate for blocks of size 2^( 4) =       0.000409423580
  error estimate for blocks of size 2^( 5) =       0.000413413834
  error estimate for blocks of size 2^( 6) =       0.000416280933
  error estimate for blocks of size 2^( 7) =       0.000417220574

      target function =                  N/A
              le_mean =     -17.213374149110
             les_mean =     296.602754785527
             stat err =       0.000414084730
             autocorr =       1.188091432226
              std dev =       0.537253534538
             le_variance =       0.288641360373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289648189248
                                         uncertainty =       0.001650626142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289648189248
                                         uncertainty =       0.001650626142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380492665
  error estimate for blocks of size 2^( 2) =       0.000392226522
  error estimate for blocks of size 2^( 3) =       0.000402574903
  error estimate for blocks of size 2^( 4) =       0.000409978613
  error estimate for blocks of size 2^( 5) =       0.000413972296
  error estimate for blocks of size 2^( 6) =       0.000416809881
  error estimate for blocks of size 2^( 7) =       0.000417740834

      target function =                  N/A
              le_mean =     -17.213383019877
             les_mean =     296.624893153678
             stat err =       0.000414625406
             autocorr =       1.187460688592
              std dev =       0.538097887484
             le_variance =       0.289549336514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289442820751
                                         uncertainty =       0.001643692294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289442820751
                                         uncertainty =       0.001643692294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380357736
  error estimate for blocks of size 2^( 2) =       0.000392094562
  error estimate for blocks of size 2^( 3) =       0.000402446941
  error estimate for blocks of size 2^( 4) =       0.000409853206
  error estimate for blocks of size 2^( 5) =       0.000413843592
  error estimate for blocks of size 2^( 6) =       0.000416687111
  error estimate for blocks of size 2^( 7) =       0.000417621559

      target function =                  N/A
              le_mean =     -17.213378746164
             les_mean =     296.604992126131
             stat err =       0.000414501367
             autocorr =       1.187592446364
              std dev =       0.537907068996
             le_variance =       0.289344014876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288825927384
                                         uncertainty =       0.001634774860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288825927384
                                         uncertainty =       0.001634774860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379952199
  error estimate for blocks of size 2^( 2) =       0.000391703106
  error estimate for blocks of size 2^( 3) =       0.000402069616
  error estimate for blocks of size 2^( 4) =       0.000409474186
  error estimate for blocks of size 2^( 5) =       0.000413468336
  error estimate for blocks of size 2^( 6) =       0.000416334046
  error estimate for blocks of size 2^( 7) =       0.000417273766

      target function =                  N/A
              le_mean =     -17.213372724895
             les_mean =     296.602716586216
             stat err =       0.000414137584
             autocorr =       1.188040825494
              std dev =       0.537333553246
             le_variance =       0.288727347444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213374149110        initial
     2.3842e-01     2.3842e+00             7.5517e-04       -17.213383019877  <--
     9.5367e-01     9.5367e+00             3.0762e-04       -17.213378746164
     3.8147e+00     3.8147e+01             9.1149e-05       -17.213372724895

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3038e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.521703e-02 3 1  ON 0
ci_002                -3.404150e-02 3 1  ON 1
ci_003                -2.747784e-02 3 1  ON 2
ci_004                 2.385572e-02 3 1  ON 3
ci_005                 2.435059e-02 3 1  ON 4
ci_006                -2.243638e-02 3 1  ON 5
ci_007                -2.282619e-02 3 1  ON 6
ci_008                -2.018757e-02 3 1  ON 7
ci_009                -1.951294e-02 3 1  ON 8
ci_010                -1.875307e-02 3 1  ON 9
ci_011                -1.734278e-02 3 1  ON 10
ci_012                -1.760463e-02 3 1  ON 11
ci_013                -2.000355e-02 3 1  ON 12
ci_014                 1.601655e-02 3 1  ON 13
ci_015                 1.613323e-02 3 1  ON 14
ci_016                 1.693376e-02 3 1  ON 15
ci_017                 1.750260e-02 3 1  ON 16
ci_018                 1.560678e-02 3 1  ON 17
ci_019                 1.560748e-02 3 1  ON 18
ci_020                 1.498670e-02 3 1  ON 19
ci_021                 1.612467e-02 3 1  ON 20
ci_022                 1.368960e-02 3 1  ON 21
ci_023                 1.432531e-02 3 1  ON 22
ci_024                 1.289915e-02 3 1  ON 23
ci_025                 1.235900e-02 3 1  ON 24
ci_026                 1.364602e-02 3 1  ON 25
ci_027                 1.400223e-02 3 1  ON 26
ci_028                -1.480114e-02 3 1  ON 27
ci_029                -1.476025e-02 3 1  ON 28
ci_030                -1.214216e-02 3 1  ON 29
ci_031                -1.162077e-02 3 1  ON 30
ci_032                -1.414327e-02 3 1  ON 31
ci_033                 1.114514e-02 3 1  ON 32
ci_034                 1.060931e-02 3 1  ON 33
ci_035                -6.960073e-03 3 1  ON 34
ci_036                -1.255520e-02 3 1  ON 35
ci_037                -1.217106e-02 3 1  ON 36
ci_038                 3.027883e-03 3 1  ON 37
ci_039                 2.973184e-03 3 1  ON 38
ci_040                -6.137109e-03 3 1  ON 39
ci_041                 1.036642e-02 3 1  ON 40
ci_042                 1.037469e-02 3 1  ON 41
ci_043                -5.269706e-03 3 1  ON 42
ci_044                -1.562658e-02 3 1  ON 43
ci_045                -3.645138e-03 3 1  ON 44
ci_046                 7.091873e-03 3 1  ON 45
ci_047                 6.987004e-03 3 1  ON 46
ci_048                -1.217243e-02 3 1  ON 47
ci_049                -1.195667e-02 3 1  ON 48
ci_050                 8.607373e-03 3 1  ON 49
ci_051                 8.430624e-03 3 1  ON 50
ci_052                -8.045880e-03 3 1  ON 51
ci_053                -7.528728e-03 3 1  ON 52
ci_054                -3.167966e-03 3 1  ON 53
ci_055                -3.802978e-03 3 1  ON 54
ci_056                 6.430391e-03 3 1  ON 55
ci_057                 6.753322e-03 3 1  ON 56
ci_058                -8.438819e-03 3 1  ON 57
ci_059                -8.733145e-03 3 1  ON 58
ci_060                 9.086693e-03 3 1  ON 59
ci_061                 8.890503e-03 3 1  ON 60
ci_062                -4.073702e-03 3 1  ON 61
ci_063                -4.063677e-03 3 1  ON 62
ci_064                -4.376416e-03 3 1  ON 63
ci_065                -5.163626e-03 3 1  ON 64
ci_066                 6.060028e-03 3 1  ON 65
ci_067                 6.342414e-03 3 1  ON 66
ci_068                -5.462546e-03 3 1  ON 67
ci_069                -5.634330e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2594
    reference variance = 0.166802
====================================================
  Execution time = 1.4184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0263e-01
  Total weights = 1.956145481e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.0447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291201827766
                                         uncertainty =       0.002072316320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291201827766
                                         uncertainty =       0.002072316320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381566701
  error estimate for blocks of size 2^( 2) =       0.000393416493
  error estimate for blocks of size 2^( 3) =       0.000403757453
  error estimate for blocks of size 2^( 4) =       0.000411485338
  error estimate for blocks of size 2^( 5) =       0.000417450642
  error estimate for blocks of size 2^( 6) =       0.000420596974
  error estimate for blocks of size 2^( 7) =       0.000421827995

      target function =                  N/A
              le_mean =     -17.213841093076
             les_mean =     296.618957956226
             stat err =       0.000417840237
             autocorr =       1.199166770630
              std dev =       0.539616802969
             le_variance =       0.291186294046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721384109308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213841093043       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213856146222       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213854626675       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213854794346       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213854908247       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.246393e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213841093043       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213850668533       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213849975781       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213849984087       residual = 6.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 7.106203e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213841093043       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213844992557       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213844882685       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.664254e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8971e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.450641e-02 3 1  ON 0
ci_002                -3.404157e-02 3 1  ON 1
ci_003                -2.696251e-02 3 1  ON 2
ci_004                 2.427589e-02 3 1  ON 3
ci_005                 2.441945e-02 3 1  ON 4
ci_006                -2.272121e-02 3 1  ON 5
ci_007                -2.273434e-02 3 1  ON 6
ci_008                -2.004603e-02 3 1  ON 7
ci_009                -1.975991e-02 3 1  ON 8
ci_010                -1.857097e-02 3 1  ON 9
ci_011                -1.782997e-02 3 1  ON 10
ci_012                -1.783352e-02 3 1  ON 11
ci_013                -2.060970e-02 3 1  ON 12
ci_014                 1.629420e-02 3 1  ON 13
ci_015                 1.638626e-02 3 1  ON 14
ci_016                 1.707962e-02 3 1  ON 15
ci_017                 1.754762e-02 3 1  ON 16
ci_018                 1.542939e-02 3 1  ON 17
ci_019                 1.590248e-02 3 1  ON 18
ci_020                 1.471968e-02 3 1  ON 19
ci_021                 1.593364e-02 3 1  ON 20
ci_022                 1.364729e-02 3 1  ON 21
ci_023                 1.417203e-02 3 1  ON 22
ci_024                 1.257772e-02 3 1  ON 23
ci_025                 1.241383e-02 3 1  ON 24
ci_026                 1.351392e-02 3 1  ON 25
ci_027                 1.406612e-02 3 1  ON 26
ci_028                -1.478388e-02 3 1  ON 27
ci_029                -1.520194e-02 3 1  ON 28
ci_030                -1.233209e-02 3 1  ON 29
ci_031                -1.122581e-02 3 1  ON 30
ci_032                -1.391461e-02 3 1  ON 31
ci_033                 1.109113e-02 3 1  ON 32
ci_034                 1.085674e-02 3 1  ON 33
ci_035                -7.251366e-03 3 1  ON 34
ci_036                -1.213355e-02 3 1  ON 35
ci_037                -1.235000e-02 3 1  ON 36
ci_038                 2.917729e-03 3 1  ON 37
ci_039                 2.808116e-03 3 1  ON 38
ci_040                -5.968404e-03 3 1  ON 39
ci_041                 1.018038e-02 3 1  ON 40
ci_042                 1.059252e-02 3 1  ON 41
ci_043                -4.984897e-03 3 1  ON 42
ci_044                -1.575041e-02 3 1  ON 43
ci_045                -3.517908e-03 3 1  ON 44
ci_046                 6.849057e-03 3 1  ON 45
ci_047                 6.945821e-03 3 1  ON 46
ci_048                -1.185620e-02 3 1  ON 47
ci_049                -1.230992e-02 3 1  ON 48
ci_050                 8.300603e-03 3 1  ON 49
ci_051                 8.690279e-03 3 1  ON 50
ci_052                -8.455342e-03 3 1  ON 51
ci_053                -7.365135e-03 3 1  ON 52
ci_054                -3.582917e-03 3 1  ON 53
ci_055                -3.795666e-03 3 1  ON 54
ci_056                 5.828829e-03 3 1  ON 55
ci_057                 6.365416e-03 3 1  ON 56
ci_058                -8.366529e-03 3 1  ON 57
ci_059                -8.838479e-03 3 1  ON 58
ci_060                 9.421409e-03 3 1  ON 59
ci_061                 8.363764e-03 3 1  ON 60
ci_062                -4.383021e-03 3 1  ON 61
ci_063                -3.857835e-03 3 1  ON 62
ci_064                -4.249907e-03 3 1  ON 63
ci_065                -5.219261e-03 3 1  ON 64
ci_066                 6.381127e-03 3 1  ON 65
ci_067                 6.162530e-03 3 1  ON 66
ci_068                -5.477739e-03 3 1  ON 67
ci_069                -5.478645e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2685
    reference variance = 0.324309
====================================================
  Execution time = 1.3925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0637e-01
  Total weights = 1.9562e+06
  Execution time = 1.8480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291159164886
                                         uncertainty =       0.001852464727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291159164886
                                         uncertainty =       0.001852464727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381546317
  error estimate for blocks of size 2^( 2) =       0.000393097924
  error estimate for blocks of size 2^( 3) =       0.000403756739
  error estimate for blocks of size 2^( 4) =       0.000412128162
  error estimate for blocks of size 2^( 5) =       0.000415381265
  error estimate for blocks of size 2^( 6) =       0.000418808649
  error estimate for blocks of size 2^( 7) =       0.000420307971

      target function =                  N/A
              le_mean =     -17.214175412234
             les_mean =     296.643126235722
             stat err =       0.000416656512
             autocorr =       1.192509412948
              std dev =       0.539587976108
             le_variance =       0.291155183961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291494558908
                                         uncertainty =       0.001851189594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291494558908
                                         uncertainty =       0.001851189594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381761926
  error estimate for blocks of size 2^( 2) =       0.000393344445
  error estimate for blocks of size 2^( 3) =       0.000404013543
  error estimate for blocks of size 2^( 4) =       0.000412401045
  error estimate for blocks of size 2^( 5) =       0.000415667170
  error estimate for blocks of size 2^( 6) =       0.000419066543
  error estimate for blocks of size 2^( 7) =       0.000420529339

      target function =                  N/A
              le_mean =     -17.214182714085
             les_mean =     296.636893317325
             stat err =       0.000416916024
             autocorr =       1.192647079731
              std dev =       0.539892893589
             le_variance =       0.291484336548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292818648269
                                         uncertainty =       0.002194041835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292818648269
                                         uncertainty =       0.002194041835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382623510
  error estimate for blocks of size 2^( 2) =       0.000394202791
  error estimate for blocks of size 2^( 3) =       0.000404858850
  error estimate for blocks of size 2^( 4) =       0.000413226791
  error estimate for blocks of size 2^( 5) =       0.000416467898
  error estimate for blocks of size 2^( 6) =       0.000419824726
  error estimate for blocks of size 2^( 7) =       0.000421377365

      target function =                  N/A
              le_mean =     -17.214216214571
             les_mean =     296.891842668349
             stat err =       0.000417724195
             autocorr =       1.191889402291
              std dev =       0.541111357464
             le_variance =       0.292801501177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291180389405
                                         uncertainty =       0.001850780302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291180389405
                                         uncertainty =       0.001850780302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381559008
  error estimate for blocks of size 2^( 2) =       0.000393121185
  error estimate for blocks of size 2^( 3) =       0.000403781874
  error estimate for blocks of size 2^( 4) =       0.000412158998
  error estimate for blocks of size 2^( 5) =       0.000415417719
  error estimate for blocks of size 2^( 6) =       0.000418837178
  error estimate for blocks of size 2^( 7) =       0.000420314348

      target function =                  N/A
              le_mean =     -17.214167772669
             les_mean =     296.637472812832
             stat err =       0.000416682061
             autocorr =       1.192576330101
              std dev =       0.539605923783
             le_variance =       0.291174552981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214175412234        initial
     5.9605e-02     5.9605e-01             1.2464e-03       -17.214182714085
     2.3842e-01     2.3842e+00             7.1062e-04       -17.214216214571  <--
     9.5367e-01     9.5367e+00             2.6643e-04       -17.214167772669

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3163e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.450641e-02 3 1  ON 0
ci_002                -3.404157e-02 3 1  ON 1
ci_003                -2.696251e-02 3 1  ON 2
ci_004                 2.427589e-02 3 1  ON 3
ci_005                 2.441945e-02 3 1  ON 4
ci_006                -2.272121e-02 3 1  ON 5
ci_007                -2.273434e-02 3 1  ON 6
ci_008                -2.004603e-02 3 1  ON 7
ci_009                -1.975991e-02 3 1  ON 8
ci_010                -1.857097e-02 3 1  ON 9
ci_011                -1.782997e-02 3 1  ON 10
ci_012                -1.783352e-02 3 1  ON 11
ci_013                -2.060970e-02 3 1  ON 12
ci_014                 1.629420e-02 3 1  ON 13
ci_015                 1.638626e-02 3 1  ON 14
ci_016                 1.707962e-02 3 1  ON 15
ci_017                 1.754762e-02 3 1  ON 16
ci_018                 1.542939e-02 3 1  ON 17
ci_019                 1.590248e-02 3 1  ON 18
ci_020                 1.471968e-02 3 1  ON 19
ci_021                 1.593364e-02 3 1  ON 20
ci_022                 1.364729e-02 3 1  ON 21
ci_023                 1.417203e-02 3 1  ON 22
ci_024                 1.257772e-02 3 1  ON 23
ci_025                 1.241383e-02 3 1  ON 24
ci_026                 1.351392e-02 3 1  ON 25
ci_027                 1.406612e-02 3 1  ON 26
ci_028                -1.478388e-02 3 1  ON 27
ci_029                -1.520194e-02 3 1  ON 28
ci_030                -1.233209e-02 3 1  ON 29
ci_031                -1.122581e-02 3 1  ON 30
ci_032                -1.391461e-02 3 1  ON 31
ci_033                 1.109113e-02 3 1  ON 32
ci_034                 1.085674e-02 3 1  ON 33
ci_035                -7.251366e-03 3 1  ON 34
ci_036                -1.213355e-02 3 1  ON 35
ci_037                -1.235000e-02 3 1  ON 36
ci_038                 2.917729e-03 3 1  ON 37
ci_039                 2.808116e-03 3 1  ON 38
ci_040                -5.968404e-03 3 1  ON 39
ci_041                 1.018038e-02 3 1  ON 40
ci_042                 1.059252e-02 3 1  ON 41
ci_043                -4.984897e-03 3 1  ON 42
ci_044                -1.575041e-02 3 1  ON 43
ci_045                -3.517908e-03 3 1  ON 44
ci_046                 6.849057e-03 3 1  ON 45
ci_047                 6.945821e-03 3 1  ON 46
ci_048                -1.185620e-02 3 1  ON 47
ci_049                -1.230992e-02 3 1  ON 48
ci_050                 8.300603e-03 3 1  ON 49
ci_051                 8.690279e-03 3 1  ON 50
ci_052                -8.455342e-03 3 1  ON 51
ci_053                -7.365135e-03 3 1  ON 52
ci_054                -3.582917e-03 3 1  ON 53
ci_055                -3.795666e-03 3 1  ON 54
ci_056                 5.828829e-03 3 1  ON 55
ci_057                 6.365416e-03 3 1  ON 56
ci_058                -8.366529e-03 3 1  ON 57
ci_059                -8.838479e-03 3 1  ON 58
ci_060                 9.421409e-03 3 1  ON 59
ci_061                 8.363764e-03 3 1  ON 60
ci_062                -4.383021e-03 3 1  ON 61
ci_063                -3.857835e-03 3 1  ON 62
ci_064                -4.249907e-03 3 1  ON 63
ci_065                -5.219261e-03 3 1  ON 64
ci_066                 6.381127e-03 3 1  ON 65
ci_067                 6.162530e-03 3 1  ON 66
ci_068                -5.477739e-03 3 1  ON 67
ci_069                -5.478645e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0997
    reference variance = 0.281844
====================================================
  Execution time = 1.4213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0759e-01
  Total weights = 1.955787744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294621249281
                                         uncertainty =       0.002463173716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294621249281
                                         uncertainty =       0.002463173716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383789322
  error estimate for blocks of size 2^( 2) =       0.000395917879
  error estimate for blocks of size 2^( 3) =       0.000405924711
  error estimate for blocks of size 2^( 4) =       0.000413372770
  error estimate for blocks of size 2^( 5) =       0.000417924814
  error estimate for blocks of size 2^( 6) =       0.000419503589
  error estimate for blocks of size 2^( 7) =       0.000420363931

      target function =                  N/A
              le_mean =     -17.213331944843
             les_mean =     296.606382804842
             stat err =       0.000417791276
             autocorr =       1.185039863894
              std dev =       0.542760063920
             le_variance =       0.294588486987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721333194484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213331944857       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213337633697       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213337152761       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213338244547       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213338218494       residual = 4.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.194747e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213331944857       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213335578816       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213335358779       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213335647812       residual = 9.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 6.951133e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213331944857       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213333431229       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213333397347       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.612102e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6693e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.474967e-02 3 1  ON 0
ci_002                -3.378309e-02 3 1  ON 1
ci_003                -2.685745e-02 3 1  ON 2
ci_004                 2.407483e-02 3 1  ON 3
ci_005                 2.422922e-02 3 1  ON 4
ci_006                -2.247555e-02 3 1  ON 5
ci_007                -2.282039e-02 3 1  ON 6
ci_008                -2.037541e-02 3 1  ON 7
ci_009                -1.989592e-02 3 1  ON 8
ci_010                -1.804575e-02 3 1  ON 9
ci_011                -1.796912e-02 3 1  ON 10
ci_012                -1.808069e-02 3 1  ON 11
ci_013                -2.084980e-02 3 1  ON 12
ci_014                 1.619760e-02 3 1  ON 13
ci_015                 1.627387e-02 3 1  ON 14
ci_016                 1.722273e-02 3 1  ON 15
ci_017                 1.745804e-02 3 1  ON 16
ci_018                 1.549175e-02 3 1  ON 17
ci_019                 1.544665e-02 3 1  ON 18
ci_020                 1.541479e-02 3 1  ON 19
ci_021                 1.603430e-02 3 1  ON 20
ci_022                 1.346508e-02 3 1  ON 21
ci_023                 1.445200e-02 3 1  ON 22
ci_024                 1.214508e-02 3 1  ON 23
ci_025                 1.244280e-02 3 1  ON 24
ci_026                 1.409401e-02 3 1  ON 25
ci_027                 1.438935e-02 3 1  ON 26
ci_028                -1.496881e-02 3 1  ON 27
ci_029                -1.532616e-02 3 1  ON 28
ci_030                -1.220413e-02 3 1  ON 29
ci_031                -1.152656e-02 3 1  ON 30
ci_032                -1.431807e-02 3 1  ON 31
ci_033                 1.092974e-02 3 1  ON 32
ci_034                 1.108719e-02 3 1  ON 33
ci_035                -7.218016e-03 3 1  ON 34
ci_036                -1.193826e-02 3 1  ON 35
ci_037                -1.272004e-02 3 1  ON 36
ci_038                 2.850904e-03 3 1  ON 37
ci_039                 2.894411e-03 3 1  ON 38
ci_040                -5.958130e-03 3 1  ON 39
ci_041                 1.017382e-02 3 1  ON 40
ci_042                 1.062879e-02 3 1  ON 41
ci_043                -5.086941e-03 3 1  ON 42
ci_044                -1.577741e-02 3 1  ON 43
ci_045                -3.707143e-03 3 1  ON 44
ci_046                 6.942740e-03 3 1  ON 45
ci_047                 7.045478e-03 3 1  ON 46
ci_048                -1.151305e-02 3 1  ON 47
ci_049                -1.181945e-02 3 1  ON 48
ci_050                 8.548155e-03 3 1  ON 49
ci_051                 8.864227e-03 3 1  ON 50
ci_052                -8.039300e-03 3 1  ON 51
ci_053                -7.946737e-03 3 1  ON 52
ci_054                -3.517585e-03 3 1  ON 53
ci_055                -3.847138e-03 3 1  ON 54
ci_056                 6.125459e-03 3 1  ON 55
ci_057                 6.009489e-03 3 1  ON 56
ci_058                -8.249114e-03 3 1  ON 57
ci_059                -8.352420e-03 3 1  ON 58
ci_060                 9.115982e-03 3 1  ON 59
ci_061                 8.383428e-03 3 1  ON 60
ci_062                -4.165661e-03 3 1  ON 61
ci_063                -4.241885e-03 3 1  ON 62
ci_064                -4.299415e-03 3 1  ON 63
ci_065                -4.994479e-03 3 1  ON 64
ci_066                 5.928028e-03 3 1  ON 65
ci_067                 6.111689e-03 3 1  ON 66
ci_068                -5.748734e-03 3 1  ON 67
ci_069                -5.093584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1784
    reference variance = 0.295308
====================================================
  Execution time = 1.3922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0844e-01
  Total weights = 1.9559e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00019351
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295231068907
                                         uncertainty =       0.002594286630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295231068907
                                         uncertainty =       0.002594286630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384186027
  error estimate for blocks of size 2^( 2) =       0.000396351720
  error estimate for blocks of size 2^( 3) =       0.000407113271
  error estimate for blocks of size 2^( 4) =       0.000415071421
  error estimate for blocks of size 2^( 5) =       0.000420312671
  error estimate for blocks of size 2^( 6) =       0.000422649985
  error estimate for blocks of size 2^( 7) =       0.000424040096

      target function =                  N/A
              le_mean =     -17.214637740888
             les_mean =     296.670399850192
             stat err =       0.000420518543
             autocorr =       1.198083734037
              std dev =       0.543321089701
             le_variance =       0.295197806514

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.166289
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295547888509
                                         uncertainty =       0.002622496205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295547888509
                                         uncertainty =       0.002622496205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384392828
  error estimate for blocks of size 2^( 2) =       0.000396573598
  error estimate for blocks of size 2^( 3) =       0.000407339678
  error estimate for blocks of size 2^( 4) =       0.000415323816
  error estimate for blocks of size 2^( 5) =       0.000420599359
  error estimate for blocks of size 2^( 6) =       0.000422936930
  error estimate for blocks of size 2^( 7) =       0.000424309563

      target function =                  N/A
              le_mean =     -17.214630716308
             les_mean =     296.656401464922
             stat err =       0.000420792417
             autocorr =       1.198354355658
              std dev =       0.543613550139
             le_variance =       0.295515691895

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000193922
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295773171879
                                         uncertainty =       0.002629515232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295773171879
                                         uncertainty =       0.002629515232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384539417
  error estimate for blocks of size 2^( 2) =       0.000396721245
  error estimate for blocks of size 2^( 3) =       0.000407479570
  error estimate for blocks of size 2^( 4) =       0.000415463297
  error estimate for blocks of size 2^( 5) =       0.000420743256
  error estimate for blocks of size 2^( 6) =       0.000423077247
  error estimate for blocks of size 2^( 7) =       0.000424458329

      target function =                  N/A
              le_mean =     -17.214642310159
             les_mean =     296.656788818039
             stat err =       0.000420935532
             autocorr =       1.198255543271
              std dev =       0.543820859198
             le_variance =       0.295741126899

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00118742
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295246357542
                                         uncertainty =       0.002598527942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295246357542
                                         uncertainty =       0.002598527942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384196205
  error estimate for blocks of size 2^( 2) =       0.000396364893
  error estimate for blocks of size 2^( 3) =       0.000407134088
  error estimate for blocks of size 2^( 4) =       0.000415101146
  error estimate for blocks of size 2^( 5) =       0.000420350937
  error estimate for blocks of size 2^( 6) =       0.000422702945
  error estimate for blocks of size 2^( 7) =       0.000424082354

      target function =                  N/A
              le_mean =     -17.214627151156
             les_mean =     296.658249028014
             stat err =       0.000420559345
             autocorr =       1.198252752709
              std dev =       0.543335483380
             le_variance =       0.295213447499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214637740888        initial
     5.9605e-02     5.9605e-01             1.1947e-03       -17.214630716308
     2.3842e-01     2.3842e+00             6.9511e-04       -17.214642310159  <--
     9.5367e-01     9.5367e+00             2.6121e-04       -17.214627151156

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3154e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.474967e-02 3 1  ON 0
ci_002                -3.378309e-02 3 1  ON 1
ci_003                -2.685745e-02 3 1  ON 2
ci_004                 2.407483e-02 3 1  ON 3
ci_005                 2.422922e-02 3 1  ON 4
ci_006                -2.247555e-02 3 1  ON 5
ci_007                -2.282039e-02 3 1  ON 6
ci_008                -2.037541e-02 3 1  ON 7
ci_009                -1.989592e-02 3 1  ON 8
ci_010                -1.804575e-02 3 1  ON 9
ci_011                -1.796912e-02 3 1  ON 10
ci_012                -1.808069e-02 3 1  ON 11
ci_013                -2.084980e-02 3 1  ON 12
ci_014                 1.619760e-02 3 1  ON 13
ci_015                 1.627387e-02 3 1  ON 14
ci_016                 1.722273e-02 3 1  ON 15
ci_017                 1.745804e-02 3 1  ON 16
ci_018                 1.549175e-02 3 1  ON 17
ci_019                 1.544665e-02 3 1  ON 18
ci_020                 1.541479e-02 3 1  ON 19
ci_021                 1.603430e-02 3 1  ON 20
ci_022                 1.346508e-02 3 1  ON 21
ci_023                 1.445200e-02 3 1  ON 22
ci_024                 1.214508e-02 3 1  ON 23
ci_025                 1.244280e-02 3 1  ON 24
ci_026                 1.409401e-02 3 1  ON 25
ci_027                 1.438935e-02 3 1  ON 26
ci_028                -1.496881e-02 3 1  ON 27
ci_029                -1.532616e-02 3 1  ON 28
ci_030                -1.220413e-02 3 1  ON 29
ci_031                -1.152656e-02 3 1  ON 30
ci_032                -1.431807e-02 3 1  ON 31
ci_033                 1.092974e-02 3 1  ON 32
ci_034                 1.108719e-02 3 1  ON 33
ci_035                -7.218016e-03 3 1  ON 34
ci_036                -1.193826e-02 3 1  ON 35
ci_037                -1.272004e-02 3 1  ON 36
ci_038                 2.850904e-03 3 1  ON 37
ci_039                 2.894411e-03 3 1  ON 38
ci_040                -5.958130e-03 3 1  ON 39
ci_041                 1.017382e-02 3 1  ON 40
ci_042                 1.062879e-02 3 1  ON 41
ci_043                -5.086941e-03 3 1  ON 42
ci_044                -1.577741e-02 3 1  ON 43
ci_045                -3.707143e-03 3 1  ON 44
ci_046                 6.942740e-03 3 1  ON 45
ci_047                 7.045478e-03 3 1  ON 46
ci_048                -1.151305e-02 3 1  ON 47
ci_049                -1.181945e-02 3 1  ON 48
ci_050                 8.548155e-03 3 1  ON 49
ci_051                 8.864227e-03 3 1  ON 50
ci_052                -8.039300e-03 3 1  ON 51
ci_053                -7.946737e-03 3 1  ON 52
ci_054                -3.517585e-03 3 1  ON 53
ci_055                -3.847138e-03 3 1  ON 54
ci_056                 6.125459e-03 3 1  ON 55
ci_057                 6.009489e-03 3 1  ON 56
ci_058                -8.249114e-03 3 1  ON 57
ci_059                -8.352420e-03 3 1  ON 58
ci_060                 9.115982e-03 3 1  ON 59
ci_061                 8.383428e-03 3 1  ON 60
ci_062                -4.165661e-03 3 1  ON 61
ci_063                -4.241885e-03 3 1  ON 62
ci_064                -4.299415e-03 3 1  ON 63
ci_065                -4.994479e-03 3 1  ON 64
ci_066                 5.928028e-03 3 1  ON 65
ci_067                 6.111689e-03 3 1  ON 66
ci_068                -5.748734e-03 3 1  ON 67
ci_069                -5.093584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9862e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1556
    reference variance = 0.249306
====================================================
  Execution time = 1.4217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0310e-01
  Total weights = 1.956083143e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291713370882
                                         uncertainty =       0.002092970912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291713370882
                                         uncertainty =       0.002092970912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381918041
  error estimate for blocks of size 2^( 2) =       0.000393664097
  error estimate for blocks of size 2^( 3) =       0.000403886999
  error estimate for blocks of size 2^( 4) =       0.000411298183
  error estimate for blocks of size 2^( 5) =       0.000415287717
  error estimate for blocks of size 2^( 6) =       0.000418754303
  error estimate for blocks of size 2^( 7) =       0.000419337148

      target function =                  N/A
              le_mean =     -17.214285686564
             les_mean =     296.634727126588
             stat err =       0.000416169338
             autocorr =       1.187407562782
              std dev =       0.540113673096
             le_variance =       0.291722779865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721428568656e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214285686603       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214298117295       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214298130410       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214298855260       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214298713614       residual = 4.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.003116e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214285686603       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214293456592       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214293278016       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214293479574       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 5.905661e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214285686603       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214288794918       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214288671410       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214288701869       residual = 1.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.242701e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6698e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.489865e-02 3 1  ON 0
ci_002                -3.427217e-02 3 1  ON 1
ci_003                -2.690159e-02 3 1  ON 2
ci_004                 2.451212e-02 3 1  ON 3
ci_005                 2.409279e-02 3 1  ON 4
ci_006                -2.306611e-02 3 1  ON 5
ci_007                -2.307980e-02 3 1  ON 6
ci_008                -2.030171e-02 3 1  ON 7
ci_009                -1.986926e-02 3 1  ON 8
ci_010                -1.808187e-02 3 1  ON 9
ci_011                -1.801517e-02 3 1  ON 10
ci_012                -1.807326e-02 3 1  ON 11
ci_013                -2.071911e-02 3 1  ON 12
ci_014                 1.565393e-02 3 1  ON 13
ci_015                 1.597068e-02 3 1  ON 14
ci_016                 1.710160e-02 3 1  ON 15
ci_017                 1.732863e-02 3 1  ON 16
ci_018                 1.541453e-02 3 1  ON 17
ci_019                 1.563585e-02 3 1  ON 18
ci_020                 1.583329e-02 3 1  ON 19
ci_021                 1.587137e-02 3 1  ON 20
ci_022                 1.357058e-02 3 1  ON 21
ci_023                 1.396745e-02 3 1  ON 22
ci_024                 1.254663e-02 3 1  ON 23
ci_025                 1.275549e-02 3 1  ON 24
ci_026                 1.401329e-02 3 1  ON 25
ci_027                 1.439812e-02 3 1  ON 26
ci_028                -1.483243e-02 3 1  ON 27
ci_029                -1.533973e-02 3 1  ON 28
ci_030                -1.229064e-02 3 1  ON 29
ci_031                -1.181018e-02 3 1  ON 30
ci_032                -1.442926e-02 3 1  ON 31
ci_033                 1.087376e-02 3 1  ON 32
ci_034                 1.111362e-02 3 1  ON 33
ci_035                -7.065385e-03 3 1  ON 34
ci_036                -1.198587e-02 3 1  ON 35
ci_037                -1.269539e-02 3 1  ON 36
ci_038                 2.842811e-03 3 1  ON 37
ci_039                 2.890870e-03 3 1  ON 38
ci_040                -5.793954e-03 3 1  ON 39
ci_041                 1.040868e-02 3 1  ON 40
ci_042                 1.083532e-02 3 1  ON 41
ci_043                -4.969564e-03 3 1  ON 42
ci_044                -1.589984e-02 3 1  ON 43
ci_045                -3.732419e-03 3 1  ON 44
ci_046                 6.964881e-03 3 1  ON 45
ci_047                 6.696202e-03 3 1  ON 46
ci_048                -1.203501e-02 3 1  ON 47
ci_049                -1.186429e-02 3 1  ON 48
ci_050                 8.552312e-03 3 1  ON 49
ci_051                 8.532755e-03 3 1  ON 50
ci_052                -7.964721e-03 3 1  ON 51
ci_053                -7.844011e-03 3 1  ON 52
ci_054                -3.453465e-03 3 1  ON 53
ci_055                -3.747130e-03 3 1  ON 54
ci_056                 6.267248e-03 3 1  ON 55
ci_057                 5.961244e-03 3 1  ON 56
ci_058                -8.189609e-03 3 1  ON 57
ci_059                -8.352523e-03 3 1  ON 58
ci_060                 9.046372e-03 3 1  ON 59
ci_061                 7.941052e-03 3 1  ON 60
ci_062                -4.089086e-03 3 1  ON 61
ci_063                -4.293021e-03 3 1  ON 62
ci_064                -4.418055e-03 3 1  ON 63
ci_065                -4.908489e-03 3 1  ON 64
ci_066                 6.258944e-03 3 1  ON 65
ci_067                 6.340823e-03 3 1  ON 66
ci_068                -5.840363e-03 3 1  ON 67
ci_069                -5.242436e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.148009
====================================================
  Execution time = 1.3801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0998e-01
  Total weights = 1.9558e+06
  Execution time = 1.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294599776628
                                         uncertainty =       0.002780120528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294599776628
                                         uncertainty =       0.002780120528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383761749
  error estimate for blocks of size 2^( 2) =       0.000395922392
  error estimate for blocks of size 2^( 3) =       0.000406712287
  error estimate for blocks of size 2^( 4) =       0.000413800530
  error estimate for blocks of size 2^( 5) =       0.000418370250
  error estimate for blocks of size 2^( 6) =       0.000420455308
  error estimate for blocks of size 2^( 7) =       0.000420410113

      target function =                  N/A
              le_mean =     -17.214232705653
             les_mean =     296.642648640812
             stat err =       0.000418259050
             autocorr =       1.187865650389
              std dev =       0.542721070371
             le_variance =       0.294546160225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294006504737
                                         uncertainty =       0.002603463111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294006504737
                                         uncertainty =       0.002603463111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383375466
  error estimate for blocks of size 2^( 2) =       0.000395539441
  error estimate for blocks of size 2^( 3) =       0.000406327414
  error estimate for blocks of size 2^( 4) =       0.000413412496
  error estimate for blocks of size 2^( 5) =       0.000417972855
  error estimate for blocks of size 2^( 6) =       0.000420057425
  error estimate for blocks of size 2^( 7) =       0.000420058562

      target function =                  N/A
              le_mean =     -17.214236914409
             les_mean =     296.639731422898
             stat err =       0.000417875335
             autocorr =       1.188077694074
              std dev =       0.542174782947
             le_variance =       0.293953495264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293922763238
                                         uncertainty =       0.002580728866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293922763238
                                         uncertainty =       0.002580728866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383320912
  error estimate for blocks of size 2^( 2) =       0.000395485933
  error estimate for blocks of size 2^( 3) =       0.000406273868
  error estimate for blocks of size 2^( 4) =       0.000413358749
  error estimate for blocks of size 2^( 5) =       0.000417916054
  error estimate for blocks of size 2^( 6) =       0.000419993723
  error estimate for blocks of size 2^( 7) =       0.000420020349

      target function =                  N/A
              le_mean =     -17.214243739870
             les_mean =     296.647230933705
             stat err =       0.000417822219
             autocorr =       1.188113791153
              std dev =       0.542097632267
             le_variance =       0.293869842910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294421414390
                                         uncertainty =       0.002739298340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294421414390
                                         uncertainty =       0.002739298340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383645631
  error estimate for blocks of size 2^( 2) =       0.000395807284
  error estimate for blocks of size 2^( 3) =       0.000406596054
  error estimate for blocks of size 2^( 4) =       0.000413682484
  error estimate for blocks of size 2^( 5) =       0.000418247862
  error estimate for blocks of size 2^( 6) =       0.000420342438
  error estimate for blocks of size 2^( 7) =       0.000420318529

      target function =                  N/A
              le_mean =     -17.214229034564
             les_mean =     296.675019218715
             stat err =       0.000418147828
             autocorr =       1.187952780586
              std dev =       0.542556853843
             le_variance =       0.294367939652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214232705653        initial
     5.9605e-02     5.9605e-01             1.0031e-03       -17.214236914409
     2.3842e-01     2.3842e+00             5.9057e-04       -17.214243739870  <--
     9.5367e-01     9.5367e+00             2.2427e-04       -17.214229034564

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3031e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.489865e-02 3 1  ON 0
ci_002                -3.427217e-02 3 1  ON 1
ci_003                -2.690159e-02 3 1  ON 2
ci_004                 2.451212e-02 3 1  ON 3
ci_005                 2.409279e-02 3 1  ON 4
ci_006                -2.306611e-02 3 1  ON 5
ci_007                -2.307980e-02 3 1  ON 6
ci_008                -2.030171e-02 3 1  ON 7
ci_009                -1.986926e-02 3 1  ON 8
ci_010                -1.808187e-02 3 1  ON 9
ci_011                -1.801517e-02 3 1  ON 10
ci_012                -1.807326e-02 3 1  ON 11
ci_013                -2.071911e-02 3 1  ON 12
ci_014                 1.565393e-02 3 1  ON 13
ci_015                 1.597068e-02 3 1  ON 14
ci_016                 1.710160e-02 3 1  ON 15
ci_017                 1.732863e-02 3 1  ON 16
ci_018                 1.541453e-02 3 1  ON 17
ci_019                 1.563585e-02 3 1  ON 18
ci_020                 1.583329e-02 3 1  ON 19
ci_021                 1.587137e-02 3 1  ON 20
ci_022                 1.357058e-02 3 1  ON 21
ci_023                 1.396745e-02 3 1  ON 22
ci_024                 1.254663e-02 3 1  ON 23
ci_025                 1.275549e-02 3 1  ON 24
ci_026                 1.401329e-02 3 1  ON 25
ci_027                 1.439812e-02 3 1  ON 26
ci_028                -1.483243e-02 3 1  ON 27
ci_029                -1.533973e-02 3 1  ON 28
ci_030                -1.229064e-02 3 1  ON 29
ci_031                -1.181018e-02 3 1  ON 30
ci_032                -1.442926e-02 3 1  ON 31
ci_033                 1.087376e-02 3 1  ON 32
ci_034                 1.111362e-02 3 1  ON 33
ci_035                -7.065385e-03 3 1  ON 34
ci_036                -1.198587e-02 3 1  ON 35
ci_037                -1.269539e-02 3 1  ON 36
ci_038                 2.842811e-03 3 1  ON 37
ci_039                 2.890870e-03 3 1  ON 38
ci_040                -5.793954e-03 3 1  ON 39
ci_041                 1.040868e-02 3 1  ON 40
ci_042                 1.083532e-02 3 1  ON 41
ci_043                -4.969564e-03 3 1  ON 42
ci_044                -1.589984e-02 3 1  ON 43
ci_045                -3.732419e-03 3 1  ON 44
ci_046                 6.964881e-03 3 1  ON 45
ci_047                 6.696202e-03 3 1  ON 46
ci_048                -1.203501e-02 3 1  ON 47
ci_049                -1.186429e-02 3 1  ON 48
ci_050                 8.552312e-03 3 1  ON 49
ci_051                 8.532755e-03 3 1  ON 50
ci_052                -7.964721e-03 3 1  ON 51
ci_053                -7.844011e-03 3 1  ON 52
ci_054                -3.453465e-03 3 1  ON 53
ci_055                -3.747130e-03 3 1  ON 54
ci_056                 6.267248e-03 3 1  ON 55
ci_057                 5.961244e-03 3 1  ON 56
ci_058                -8.189609e-03 3 1  ON 57
ci_059                -8.352523e-03 3 1  ON 58
ci_060                 9.046372e-03 3 1  ON 59
ci_061                 7.941052e-03 3 1  ON 60
ci_062                -4.089086e-03 3 1  ON 61
ci_063                -4.293021e-03 3 1  ON 62
ci_064                -4.418055e-03 3 1  ON 63
ci_065                -4.908489e-03 3 1  ON 64
ci_066                 6.258944e-03 3 1  ON 65
ci_067                 6.340823e-03 3 1  ON 66
ci_068                -5.840363e-03 3 1  ON 67
ci_069                -5.242436e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.255425
====================================================
  Execution time = 1.4085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0396e-01
  Total weights = 1.956255096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597323331
                                         uncertainty =       0.001956215970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292597323331
                                         uncertainty =       0.001956215970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382436140
  error estimate for blocks of size 2^( 2) =       0.000394068888
  error estimate for blocks of size 2^( 3) =       0.000404837887
  error estimate for blocks of size 2^( 4) =       0.000412645840
  error estimate for blocks of size 2^( 5) =       0.000417003674
  error estimate for blocks of size 2^( 6) =       0.000420163271
  error estimate for blocks of size 2^( 7) =       0.000420722697

      target function =                  N/A
              le_mean =     -17.213951835907
             les_mean =     296.624098862710
             stat err =       0.000417633871
             autocorr =       1.192541697933
              std dev =       0.540846376523
             le_variance =       0.292514802998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721395183591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213951835892       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213947387828       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213948467683       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213949274019       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213949314231       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.255960e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213951835892       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213948974309       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213949488060       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213949749158       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 7.537323e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213951835892       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213950656670       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213950760728       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.903764e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6569e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.502986e-02 3 1  ON 0
ci_002                -3.433385e-02 3 1  ON 1
ci_003                -2.645170e-02 3 1  ON 2
ci_004                 2.395649e-02 3 1  ON 3
ci_005                 2.437432e-02 3 1  ON 4
ci_006                -2.283780e-02 3 1  ON 5
ci_007                -2.300813e-02 3 1  ON 6
ci_008                -2.013435e-02 3 1  ON 7
ci_009                -1.994219e-02 3 1  ON 8
ci_010                -1.797993e-02 3 1  ON 9
ci_011                -1.816583e-02 3 1  ON 10
ci_012                -1.829007e-02 3 1  ON 11
ci_013                -2.062373e-02 3 1  ON 12
ci_014                 1.617028e-02 3 1  ON 13
ci_015                 1.580922e-02 3 1  ON 14
ci_016                 1.737931e-02 3 1  ON 15
ci_017                 1.747196e-02 3 1  ON 16
ci_018                 1.569688e-02 3 1  ON 17
ci_019                 1.577569e-02 3 1  ON 18
ci_020                 1.588933e-02 3 1  ON 19
ci_021                 1.568945e-02 3 1  ON 20
ci_022                 1.361662e-02 3 1  ON 21
ci_023                 1.392149e-02 3 1  ON 22
ci_024                 1.232840e-02 3 1  ON 23
ci_025                 1.252758e-02 3 1  ON 24
ci_026                 1.453097e-02 3 1  ON 25
ci_027                 1.398388e-02 3 1  ON 26
ci_028                -1.479735e-02 3 1  ON 27
ci_029                -1.521607e-02 3 1  ON 28
ci_030                -1.191920e-02 3 1  ON 29
ci_031                -1.189076e-02 3 1  ON 30
ci_032                -1.438151e-02 3 1  ON 31
ci_033                 1.123364e-02 3 1  ON 32
ci_034                 1.037660e-02 3 1  ON 33
ci_035                -6.748248e-03 3 1  ON 34
ci_036                -1.243887e-02 3 1  ON 35
ci_037                -1.194166e-02 3 1  ON 36
ci_038                 2.734056e-03 3 1  ON 37
ci_039                 2.953848e-03 3 1  ON 38
ci_040                -5.854360e-03 3 1  ON 39
ci_041                 1.046780e-02 3 1  ON 40
ci_042                 1.041928e-02 3 1  ON 41
ci_043                -5.086247e-03 3 1  ON 42
ci_044                -1.548418e-02 3 1  ON 43
ci_045                -3.647662e-03 3 1  ON 44
ci_046                 6.827477e-03 3 1  ON 45
ci_047                 6.936360e-03 3 1  ON 46
ci_048                -1.218698e-02 3 1  ON 47
ci_049                -1.167396e-02 3 1  ON 48
ci_050                 8.029497e-03 3 1  ON 49
ci_051                 8.902780e-03 3 1  ON 50
ci_052                -7.974397e-03 3 1  ON 51
ci_053                -8.405038e-03 3 1  ON 52
ci_054                -3.434796e-03 3 1  ON 53
ci_055                -3.469174e-03 3 1  ON 54
ci_056                 6.162634e-03 3 1  ON 55
ci_057                 5.385832e-03 3 1  ON 56
ci_058                -7.962619e-03 3 1  ON 57
ci_059                -7.939114e-03 3 1  ON 58
ci_060                 8.798337e-03 3 1  ON 59
ci_061                 8.287034e-03 3 1  ON 60
ci_062                -4.504133e-03 3 1  ON 61
ci_063                -4.237823e-03 3 1  ON 62
ci_064                -4.150451e-03 3 1  ON 63
ci_065                -5.179264e-03 3 1  ON 64
ci_066                 6.228970e-03 3 1  ON 65
ci_067                 6.362398e-03 3 1  ON 66
ci_068                -5.377687e-03 3 1  ON 67
ci_069                -5.104665e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.623938
====================================================
  Execution time = 1.3738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0959e-01
  Total weights = 1.9560e+06
  Execution time = 1.8177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294458967153
                                         uncertainty =       0.002588576034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294458967153
                                         uncertainty =       0.002588576034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383706383
  error estimate for blocks of size 2^( 2) =       0.000395480331
  error estimate for blocks of size 2^( 3) =       0.000405927751
  error estimate for blocks of size 2^( 4) =       0.000412872132
  error estimate for blocks of size 2^( 5) =       0.000416997406
  error estimate for blocks of size 2^( 6) =       0.000418461344
  error estimate for blocks of size 2^( 7) =       0.000420976142

      target function =                  N/A
              le_mean =     -17.213686372539
             les_mean =     296.634798888430
             stat err =       0.000417326756
             autocorr =       1.182917373532
              std dev =       0.542642771414
             le_variance =       0.294461177368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294168917607
                                         uncertainty =       0.002570414496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294168917607
                                         uncertainty =       0.002570414496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383518475
  error estimate for blocks of size 2^( 2) =       0.000395313867
  error estimate for blocks of size 2^( 3) =       0.000405795847
  error estimate for blocks of size 2^( 4) =       0.000412745355
  error estimate for blocks of size 2^( 5) =       0.000416894682
  error estimate for blocks of size 2^( 6) =       0.000418226908
  error estimate for blocks of size 2^( 7) =       0.000420800617

      target function =                  N/A
              le_mean =     -17.213646055271
             les_mean =     296.643716591252
             stat err =       0.000417166891
             autocorr =       1.183169824987
              std dev =       0.542377028683
             le_variance =       0.294172841243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294222705275
                                         uncertainty =       0.002558624590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294222705275
                                         uncertainty =       0.002558624590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383553834
  error estimate for blocks of size 2^( 2) =       0.000395351999
  error estimate for blocks of size 2^( 3) =       0.000405842952
  error estimate for blocks of size 2^( 4) =       0.000412789266
  error estimate for blocks of size 2^( 5) =       0.000416931904
  error estimate for blocks of size 2^( 6) =       0.000418218392
  error estimate for blocks of size 2^( 7) =       0.000420744003

      target function =                  N/A
              le_mean =     -17.213664377348
             les_mean =     296.652173500387
             stat err =       0.000417170891
             autocorr =       1.182974377484
              std dev =       0.542427033449
             le_variance =       0.294227086616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294225223116
                                         uncertainty =       0.002581423256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294225223116
                                         uncertainty =       0.002581423256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383554510
  error estimate for blocks of size 2^( 2) =       0.000395340887
  error estimate for blocks of size 2^( 3) =       0.000405798201
  error estimate for blocks of size 2^( 4) =       0.000412748994
  error estimate for blocks of size 2^( 5) =       0.000416882583
  error estimate for blocks of size 2^( 6) =       0.000418303460
  error estimate for blocks of size 2^( 7) =       0.000420856883

      target function =                  N/A
              le_mean =     -17.213666300180
             les_mean =     296.627405918618
             stat err =       0.000417197980
             autocorr =       1.183123840972
              std dev =       0.542427990235
             le_variance =       0.294228124591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213686372539        initial  <--
     5.9605e-02     5.9605e-01             1.2560e-03       -17.213646055271
     2.3842e-01     2.3842e+00             7.5373e-04       -17.213664377348
     9.5367e-01     9.5367e+00             2.9038e-04       -17.213666300180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8753
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.489865e-02 3 1  ON 0
ci_002                -3.427217e-02 3 1  ON 1
ci_003                -2.690159e-02 3 1  ON 2
ci_004                 2.451212e-02 3 1  ON 3
ci_005                 2.409279e-02 3 1  ON 4
ci_006                -2.306611e-02 3 1  ON 5
ci_007                -2.307980e-02 3 1  ON 6
ci_008                -2.030171e-02 3 1  ON 7
ci_009                -1.986926e-02 3 1  ON 8
ci_010                -1.808187e-02 3 1  ON 9
ci_011                -1.801517e-02 3 1  ON 10
ci_012                -1.807326e-02 3 1  ON 11
ci_013                -2.071911e-02 3 1  ON 12
ci_014                 1.565393e-02 3 1  ON 13
ci_015                 1.597068e-02 3 1  ON 14
ci_016                 1.710160e-02 3 1  ON 15
ci_017                 1.732863e-02 3 1  ON 16
ci_018                 1.541453e-02 3 1  ON 17
ci_019                 1.563585e-02 3 1  ON 18
ci_020                 1.583329e-02 3 1  ON 19
ci_021                 1.587137e-02 3 1  ON 20
ci_022                 1.357058e-02 3 1  ON 21
ci_023                 1.396745e-02 3 1  ON 22
ci_024                 1.254663e-02 3 1  ON 23
ci_025                 1.275549e-02 3 1  ON 24
ci_026                 1.401329e-02 3 1  ON 25
ci_027                 1.439812e-02 3 1  ON 26
ci_028                -1.483243e-02 3 1  ON 27
ci_029                -1.533973e-02 3 1  ON 28
ci_030                -1.229064e-02 3 1  ON 29
ci_031                -1.181018e-02 3 1  ON 30
ci_032                -1.442926e-02 3 1  ON 31
ci_033                 1.087376e-02 3 1  ON 32
ci_034                 1.111362e-02 3 1  ON 33
ci_035                -7.065385e-03 3 1  ON 34
ci_036                -1.198587e-02 3 1  ON 35
ci_037                -1.269539e-02 3 1  ON 36
ci_038                 2.842811e-03 3 1  ON 37
ci_039                 2.890870e-03 3 1  ON 38
ci_040                -5.793954e-03 3 1  ON 39
ci_041                 1.040868e-02 3 1  ON 40
ci_042                 1.083532e-02 3 1  ON 41
ci_043                -4.969564e-03 3 1  ON 42
ci_044                -1.589984e-02 3 1  ON 43
ci_045                -3.732419e-03 3 1  ON 44
ci_046                 6.964881e-03 3 1  ON 45
ci_047                 6.696202e-03 3 1  ON 46
ci_048                -1.203501e-02 3 1  ON 47
ci_049                -1.186429e-02 3 1  ON 48
ci_050                 8.552312e-03 3 1  ON 49
ci_051                 8.532755e-03 3 1  ON 50
ci_052                -7.964721e-03 3 1  ON 51
ci_053                -7.844011e-03 3 1  ON 52
ci_054                -3.453465e-03 3 1  ON 53
ci_055                -3.747130e-03 3 1  ON 54
ci_056                 6.267248e-03 3 1  ON 55
ci_057                 5.961244e-03 3 1  ON 56
ci_058                -8.189609e-03 3 1  ON 57
ci_059                -8.352523e-03 3 1  ON 58
ci_060                 9.046372e-03 3 1  ON 59
ci_061                 7.941052e-03 3 1  ON 60
ci_062                -4.089086e-03 3 1  ON 61
ci_063                -4.293021e-03 3 1  ON 62
ci_064                -4.418055e-03 3 1  ON 63
ci_065                -4.908489e-03 3 1  ON 64
ci_066                 6.258944e-03 3 1  ON 65
ci_067                 6.340823e-03 3 1  ON 66
ci_068                -5.840363e-03 3 1  ON 67
ci_069                -5.242436e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.813592
====================================================
  Execution time = 1.4389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1069e-01
  Total weights = 1.956101940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297140557747
                                         uncertainty =       0.002474668345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297140557747
                                         uncertainty =       0.002474668345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385455316
  error estimate for blocks of size 2^( 2) =       0.000396910868
  error estimate for blocks of size 2^( 3) =       0.000407008037
  error estimate for blocks of size 2^( 4) =       0.000413741117
  error estimate for blocks of size 2^( 5) =       0.000418828053
  error estimate for blocks of size 2^( 6) =       0.000421606560
  error estimate for blocks of size 2^( 7) =       0.000424991950

      target function =                  N/A
              le_mean =     -17.213433742267
             les_mean =     296.612993498468
             stat err =       0.000419791920
             autocorr =       1.186096626668
              std dev =       0.545116135666
             le_variance =       0.297151601364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721343374227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213433742275       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213432997874       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213433634594       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213433604801       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.747325e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213433742275       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213433501486       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213433598207       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.518749e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213433742275       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213433677305       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213433691891       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213433690432       residual = 8.45e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 4.068411e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6858e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.483569e-02 3 1  ON 0
ci_002                -3.422512e-02 3 1  ON 1
ci_003                -2.691673e-02 3 1  ON 2
ci_004                 2.447837e-02 3 1  ON 3
ci_005                 2.410503e-02 3 1  ON 4
ci_006                -2.303789e-02 3 1  ON 5
ci_007                -2.298193e-02 3 1  ON 6
ci_008                -2.033070e-02 3 1  ON 7
ci_009                -1.982775e-02 3 1  ON 8
ci_010                -1.810980e-02 3 1  ON 9
ci_011                -1.807447e-02 3 1  ON 10
ci_012                -1.813151e-02 3 1  ON 11
ci_013                -2.065538e-02 3 1  ON 12
ci_014                 1.578870e-02 3 1  ON 13
ci_015                 1.593876e-02 3 1  ON 14
ci_016                 1.707656e-02 3 1  ON 15
ci_017                 1.727758e-02 3 1  ON 16
ci_018                 1.543430e-02 3 1  ON 17
ci_019                 1.560292e-02 3 1  ON 18
ci_020                 1.578636e-02 3 1  ON 19
ci_021                 1.588165e-02 3 1  ON 20
ci_022                 1.358003e-02 3 1  ON 21
ci_023                 1.399023e-02 3 1  ON 22
ci_024                 1.257494e-02 3 1  ON 23
ci_025                 1.274358e-02 3 1  ON 24
ci_026                 1.399589e-02 3 1  ON 25
ci_027                 1.439380e-02 3 1  ON 26
ci_028                -1.477934e-02 3 1  ON 27
ci_029                -1.533130e-02 3 1  ON 28
ci_030                -1.219776e-02 3 1  ON 29
ci_031                -1.180297e-02 3 1  ON 30
ci_032                -1.437118e-02 3 1  ON 31
ci_033                 1.091219e-02 3 1  ON 32
ci_034                 1.114679e-02 3 1  ON 33
ci_035                -7.041078e-03 3 1  ON 34
ci_036                -1.204538e-02 3 1  ON 35
ci_037                -1.270854e-02 3 1  ON 36
ci_038                 2.885848e-03 3 1  ON 37
ci_039                 2.918761e-03 3 1  ON 38
ci_040                -5.827660e-03 3 1  ON 39
ci_041                 1.039980e-02 3 1  ON 40
ci_042                 1.083415e-02 3 1  ON 41
ci_043                -5.065225e-03 3 1  ON 42
ci_044                -1.586201e-02 3 1  ON 43
ci_045                -3.746325e-03 3 1  ON 44
ci_046                 6.898902e-03 3 1  ON 45
ci_047                 6.624100e-03 3 1  ON 46
ci_048                -1.205184e-02 3 1  ON 47
ci_049                -1.186582e-02 3 1  ON 48
ci_050                 8.547650e-03 3 1  ON 49
ci_051                 8.491308e-03 3 1  ON 50
ci_052                -7.988684e-03 3 1  ON 51
ci_053                -7.816901e-03 3 1  ON 52
ci_054                -3.443177e-03 3 1  ON 53
ci_055                -3.698904e-03 3 1  ON 54
ci_056                 6.294905e-03 3 1  ON 55
ci_057                 6.028433e-03 3 1  ON 56
ci_058                -8.226040e-03 3 1  ON 57
ci_059                -8.334984e-03 3 1  ON 58
ci_060                 8.894497e-03 3 1  ON 59
ci_061                 7.953889e-03 3 1  ON 60
ci_062                -4.046838e-03 3 1  ON 61
ci_063                -4.360514e-03 3 1  ON 62
ci_064                -4.409511e-03 3 1  ON 63
ci_065                -4.935722e-03 3 1  ON 64
ci_066                 6.309927e-03 3 1  ON 65
ci_067                 6.379210e-03 3 1  ON 66
ci_068                -5.818483e-03 3 1  ON 67
ci_069                -5.295945e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.281367
====================================================
  Execution time = 1.3704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0703e-01
  Total weights = 1.9561e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293536202282
                                         uncertainty =       0.002344897637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293536202282
                                         uncertainty =       0.002344897637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383056628
  error estimate for blocks of size 2^( 2) =       0.000395140795
  error estimate for blocks of size 2^( 3) =       0.000405192286
  error estimate for blocks of size 2^( 4) =       0.000413059046
  error estimate for blocks of size 2^( 5) =       0.000417878830
  error estimate for blocks of size 2^( 6) =       0.000419944232
  error estimate for blocks of size 2^( 7) =       0.000419672545

      target function =                  N/A
              le_mean =     -17.213763542696
             les_mean =     296.622595202280
             stat err =       0.000417638663
             autocorr =       1.188708675561
              std dev =       0.541723877897
             le_variance =       0.293464759884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293610853788
                                         uncertainty =       0.002345081048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293610853788
                                         uncertainty =       0.002345081048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383106780
  error estimate for blocks of size 2^( 2) =       0.000395190464
  error estimate for blocks of size 2^( 3) =       0.000405240235
  error estimate for blocks of size 2^( 4) =       0.000413114471
  error estimate for blocks of size 2^( 5) =       0.000417930100
  error estimate for blocks of size 2^( 6) =       0.000419996857
  error estimate for blocks of size 2^( 7) =       0.000419737264

      target function =                  N/A
              le_mean =     -17.213765477864
             les_mean =     296.620826629431
             stat err =       0.000417694673
             autocorr =       1.188716240288
              std dev =       0.541794804723
             le_variance =       0.293541610425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293577151915
                                         uncertainty =       0.002344911377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293577151915
                                         uncertainty =       0.002344911377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383084253
  error estimate for blocks of size 2^( 2) =       0.000395167750
  error estimate for blocks of size 2^( 3) =       0.000405217880
  error estimate for blocks of size 2^( 4) =       0.000413089591
  error estimate for blocks of size 2^( 5) =       0.000417906588
  error estimate for blocks of size 2^( 6) =       0.000419973385
  error estimate for blocks of size 2^( 7) =       0.000419709645

      target function =                  N/A
              le_mean =     -17.213763701387
             les_mean =     296.620702550205
             stat err =       0.000417669802
             autocorr =       1.188714478276
              std dev =       0.541762946465
             le_variance =       0.293507090163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293539764700
                                         uncertainty =       0.002344854603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293539764700
                                         uncertainty =       0.002344854603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383059073
  error estimate for blocks of size 2^( 2) =       0.000395142768
  error estimate for blocks of size 2^( 3) =       0.000405194310
  error estimate for blocks of size 2^( 4) =       0.000413062085
  error estimate for blocks of size 2^( 5) =       0.000417881223
  error estimate for blocks of size 2^( 6) =       0.000419947197
  error estimate for blocks of size 2^( 7) =       0.000419676973

      target function =                  N/A
              le_mean =     -17.213763343793
             les_mean =     296.621530662530
             stat err =       0.000417641870
             autocorr =       1.188711752752
              std dev =       0.541727335856
             le_variance =       0.293468506414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213763542696        initial
     5.9605e-01     5.9605e+00             4.7473e-04       -17.213765477864  <--
     2.3842e+00     2.3842e+01             1.5187e-04       -17.213763701387
     9.5367e+00     9.5367e+01             4.0684e-05       -17.213763343793

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.2891e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.469928e-02 3 1  ON 0
ci_002                -3.412466e-02 3 1  ON 1
ci_003                -2.695842e-02 3 1  ON 2
ci_004                 2.439909e-02 3 1  ON 3
ci_005                 2.413257e-02 3 1  ON 4
ci_006                -2.297879e-02 3 1  ON 5
ci_007                -2.276789e-02 3 1  ON 6
ci_008                -2.039110e-02 3 1  ON 7
ci_009                -1.974013e-02 3 1  ON 8
ci_010                -1.817860e-02 3 1  ON 9
ci_011                -1.820211e-02 3 1  ON 10
ci_012                -1.825452e-02 3 1  ON 11
ci_013                -2.050442e-02 3 1  ON 12
ci_014                 1.607659e-02 3 1  ON 13
ci_015                 1.586939e-02 3 1  ON 14
ci_016                 1.702551e-02 3 1  ON 15
ci_017                 1.716924e-02 3 1  ON 16
ci_018                 1.547712e-02 3 1  ON 17
ci_019                 1.553507e-02 3 1  ON 18
ci_020                 1.567950e-02 3 1  ON 19
ci_021                 1.590714e-02 3 1  ON 20
ci_022                 1.359884e-02 3 1  ON 21
ci_023                 1.404198e-02 3 1  ON 22
ci_024                 1.264500e-02 3 1  ON 23
ci_025                 1.271706e-02 3 1  ON 24
ci_026                 1.395955e-02 3 1  ON 25
ci_027                 1.438892e-02 3 1  ON 26
ci_028                -1.465837e-02 3 1  ON 27
ci_029                -1.531054e-02 3 1  ON 28
ci_030                -1.199785e-02 3 1  ON 29
ci_031                -1.178639e-02 3 1  ON 30
ci_032                -1.425800e-02 3 1  ON 31
ci_033                 1.099381e-02 3 1  ON 32
ci_034                 1.121497e-02 3 1  ON 33
ci_035                -6.994821e-03 3 1  ON 34
ci_036                -1.217839e-02 3 1  ON 35
ci_037                -1.273824e-02 3 1  ON 36
ci_038                 2.962032e-03 3 1  ON 37
ci_039                 2.967817e-03 3 1  ON 38
ci_040                -5.886676e-03 3 1  ON 39
ci_041                 1.038328e-02 3 1  ON 40
ci_042                 1.083220e-02 3 1  ON 41
ci_043                -5.239433e-03 3 1  ON 42
ci_044                -1.577490e-02 3 1  ON 43
ci_045                -3.768922e-03 3 1  ON 44
ci_046                 6.760551e-03 3 1  ON 45
ci_047                 6.475535e-03 3 1  ON 46
ci_048                -1.209234e-02 3 1  ON 47
ci_049                -1.186730e-02 3 1  ON 48
ci_050                 8.540550e-03 3 1  ON 49
ci_051                 8.412895e-03 3 1  ON 50
ci_052                -8.034877e-03 3 1  ON 51
ci_053                -7.765601e-03 3 1  ON 52
ci_054                -3.420213e-03 3 1  ON 53
ci_055                -3.602286e-03 3 1  ON 54
ci_056                 6.347646e-03 3 1  ON 55
ci_057                 6.159056e-03 3 1  ON 56
ci_058                -8.298433e-03 3 1  ON 57
ci_059                -8.300377e-03 3 1  ON 58
ci_060                 8.571639e-03 3 1  ON 59
ci_061                 7.980219e-03 3 1  ON 60
ci_062                -3.963360e-03 3 1  ON 61
ci_063                -4.501816e-03 3 1  ON 62
ci_064                -4.395248e-03 3 1  ON 63
ci_065                -4.980524e-03 3 1  ON 64
ci_066                 6.406513e-03 3 1  ON 65
ci_067                 6.449289e-03 3 1  ON 66
ci_068                -5.771090e-03 3 1  ON 67
ci_069                -5.405800e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.19166
====================================================
  Execution time = 1.4178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1102e-01
  Total weights = 1.955675073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295543307801
                                         uncertainty =       0.003101163450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295543307801
                                         uncertainty =       0.003101163450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384381504
  error estimate for blocks of size 2^( 2) =       0.000395703040
  error estimate for blocks of size 2^( 3) =       0.000405547485
  error estimate for blocks of size 2^( 4) =       0.000413146868
  error estimate for blocks of size 2^( 5) =       0.000418112992
  error estimate for blocks of size 2^( 6) =       0.000420937851
  error estimate for blocks of size 2^( 7) =       0.000423087170

      target function =                  N/A
              le_mean =     -17.213689551838
             les_mean =     296.622123302223
             stat err =       0.000418821220
             autocorr =       1.187223244327
              std dev =       0.543597536746
             le_variance =       0.295498281956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721368955184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213689551808       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213687259202       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213685614842       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213685901180       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 7.065069e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213689551808       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213688466114       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213688057618       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213688081188       residual = 2.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 3.198863e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213689551808       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213689202232       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213689159959       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213689153945       residual = 1.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.008152e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6651e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.462834e-02 3 1  ON 0
ci_002                -3.396548e-02 3 1  ON 1
ci_003                -2.672665e-02 3 1  ON 2
ci_004                 2.419896e-02 3 1  ON 3
ci_005                 2.425326e-02 3 1  ON 4
ci_006                -2.306083e-02 3 1  ON 5
ci_007                -2.287327e-02 3 1  ON 6
ci_008                -2.043145e-02 3 1  ON 7
ci_009                -1.971991e-02 3 1  ON 8
ci_010                -1.830956e-02 3 1  ON 9
ci_011                -1.803936e-02 3 1  ON 10
ci_012                -1.838029e-02 3 1  ON 11
ci_013                -2.037757e-02 3 1  ON 12
ci_014                 1.639648e-02 3 1  ON 13
ci_015                 1.580793e-02 3 1  ON 14
ci_016                 1.678236e-02 3 1  ON 15
ci_017                 1.735064e-02 3 1  ON 16
ci_018                 1.529106e-02 3 1  ON 17
ci_019                 1.548202e-02 3 1  ON 18
ci_020                 1.563590e-02 3 1  ON 19
ci_021                 1.568414e-02 3 1  ON 20
ci_022                 1.371747e-02 3 1  ON 21
ci_023                 1.421399e-02 3 1  ON 22
ci_024                 1.258691e-02 3 1  ON 23
ci_025                 1.256102e-02 3 1  ON 24
ci_026                 1.380654e-02 3 1  ON 25
ci_027                 1.433537e-02 3 1  ON 26
ci_028                -1.449994e-02 3 1  ON 27
ci_029                -1.543073e-02 3 1  ON 28
ci_030                -1.189481e-02 3 1  ON 29
ci_031                -1.170166e-02 3 1  ON 30
ci_032                -1.420619e-02 3 1  ON 31
ci_033                 1.099663e-02 3 1  ON 32
ci_034                 1.103660e-02 3 1  ON 33
ci_035                -7.074690e-03 3 1  ON 34
ci_036                -1.219992e-02 3 1  ON 35
ci_037                -1.255705e-02 3 1  ON 36
ci_038                 3.026194e-03 3 1  ON 37
ci_039                 2.902188e-03 3 1  ON 38
ci_040                -5.750521e-03 3 1  ON 39
ci_041                 1.039013e-02 3 1  ON 40
ci_042                 1.077837e-02 3 1  ON 41
ci_043                -5.023473e-03 3 1  ON 42
ci_044                -1.588685e-02 3 1  ON 43
ci_045                -3.760968e-03 3 1  ON 44
ci_046                 6.983857e-03 3 1  ON 45
ci_047                 6.726641e-03 3 1  ON 46
ci_048                -1.202580e-02 3 1  ON 47
ci_049                -1.169460e-02 3 1  ON 48
ci_050                 8.547377e-03 3 1  ON 49
ci_051                 8.684317e-03 3 1  ON 50
ci_052                -8.207499e-03 3 1  ON 51
ci_053                -7.922510e-03 3 1  ON 52
ci_054                -3.373254e-03 3 1  ON 53
ci_055                -3.545165e-03 3 1  ON 54
ci_056                 6.338230e-03 3 1  ON 55
ci_057                 6.179532e-03 3 1  ON 56
ci_058                -8.315979e-03 3 1  ON 57
ci_059                -8.244085e-03 3 1  ON 58
ci_060                 8.678316e-03 3 1  ON 59
ci_061                 7.828977e-03 3 1  ON 60
ci_062                -3.933997e-03 3 1  ON 61
ci_063                -4.590273e-03 3 1  ON 62
ci_064                -4.257059e-03 3 1  ON 63
ci_065                -4.925864e-03 3 1  ON 64
ci_066                 6.251583e-03 3 1  ON 65
ci_067                 6.528866e-03 3 1  ON 66
ci_068                -5.582182e-03 3 1  ON 67
ci_069                -5.348283e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2077
    reference variance = 0.15556
====================================================
  Execution time = 1.3847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0441e-01
  Total weights = 1.9563e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292213065020
                                         uncertainty =       0.001938876577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292213065020
                                         uncertainty =       0.001938876577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382210106
  error estimate for blocks of size 2^( 2) =       0.000393762374
  error estimate for blocks of size 2^( 3) =       0.000404160176
  error estimate for blocks of size 2^( 4) =       0.000411698084
  error estimate for blocks of size 2^( 5) =       0.000416518792
  error estimate for blocks of size 2^( 6) =       0.000418958748
  error estimate for blocks of size 2^( 7) =       0.000419910363

      target function =                  N/A
              le_mean =     -17.214737360877
             les_mean =     296.651705019909
             stat err =       0.000416771497
             autocorr =       1.189026922037
              std dev =       0.540526715082
             le_variance =       0.292169129717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292728876103
                                         uncertainty =       0.001966371413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292728876103
                                         uncertainty =       0.001966371413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382547606
  error estimate for blocks of size 2^( 2) =       0.000394113245
  error estimate for blocks of size 2^( 3) =       0.000404503428
  error estimate for blocks of size 2^( 4) =       0.000412057872
  error estimate for blocks of size 2^( 5) =       0.000416892207
  error estimate for blocks of size 2^( 6) =       0.000419344600
  error estimate for blocks of size 2^( 7) =       0.000420304824

      target function =                  N/A
              le_mean =     -17.214741867674
             les_mean =     296.652811781460
             stat err =       0.000417149875
             autocorr =       1.189085982760
              std dev =       0.541004012683
             le_variance =       0.292685341739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292685607809
                                         uncertainty =       0.001963722913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292685607809
                                         uncertainty =       0.001963722913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382519361
  error estimate for blocks of size 2^( 2) =       0.000394085548
  error estimate for blocks of size 2^( 3) =       0.000404475422
  error estimate for blocks of size 2^( 4) =       0.000412030708
  error estimate for blocks of size 2^( 5) =       0.000416864820
  error estimate for blocks of size 2^( 6) =       0.000419319300
  error estimate for blocks of size 2^( 7) =       0.000420277538

      target function =                  N/A
              le_mean =     -17.214743120530
             les_mean =     296.785802900207
             stat err =       0.000417123092
             autocorr =       1.189108882161
              std dev =       0.540964067608
             le_variance =       0.292642122443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292274343248
                                         uncertainty =       0.001942682431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292274343248
                                         uncertainty =       0.001942682431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382250245
  error estimate for blocks of size 2^( 2) =       0.000393805047
  error estimate for blocks of size 2^( 3) =       0.000404201682
  error estimate for blocks of size 2^( 4) =       0.000411742823
  error estimate for blocks of size 2^( 5) =       0.000416566445
  error estimate for blocks of size 2^( 6) =       0.000419009233
  error estimate for blocks of size 2^( 7) =       0.000419962468

      target function =                  N/A
              le_mean =     -17.214736667523
             les_mean =     296.651834189349
             stat err =       0.000416820242
             autocorr =       1.189055316753
              std dev =       0.540583480396
             le_variance =       0.292230499278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214737360877        initial
     1.4901e-01     1.4901e+00             7.0651e-04       -17.214741867674
     5.9605e-01     5.9605e+00             3.1989e-04       -17.214743120530  <--
     2.3842e+00     2.3842e+01             1.0082e-04       -17.214736667523

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.3028e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.462834e-02 3 1  ON 0
ci_002                -3.396548e-02 3 1  ON 1
ci_003                -2.672665e-02 3 1  ON 2
ci_004                 2.419896e-02 3 1  ON 3
ci_005                 2.425326e-02 3 1  ON 4
ci_006                -2.306083e-02 3 1  ON 5
ci_007                -2.287327e-02 3 1  ON 6
ci_008                -2.043145e-02 3 1  ON 7
ci_009                -1.971991e-02 3 1  ON 8
ci_010                -1.830956e-02 3 1  ON 9
ci_011                -1.803936e-02 3 1  ON 10
ci_012                -1.838029e-02 3 1  ON 11
ci_013                -2.037757e-02 3 1  ON 12
ci_014                 1.639648e-02 3 1  ON 13
ci_015                 1.580793e-02 3 1  ON 14
ci_016                 1.678236e-02 3 1  ON 15
ci_017                 1.735064e-02 3 1  ON 16
ci_018                 1.529106e-02 3 1  ON 17
ci_019                 1.548202e-02 3 1  ON 18
ci_020                 1.563590e-02 3 1  ON 19
ci_021                 1.568414e-02 3 1  ON 20
ci_022                 1.371747e-02 3 1  ON 21
ci_023                 1.421399e-02 3 1  ON 22
ci_024                 1.258691e-02 3 1  ON 23
ci_025                 1.256102e-02 3 1  ON 24
ci_026                 1.380654e-02 3 1  ON 25
ci_027                 1.433537e-02 3 1  ON 26
ci_028                -1.449994e-02 3 1  ON 27
ci_029                -1.543073e-02 3 1  ON 28
ci_030                -1.189481e-02 3 1  ON 29
ci_031                -1.170166e-02 3 1  ON 30
ci_032                -1.420619e-02 3 1  ON 31
ci_033                 1.099663e-02 3 1  ON 32
ci_034                 1.103660e-02 3 1  ON 33
ci_035                -7.074690e-03 3 1  ON 34
ci_036                -1.219992e-02 3 1  ON 35
ci_037                -1.255705e-02 3 1  ON 36
ci_038                 3.026194e-03 3 1  ON 37
ci_039                 2.902188e-03 3 1  ON 38
ci_040                -5.750521e-03 3 1  ON 39
ci_041                 1.039013e-02 3 1  ON 40
ci_042                 1.077837e-02 3 1  ON 41
ci_043                -5.023473e-03 3 1  ON 42
ci_044                -1.588685e-02 3 1  ON 43
ci_045                -3.760968e-03 3 1  ON 44
ci_046                 6.983857e-03 3 1  ON 45
ci_047                 6.726641e-03 3 1  ON 46
ci_048                -1.202580e-02 3 1  ON 47
ci_049                -1.169460e-02 3 1  ON 48
ci_050                 8.547377e-03 3 1  ON 49
ci_051                 8.684317e-03 3 1  ON 50
ci_052                -8.207499e-03 3 1  ON 51
ci_053                -7.922510e-03 3 1  ON 52
ci_054                -3.373254e-03 3 1  ON 53
ci_055                -3.545165e-03 3 1  ON 54
ci_056                 6.338230e-03 3 1  ON 55
ci_057                 6.179532e-03 3 1  ON 56
ci_058                -8.315979e-03 3 1  ON 57
ci_059                -8.244085e-03 3 1  ON 58
ci_060                 8.678316e-03 3 1  ON 59
ci_061                 7.828977e-03 3 1  ON 60
ci_062                -3.933997e-03 3 1  ON 61
ci_063                -4.590273e-03 3 1  ON 62
ci_064                -4.257059e-03 3 1  ON 63
ci_065                -4.925864e-03 3 1  ON 64
ci_066                 6.251583e-03 3 1  ON 65
ci_067                 6.528866e-03 3 1  ON 66
ci_068                -5.582182e-03 3 1  ON 67
ci_069                -5.348283e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2443
    reference variance = 0.390774
====================================================
  Execution time = 1.4093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0639e-01
  Total weights = 1.956156734e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291577126037
                                         uncertainty =       0.001991317762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291577126037
                                         uncertainty =       0.001991317762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381818652
  error estimate for blocks of size 2^( 2) =       0.000393044381
  error estimate for blocks of size 2^( 3) =       0.000403452274
  error estimate for blocks of size 2^( 4) =       0.000410630948
  error estimate for blocks of size 2^( 5) =       0.000414951713
  error estimate for blocks of size 2^( 6) =       0.000416832778
  error estimate for blocks of size 2^( 7) =       0.000417810072

      target function =                  N/A
              le_mean =     -17.214268123597
             les_mean =     296.637416870828
             stat err =       0.000415056378
             autocorr =       1.181680051818
              std dev =       0.539973115488
             le_variance =       0.291570965449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426812360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214268123589       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214269329505       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214267334860       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214267828477       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.360315e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214268123589       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214268692125       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214268324024       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214268384234       residual = 1.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 5.727165e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214268123589       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214268306153       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214268321827       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.814206e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6570e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.456008e-02 3 1  ON 0
ci_002                -3.395602e-02 3 1  ON 1
ci_003                -2.691332e-02 3 1  ON 2
ci_004                 2.422381e-02 3 1  ON 3
ci_005                 2.407056e-02 3 1  ON 4
ci_006                -2.296996e-02 3 1  ON 5
ci_007                -2.284450e-02 3 1  ON 6
ci_008                -2.024709e-02 3 1  ON 7
ci_009                -1.977161e-02 3 1  ON 8
ci_010                -1.812394e-02 3 1  ON 9
ci_011                -1.820418e-02 3 1  ON 10
ci_012                -1.849790e-02 3 1  ON 11
ci_013                -2.055692e-02 3 1  ON 12
ci_014                 1.657878e-02 3 1  ON 13
ci_015                 1.580804e-02 3 1  ON 14
ci_016                 1.673561e-02 3 1  ON 15
ci_017                 1.732972e-02 3 1  ON 16
ci_018                 1.557879e-02 3 1  ON 17
ci_019                 1.541797e-02 3 1  ON 18
ci_020                 1.559695e-02 3 1  ON 19
ci_021                 1.570008e-02 3 1  ON 20
ci_022                 1.357487e-02 3 1  ON 21
ci_023                 1.425144e-02 3 1  ON 22
ci_024                 1.235754e-02 3 1  ON 23
ci_025                 1.267178e-02 3 1  ON 24
ci_026                 1.355866e-02 3 1  ON 25
ci_027                 1.409871e-02 3 1  ON 26
ci_028                -1.444262e-02 3 1  ON 27
ci_029                -1.549456e-02 3 1  ON 28
ci_030                -1.193607e-02 3 1  ON 29
ci_031                -1.167866e-02 3 1  ON 30
ci_032                -1.438311e-02 3 1  ON 31
ci_033                 1.102591e-02 3 1  ON 32
ci_034                 1.120537e-02 3 1  ON 33
ci_035                -7.169706e-03 3 1  ON 34
ci_036                -1.243528e-02 3 1  ON 35
ci_037                -1.269620e-02 3 1  ON 36
ci_038                 2.980553e-03 3 1  ON 37
ci_039                 2.926898e-03 3 1  ON 38
ci_040                -5.845553e-03 3 1  ON 39
ci_041                 1.055625e-02 3 1  ON 40
ci_042                 1.071087e-02 3 1  ON 41
ci_043                -5.339228e-03 3 1  ON 42
ci_044                -1.532844e-02 3 1  ON 43
ci_045                -3.889607e-03 3 1  ON 44
ci_046                 6.807403e-03 3 1  ON 45
ci_047                 6.743638e-03 3 1  ON 46
ci_048                -1.206039e-02 3 1  ON 47
ci_049                -1.172591e-02 3 1  ON 48
ci_050                 8.523514e-03 3 1  ON 49
ci_051                 8.669599e-03 3 1  ON 50
ci_052                -8.012398e-03 3 1  ON 51
ci_053                -7.909914e-03 3 1  ON 52
ci_054                -3.465281e-03 3 1  ON 53
ci_055                -3.539170e-03 3 1  ON 54
ci_056                 6.300232e-03 3 1  ON 55
ci_057                 6.192283e-03 3 1  ON 56
ci_058                -8.427296e-03 3 1  ON 57
ci_059                -8.299827e-03 3 1  ON 58
ci_060                 8.553223e-03 3 1  ON 59
ci_061                 8.401693e-03 3 1  ON 60
ci_062                -3.787135e-03 3 1  ON 61
ci_063                -4.366086e-03 3 1  ON 62
ci_064                -4.080616e-03 3 1  ON 63
ci_065                -5.017681e-03 3 1  ON 64
ci_066                 5.999783e-03 3 1  ON 65
ci_067                 6.426648e-03 3 1  ON 66
ci_068                -5.367090e-03 3 1  ON 67
ci_069                -5.246843e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2274
    reference variance = 0.141416
====================================================
  Execution time = 1.3706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1014e-01
  Total weights = 1.9559e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293057111618
                                         uncertainty =       0.002209968372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293057111618
                                         uncertainty =       0.002209968372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382776594
  error estimate for blocks of size 2^( 2) =       0.000394739332
  error estimate for blocks of size 2^( 3) =       0.000405440306
  error estimate for blocks of size 2^( 4) =       0.000412968521
  error estimate for blocks of size 2^( 5) =       0.000418141219
  error estimate for blocks of size 2^( 6) =       0.000418643276
  error estimate for blocks of size 2^( 7) =       0.000421169448

      target function =                  N/A
              le_mean =     -17.213991948922
             les_mean =     296.632196693284
             stat err =       0.000417730616
             autocorr =       1.190972860199
              std dev =       0.541327850988
             le_variance =       0.293035842255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292510419141
                                         uncertainty =       0.002162518344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292510419141
                                         uncertainty =       0.002162518344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382419096
  error estimate for blocks of size 2^( 2) =       0.000394385484
  error estimate for blocks of size 2^( 3) =       0.000405087158
  error estimate for blocks of size 2^( 4) =       0.000412613720
  error estimate for blocks of size 2^( 5) =       0.000417788628
  error estimate for blocks of size 2^( 6) =       0.000418285912
  error estimate for blocks of size 2^( 7) =       0.000420834854

      target function =                  N/A
              le_mean =     -17.213995109522
             les_mean =     296.632634724181
             stat err =       0.000417380779
             autocorr =       1.191202918725
              std dev =       0.540822271915
             le_variance =       0.292488729799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292545080144
                                         uncertainty =       0.002166379150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292545080144
                                         uncertainty =       0.002166379150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382441786
  error estimate for blocks of size 2^( 2) =       0.000394407310
  error estimate for blocks of size 2^( 3) =       0.000405108464
  error estimate for blocks of size 2^( 4) =       0.000412633885
  error estimate for blocks of size 2^( 5) =       0.000417809877
  error estimate for blocks of size 2^( 6) =       0.000418308437
  error estimate for blocks of size 2^( 7) =       0.000420852680

      target function =                  N/A
              le_mean =     -17.213994033944
             les_mean =     296.633339440905
             stat err =       0.000417401220
             autocorr =       1.191178245220
              std dev =       0.540854360229
             le_variance =       0.292523438978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292956461523
                                         uncertainty =       0.002202465550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292956461523
                                         uncertainty =       0.002202465550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382710821
  error estimate for blocks of size 2^( 2) =       0.000394673763
  error estimate for blocks of size 2^( 3) =       0.000405378252
  error estimate for blocks of size 2^( 4) =       0.000412906766
  error estimate for blocks of size 2^( 5) =       0.000418075844
  error estimate for blocks of size 2^( 6) =       0.000418577975
  error estimate for blocks of size 2^( 7) =       0.000421108590

      target function =                  N/A
              le_mean =     -17.213991230908
             les_mean =     296.633558005425
             stat err =       0.000417667294
             autocorr =       1.191021091780
              std dev =       0.541234833505
             le_variance =       0.292935144999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213991948922        initial
     1.4901e-01     1.4901e+00             1.3603e-03       -17.213995109522  <--
     5.9605e-01     5.9605e+00             5.7272e-04       -17.213994033944
     2.3842e+00     2.3842e+01             1.8142e-04       -17.213991230908

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.2932e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.447621e-02 3 1  ON 0
ci_002                -3.396685e-02 3 1  ON 1
ci_003                -2.717740e-02 3 1  ON 2
ci_004                 2.424131e-02 3 1  ON 3
ci_005                 2.382330e-02 3 1  ON 4
ci_006                -2.286118e-02 3 1  ON 5
ci_007                -2.281716e-02 3 1  ON 6
ci_008                -2.005594e-02 3 1  ON 7
ci_009                -1.985564e-02 3 1  ON 8
ci_010                -1.788058e-02 3 1  ON 9
ci_011                -1.840005e-02 3 1  ON 10
ci_012                -1.863576e-02 3 1  ON 11
ci_013                -2.079574e-02 3 1  ON 12
ci_014                 1.679698e-02 3 1  ON 13
ci_015                 1.581111e-02 3 1  ON 14
ci_016                 1.669419e-02 3 1  ON 15
ci_017                 1.730649e-02 3 1  ON 16
ci_018                 1.590226e-02 3 1  ON 17
ci_019                 1.534281e-02 3 1  ON 18
ci_020                 1.554617e-02 3 1  ON 19
ci_021                 1.572205e-02 3 1  ON 20
ci_022                 1.339498e-02 3 1  ON 21
ci_023                 1.429138e-02 3 1  ON 22
ci_024                 1.204127e-02 3 1  ON 23
ci_025                 1.284416e-02 3 1  ON 24
ci_026                 1.326445e-02 3 1  ON 25
ci_027                 1.381386e-02 3 1  ON 26
ci_028                -1.436274e-02 3 1  ON 27
ci_029                -1.556525e-02 3 1  ON 28
ci_030                -1.199628e-02 3 1  ON 29
ci_031                -1.166459e-02 3 1  ON 30
ci_032                -1.456546e-02 3 1  ON 31
ci_033                 1.106146e-02 3 1  ON 32
ci_034                 1.140747e-02 3 1  ON 33
ci_035                -7.245222e-03 3 1  ON 34
ci_036                -1.272207e-02 3 1  ON 35
ci_037                -1.287377e-02 3 1  ON 36
ci_038                 2.943197e-03 3 1  ON 37
ci_039                 2.944183e-03 3 1  ON 38
ci_040                -5.923020e-03 3 1  ON 39
ci_041                 1.075051e-02 3 1  ON 40
ci_042                 1.063562e-02 3 1  ON 41
ci_043                -5.600666e-03 3 1  ON 42
ci_044                -1.452653e-02 3 1  ON 43
ci_045                -3.992847e-03 3 1  ON 44
ci_046                 6.614664e-03 3 1  ON 45
ci_047                 6.766918e-03 3 1  ON 46
ci_048                -1.210661e-02 3 1  ON 47
ci_049                -1.176404e-02 3 1  ON 48
ci_050                 8.499162e-03 3 1  ON 49
ci_051                 8.657905e-03 3 1  ON 50
ci_052                -7.823189e-03 3 1  ON 51
ci_053                -7.899972e-03 3 1  ON 52
ci_054                -3.565262e-03 3 1  ON 53
ci_055                -3.539828e-03 3 1  ON 54
ci_056                 6.262110e-03 3 1  ON 55
ci_057                 6.201314e-03 3 1  ON 56
ci_058                -8.541868e-03 3 1  ON 57
ci_059                -8.352698e-03 3 1  ON 58
ci_060                 8.409951e-03 3 1  ON 59
ci_061                 9.074347e-03 3 1  ON 60
ci_062                -3.633071e-03 3 1  ON 61
ci_063                -4.131732e-03 3 1  ON 62
ci_064                -3.957191e-03 3 1  ON 63
ci_065                -5.075376e-03 3 1  ON 64
ci_066                 5.774124e-03 3 1  ON 65
ci_067                 6.333111e-03 3 1  ON 66
ci_068                -5.123522e-03 3 1  ON 67
ci_069                -5.131037e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2578
    reference variance = 0.262605
====================================================
  Execution time = 1.4133e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1562e-01
  Total weights = 1.956022031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300711499562
                                         uncertainty =       0.007936437885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300711499562
                                         uncertainty =       0.007936437885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387823612
  error estimate for blocks of size 2^( 2) =       0.000399305668
  error estimate for blocks of size 2^( 3) =       0.000409837743
  error estimate for blocks of size 2^( 4) =       0.000417278635
  error estimate for blocks of size 2^( 5) =       0.000422220326
  error estimate for blocks of size 2^( 6) =       0.000424327243
  error estimate for blocks of size 2^( 7) =       0.000423508748

      target function =                  N/A
              le_mean =     -17.214296258953
             les_mean =     296.647612911250
             stat err =       0.000421833738
             autocorr =       1.183080043670
              std dev =       0.548465411931
             le_variance =       0.300814308085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429625895e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214296258944       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214335236993       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214332500469       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214332277092       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214332283133       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-02 is 1.534416e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214296258944       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214324663762       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214322799632       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214322658656       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.061535e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214296258944       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214309882026       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214309248216       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214309214746       residual = 3.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.732662e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6619e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.441810e-02 3 1  ON 0
ci_002                -3.398815e-02 3 1  ON 1
ci_003                -2.667359e-02 3 1  ON 2
ci_004                 2.406128e-02 3 1  ON 3
ci_005                 2.365662e-02 3 1  ON 4
ci_006                -2.229799e-02 3 1  ON 5
ci_007                -2.291059e-02 3 1  ON 6
ci_008                -2.013497e-02 3 1  ON 7
ci_009                -1.970857e-02 3 1  ON 8
ci_010                -1.824893e-02 3 1  ON 9
ci_011                -1.902200e-02 3 1  ON 10
ci_012                -1.853520e-02 3 1  ON 11
ci_013                -2.097998e-02 3 1  ON 12
ci_014                 1.740926e-02 3 1  ON 13
ci_015                 1.598878e-02 3 1  ON 14
ci_016                 1.670820e-02 3 1  ON 15
ci_017                 1.789689e-02 3 1  ON 16
ci_018                 1.578264e-02 3 1  ON 17
ci_019                 1.537556e-02 3 1  ON 18
ci_020                 1.551693e-02 3 1  ON 19
ci_021                 1.559952e-02 3 1  ON 20
ci_022                 1.423786e-02 3 1  ON 21
ci_023                 1.362170e-02 3 1  ON 22
ci_024                 1.214473e-02 3 1  ON 23
ci_025                 1.241031e-02 3 1  ON 24
ci_026                 1.333826e-02 3 1  ON 25
ci_027                 1.376828e-02 3 1  ON 26
ci_028                -1.530178e-02 3 1  ON 27
ci_029                -1.553871e-02 3 1  ON 28
ci_030                -1.164356e-02 3 1  ON 29
ci_031                -1.167181e-02 3 1  ON 30
ci_032                -1.379156e-02 3 1  ON 31
ci_033                 1.103149e-02 3 1  ON 32
ci_034                 1.134893e-02 3 1  ON 33
ci_035                -6.641289e-03 3 1  ON 34
ci_036                -1.223165e-02 3 1  ON 35
ci_037                -1.181224e-02 3 1  ON 36
ci_038                 2.620570e-03 3 1  ON 37
ci_039                 3.003031e-03 3 1  ON 38
ci_040                -6.042890e-03 3 1  ON 39
ci_041                 1.049708e-02 3 1  ON 40
ci_042                 1.042051e-02 3 1  ON 41
ci_043                -5.185613e-03 3 1  ON 42
ci_044                -1.508606e-02 3 1  ON 43
ci_045                -3.674928e-03 3 1  ON 44
ci_046                 6.508557e-03 3 1  ON 45
ci_047                 7.037009e-03 3 1  ON 46
ci_048                -1.132640e-02 3 1  ON 47
ci_049                -1.162608e-02 3 1  ON 48
ci_050                 8.406406e-03 3 1  ON 49
ci_051                 8.678300e-03 3 1  ON 50
ci_052                -8.116254e-03 3 1  ON 51
ci_053                -8.136836e-03 3 1  ON 52
ci_054                -3.206052e-03 3 1  ON 53
ci_055                -3.761915e-03 3 1  ON 54
ci_056                 6.497093e-03 3 1  ON 55
ci_057                 6.804463e-03 3 1  ON 56
ci_058                -8.383985e-03 3 1  ON 57
ci_059                -8.687929e-03 3 1  ON 58
ci_060                 7.870436e-03 3 1  ON 59
ci_061                 8.969992e-03 3 1  ON 60
ci_062                -4.168640e-03 3 1  ON 61
ci_063                -4.384401e-03 3 1  ON 62
ci_064                -4.128288e-03 3 1  ON 63
ci_065                -5.012221e-03 3 1  ON 64
ci_066                 6.322505e-03 3 1  ON 65
ci_067                 6.357855e-03 3 1  ON 66
ci_068                -4.992654e-03 3 1  ON 67
ci_069                -5.463788e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2347
    reference variance = 0.183697
====================================================
  Execution time = 1.3764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0445e-01
  Total weights = 1.9561e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292300426687
                                         uncertainty =       0.002291046763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292300426687
                                         uncertainty =       0.002291046763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382257050
  error estimate for blocks of size 2^( 2) =       0.000393816318
  error estimate for blocks of size 2^( 3) =       0.000404154265
  error estimate for blocks of size 2^( 4) =       0.000412149439
  error estimate for blocks of size 2^( 5) =       0.000417673536
  error estimate for blocks of size 2^( 6) =       0.000420579387
  error estimate for blocks of size 2^( 7) =       0.000422473942

      target function =                  N/A
              le_mean =     -17.214492099023
             les_mean =     296.645844453207
             stat err =       0.000418219076
             autocorr =       1.197006940727
              std dev =       0.540593104415
             le_variance =       0.292240904542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293187756039
                                         uncertainty =       0.002307344936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293187756039
                                         uncertainty =       0.002307344936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382837587
  error estimate for blocks of size 2^( 2) =       0.000394380199
  error estimate for blocks of size 2^( 3) =       0.000404712804
  error estimate for blocks of size 2^( 4) =       0.000412706717
  error estimate for blocks of size 2^( 5) =       0.000418228860
  error estimate for blocks of size 2^( 6) =       0.000421111517
  error estimate for blocks of size 2^( 7) =       0.000423087260

      target function =                  N/A
              le_mean =     -17.214474765072
             les_mean =     296.643755589173
             stat err =       0.000418783589
             autocorr =       1.196603219220
              std dev =       0.541414108124
             le_variance =       0.293129236475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293773602670
                                         uncertainty =       0.002314430578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293773602670
                                         uncertainty =       0.002314430578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383220111
  error estimate for blocks of size 2^( 2) =       0.000394758369
  error estimate for blocks of size 2^( 3) =       0.000405088380
  error estimate for blocks of size 2^( 4) =       0.000413079221
  error estimate for blocks of size 2^( 5) =       0.000418618374
  error estimate for blocks of size 2^( 6) =       0.000421502579
  error estimate for blocks of size 2^( 7) =       0.000423515500

      target function =                  N/A
              le_mean =     -17.214494140192
             les_mean =     296.648970835977
             stat err =       0.000419178918
             autocorr =       1.196471287829
              std dev =       0.541955078228
             le_variance =       0.293715306817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292499643422
                                         uncertainty =       0.002295718536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292499643422
                                         uncertainty =       0.002295718536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382387561
  error estimate for blocks of size 2^( 2) =       0.000393945081
  error estimate for blocks of size 2^( 3) =       0.000404283225
  error estimate for blocks of size 2^( 4) =       0.000412281389
  error estimate for blocks of size 2^( 5) =       0.000417807207
  error estimate for blocks of size 2^( 6) =       0.000420704392
  error estimate for blocks of size 2^( 7) =       0.000422623202

      target function =                  N/A
              le_mean =     -17.214473130781
             les_mean =     296.660600504032
             stat err =       0.000418354047
             autocorr =       1.196962203669
              std dev =       0.540777675123
             le_variance =       0.292440493911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214492099023        initial
     3.7253e-02     3.7253e-01             1.5344e-03       -17.214474765072
     1.4901e-01     1.4901e+00             1.0615e-03       -17.214494140192  <--
     5.9605e-01     5.9605e+00             4.7327e-04       -17.214473130781

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.6212e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.441810e-02 3 1  ON 0
ci_002                -3.398815e-02 3 1  ON 1
ci_003                -2.667359e-02 3 1  ON 2
ci_004                 2.406128e-02 3 1  ON 3
ci_005                 2.365662e-02 3 1  ON 4
ci_006                -2.229799e-02 3 1  ON 5
ci_007                -2.291059e-02 3 1  ON 6
ci_008                -2.013497e-02 3 1  ON 7
ci_009                -1.970857e-02 3 1  ON 8
ci_010                -1.824893e-02 3 1  ON 9
ci_011                -1.902200e-02 3 1  ON 10
ci_012                -1.853520e-02 3 1  ON 11
ci_013                -2.097998e-02 3 1  ON 12
ci_014                 1.740926e-02 3 1  ON 13
ci_015                 1.598878e-02 3 1  ON 14
ci_016                 1.670820e-02 3 1  ON 15
ci_017                 1.789689e-02 3 1  ON 16
ci_018                 1.578264e-02 3 1  ON 17
ci_019                 1.537556e-02 3 1  ON 18
ci_020                 1.551693e-02 3 1  ON 19
ci_021                 1.559952e-02 3 1  ON 20
ci_022                 1.423786e-02 3 1  ON 21
ci_023                 1.362170e-02 3 1  ON 22
ci_024                 1.214473e-02 3 1  ON 23
ci_025                 1.241031e-02 3 1  ON 24
ci_026                 1.333826e-02 3 1  ON 25
ci_027                 1.376828e-02 3 1  ON 26
ci_028                -1.530178e-02 3 1  ON 27
ci_029                -1.553871e-02 3 1  ON 28
ci_030                -1.164356e-02 3 1  ON 29
ci_031                -1.167181e-02 3 1  ON 30
ci_032                -1.379156e-02 3 1  ON 31
ci_033                 1.103149e-02 3 1  ON 32
ci_034                 1.134893e-02 3 1  ON 33
ci_035                -6.641289e-03 3 1  ON 34
ci_036                -1.223165e-02 3 1  ON 35
ci_037                -1.181224e-02 3 1  ON 36
ci_038                 2.620570e-03 3 1  ON 37
ci_039                 3.003031e-03 3 1  ON 38
ci_040                -6.042890e-03 3 1  ON 39
ci_041                 1.049708e-02 3 1  ON 40
ci_042                 1.042051e-02 3 1  ON 41
ci_043                -5.185613e-03 3 1  ON 42
ci_044                -1.508606e-02 3 1  ON 43
ci_045                -3.674928e-03 3 1  ON 44
ci_046                 6.508557e-03 3 1  ON 45
ci_047                 7.037009e-03 3 1  ON 46
ci_048                -1.132640e-02 3 1  ON 47
ci_049                -1.162608e-02 3 1  ON 48
ci_050                 8.406406e-03 3 1  ON 49
ci_051                 8.678300e-03 3 1  ON 50
ci_052                -8.116254e-03 3 1  ON 51
ci_053                -8.136836e-03 3 1  ON 52
ci_054                -3.206052e-03 3 1  ON 53
ci_055                -3.761915e-03 3 1  ON 54
ci_056                 6.497093e-03 3 1  ON 55
ci_057                 6.804463e-03 3 1  ON 56
ci_058                -8.383985e-03 3 1  ON 57
ci_059                -8.687929e-03 3 1  ON 58
ci_060                 7.870436e-03 3 1  ON 59
ci_061                 8.969992e-03 3 1  ON 60
ci_062                -4.168640e-03 3 1  ON 61
ci_063                -4.384401e-03 3 1  ON 62
ci_064                -4.128288e-03 3 1  ON 63
ci_065                -5.012221e-03 3 1  ON 64
ci_066                 6.322505e-03 3 1  ON 65
ci_067                 6.357855e-03 3 1  ON 66
ci_068                -4.992654e-03 3 1  ON 67
ci_069                -5.463788e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.219617
====================================================
  Execution time = 1.4119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0422e-01
  Total weights = 1.955994142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487333705
                                         uncertainty =       0.001960503614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487333705
                                         uncertainty =       0.001960503614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381751448
  error estimate for blocks of size 2^( 2) =       0.000393656394
  error estimate for blocks of size 2^( 3) =       0.000404067064
  error estimate for blocks of size 2^( 4) =       0.000410949035
  error estimate for blocks of size 2^( 5) =       0.000415019049
  error estimate for blocks of size 2^( 6) =       0.000416970276
  error estimate for blocks of size 2^( 7) =       0.000419431346

      target function =                  N/A
              le_mean =     -17.213527303992
             les_mean =     296.609737308825
             stat err =       0.000415592426
             autocorr =       1.185151477114
              std dev =       0.539878075712
             le_variance =       0.291468336634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721352730399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213527304001       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213546834626       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213547664724       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213547163763       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213547367845       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-02 is 1.481953e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213527304001       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213541556967       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213542063281       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213541889500       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.035603e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213527304001       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213534153418       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213534483034       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213534471375       residual = 4.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.725947e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6611e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.511023e-02 3 1  ON 0
ci_002                -3.422862e-02 3 1  ON 1
ci_003                -2.718312e-02 3 1  ON 2
ci_004                 2.402143e-02 3 1  ON 3
ci_005                 2.361168e-02 3 1  ON 4
ci_006                -2.267812e-02 3 1  ON 5
ci_007                -2.260696e-02 3 1  ON 6
ci_008                -1.971054e-02 3 1  ON 7
ci_009                -1.934274e-02 3 1  ON 8
ci_010                -1.821667e-02 3 1  ON 9
ci_011                -1.874698e-02 3 1  ON 10
ci_012                -1.800185e-02 3 1  ON 11
ci_013                -2.078260e-02 3 1  ON 12
ci_014                 1.692822e-02 3 1  ON 13
ci_015                 1.599008e-02 3 1  ON 14
ci_016                 1.683316e-02 3 1  ON 15
ci_017                 1.700327e-02 3 1  ON 16
ci_018                 1.592909e-02 3 1  ON 17
ci_019                 1.561770e-02 3 1  ON 18
ci_020                 1.602541e-02 3 1  ON 19
ci_021                 1.581399e-02 3 1  ON 20
ci_022                 1.381965e-02 3 1  ON 21
ci_023                 1.331527e-02 3 1  ON 22
ci_024                 1.267078e-02 3 1  ON 23
ci_025                 1.254968e-02 3 1  ON 24
ci_026                 1.338489e-02 3 1  ON 25
ci_027                 1.437547e-02 3 1  ON 26
ci_028                -1.541471e-02 3 1  ON 27
ci_029                -1.455740e-02 3 1  ON 28
ci_030                -1.160658e-02 3 1  ON 29
ci_031                -1.171293e-02 3 1  ON 30
ci_032                -1.406847e-02 3 1  ON 31
ci_033                 1.088004e-02 3 1  ON 32
ci_034                 1.146026e-02 3 1  ON 33
ci_035                -7.327513e-03 3 1  ON 34
ci_036                -1.256434e-02 3 1  ON 35
ci_037                -1.240445e-02 3 1  ON 36
ci_038                 3.000546e-03 3 1  ON 37
ci_039                 2.765393e-03 3 1  ON 38
ci_040                -6.036492e-03 3 1  ON 39
ci_041                 1.055758e-02 3 1  ON 40
ci_042                 1.036899e-02 3 1  ON 41
ci_043                -5.218510e-03 3 1  ON 42
ci_044                -1.525917e-02 3 1  ON 43
ci_045                -3.571806e-03 3 1  ON 44
ci_046                 6.484693e-03 3 1  ON 45
ci_047                 7.233178e-03 3 1  ON 46
ci_048                -1.203482e-02 3 1  ON 47
ci_049                -1.207780e-02 3 1  ON 48
ci_050                 8.184571e-03 3 1  ON 49
ci_051                 8.698437e-03 3 1  ON 50
ci_052                -8.081054e-03 3 1  ON 51
ci_053                -7.838078e-03 3 1  ON 52
ci_054                -3.177074e-03 3 1  ON 53
ci_055                -3.639072e-03 3 1  ON 54
ci_056                 6.302720e-03 3 1  ON 55
ci_057                 6.122708e-03 3 1  ON 56
ci_058                -7.977497e-03 3 1  ON 57
ci_059                -8.354152e-03 3 1  ON 58
ci_060                 8.906040e-03 3 1  ON 59
ci_061                 8.755743e-03 3 1  ON 60
ci_062                -4.024546e-03 3 1  ON 61
ci_063                -4.396731e-03 3 1  ON 62
ci_064                -4.395580e-03 3 1  ON 63
ci_065                -5.392900e-03 3 1  ON 64
ci_066                 6.677228e-03 3 1  ON 65
ci_067                 6.053755e-03 3 1  ON 66
ci_068                -5.300619e-03 3 1  ON 67
ci_069                -5.075553e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2821
    reference variance = 0.254542
====================================================
  Execution time = 1.3833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0301e-01
  Total weights = 1.9561e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291664975310
                                         uncertainty =       0.001754849471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291664975310
                                         uncertainty =       0.001754849471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381846395
  error estimate for blocks of size 2^( 2) =       0.000393393787
  error estimate for blocks of size 2^( 3) =       0.000403683236
  error estimate for blocks of size 2^( 4) =       0.000411320664
  error estimate for blocks of size 2^( 5) =       0.000415200126
  error estimate for blocks of size 2^( 6) =       0.000416596300
  error estimate for blocks of size 2^( 7) =       0.000419274749

      target function =                  N/A
              le_mean =     -17.214262206394
             les_mean =     296.641194571912
             stat err =       0.000415597960
             autocorr =       1.184593713571
              std dev =       0.540012350784
             le_variance =       0.291613338999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290475141337
                                         uncertainty =       0.001720888486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290475141337
                                         uncertainty =       0.001720888486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381066686
  error estimate for blocks of size 2^( 2) =       0.000392632807
  error estimate for blocks of size 2^( 3) =       0.000402930187
  error estimate for blocks of size 2^( 4) =       0.000410566829
  error estimate for blocks of size 2^( 5) =       0.000414457065
  error estimate for blocks of size 2^( 6) =       0.000415873652
  error estimate for blocks of size 2^( 7) =       0.000418554898

      target function =                  N/A
              le_mean =     -17.214218209650
             les_mean =     296.677205778676
             stat err =       0.000414863111
             autocorr =       1.185243747115
              std dev =       0.538909675629
             le_variance =       0.290423638486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290180160667
                                         uncertainty =       0.001703512043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290180160667
                                         uncertainty =       0.001703512043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380872870
  error estimate for blocks of size 2^( 2) =       0.000392446663
  error estimate for blocks of size 2^( 3) =       0.000402749460
  error estimate for blocks of size 2^( 4) =       0.000410388334
  error estimate for blocks of size 2^( 5) =       0.000414288606
  error estimate for blocks of size 2^( 6) =       0.000415696319
  error estimate for blocks of size 2^( 7) =       0.000418387221

      target function =                  N/A
              le_mean =     -17.214228984536
             les_mean =     296.639676389824
             stat err =       0.000414690120
             autocorr =       1.185461079487
              std dev =       0.538635578338
             le_variance =       0.290128286251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291097507111
                                         uncertainty =       0.001743524714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291097507111
                                         uncertainty =       0.001743524714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381474809
  error estimate for blocks of size 2^( 2) =       0.000393030320
  error estimate for blocks of size 2^( 3) =       0.000403322178
  error estimate for blocks of size 2^( 4) =       0.000410961491
  error estimate for blocks of size 2^( 5) =       0.000414845127
  error estimate for blocks of size 2^( 6) =       0.000416243861
  error estimate for blocks of size 2^( 7) =       0.000418922838

      target function =                  N/A
              le_mean =     -17.214240607814
             les_mean =     296.635855888283
             stat err =       0.000415243329
             autocorr =       1.184877905751
              std dev =       0.539486847904
             le_variance =       0.291046059061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214262206394        initial  <--
     3.7253e-02     3.7253e-01             1.4820e-03       -17.214218209650
     1.4901e-01     1.4901e+00             1.0356e-03       -17.214228984536
     5.9605e-01     5.9605e+00             4.7259e-04       -17.214240607814

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9793
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.441810e-02 3 1  ON 0
ci_002                -3.398815e-02 3 1  ON 1
ci_003                -2.667359e-02 3 1  ON 2
ci_004                 2.406128e-02 3 1  ON 3
ci_005                 2.365662e-02 3 1  ON 4
ci_006                -2.229799e-02 3 1  ON 5
ci_007                -2.291059e-02 3 1  ON 6
ci_008                -2.013497e-02 3 1  ON 7
ci_009                -1.970857e-02 3 1  ON 8
ci_010                -1.824893e-02 3 1  ON 9
ci_011                -1.902200e-02 3 1  ON 10
ci_012                -1.853520e-02 3 1  ON 11
ci_013                -2.097998e-02 3 1  ON 12
ci_014                 1.740926e-02 3 1  ON 13
ci_015                 1.598878e-02 3 1  ON 14
ci_016                 1.670820e-02 3 1  ON 15
ci_017                 1.789689e-02 3 1  ON 16
ci_018                 1.578264e-02 3 1  ON 17
ci_019                 1.537556e-02 3 1  ON 18
ci_020                 1.551693e-02 3 1  ON 19
ci_021                 1.559952e-02 3 1  ON 20
ci_022                 1.423786e-02 3 1  ON 21
ci_023                 1.362170e-02 3 1  ON 22
ci_024                 1.214473e-02 3 1  ON 23
ci_025                 1.241031e-02 3 1  ON 24
ci_026                 1.333826e-02 3 1  ON 25
ci_027                 1.376828e-02 3 1  ON 26
ci_028                -1.530178e-02 3 1  ON 27
ci_029                -1.553871e-02 3 1  ON 28
ci_030                -1.164356e-02 3 1  ON 29
ci_031                -1.167181e-02 3 1  ON 30
ci_032                -1.379156e-02 3 1  ON 31
ci_033                 1.103149e-02 3 1  ON 32
ci_034                 1.134893e-02 3 1  ON 33
ci_035                -6.641289e-03 3 1  ON 34
ci_036                -1.223165e-02 3 1  ON 35
ci_037                -1.181224e-02 3 1  ON 36
ci_038                 2.620570e-03 3 1  ON 37
ci_039                 3.003031e-03 3 1  ON 38
ci_040                -6.042890e-03 3 1  ON 39
ci_041                 1.049708e-02 3 1  ON 40
ci_042                 1.042051e-02 3 1  ON 41
ci_043                -5.185613e-03 3 1  ON 42
ci_044                -1.508606e-02 3 1  ON 43
ci_045                -3.674928e-03 3 1  ON 44
ci_046                 6.508557e-03 3 1  ON 45
ci_047                 7.037009e-03 3 1  ON 46
ci_048                -1.132640e-02 3 1  ON 47
ci_049                -1.162608e-02 3 1  ON 48
ci_050                 8.406406e-03 3 1  ON 49
ci_051                 8.678300e-03 3 1  ON 50
ci_052                -8.116254e-03 3 1  ON 51
ci_053                -8.136836e-03 3 1  ON 52
ci_054                -3.206052e-03 3 1  ON 53
ci_055                -3.761915e-03 3 1  ON 54
ci_056                 6.497093e-03 3 1  ON 55
ci_057                 6.804463e-03 3 1  ON 56
ci_058                -8.383985e-03 3 1  ON 57
ci_059                -8.687929e-03 3 1  ON 58
ci_060                 7.870436e-03 3 1  ON 59
ci_061                 8.969992e-03 3 1  ON 60
ci_062                -4.168640e-03 3 1  ON 61
ci_063                -4.384401e-03 3 1  ON 62
ci_064                -4.128288e-03 3 1  ON 63
ci_065                -5.012221e-03 3 1  ON 64
ci_066                 6.322505e-03 3 1  ON 65
ci_067                 6.357855e-03 3 1  ON 66
ci_068                -4.992654e-03 3 1  ON 67
ci_069                -5.463788e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1833
    reference variance = 0.742214
====================================================
  Execution time = 1.4101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0673e-01
  Total weights = 1.956156489e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292116505250
                                         uncertainty =       0.001902145891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292116505250
                                         uncertainty =       0.001902145891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382174248
  error estimate for blocks of size 2^( 2) =       0.000393606112
  error estimate for blocks of size 2^( 3) =       0.000404384148
  error estimate for blocks of size 2^( 4) =       0.000411603604
  error estimate for blocks of size 2^( 5) =       0.000416499753
  error estimate for blocks of size 2^( 6) =       0.000418440829
  error estimate for blocks of size 2^( 7) =       0.000420392811

      target function =                  N/A
              le_mean =     -17.213735721495
             les_mean =     296.619425055723
             stat err =       0.000416734249
             autocorr =       1.189037494488
              std dev =       0.540476004568
             le_variance =       0.292114311514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721373572149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735721475       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213749084100       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213749437945       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213749250130       residual = 6.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 6.993617e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735721475       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213740431069       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213740543730       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213740528695       residual = 1.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.374861e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213735721475       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213737033259       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213737065589       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213737059683       residual = 2.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 6.609342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6579e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.445544e-02 3 1  ON 0
ci_002                -3.398293e-02 3 1  ON 1
ci_003                -2.676231e-02 3 1  ON 2
ci_004                 2.412057e-02 3 1  ON 3
ci_005                 2.379970e-02 3 1  ON 4
ci_006                -2.236321e-02 3 1  ON 5
ci_007                -2.287968e-02 3 1  ON 6
ci_008                -2.009959e-02 3 1  ON 7
ci_009                -1.980565e-02 3 1  ON 8
ci_010                -1.838647e-02 3 1  ON 9
ci_011                -1.884570e-02 3 1  ON 10
ci_012                -1.854366e-02 3 1  ON 11
ci_013                -2.077967e-02 3 1  ON 12
ci_014                 1.719393e-02 3 1  ON 13
ci_015                 1.608706e-02 3 1  ON 14
ci_016                 1.675795e-02 3 1  ON 15
ci_017                 1.776621e-02 3 1  ON 16
ci_018                 1.570349e-02 3 1  ON 17
ci_019                 1.533568e-02 3 1  ON 18
ci_020                 1.557613e-02 3 1  ON 19
ci_021                 1.560138e-02 3 1  ON 20
ci_022                 1.438399e-02 3 1  ON 21
ci_023                 1.365884e-02 3 1  ON 22
ci_024                 1.215426e-02 3 1  ON 23
ci_025                 1.244988e-02 3 1  ON 24
ci_026                 1.337983e-02 3 1  ON 25
ci_027                 1.389293e-02 3 1  ON 26
ci_028                -1.535976e-02 3 1  ON 27
ci_029                -1.549421e-02 3 1  ON 28
ci_030                -1.169900e-02 3 1  ON 29
ci_031                -1.164638e-02 3 1  ON 30
ci_032                -1.383319e-02 3 1  ON 31
ci_033                 1.092872e-02 3 1  ON 32
ci_034                 1.111144e-02 3 1  ON 33
ci_035                -6.687661e-03 3 1  ON 34
ci_036                -1.216210e-02 3 1  ON 35
ci_037                -1.192596e-02 3 1  ON 36
ci_038                 2.630743e-03 3 1  ON 37
ci_039                 3.072767e-03 3 1  ON 38
ci_040                -6.060217e-03 3 1  ON 39
ci_041                 1.049643e-02 3 1  ON 40
ci_042                 1.048516e-02 3 1  ON 41
ci_043                -5.199327e-03 3 1  ON 42
ci_044                -1.520832e-02 3 1  ON 43
ci_045                -3.682287e-03 3 1  ON 44
ci_046                 6.517719e-03 3 1  ON 45
ci_047                 6.939622e-03 3 1  ON 46
ci_048                -1.155499e-02 3 1  ON 47
ci_049                -1.171373e-02 3 1  ON 48
ci_050                 8.365397e-03 3 1  ON 49
ci_051                 8.622096e-03 3 1  ON 50
ci_052                -8.130406e-03 3 1  ON 51
ci_053                -8.212455e-03 3 1  ON 52
ci_054                -3.174963e-03 3 1  ON 53
ci_055                -3.715505e-03 3 1  ON 54
ci_056                 6.490646e-03 3 1  ON 55
ci_057                 6.680089e-03 3 1  ON 56
ci_058                -8.287156e-03 3 1  ON 57
ci_059                -8.577894e-03 3 1  ON 58
ci_060                 8.023700e-03 3 1  ON 59
ci_061                 8.999184e-03 3 1  ON 60
ci_062                -4.218107e-03 3 1  ON 61
ci_063                -4.328781e-03 3 1  ON 62
ci_064                -4.126134e-03 3 1  ON 63
ci_065                -5.144306e-03 3 1  ON 64
ci_066                 6.406552e-03 3 1  ON 65
ci_067                 6.342274e-03 3 1  ON 66
ci_068                -5.098407e-03 3 1  ON 67
ci_069                -5.468049e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1623
    reference variance = 0.221525
====================================================
  Execution time = 1.3841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0875e-01
  Total weights = 1.9564e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295310719521
                                         uncertainty =       0.001968459358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295310719521
                                         uncertainty =       0.001968459358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384274486
  error estimate for blocks of size 2^( 2) =       0.000395692805
  error estimate for blocks of size 2^( 3) =       0.000406176799
  error estimate for blocks of size 2^( 4) =       0.000413890644
  error estimate for blocks of size 2^( 5) =       0.000417201458
  error estimate for blocks of size 2^( 6) =       0.000419761417
  error estimate for blocks of size 2^( 7) =       0.000422281617

      target function =                  N/A
              le_mean =     -17.214692199064
             les_mean =     296.655262170008
             stat err =       0.000418283784
             autocorr =       1.184837947295
              std dev =       0.543446190339
             le_variance =       0.295333761794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295106634326
                                         uncertainty =       0.001971817816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295106634326
                                         uncertainty =       0.001971817816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384141353
  error estimate for blocks of size 2^( 2) =       0.000395557079
  error estimate for blocks of size 2^( 3) =       0.000406035667
  error estimate for blocks of size 2^( 4) =       0.000413743180
  error estimate for blocks of size 2^( 5) =       0.000417054615
  error estimate for blocks of size 2^( 6) =       0.000419606617
  error estimate for blocks of size 2^( 7) =       0.000422163605

      target function =                  N/A
              le_mean =     -17.214700190400
             les_mean =     296.654944153311
             stat err =       0.000418142004
             autocorr =       1.184855719957
              std dev =       0.543257911375
             le_variance =       0.295129158272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295140183785
                                         uncertainty =       0.001970016540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295140183785
                                         uncertainty =       0.001970016540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384163263
  error estimate for blocks of size 2^( 2) =       0.000395579364
  error estimate for blocks of size 2^( 3) =       0.000406059169
  error estimate for blocks of size 2^( 4) =       0.000413768599
  error estimate for blocks of size 2^( 5) =       0.000417080362
  error estimate for blocks of size 2^( 6) =       0.000419634388
  error estimate for blocks of size 2^( 7) =       0.000422182758

      target function =                  N/A
              le_mean =     -17.214695913833
             les_mean =     296.655180325973
             stat err =       0.000418166526
             autocorr =       1.184859535031
              std dev =       0.543288896497
             le_variance =       0.295162825057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295281169306
                                         uncertainty =       0.001968577482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295281169306
                                         uncertainty =       0.001968577482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384255224
  error estimate for blocks of size 2^( 2) =       0.000395673264
  error estimate for blocks of size 2^( 3) =       0.000406156645
  error estimate for blocks of size 2^( 4) =       0.000413870052
  error estimate for blocks of size 2^( 5) =       0.000417181215
  error estimate for blocks of size 2^( 6) =       0.000419740249
  error estimate for blocks of size 2^( 7) =       0.000422264865

      target function =                  N/A
              le_mean =     -17.214692076705
             les_mean =     296.654578915666
             stat err =       0.000418264095
             autocorr =       1.184845187427
              std dev =       0.543418949517
             le_variance =       0.295304154694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214692199064        initial
     3.7253e-01     3.7253e+00             6.9936e-04       -17.214700190400  <--
     1.4901e+00     1.4901e+01             2.3749e-04       -17.214695913833
     5.9605e+00     5.9605e+01             6.6093e-05       -17.214692076705

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.2977e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.451008e-02 3 1  ON 0
ci_002                -3.397242e-02 3 1  ON 1
ci_003                -2.692111e-02 3 1  ON 2
ci_004                 2.423722e-02 3 1  ON 3
ci_005                 2.407144e-02 3 1  ON 4
ci_006                -2.248636e-02 3 1  ON 5
ci_007                -2.281590e-02 3 1  ON 6
ci_008                -2.003780e-02 3 1  ON 7
ci_009                -1.995288e-02 3 1  ON 8
ci_010                -1.865697e-02 3 1  ON 9
ci_011                -1.851530e-02 3 1  ON 10
ci_012                -1.856706e-02 3 1  ON 11
ci_013                -2.036217e-02 3 1  ON 12
ci_014                 1.680777e-02 3 1  ON 13
ci_015                 1.627286e-02 3 1  ON 14
ci_016                 1.684579e-02 3 1  ON 15
ci_017                 1.750483e-02 3 1  ON 16
ci_018                 1.555715e-02 3 1  ON 17
ci_019                 1.526027e-02 3 1  ON 18
ci_020                 1.568116e-02 3 1  ON 19
ci_021                 1.560212e-02 3 1  ON 20
ci_022                 1.464638e-02 3 1  ON 21
ci_023                 1.371891e-02 3 1  ON 22
ci_024                 1.217059e-02 3 1  ON 23
ci_025                 1.253582e-02 3 1  ON 24
ci_026                 1.345601e-02 3 1  ON 25
ci_027                 1.412066e-02 3 1  ON 26
ci_028                -1.546208e-02 3 1  ON 27
ci_029                -1.540037e-02 3 1  ON 28
ci_030                -1.180347e-02 3 1  ON 29
ci_031                -1.159362e-02 3 1  ON 30
ci_032                -1.389970e-02 3 1  ON 31
ci_033                 1.073881e-02 3 1  ON 32
ci_034                 1.067344e-02 3 1  ON 33
ci_035                -6.753205e-03 3 1  ON 34
ci_036                -1.202594e-02 3 1  ON 35
ci_037                -1.213915e-02 3 1  ON 36
ci_038                 2.644793e-03 3 1  ON 37
ci_039                 3.171811e-03 3 1  ON 38
ci_040                -6.083312e-03 3 1  ON 39
ci_041                 1.049553e-02 3 1  ON 40
ci_042                 1.060428e-02 3 1  ON 41
ci_043                -5.216630e-03 3 1  ON 42
ci_044                -1.547067e-02 3 1  ON 43
ci_045                -3.694440e-03 3 1  ON 44
ci_046                 6.534529e-03 3 1  ON 45
ci_047                 6.767265e-03 3 1  ON 46
ci_048                -1.202576e-02 3 1  ON 47
ci_049                -1.188290e-02 3 1  ON 48
ci_050                 8.303302e-03 3 1  ON 49
ci_051                 8.535657e-03 3 1  ON 50
ci_052                -8.153243e-03 3 1  ON 51
ci_053                -8.332469e-03 3 1  ON 52
ci_054                -3.122997e-03 3 1  ON 53
ci_055                -3.637681e-03 3 1  ON 54
ci_056                 6.480233e-03 3 1  ON 55
ci_057                 6.482950e-03 3 1  ON 56
ci_058                -8.126141e-03 3 1  ON 57
ci_059                -8.392268e-03 3 1  ON 58
ci_060                 8.303286e-03 3 1  ON 59
ci_061                 9.050016e-03 3 1  ON 60
ci_062                -4.303667e-03 3 1  ON 61
ci_063                -4.234762e-03 3 1  ON 62
ci_064                -4.121979e-03 3 1  ON 63
ci_065                -5.316264e-03 3 1  ON 64
ci_066                 6.538188e-03 3 1  ON 65
ci_067                 6.321417e-03 3 1  ON 66
ci_068                -5.284213e-03 3 1  ON 67
ci_069                -5.478548e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2001
    reference variance = 0.298056
====================================================
  Execution time = 1.4272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1127e-01
  Total weights = 1.956092161e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294876715799
                                         uncertainty =       0.003857067424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294876715799
                                         uncertainty =       0.003857067424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383945986
  error estimate for blocks of size 2^( 2) =       0.000395533546
  error estimate for blocks of size 2^( 3) =       0.000406000825
  error estimate for blocks of size 2^( 4) =       0.000412822071
  error estimate for blocks of size 2^( 5) =       0.000416926296
  error estimate for blocks of size 2^( 6) =       0.000419587123
  error estimate for blocks of size 2^( 7) =       0.000420463783

      target function =                  N/A
              le_mean =     -17.214196188448
             les_mean =     296.639822235970
             stat err =       0.000417449818
             autocorr =       1.182138300632
              std dev =       0.542981621113
             le_variance =       0.294829040866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721419618845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214196188462       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214186998461       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214190390924       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214190109911       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214190100669       residual = 5.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 1.287194e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214196188462       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214190989635       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214192253876       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214192212320       residual = 5.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 7.008318e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214196188462       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214194289125       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214194502432       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.485923e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6731e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.462256e-02 3 1  ON 0
ci_002                -3.371636e-02 3 1  ON 1
ci_003                -2.721264e-02 3 1  ON 2
ci_004                 2.435902e-02 3 1  ON 3
ci_005                 2.404374e-02 3 1  ON 4
ci_006                -2.225037e-02 3 1  ON 5
ci_007                -2.266454e-02 3 1  ON 6
ci_008                -2.021400e-02 3 1  ON 7
ci_009                -1.980478e-02 3 1  ON 8
ci_010                -1.853948e-02 3 1  ON 9
ci_011                -1.858959e-02 3 1  ON 10
ci_012                -1.816562e-02 3 1  ON 11
ci_013                -2.060176e-02 3 1  ON 12
ci_014                 1.657239e-02 3 1  ON 13
ci_015                 1.612888e-02 3 1  ON 14
ci_016                 1.724201e-02 3 1  ON 15
ci_017                 1.723161e-02 3 1  ON 16
ci_018                 1.554720e-02 3 1  ON 17
ci_019                 1.521280e-02 3 1  ON 18
ci_020                 1.559425e-02 3 1  ON 19
ci_021                 1.564529e-02 3 1  ON 20
ci_022                 1.442928e-02 3 1  ON 21
ci_023                 1.357526e-02 3 1  ON 22
ci_024                 1.182664e-02 3 1  ON 23
ci_025                 1.268695e-02 3 1  ON 24
ci_026                 1.366757e-02 3 1  ON 25
ci_027                 1.426014e-02 3 1  ON 26
ci_028                -1.540868e-02 3 1  ON 27
ci_029                -1.499396e-02 3 1  ON 28
ci_030                -1.157535e-02 3 1  ON 29
ci_031                -1.169697e-02 3 1  ON 30
ci_032                -1.423706e-02 3 1  ON 31
ci_033                 1.061199e-02 3 1  ON 32
ci_034                 1.077786e-02 3 1  ON 33
ci_035                -7.060380e-03 3 1  ON 34
ci_036                -1.223574e-02 3 1  ON 35
ci_037                -1.212215e-02 3 1  ON 36
ci_038                 3.010371e-03 3 1  ON 37
ci_039                 3.158557e-03 3 1  ON 38
ci_040                -5.786011e-03 3 1  ON 39
ci_041                 1.036071e-02 3 1  ON 40
ci_042                 1.046323e-02 3 1  ON 41
ci_043                -5.116282e-03 3 1  ON 42
ci_044                -1.578966e-02 3 1  ON 43
ci_045                -3.742071e-03 3 1  ON 44
ci_046                 6.619803e-03 3 1  ON 45
ci_047                 6.841568e-03 3 1  ON 46
ci_048                -1.203135e-02 3 1  ON 47
ci_049                -1.179763e-02 3 1  ON 48
ci_050                 8.470574e-03 3 1  ON 49
ci_051                 8.623488e-03 3 1  ON 50
ci_052                -8.443989e-03 3 1  ON 51
ci_053                -8.027670e-03 3 1  ON 52
ci_054                -3.202222e-03 3 1  ON 53
ci_055                -3.635928e-03 3 1  ON 54
ci_056                 6.607310e-03 3 1  ON 55
ci_057                 6.187205e-03 3 1  ON 56
ci_058                -8.409871e-03 3 1  ON 57
ci_059                -8.364975e-03 3 1  ON 58
ci_060                 8.386030e-03 3 1  ON 59
ci_061                 8.349185e-03 3 1  ON 60
ci_062                -4.454442e-03 3 1  ON 61
ci_063                -3.955802e-03 3 1  ON 62
ci_064                -4.157691e-03 3 1  ON 63
ci_065                -5.584864e-03 3 1  ON 64
ci_066                 6.496980e-03 3 1  ON 65
ci_067                 6.282771e-03 3 1  ON 66
ci_068                -5.508341e-03 3 1  ON 67
ci_069                -5.421614e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1415
    reference variance = 0.3704
====================================================
  Execution time = 1.3816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0549e-01
  Total weights = 1.9561e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293290593411
                                         uncertainty =       0.002156440382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293290593411
                                         uncertainty =       0.002156440382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382878703
  error estimate for blocks of size 2^( 2) =       0.000394406699
  error estimate for blocks of size 2^( 3) =       0.000404849142
  error estimate for blocks of size 2^( 4) =       0.000411873924
  error estimate for blocks of size 2^( 5) =       0.000416979180
  error estimate for blocks of size 2^( 6) =       0.000419070847
  error estimate for blocks of size 2^( 7) =       0.000421312477

      target function =                  N/A
              le_mean =     -17.214290124158
             les_mean =     296.638653507369
             stat err =       0.000417309107
             autocorr =       1.187936717417
              std dev =       0.541472253846
             le_variance =       0.293192201685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293429124923
                                         uncertainty =       0.002140357954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293429124923
                                         uncertainty =       0.002140357954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382968958
  error estimate for blocks of size 2^( 2) =       0.000394503867
  error estimate for blocks of size 2^( 3) =       0.000404961074
  error estimate for blocks of size 2^( 4) =       0.000412007192
  error estimate for blocks of size 2^( 5) =       0.000417111432
  error estimate for blocks of size 2^( 6) =       0.000419173774
  error estimate for blocks of size 2^( 7) =       0.000421450208

      target function =                  N/A
              le_mean =     -17.214284672035
             les_mean =     296.642158497273
             stat err =       0.000417435652
             autocorr =       1.188097080420
              std dev =       0.541599894814
             le_variance =       0.293330446063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293474964082
                                         uncertainty =       0.002136934172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293474964082
                                         uncertainty =       0.002136934172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382998848
  error estimate for blocks of size 2^( 2) =       0.000394532254
  error estimate for blocks of size 2^( 3) =       0.000404987640
  error estimate for blocks of size 2^( 4) =       0.000412038283
  error estimate for blocks of size 2^( 5) =       0.000417138100
  error estimate for blocks of size 2^( 6) =       0.000419192570
  error estimate for blocks of size 2^( 7) =       0.000421466121

      target function =                  N/A
              le_mean =     -17.214284677833
             les_mean =     296.641581628146
             stat err =       0.000417458768
             autocorr =       1.188043220980
              std dev =       0.541642164605
             le_variance =       0.293376234478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293285458008
                                         uncertainty =       0.002151565620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293285458008
                                         uncertainty =       0.002151565620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382875321
  error estimate for blocks of size 2^( 2) =       0.000394403696
  error estimate for blocks of size 2^( 3) =       0.000404848514
  error estimate for blocks of size 2^( 4) =       0.000411876963
  error estimate for blocks of size 2^( 5) =       0.000416982958
  error estimate for blocks of size 2^( 6) =       0.000419063657
  error estimate for blocks of size 2^( 7) =       0.000421311540

      target function =                  N/A
              le_mean =     -17.214285642201
             les_mean =     296.638808032308
             stat err =       0.000417308779
             autocorr =       1.187955835540
              std dev =       0.541467471749
             le_variance =       0.293187022962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214290124158        initial  <--
     9.3132e-02     9.3132e-01             1.2872e-03       -17.214284672035
     3.7253e-01     3.7253e+00             7.0083e-04       -17.214284677833
     1.4901e+00     1.4901e+01             2.4859e-04       -17.214285642201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9571
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.451008e-02 3 1  ON 0
ci_002                -3.397242e-02 3 1  ON 1
ci_003                -2.692111e-02 3 1  ON 2
ci_004                 2.423722e-02 3 1  ON 3
ci_005                 2.407144e-02 3 1  ON 4
ci_006                -2.248636e-02 3 1  ON 5
ci_007                -2.281590e-02 3 1  ON 6
ci_008                -2.003780e-02 3 1  ON 7
ci_009                -1.995288e-02 3 1  ON 8
ci_010                -1.865697e-02 3 1  ON 9
ci_011                -1.851530e-02 3 1  ON 10
ci_012                -1.856706e-02 3 1  ON 11
ci_013                -2.036217e-02 3 1  ON 12
ci_014                 1.680777e-02 3 1  ON 13
ci_015                 1.627286e-02 3 1  ON 14
ci_016                 1.684579e-02 3 1  ON 15
ci_017                 1.750483e-02 3 1  ON 16
ci_018                 1.555715e-02 3 1  ON 17
ci_019                 1.526027e-02 3 1  ON 18
ci_020                 1.568116e-02 3 1  ON 19
ci_021                 1.560212e-02 3 1  ON 20
ci_022                 1.464638e-02 3 1  ON 21
ci_023                 1.371891e-02 3 1  ON 22
ci_024                 1.217059e-02 3 1  ON 23
ci_025                 1.253582e-02 3 1  ON 24
ci_026                 1.345601e-02 3 1  ON 25
ci_027                 1.412066e-02 3 1  ON 26
ci_028                -1.546208e-02 3 1  ON 27
ci_029                -1.540037e-02 3 1  ON 28
ci_030                -1.180347e-02 3 1  ON 29
ci_031                -1.159362e-02 3 1  ON 30
ci_032                -1.389970e-02 3 1  ON 31
ci_033                 1.073881e-02 3 1  ON 32
ci_034                 1.067344e-02 3 1  ON 33
ci_035                -6.753205e-03 3 1  ON 34
ci_036                -1.202594e-02 3 1  ON 35
ci_037                -1.213915e-02 3 1  ON 36
ci_038                 2.644793e-03 3 1  ON 37
ci_039                 3.171811e-03 3 1  ON 38
ci_040                -6.083312e-03 3 1  ON 39
ci_041                 1.049553e-02 3 1  ON 40
ci_042                 1.060428e-02 3 1  ON 41
ci_043                -5.216630e-03 3 1  ON 42
ci_044                -1.547067e-02 3 1  ON 43
ci_045                -3.694440e-03 3 1  ON 44
ci_046                 6.534529e-03 3 1  ON 45
ci_047                 6.767265e-03 3 1  ON 46
ci_048                -1.202576e-02 3 1  ON 47
ci_049                -1.188290e-02 3 1  ON 48
ci_050                 8.303302e-03 3 1  ON 49
ci_051                 8.535657e-03 3 1  ON 50
ci_052                -8.153243e-03 3 1  ON 51
ci_053                -8.332469e-03 3 1  ON 52
ci_054                -3.122997e-03 3 1  ON 53
ci_055                -3.637681e-03 3 1  ON 54
ci_056                 6.480233e-03 3 1  ON 55
ci_057                 6.482950e-03 3 1  ON 56
ci_058                -8.126141e-03 3 1  ON 57
ci_059                -8.392268e-03 3 1  ON 58
ci_060                 8.303286e-03 3 1  ON 59
ci_061                 9.050016e-03 3 1  ON 60
ci_062                -4.303667e-03 3 1  ON 61
ci_063                -4.234762e-03 3 1  ON 62
ci_064                -4.121979e-03 3 1  ON 63
ci_065                -5.316264e-03 3 1  ON 64
ci_066                 6.538188e-03 3 1  ON 65
ci_067                 6.321417e-03 3 1  ON 66
ci_068                -5.284213e-03 3 1  ON 67
ci_069                -5.478548e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.323411
====================================================
  Execution time = 1.4212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0320e-01
  Total weights = 1.956260549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290766230108
                                         uncertainty =       0.001831881975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290766230108
                                         uncertainty =       0.001831881975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381299813
  error estimate for blocks of size 2^( 2) =       0.000393081490
  error estimate for blocks of size 2^( 3) =       0.000403388668
  error estimate for blocks of size 2^( 4) =       0.000410096751
  error estimate for blocks of size 2^( 5) =       0.000414789443
  error estimate for blocks of size 2^( 6) =       0.000418334542
  error estimate for blocks of size 2^( 7) =       0.000422252250

      target function =                  N/A
              le_mean =     -17.214152968339
             les_mean =     296.630265120459
             stat err =       0.000416368247
             autocorr =       1.192400137627
              std dev =       0.539239367539
             le_variance =       0.290779095503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721415296834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214152968334       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214155807125       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214155518842       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 3.580800e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214152968334       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214153814509       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214153799284       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 1.069865e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214152968334       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214153190561       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214153193100       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 2.810970e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6679e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.454596e-02 3 1  ON 0
ci_002                -3.399683e-02 3 1  ON 1
ci_003                -2.697415e-02 3 1  ON 2
ci_004                 2.419225e-02 3 1  ON 3
ci_005                 2.405536e-02 3 1  ON 4
ci_006                -2.245399e-02 3 1  ON 5
ci_007                -2.282663e-02 3 1  ON 6
ci_008                -2.008980e-02 3 1  ON 7
ci_009                -1.992335e-02 3 1  ON 8
ci_010                -1.865952e-02 3 1  ON 9
ci_011                -1.851482e-02 3 1  ON 10
ci_012                -1.855225e-02 3 1  ON 11
ci_013                -2.032854e-02 3 1  ON 12
ci_014                 1.682169e-02 3 1  ON 13
ci_015                 1.632169e-02 3 1  ON 14
ci_016                 1.685100e-02 3 1  ON 15
ci_017                 1.745903e-02 3 1  ON 16
ci_018                 1.554606e-02 3 1  ON 17
ci_019                 1.526443e-02 3 1  ON 18
ci_020                 1.563281e-02 3 1  ON 19
ci_021                 1.565643e-02 3 1  ON 20
ci_022                 1.453939e-02 3 1  ON 21
ci_023                 1.375756e-02 3 1  ON 22
ci_024                 1.216526e-02 3 1  ON 23
ci_025                 1.254202e-02 3 1  ON 24
ci_026                 1.348385e-02 3 1  ON 25
ci_027                 1.408562e-02 3 1  ON 26
ci_028                -1.541076e-02 3 1  ON 27
ci_029                -1.535638e-02 3 1  ON 28
ci_030                -1.174896e-02 3 1  ON 29
ci_031                -1.162694e-02 3 1  ON 30
ci_032                -1.390284e-02 3 1  ON 31
ci_033                 1.081790e-02 3 1  ON 32
ci_034                 1.061357e-02 3 1  ON 33
ci_035                -6.740598e-03 3 1  ON 34
ci_036                -1.204963e-02 3 1  ON 35
ci_037                -1.216753e-02 3 1  ON 36
ci_038                 2.667372e-03 3 1  ON 37
ci_039                 3.134784e-03 3 1  ON 38
ci_040                -6.054200e-03 3 1  ON 39
ci_041                 1.049335e-02 3 1  ON 40
ci_042                 1.059632e-02 3 1  ON 41
ci_043                -5.273691e-03 3 1  ON 42
ci_044                -1.546110e-02 3 1  ON 43
ci_045                -3.707159e-03 3 1  ON 44
ci_046                 6.526012e-03 3 1  ON 45
ci_047                 6.765977e-03 3 1  ON 46
ci_048                -1.200185e-02 3 1  ON 47
ci_049                -1.190159e-02 3 1  ON 48
ci_050                 8.321291e-03 3 1  ON 49
ci_051                 8.534030e-03 3 1  ON 50
ci_052                -8.119832e-03 3 1  ON 51
ci_053                -8.361086e-03 3 1  ON 52
ci_054                -3.149655e-03 3 1  ON 53
ci_055                -3.682242e-03 3 1  ON 54
ci_056                 6.439964e-03 3 1  ON 55
ci_057                 6.446570e-03 3 1  ON 56
ci_058                -8.149300e-03 3 1  ON 57
ci_059                -8.360969e-03 3 1  ON 58
ci_060                 8.271759e-03 3 1  ON 59
ci_061                 9.041748e-03 3 1  ON 60
ci_062                -4.265937e-03 3 1  ON 61
ci_063                -4.285764e-03 3 1  ON 62
ci_064                -4.161719e-03 3 1  ON 63
ci_065                -5.273025e-03 3 1  ON 64
ci_066                 6.502445e-03 3 1  ON 65
ci_067                 6.364995e-03 3 1  ON 66
ci_068                -5.322959e-03 3 1  ON 67
ci_069                -5.453066e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2061
    reference variance = 0.125477
====================================================
  Execution time = 1.3725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0793e-01
  Total weights = 1.9561e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293968538814
                                         uncertainty =       0.002573208492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293968538814
                                         uncertainty =       0.002573208492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383381454
  error estimate for blocks of size 2^( 2) =       0.000395478740
  error estimate for blocks of size 2^( 3) =       0.000405628976
  error estimate for blocks of size 2^( 4) =       0.000413236649
  error estimate for blocks of size 2^( 5) =       0.000417643155
  error estimate for blocks of size 2^( 6) =       0.000418320106
  error estimate for blocks of size 2^( 7) =       0.000419507643

      target function =                  N/A
              le_mean =     -17.213979240985
             les_mean =     296.629298260498
             stat err =       0.000417176888
             autocorr =       1.184072461882
              std dev =       0.542183251849
             le_variance =       0.293962678585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294002838447
                                         uncertainty =       0.002512838993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294002838447
                                         uncertainty =       0.002512838993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383403401
  error estimate for blocks of size 2^( 2) =       0.000395500928
  error estimate for blocks of size 2^( 3) =       0.000405655324
  error estimate for blocks of size 2^( 4) =       0.000413262600
  error estimate for blocks of size 2^( 5) =       0.000417663522
  error estimate for blocks of size 2^( 6) =       0.000418336250
  error estimate for blocks of size 2^( 7) =       0.000419524320

      target function =                  N/A
              le_mean =     -17.213979427492
             les_mean =     296.639506326393
             stat err =       0.000417196673
             autocorr =       1.184049208573
              std dev =       0.542214289416
             le_variance =       0.293996335647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293979414987
                                         uncertainty =       0.002535075113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293979414987
                                         uncertainty =       0.002535075113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383388283
  error estimate for blocks of size 2^( 2) =       0.000395486098
  error estimate for blocks of size 2^( 3) =       0.000405639221
  error estimate for blocks of size 2^( 4) =       0.000413247009
  error estimate for blocks of size 2^( 5) =       0.000417650192
  error estimate for blocks of size 2^( 6) =       0.000418328516
  error estimate for blocks of size 2^( 7) =       0.000419514753

      target function =                  N/A
              le_mean =     -17.213979584021
             les_mean =     296.628986363550
             stat err =       0.000417185118
             autocorr =       1.184076995809
              std dev =       0.542192908863
             le_variance =       0.293973150421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293969816076
                                         uncertainty =       0.002568116528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293969816076
                                         uncertainty =       0.002568116528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383382251
  error estimate for blocks of size 2^( 2) =       0.000395478920
  error estimate for blocks of size 2^( 3) =       0.000405629257
  error estimate for blocks of size 2^( 4) =       0.000413237606
  error estimate for blocks of size 2^( 5) =       0.000417643267
  error estimate for blocks of size 2^( 6) =       0.000418319431
  error estimate for blocks of size 2^( 7) =       0.000419506101

      target function =                  N/A
              le_mean =     -17.213978466171
             les_mean =     296.657395613616
             stat err =       0.000417176601
             autocorr =       1.184065911190
              std dev =       0.542184378454
             le_variance =       0.293963900240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213979240985        initial
     9.3132e-01     9.3132e+00             3.5808e-04       -17.213979427492
     3.7253e+00     3.7253e+01             1.0699e-04       -17.213979584021  <--
     1.4901e+01     1.4901e+02             2.8110e-05       -17.213978466171

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.2955e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.454596e-02 3 1  ON 0
ci_002                -3.399683e-02 3 1  ON 1
ci_003                -2.697415e-02 3 1  ON 2
ci_004                 2.419225e-02 3 1  ON 3
ci_005                 2.405536e-02 3 1  ON 4
ci_006                -2.245399e-02 3 1  ON 5
ci_007                -2.282663e-02 3 1  ON 6
ci_008                -2.008980e-02 3 1  ON 7
ci_009                -1.992335e-02 3 1  ON 8
ci_010                -1.865952e-02 3 1  ON 9
ci_011                -1.851482e-02 3 1  ON 10
ci_012                -1.855225e-02 3 1  ON 11
ci_013                -2.032854e-02 3 1  ON 12
ci_014                 1.682169e-02 3 1  ON 13
ci_015                 1.632169e-02 3 1  ON 14
ci_016                 1.685100e-02 3 1  ON 15
ci_017                 1.745903e-02 3 1  ON 16
ci_018                 1.554606e-02 3 1  ON 17
ci_019                 1.526443e-02 3 1  ON 18
ci_020                 1.563281e-02 3 1  ON 19
ci_021                 1.565643e-02 3 1  ON 20
ci_022                 1.453939e-02 3 1  ON 21
ci_023                 1.375756e-02 3 1  ON 22
ci_024                 1.216526e-02 3 1  ON 23
ci_025                 1.254202e-02 3 1  ON 24
ci_026                 1.348385e-02 3 1  ON 25
ci_027                 1.408562e-02 3 1  ON 26
ci_028                -1.541076e-02 3 1  ON 27
ci_029                -1.535638e-02 3 1  ON 28
ci_030                -1.174896e-02 3 1  ON 29
ci_031                -1.162694e-02 3 1  ON 30
ci_032                -1.390284e-02 3 1  ON 31
ci_033                 1.081790e-02 3 1  ON 32
ci_034                 1.061357e-02 3 1  ON 33
ci_035                -6.740598e-03 3 1  ON 34
ci_036                -1.204963e-02 3 1  ON 35
ci_037                -1.216753e-02 3 1  ON 36
ci_038                 2.667372e-03 3 1  ON 37
ci_039                 3.134784e-03 3 1  ON 38
ci_040                -6.054200e-03 3 1  ON 39
ci_041                 1.049335e-02 3 1  ON 40
ci_042                 1.059632e-02 3 1  ON 41
ci_043                -5.273691e-03 3 1  ON 42
ci_044                -1.546110e-02 3 1  ON 43
ci_045                -3.707159e-03 3 1  ON 44
ci_046                 6.526012e-03 3 1  ON 45
ci_047                 6.765977e-03 3 1  ON 46
ci_048                -1.200185e-02 3 1  ON 47
ci_049                -1.190159e-02 3 1  ON 48
ci_050                 8.321291e-03 3 1  ON 49
ci_051                 8.534030e-03 3 1  ON 50
ci_052                -8.119832e-03 3 1  ON 51
ci_053                -8.361086e-03 3 1  ON 52
ci_054                -3.149655e-03 3 1  ON 53
ci_055                -3.682242e-03 3 1  ON 54
ci_056                 6.439964e-03 3 1  ON 55
ci_057                 6.446570e-03 3 1  ON 56
ci_058                -8.149300e-03 3 1  ON 57
ci_059                -8.360969e-03 3 1  ON 58
ci_060                 8.271759e-03 3 1  ON 59
ci_061                 9.041748e-03 3 1  ON 60
ci_062                -4.265937e-03 3 1  ON 61
ci_063                -4.285764e-03 3 1  ON 62
ci_064                -4.161719e-03 3 1  ON 63
ci_065                -5.273025e-03 3 1  ON 64
ci_066                 6.502445e-03 3 1  ON 65
ci_067                 6.364995e-03 3 1  ON 66
ci_068                -5.322959e-03 3 1  ON 67
ci_069                -5.453066e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.226759
====================================================
  Execution time = 1.4140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1435e-01
  Total weights = 1.956195093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297327640413
                                         uncertainty =       0.002288873896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297327640413
                                         uncertainty =       0.002288873896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385520525
  error estimate for blocks of size 2^( 2) =       0.000397160797
  error estimate for blocks of size 2^( 3) =       0.000407878488
  error estimate for blocks of size 2^( 4) =       0.000415079078
  error estimate for blocks of size 2^( 5) =       0.000419178595
  error estimate for blocks of size 2^( 6) =       0.000421982053
  error estimate for blocks of size 2^( 7) =       0.000422392434

      target function =                  N/A
              le_mean =     -17.214243914354
             les_mean =     296.644545110766
             stat err =       0.000419658040
             autocorr =       1.184939253142
              std dev =       0.545208355074
             le_variance =       0.297252150443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721424391435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214243914353       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214246116539       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214246116519       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 2.091161e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214243914353       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214244561748       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214244613458       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 6.186360e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214243914353       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214244083647       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214244101337       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 1.621769e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6631e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.450258e-02 3 1  ON 0
ci_002                -3.400002e-02 3 1  ON 1
ci_003                -2.701825e-02 3 1  ON 2
ci_004                 2.415306e-02 3 1  ON 3
ci_005                 2.406118e-02 3 1  ON 4
ci_006                -2.250169e-02 3 1  ON 5
ci_007                -2.280831e-02 3 1  ON 6
ci_008                -2.007942e-02 3 1  ON 7
ci_009                -1.992748e-02 3 1  ON 8
ci_010                -1.863991e-02 3 1  ON 9
ci_011                -1.850510e-02 3 1  ON 10
ci_012                -1.854933e-02 3 1  ON 11
ci_013                -2.028192e-02 3 1  ON 12
ci_014                 1.683631e-02 3 1  ON 13
ci_015                 1.634760e-02 3 1  ON 14
ci_016                 1.686361e-02 3 1  ON 15
ci_017                 1.742288e-02 3 1  ON 16
ci_018                 1.550864e-02 3 1  ON 17
ci_019                 1.524959e-02 3 1  ON 18
ci_020                 1.565539e-02 3 1  ON 19
ci_021                 1.565423e-02 3 1  ON 20
ci_022                 1.448586e-02 3 1  ON 21
ci_023                 1.374475e-02 3 1  ON 22
ci_024                 1.222176e-02 3 1  ON 23
ci_025                 1.251449e-02 3 1  ON 24
ci_026                 1.353406e-02 3 1  ON 25
ci_027                 1.408474e-02 3 1  ON 26
ci_028                -1.542503e-02 3 1  ON 27
ci_029                -1.535039e-02 3 1  ON 28
ci_030                -1.170879e-02 3 1  ON 29
ci_031                -1.166595e-02 3 1  ON 30
ci_032                -1.393204e-02 3 1  ON 31
ci_033                 1.081231e-02 3 1  ON 32
ci_034                 1.064945e-02 3 1  ON 33
ci_035                -6.766937e-03 3 1  ON 34
ci_036                -1.204591e-02 3 1  ON 35
ci_037                -1.217176e-02 3 1  ON 36
ci_038                 2.671261e-03 3 1  ON 37
ci_039                 3.141314e-03 3 1  ON 38
ci_040                -6.026472e-03 3 1  ON 39
ci_041                 1.049926e-02 3 1  ON 40
ci_042                 1.060208e-02 3 1  ON 41
ci_043                -5.263362e-03 3 1  ON 42
ci_044                -1.541065e-02 3 1  ON 43
ci_045                -3.721288e-03 3 1  ON 44
ci_046                 6.555878e-03 3 1  ON 45
ci_047                 6.812024e-03 3 1  ON 46
ci_048                -1.205736e-02 3 1  ON 47
ci_049                -1.190823e-02 3 1  ON 48
ci_050                 8.367950e-03 3 1  ON 49
ci_051                 8.556434e-03 3 1  ON 50
ci_052                -8.084565e-03 3 1  ON 51
ci_053                -8.367176e-03 3 1  ON 52
ci_054                -3.181715e-03 3 1  ON 53
ci_055                -3.656480e-03 3 1  ON 54
ci_056                 6.393594e-03 3 1  ON 55
ci_057                 6.425285e-03 3 1  ON 56
ci_058                -8.119388e-03 3 1  ON 57
ci_059                -8.372706e-03 3 1  ON 58
ci_060                 8.297988e-03 3 1  ON 59
ci_061                 8.979884e-03 3 1  ON 60
ci_062                -4.285837e-03 3 1  ON 61
ci_063                -4.334618e-03 3 1  ON 62
ci_064                -4.173653e-03 3 1  ON 63
ci_065                -5.264858e-03 3 1  ON 64
ci_066                 6.503947e-03 3 1  ON 65
ci_067                 6.385249e-03 3 1  ON 66
ci_068                -5.310485e-03 3 1  ON 67
ci_069                -5.438887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2851
    reference variance = 0.356423
====================================================
  Execution time = 1.3760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0805e-01
  Total weights = 1.9562e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292755657079
                                         uncertainty =       0.001920657935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292755657079
                                         uncertainty =       0.001920657935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382627102
  error estimate for blocks of size 2^( 2) =       0.000394291533
  error estimate for blocks of size 2^( 3) =       0.000404659119
  error estimate for blocks of size 2^( 4) =       0.000412002636
  error estimate for blocks of size 2^( 5) =       0.000417549594
  error estimate for blocks of size 2^( 6) =       0.000420292031
  error estimate for blocks of size 2^( 7) =       0.000422440942

      target function =                  N/A
              le_mean =     -17.213772481766
             les_mean =     296.623116750862
             stat err =       0.000418071301
             autocorr =       1.193848600749
              std dev =       0.541116437109
             le_variance =       0.292806998510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292670975006
                                         uncertainty =       0.001921541128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292670975006
                                         uncertainty =       0.001921541128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382570905
  error estimate for blocks of size 2^( 2) =       0.000394239412
  error estimate for blocks of size 2^( 3) =       0.000404610100
  error estimate for blocks of size 2^( 4) =       0.000411957846
  error estimate for blocks of size 2^( 5) =       0.000417504114
  error estimate for blocks of size 2^( 6) =       0.000420243098
  error estimate for blocks of size 2^( 7) =       0.000422395778

      target function =                  N/A
              le_mean =     -17.213774587763
             les_mean =     296.621713249982
             stat err =       0.000418025209
             autocorr =       1.193936058477
              std dev =       0.541036962593
             le_variance =       0.292720994892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292702340732
                                         uncertainty =       0.001921106467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292702340732
                                         uncertainty =       0.001921106467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382591763
  error estimate for blocks of size 2^( 2) =       0.000394258596
  error estimate for blocks of size 2^( 3) =       0.000404628008
  error estimate for blocks of size 2^( 4) =       0.000411973856
  error estimate for blocks of size 2^( 5) =       0.000417520364
  error estimate for blocks of size 2^( 6) =       0.000420260772
  error estimate for blocks of size 2^( 7) =       0.000422411423

      target function =                  N/A
              le_mean =     -17.213773294071
             les_mean =     296.621971468012
             stat err =       0.000418041604
             autocorr =       1.193899524560
              std dev =       0.541066459701
             le_variance =       0.292752913813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292748061429
                                         uncertainty =       0.001920706873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292748061429
                                         uncertainty =       0.001920706873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382622073
  error estimate for blocks of size 2^( 2) =       0.000394286826
  error estimate for blocks of size 2^( 3) =       0.000404654648
  error estimate for blocks of size 2^( 4) =       0.000411998579
  error estimate for blocks of size 2^( 5) =       0.000417545503
  error estimate for blocks of size 2^( 6) =       0.000420287742
  error estimate for blocks of size 2^( 7) =       0.000422436757

      target function =                  N/A
              le_mean =     -17.213772457287
             les_mean =     296.622559390560
             stat err =       0.000418067145
             autocorr =       1.193856251148
              std dev =       0.541109324674
             le_variance =       0.292799301249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213772481766        initial
     9.3132e-01     9.3132e+00             2.0912e-04       -17.213774587763  <--
     3.7253e+00     3.7253e+01             6.1864e-05       -17.213773294071
     1.4901e+01     1.4901e+02             1.6218e-05       -17.213772457287

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.2886e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.439420e-02 3 1  ON 0
ci_002                -3.400817e-02 3 1  ON 1
ci_003                -2.712983e-02 3 1  ON 2
ci_004                 2.405295e-02 3 1  ON 3
ci_005                 2.406954e-02 3 1  ON 4
ci_006                -2.262061e-02 3 1  ON 5
ci_007                -2.276483e-02 3 1  ON 6
ci_008                -2.005574e-02 3 1  ON 7
ci_009                -1.993827e-02 3 1  ON 8
ci_010                -1.859298e-02 3 1  ON 9
ci_011                -1.848348e-02 3 1  ON 10
ci_012                -1.854391e-02 3 1  ON 11
ci_013                -2.016112e-02 3 1  ON 12
ci_014                 1.687042e-02 3 1  ON 13
ci_015                 1.640948e-02 3 1  ON 14
ci_016                 1.689492e-02 3 1  ON 15
ci_017                 1.733388e-02 3 1  ON 16
ci_018                 1.541922e-02 3 1  ON 17
ci_019                 1.521536e-02 3 1  ON 18
ci_020                 1.570976e-02 3 1  ON 19
ci_021                 1.564882e-02 3 1  ON 20
ci_022                 1.436032e-02 3 1  ON 21
ci_023                 1.371345e-02 3 1  ON 22
ci_024                 1.236903e-02 3 1  ON 23
ci_025                 1.244537e-02 3 1  ON 24
ci_026                 1.365502e-02 3 1  ON 25
ci_027                 1.408289e-02 3 1  ON 26
ci_028                -1.545870e-02 3 1  ON 27
ci_029                -1.533565e-02 3 1  ON 28
ci_030                -1.161319e-02 3 1  ON 29
ci_031                -1.175885e-02 3 1  ON 30
ci_032                -1.400180e-02 3 1  ON 31
ci_033                 1.079703e-02 3 1  ON 32
ci_034                 1.073561e-02 3 1  ON 33
ci_035                -6.822516e-03 3 1  ON 34
ci_036                -1.203796e-02 3 1  ON 35
ci_037                -1.218003e-02 3 1  ON 36
ci_038                 2.679445e-03 3 1  ON 37
ci_039                 3.154526e-03 3 1  ON 38
ci_040                -5.970546e-03 3 1  ON 39
ci_041                 1.051491e-02 3 1  ON 40
ci_042                 1.061558e-02 3 1  ON 41
ci_043                -5.241484e-03 3 1  ON 42
ci_044                -1.528050e-02 3 1  ON 43
ci_045                -3.751109e-03 3 1  ON 44
ci_046                 6.625242e-03 3 1  ON 45
ci_047                 6.919476e-03 3 1  ON 46
ci_048                -1.219898e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470680e-03 3 1  ON 49
ci_051                 8.605855e-03 3 1  ON 50
ci_052                -8.005445e-03 3 1  ON 51
ci_053                -8.380760e-03 3 1  ON 52
ci_054                -3.254086e-03 3 1  ON 53
ci_055                -3.597254e-03 3 1  ON 54
ci_056                 6.291427e-03 3 1  ON 55
ci_057                 6.378326e-03 3 1  ON 56
ci_058                -8.050931e-03 3 1  ON 57
ci_059                -8.400330e-03 3 1  ON 58
ci_060                 8.360504e-03 3 1  ON 59
ci_061                 8.832632e-03 3 1  ON 60
ci_062                -4.331049e-03 3 1  ON 61
ci_063                -4.446273e-03 3 1  ON 62
ci_064                -4.195673e-03 3 1  ON 63
ci_065                -5.249370e-03 3 1  ON 64
ci_066                 6.507897e-03 3 1  ON 65
ci_067                 6.428176e-03 3 1  ON 66
ci_068                -5.280238e-03 3 1  ON 67
ci_069                -5.406133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9528e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2531
    reference variance = 0.223467
====================================================
  Execution time = 1.4224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0713e-01
  Total weights = 1.956261778e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293756311833
                                         uncertainty =       0.002136459409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293756311833
                                         uncertainty =       0.002136459409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383317602
  error estimate for blocks of size 2^( 2) =       0.000394960357
  error estimate for blocks of size 2^( 3) =       0.000405242036
  error estimate for blocks of size 2^( 4) =       0.000412440953
  error estimate for blocks of size 2^( 5) =       0.000416666328
  error estimate for blocks of size 2^( 6) =       0.000418155578
  error estimate for blocks of size 2^( 7) =       0.000421866390

      target function =                  N/A
              le_mean =     -17.214893061502
             les_mean =     296.659675924983
             stat err =       0.000417282312
             autocorr =       1.185065699666
              std dev =       0.542092950780
             le_variance =       0.293864767285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721489306150e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214893061509       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214895263382       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214896337995       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214896306068       residual = 9.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 6.764342e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214893061509       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214893977545       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214894415249       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 2.656097e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214893061509       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214893336108       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214893459053       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 8.254785e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6687e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.444653e-02 3 1  ON 0
ci_002                -3.393005e-02 3 1  ON 1
ci_003                -2.721123e-02 3 1  ON 2
ci_004                 2.392717e-02 3 1  ON 3
ci_005                 2.408602e-02 3 1  ON 4
ci_006                -2.264488e-02 3 1  ON 5
ci_007                -2.272324e-02 3 1  ON 6
ci_008                -2.006572e-02 3 1  ON 7
ci_009                -1.991861e-02 3 1  ON 8
ci_010                -1.851812e-02 3 1  ON 9
ci_011                -1.840040e-02 3 1  ON 10
ci_012                -1.848801e-02 3 1  ON 11
ci_013                -2.012044e-02 3 1  ON 12
ci_014                 1.665919e-02 3 1  ON 13
ci_015                 1.651873e-02 3 1  ON 14
ci_016                 1.696769e-02 3 1  ON 15
ci_017                 1.721337e-02 3 1  ON 16
ci_018                 1.541331e-02 3 1  ON 17
ci_019                 1.528032e-02 3 1  ON 18
ci_020                 1.561221e-02 3 1  ON 19
ci_021                 1.560046e-02 3 1  ON 20
ci_022                 1.428242e-02 3 1  ON 21
ci_023                 1.360810e-02 3 1  ON 22
ci_024                 1.236182e-02 3 1  ON 23
ci_025                 1.248399e-02 3 1  ON 24
ci_026                 1.360614e-02 3 1  ON 25
ci_027                 1.411595e-02 3 1  ON 26
ci_028                -1.527575e-02 3 1  ON 27
ci_029                -1.533207e-02 3 1  ON 28
ci_030                -1.144823e-02 3 1  ON 29
ci_031                -1.167444e-02 3 1  ON 30
ci_032                -1.397830e-02 3 1  ON 31
ci_033                 1.090369e-02 3 1  ON 32
ci_034                 1.064817e-02 3 1  ON 33
ci_035                -6.873497e-03 3 1  ON 34
ci_036                -1.212083e-02 3 1  ON 35
ci_037                -1.240882e-02 3 1  ON 36
ci_038                 2.780658e-03 3 1  ON 37
ci_039                 3.165805e-03 3 1  ON 38
ci_040                -6.055156e-03 3 1  ON 39
ci_041                 1.053089e-02 3 1  ON 40
ci_042                 1.051371e-02 3 1  ON 41
ci_043                -5.280445e-03 3 1  ON 42
ci_044                -1.518139e-02 3 1  ON 43
ci_045                -3.604902e-03 3 1  ON 44
ci_046                 6.551209e-03 3 1  ON 45
ci_047                 7.059407e-03 3 1  ON 46
ci_048                -1.244152e-02 3 1  ON 47
ci_049                -1.181752e-02 3 1  ON 48
ci_050                 8.450245e-03 3 1  ON 49
ci_051                 8.638724e-03 3 1  ON 50
ci_052                -8.065907e-03 3 1  ON 51
ci_053                -8.269525e-03 3 1  ON 52
ci_054                -3.309999e-03 3 1  ON 53
ci_055                -3.584847e-03 3 1  ON 54
ci_056                 6.025818e-03 3 1  ON 55
ci_057                 6.370755e-03 3 1  ON 56
ci_058                -8.086117e-03 3 1  ON 57
ci_059                -8.356630e-03 3 1  ON 58
ci_060                 8.399188e-03 3 1  ON 59
ci_061                 8.756295e-03 3 1  ON 60
ci_062                -4.189493e-03 3 1  ON 61
ci_063                -4.364528e-03 3 1  ON 62
ci_064                -4.373056e-03 3 1  ON 63
ci_065                -5.130362e-03 3 1  ON 64
ci_066                 6.576883e-03 3 1  ON 65
ci_067                 6.328501e-03 3 1  ON 66
ci_068                -5.321220e-03 3 1  ON 67
ci_069                -5.248454e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.181687
====================================================
  Execution time = 1.3743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0683e-01
  Total weights = 1.9559e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292808269445
                                         uncertainty =       0.001987959746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292808269445
                                         uncertainty =       0.001987959746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382644920
  error estimate for blocks of size 2^( 2) =       0.000394481260
  error estimate for blocks of size 2^( 3) =       0.000405035093
  error estimate for blocks of size 2^( 4) =       0.000412022632
  error estimate for blocks of size 2^( 5) =       0.000416104109
  error estimate for blocks of size 2^( 6) =       0.000418736965
  error estimate for blocks of size 2^( 7) =       0.000420733584

      target function =                  N/A
              le_mean =     -17.214010877644
             les_mean =     296.656474595077
             stat err =       0.000416899322
             autocorr =       1.187053995854
              std dev =       0.541141635570
             le_variance =       0.292834269747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292529278077
                                         uncertainty =       0.001978292561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292529278077
                                         uncertainty =       0.001978292561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382465531
  error estimate for blocks of size 2^( 2) =       0.000394328312
  error estimate for blocks of size 2^( 3) =       0.000404894136
  error estimate for blocks of size 2^( 4) =       0.000411892388
  error estimate for blocks of size 2^( 5) =       0.000415999999
  error estimate for blocks of size 2^( 6) =       0.000418633228
  error estimate for blocks of size 2^( 7) =       0.000420612228

      target function =                  N/A
              le_mean =     -17.214005363930
             les_mean =     296.645564961431
             stat err =       0.000416784461
             autocorr =       1.187513168550
              std dev =       0.540887941521
             le_variance =       0.292559765283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292562721789
                                         uncertainty =       0.001979700515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292562721789
                                         uncertainty =       0.001979700515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382487034
  error estimate for blocks of size 2^( 2) =       0.000394346965
  error estimate for blocks of size 2^( 3) =       0.000404909576
  error estimate for blocks of size 2^( 4) =       0.000411906806
  error estimate for blocks of size 2^( 5) =       0.000416004818
  error estimate for blocks of size 2^( 6) =       0.000418636917
  error estimate for blocks of size 2^( 7) =       0.000420606953

      target function =                  N/A
              le_mean =     -17.214006257999
             les_mean =     296.629254663101
             stat err =       0.000416788873
             autocorr =       1.187404795058
              std dev =       0.540918350767
             le_variance =       0.292592662196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292763906651
                                         uncertainty =       0.001986587786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292763906651
                                         uncertainty =       0.001986587786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382616331
  error estimate for blocks of size 2^( 2) =       0.000394455824
  error estimate for blocks of size 2^( 3) =       0.000405010140
  error estimate for blocks of size 2^( 4) =       0.000411999041
  error estimate for blocks of size 2^( 5) =       0.000416088687
  error estimate for blocks of size 2^( 6) =       0.000418721768
  error estimate for blocks of size 2^( 7) =       0.000420712699

      target function =                  N/A
              le_mean =     -17.214009514440
             les_mean =     296.629428079886
             stat err =       0.000416880549
             autocorr =       1.187124471751
              std dev =       0.541101204509
             le_variance =       0.292790513521


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214010877644        initial  <--
     2.3283e-01     2.3283e+00             6.7643e-04       -17.214005363930
     9.3132e-01     9.3132e+00             2.6561e-04       -17.214006257999
     3.7253e+00     3.7253e+01             8.2548e-05       -17.214009514440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8903
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.439420e-02 3 1  ON 0
ci_002                -3.400817e-02 3 1  ON 1
ci_003                -2.712983e-02 3 1  ON 2
ci_004                 2.405295e-02 3 1  ON 3
ci_005                 2.406954e-02 3 1  ON 4
ci_006                -2.262061e-02 3 1  ON 5
ci_007                -2.276483e-02 3 1  ON 6
ci_008                -2.005574e-02 3 1  ON 7
ci_009                -1.993827e-02 3 1  ON 8
ci_010                -1.859298e-02 3 1  ON 9
ci_011                -1.848348e-02 3 1  ON 10
ci_012                -1.854391e-02 3 1  ON 11
ci_013                -2.016112e-02 3 1  ON 12
ci_014                 1.687042e-02 3 1  ON 13
ci_015                 1.640948e-02 3 1  ON 14
ci_016                 1.689492e-02 3 1  ON 15
ci_017                 1.733388e-02 3 1  ON 16
ci_018                 1.541922e-02 3 1  ON 17
ci_019                 1.521536e-02 3 1  ON 18
ci_020                 1.570976e-02 3 1  ON 19
ci_021                 1.564882e-02 3 1  ON 20
ci_022                 1.436032e-02 3 1  ON 21
ci_023                 1.371345e-02 3 1  ON 22
ci_024                 1.236903e-02 3 1  ON 23
ci_025                 1.244537e-02 3 1  ON 24
ci_026                 1.365502e-02 3 1  ON 25
ci_027                 1.408289e-02 3 1  ON 26
ci_028                -1.545870e-02 3 1  ON 27
ci_029                -1.533565e-02 3 1  ON 28
ci_030                -1.161319e-02 3 1  ON 29
ci_031                -1.175885e-02 3 1  ON 30
ci_032                -1.400180e-02 3 1  ON 31
ci_033                 1.079703e-02 3 1  ON 32
ci_034                 1.073561e-02 3 1  ON 33
ci_035                -6.822516e-03 3 1  ON 34
ci_036                -1.203796e-02 3 1  ON 35
ci_037                -1.218003e-02 3 1  ON 36
ci_038                 2.679445e-03 3 1  ON 37
ci_039                 3.154526e-03 3 1  ON 38
ci_040                -5.970546e-03 3 1  ON 39
ci_041                 1.051491e-02 3 1  ON 40
ci_042                 1.061558e-02 3 1  ON 41
ci_043                -5.241484e-03 3 1  ON 42
ci_044                -1.528050e-02 3 1  ON 43
ci_045                -3.751109e-03 3 1  ON 44
ci_046                 6.625242e-03 3 1  ON 45
ci_047                 6.919476e-03 3 1  ON 46
ci_048                -1.219898e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470680e-03 3 1  ON 49
ci_051                 8.605855e-03 3 1  ON 50
ci_052                -8.005445e-03 3 1  ON 51
ci_053                -8.380760e-03 3 1  ON 52
ci_054                -3.254086e-03 3 1  ON 53
ci_055                -3.597254e-03 3 1  ON 54
ci_056                 6.291427e-03 3 1  ON 55
ci_057                 6.378326e-03 3 1  ON 56
ci_058                -8.050931e-03 3 1  ON 57
ci_059                -8.400330e-03 3 1  ON 58
ci_060                 8.360504e-03 3 1  ON 59
ci_061                 8.832632e-03 3 1  ON 60
ci_062                -4.331049e-03 3 1  ON 61
ci_063                -4.446273e-03 3 1  ON 62
ci_064                -4.195673e-03 3 1  ON 63
ci_065                -5.249370e-03 3 1  ON 64
ci_066                 6.507897e-03 3 1  ON 65
ci_067                 6.428176e-03 3 1  ON 66
ci_068                -5.280238e-03 3 1  ON 67
ci_069                -5.406133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9583e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.297904
====================================================
  Execution time = 1.4135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0752e-01
  Total weights = 1.956339148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294116734543
                                         uncertainty =       0.002393731401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294116734543
                                         uncertainty =       0.002393731401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383451350
  error estimate for blocks of size 2^( 2) =       0.000395177549
  error estimate for blocks of size 2^( 3) =       0.000405252898
  error estimate for blocks of size 2^( 4) =       0.000413106177
  error estimate for blocks of size 2^( 5) =       0.000418072038
  error estimate for blocks of size 2^( 6) =       0.000421978116
  error estimate for blocks of size 2^( 7) =       0.000420840974

      target function =                  N/A
              le_mean =     -17.214655368457
             les_mean =     296.651882301744
             stat err =       0.000418499326
             autocorr =       1.191156937874
              std dev =       0.542282099410
             le_variance =       0.294069875340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721465536846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214655368481       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214656824739       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214656791923       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 1.182314e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214655368481       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214655760426       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214655747783       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 3.108631e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214655368481       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214655468380       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214655464919       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 7.875154e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6602e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.439844e-02 3 1  ON 0
ci_002                -3.400616e-02 3 1  ON 1
ci_003                -2.713622e-02 3 1  ON 2
ci_004                 2.405811e-02 3 1  ON 3
ci_005                 2.406008e-02 3 1  ON 4
ci_006                -2.260754e-02 3 1  ON 5
ci_007                -2.275741e-02 3 1  ON 6
ci_008                -2.006250e-02 3 1  ON 7
ci_009                -1.993459e-02 3 1  ON 8
ci_010                -1.857586e-02 3 1  ON 9
ci_011                -1.850660e-02 3 1  ON 10
ci_012                -1.851853e-02 3 1  ON 11
ci_013                -2.013480e-02 3 1  ON 12
ci_014                 1.686301e-02 3 1  ON 13
ci_015                 1.640748e-02 3 1  ON 14
ci_016                 1.689564e-02 3 1  ON 15
ci_017                 1.733095e-02 3 1  ON 16
ci_018                 1.541392e-02 3 1  ON 17
ci_019                 1.521891e-02 3 1  ON 18
ci_020                 1.570416e-02 3 1  ON 19
ci_021                 1.565656e-02 3 1  ON 20
ci_022                 1.434433e-02 3 1  ON 21
ci_023                 1.373085e-02 3 1  ON 22
ci_024                 1.237719e-02 3 1  ON 23
ci_025                 1.246026e-02 3 1  ON 24
ci_026                 1.366202e-02 3 1  ON 25
ci_027                 1.406936e-02 3 1  ON 26
ci_028                -1.546605e-02 3 1  ON 27
ci_029                -1.533416e-02 3 1  ON 28
ci_030                -1.159211e-02 3 1  ON 29
ci_031                -1.175888e-02 3 1  ON 30
ci_032                -1.400124e-02 3 1  ON 31
ci_033                 1.081208e-02 3 1  ON 32
ci_034                 1.073686e-02 3 1  ON 33
ci_035                -6.829485e-03 3 1  ON 34
ci_036                -1.204892e-02 3 1  ON 35
ci_037                -1.218717e-02 3 1  ON 36
ci_038                 2.687218e-03 3 1  ON 37
ci_039                 3.139399e-03 3 1  ON 38
ci_040                -5.968021e-03 3 1  ON 39
ci_041                 1.051289e-02 3 1  ON 40
ci_042                 1.062139e-02 3 1  ON 41
ci_043                -5.239809e-03 3 1  ON 42
ci_044                -1.524942e-02 3 1  ON 43
ci_045                -3.747332e-03 3 1  ON 44
ci_046                 6.613340e-03 3 1  ON 45
ci_047                 6.907690e-03 3 1  ON 46
ci_048                -1.219611e-02 3 1  ON 47
ci_049                -1.193317e-02 3 1  ON 48
ci_050                 8.484382e-03 3 1  ON 49
ci_051                 8.591041e-03 3 1  ON 50
ci_052                -8.004805e-03 3 1  ON 51
ci_053                -8.368134e-03 3 1  ON 52
ci_054                -3.244836e-03 3 1  ON 53
ci_055                -3.588559e-03 3 1  ON 54
ci_056                 6.277742e-03 3 1  ON 55
ci_057                 6.364007e-03 3 1  ON 56
ci_058                -8.052385e-03 3 1  ON 57
ci_059                -8.404894e-03 3 1  ON 58
ci_060                 8.363637e-03 3 1  ON 59
ci_061                 8.816163e-03 3 1  ON 60
ci_062                -4.324039e-03 3 1  ON 61
ci_063                -4.446214e-03 3 1  ON 62
ci_064                -4.191653e-03 3 1  ON 63
ci_065                -5.222744e-03 3 1  ON 64
ci_066                 6.490585e-03 3 1  ON 65
ci_067                 6.433469e-03 3 1  ON 66
ci_068                -5.285437e-03 3 1  ON 67
ci_069                -5.391801e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.224085
====================================================
  Execution time = 1.3753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0648e-01
  Total weights = 1.9560e+06
  Execution time = 1.8226e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292886481639
                                         uncertainty =       0.001987638776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292886481639
                                         uncertainty =       0.001987638776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382748311
  error estimate for blocks of size 2^( 2) =       0.000394772208
  error estimate for blocks of size 2^( 3) =       0.000405197015
  error estimate for blocks of size 2^( 4) =       0.000412375257
  error estimate for blocks of size 2^( 5) =       0.000417326007
  error estimate for blocks of size 2^( 6) =       0.000420600885
  error estimate for blocks of size 2^( 7) =       0.000423755691

      target function =                  N/A
              le_mean =     -17.214632657813
             les_mean =     296.650071172957
             stat err =       0.000418514460
             autocorr =       1.195623302250
              std dev =       0.541287852093
             le_variance =       0.292992538823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292819940276
                                         uncertainty =       0.001988081846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292819940276
                                         uncertainty =       0.001988081846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382705189
  error estimate for blocks of size 2^( 2) =       0.000394732005
  error estimate for blocks of size 2^( 3) =       0.000405161384
  error estimate for blocks of size 2^( 4) =       0.000412340339
  error estimate for blocks of size 2^( 5) =       0.000417291504
  error estimate for blocks of size 2^( 6) =       0.000420569491
  error estimate for blocks of size 2^( 7) =       0.000423721115

      target function =                  N/A
              le_mean =     -17.214631223833
             les_mean =     296.649985334990
             stat err =       0.000418480612
             autocorr =       1.195699322112
              std dev =       0.541226868959
             le_variance =       0.292926523683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292849626291
                                         uncertainty =       0.001987842938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292849626291
                                         uncertainty =       0.001987842938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382724431
  error estimate for blocks of size 2^( 2) =       0.000394749936
  error estimate for blocks of size 2^( 3) =       0.000405177256
  error estimate for blocks of size 2^( 4) =       0.000412355895
  error estimate for blocks of size 2^( 5) =       0.000417306868
  error estimate for blocks of size 2^( 6) =       0.000420583419
  error estimate for blocks of size 2^( 7) =       0.000423736549

      target function =                  N/A
              le_mean =     -17.214631806334
             les_mean =     296.650048649254
             stat err =       0.000418495683
             autocorr =       1.195665207921
              std dev =       0.541254081168
             le_variance =       0.292955980381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292881686555
                                         uncertainty =       0.001987662510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292881686555
                                         uncertainty =       0.001987662510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382745204
  error estimate for blocks of size 2^( 2) =       0.000394769308
  error estimate for blocks of size 2^( 3) =       0.000405194437
  error estimate for blocks of size 2^( 4) =       0.000412372731
  error estimate for blocks of size 2^( 5) =       0.000417323507
  error estimate for blocks of size 2^( 6) =       0.000420598604
  error estimate for blocks of size 2^( 7) =       0.000423753199

      target function =                  N/A
              le_mean =     -17.214632537814
             les_mean =     296.650062651453
             stat err =       0.000418512010
             autocorr =       1.195628715900
              std dev =       0.541283458012
             le_variance =       0.292987781917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214632657813        initial  <--
     2.3283e+00     2.3283e+01             1.1823e-04       -17.214631223833
     9.3132e+00     9.3132e+01             3.1086e-05       -17.214631806334
     3.7253e+01     3.7253e+02             7.8752e-06       -17.214632537814

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9682
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.439420e-02 3 1  ON 0
ci_002                -3.400817e-02 3 1  ON 1
ci_003                -2.712983e-02 3 1  ON 2
ci_004                 2.405295e-02 3 1  ON 3
ci_005                 2.406954e-02 3 1  ON 4
ci_006                -2.262061e-02 3 1  ON 5
ci_007                -2.276483e-02 3 1  ON 6
ci_008                -2.005574e-02 3 1  ON 7
ci_009                -1.993827e-02 3 1  ON 8
ci_010                -1.859298e-02 3 1  ON 9
ci_011                -1.848348e-02 3 1  ON 10
ci_012                -1.854391e-02 3 1  ON 11
ci_013                -2.016112e-02 3 1  ON 12
ci_014                 1.687042e-02 3 1  ON 13
ci_015                 1.640948e-02 3 1  ON 14
ci_016                 1.689492e-02 3 1  ON 15
ci_017                 1.733388e-02 3 1  ON 16
ci_018                 1.541922e-02 3 1  ON 17
ci_019                 1.521536e-02 3 1  ON 18
ci_020                 1.570976e-02 3 1  ON 19
ci_021                 1.564882e-02 3 1  ON 20
ci_022                 1.436032e-02 3 1  ON 21
ci_023                 1.371345e-02 3 1  ON 22
ci_024                 1.236903e-02 3 1  ON 23
ci_025                 1.244537e-02 3 1  ON 24
ci_026                 1.365502e-02 3 1  ON 25
ci_027                 1.408289e-02 3 1  ON 26
ci_028                -1.545870e-02 3 1  ON 27
ci_029                -1.533565e-02 3 1  ON 28
ci_030                -1.161319e-02 3 1  ON 29
ci_031                -1.175885e-02 3 1  ON 30
ci_032                -1.400180e-02 3 1  ON 31
ci_033                 1.079703e-02 3 1  ON 32
ci_034                 1.073561e-02 3 1  ON 33
ci_035                -6.822516e-03 3 1  ON 34
ci_036                -1.203796e-02 3 1  ON 35
ci_037                -1.218003e-02 3 1  ON 36
ci_038                 2.679445e-03 3 1  ON 37
ci_039                 3.154526e-03 3 1  ON 38
ci_040                -5.970546e-03 3 1  ON 39
ci_041                 1.051491e-02 3 1  ON 40
ci_042                 1.061558e-02 3 1  ON 41
ci_043                -5.241484e-03 3 1  ON 42
ci_044                -1.528050e-02 3 1  ON 43
ci_045                -3.751109e-03 3 1  ON 44
ci_046                 6.625242e-03 3 1  ON 45
ci_047                 6.919476e-03 3 1  ON 46
ci_048                -1.219898e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470680e-03 3 1  ON 49
ci_051                 8.605855e-03 3 1  ON 50
ci_052                -8.005445e-03 3 1  ON 51
ci_053                -8.380760e-03 3 1  ON 52
ci_054                -3.254086e-03 3 1  ON 53
ci_055                -3.597254e-03 3 1  ON 54
ci_056                 6.291427e-03 3 1  ON 55
ci_057                 6.378326e-03 3 1  ON 56
ci_058                -8.050931e-03 3 1  ON 57
ci_059                -8.400330e-03 3 1  ON 58
ci_060                 8.360504e-03 3 1  ON 59
ci_061                 8.832632e-03 3 1  ON 60
ci_062                -4.331049e-03 3 1  ON 61
ci_063                -4.446273e-03 3 1  ON 62
ci_064                -4.195673e-03 3 1  ON 63
ci_065                -5.249370e-03 3 1  ON 64
ci_066                 6.507897e-03 3 1  ON 65
ci_067                 6.428176e-03 3 1  ON 66
ci_068                -5.280238e-03 3 1  ON 67
ci_069                -5.406133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.0903
    reference variance = 0.257189
====================================================
  Execution time = 1.4176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1427e-01
  Total weights = 1.956076202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298946497983
                                         uncertainty =       0.005315130476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298946497983
                                         uncertainty =       0.005315130476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386567143
  error estimate for blocks of size 2^( 2) =       0.000398361848
  error estimate for blocks of size 2^( 3) =       0.000408776781
  error estimate for blocks of size 2^( 4) =       0.000416791132
  error estimate for blocks of size 2^( 5) =       0.000420745222
  error estimate for blocks of size 2^( 6) =       0.000423907786
  error estimate for blocks of size 2^( 7) =       0.000426423143

      target function =                  N/A
              le_mean =     -17.214276070961
             les_mean =     296.645568946275
             stat err =       0.000421966821
             autocorr =       1.191534805823
              std dev =       0.546688496034
             le_variance =       0.298868311696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721427607096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214276070944       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214276107863       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214276116408       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.430619e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214276070944       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214276080252       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214276082565       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.620535e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214276070944       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214276073276       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214276073866       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 9.079203e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8804e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.439249e-02 3 1  ON 0
ci_002                -3.400788e-02 3 1  ON 1
ci_003                -2.713103e-02 3 1  ON 2
ci_004                 2.405438e-02 3 1  ON 3
ci_005                 2.407059e-02 3 1  ON 4
ci_006                -2.262142e-02 3 1  ON 5
ci_007                -2.276480e-02 3 1  ON 6
ci_008                -2.005455e-02 3 1  ON 7
ci_009                -1.993528e-02 3 1  ON 8
ci_010                -1.859136e-02 3 1  ON 9
ci_011                -1.848285e-02 3 1  ON 10
ci_012                -1.854230e-02 3 1  ON 11
ci_013                -2.016128e-02 3 1  ON 12
ci_014                 1.686980e-02 3 1  ON 13
ci_015                 1.640719e-02 3 1  ON 14
ci_016                 1.689231e-02 3 1  ON 15
ci_017                 1.733176e-02 3 1  ON 16
ci_018                 1.541969e-02 3 1  ON 17
ci_019                 1.521648e-02 3 1  ON 18
ci_020                 1.570936e-02 3 1  ON 19
ci_021                 1.564756e-02 3 1  ON 20
ci_022                 1.435920e-02 3 1  ON 21
ci_023                 1.371223e-02 3 1  ON 22
ci_024                 1.236971e-02 3 1  ON 23
ci_025                 1.244709e-02 3 1  ON 24
ci_026                 1.365430e-02 3 1  ON 25
ci_027                 1.408181e-02 3 1  ON 26
ci_028                -1.545877e-02 3 1  ON 27
ci_029                -1.533422e-02 3 1  ON 28
ci_030                -1.161269e-02 3 1  ON 29
ci_031                -1.175783e-02 3 1  ON 30
ci_032                -1.400213e-02 3 1  ON 31
ci_033                 1.079745e-02 3 1  ON 32
ci_034                 1.073632e-02 3 1  ON 33
ci_035                -6.826137e-03 3 1  ON 34
ci_036                -1.204061e-02 3 1  ON 35
ci_037                -1.218115e-02 3 1  ON 36
ci_038                 2.679825e-03 3 1  ON 37
ci_039                 3.152935e-03 3 1  ON 38
ci_040                -5.970352e-03 3 1  ON 39
ci_041                 1.051406e-02 3 1  ON 40
ci_042                 1.061529e-02 3 1  ON 41
ci_043                -5.240256e-03 3 1  ON 42
ci_044                -1.528237e-02 3 1  ON 43
ci_045                -3.751651e-03 3 1  ON 44
ci_046                 6.625286e-03 3 1  ON 45
ci_047                 6.920250e-03 3 1  ON 46
ci_048                -1.219998e-02 3 1  ON 47
ci_049                -1.192538e-02 3 1  ON 48
ci_050                 8.470651e-03 3 1  ON 49
ci_051                 8.603641e-03 3 1  ON 50
ci_052                -8.004452e-03 3 1  ON 51
ci_053                -8.381076e-03 3 1  ON 52
ci_054                -3.256988e-03 3 1  ON 53
ci_055                -3.597045e-03 3 1  ON 54
ci_056                 6.292905e-03 3 1  ON 55
ci_057                 6.377388e-03 3 1  ON 56
ci_058                -8.052973e-03 3 1  ON 57
ci_059                -8.399262e-03 3 1  ON 58
ci_060                 8.361485e-03 3 1  ON 59
ci_061                 8.833081e-03 3 1  ON 60
ci_062                -4.328966e-03 3 1  ON 61
ci_063                -4.445566e-03 3 1  ON 62
ci_064                -4.196031e-03 3 1  ON 63
ci_065                -5.247588e-03 3 1  ON 64
ci_066                 6.507271e-03 3 1  ON 65
ci_067                 6.427695e-03 3 1  ON 66
ci_068                -5.280916e-03 3 1  ON 67
ci_069                -5.406311e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2581
    reference variance = 0.297703
====================================================
  Execution time = 1.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0867e-01
  Total weights = 1.9563e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293749487604
                                         uncertainty =       0.002465106628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293749487604
                                         uncertainty =       0.002465106628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383273822
  error estimate for blocks of size 2^( 2) =       0.000394911417
  error estimate for blocks of size 2^( 3) =       0.000405531452
  error estimate for blocks of size 2^( 4) =       0.000413951142
  error estimate for blocks of size 2^( 5) =       0.000418758452
  error estimate for blocks of size 2^( 6) =       0.000422234830
  error estimate for blocks of size 2^( 7) =       0.000422673907

      target function =                  N/A
              le_mean =     -17.214038765898
             les_mean =     296.631806920310
             stat err =       0.000419404583
             autocorr =       1.197424192475
              std dev =       0.542031037154
             le_variance =       0.293797645238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293732452937
                                         uncertainty =       0.002463985837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293732452937
                                         uncertainty =       0.002463985837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383262721
  error estimate for blocks of size 2^( 2) =       0.000394901010
  error estimate for blocks of size 2^( 3) =       0.000405521616
  error estimate for blocks of size 2^( 4) =       0.000413941874
  error estimate for blocks of size 2^( 5) =       0.000418749821
  error estimate for blocks of size 2^( 6) =       0.000422226493
  error estimate for blocks of size 2^( 7) =       0.000422666475

      target function =                  N/A
              le_mean =     -17.214038734666
             les_mean =     296.631773272043
             stat err =       0.000419396166
             autocorr =       1.197445493518
              std dev =       0.542015338487
             le_variance =       0.293780627155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293740874965
                                         uncertainty =       0.002464540607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293740874965
                                         uncertainty =       0.002464540607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383268210
  error estimate for blocks of size 2^( 2) =       0.000394906155
  error estimate for blocks of size 2^( 3) =       0.000405526478
  error estimate for blocks of size 2^( 4) =       0.000413946455
  error estimate for blocks of size 2^( 5) =       0.000418754086
  error estimate for blocks of size 2^( 6) =       0.000422230613
  error estimate for blocks of size 2^( 7) =       0.000422670147

      target function =                  N/A
              le_mean =     -17.214038749027
             les_mean =     296.631789579454
             stat err =       0.000419400326
             autocorr =       1.197434951479
              std dev =       0.542023100067
             le_variance =       0.293789041006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293748406992
                                         uncertainty =       0.002465035637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293748406992
                                         uncertainty =       0.002465035637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383273118
  error estimate for blocks of size 2^( 2) =       0.000394910757
  error estimate for blocks of size 2^( 3) =       0.000405530828
  error estimate for blocks of size 2^( 4) =       0.000413950554
  error estimate for blocks of size 2^( 5) =       0.000418757904
  error estimate for blocks of size 2^( 6) =       0.000422234301
  error estimate for blocks of size 2^( 7) =       0.000422673435

      target function =                  N/A
              le_mean =     -17.214038763659
             les_mean =     296.631804712469
             stat err =       0.000419404048
             autocorr =       1.197425541126
              std dev =       0.542030041309
             le_variance =       0.293796565682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214038765898        initial  <--
     2.3283e+01     2.3283e+02             1.4306e-05       -17.214038734666
     9.3132e+01     9.3132e+02             3.6205e-06       -17.214038749027
     3.7253e+02     3.7253e+03             9.0792e-07       -17.214038763659

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8565
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.439420e-02 3 1  ON 0
ci_002                -3.400817e-02 3 1  ON 1
ci_003                -2.712983e-02 3 1  ON 2
ci_004                 2.405295e-02 3 1  ON 3
ci_005                 2.406954e-02 3 1  ON 4
ci_006                -2.262061e-02 3 1  ON 5
ci_007                -2.276483e-02 3 1  ON 6
ci_008                -2.005574e-02 3 1  ON 7
ci_009                -1.993827e-02 3 1  ON 8
ci_010                -1.859298e-02 3 1  ON 9
ci_011                -1.848348e-02 3 1  ON 10
ci_012                -1.854391e-02 3 1  ON 11
ci_013                -2.016112e-02 3 1  ON 12
ci_014                 1.687042e-02 3 1  ON 13
ci_015                 1.640948e-02 3 1  ON 14
ci_016                 1.689492e-02 3 1  ON 15
ci_017                 1.733388e-02 3 1  ON 16
ci_018                 1.541922e-02 3 1  ON 17
ci_019                 1.521536e-02 3 1  ON 18
ci_020                 1.570976e-02 3 1  ON 19
ci_021                 1.564882e-02 3 1  ON 20
ci_022                 1.436032e-02 3 1  ON 21
ci_023                 1.371345e-02 3 1  ON 22
ci_024                 1.236903e-02 3 1  ON 23
ci_025                 1.244537e-02 3 1  ON 24
ci_026                 1.365502e-02 3 1  ON 25
ci_027                 1.408289e-02 3 1  ON 26
ci_028                -1.545870e-02 3 1  ON 27
ci_029                -1.533565e-02 3 1  ON 28
ci_030                -1.161319e-02 3 1  ON 29
ci_031                -1.175885e-02 3 1  ON 30
ci_032                -1.400180e-02 3 1  ON 31
ci_033                 1.079703e-02 3 1  ON 32
ci_034                 1.073561e-02 3 1  ON 33
ci_035                -6.822516e-03 3 1  ON 34
ci_036                -1.203796e-02 3 1  ON 35
ci_037                -1.218003e-02 3 1  ON 36
ci_038                 2.679445e-03 3 1  ON 37
ci_039                 3.154526e-03 3 1  ON 38
ci_040                -5.970546e-03 3 1  ON 39
ci_041                 1.051491e-02 3 1  ON 40
ci_042                 1.061558e-02 3 1  ON 41
ci_043                -5.241484e-03 3 1  ON 42
ci_044                -1.528050e-02 3 1  ON 43
ci_045                -3.751109e-03 3 1  ON 44
ci_046                 6.625242e-03 3 1  ON 45
ci_047                 6.919476e-03 3 1  ON 46
ci_048                -1.219898e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470680e-03 3 1  ON 49
ci_051                 8.605855e-03 3 1  ON 50
ci_052                -8.005445e-03 3 1  ON 51
ci_053                -8.380760e-03 3 1  ON 52
ci_054                -3.254086e-03 3 1  ON 53
ci_055                -3.597254e-03 3 1  ON 54
ci_056                 6.291427e-03 3 1  ON 55
ci_057                 6.378326e-03 3 1  ON 56
ci_058                -8.050931e-03 3 1  ON 57
ci_059                -8.400330e-03 3 1  ON 58
ci_060                 8.360504e-03 3 1  ON 59
ci_061                 8.832632e-03 3 1  ON 60
ci_062                -4.331049e-03 3 1  ON 61
ci_063                -4.446273e-03 3 1  ON 62
ci_064                -4.195673e-03 3 1  ON 63
ci_065                -5.249370e-03 3 1  ON 64
ci_066                 6.507897e-03 3 1  ON 65
ci_067                 6.428176e-03 3 1  ON 66
ci_068                -5.280238e-03 3 1  ON 67
ci_069                -5.406133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1882
    reference variance = 0.274809
====================================================
  Execution time = 1.4107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0554e-01
  Total weights = 1.955953370e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291731729764
                                         uncertainty =       0.001789789172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291731729764
                                         uncertainty =       0.001789789172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381908736
  error estimate for blocks of size 2^( 2) =       0.000393461534
  error estimate for blocks of size 2^( 3) =       0.000403585868
  error estimate for blocks of size 2^( 4) =       0.000411242943
  error estimate for blocks of size 2^( 5) =       0.000415337236
  error estimate for blocks of size 2^( 6) =       0.000416685596
  error estimate for blocks of size 2^( 7) =       0.000416779111

      target function =                  N/A
              le_mean =     -17.214541196070
             les_mean =     296.645966437920
             stat err =       0.000415011222
             autocorr =       1.180865660622
              std dev =       0.540100514384
             le_variance =       0.291708565638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721454119607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214541196088       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214541198357       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214541201437       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214541201548       residual = 1.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.463046e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214541196088       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214541196655       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214541197427       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214541197454       residual = 1.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 3.660013e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214541196088       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214541196230       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214541196423       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214541196430       residual = 1.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 9.151532e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6585e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.439457e-02 3 1  ON 0
ci_002                -3.400816e-02 3 1  ON 1
ci_003                -2.712991e-02 3 1  ON 2
ci_004                 2.405300e-02 3 1  ON 3
ci_005                 2.406935e-02 3 1  ON 4
ci_006                -2.262057e-02 3 1  ON 5
ci_007                -2.276493e-02 3 1  ON 6
ci_008                -2.005569e-02 3 1  ON 7
ci_009                -1.993856e-02 3 1  ON 8
ci_010                -1.859285e-02 3 1  ON 9
ci_011                -1.848331e-02 3 1  ON 10
ci_012                -1.854372e-02 3 1  ON 11
ci_013                -2.016134e-02 3 1  ON 12
ci_014                 1.687030e-02 3 1  ON 13
ci_015                 1.640926e-02 3 1  ON 14
ci_016                 1.689511e-02 3 1  ON 15
ci_017                 1.733389e-02 3 1  ON 16
ci_018                 1.541933e-02 3 1  ON 17
ci_019                 1.521555e-02 3 1  ON 18
ci_020                 1.570983e-02 3 1  ON 19
ci_021                 1.564872e-02 3 1  ON 20
ci_022                 1.436045e-02 3 1  ON 21
ci_023                 1.371340e-02 3 1  ON 22
ci_024                 1.236889e-02 3 1  ON 23
ci_025                 1.244520e-02 3 1  ON 24
ci_026                 1.365510e-02 3 1  ON 25
ci_027                 1.408287e-02 3 1  ON 26
ci_028                -1.545852e-02 3 1  ON 27
ci_029                -1.533545e-02 3 1  ON 28
ci_030                -1.161310e-02 3 1  ON 29
ci_031                -1.175885e-02 3 1  ON 30
ci_032                -1.400198e-02 3 1  ON 31
ci_033                 1.079685e-02 3 1  ON 32
ci_034                 1.073573e-02 3 1  ON 33
ci_035                -6.822683e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217976e-02 3 1  ON 36
ci_038                 2.679414e-03 3 1  ON 37
ci_039                 3.154506e-03 3 1  ON 38
ci_040                -5.970624e-03 3 1  ON 39
ci_041                 1.051466e-02 3 1  ON 40
ci_042                 1.061549e-02 3 1  ON 41
ci_043                -5.241390e-03 3 1  ON 42
ci_044                -1.528031e-02 3 1  ON 43
ci_045                -3.751065e-03 3 1  ON 44
ci_046                 6.625288e-03 3 1  ON 45
ci_047                 6.919477e-03 3 1  ON 46
ci_048                -1.219899e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470615e-03 3 1  ON 49
ci_051                 8.605859e-03 3 1  ON 50
ci_052                -8.005628e-03 3 1  ON 51
ci_053                -8.380462e-03 3 1  ON 52
ci_054                -3.254341e-03 3 1  ON 53
ci_055                -3.597320e-03 3 1  ON 54
ci_056                 6.291460e-03 3 1  ON 55
ci_057                 6.378290e-03 3 1  ON 56
ci_058                -8.051153e-03 3 1  ON 57
ci_059                -8.400525e-03 3 1  ON 58
ci_060                 8.360752e-03 3 1  ON 59
ci_061                 8.832678e-03 3 1  ON 60
ci_062                -4.331073e-03 3 1  ON 61
ci_063                -4.446310e-03 3 1  ON 62
ci_064                -4.195749e-03 3 1  ON 63
ci_065                -5.249196e-03 3 1  ON 64
ci_066                 6.507910e-03 3 1  ON 65
ci_067                 6.428305e-03 3 1  ON 66
ci_068                -5.280330e-03 3 1  ON 67
ci_069                -5.405977e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.267833
====================================================
  Execution time = 1.3696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0568e-01
  Total weights = 1.9559e+06
  Execution time = 1.8157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921346963
                                         uncertainty =       0.002617100483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921346963
                                         uncertainty =       0.002617100483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382024991
  error estimate for blocks of size 2^( 2) =       0.000393611562
  error estimate for blocks of size 2^( 3) =       0.000404197044
  error estimate for blocks of size 2^( 4) =       0.000411203191
  error estimate for blocks of size 2^( 5) =       0.000415681025
  error estimate for blocks of size 2^( 6) =       0.000418476840
  error estimate for blocks of size 2^( 7) =       0.000418575226

      target function =                  N/A
              le_mean =     -17.213674728441
             les_mean =     296.616282150851
             stat err =       0.000415984071
             autocorr =       1.185686438335
              std dev =       0.540264923430
             le_variance =       0.291886187489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291920899074
                                         uncertainty =       0.002616728545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291920899074
                                         uncertainty =       0.002616728545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382024698
  error estimate for blocks of size 2^( 2) =       0.000393611300
  error estimate for blocks of size 2^( 3) =       0.000404196802
  error estimate for blocks of size 2^( 4) =       0.000411202973
  error estimate for blocks of size 2^( 5) =       0.000415680837
  error estimate for blocks of size 2^( 6) =       0.000418476623
  error estimate for blocks of size 2^( 7) =       0.000418574992

      target function =                  N/A
              le_mean =     -17.213674740011
             les_mean =     296.616310171082
             stat err =       0.000415983856
             autocorr =       1.185687034041
              std dev =       0.540264509312
             le_variance =       0.291885740022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921122669
                                         uncertainty =       0.002616914293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921122669
                                         uncertainty =       0.002616914293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382024844
  error estimate for blocks of size 2^( 2) =       0.000393611431
  error estimate for blocks of size 2^( 3) =       0.000404196923
  error estimate for blocks of size 2^( 4) =       0.000411203082
  error estimate for blocks of size 2^( 5) =       0.000415680931
  error estimate for blocks of size 2^( 6) =       0.000418476731
  error estimate for blocks of size 2^( 7) =       0.000418575108

      target function =                  N/A
              le_mean =     -17.213674734243
             les_mean =     296.616283233600
             stat err =       0.000415983963
             autocorr =       1.185686736377
              std dev =       0.540264716048
             le_variance =       0.291885963407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921318904
                                         uncertainty =       0.002617077200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291921318904
                                         uncertainty =       0.002617077200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382024973
  error estimate for blocks of size 2^( 2) =       0.000393611545
  error estimate for blocks of size 2^( 3) =       0.000404197029
  error estimate for blocks of size 2^( 4) =       0.000411203177
  error estimate for blocks of size 2^( 5) =       0.000415681014
  error estimate for blocks of size 2^( 6) =       0.000418476827
  error estimate for blocks of size 2^( 7) =       0.000418575211

      target function =                  N/A
              le_mean =     -17.213674729165
             les_mean =     296.616282161727
             stat err =       0.000415984057
             autocorr =       1.185686475598
              std dev =       0.540264897486
             le_variance =       0.291886159456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213674728441        initial
     2.3283e+02     2.3283e+03             1.4630e-06       -17.213674740011  <--
     9.3132e+02     9.3132e+03             3.6600e-07       -17.213674734243
     3.7253e+03     3.7253e+04             9.1515e-08       -17.213674729165

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.2812e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.439566e-02 3 1  ON 0
ci_002                -3.400814e-02 3 1  ON 1
ci_003                -2.713015e-02 3 1  ON 2
ci_004                 2.405316e-02 3 1  ON 3
ci_005                 2.406877e-02 3 1  ON 4
ci_006                -2.262046e-02 3 1  ON 5
ci_007                -2.276525e-02 3 1  ON 6
ci_008                -2.005554e-02 3 1  ON 7
ci_009                -1.993944e-02 3 1  ON 8
ci_010                -1.859246e-02 3 1  ON 9
ci_011                -1.848280e-02 3 1  ON 10
ci_012                -1.854314e-02 3 1  ON 11
ci_013                -2.016198e-02 3 1  ON 12
ci_014                 1.686993e-02 3 1  ON 13
ci_015                 1.640861e-02 3 1  ON 14
ci_016                 1.689568e-02 3 1  ON 15
ci_017                 1.733392e-02 3 1  ON 16
ci_018                 1.541966e-02 3 1  ON 17
ci_019                 1.521611e-02 3 1  ON 18
ci_020                 1.571005e-02 3 1  ON 19
ci_021                 1.564841e-02 3 1  ON 20
ci_022                 1.436083e-02 3 1  ON 21
ci_023                 1.371324e-02 3 1  ON 22
ci_024                 1.236846e-02 3 1  ON 23
ci_025                 1.244467e-02 3 1  ON 24
ci_026                 1.365536e-02 3 1  ON 25
ci_027                 1.408279e-02 3 1  ON 26
ci_028                -1.545799e-02 3 1  ON 27
ci_029                -1.533484e-02 3 1  ON 28
ci_030                -1.161280e-02 3 1  ON 29
ci_031                -1.175888e-02 3 1  ON 30
ci_032                -1.400251e-02 3 1  ON 31
ci_033                 1.079630e-02 3 1  ON 32
ci_034                 1.073608e-02 3 1  ON 33
ci_035                -6.823182e-03 3 1  ON 34
ci_036                -1.203756e-02 3 1  ON 35
ci_037                -1.217896e-02 3 1  ON 36
ci_038                 2.679318e-03 3 1  ON 37
ci_039                 3.154447e-03 3 1  ON 38
ci_040                -5.970859e-03 3 1  ON 39
ci_041                 1.051390e-02 3 1  ON 40
ci_042                 1.061523e-02 3 1  ON 41
ci_043                -5.241109e-03 3 1  ON 42
ci_044                -1.527975e-02 3 1  ON 43
ci_045                -3.750933e-03 3 1  ON 44
ci_046                 6.625424e-03 3 1  ON 45
ci_047                 6.919479e-03 3 1  ON 46
ci_048                -1.219902e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470418e-03 3 1  ON 49
ci_051                 8.605871e-03 3 1  ON 50
ci_052                -8.006175e-03 3 1  ON 51
ci_053                -8.379571e-03 3 1  ON 52
ci_054                -3.255105e-03 3 1  ON 53
ci_055                -3.597514e-03 3 1  ON 54
ci_056                 6.291559e-03 3 1  ON 55
ci_057                 6.378181e-03 3 1  ON 56
ci_058                -8.051820e-03 3 1  ON 57
ci_059                -8.401109e-03 3 1  ON 58
ci_060                 8.361494e-03 3 1  ON 59
ci_061                 8.832818e-03 3 1  ON 60
ci_062                -4.331148e-03 3 1  ON 61
ci_063                -4.446424e-03 3 1  ON 62
ci_064                -4.195976e-03 3 1  ON 63
ci_065                -5.248675e-03 3 1  ON 64
ci_066                 6.507949e-03 3 1  ON 65
ci_067                 6.428690e-03 3 1  ON 66
ci_068                -5.280605e-03 3 1  ON 67
ci_069                -5.405512e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.151
    reference variance = 0.319245
====================================================
  Execution time = 1.4184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0923e-01
  Total weights = 1.955958477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295772134196
                                         uncertainty =       0.002291873860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295772134196
                                         uncertainty =       0.002291873860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384545825
  error estimate for blocks of size 2^( 2) =       0.000396181649
  error estimate for blocks of size 2^( 3) =       0.000406659067
  error estimate for blocks of size 2^( 4) =       0.000413884210
  error estimate for blocks of size 2^( 5) =       0.000417148584
  error estimate for blocks of size 2^( 6) =       0.000418910154
  error estimate for blocks of size 2^( 7) =       0.000422087890

      target function =                  N/A
              le_mean =     -17.214370496425
             les_mean =     296.643784601111
             stat err =       0.000418007710
             autocorr =       1.181605167237
              std dev =       0.543829921565
             le_variance =       0.295750983589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721437049643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214370496455       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214370595618       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214370595273       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 5.707298e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214370496455       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214370521334       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214370521251       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.433053e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214370496455       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214370502680       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214370502659       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 3.586548e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6720e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.439573e-02 3 1  ON 0
ci_002                -3.400815e-02 3 1  ON 1
ci_003                -2.712965e-02 3 1  ON 2
ci_004                 2.405324e-02 3 1  ON 3
ci_005                 2.406908e-02 3 1  ON 4
ci_006                -2.262055e-02 3 1  ON 5
ci_007                -2.276484e-02 3 1  ON 6
ci_008                -2.005557e-02 3 1  ON 7
ci_009                -1.994051e-02 3 1  ON 8
ci_010                -1.859122e-02 3 1  ON 9
ci_011                -1.848230e-02 3 1  ON 10
ci_012                -1.854237e-02 3 1  ON 11
ci_013                -2.016267e-02 3 1  ON 12
ci_014                 1.686992e-02 3 1  ON 13
ci_015                 1.640965e-02 3 1  ON 14
ci_016                 1.689554e-02 3 1  ON 15
ci_017                 1.733433e-02 3 1  ON 16
ci_018                 1.542040e-02 3 1  ON 17
ci_019                 1.521486e-02 3 1  ON 18
ci_020                 1.570921e-02 3 1  ON 19
ci_021                 1.564743e-02 3 1  ON 20
ci_022                 1.436044e-02 3 1  ON 21
ci_023                 1.371299e-02 3 1  ON 22
ci_024                 1.236922e-02 3 1  ON 23
ci_025                 1.244547e-02 3 1  ON 24
ci_026                 1.365508e-02 3 1  ON 25
ci_027                 1.408272e-02 3 1  ON 26
ci_028                -1.545707e-02 3 1  ON 27
ci_029                -1.533392e-02 3 1  ON 28
ci_030                -1.161376e-02 3 1  ON 29
ci_031                -1.175899e-02 3 1  ON 30
ci_032                -1.400275e-02 3 1  ON 31
ci_033                 1.079590e-02 3 1  ON 32
ci_034                 1.073592e-02 3 1  ON 33
ci_035                -6.823416e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217925e-02 3 1  ON 36
ci_038                 2.680450e-03 3 1  ON 37
ci_039                 3.153942e-03 3 1  ON 38
ci_040                -5.970950e-03 3 1  ON 39
ci_041                 1.051427e-02 3 1  ON 40
ci_042                 1.061570e-02 3 1  ON 41
ci_043                -5.241314e-03 3 1  ON 42
ci_044                -1.527961e-02 3 1  ON 43
ci_045                -3.750446e-03 3 1  ON 44
ci_046                 6.626005e-03 3 1  ON 45
ci_047                 6.919493e-03 3 1  ON 46
ci_048                -1.219892e-02 3 1  ON 47
ci_049                -1.192533e-02 3 1  ON 48
ci_050                 8.470404e-03 3 1  ON 49
ci_051                 8.605936e-03 3 1  ON 50
ci_052                -8.005045e-03 3 1  ON 51
ci_053                -8.378192e-03 3 1  ON 52
ci_054                -3.255621e-03 3 1  ON 53
ci_055                -3.597532e-03 3 1  ON 54
ci_056                 6.290126e-03 3 1  ON 55
ci_057                 6.377629e-03 3 1  ON 56
ci_058                -8.052287e-03 3 1  ON 57
ci_059                -8.401294e-03 3 1  ON 58
ci_060                 8.361743e-03 3 1  ON 59
ci_061                 8.833183e-03 3 1  ON 60
ci_062                -4.330134e-03 3 1  ON 61
ci_063                -4.446239e-03 3 1  ON 62
ci_064                -4.197007e-03 3 1  ON 63
ci_065                -5.247531e-03 3 1  ON 64
ci_066                 6.507735e-03 3 1  ON 65
ci_067                 6.429054e-03 3 1  ON 66
ci_068                -5.281400e-03 3 1  ON 67
ci_069                -5.405244e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.3402
    reference variance = 0.369733
====================================================
  Execution time = 1.3721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0903e-01
  Total weights = 1.9561e+06
  Execution time = 1.8160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293383744580
                                         uncertainty =       0.001829931998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293383744580
                                         uncertainty =       0.001829931998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383014197
  error estimate for blocks of size 2^( 2) =       0.000394867606
  error estimate for blocks of size 2^( 3) =       0.000404988773
  error estimate for blocks of size 2^( 4) =       0.000412570357
  error estimate for blocks of size 2^( 5) =       0.000417522000
  error estimate for blocks of size 2^( 6) =       0.000418888724
  error estimate for blocks of size 2^( 7) =       0.000419713232

      target function =                  N/A
              le_mean =     -17.214691917440
             les_mean =     296.654643908098
             stat err =       0.000417173578
             autocorr =       1.186325440777
              std dev =       0.541663872618
             le_variance =       0.293399750899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293381149297
                                         uncertainty =       0.001829816445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293381149297
                                         uncertainty =       0.001829816445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383012494
  error estimate for blocks of size 2^( 2) =       0.000394866107
  error estimate for blocks of size 2^( 3) =       0.000404987397
  error estimate for blocks of size 2^( 4) =       0.000412569146
  error estimate for blocks of size 2^( 5) =       0.000417521039
  error estimate for blocks of size 2^( 6) =       0.000418887810
  error estimate for blocks of size 2^( 7) =       0.000419712338

      target function =                  N/A
              le_mean =     -17.214691855288
             les_mean =     296.654682993985
             stat err =       0.000417172583
             autocorr =       1.186330333827
              std dev =       0.541661463292
             le_variance =       0.293397140815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293382440058
                                         uncertainty =       0.001829873932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293382440058
                                         uncertainty =       0.001829873932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383013341
  error estimate for blocks of size 2^( 2) =       0.000394866852
  error estimate for blocks of size 2^( 3) =       0.000404988081
  error estimate for blocks of size 2^( 4) =       0.000412569748
  error estimate for blocks of size 2^( 5) =       0.000417521517
  error estimate for blocks of size 2^( 6) =       0.000418888264
  error estimate for blocks of size 2^( 7) =       0.000419712783

      target function =                  N/A
              le_mean =     -17.214691885972
             les_mean =     296.654658499677
             stat err =       0.000417173078
             autocorr =       1.186327901467
              std dev =       0.541662661589
             le_variance =       0.293398438960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293383581096
                                         uncertainty =       0.001829924723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293383581096
                                         uncertainty =       0.001829924723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383014090
  error estimate for blocks of size 2^( 2) =       0.000394867511
  error estimate for blocks of size 2^( 3) =       0.000404988687
  error estimate for blocks of size 2^( 4) =       0.000412570280
  error estimate for blocks of size 2^( 5) =       0.000417521940
  error estimate for blocks of size 2^( 6) =       0.000418888666
  error estimate for blocks of size 2^( 7) =       0.000419713176

      target function =                  N/A
              le_mean =     -17.214691913475
             les_mean =     296.654645294840
             stat err =       0.000417173516
             autocorr =       1.186325749206
              std dev =       0.541663720852
             le_variance =       0.293399586488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214691917440        initial  <--
     5.8208e+01     5.8208e+02             5.7073e-06       -17.214691855288
     2.3283e+02     2.3283e+03             1.4331e-06       -17.214691885972
     9.3132e+02     9.3132e+03             3.5865e-07       -17.214691913475

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8327
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.439566e-02 3 1  ON 0
ci_002                -3.400814e-02 3 1  ON 1
ci_003                -2.713015e-02 3 1  ON 2
ci_004                 2.405316e-02 3 1  ON 3
ci_005                 2.406877e-02 3 1  ON 4
ci_006                -2.262046e-02 3 1  ON 5
ci_007                -2.276525e-02 3 1  ON 6
ci_008                -2.005554e-02 3 1  ON 7
ci_009                -1.993944e-02 3 1  ON 8
ci_010                -1.859246e-02 3 1  ON 9
ci_011                -1.848280e-02 3 1  ON 10
ci_012                -1.854314e-02 3 1  ON 11
ci_013                -2.016198e-02 3 1  ON 12
ci_014                 1.686993e-02 3 1  ON 13
ci_015                 1.640861e-02 3 1  ON 14
ci_016                 1.689568e-02 3 1  ON 15
ci_017                 1.733392e-02 3 1  ON 16
ci_018                 1.541966e-02 3 1  ON 17
ci_019                 1.521611e-02 3 1  ON 18
ci_020                 1.571005e-02 3 1  ON 19
ci_021                 1.564841e-02 3 1  ON 20
ci_022                 1.436083e-02 3 1  ON 21
ci_023                 1.371324e-02 3 1  ON 22
ci_024                 1.236846e-02 3 1  ON 23
ci_025                 1.244467e-02 3 1  ON 24
ci_026                 1.365536e-02 3 1  ON 25
ci_027                 1.408279e-02 3 1  ON 26
ci_028                -1.545799e-02 3 1  ON 27
ci_029                -1.533484e-02 3 1  ON 28
ci_030                -1.161280e-02 3 1  ON 29
ci_031                -1.175888e-02 3 1  ON 30
ci_032                -1.400251e-02 3 1  ON 31
ci_033                 1.079630e-02 3 1  ON 32
ci_034                 1.073608e-02 3 1  ON 33
ci_035                -6.823182e-03 3 1  ON 34
ci_036                -1.203756e-02 3 1  ON 35
ci_037                -1.217896e-02 3 1  ON 36
ci_038                 2.679318e-03 3 1  ON 37
ci_039                 3.154447e-03 3 1  ON 38
ci_040                -5.970859e-03 3 1  ON 39
ci_041                 1.051390e-02 3 1  ON 40
ci_042                 1.061523e-02 3 1  ON 41
ci_043                -5.241109e-03 3 1  ON 42
ci_044                -1.527975e-02 3 1  ON 43
ci_045                -3.750933e-03 3 1  ON 44
ci_046                 6.625424e-03 3 1  ON 45
ci_047                 6.919479e-03 3 1  ON 46
ci_048                -1.219902e-02 3 1  ON 47
ci_049                -1.192585e-02 3 1  ON 48
ci_050                 8.470418e-03 3 1  ON 49
ci_051                 8.605871e-03 3 1  ON 50
ci_052                -8.006175e-03 3 1  ON 51
ci_053                -8.379571e-03 3 1  ON 52
ci_054                -3.255105e-03 3 1  ON 53
ci_055                -3.597514e-03 3 1  ON 54
ci_056                 6.291559e-03 3 1  ON 55
ci_057                 6.378181e-03 3 1  ON 56
ci_058                -8.051820e-03 3 1  ON 57
ci_059                -8.401109e-03 3 1  ON 58
ci_060                 8.361494e-03 3 1  ON 59
ci_061                 8.832818e-03 3 1  ON 60
ci_062                -4.331148e-03 3 1  ON 61
ci_063                -4.446424e-03 3 1  ON 62
ci_064                -4.195976e-03 3 1  ON 63
ci_065                -5.248675e-03 3 1  ON 64
ci_066                 6.507949e-03 3 1  ON 65
ci_067                 6.428690e-03 3 1  ON 66
ci_068                -5.280605e-03 3 1  ON 67
ci_069                -5.405512e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.414011
====================================================
  Execution time = 1.4176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0434e-01
  Total weights = 1.956262256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291505897967
                                         uncertainty =       0.002141148145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291505897967
                                         uncertainty =       0.002141148145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381742656
  error estimate for blocks of size 2^( 2) =       0.000393363724
  error estimate for blocks of size 2^( 3) =       0.000403268987
  error estimate for blocks of size 2^( 4) =       0.000410504853
  error estimate for blocks of size 2^( 5) =       0.000415796031
  error estimate for blocks of size 2^( 6) =       0.000419727336
  error estimate for blocks of size 2^( 7) =       0.000422139460

      target function =                  N/A
              le_mean =     -17.214508663965
             les_mean =     296.643644685093
             stat err =       0.000417041920
             autocorr =       1.193487956402
              std dev =       0.539865641421
             le_variance =       0.291454910787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450866396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214508663930       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214508671484       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214508671447       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214508671481       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 8.498524e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214508663930       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214508665819       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214508665810       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214508665819       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 2.125516e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214508663930       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214508664402       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214508664400       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214508664399       residual = 1.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 5.314342e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6650e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.439581e-02 3 1  ON 0
ci_002                -3.400811e-02 3 1  ON 1
ci_003                -2.713013e-02 3 1  ON 2
ci_004                 2.405314e-02 3 1  ON 3
ci_005                 2.406884e-02 3 1  ON 4
ci_006                -2.262048e-02 3 1  ON 5
ci_007                -2.276524e-02 3 1  ON 6
ci_008                -2.005560e-02 3 1  ON 7
ci_009                -1.993943e-02 3 1  ON 8
ci_010                -1.859252e-02 3 1  ON 9
ci_011                -1.848271e-02 3 1  ON 10
ci_012                -1.854314e-02 3 1  ON 11
ci_013                -2.016198e-02 3 1  ON 12
ci_014                 1.686985e-02 3 1  ON 13
ci_015                 1.640851e-02 3 1  ON 14
ci_016                 1.689568e-02 3 1  ON 15
ci_017                 1.733397e-02 3 1  ON 16
ci_018                 1.541980e-02 3 1  ON 17
ci_019                 1.521617e-02 3 1  ON 18
ci_020                 1.571001e-02 3 1  ON 19
ci_021                 1.564846e-02 3 1  ON 20
ci_022                 1.436082e-02 3 1  ON 21
ci_023                 1.371322e-02 3 1  ON 22
ci_024                 1.236854e-02 3 1  ON 23
ci_025                 1.244464e-02 3 1  ON 24
ci_026                 1.365539e-02 3 1  ON 25
ci_027                 1.408280e-02 3 1  ON 26
ci_028                -1.545798e-02 3 1  ON 27
ci_029                -1.533482e-02 3 1  ON 28
ci_030                -1.161279e-02 3 1  ON 29
ci_031                -1.175895e-02 3 1  ON 30
ci_032                -1.400259e-02 3 1  ON 31
ci_033                 1.079636e-02 3 1  ON 32
ci_034                 1.073599e-02 3 1  ON 33
ci_035                -6.823316e-03 3 1  ON 34
ci_036                -1.203757e-02 3 1  ON 35
ci_037                -1.217898e-02 3 1  ON 36
ci_038                 2.679352e-03 3 1  ON 37
ci_039                 3.154424e-03 3 1  ON 38
ci_040                -5.970950e-03 3 1  ON 39
ci_041                 1.051394e-02 3 1  ON 40
ci_042                 1.061519e-02 3 1  ON 41
ci_043                -5.241062e-03 3 1  ON 42
ci_044                -1.527977e-02 3 1  ON 43
ci_045                -3.750858e-03 3 1  ON 44
ci_046                 6.625458e-03 3 1  ON 45
ci_047                 6.919561e-03 3 1  ON 46
ci_048                -1.219894e-02 3 1  ON 47
ci_049                -1.192590e-02 3 1  ON 48
ci_050                 8.470381e-03 3 1  ON 49
ci_051                 8.605891e-03 3 1  ON 50
ci_052                -8.006210e-03 3 1  ON 51
ci_053                -8.379358e-03 3 1  ON 52
ci_054                -3.255182e-03 3 1  ON 53
ci_055                -3.597581e-03 3 1  ON 54
ci_056                 6.291676e-03 3 1  ON 55
ci_057                 6.378060e-03 3 1  ON 56
ci_058                -8.051882e-03 3 1  ON 57
ci_059                -8.401108e-03 3 1  ON 58
ci_060                 8.361482e-03 3 1  ON 59
ci_061                 8.832737e-03 3 1  ON 60
ci_062                -4.331174e-03 3 1  ON 61
ci_063                -4.446457e-03 3 1  ON 62
ci_064                -4.196120e-03 3 1  ON 63
ci_065                -5.248555e-03 3 1  ON 64
ci_066                 6.507915e-03 3 1  ON 65
ci_067                 6.428779e-03 3 1  ON 66
ci_068                -5.280459e-03 3 1  ON 67
ci_069                -5.405565e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.468903
====================================================
  Execution time = 1.3697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0579e-01
  Total weights = 1.9561e+06
  Execution time = 1.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484396673
                                         uncertainty =       0.002205715845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484396673
                                         uncertainty =       0.002205715845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382433603
  error estimate for blocks of size 2^( 2) =       0.000394279365
  error estimate for blocks of size 2^( 3) =       0.000404747075
  error estimate for blocks of size 2^( 4) =       0.000412196005
  error estimate for blocks of size 2^( 5) =       0.000416457160
  error estimate for blocks of size 2^( 6) =       0.000419083876
  error estimate for blocks of size 2^( 7) =       0.000421632112

      target function =                  N/A
              le_mean =     -17.214487767151
             les_mean =     296.644374836618
             stat err =       0.000417342288
             autocorr =       1.190892871369
              std dev =       0.540842788333
             le_variance =       0.292510921692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484532569
                                         uncertainty =       0.002205710363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484532569
                                         uncertainty =       0.002205710363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382433692
  error estimate for blocks of size 2^( 2) =       0.000394279447
  error estimate for blocks of size 2^( 3) =       0.000404747144
  error estimate for blocks of size 2^( 4) =       0.000412196048
  error estimate for blocks of size 2^( 5) =       0.000416457194
  error estimate for blocks of size 2^( 6) =       0.000419083923
  error estimate for blocks of size 2^( 7) =       0.000421632178

      target function =                  N/A
              le_mean =     -17.214487769299
             les_mean =     296.644376653878
             stat err =       0.000417342336
             autocorr =       1.190892589653
              std dev =       0.540842913888
             le_variance =       0.292511057503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484464615
                                         uncertainty =       0.002205713101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484464615
                                         uncertainty =       0.002205713101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382433648
  error estimate for blocks of size 2^( 2) =       0.000394279406
  error estimate for blocks of size 2^( 3) =       0.000404747110
  error estimate for blocks of size 2^( 4) =       0.000412196027
  error estimate for blocks of size 2^( 5) =       0.000416457177
  error estimate for blocks of size 2^( 6) =       0.000419083900
  error estimate for blocks of size 2^( 7) =       0.000421632145

      target function =                  N/A
              le_mean =     -17.214487768223
             les_mean =     296.644375733656
             stat err =       0.000417342312
             autocorr =       1.190892730474
              std dev =       0.540842851105
             le_variance =       0.292510989592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484405163
                                         uncertainty =       0.002205715501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292484405163
                                         uncertainty =       0.002205715501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382433609
  error estimate for blocks of size 2^( 2) =       0.000394279370
  error estimate for blocks of size 2^( 3) =       0.000404747079
  error estimate for blocks of size 2^( 4) =       0.000412196008
  error estimate for blocks of size 2^( 5) =       0.000416457162
  error estimate for blocks of size 2^( 6) =       0.000419083879
  error estimate for blocks of size 2^( 7) =       0.000421632117

      target function =                  N/A
              le_mean =     -17.214487767285
             les_mean =     296.644374947494
             stat err =       0.000417342291
             autocorr =       1.190892853756
              std dev =       0.540842796177
             le_variance =       0.292510930177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214487767151        initial
     5.8208e+02     5.8208e+03             8.4985e-07       -17.214487769299  <--
     2.3283e+03     2.3283e+04             2.1255e-07       -17.214487768223
     9.3132e+03     9.3132e+04             5.3143e-08       -17.214487767285

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 2.2944e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.439625e-02 3 1  ON 0
ci_002                -3.400801e-02 3 1  ON 1
ci_003                -2.713005e-02 3 1  ON 2
ci_004                 2.405306e-02 3 1  ON 3
ci_005                 2.406904e-02 3 1  ON 4
ci_006                -2.262053e-02 3 1  ON 5
ci_007                -2.276520e-02 3 1  ON 6
ci_008                -2.005576e-02 3 1  ON 7
ci_009                -1.993940e-02 3 1  ON 8
ci_010                -1.859269e-02 3 1  ON 9
ci_011                -1.848246e-02 3 1  ON 10
ci_012                -1.854316e-02 3 1  ON 11
ci_013                -2.016198e-02 3 1  ON 12
ci_014                 1.686960e-02 3 1  ON 13
ci_015                 1.640820e-02 3 1  ON 14
ci_016                 1.689569e-02 3 1  ON 15
ci_017                 1.733413e-02 3 1  ON 16
ci_018                 1.542021e-02 3 1  ON 17
ci_019                 1.521638e-02 3 1  ON 18
ci_020                 1.570988e-02 3 1  ON 19
ci_021                 1.564860e-02 3 1  ON 20
ci_022                 1.436080e-02 3 1  ON 21
ci_023                 1.371315e-02 3 1  ON 22
ci_024                 1.236877e-02 3 1  ON 23
ci_025                 1.244452e-02 3 1  ON 24
ci_026                 1.365547e-02 3 1  ON 25
ci_027                 1.408284e-02 3 1  ON 26
ci_028                -1.545797e-02 3 1  ON 27
ci_029                -1.533475e-02 3 1  ON 28
ci_030                -1.161273e-02 3 1  ON 29
ci_031                -1.175918e-02 3 1  ON 30
ci_032                -1.400282e-02 3 1  ON 31
ci_033                 1.079651e-02 3 1  ON 32
ci_034                 1.073573e-02 3 1  ON 33
ci_035                -6.823718e-03 3 1  ON 34
ci_036                -1.203762e-02 3 1  ON 35
ci_037                -1.217906e-02 3 1  ON 36
ci_038                 2.679453e-03 3 1  ON 37
ci_039                 3.154357e-03 3 1  ON 38
ci_040                -5.971221e-03 3 1  ON 39
ci_041                 1.051404e-02 3 1  ON 40
ci_042                 1.061508e-02 3 1  ON 41
ci_043                -5.240921e-03 3 1  ON 42
ci_044                -1.527981e-02 3 1  ON 43
ci_045                -3.750635e-03 3 1  ON 44
ci_046                 6.625560e-03 3 1  ON 45
ci_047                 6.919808e-03 3 1  ON 46
ci_048                -1.219868e-02 3 1  ON 47
ci_049                -1.192603e-02 3 1  ON 48
ci_050                 8.470270e-03 3 1  ON 49
ci_051                 8.605950e-03 3 1  ON 50
ci_052                -8.006315e-03 3 1  ON 51
ci_053                -8.378721e-03 3 1  ON 52
ci_054                -3.255413e-03 3 1  ON 53
ci_055                -3.597781e-03 3 1  ON 54
ci_056                 6.292026e-03 3 1  ON 55
ci_057                 6.377696e-03 3 1  ON 56
ci_058                -8.052067e-03 3 1  ON 57
ci_059                -8.401106e-03 3 1  ON 58
ci_060                 8.361445e-03 3 1  ON 59
ci_061                 8.832492e-03 3 1  ON 60
ci_062                -4.331252e-03 3 1  ON 61
ci_063                -4.446559e-03 3 1  ON 62
ci_064                -4.196550e-03 3 1  ON 63
ci_065                -5.248195e-03 3 1  ON 64
ci_066                 6.507814e-03 3 1  ON 65
ci_067                 6.429046e-03 3 1  ON 66
ci_068                -5.280020e-03 3 1  ON 67
ci_069                -5.405722e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.263363
====================================================
  Execution time = 1.4216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0783e-01
  Total weights = 1.956036858e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295632175046
                                         uncertainty =       0.002016388217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295632175046
                                         uncertainty =       0.002016388217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384436997
  error estimate for blocks of size 2^( 2) =       0.000396031759
  error estimate for blocks of size 2^( 3) =       0.000406409954
  error estimate for blocks of size 2^( 4) =       0.000413930101
  error estimate for blocks of size 2^( 5) =       0.000418830895
  error estimate for blocks of size 2^( 6) =       0.000420805314
  error estimate for blocks of size 2^( 7) =       0.000421927768

      target function =                  N/A
              le_mean =     -17.214692892202
             les_mean =     296.653478070507
             stat err =       0.000418873519
             autocorr =       1.187176957921
              std dev =       0.543676015371
             le_variance =       0.295583609690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721469289220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214692892188       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214692933694       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214692934970       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 2.236305e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214692892188       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214692902579       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214692902899       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 5.598357e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214692892188       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214692894787       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214692894867       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.400065e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6674e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.439654e-02 3 1  ON 0
ci_002                -3.400825e-02 3 1  ON 1
ci_003                -2.712959e-02 3 1  ON 2
ci_004                 2.405288e-02 3 1  ON 3
ci_005                 2.406913e-02 3 1  ON 4
ci_006                -2.262069e-02 3 1  ON 5
ci_007                -2.276504e-02 3 1  ON 6
ci_008                -2.005572e-02 3 1  ON 7
ci_009                -1.993937e-02 3 1  ON 8
ci_010                -1.859271e-02 3 1  ON 9
ci_011                -1.848225e-02 3 1  ON 10
ci_012                -1.854323e-02 3 1  ON 11
ci_013                -2.016189e-02 3 1  ON 12
ci_014                 1.686943e-02 3 1  ON 13
ci_015                 1.640799e-02 3 1  ON 14
ci_016                 1.689577e-02 3 1  ON 15
ci_017                 1.733417e-02 3 1  ON 16
ci_018                 1.542046e-02 3 1  ON 17
ci_019                 1.521687e-02 3 1  ON 18
ci_020                 1.570984e-02 3 1  ON 19
ci_021                 1.564880e-02 3 1  ON 20
ci_022                 1.436069e-02 3 1  ON 21
ci_023                 1.371370e-02 3 1  ON 22
ci_024                 1.236871e-02 3 1  ON 23
ci_025                 1.244447e-02 3 1  ON 24
ci_026                 1.365539e-02 3 1  ON 25
ci_027                 1.408274e-02 3 1  ON 26
ci_028                -1.545772e-02 3 1  ON 27
ci_029                -1.533487e-02 3 1  ON 28
ci_030                -1.161312e-02 3 1  ON 29
ci_031                -1.175904e-02 3 1  ON 30
ci_032                -1.400273e-02 3 1  ON 31
ci_033                 1.079706e-02 3 1  ON 32
ci_034                 1.073565e-02 3 1  ON 33
ci_035                -6.824059e-03 3 1  ON 34
ci_036                -1.203763e-02 3 1  ON 35
ci_037                -1.217880e-02 3 1  ON 36
ci_038                 2.679667e-03 3 1  ON 37
ci_039                 3.154117e-03 3 1  ON 38
ci_040                -5.971133e-03 3 1  ON 39
ci_041                 1.051409e-02 3 1  ON 40
ci_042                 1.061518e-02 3 1  ON 41
ci_043                -5.240828e-03 3 1  ON 42
ci_044                -1.527996e-02 3 1  ON 43
ci_045                -3.750658e-03 3 1  ON 44
ci_046                 6.625266e-03 3 1  ON 45
ci_047                 6.919248e-03 3 1  ON 46
ci_048                -1.219853e-02 3 1  ON 47
ci_049                -1.192596e-02 3 1  ON 48
ci_050                 8.470171e-03 3 1  ON 49
ci_051                 8.606094e-03 3 1  ON 50
ci_052                -8.005846e-03 3 1  ON 51
ci_053                -8.378352e-03 3 1  ON 52
ci_054                -3.255681e-03 3 1  ON 53
ci_055                -3.597735e-03 3 1  ON 54
ci_056                 6.292006e-03 3 1  ON 55
ci_057                 6.377470e-03 3 1  ON 56
ci_058                -8.052382e-03 3 1  ON 57
ci_059                -8.401018e-03 3 1  ON 58
ci_060                 8.361751e-03 3 1  ON 59
ci_061                 8.832323e-03 3 1  ON 60
ci_062                -4.331727e-03 3 1  ON 61
ci_063                -4.446585e-03 3 1  ON 62
ci_064                -4.196488e-03 3 1  ON 63
ci_065                -5.247815e-03 3 1  ON 64
ci_066                 6.507704e-03 3 1  ON 65
ci_067                 6.428848e-03 3 1  ON 66
ci_068                -5.279968e-03 3 1  ON 67
ci_069                -5.405718e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2715
    reference variance = 0.235146
====================================================
  Execution time = 1.3795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0983e-01
  Total weights = 1.9561e+06
  Execution time = 1.8108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217310443
                                         uncertainty =       0.002218412541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217310443
                                         uncertainty =       0.002218412541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383477222
  error estimate for blocks of size 2^( 2) =       0.000395264728
  error estimate for blocks of size 2^( 3) =       0.000406284755
  error estimate for blocks of size 2^( 4) =       0.000413673225
  error estimate for blocks of size 2^( 5) =       0.000417897943
  error estimate for blocks of size 2^( 6) =       0.000419548773
  error estimate for blocks of size 2^( 7) =       0.000422157688

      target function =                  N/A
              le_mean =     -17.214385262229
             les_mean =     296.644893999913
             stat err =       0.000418319407
             autocorr =       1.189972377947
              std dev =       0.542318688660
             le_variance =       0.294109560070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217045430
                                         uncertainty =       0.002218407618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217045430
                                         uncertainty =       0.002218407618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383477052
  error estimate for blocks of size 2^( 2) =       0.000395264550
  error estimate for blocks of size 2^( 3) =       0.000406284592
  error estimate for blocks of size 2^( 4) =       0.000413673012
  error estimate for blocks of size 2^( 5) =       0.000417897776
  error estimate for blocks of size 2^( 6) =       0.000419548578
  error estimate for blocks of size 2^( 7) =       0.000422157489

      target function =                  N/A
              le_mean =     -17.214385281177
             les_mean =     296.646037796521
             stat err =       0.000418319214
             autocorr =       1.189972336491
              std dev =       0.542318447458
             le_variance =       0.294109298453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217177368
                                         uncertainty =       0.002218410082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217177368
                                         uncertainty =       0.002218410082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383477137
  error estimate for blocks of size 2^( 2) =       0.000395264640
  error estimate for blocks of size 2^( 3) =       0.000406284675
  error estimate for blocks of size 2^( 4) =       0.000413673120
  error estimate for blocks of size 2^( 5) =       0.000417897863
  error estimate for blocks of size 2^( 6) =       0.000419548681
  error estimate for blocks of size 2^( 7) =       0.000422157593

      target function =                  N/A
              le_mean =     -17.214385272035
             les_mean =     296.644897583571
             stat err =       0.000418319314
             autocorr =       1.189972381276
              std dev =       0.542318567536
             le_variance =       0.294109428694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217293763
                                         uncertainty =       0.002218412232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294217293763
                                         uncertainty =       0.002218412232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383477212
  error estimate for blocks of size 2^( 2) =       0.000395264717
  error estimate for blocks of size 2^( 3) =       0.000406284745
  error estimate for blocks of size 2^( 4) =       0.000413673212
  error estimate for blocks of size 2^( 5) =       0.000417897933
  error estimate for blocks of size 2^( 6) =       0.000419548761
  error estimate for blocks of size 2^( 7) =       0.000422157676

      target function =                  N/A
              le_mean =     -17.214385263452
             les_mean =     296.644894185786
             stat err =       0.000418319395
             autocorr =       1.189972378476
              std dev =       0.542318673478
             le_variance =       0.294109543603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214385262229        initial
     1.4552e+02     1.4552e+03             2.2363e-06       -17.214385281177  <--
     5.8208e+02     5.8208e+03             5.5984e-07       -17.214385272035
     2.3283e+03     2.3283e+04             1.4001e-07       -17.214385263452

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.2957e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400898e-02 3 1  ON 1
ci_003                -2.712821e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406939e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276456e-02 3 1  ON 6
ci_008                -2.005560e-02 3 1  ON 7
ci_009                -1.993926e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848162e-02 3 1  ON 10
ci_012                -1.854344e-02 3 1  ON 11
ci_013                -2.016163e-02 3 1  ON 12
ci_014                 1.686889e-02 3 1  ON 13
ci_015                 1.640738e-02 3 1  ON 14
ci_016                 1.689601e-02 3 1  ON 15
ci_017                 1.733430e-02 3 1  ON 16
ci_018                 1.542120e-02 3 1  ON 17
ci_019                 1.521833e-02 3 1  ON 18
ci_020                 1.570973e-02 3 1  ON 19
ci_021                 1.564937e-02 3 1  ON 20
ci_022                 1.436036e-02 3 1  ON 21
ci_023                 1.371533e-02 3 1  ON 22
ci_024                 1.236855e-02 3 1  ON 23
ci_025                 1.244431e-02 3 1  ON 24
ci_026                 1.365516e-02 3 1  ON 25
ci_027                 1.408242e-02 3 1  ON 26
ci_028                -1.545697e-02 3 1  ON 27
ci_029                -1.533525e-02 3 1  ON 28
ci_030                -1.161426e-02 3 1  ON 29
ci_031                -1.175862e-02 3 1  ON 30
ci_032                -1.400245e-02 3 1  ON 31
ci_033                 1.079868e-02 3 1  ON 32
ci_034                 1.073539e-02 3 1  ON 33
ci_035                -6.825080e-03 3 1  ON 34
ci_036                -1.203766e-02 3 1  ON 35
ci_037                -1.217801e-02 3 1  ON 36
ci_038                 2.680307e-03 3 1  ON 37
ci_039                 3.153401e-03 3 1  ON 38
ci_040                -5.970871e-03 3 1  ON 39
ci_041                 1.051426e-02 3 1  ON 40
ci_042                 1.061549e-02 3 1  ON 41
ci_043                -5.240552e-03 3 1  ON 42
ci_044                -1.528039e-02 3 1  ON 43
ci_045                -3.750726e-03 3 1  ON 44
ci_046                 6.624384e-03 3 1  ON 45
ci_047                 6.917572e-03 3 1  ON 46
ci_048                -1.219809e-02 3 1  ON 47
ci_049                -1.192577e-02 3 1  ON 48
ci_050                 8.469875e-03 3 1  ON 49
ci_051                 8.606524e-03 3 1  ON 50
ci_052                -8.004445e-03 3 1  ON 51
ci_053                -8.377246e-03 3 1  ON 52
ci_054                -3.256484e-03 3 1  ON 53
ci_055                -3.597596e-03 3 1  ON 54
ci_056                 6.291948e-03 3 1  ON 55
ci_057                 6.376793e-03 3 1  ON 56
ci_058                -8.053323e-03 3 1  ON 57
ci_059                -8.400758e-03 3 1  ON 58
ci_060                 8.362668e-03 3 1  ON 59
ci_061                 8.831816e-03 3 1  ON 60
ci_062                -4.333148e-03 3 1  ON 61
ci_063                -4.446662e-03 3 1  ON 62
ci_064                -4.196301e-03 3 1  ON 63
ci_065                -5.246676e-03 3 1  ON 64
ci_066                 6.507375e-03 3 1  ON 65
ci_067                 6.428254e-03 3 1  ON 66
ci_068                -5.279813e-03 3 1  ON 67
ci_069                -5.405704e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.164596
====================================================
  Execution time = 1.4251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1183e-01
  Total weights = 1.956048311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295816690130
                                         uncertainty =       0.002958613418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295816690130
                                         uncertainty =       0.002958613418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384565631
  error estimate for blocks of size 2^( 2) =       0.000396318538
  error estimate for blocks of size 2^( 3) =       0.000406623355
  error estimate for blocks of size 2^( 4) =       0.000414691530
  error estimate for blocks of size 2^( 5) =       0.000417885839
  error estimate for blocks of size 2^( 6) =       0.000419136765
  error estimate for blocks of size 2^( 7) =       0.000419609432

      target function =                  N/A
              le_mean =     -17.214157597899
             les_mean =     296.639050874275
             stat err =       0.000417830892
             autocorr =       1.180484134934
              std dev =       0.543857931049
             le_variance =       0.295781449165


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721415759790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214157597893       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214157609690       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214157607827       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214157608381       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+01 is 9.397182e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214157597893       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214157600858       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214157600369       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214157600493       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 2.360036e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214157597893       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214157598635       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214157598512       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214157598542       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 5.906842e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6721e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.439968e-02 3 1  ON 0
ci_002                -3.400845e-02 3 1  ON 1
ci_003                -2.712797e-02 3 1  ON 2
ci_004                 2.405274e-02 3 1  ON 3
ci_005                 2.406855e-02 3 1  ON 4
ci_006                -2.262065e-02 3 1  ON 5
ci_007                -2.276622e-02 3 1  ON 6
ci_008                -2.005650e-02 3 1  ON 7
ci_009                -1.993837e-02 3 1  ON 8
ci_010                -1.859344e-02 3 1  ON 9
ci_011                -1.848166e-02 3 1  ON 10
ci_012                -1.854345e-02 3 1  ON 11
ci_013                -2.016123e-02 3 1  ON 12
ci_014                 1.686945e-02 3 1  ON 13
ci_015                 1.640731e-02 3 1  ON 14
ci_016                 1.689823e-02 3 1  ON 15
ci_017                 1.733302e-02 3 1  ON 16
ci_018                 1.542183e-02 3 1  ON 17
ci_019                 1.521892e-02 3 1  ON 18
ci_020                 1.570940e-02 3 1  ON 19
ci_021                 1.564908e-02 3 1  ON 20
ci_022                 1.435961e-02 3 1  ON 21
ci_023                 1.371684e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244408e-02 3 1  ON 24
ci_026                 1.365420e-02 3 1  ON 25
ci_027                 1.408296e-02 3 1  ON 26
ci_028                -1.545611e-02 3 1  ON 27
ci_029                -1.533476e-02 3 1  ON 28
ci_030                -1.161538e-02 3 1  ON 29
ci_031                -1.175899e-02 3 1  ON 30
ci_032                -1.400285e-02 3 1  ON 31
ci_033                 1.079804e-02 3 1  ON 32
ci_034                 1.073775e-02 3 1  ON 33
ci_035                -6.824821e-03 3 1  ON 34
ci_036                -1.203793e-02 3 1  ON 35
ci_037                -1.217812e-02 3 1  ON 36
ci_038                 2.681354e-03 3 1  ON 37
ci_039                 3.152493e-03 3 1  ON 38
ci_040                -5.971073e-03 3 1  ON 39
ci_041                 1.051409e-02 3 1  ON 40
ci_042                 1.061576e-02 3 1  ON 41
ci_043                -5.239908e-03 3 1  ON 42
ci_044                -1.528083e-02 3 1  ON 43
ci_045                -3.751989e-03 3 1  ON 44
ci_046                 6.623991e-03 3 1  ON 45
ci_047                 6.918899e-03 3 1  ON 46
ci_048                -1.219787e-02 3 1  ON 47
ci_049                -1.192665e-02 3 1  ON 48
ci_050                 8.469507e-03 3 1  ON 49
ci_051                 8.605322e-03 3 1  ON 50
ci_052                -8.004483e-03 3 1  ON 51
ci_053                -8.376382e-03 3 1  ON 52
ci_054                -3.255503e-03 3 1  ON 53
ci_055                -3.596886e-03 3 1  ON 54
ci_056                 6.291646e-03 3 1  ON 55
ci_057                 6.377057e-03 3 1  ON 56
ci_058                -8.053290e-03 3 1  ON 57
ci_059                -8.400922e-03 3 1  ON 58
ci_060                 8.362557e-03 3 1  ON 59
ci_061                 8.831688e-03 3 1  ON 60
ci_062                -4.334242e-03 3 1  ON 61
ci_063                -4.446462e-03 3 1  ON 62
ci_064                -4.197099e-03 3 1  ON 63
ci_065                -5.245360e-03 3 1  ON 64
ci_066                 6.509032e-03 3 1  ON 65
ci_067                 6.428576e-03 3 1  ON 66
ci_068                -5.279656e-03 3 1  ON 67
ci_069                -5.403800e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2499
    reference variance = 0.208503
====================================================
  Execution time = 1.3763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0456e-01
  Total weights = 1.9564e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292965807821
                                         uncertainty =       0.002335903143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292965807821
                                         uncertainty =       0.002335903143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382672238
  error estimate for blocks of size 2^( 2) =       0.000394070149
  error estimate for blocks of size 2^( 3) =       0.000404812711
  error estimate for blocks of size 2^( 4) =       0.000412752084
  error estimate for blocks of size 2^( 5) =       0.000418376991
  error estimate for blocks of size 2^( 6) =       0.000421176240
  error estimate for blocks of size 2^( 7) =       0.000420973882

      target function =                  N/A
              le_mean =     -17.214422277926
             les_mean =     296.640891050290
             stat err =       0.000418319799
             autocorr =       1.194986305332
              std dev =       0.541180268956
             le_variance =       0.292876083508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292968511626
                                         uncertainty =       0.002335105307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292968511626
                                         uncertainty =       0.002335105307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382673999
  error estimate for blocks of size 2^( 2) =       0.000394071662
  error estimate for blocks of size 2^( 3) =       0.000404813951
  error estimate for blocks of size 2^( 4) =       0.000412753302
  error estimate for blocks of size 2^( 5) =       0.000418378228
  error estimate for blocks of size 2^( 6) =       0.000421177056
  error estimate for blocks of size 2^( 7) =       0.000420974743

      target function =                  N/A
              le_mean =     -17.214422119794
             les_mean =     296.640890647834
             stat err =       0.000418320832
             autocorr =       1.194981209665
              std dev =       0.541182759039
             le_variance =       0.292878778681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292967162119
                                         uncertainty =       0.002335502038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292967162119
                                         uncertainty =       0.002335502038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382673120
  error estimate for blocks of size 2^( 2) =       0.000394070906
  error estimate for blocks of size 2^( 3) =       0.000404813331
  error estimate for blocks of size 2^( 4) =       0.000412752693
  error estimate for blocks of size 2^( 5) =       0.000418377610
  error estimate for blocks of size 2^( 6) =       0.000421176647
  error estimate for blocks of size 2^( 7) =       0.000420974311

      target function =                  N/A
              le_mean =     -17.214422197762
             les_mean =     296.640888486230
             stat err =       0.000418320315
             autocorr =       1.194983746484
              std dev =       0.541181516190
             le_variance =       0.292877433465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292965976808
                                         uncertainty =       0.002335852899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292965976808
                                         uncertainty =       0.002335852899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382672348
  error estimate for blocks of size 2^( 2) =       0.000394070243
  error estimate for blocks of size 2^( 3) =       0.000404812789
  error estimate for blocks of size 2^( 4) =       0.000412752160
  error estimate for blocks of size 2^( 5) =       0.000418377068
  error estimate for blocks of size 2^( 6) =       0.000421176291
  error estimate for blocks of size 2^( 7) =       0.000420973936

      target function =                  N/A
              le_mean =     -17.214422267821
             les_mean =     296.640890587634
             stat err =       0.000418319864
             autocorr =       1.194985985156
              std dev =       0.541180424583
             le_variance =       0.292876251952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214422277926        initial  <--
     3.6380e+01     3.6380e+02             9.3972e-06       -17.214422119794
     1.4552e+02     1.4552e+03             2.3600e-06       -17.214422197762
     5.8208e+02     5.8208e+03             5.9068e-07       -17.214422267821

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8919
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400898e-02 3 1  ON 1
ci_003                -2.712821e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406939e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276456e-02 3 1  ON 6
ci_008                -2.005560e-02 3 1  ON 7
ci_009                -1.993926e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848162e-02 3 1  ON 10
ci_012                -1.854344e-02 3 1  ON 11
ci_013                -2.016163e-02 3 1  ON 12
ci_014                 1.686889e-02 3 1  ON 13
ci_015                 1.640738e-02 3 1  ON 14
ci_016                 1.689601e-02 3 1  ON 15
ci_017                 1.733430e-02 3 1  ON 16
ci_018                 1.542120e-02 3 1  ON 17
ci_019                 1.521833e-02 3 1  ON 18
ci_020                 1.570973e-02 3 1  ON 19
ci_021                 1.564937e-02 3 1  ON 20
ci_022                 1.436036e-02 3 1  ON 21
ci_023                 1.371533e-02 3 1  ON 22
ci_024                 1.236855e-02 3 1  ON 23
ci_025                 1.244431e-02 3 1  ON 24
ci_026                 1.365516e-02 3 1  ON 25
ci_027                 1.408242e-02 3 1  ON 26
ci_028                -1.545697e-02 3 1  ON 27
ci_029                -1.533525e-02 3 1  ON 28
ci_030                -1.161426e-02 3 1  ON 29
ci_031                -1.175862e-02 3 1  ON 30
ci_032                -1.400245e-02 3 1  ON 31
ci_033                 1.079868e-02 3 1  ON 32
ci_034                 1.073539e-02 3 1  ON 33
ci_035                -6.825080e-03 3 1  ON 34
ci_036                -1.203766e-02 3 1  ON 35
ci_037                -1.217801e-02 3 1  ON 36
ci_038                 2.680307e-03 3 1  ON 37
ci_039                 3.153401e-03 3 1  ON 38
ci_040                -5.970871e-03 3 1  ON 39
ci_041                 1.051426e-02 3 1  ON 40
ci_042                 1.061549e-02 3 1  ON 41
ci_043                -5.240552e-03 3 1  ON 42
ci_044                -1.528039e-02 3 1  ON 43
ci_045                -3.750726e-03 3 1  ON 44
ci_046                 6.624384e-03 3 1  ON 45
ci_047                 6.917572e-03 3 1  ON 46
ci_048                -1.219809e-02 3 1  ON 47
ci_049                -1.192577e-02 3 1  ON 48
ci_050                 8.469875e-03 3 1  ON 49
ci_051                 8.606524e-03 3 1  ON 50
ci_052                -8.004445e-03 3 1  ON 51
ci_053                -8.377246e-03 3 1  ON 52
ci_054                -3.256484e-03 3 1  ON 53
ci_055                -3.597596e-03 3 1  ON 54
ci_056                 6.291948e-03 3 1  ON 55
ci_057                 6.376793e-03 3 1  ON 56
ci_058                -8.053323e-03 3 1  ON 57
ci_059                -8.400758e-03 3 1  ON 58
ci_060                 8.362668e-03 3 1  ON 59
ci_061                 8.831816e-03 3 1  ON 60
ci_062                -4.333148e-03 3 1  ON 61
ci_063                -4.446662e-03 3 1  ON 62
ci_064                -4.196301e-03 3 1  ON 63
ci_065                -5.246676e-03 3 1  ON 64
ci_066                 6.507375e-03 3 1  ON 65
ci_067                 6.428254e-03 3 1  ON 66
ci_068                -5.279813e-03 3 1  ON 67
ci_069                -5.405704e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9618e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2652
    reference variance = 0.274054
====================================================
  Execution time = 1.4311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0370e-01
  Total weights = 1.956033028e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291398557195
                                         uncertainty =       0.001752138273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291398557195
                                         uncertainty =       0.001752138273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381690256
  error estimate for blocks of size 2^( 2) =       0.000393403380
  error estimate for blocks of size 2^( 3) =       0.000404410827
  error estimate for blocks of size 2^( 4) =       0.000411984011
  error estimate for blocks of size 2^( 5) =       0.000416615422
  error estimate for blocks of size 2^( 6) =       0.000419049503
  error estimate for blocks of size 2^( 7) =       0.000421222078

      target function =                  N/A
              le_mean =     -17.213780397767
             les_mean =     296.617937249957
             stat err =       0.000417217753
             autocorr =       1.194822561492
              std dev =       0.539791536224
             le_variance =       0.291374902579


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721378039777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213780397764       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213780414573       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213780415374       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 8.349099e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213780397764       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213780401968       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213780402170       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.089295e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213780397764       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213780398815       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213780398866       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 5.224500e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138744 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6776e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400914e-02 3 1  ON 1
ci_003                -2.712831e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406936e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276458e-02 3 1  ON 6
ci_008                -2.005570e-02 3 1  ON 7
ci_009                -1.993916e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848156e-02 3 1  ON 10
ci_012                -1.854343e-02 3 1  ON 11
ci_013                -2.016163e-02 3 1  ON 12
ci_014                 1.686883e-02 3 1  ON 13
ci_015                 1.640739e-02 3 1  ON 14
ci_016                 1.689614e-02 3 1  ON 15
ci_017                 1.733433e-02 3 1  ON 16
ci_018                 1.542114e-02 3 1  ON 17
ci_019                 1.521832e-02 3 1  ON 18
ci_020                 1.570982e-02 3 1  ON 19
ci_021                 1.564948e-02 3 1  ON 20
ci_022                 1.436020e-02 3 1  ON 21
ci_023                 1.371524e-02 3 1  ON 22
ci_024                 1.236848e-02 3 1  ON 23
ci_025                 1.244445e-02 3 1  ON 24
ci_026                 1.365525e-02 3 1  ON 25
ci_027                 1.408235e-02 3 1  ON 26
ci_028                -1.545682e-02 3 1  ON 27
ci_029                -1.533521e-02 3 1  ON 28
ci_030                -1.161433e-02 3 1  ON 29
ci_031                -1.175877e-02 3 1  ON 30
ci_032                -1.400240e-02 3 1  ON 31
ci_033                 1.079865e-02 3 1  ON 32
ci_034                 1.073551e-02 3 1  ON 33
ci_035                -6.825078e-03 3 1  ON 34
ci_036                -1.203771e-02 3 1  ON 35
ci_037                -1.217803e-02 3 1  ON 36
ci_038                 2.680367e-03 3 1  ON 37
ci_039                 3.153345e-03 3 1  ON 38
ci_040                -5.970802e-03 3 1  ON 39
ci_041                 1.051429e-02 3 1  ON 40
ci_042                 1.061547e-02 3 1  ON 41
ci_043                -5.240583e-03 3 1  ON 42
ci_044                -1.528051e-02 3 1  ON 43
ci_045                -3.750723e-03 3 1  ON 44
ci_046                 6.624371e-03 3 1  ON 45
ci_047                 6.917576e-03 3 1  ON 46
ci_048                -1.219798e-02 3 1  ON 47
ci_049                -1.192571e-02 3 1  ON 48
ci_050                 8.469820e-03 3 1  ON 49
ci_051                 8.606473e-03 3 1  ON 50
ci_052                -8.004441e-03 3 1  ON 51
ci_053                -8.377136e-03 3 1  ON 52
ci_054                -3.256529e-03 3 1  ON 53
ci_055                -3.597603e-03 3 1  ON 54
ci_056                 6.291754e-03 3 1  ON 55
ci_057                 6.376958e-03 3 1  ON 56
ci_058                -8.053298e-03 3 1  ON 57
ci_059                -8.400616e-03 3 1  ON 58
ci_060                 8.362699e-03 3 1  ON 59
ci_061                 8.831925e-03 3 1  ON 60
ci_062                -4.333160e-03 3 1  ON 61
ci_063                -4.446540e-03 3 1  ON 62
ci_064                -4.196216e-03 3 1  ON 63
ci_065                -5.246467e-03 3 1  ON 64
ci_066                 6.507309e-03 3 1  ON 65
ci_067                 6.428269e-03 3 1  ON 66
ci_068                -5.279842e-03 3 1  ON 67
ci_069                -5.405694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.26397
====================================================
  Execution time = 1.3736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0668e-01
  Total weights = 1.9563e+06
  Execution time = 1.8228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107530021
                                         uncertainty =       0.002010541348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107530021
                                         uncertainty =       0.002010541348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382227158
  error estimate for blocks of size 2^( 2) =       0.000393801365
  error estimate for blocks of size 2^( 3) =       0.000404449559
  error estimate for blocks of size 2^( 4) =       0.000411627308
  error estimate for blocks of size 2^( 5) =       0.000416784364
  error estimate for blocks of size 2^( 6) =       0.000419373423
  error estimate for blocks of size 2^( 7) =       0.000418891017

      target function =                  N/A
              le_mean =     -17.214180411313
             les_mean =     296.634687518098
             stat err =       0.000416669028
             autocorr =       1.188336279785
              std dev =       0.540550830920
             le_variance =       0.292195200808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107282377
                                         uncertainty =       0.002010609622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107282377
                                         uncertainty =       0.002010609622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382226997
  error estimate for blocks of size 2^( 2) =       0.000393801216
  error estimate for blocks of size 2^( 3) =       0.000404449427
  error estimate for blocks of size 2^( 4) =       0.000411627172
  error estimate for blocks of size 2^( 5) =       0.000416784248
  error estimate for blocks of size 2^( 6) =       0.000419373297
  error estimate for blocks of size 2^( 7) =       0.000418890931

      target function =                  N/A
              le_mean =     -17.214180422826
             les_mean =     296.634686704748
             stat err =       0.000416668912
             autocorr =       1.188336619451
              std dev =       0.540550602810
             le_variance =       0.292194954198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107406037
                                         uncertainty =       0.002010575500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107406037
                                         uncertainty =       0.002010575500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382227077
  error estimate for blocks of size 2^( 2) =       0.000393801290
  error estimate for blocks of size 2^( 3) =       0.000404449493
  error estimate for blocks of size 2^( 4) =       0.000411627240
  error estimate for blocks of size 2^( 5) =       0.000416784306
  error estimate for blocks of size 2^( 6) =       0.000419373360
  error estimate for blocks of size 2^( 7) =       0.000418890974

      target function =                  N/A
              le_mean =     -17.214180417066
             les_mean =     296.634687102912
             stat err =       0.000416668970
             autocorr =       1.188336449797
              std dev =       0.540550716714
             le_variance =       0.292195077341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107514515
                                         uncertainty =       0.002010545617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292107514515
                                         uncertainty =       0.002010545617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382227148
  error estimate for blocks of size 2^( 2) =       0.000393801356
  error estimate for blocks of size 2^( 3) =       0.000404449551
  error estimate for blocks of size 2^( 4) =       0.000411627299
  error estimate for blocks of size 2^( 5) =       0.000416784357
  error estimate for blocks of size 2^( 6) =       0.000419373415
  error estimate for blocks of size 2^( 7) =       0.000418891012

      target function =                  N/A
              le_mean =     -17.214180412031
             les_mean =     296.634687465257
             stat err =       0.000416669021
             autocorr =       1.188336301042
              std dev =       0.540550816636
             le_variance =       0.292195185366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214180411313        initial
     3.6380e+02     3.6380e+03             8.3491e-07       -17.214180422826  <--
     1.4552e+03     1.4552e+04             2.0893e-07       -17.214180417066
     5.8208e+03     5.8208e+04             5.2245e-08       -17.214180412031

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.2880e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400964e-02 3 1  ON 1
ci_003                -2.712862e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406925e-02 3 1  ON 4
ci_006                -2.262114e-02 3 1  ON 5
ci_007                -2.276463e-02 3 1  ON 6
ci_008                -2.005601e-02 3 1  ON 7
ci_009                -1.993885e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848135e-02 3 1  ON 10
ci_012                -1.854342e-02 3 1  ON 11
ci_013                -2.016164e-02 3 1  ON 12
ci_014                 1.686866e-02 3 1  ON 13
ci_015                 1.640745e-02 3 1  ON 14
ci_016                 1.689653e-02 3 1  ON 15
ci_017                 1.733444e-02 3 1  ON 16
ci_018                 1.542094e-02 3 1  ON 17
ci_019                 1.521829e-02 3 1  ON 18
ci_020                 1.571010e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435971e-02 3 1  ON 21
ci_023                 1.371497e-02 3 1  ON 22
ci_024                 1.236825e-02 3 1  ON 23
ci_025                 1.244486e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533508e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175922e-02 3 1  ON 30
ci_032                -1.400223e-02 3 1  ON 31
ci_033                 1.079856e-02 3 1  ON 32
ci_034                 1.073587e-02 3 1  ON 33
ci_035                -6.825072e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680547e-03 3 1  ON 37
ci_039                 3.153178e-03 3 1  ON 38
ci_040                -5.970597e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240673e-03 3 1  ON 42
ci_044                -1.528086e-02 3 1  ON 43
ci_045                -3.750716e-03 3 1  ON 44
ci_046                 6.624332e-03 3 1  ON 45
ci_047                 6.917587e-03 3 1  ON 46
ci_048                -1.219764e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469656e-03 3 1  ON 49
ci_051                 8.606319e-03 3 1  ON 50
ci_052                -8.004431e-03 3 1  ON 51
ci_053                -8.376808e-03 3 1  ON 52
ci_054                -3.256663e-03 3 1  ON 53
ci_055                -3.597624e-03 3 1  ON 54
ci_056                 6.291170e-03 3 1  ON 55
ci_057                 6.377452e-03 3 1  ON 56
ci_058                -8.053223e-03 3 1  ON 57
ci_059                -8.400192e-03 3 1  ON 58
ci_060                 8.362792e-03 3 1  ON 59
ci_061                 8.832252e-03 3 1  ON 60
ci_062                -4.333197e-03 3 1  ON 61
ci_063                -4.446176e-03 3 1  ON 62
ci_064                -4.195962e-03 3 1  ON 63
ci_065                -5.245841e-03 3 1  ON 64
ci_066                 6.507111e-03 3 1  ON 65
ci_067                 6.428315e-03 3 1  ON 66
ci_068                -5.279929e-03 3 1  ON 67
ci_069                -5.405661e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.251832
====================================================
  Execution time = 1.4147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0375e-01
  Total weights = 1.955819989e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291775632641
                                         uncertainty =       0.002014560401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291775632641
                                         uncertainty =       0.002014560401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381941563
  error estimate for blocks of size 2^( 2) =       0.000393840981
  error estimate for blocks of size 2^( 3) =       0.000404707882
  error estimate for blocks of size 2^( 4) =       0.000412764475
  error estimate for blocks of size 2^( 5) =       0.000416616827
  error estimate for blocks of size 2^( 6) =       0.000417747722
  error estimate for blocks of size 2^( 7) =       0.000420398345

      target function =                  N/A
              le_mean =     -17.214221057044
             les_mean =     296.633158378363
             stat err =       0.000416881842
             autocorr =       1.191330103742
              std dev =       0.540146938685
             le_variance =       0.291758715370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721422105704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214221057057       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214221097306       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214221095134       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214221094862       residual = 9.59e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+01 is 5.037109e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214221057057       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214221067141       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214221066587       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214221066518       residual = 9.68e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 1.262059e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214221057057       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214221059579       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214221059440       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214221059423       residual = 9.70e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 3.156892e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6647e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.439828e-02 3 1  ON 0
ci_002                -3.400956e-02 3 1  ON 1
ci_003                -2.712853e-02 3 1  ON 2
ci_004                 2.405234e-02 3 1  ON 3
ci_005                 2.406922e-02 3 1  ON 4
ci_006                -2.262157e-02 3 1  ON 5
ci_007                -2.276460e-02 3 1  ON 6
ci_008                -2.005604e-02 3 1  ON 7
ci_009                -1.993917e-02 3 1  ON 8
ci_010                -1.859306e-02 3 1  ON 9
ci_011                -1.848086e-02 3 1  ON 10
ci_012                -1.854288e-02 3 1  ON 11
ci_013                -2.016214e-02 3 1  ON 12
ci_014                 1.686795e-02 3 1  ON 13
ci_015                 1.640681e-02 3 1  ON 14
ci_016                 1.689666e-02 3 1  ON 15
ci_017                 1.733455e-02 3 1  ON 16
ci_018                 1.542046e-02 3 1  ON 17
ci_019                 1.521824e-02 3 1  ON 18
ci_020                 1.570988e-02 3 1  ON 19
ci_021                 1.564978e-02 3 1  ON 20
ci_022                 1.435845e-02 3 1  ON 21
ci_023                 1.371550e-02 3 1  ON 22
ci_024                 1.236816e-02 3 1  ON 23
ci_025                 1.244489e-02 3 1  ON 24
ci_026                 1.365543e-02 3 1  ON 25
ci_027                 1.408180e-02 3 1  ON 26
ci_028                -1.545580e-02 3 1  ON 27
ci_029                -1.533483e-02 3 1  ON 28
ci_030                -1.161483e-02 3 1  ON 29
ci_031                -1.175897e-02 3 1  ON 30
ci_032                -1.400239e-02 3 1  ON 31
ci_033                 1.079805e-02 3 1  ON 32
ci_034                 1.073524e-02 3 1  ON 33
ci_035                -6.825453e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217839e-02 3 1  ON 36
ci_038                 2.680728e-03 3 1  ON 37
ci_039                 3.152858e-03 3 1  ON 38
ci_040                -5.970691e-03 3 1  ON 39
ci_041                 1.051399e-02 3 1  ON 40
ci_042                 1.061532e-02 3 1  ON 41
ci_043                -5.239974e-03 3 1  ON 42
ci_044                -1.527997e-02 3 1  ON 43
ci_045                -3.750625e-03 3 1  ON 44
ci_046                 6.624139e-03 3 1  ON 45
ci_047                 6.917790e-03 3 1  ON 46
ci_048                -1.219768e-02 3 1  ON 47
ci_049                -1.192560e-02 3 1  ON 48
ci_050                 8.469763e-03 3 1  ON 49
ci_051                 8.606104e-03 3 1  ON 50
ci_052                -8.004154e-03 3 1  ON 51
ci_053                -8.376234e-03 3 1  ON 52
ci_054                -3.256719e-03 3 1  ON 53
ci_055                -3.597763e-03 3 1  ON 54
ci_056                 6.290901e-03 3 1  ON 55
ci_057                 6.377267e-03 3 1  ON 56
ci_058                -8.052667e-03 3 1  ON 57
ci_059                -8.399377e-03 3 1  ON 58
ci_060                 8.363744e-03 3 1  ON 59
ci_061                 8.831955e-03 3 1  ON 60
ci_062                -4.333236e-03 3 1  ON 61
ci_063                -4.446125e-03 3 1  ON 62
ci_064                -4.195923e-03 3 1  ON 63
ci_065                -5.245131e-03 3 1  ON 64
ci_066                 6.506886e-03 3 1  ON 65
ci_067                 6.427652e-03 3 1  ON 66
ci_068                -5.279606e-03 3 1  ON 67
ci_069                -5.406111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2585
    reference variance = 0.186
====================================================
  Execution time = 1.3795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0974e-01
  Total weights = 1.9559e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293845606403
                                         uncertainty =       0.002076293970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293845606403
                                         uncertainty =       0.002076293970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383335340
  error estimate for blocks of size 2^( 2) =       0.000395336147
  error estimate for blocks of size 2^( 3) =       0.000405590203
  error estimate for blocks of size 2^( 4) =       0.000412799328
  error estimate for blocks of size 2^( 5) =       0.000417762202
  error estimate for blocks of size 2^( 6) =       0.000421260125
  error estimate for blocks of size 2^( 7) =       0.000421907498

      target function =                  N/A
              le_mean =     -17.214632973270
             les_mean =     296.653326101947
             stat err =       0.000418432288
             autocorr =       1.191496198714
              std dev =       0.542118036476
             le_variance =       0.293891965473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293839345491
                                         uncertainty =       0.002076236108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293839345491
                                         uncertainty =       0.002076236108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383331255
  error estimate for blocks of size 2^( 2) =       0.000395332312
  error estimate for blocks of size 2^( 3) =       0.000405586626
  error estimate for blocks of size 2^( 4) =       0.000412795992
  error estimate for blocks of size 2^( 5) =       0.000417758960
  error estimate for blocks of size 2^( 6) =       0.000421257063
  error estimate for blocks of size 2^( 7) =       0.000421904355

      target function =                  N/A
              le_mean =     -17.214632934429
             les_mean =     296.653321475480
             stat err =       0.000418429093
             autocorr =       1.191503392344
              std dev =       0.542112259844
             le_variance =       0.293885702273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293842467124
                                         uncertainty =       0.002076264886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293842467124
                                         uncertainty =       0.002076264886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383333292
  error estimate for blocks of size 2^( 2) =       0.000395334224
  error estimate for blocks of size 2^( 3) =       0.000405588410
  error estimate for blocks of size 2^( 4) =       0.000412797655
  error estimate for blocks of size 2^( 5) =       0.000417760577
  error estimate for blocks of size 2^( 6) =       0.000421258589
  error estimate for blocks of size 2^( 7) =       0.000421905922

      target function =                  N/A
              le_mean =     -17.214632953621
             les_mean =     296.653323519821
             stat err =       0.000418430686
             autocorr =       1.191499804719
              std dev =       0.542115140032
             le_variance =       0.293888825052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293845213629
                                         uncertainty =       0.002076290326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293845213629
                                         uncertainty =       0.002076290326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383335084
  error estimate for blocks of size 2^( 2) =       0.000395335906
  error estimate for blocks of size 2^( 3) =       0.000405589979
  error estimate for blocks of size 2^( 4) =       0.000412799119
  error estimate for blocks of size 2^( 5) =       0.000417761999
  error estimate for blocks of size 2^( 6) =       0.000421259932
  error estimate for blocks of size 2^( 7) =       0.000421907301

      target function =                  N/A
              le_mean =     -17.214632970794
             les_mean =     296.653325756719
             stat err =       0.000418432088
             autocorr =       1.191496649773
              std dev =       0.542117674085
             le_variance =       0.293891572556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214632973270        initial  <--
     9.0949e+01     9.0949e+02             5.0371e-06       -17.214632934429
     3.6380e+02     3.6380e+03             1.2621e-06       -17.214632953621
     1.4552e+03     1.4552e+04             3.1569e-07       -17.214632970794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.0939
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400964e-02 3 1  ON 1
ci_003                -2.712862e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406925e-02 3 1  ON 4
ci_006                -2.262114e-02 3 1  ON 5
ci_007                -2.276463e-02 3 1  ON 6
ci_008                -2.005601e-02 3 1  ON 7
ci_009                -1.993885e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848135e-02 3 1  ON 10
ci_012                -1.854342e-02 3 1  ON 11
ci_013                -2.016164e-02 3 1  ON 12
ci_014                 1.686866e-02 3 1  ON 13
ci_015                 1.640745e-02 3 1  ON 14
ci_016                 1.689653e-02 3 1  ON 15
ci_017                 1.733444e-02 3 1  ON 16
ci_018                 1.542094e-02 3 1  ON 17
ci_019                 1.521829e-02 3 1  ON 18
ci_020                 1.571010e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435971e-02 3 1  ON 21
ci_023                 1.371497e-02 3 1  ON 22
ci_024                 1.236825e-02 3 1  ON 23
ci_025                 1.244486e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533508e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175922e-02 3 1  ON 30
ci_032                -1.400223e-02 3 1  ON 31
ci_033                 1.079856e-02 3 1  ON 32
ci_034                 1.073587e-02 3 1  ON 33
ci_035                -6.825072e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680547e-03 3 1  ON 37
ci_039                 3.153178e-03 3 1  ON 38
ci_040                -5.970597e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240673e-03 3 1  ON 42
ci_044                -1.528086e-02 3 1  ON 43
ci_045                -3.750716e-03 3 1  ON 44
ci_046                 6.624332e-03 3 1  ON 45
ci_047                 6.917587e-03 3 1  ON 46
ci_048                -1.219764e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469656e-03 3 1  ON 49
ci_051                 8.606319e-03 3 1  ON 50
ci_052                -8.004431e-03 3 1  ON 51
ci_053                -8.376808e-03 3 1  ON 52
ci_054                -3.256663e-03 3 1  ON 53
ci_055                -3.597624e-03 3 1  ON 54
ci_056                 6.291170e-03 3 1  ON 55
ci_057                 6.377452e-03 3 1  ON 56
ci_058                -8.053223e-03 3 1  ON 57
ci_059                -8.400192e-03 3 1  ON 58
ci_060                 8.362792e-03 3 1  ON 59
ci_061                 8.832252e-03 3 1  ON 60
ci_062                -4.333197e-03 3 1  ON 61
ci_063                -4.446176e-03 3 1  ON 62
ci_064                -4.195962e-03 3 1  ON 63
ci_065                -5.245841e-03 3 1  ON 64
ci_066                 6.507111e-03 3 1  ON 65
ci_067                 6.428315e-03 3 1  ON 66
ci_068                -5.279929e-03 3 1  ON 67
ci_069                -5.405661e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.205196
====================================================
  Execution time = 1.4188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0226e-01
  Total weights = 1.956281310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290472650823
                                         uncertainty =       0.001735804327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290472650823
                                         uncertainty =       0.001735804327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381061832
  error estimate for blocks of size 2^( 2) =       0.000392558370
  error estimate for blocks of size 2^( 3) =       0.000402524572
  error estimate for blocks of size 2^( 4) =       0.000410543526
  error estimate for blocks of size 2^( 5) =       0.000415426515
  error estimate for blocks of size 2^( 6) =       0.000418748430
  error estimate for blocks of size 2^( 7) =       0.000419330718

      target function =                  N/A
              le_mean =     -17.213925145084
             les_mean =     296.621477163031
             stat err =       0.000416012297
             autocorr =       1.191849544499
              std dev =       0.538902811022
             le_variance =       0.290416239728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721392514508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925145085       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213925145280       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213925145728       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213925145730       residual = 1.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 3.696902e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925145085       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213925145134       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213925145246       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213925145246       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 9.244201e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213925145085       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213925145097       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213925145125       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213925145125       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.311172e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6681e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.439744e-02 3 1  ON 0
ci_002                -3.400968e-02 3 1  ON 1
ci_003                -2.712859e-02 3 1  ON 2
ci_004                 2.405234e-02 3 1  ON 3
ci_005                 2.406922e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276462e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993883e-02 3 1  ON 8
ci_010                -1.859274e-02 3 1  ON 9
ci_011                -1.848136e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686864e-02 3 1  ON 13
ci_015                 1.640739e-02 3 1  ON 14
ci_016                 1.689651e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542097e-02 3 1  ON 17
ci_019                 1.521838e-02 3 1  ON 18
ci_020                 1.571014e-02 3 1  ON 19
ci_021                 1.564982e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371501e-02 3 1  ON 22
ci_024                 1.236824e-02 3 1  ON 23
ci_025                 1.244489e-02 3 1  ON 24
ci_026                 1.365555e-02 3 1  ON 25
ci_027                 1.408213e-02 3 1  ON 26
ci_028                -1.545631e-02 3 1  ON 27
ci_029                -1.533508e-02 3 1  ON 28
ci_030                -1.161456e-02 3 1  ON 29
ci_031                -1.175927e-02 3 1  ON 30
ci_032                -1.400220e-02 3 1  ON 31
ci_033                 1.079860e-02 3 1  ON 32
ci_034                 1.073588e-02 3 1  ON 33
ci_035                -6.825128e-03 3 1  ON 34
ci_036                -1.203787e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680581e-03 3 1  ON 37
ci_039                 3.153140e-03 3 1  ON 38
ci_040                -5.970593e-03 3 1  ON 39
ci_041                 1.051444e-02 3 1  ON 40
ci_042                 1.061539e-02 3 1  ON 41
ci_043                -5.240668e-03 3 1  ON 42
ci_044                -1.528092e-02 3 1  ON 43
ci_045                -3.750717e-03 3 1  ON 44
ci_046                 6.624316e-03 3 1  ON 45
ci_047                 6.917599e-03 3 1  ON 46
ci_048                -1.219763e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469603e-03 3 1  ON 49
ci_051                 8.606323e-03 3 1  ON 50
ci_052                -8.004456e-03 3 1  ON 51
ci_053                -8.376756e-03 3 1  ON 52
ci_054                -3.256756e-03 3 1  ON 53
ci_055                -3.597646e-03 3 1  ON 54
ci_056                 6.291103e-03 3 1  ON 55
ci_057                 6.377467e-03 3 1  ON 56
ci_058                -8.053263e-03 3 1  ON 57
ci_059                -8.400127e-03 3 1  ON 58
ci_060                 8.362826e-03 3 1  ON 59
ci_061                 8.832212e-03 3 1  ON 60
ci_062                -4.333226e-03 3 1  ON 61
ci_063                -4.446191e-03 3 1  ON 62
ci_064                -4.195970e-03 3 1  ON 63
ci_065                -5.245785e-03 3 1  ON 64
ci_066                 6.507085e-03 3 1  ON 65
ci_067                 6.428337e-03 3 1  ON 66
ci_068                -5.279912e-03 3 1  ON 67
ci_069                -5.405665e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.295153
====================================================
  Execution time = 1.3800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1302e-01
  Total weights = 1.9561e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541884662
                                         uncertainty =       0.002215685834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541884662
                                         uncertainty =       0.002215685834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383865315
  error estimate for blocks of size 2^( 2) =       0.000395321921
  error estimate for blocks of size 2^( 3) =       0.000405564448
  error estimate for blocks of size 2^( 4) =       0.000413443964
  error estimate for blocks of size 2^( 5) =       0.000417750903
  error estimate for blocks of size 2^( 6) =       0.000420312851
  error estimate for blocks of size 2^( 7) =       0.000420033154

      target function =                  N/A
              le_mean =     -17.213937226080
             les_mean =     296.632651306805
             stat err =       0.000417885218
             autocorr =       1.185103477751
              std dev =       0.542867535114
             le_variance =       0.294705160680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541794895
                                         uncertainty =       0.002215686795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541794895
                                         uncertainty =       0.002215686795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383865259
  error estimate for blocks of size 2^( 2) =       0.000395321863
  error estimate for blocks of size 2^( 3) =       0.000405564393
  error estimate for blocks of size 2^( 4) =       0.000413443897
  error estimate for blocks of size 2^( 5) =       0.000417750824
  error estimate for blocks of size 2^( 6) =       0.000420312756
  error estimate for blocks of size 2^( 7) =       0.000420033042

      target function =                  N/A
              le_mean =     -17.213937222473
             les_mean =     296.632649246378
             stat err =       0.000417885130
             autocorr =       1.185103323857
              std dev =       0.542867455461
             le_variance =       0.294705074199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541839756
                                         uncertainty =       0.002215686315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541839756
                                         uncertainty =       0.002215686315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383865287
  error estimate for blocks of size 2^( 2) =       0.000395321892
  error estimate for blocks of size 2^( 3) =       0.000405564420
  error estimate for blocks of size 2^( 4) =       0.000413443931
  error estimate for blocks of size 2^( 5) =       0.000417750863
  error estimate for blocks of size 2^( 6) =       0.000420312803
  error estimate for blocks of size 2^( 7) =       0.000420033098

      target function =                  N/A
              le_mean =     -17.213937224277
             les_mean =     296.632650076926
             stat err =       0.000417885174
             autocorr =       1.185103400784
              std dev =       0.542867495267
             le_variance =       0.294705117418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541879048
                                         uncertainty =       0.002215685894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294541879048
                                         uncertainty =       0.002215685894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383865312
  error estimate for blocks of size 2^( 2) =       0.000395321918
  error estimate for blocks of size 2^( 3) =       0.000405564444
  error estimate for blocks of size 2^( 4) =       0.000413443960
  error estimate for blocks of size 2^( 5) =       0.000417750898
  error estimate for blocks of size 2^( 6) =       0.000420312845
  error estimate for blocks of size 2^( 7) =       0.000420033147

      target function =                  N/A
              le_mean =     -17.213937225855
             les_mean =     296.632651123814
             stat err =       0.000417885212
             autocorr =       1.185103468142
              std dev =       0.542867530132
             le_variance =       0.294705155271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213937226080        initial  <--
     9.0949e+02     9.0949e+03             3.6969e-07       -17.213937222473
     3.6380e+03     3.6380e+04             9.2442e-08       -17.213937224277
     1.4552e+04     1.4552e+05             2.3112e-08       -17.213937225855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9335
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.439741e-02 3 1  ON 0
ci_002                -3.400964e-02 3 1  ON 1
ci_003                -2.712862e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406925e-02 3 1  ON 4
ci_006                -2.262114e-02 3 1  ON 5
ci_007                -2.276463e-02 3 1  ON 6
ci_008                -2.005601e-02 3 1  ON 7
ci_009                -1.993885e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848135e-02 3 1  ON 10
ci_012                -1.854342e-02 3 1  ON 11
ci_013                -2.016164e-02 3 1  ON 12
ci_014                 1.686866e-02 3 1  ON 13
ci_015                 1.640745e-02 3 1  ON 14
ci_016                 1.689653e-02 3 1  ON 15
ci_017                 1.733444e-02 3 1  ON 16
ci_018                 1.542094e-02 3 1  ON 17
ci_019                 1.521829e-02 3 1  ON 18
ci_020                 1.571010e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435971e-02 3 1  ON 21
ci_023                 1.371497e-02 3 1  ON 22
ci_024                 1.236825e-02 3 1  ON 23
ci_025                 1.244486e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533508e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175922e-02 3 1  ON 30
ci_032                -1.400223e-02 3 1  ON 31
ci_033                 1.079856e-02 3 1  ON 32
ci_034                 1.073587e-02 3 1  ON 33
ci_035                -6.825072e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680547e-03 3 1  ON 37
ci_039                 3.153178e-03 3 1  ON 38
ci_040                -5.970597e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240673e-03 3 1  ON 42
ci_044                -1.528086e-02 3 1  ON 43
ci_045                -3.750716e-03 3 1  ON 44
ci_046                 6.624332e-03 3 1  ON 45
ci_047                 6.917587e-03 3 1  ON 46
ci_048                -1.219764e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469656e-03 3 1  ON 49
ci_051                 8.606319e-03 3 1  ON 50
ci_052                -8.004431e-03 3 1  ON 51
ci_053                -8.376808e-03 3 1  ON 52
ci_054                -3.256663e-03 3 1  ON 53
ci_055                -3.597624e-03 3 1  ON 54
ci_056                 6.291170e-03 3 1  ON 55
ci_057                 6.377452e-03 3 1  ON 56
ci_058                -8.053223e-03 3 1  ON 57
ci_059                -8.400192e-03 3 1  ON 58
ci_060                 8.362792e-03 3 1  ON 59
ci_061                 8.832252e-03 3 1  ON 60
ci_062                -4.333197e-03 3 1  ON 61
ci_063                -4.446176e-03 3 1  ON 62
ci_064                -4.195962e-03 3 1  ON 63
ci_065                -5.245841e-03 3 1  ON 64
ci_066                 6.507111e-03 3 1  ON 65
ci_067                 6.428315e-03 3 1  ON 66
ci_068                -5.279929e-03 3 1  ON 67
ci_069                -5.405661e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9629e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.17561
====================================================
  Execution time = 1.4174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0920e-01
  Total weights = 1.956123294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293957562863
                                         uncertainty =       0.002183474203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293957562863
                                         uncertainty =       0.002183474203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383309056
  error estimate for blocks of size 2^( 2) =       0.000395109658
  error estimate for blocks of size 2^( 3) =       0.000405459354
  error estimate for blocks of size 2^( 4) =       0.000412593628
  error estimate for blocks of size 2^( 5) =       0.000417000416
  error estimate for blocks of size 2^( 6) =       0.000418034105
  error estimate for blocks of size 2^( 7) =       0.000419118383

      target function =                  N/A
              le_mean =     -17.214630727602
             les_mean =     296.652707771783
             stat err =       0.000416686633
             autocorr =       1.181737395204
              std dev =       0.542080865157
             le_variance =       0.293851664370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721463072760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214630727592       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214630727727       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214630727660       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214630727662       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 6.281608e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214630727592       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214630727626       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214630727609       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214630727610       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 1.570429e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214630727592       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214630727600       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214630727596       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214630727592       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 3.926091e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6647e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.439742e-02 3 1  ON 0
ci_002                -3.400964e-02 3 1  ON 1
ci_003                -2.712862e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406924e-02 3 1  ON 4
ci_006                -2.262114e-02 3 1  ON 5
ci_007                -2.276463e-02 3 1  ON 6
ci_008                -2.005600e-02 3 1  ON 7
ci_009                -1.993885e-02 3 1  ON 8
ci_010                -1.859277e-02 3 1  ON 9
ci_011                -1.848135e-02 3 1  ON 10
ci_012                -1.854342e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686865e-02 3 1  ON 13
ci_015                 1.640745e-02 3 1  ON 14
ci_016                 1.689653e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542094e-02 3 1  ON 17
ci_019                 1.521829e-02 3 1  ON 18
ci_020                 1.571010e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435971e-02 3 1  ON 21
ci_023                 1.371498e-02 3 1  ON 22
ci_024                 1.236825e-02 3 1  ON 23
ci_025                 1.244487e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533508e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400223e-02 3 1  ON 31
ci_033                 1.079857e-02 3 1  ON 32
ci_034                 1.073587e-02 3 1  ON 33
ci_035                -6.825075e-03 3 1  ON 34
ci_036                -1.203785e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680550e-03 3 1  ON 37
ci_039                 3.153175e-03 3 1  ON 38
ci_040                -5.970595e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240669e-03 3 1  ON 42
ci_044                -1.528086e-02 3 1  ON 43
ci_045                -3.750713e-03 3 1  ON 44
ci_046                 6.624338e-03 3 1  ON 45
ci_047                 6.917590e-03 3 1  ON 46
ci_048                -1.219764e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469654e-03 3 1  ON 49
ci_051                 8.606324e-03 3 1  ON 50
ci_052                -8.004432e-03 3 1  ON 51
ci_053                -8.376805e-03 3 1  ON 52
ci_054                -3.256664e-03 3 1  ON 53
ci_055                -3.597631e-03 3 1  ON 54
ci_056                 6.291165e-03 3 1  ON 55
ci_057                 6.377454e-03 3 1  ON 56
ci_058                -8.053230e-03 3 1  ON 57
ci_059                -8.400197e-03 3 1  ON 58
ci_060                 8.362788e-03 3 1  ON 59
ci_061                 8.832245e-03 3 1  ON 60
ci_062                -4.333199e-03 3 1  ON 61
ci_063                -4.446173e-03 3 1  ON 62
ci_064                -4.195967e-03 3 1  ON 63
ci_065                -5.245839e-03 3 1  ON 64
ci_066                 6.507107e-03 3 1  ON 65
ci_067                 6.428317e-03 3 1  ON 66
ci_068                -5.279926e-03 3 1  ON 67
ci_069                -5.405659e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.484129
====================================================
  Execution time = 1.3796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0453e-01
  Total weights = 1.9559e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362124439
                                         uncertainty =       0.001857977506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362124439
                                         uncertainty =       0.001857977506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381705386
  error estimate for blocks of size 2^( 2) =       0.000393476419
  error estimate for blocks of size 2^( 3) =       0.000404262924
  error estimate for blocks of size 2^( 4) =       0.000412050456
  error estimate for blocks of size 2^( 5) =       0.000416721951
  error estimate for blocks of size 2^( 6) =       0.000417763687
  error estimate for blocks of size 2^( 7) =       0.000420268219

      target function =                  N/A
              le_mean =     -17.214156677032
             les_mean =     296.631718175646
             stat err =       0.000416701078
             autocorr =       1.191770613583
              std dev =       0.539812933722
             le_variance =       0.291398003413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362126441
                                         uncertainty =       0.001857977093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362126441
                                         uncertainty =       0.001857977093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381705387
  error estimate for blocks of size 2^( 2) =       0.000393476420
  error estimate for blocks of size 2^( 3) =       0.000404262925
  error estimate for blocks of size 2^( 4) =       0.000412050457
  error estimate for blocks of size 2^( 5) =       0.000416721950
  error estimate for blocks of size 2^( 6) =       0.000417763686
  error estimate for blocks of size 2^( 7) =       0.000420268216

      target function =                  N/A
              le_mean =     -17.214156677159
             les_mean =     296.631717457627
             stat err =       0.000416701077
             autocorr =       1.191770598602
              std dev =       0.539812935568
             le_variance =       0.291398005407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362125440
                                         uncertainty =       0.001857977299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362125440
                                         uncertainty =       0.001857977299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381705387
  error estimate for blocks of size 2^( 2) =       0.000393476419
  error estimate for blocks of size 2^( 3) =       0.000404262925
  error estimate for blocks of size 2^( 4) =       0.000412050456
  error estimate for blocks of size 2^( 5) =       0.000416721950
  error estimate for blocks of size 2^( 6) =       0.000417763687
  error estimate for blocks of size 2^( 7) =       0.000420268218

      target function =                  N/A
              le_mean =     -17.214156677096
             les_mean =     296.631717813694
             stat err =       0.000416701078
             autocorr =       1.191770606096
              std dev =       0.539812934645
             le_variance =       0.291398004410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362124564
                                         uncertainty =       0.001857977480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291362124564
                                         uncertainty =       0.001857977480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381705386
  error estimate for blocks of size 2^( 2) =       0.000393476419
  error estimate for blocks of size 2^( 3) =       0.000404262924
  error estimate for blocks of size 2^( 4) =       0.000412050456
  error estimate for blocks of size 2^( 5) =       0.000416721951
  error estimate for blocks of size 2^( 6) =       0.000417763687
  error estimate for blocks of size 2^( 7) =       0.000420268219

      target function =                  N/A
              le_mean =     -17.214156677040
             les_mean =     296.631718130076
             stat err =       0.000416701078
             autocorr =       1.191770612647
              std dev =       0.539812933837
             le_variance =       0.291398003538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214156677032        initial
     9.0949e+03     9.0949e+04             6.2816e-08       -17.214156677159  <--
     3.6380e+04     3.6380e+05             1.5704e-08       -17.214156677096
     1.4552e+05     1.4552e+06             3.9261e-09       -17.214156677040

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 2.2983e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.24763
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0716e-01
  Total weights = 1.955993291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292291895463
                                         uncertainty =       0.002108764102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292291895463
                                         uncertainty =       0.002108764102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382261277
  error estimate for blocks of size 2^( 2) =       0.000394477225
  error estimate for blocks of size 2^( 3) =       0.000404338593
  error estimate for blocks of size 2^( 4) =       0.000411643760
  error estimate for blocks of size 2^( 5) =       0.000416707065
  error estimate for blocks of size 2^( 6) =       0.000418332608
  error estimate for blocks of size 2^( 7) =       0.000420134170

      target function =                  N/A
              le_mean =     -17.214042384200
             les_mean =     296.630414079890
             stat err =       0.000416704401
             autocorr =       1.188325896162
              std dev =       0.540599082661
             le_variance =       0.292247368174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721404238420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214042384200       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214042382237       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214042382178       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214042382199       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 2.138685e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214042384200       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214042383709       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214042383695       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214042383706       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 5.347025e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214042384200       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214042384078       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214042384074       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214042384078       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 1.336776e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6689e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.439746e-02 3 1  ON 0
ci_002                -3.400968e-02 3 1  ON 1
ci_003                -2.712865e-02 3 1  ON 2
ci_004                 2.405236e-02 3 1  ON 3
ci_005                 2.406928e-02 3 1  ON 4
ci_006                -2.262114e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993889e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848129e-02 3 1  ON 10
ci_012                -1.854342e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640741e-02 3 1  ON 14
ci_016                 1.689652e-02 3 1  ON 15
ci_017                 1.733447e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521830e-02 3 1  ON 18
ci_020                 1.571011e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236828e-02 3 1  ON 23
ci_025                 1.244489e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408213e-02 3 1  ON 26
ci_028                -1.545636e-02 3 1  ON 27
ci_029                -1.533504e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400224e-02 3 1  ON 31
ci_033                 1.079865e-02 3 1  ON 32
ci_034                 1.073586e-02 3 1  ON 33
ci_035                -6.825061e-03 3 1  ON 34
ci_036                -1.203784e-02 3 1  ON 35
ci_037                -1.217810e-02 3 1  ON 36
ci_038                 2.680564e-03 3 1  ON 37
ci_039                 3.153160e-03 3 1  ON 38
ci_040                -5.970597e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240647e-03 3 1  ON 42
ci_044                -1.528086e-02 3 1  ON 43
ci_045                -3.750699e-03 3 1  ON 44
ci_046                 6.624366e-03 3 1  ON 45
ci_047                 6.917603e-03 3 1  ON 46
ci_048                -1.219761e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469634e-03 3 1  ON 49
ci_051                 8.606306e-03 3 1  ON 50
ci_052                -8.004435e-03 3 1  ON 51
ci_053                -8.376800e-03 3 1  ON 52
ci_054                -3.256678e-03 3 1  ON 53
ci_055                -3.597654e-03 3 1  ON 54
ci_056                 6.291160e-03 3 1  ON 55
ci_057                 6.377463e-03 3 1  ON 56
ci_058                -8.053271e-03 3 1  ON 57
ci_059                -8.400245e-03 3 1  ON 58
ci_060                 8.362794e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333200e-03 3 1  ON 61
ci_063                -4.446156e-03 3 1  ON 62
ci_064                -4.195970e-03 3 1  ON 63
ci_065                -5.245812e-03 3 1  ON 64
ci_066                 6.507106e-03 3 1  ON 65
ci_067                 6.428319e-03 3 1  ON 66
ci_068                -5.279885e-03 3 1  ON 67
ci_069                -5.405656e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.302445
====================================================
  Execution time = 1.3898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0977e-01
  Total weights = 1.9560e+06
  Execution time = 1.8082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971646165
                                         uncertainty =       0.002009312918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971646165
                                         uncertainty =       0.002009312918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384764283
  error estimate for blocks of size 2^( 2) =       0.000396708732
  error estimate for blocks of size 2^( 3) =       0.000406976013
  error estimate for blocks of size 2^( 4) =       0.000414176882
  error estimate for blocks of size 2^( 5) =       0.000418649364
  error estimate for blocks of size 2^( 6) =       0.000422345947
  error estimate for blocks of size 2^( 7) =       0.000420798851

      target function =                  N/A
              le_mean =     -17.214124596214
             les_mean =     296.635859424276
             stat err =       0.000418992761
             autocorr =       1.185833019301
              std dev =       0.544138867089
             le_variance =       0.296087106677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971661838
                                         uncertainty =       0.002009316746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971661838
                                         uncertainty =       0.002009316746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384764293
  error estimate for blocks of size 2^( 2) =       0.000396708741
  error estimate for blocks of size 2^( 3) =       0.000406976022
  error estimate for blocks of size 2^( 4) =       0.000414176891
  error estimate for blocks of size 2^( 5) =       0.000418649372
  error estimate for blocks of size 2^( 6) =       0.000422345953
  error estimate for blocks of size 2^( 7) =       0.000420798853

      target function =                  N/A
              le_mean =     -17.214124595127
             les_mean =     296.635859969351
             stat err =       0.000418992767
             autocorr =       1.185832993662
              std dev =       0.544138881005
             le_variance =       0.296087121822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971654000
                                         uncertainty =       0.002009314832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971654000
                                         uncertainty =       0.002009314832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384764288
  error estimate for blocks of size 2^( 2) =       0.000396708737
  error estimate for blocks of size 2^( 3) =       0.000406976017
  error estimate for blocks of size 2^( 4) =       0.000414176886
  error estimate for blocks of size 2^( 5) =       0.000418649368
  error estimate for blocks of size 2^( 6) =       0.000422345950
  error estimate for blocks of size 2^( 7) =       0.000420798852

      target function =                  N/A
              le_mean =     -17.214124595670
             les_mean =     296.635859694418
             stat err =       0.000418992764
             autocorr =       1.185833006481
              std dev =       0.544138874046
             le_variance =       0.296087114248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971647145
                                         uncertainty =       0.002009313158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295971647145
                                         uncertainty =       0.002009313158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384764283
  error estimate for blocks of size 2^( 2) =       0.000396708733
  error estimate for blocks of size 2^( 3) =       0.000406976013
  error estimate for blocks of size 2^( 4) =       0.000414176883
  error estimate for blocks of size 2^( 5) =       0.000418649364
  error estimate for blocks of size 2^( 6) =       0.000422345948
  error estimate for blocks of size 2^( 7) =       0.000420798851

      target function =                  N/A
              le_mean =     -17.214124596146
             les_mean =     296.635859457783
             stat err =       0.000418992761
             autocorr =       1.185833017701
              std dev =       0.544138867959
             le_variance =       0.296087107623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214124596214        initial  <--
     2.2737e+03     2.2737e+04             2.1387e-07       -17.214124595127
     9.0949e+03     9.0949e+04             5.3470e-08       -17.214124595670
     3.6380e+04     3.6380e+05             1.3368e-08       -17.214124596146

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9743
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2223
    reference variance = 0.15995
====================================================
  Execution time = 1.4109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0587e-01
  Total weights = 1.956098034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814630319
                                         uncertainty =       0.002375472898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292814630319
                                         uncertainty =       0.002375472898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382588371
  error estimate for blocks of size 2^( 2) =       0.000393803619
  error estimate for blocks of size 2^( 3) =       0.000403736999
  error estimate for blocks of size 2^( 4) =       0.000411061928
  error estimate for blocks of size 2^( 5) =       0.000414904205
  error estimate for blocks of size 2^( 6) =       0.000416591748
  error estimate for blocks of size 2^( 7) =       0.000416954537

      target function =                  N/A
              le_mean =     -17.214732305669
             les_mean =     296.652875289939
             stat err =       0.000414878104
             autocorr =       1.175919249450
              std dev =       0.541061662957
             le_variance =       0.292747723122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721473230567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214732305667       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214732305841       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214732305848       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+04 is 1.669948e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214732305667       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214732305710       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214732305712       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+04 is 4.174908e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214732305667       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214732305678       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214732305678       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 1.043730e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6590e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848134e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016164e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175924e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825086e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153162e-03 3 1  ON 38
ci_040                -5.970589e-03 3 1  ON 39
ci_041                 1.051440e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750701e-03 3 1  ON 44
ci_046                 6.624353e-03 3 1  ON 45
ci_047                 6.917601e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606337e-03 3 1  ON 50
ci_052                -8.004437e-03 3 1  ON 51
ci_053                -8.376799e-03 3 1  ON 52
ci_054                -3.256667e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291150e-03 3 1  ON 55
ci_057                 6.377461e-03 3 1  ON 56
ci_058                -8.053252e-03 3 1  ON 57
ci_059                -8.400210e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832224e-03 3 1  ON 60
ci_062                -4.333205e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195982e-03 3 1  ON 63
ci_065                -5.245829e-03 3 1  ON 64
ci_066                 6.507094e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405651e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2539
    reference variance = 0.278842
====================================================
  Execution time = 1.3713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0544e-01
  Total weights = 1.9563e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827064541
                                         uncertainty =       0.002108964036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827064541
                                         uncertainty =       0.002108964036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381943662
  error estimate for blocks of size 2^( 2) =       0.000393658771
  error estimate for blocks of size 2^( 3) =       0.000403617827
  error estimate for blocks of size 2^( 4) =       0.000411289969
  error estimate for blocks of size 2^( 5) =       0.000416375626
  error estimate for blocks of size 2^( 6) =       0.000417466405
  error estimate for blocks of size 2^( 7) =       0.000419191789

      target function =                  N/A
              le_mean =     -17.213778920406
             les_mean =     296.619626896082
             stat err =       0.000416080947
             autocorr =       1.186743999375
              std dev =       0.540149906224
             le_variance =       0.291761921194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827057426
                                         uncertainty =       0.002108964604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827057426
                                         uncertainty =       0.002108964604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381943657
  error estimate for blocks of size 2^( 2) =       0.000393658767
  error estimate for blocks of size 2^( 3) =       0.000403617823
  error estimate for blocks of size 2^( 4) =       0.000411289965
  error estimate for blocks of size 2^( 5) =       0.000416375623
  error estimate for blocks of size 2^( 6) =       0.000417466401
  error estimate for blocks of size 2^( 7) =       0.000419191786

      target function =                  N/A
              le_mean =     -17.213778920239
             les_mean =     296.619626874199
             stat err =       0.000416080944
             autocorr =       1.186744009064
              std dev =       0.540149899648
             le_variance =       0.291761914089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827060984
                                         uncertainty =       0.002108964320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827060984
                                         uncertainty =       0.002108964320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381943659
  error estimate for blocks of size 2^( 2) =       0.000393658769
  error estimate for blocks of size 2^( 3) =       0.000403617825
  error estimate for blocks of size 2^( 4) =       0.000411289967
  error estimate for blocks of size 2^( 5) =       0.000416375625
  error estimate for blocks of size 2^( 6) =       0.000417466403
  error estimate for blocks of size 2^( 7) =       0.000419191787

      target function =                  N/A
              le_mean =     -17.213778920322
             les_mean =     296.619626885139
             stat err =       0.000416080946
             autocorr =       1.186744004224
              std dev =       0.540149902936
             le_variance =       0.291761917642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827064097
                                         uncertainty =       0.002108964072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291827064097
                                         uncertainty =       0.002108964072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381943661
  error estimate for blocks of size 2^( 2) =       0.000393658771
  error estimate for blocks of size 2^( 3) =       0.000403617826
  error estimate for blocks of size 2^( 4) =       0.000411289969
  error estimate for blocks of size 2^( 5) =       0.000416375626
  error estimate for blocks of size 2^( 6) =       0.000417466404
  error estimate for blocks of size 2^( 7) =       0.000419191788

      target function =                  N/A
              le_mean =     -17.213778920395
             les_mean =     296.619626894714
             stat err =       0.000416080947
             autocorr =       1.186743999979
              std dev =       0.540149905813
             le_variance =       0.291761920750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213778920406        initial  <--
     2.2737e+04     2.2737e+05             1.6699e-08       -17.213778920239
     9.0949e+04     9.0949e+05             4.1749e-09       -17.213778920322
     3.6380e+05     3.6380e+06             1.0437e-09       -17.213778920395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8518
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1803
    reference variance = 0.291563
====================================================
  Execution time = 1.4106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0764e-01
  Total weights = 1.956280159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290454602093
                                         uncertainty =       0.001832810552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290454602093
                                         uncertainty =       0.001832810552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381100292
  error estimate for blocks of size 2^( 2) =       0.000392777173
  error estimate for blocks of size 2^( 3) =       0.000403094186
  error estimate for blocks of size 2^( 4) =       0.000411198112
  error estimate for blocks of size 2^( 5) =       0.000415171248
  error estimate for blocks of size 2^( 6) =       0.000416532726
  error estimate for blocks of size 2^( 7) =       0.000416847491

      target function =                  N/A
              le_mean =     -17.214209362367
             les_mean =     296.636639721475
             stat err =       0.000414937394
             autocorr =       1.185459136062
              std dev =       0.538957201313
             le_variance =       0.290474864848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721420936237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209362349       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209362358       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209362357       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209362244       residual = 2.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 1.978980e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209362349       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209362352       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209362351       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209362351       residual = 2.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 4.947456e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214209362349       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214209362350       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214209362350       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214209362350       residual = 2.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 1.236865e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6562e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004437e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053251e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333207e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.150577
====================================================
  Execution time = 1.3880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0541e-01
  Total weights = 1.9562e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487688577
                                         uncertainty =       0.002157572395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487688577
                                         uncertainty =       0.002157572395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381726511
  error estimate for blocks of size 2^( 2) =       0.000393593374
  error estimate for blocks of size 2^( 3) =       0.000404092183
  error estimate for blocks of size 2^( 4) =       0.000411746779
  error estimate for blocks of size 2^( 5) =       0.000416505874
  error estimate for blocks of size 2^( 6) =       0.000417767604
  error estimate for blocks of size 2^( 7) =       0.000419154451

      target function =                  N/A
              le_mean =     -17.213934717927
             les_mean =     296.624962170839
             stat err =       0.000416293677
             autocorr =       1.189309762663
              std dev =       0.539842808825
             le_variance =       0.291430258240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487690681
                                         uncertainty =       0.002157572498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487690681
                                         uncertainty =       0.002157572498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381726512
  error estimate for blocks of size 2^( 2) =       0.000393593375
  error estimate for blocks of size 2^( 3) =       0.000404092184
  error estimate for blocks of size 2^( 4) =       0.000411746781
  error estimate for blocks of size 2^( 5) =       0.000416505875
  error estimate for blocks of size 2^( 6) =       0.000417767606
  error estimate for blocks of size 2^( 7) =       0.000419154452

      target function =                  N/A
              le_mean =     -17.213934717905
             les_mean =     296.624962166549
             stat err =       0.000416293678
             autocorr =       1.189309760488
              std dev =       0.539842810770
             le_variance =       0.291430260340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487689629
                                         uncertainty =       0.002157572446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487689629
                                         uncertainty =       0.002157572446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381726512
  error estimate for blocks of size 2^( 2) =       0.000393593375
  error estimate for blocks of size 2^( 3) =       0.000404092183
  error estimate for blocks of size 2^( 4) =       0.000411746780
  error estimate for blocks of size 2^( 5) =       0.000416505874
  error estimate for blocks of size 2^( 6) =       0.000417767605
  error estimate for blocks of size 2^( 7) =       0.000419154452

      target function =                  N/A
              le_mean =     -17.213934717916
             les_mean =     296.624962168692
             stat err =       0.000416293678
             autocorr =       1.189309761577
              std dev =       0.539842809798
             le_variance =       0.291430259290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487688708
                                         uncertainty =       0.002157572401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291487688708
                                         uncertainty =       0.002157572401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381726511
  error estimate for blocks of size 2^( 2) =       0.000393593374
  error estimate for blocks of size 2^( 3) =       0.000404092183
  error estimate for blocks of size 2^( 4) =       0.000411746779
  error estimate for blocks of size 2^( 5) =       0.000416505874
  error estimate for blocks of size 2^( 6) =       0.000417767604
  error estimate for blocks of size 2^( 7) =       0.000419154451

      target function =                  N/A
              le_mean =     -17.213934717926
             les_mean =     296.624962170570
             stat err =       0.000416293677
             autocorr =       1.189309762525
              std dev =       0.539842808947
             le_variance =       0.291430258371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213934717927        initial  <--
     2.2737e+05     2.2737e+06             1.9790e-09       -17.213934717905
     9.0949e+05     9.0949e+06             4.9475e-10       -17.213934717916
     3.6380e+06     3.6380e+07             1.2369e-10       -17.213934717926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0197
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.0845
    reference variance = 0.304657
====================================================
  Execution time = 1.4092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2117e-01
  Total weights = 1.955832990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301455848940
                                         uncertainty =       0.007110613464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301455848940
                                         uncertainty =       0.007110613464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388292844
  error estimate for blocks of size 2^( 2) =       0.000399924077
  error estimate for blocks of size 2^( 3) =       0.000410821882
  error estimate for blocks of size 2^( 4) =       0.000418311726
  error estimate for blocks of size 2^( 5) =       0.000422810517
  error estimate for blocks of size 2^( 6) =       0.000424633641
  error estimate for blocks of size 2^( 7) =       0.000426055521

      target function =                  N/A
              le_mean =     -17.214382491237
             les_mean =     296.656134321856
             stat err =       0.000422952851
             autocorr =       1.186492894154
              std dev =       0.549129005493
             le_variance =       0.301542664674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721438249124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214382491250       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214382491250       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214382491251       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214382492987       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 1.964817e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214382491250       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214382491250       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214382491250       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214382492928       residual = 1.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 4.912039e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214382491250       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214382491250       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214382491250       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214382481952       residual = 1.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 1.228009e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6557e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2193
    reference variance = 0.150318
====================================================
  Execution time = 1.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0806e-01
  Total weights = 1.9561e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933673
                                         uncertainty =       0.002233440909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933673
                                         uncertainty =       0.002233440909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383548696
  error estimate for blocks of size 2^( 2) =       0.000395492890
  error estimate for blocks of size 2^( 3) =       0.000405740749
  error estimate for blocks of size 2^( 4) =       0.000413316527
  error estimate for blocks of size 2^( 5) =       0.000418550225
  error estimate for blocks of size 2^( 6) =       0.000420064027
  error estimate for blocks of size 2^( 7) =       0.000419359920

      target function =                  N/A
              le_mean =     -17.214700803133
             les_mean =     296.653981088801
             stat err =       0.000417822675
             autocorr =       1.186705591639
              std dev =       0.542419767543
             le_variance =       0.294219204221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933568
                                         uncertainty =       0.002233440903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933568
                                         uncertainty =       0.002233440903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383548696
  error estimate for blocks of size 2^( 2) =       0.000395492890
  error estimate for blocks of size 2^( 3) =       0.000405740749
  error estimate for blocks of size 2^( 4) =       0.000413316527
  error estimate for blocks of size 2^( 5) =       0.000418550225
  error estimate for blocks of size 2^( 6) =       0.000420064027
  error estimate for blocks of size 2^( 7) =       0.000419359920

      target function =                  N/A
              le_mean =     -17.214700803134
             les_mean =     296.653981088711
             stat err =       0.000417822675
             autocorr =       1.186705591763
              std dev =       0.542419767447
             le_variance =       0.294219204117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933620
                                         uncertainty =       0.002233440906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933620
                                         uncertainty =       0.002233440906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383548696
  error estimate for blocks of size 2^( 2) =       0.000395492890
  error estimate for blocks of size 2^( 3) =       0.000405740749
  error estimate for blocks of size 2^( 4) =       0.000413316527
  error estimate for blocks of size 2^( 5) =       0.000418550225
  error estimate for blocks of size 2^( 6) =       0.000420064027
  error estimate for blocks of size 2^( 7) =       0.000419359920

      target function =                  N/A
              le_mean =     -17.214700803133
             les_mean =     296.653981088756
             stat err =       0.000417822675
             autocorr =       1.186705591697
              std dev =       0.542419767495
             le_variance =       0.294219204169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933666
                                         uncertainty =       0.002233440909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294253933666
                                         uncertainty =       0.002233440909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383548696
  error estimate for blocks of size 2^( 2) =       0.000395492890
  error estimate for blocks of size 2^( 3) =       0.000405740749
  error estimate for blocks of size 2^( 4) =       0.000413316527
  error estimate for blocks of size 2^( 5) =       0.000418550225
  error estimate for blocks of size 2^( 6) =       0.000420064027
  error estimate for blocks of size 2^( 7) =       0.000419359920

      target function =                  N/A
              le_mean =     -17.214700803133
             les_mean =     296.653981088795
             stat err =       0.000417822675
             autocorr =       1.186705591651
              std dev =       0.542419767537
             le_variance =       0.294219204215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214700803133        initial
     2.2737e+06     2.2737e+07             1.9648e-10       -17.214700803134  <--
     9.0949e+06     9.0949e+07             4.9120e-11       -17.214700803133
     3.6380e+07     3.6380e+08             1.2280e-11       -17.214700803133

*****************************************************************************
Applying the update for shift_i =   2.2737e+06     and shift_s =   2.2737e+07
*****************************************************************************

  Execution time = 2.2869e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2854
    reference variance = 0.135518
====================================================
  Execution time = 1.4196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0570e-01
  Total weights = 1.956448812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292227618872
                                         uncertainty =       0.001856458110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292227618872
                                         uncertainty =       0.001856458110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382270401
  error estimate for blocks of size 2^( 2) =       0.000393889014
  error estimate for blocks of size 2^( 3) =       0.000404264610
  error estimate for blocks of size 2^( 4) =       0.000411785458
  error estimate for blocks of size 2^( 5) =       0.000416367930
  error estimate for blocks of size 2^( 6) =       0.000418596217
  error estimate for blocks of size 2^( 7) =       0.000420442717

      target function =                  N/A
              le_mean =     -17.214239109056
             les_mean =     296.635724484820
             stat err =       0.000416798081
             autocorr =       1.188803502669
              std dev =       0.540611985746
             le_variance =       0.292261319132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721423910906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214239109075       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214239109075       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214239109075       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214239109075       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+05 is 8.158743e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214239109075       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214239109075       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214239109075       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214239109075       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 2.039689e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214239109075       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214239109075       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214239109075       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214239109075       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 5.099222e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6653e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161452e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469649e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.188116
====================================================
  Execution time = 1.3806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0936e-01
  Total weights = 1.9561e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693731
                                         uncertainty =       0.002184291501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693731
                                         uncertainty =       0.002184291501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383201998
  error estimate for blocks of size 2^( 2) =       0.000394862086
  error estimate for blocks of size 2^( 3) =       0.000405980877
  error estimate for blocks of size 2^( 4) =       0.000413553419
  error estimate for blocks of size 2^( 5) =       0.000417880087
  error estimate for blocks of size 2^( 6) =       0.000419127207
  error estimate for blocks of size 2^( 7) =       0.000418456056

      target function =                  N/A
              le_mean =     -17.213725766133
             les_mean =     296.621715852327
             stat err =       0.000417254192
             autocorr =       1.185621013036
              std dev =       0.541929462915
             le_variance =       0.293687542775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693696
                                         uncertainty =       0.002184291488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693696
                                         uncertainty =       0.002184291488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383201998
  error estimate for blocks of size 2^( 2) =       0.000394862086
  error estimate for blocks of size 2^( 3) =       0.000405980877
  error estimate for blocks of size 2^( 4) =       0.000413553419
  error estimate for blocks of size 2^( 5) =       0.000417880087
  error estimate for blocks of size 2^( 6) =       0.000419127207
  error estimate for blocks of size 2^( 7) =       0.000418456056

      target function =                  N/A
              le_mean =     -17.213725766131
             les_mean =     296.621715851703
             stat err =       0.000417254192
             autocorr =       1.185621013025
              std dev =       0.541929462878
             le_variance =       0.293687542736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693714
                                         uncertainty =       0.002184291495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693714
                                         uncertainty =       0.002184291495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383201998
  error estimate for blocks of size 2^( 2) =       0.000394862086
  error estimate for blocks of size 2^( 3) =       0.000405980877
  error estimate for blocks of size 2^( 4) =       0.000413553419
  error estimate for blocks of size 2^( 5) =       0.000417880087
  error estimate for blocks of size 2^( 6) =       0.000419127207
  error estimate for blocks of size 2^( 7) =       0.000418456056

      target function =                  N/A
              le_mean =     -17.213725766132
             les_mean =     296.621715852015
             stat err =       0.000417254192
             autocorr =       1.185621013038
              std dev =       0.541929462897
             le_variance =       0.293687542756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693729
                                         uncertainty =       0.002184291500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293634693729
                                         uncertainty =       0.002184291500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383201998
  error estimate for blocks of size 2^( 2) =       0.000394862086
  error estimate for blocks of size 2^( 3) =       0.000405980877
  error estimate for blocks of size 2^( 4) =       0.000413553419
  error estimate for blocks of size 2^( 5) =       0.000417880087
  error estimate for blocks of size 2^( 6) =       0.000419127207
  error estimate for blocks of size 2^( 7) =       0.000418456056

      target function =                  N/A
              le_mean =     -17.213725766133
             les_mean =     296.621715852288
             stat err =       0.000417254192
             autocorr =       1.185621013037
              std dev =       0.541929462913
             le_variance =       0.293687542773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213725766133        initial  <--
     5.6843e+05     5.6843e+06             8.1587e-10       -17.213725766131
     2.2737e+06     2.2737e+07             2.0397e-10       -17.213725766132
     9.0949e+06     9.0949e+07             5.0992e-11       -17.213725766133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9592
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1507
    reference variance = 0.239542
====================================================
  Execution time = 1.4077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0493e-01
  Total weights = 1.956354694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291107152861
                                         uncertainty =       0.001788536324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291107152861
                                         uncertainty =       0.001788536324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381537708
  error estimate for blocks of size 2^( 2) =       0.000393370242
  error estimate for blocks of size 2^( 3) =       0.000404020203
  error estimate for blocks of size 2^( 4) =       0.000411170060
  error estimate for blocks of size 2^( 5) =       0.000416168046
  error estimate for blocks of size 2^( 6) =       0.000418343965
  error estimate for blocks of size 2^( 7) =       0.000420402715

      target function =                  N/A
              le_mean =     -17.213736546244
             les_mean =     296.617658222782
             stat err =       0.000416521196
             autocorr =       1.191788746936
              std dev =       0.539575801840
             le_variance =       0.291142045932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721373654624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+06, overlap shift 5.6843e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213736546233       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213736546234       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213736546234       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+06 is 5.243275e-11

solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213736546233       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213736546233       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213736546233       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 1.310819e-11

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213736546233       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213736546233       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213736546233       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 3.277047e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9459e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.348651
====================================================
  Execution time = 1.3870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0869e-01
  Total weights = 1.9564e+06
  Execution time = 1.8524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603742
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603742
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382716610
  error estimate for blocks of size 2^( 2) =       0.000394550917
  error estimate for blocks of size 2^( 3) =       0.000404789944
  error estimate for blocks of size 2^( 4) =       0.000412049139
  error estimate for blocks of size 2^( 5) =       0.000416938121
  error estimate for blocks of size 2^( 6) =       0.000419587812
  error estimate for blocks of size 2^( 7) =       0.000418741197

      target function =                  N/A
              le_mean =     -17.215230677710
             les_mean =     296.672859129432
             stat err =       0.000416829067
             autocorr =       1.186209423188
              std dev =       0.541243020816
             le_variance =       0.292944007583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603736
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603736
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382716610
  error estimate for blocks of size 2^( 2) =       0.000394550917
  error estimate for blocks of size 2^( 3) =       0.000404789944
  error estimate for blocks of size 2^( 4) =       0.000412049139
  error estimate for blocks of size 2^( 5) =       0.000416938121
  error estimate for blocks of size 2^( 6) =       0.000419587812
  error estimate for blocks of size 2^( 7) =       0.000418741197

      target function =                  N/A
              le_mean =     -17.215230677710
             les_mean =     296.672859129364
             stat err =       0.000416829067
             autocorr =       1.186209423212
              std dev =       0.541243020811
             le_variance =       0.292944007577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603739
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603739
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382716610
  error estimate for blocks of size 2^( 2) =       0.000394550917
  error estimate for blocks of size 2^( 3) =       0.000404789944
  error estimate for blocks of size 2^( 4) =       0.000412049139
  error estimate for blocks of size 2^( 5) =       0.000416938121
  error estimate for blocks of size 2^( 6) =       0.000419587812
  error estimate for blocks of size 2^( 7) =       0.000418741197

      target function =                  N/A
              le_mean =     -17.215230677710
             les_mean =     296.672859129398
             stat err =       0.000416829067
             autocorr =       1.186209423196
              std dev =       0.541243020814
             le_variance =       0.292944007580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603741
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293033603741
                                         uncertainty =       0.002220469525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382716610
  error estimate for blocks of size 2^( 2) =       0.000394550917
  error estimate for blocks of size 2^( 3) =       0.000404789944
  error estimate for blocks of size 2^( 4) =       0.000412049139
  error estimate for blocks of size 2^( 5) =       0.000416938121
  error estimate for blocks of size 2^( 6) =       0.000419587812
  error estimate for blocks of size 2^( 7) =       0.000418741197

      target function =                  N/A
              le_mean =     -17.215230677710
             les_mean =     296.672859129428
             stat err =       0.000416829067
             autocorr =       1.186209423198
              std dev =       0.541243020816
             le_variance =       0.292944007582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215230677710        initial  <--
     5.6843e+06     5.6843e+07             5.2433e-11       -17.215230677710
     2.2737e+07     2.2737e+08             1.3108e-11       -17.215230677710
     9.0949e+07     9.0949e+08             3.2770e-12       -17.215230677710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1883
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.3226
    reference variance = 0.430587
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0874e-01
  Total weights = 1.956163488e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295438108268
                                         uncertainty =       0.002368431194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295438108268
                                         uncertainty =       0.002368431194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384343571
  error estimate for blocks of size 2^( 2) =       0.000396108623
  error estimate for blocks of size 2^( 3) =       0.000406482223
  error estimate for blocks of size 2^( 4) =       0.000414004139
  error estimate for blocks of size 2^( 5) =       0.000418524388
  error estimate for blocks of size 2^( 6) =       0.000422427099
  error estimate for blocks of size 2^( 7) =       0.000424997935

      target function =                  N/A
              le_mean =     -17.214010748829
             les_mean =     296.630903478036
             stat err =       0.000419988390
             autocorr =       1.194085236545
              std dev =       0.543543890694
             le_variance =       0.295439961111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721401074883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214010748842       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214010748842       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214010748842       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214010729973       residual = 2.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 9.489316e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214010748842       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214010748842       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214010748842       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214010748842       residual = 2.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 2.372334e-12

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214010748842       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214010748842       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214010748842       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214011000714       residual = 2.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 5.930897e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6627e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2578
    reference variance = 0.227133
====================================================
  Execution time = 1.3815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0497e-01
  Total weights = 1.9560e+06
  Execution time = 1.8343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252293
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252293
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383108459
  error estimate for blocks of size 2^( 2) =       0.000394981166
  error estimate for blocks of size 2^( 3) =       0.000405802155
  error estimate for blocks of size 2^( 4) =       0.000413110816
  error estimate for blocks of size 2^( 5) =       0.000417287073
  error estimate for blocks of size 2^( 6) =       0.000419270314
  error estimate for blocks of size 2^( 7) =       0.000421233061

      target function =                  N/A
              le_mean =     -17.213881923043
             les_mean =     296.622705181005
             stat err =       0.000417725316
             autocorr =       1.188880245818
              std dev =       0.541797177918
             le_variance =       0.293544182000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252288
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252288
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383108459
  error estimate for blocks of size 2^( 2) =       0.000394981166
  error estimate for blocks of size 2^( 3) =       0.000405802155
  error estimate for blocks of size 2^( 4) =       0.000413110816
  error estimate for blocks of size 2^( 5) =       0.000417287073
  error estimate for blocks of size 2^( 6) =       0.000419270314
  error estimate for blocks of size 2^( 7) =       0.000421233061

      target function =                  N/A
              le_mean =     -17.213881923043
             les_mean =     296.622705180984
             stat err =       0.000417725316
             autocorr =       1.188880245838
              std dev =       0.541797177914
             le_variance =       0.293544181995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252290
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252290
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383108459
  error estimate for blocks of size 2^( 2) =       0.000394981166
  error estimate for blocks of size 2^( 3) =       0.000405802155
  error estimate for blocks of size 2^( 4) =       0.000413110816
  error estimate for blocks of size 2^( 5) =       0.000417287073
  error estimate for blocks of size 2^( 6) =       0.000419270314
  error estimate for blocks of size 2^( 7) =       0.000421233061

      target function =                  N/A
              le_mean =     -17.213881923043
             les_mean =     296.622705180994
             stat err =       0.000417725316
             autocorr =       1.188880245820
              std dev =       0.541797177916
             le_variance =       0.293544181998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252292
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293598252292
                                         uncertainty =       0.002808401598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383108459
  error estimate for blocks of size 2^( 2) =       0.000394981166
  error estimate for blocks of size 2^( 3) =       0.000405802155
  error estimate for blocks of size 2^( 4) =       0.000413110816
  error estimate for blocks of size 2^( 5) =       0.000417287073
  error estimate for blocks of size 2^( 6) =       0.000419270314
  error estimate for blocks of size 2^( 7) =       0.000421233061

      target function =                  N/A
              le_mean =     -17.213881923043
             les_mean =     296.622705181003
             stat err =       0.000417725316
             autocorr =       1.188880245819
              std dev =       0.541797177918
             le_variance =       0.293544182000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213881923043        initial  <--
     5.6843e+07     5.6843e+08             9.4893e-12       -17.213881923043
     2.2737e+08     2.2737e+09             2.3723e-12       -17.213881923043
     9.0949e+08     9.0949e+09             5.9309e-13       -17.213881923043

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0981
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1701
    reference variance = 0.381641
====================================================
  Execution time = 1.4113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1233e-01
  Total weights = 1.956198268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295765209351
                                         uncertainty =       0.002701292807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295765209351
                                         uncertainty =       0.002701292807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384548945
  error estimate for blocks of size 2^( 2) =       0.000396404385
  error estimate for blocks of size 2^( 3) =       0.000406869716
  error estimate for blocks of size 2^( 4) =       0.000414217665
  error estimate for blocks of size 2^( 5) =       0.000418430121
  error estimate for blocks of size 2^( 6) =       0.000420222589
  error estimate for blocks of size 2^( 7) =       0.000421499366

      target function =                  N/A
              le_mean =     -17.213711711347
             les_mean =     296.624204582300
             stat err =       0.000418592435
             autocorr =       1.184894004956
              std dev =       0.543834333770
             le_variance =       0.295755782587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721371171135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213711711337       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213711711337       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213711711337       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+08 is 6.140003e-13

solving harmonic davidson linear method for identity shift 2.2737e+09, overlap shift 2.2737e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213711711337       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213711711337       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213711711337       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+09 is 1.534614e-13

solving harmonic davidson linear method for identity shift 9.0949e+09, overlap shift 9.0949e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213711711337       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213711711337       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213711711337       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+09 is 3.837502e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6612e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 1.00782
====================================================
  Execution time = 1.3751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0933e-01
  Total weights = 1.9560e+06
  Execution time = 1.8424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056806
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056806
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384284213
  error estimate for blocks of size 2^( 2) =       0.000396100578
  error estimate for blocks of size 2^( 3) =       0.000407063841
  error estimate for blocks of size 2^( 4) =       0.000414647791
  error estimate for blocks of size 2^( 5) =       0.000419056522
  error estimate for blocks of size 2^( 6) =       0.000422465820
  error estimate for blocks of size 2^( 7) =       0.000423504564

      target function =                  N/A
              le_mean =     -17.213360146109
             les_mean =     296.609101421797
             stat err =       0.000419918674
             autocorr =       1.194057635755
              std dev =       0.543459945955
             le_variance =       0.295348712857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056807
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056807
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384284213
  error estimate for blocks of size 2^( 2) =       0.000396100578
  error estimate for blocks of size 2^( 3) =       0.000407063841
  error estimate for blocks of size 2^( 4) =       0.000414647791
  error estimate for blocks of size 2^( 5) =       0.000419056522
  error estimate for blocks of size 2^( 6) =       0.000422465820
  error estimate for blocks of size 2^( 7) =       0.000423504564

      target function =                  N/A
              le_mean =     -17.213360146109
             les_mean =     296.609101421797
             stat err =       0.000419918674
             autocorr =       1.194057635759
              std dev =       0.543459945955
             le_variance =       0.295348712857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056807
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056807
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384284213
  error estimate for blocks of size 2^( 2) =       0.000396100578
  error estimate for blocks of size 2^( 3) =       0.000407063841
  error estimate for blocks of size 2^( 4) =       0.000414647791
  error estimate for blocks of size 2^( 5) =       0.000419056522
  error estimate for blocks of size 2^( 6) =       0.000422465820
  error estimate for blocks of size 2^( 7) =       0.000423504564

      target function =                  N/A
              le_mean =     -17.213360146109
             les_mean =     296.609101421797
             stat err =       0.000419918674
             autocorr =       1.194057635760
              std dev =       0.543459945955
             le_variance =       0.295348712857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056806
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295369056806
                                         uncertainty =       0.002257148977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384284213
  error estimate for blocks of size 2^( 2) =       0.000396100578
  error estimate for blocks of size 2^( 3) =       0.000407063841
  error estimate for blocks of size 2^( 4) =       0.000414647791
  error estimate for blocks of size 2^( 5) =       0.000419056522
  error estimate for blocks of size 2^( 6) =       0.000422465820
  error estimate for blocks of size 2^( 7) =       0.000423504564

      target function =                  N/A
              le_mean =     -17.213360146109
             les_mean =     296.609101421797
             stat err =       0.000419918674
             autocorr =       1.194057635760
              std dev =       0.543459945955
             le_variance =       0.295348712857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213360146109        initial  <--
     5.6843e+08     5.6843e+09             6.1400e-13       -17.213360146109
     2.2737e+09     2.2737e+10             1.5346e-13       -17.213360146109
     9.0949e+09     9.0949e+10             3.8375e-14       -17.213360146109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0723
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2015
    reference variance = 0.19085
====================================================
  Execution time = 1.4131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0938e-01
  Total weights = 1.955868070e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293930378609
                                         uncertainty =       0.002377095305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293930378609
                                         uncertainty =       0.002377095305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383382771
  error estimate for blocks of size 2^( 2) =       0.000395402712
  error estimate for blocks of size 2^( 3) =       0.000405683880
  error estimate for blocks of size 2^( 4) =       0.000412760418
  error estimate for blocks of size 2^( 5) =       0.000417683371
  error estimate for blocks of size 2^( 6) =       0.000418870666
  error estimate for blocks of size 2^( 7) =       0.000420242576

      target function =                  N/A
              le_mean =     -17.214671382073
             les_mean =     296.654295231266
             stat err =       0.000417389258
             autocorr =       1.185270157419
              std dev =       0.542185114961
             le_variance =       0.293964698885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721467138207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+09, overlap shift 5.6843e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214671382076       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214671382076       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214671382076       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214668206914       residual = 2.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+09 is 8.176608e-14

solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214671382076       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214671382076       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214671382076       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214675189654       residual = 1.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+10 is 2.041951e-14

solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214671382076       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214671382076       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214671382076       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214671382076       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214603142120       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214703775258       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214582102241       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214548460709       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214713403331       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214633425050       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214717860402       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214727274011       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214705985604       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214621171576       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214677653685       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214458409860       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214678693940       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214647265023       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214668602724       residual = 3.11e-08           smallest_sin_value = 9.98e-01
davidson iteration   19 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+10 is 5.104770e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6628e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2516
    reference variance = 0.241749
====================================================
  Execution time = 1.3722e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1825e-01
  Total weights = 1.9561e+06
  Execution time = 1.8390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386382199
  error estimate for blocks of size 2^( 2) =       0.000397874646
  error estimate for blocks of size 2^( 3) =       0.000408192553
  error estimate for blocks of size 2^( 4) =       0.000415817797
  error estimate for blocks of size 2^( 5) =       0.000420560063
  error estimate for blocks of size 2^( 6) =       0.000423440181
  error estimate for blocks of size 2^( 7) =       0.000425257354

      target function =                  N/A
              le_mean =     -17.213935414177
             les_mean =     296.637820479413
             stat err =       0.000421268849
             autocorr =       1.188733416744
              std dev =       0.546426946747
             le_variance =       0.298582408131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386382199
  error estimate for blocks of size 2^( 2) =       0.000397874646
  error estimate for blocks of size 2^( 3) =       0.000408192553
  error estimate for blocks of size 2^( 4) =       0.000415817797
  error estimate for blocks of size 2^( 5) =       0.000420560063
  error estimate for blocks of size 2^( 6) =       0.000423440181
  error estimate for blocks of size 2^( 7) =       0.000425257354

      target function =                  N/A
              le_mean =     -17.213935414177
             les_mean =     296.637820479413
             stat err =       0.000421268849
             autocorr =       1.188733416759
              std dev =       0.546426946747
             le_variance =       0.298582408131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386382199
  error estimate for blocks of size 2^( 2) =       0.000397874646
  error estimate for blocks of size 2^( 3) =       0.000408192553
  error estimate for blocks of size 2^( 4) =       0.000415817797
  error estimate for blocks of size 2^( 5) =       0.000420560063
  error estimate for blocks of size 2^( 6) =       0.000423440181
  error estimate for blocks of size 2^( 7) =       0.000425257354

      target function =                  N/A
              le_mean =     -17.213935414177
             les_mean =     296.637820479413
             stat err =       0.000421268849
             autocorr =       1.188733416758
              std dev =       0.546426946747
             le_variance =       0.298582408131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298550902869
                                         uncertainty =       0.003960564149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386382199
  error estimate for blocks of size 2^( 2) =       0.000397874646
  error estimate for blocks of size 2^( 3) =       0.000408192553
  error estimate for blocks of size 2^( 4) =       0.000415817797
  error estimate for blocks of size 2^( 5) =       0.000420560063
  error estimate for blocks of size 2^( 6) =       0.000423440181
  error estimate for blocks of size 2^( 7) =       0.000425257354

      target function =                  N/A
              le_mean =     -17.213935414177
             les_mean =     296.637820479413
             stat err =       0.000421268849
             autocorr =       1.188733416744
              std dev =       0.546426946747
             le_variance =       0.298582408131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213935414177        initial  <--
     5.6843e+09     5.6843e+10             8.1766e-14       -17.213935414177
     2.2737e+10     2.2737e+11             2.0420e-14       -17.213935414177
     9.0949e+10     9.0949e+11             5.1048e-15       -17.213935414177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0102
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2054
    reference variance = 0.35618
====================================================
  Execution time = 1.4122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1293e-01
  Total weights = 1.956252342e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183282792
                                         uncertainty =       0.006237374434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183282792
                                         uncertainty =       0.006237374434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386086903
  error estimate for blocks of size 2^( 2) =       0.000397813119
  error estimate for blocks of size 2^( 3) =       0.000407695006
  error estimate for blocks of size 2^( 4) =       0.000414851837
  error estimate for blocks of size 2^( 5) =       0.000419699457
  error estimate for blocks of size 2^( 6) =       0.000423362088
  error estimate for blocks of size 2^( 7) =       0.000423478573

      target function =                  N/A
              le_mean =     -17.213709511539
             les_mean =     296.624725233744
             stat err =       0.000420347989
             autocorr =       1.185353286349
              std dev =       0.546009334512
             le_variance =       0.298126193374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721370951154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+10, overlap shift 5.6843e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213709511523       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213709511523       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213709511523       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213709511523       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+10 is 7.193570e-15

solving harmonic davidson linear method for identity shift 2.2737e+11, overlap shift 2.2737e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213709511523       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213709511523       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213709511523       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213709511523       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213706387085       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+11 is 1.787104e-15

solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213709511523       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213709511523       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213709511523       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213708352896       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213579845113       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213756058228       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213825567245       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214218082641       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213076771173       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213502391415       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215018900537       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213420881951       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213499520448       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213760645050       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213387763860       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214063345152       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213795572087       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.212736177255       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213443630953       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213359483440       residual = 1.40e-04           smallest_sin_value = 9.99e-01
davidson iteration   20:   krylov dim =  21   energy =     -17.214680800381       residual = 6.34e-06           smallest_sin_value = 9.98e-01
davidson iteration   21:   krylov dim =  22   energy =     -17.213916256957       residual = 1.08e-05           smallest_sin_value = 9.94e-01
davidson iteration   22:   krylov dim =  23   energy =     -17.213097285529       residual = 1.42e-05           smallest_sin_value = 9.91e-01
davidson iteration   23 stopping due to small subspace S singular value of 8.65e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+11 is 4.561160e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6599e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.176836
====================================================
  Execution time = 1.3771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0373e-01
  Total weights = 1.9560e+06
  Execution time = 1.8302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381202149
  error estimate for blocks of size 2^( 2) =       0.000392842639
  error estimate for blocks of size 2^( 3) =       0.000403442384
  error estimate for blocks of size 2^( 4) =       0.000411641783
  error estimate for blocks of size 2^( 5) =       0.000416633384
  error estimate for blocks of size 2^( 6) =       0.000418488560
  error estimate for blocks of size 2^( 7) =       0.000419992290

      target function =                  N/A
              le_mean =     -17.215125581391
             les_mean =     296.664278410631
             stat err =       0.000416689004
             autocorr =       1.194850034536
              std dev =       0.539101248700
             le_variance =       0.290630156350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381202149
  error estimate for blocks of size 2^( 2) =       0.000392842639
  error estimate for blocks of size 2^( 3) =       0.000403442384
  error estimate for blocks of size 2^( 4) =       0.000411641783
  error estimate for blocks of size 2^( 5) =       0.000416633384
  error estimate for blocks of size 2^( 6) =       0.000418488560
  error estimate for blocks of size 2^( 7) =       0.000419992290

      target function =                  N/A
              le_mean =     -17.215125581391
             les_mean =     296.664278410631
             stat err =       0.000416689004
             autocorr =       1.194850034535
              std dev =       0.539101248700
             le_variance =       0.290630156350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381202149
  error estimate for blocks of size 2^( 2) =       0.000392842639
  error estimate for blocks of size 2^( 3) =       0.000403442384
  error estimate for blocks of size 2^( 4) =       0.000411641783
  error estimate for blocks of size 2^( 5) =       0.000416633384
  error estimate for blocks of size 2^( 6) =       0.000418488560
  error estimate for blocks of size 2^( 7) =       0.000419992290

      target function =                  N/A
              le_mean =     -17.215125581391
             les_mean =     296.664278410631
             stat err =       0.000416689004
             autocorr =       1.194850034539
              std dev =       0.539101248700
             le_variance =       0.290630156350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290363475206
                                         uncertainty =       0.001972927601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381202149
  error estimate for blocks of size 2^( 2) =       0.000392842639
  error estimate for blocks of size 2^( 3) =       0.000403442384
  error estimate for blocks of size 2^( 4) =       0.000411641783
  error estimate for blocks of size 2^( 5) =       0.000416633384
  error estimate for blocks of size 2^( 6) =       0.000418488560
  error estimate for blocks of size 2^( 7) =       0.000419992290

      target function =                  N/A
              le_mean =     -17.215125581391
             les_mean =     296.664278410631
             stat err =       0.000416689004
             autocorr =       1.194850034537
              std dev =       0.539101248700
             le_variance =       0.290630156350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215125581391        initial  <--
     5.6843e+10     5.6843e+11             7.1936e-15       -17.215125581391
     2.2737e+11     2.2737e+12             1.7871e-15       -17.215125581391
     9.0949e+11     9.0949e+12             4.5612e-16       -17.215125581391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0313
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.439745e-02 3 1  ON 0
ci_002                -3.400965e-02 3 1  ON 1
ci_003                -2.712864e-02 3 1  ON 2
ci_004                 2.405235e-02 3 1  ON 3
ci_005                 2.406923e-02 3 1  ON 4
ci_006                -2.262115e-02 3 1  ON 5
ci_007                -2.276461e-02 3 1  ON 6
ci_008                -2.005599e-02 3 1  ON 7
ci_009                -1.993886e-02 3 1  ON 8
ci_010                -1.859276e-02 3 1  ON 9
ci_011                -1.848133e-02 3 1  ON 10
ci_012                -1.854341e-02 3 1  ON 11
ci_013                -2.016165e-02 3 1  ON 12
ci_014                 1.686862e-02 3 1  ON 13
ci_015                 1.640744e-02 3 1  ON 14
ci_016                 1.689654e-02 3 1  ON 15
ci_017                 1.733445e-02 3 1  ON 16
ci_018                 1.542095e-02 3 1  ON 17
ci_019                 1.521831e-02 3 1  ON 18
ci_020                 1.571012e-02 3 1  ON 19
ci_021                 1.564981e-02 3 1  ON 20
ci_022                 1.435968e-02 3 1  ON 21
ci_023                 1.371499e-02 3 1  ON 22
ci_024                 1.236826e-02 3 1  ON 23
ci_025                 1.244488e-02 3 1  ON 24
ci_026                 1.365554e-02 3 1  ON 25
ci_027                 1.408211e-02 3 1  ON 26
ci_028                -1.545635e-02 3 1  ON 27
ci_029                -1.533505e-02 3 1  ON 28
ci_030                -1.161451e-02 3 1  ON 29
ci_031                -1.175923e-02 3 1  ON 30
ci_032                -1.400222e-02 3 1  ON 31
ci_033                 1.079862e-02 3 1  ON 32
ci_034                 1.073585e-02 3 1  ON 33
ci_035                -6.825085e-03 3 1  ON 34
ci_036                -1.203786e-02 3 1  ON 35
ci_037                -1.217809e-02 3 1  ON 36
ci_038                 2.680556e-03 3 1  ON 37
ci_039                 3.153165e-03 3 1  ON 38
ci_040                -5.970590e-03 3 1  ON 39
ci_041                 1.051441e-02 3 1  ON 40
ci_042                 1.061541e-02 3 1  ON 41
ci_043                -5.240658e-03 3 1  ON 42
ci_044                -1.528088e-02 3 1  ON 43
ci_045                -3.750702e-03 3 1  ON 44
ci_046                 6.624355e-03 3 1  ON 45
ci_047                 6.917600e-03 3 1  ON 46
ci_048                -1.219762e-02 3 1  ON 47
ci_049                -1.192556e-02 3 1  ON 48
ci_050                 8.469648e-03 3 1  ON 49
ci_051                 8.606338e-03 3 1  ON 50
ci_052                -8.004436e-03 3 1  ON 51
ci_053                -8.376798e-03 3 1  ON 52
ci_054                -3.256666e-03 3 1  ON 53
ci_055                -3.597652e-03 3 1  ON 54
ci_056                 6.291151e-03 3 1  ON 55
ci_057                 6.377459e-03 3 1  ON 56
ci_058                -8.053250e-03 3 1  ON 57
ci_059                -8.400211e-03 3 1  ON 58
ci_060                 8.362776e-03 3 1  ON 59
ci_061                 8.832226e-03 3 1  ON 60
ci_062                -4.333206e-03 3 1  ON 61
ci_063                -4.446163e-03 3 1  ON 62
ci_064                -4.195983e-03 3 1  ON 63
ci_065                -5.245830e-03 3 1  ON 64
ci_066                 6.507095e-03 3 1  ON 65
ci_067                 6.428322e-03 3 1  ON 66
ci_068                -5.279916e-03 3 1  ON 67
ci_069                -5.405652e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9635e+01 secs
  Total Execution time = 2.4024e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
