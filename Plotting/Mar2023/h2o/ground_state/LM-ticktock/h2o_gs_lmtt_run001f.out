Rank =    0  Free Memory = 71113 MB
Rank =    1  Free Memory = 71112 MB
Rank =    2  Free Memory = 71112 MB
Rank =    3  Free Memory = 71112 MB
Rank =    4  Free Memory = 71112 MB
Rank =    5  Free Memory = 71112 MB
Rank =    6  Free Memory = 71112 MB
Rank =    7  Free Memory = 71112 MB
Rank =    8  Free Memory = 71112 MB
Rank =    9  Free Memory = 71112 MB
Rank =   10  Free Memory = 71112 MB
Rank =   11  Free Memory = 71112 MB
Rank =   12  Free Memory = 71112 MB
Rank =   13  Free Memory = 71112 MB
Rank =   14  Free Memory = 71098 MB
Rank =   15  Free Memory = 71097 MB
Rank =   16  Free Memory = 71097 MB
Rank =   17  Free Memory = 71097 MB
Rank =   18  Free Memory = 71097 MB
Rank =   19  Free Memory = 71097 MB
Rank =   20  Free Memory = 71097 MB
Rank =   21  Free Memory = 71097 MB
Rank =   22  Free Memory = 71097 MB
Rank =   23  Free Memory = 71097 MB
Rank =   24  Free Memory = 71097 MB
Rank =   25  Free Memory = 71097 MB
Rank =   26  Free Memory = 71097 MB
Rank =   27  Free Memory = 71097 MB
Rank =   28  Free Memory = 71097 MB
Rank =   29  Free Memory = 71097 MB
Rank =   30  Free Memory = 71097 MB
Rank =   31  Free Memory = 71097 MB
Rank =   32  Free Memory = 73135 MB
Rank =   33  Free Memory = 73135 MB
Rank =   34  Free Memory = 73135 MB
Rank =   35  Free Memory = 73135 MB
Rank =   36  Free Memory = 73135 MB
Rank =   37  Free Memory = 73135 MB
Rank =   38  Free Memory = 73135 MB
Rank =   39  Free Memory = 73135 MB
Rank =   40  Free Memory = 73135 MB
Rank =   41  Free Memory = 73135 MB
Rank =   42  Free Memory = 73135 MB
Rank =   43  Free Memory = 73135 MB
Rank =   44  Free Memory = 73135 MB
Rank =   45  Free Memory = 73135 MB
Rank =   46  Free Memory = 73135 MB
Rank =   47  Free Memory = 73135 MB
Rank =   48  Free Memory = 73135 MB
Rank =   49  Free Memory = 73135 MB
Rank =   50  Free Memory = 73134 MB
Rank =   51  Free Memory = 73134 MB
Rank =   52  Free Memory = 73134 MB
Rank =   53  Free Memory = 73134 MB
Rank =   54  Free Memory = 73134 MB
Rank =   55  Free Memory = 73134 MB
Rank =   56  Free Memory = 73134 MB
Rank =   57  Free Memory = 73134 MB
Rank =   58  Free Memory = 73134 MB
Rank =   59  Free Memory = 73134 MB
Rank =   60  Free Memory = 73134 MB
Rank =   61  Free Memory = 73134 MB
Rank =   62  Free Memory = 73134 MB
Rank =   63  Free Memory = 73134 MB
Rank =   64  Free Memory = 89733 MB
Rank =   65  Free Memory = 89733 MB
Rank =   66  Free Memory = 89733 MB
Rank =   67  Free Memory = 89733 MB
Rank =   68  Free Memory = 89733 MB
Rank =   69  Free Memory = 89733 MB
Rank =   70  Free Memory = 89733 MB
Rank =   71  Free Memory = 89733 MB
Rank =   72  Free Memory = 89733 MB
Rank =   73  Free Memory = 89733 MB
Rank =   74  Free Memory = 89733 MB
Rank =   75  Free Memory = 89733 MB
Rank =   76  Free Memory = 89733 MB
Rank =   77  Free Memory = 89733 MB
Rank =   78  Free Memory = 89733 MB
Rank =   79  Free Memory = 89732 MB
Rank =   80  Free Memory = 89732 MB
Rank =   81  Free Memory = 89732 MB
Rank =   82  Free Memory = 89732 MB
Rank =   83  Free Memory = 89732 MB
Rank =   84  Free Memory = 89732 MB
Rank =   85  Free Memory = 89732 MB
Rank =   86  Free Memory = 89732 MB
Rank =   87  Free Memory = 89732 MB
Rank =   88  Free Memory = 89732 MB
Rank =   89  Free Memory = 89732 MB
Rank =   90  Free Memory = 89732 MB
Rank =   91  Free Memory = 89732 MB
Rank =   92  Free Memory = 89732 MB
Rank =   93  Free Memory = 89732 MB
Rank =   94  Free Memory = 89732 MB
Rank =   95  Free Memory = 89732 MB
Rank =   96  Free Memory = 62993 MB
Rank =   97  Free Memory = 62993 MB
Rank =   98  Free Memory = 62993 MB
Rank =   99  Free Memory = 62993 MB
Rank =  100  Free Memory = 62993 MB
Rank =  101  Free Memory = 62993 MB
Rank =  102  Free Memory = 62993 MB
Rank =  103  Free Memory = 62993 MB
Rank =  104  Free Memory = 62993 MB
Rank =  105  Free Memory = 62993 MB
Rank =  106  Free Memory = 62993 MB
Rank =  107  Free Memory = 62993 MB
Rank =  108  Free Memory = 62993 MB
Rank =  109  Free Memory = 62993 MB
Rank =  110  Free Memory = 62993 MB
Rank =  111  Free Memory = 62993 MB
Rank =  112  Free Memory = 62993 MB
Rank =  113  Free Memory = 62993 MB
Rank =  114  Free Memory = 62993 MB
Rank =  115  Free Memory = 62993 MB
Rank =  116  Free Memory = 62993 MB
Rank =  117  Free Memory = 62993 MB
Rank =  118  Free Memory = 62993 MB
Rank =  119  Free Memory = 62993 MB
Rank =  120  Free Memory = 62993 MB
Rank =  121  Free Memory = 62993 MB
Rank =  122  Free Memory = 62993 MB
Rank =  123  Free Memory = 62993 MB
Rank =  124  Free Memory = 62993 MB
Rank =  125  Free Memory = 62993 MB
Rank =  126  Free Memory = 62993 MB
Rank =  127  Free Memory = 62993 MB
  Input file(s): opt_h2o_gs_lmtt_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001f.xml

  Project = H2O
  date    = 2023-03-06 13:53:12 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 200

  Range of prime numbers to use as seeds over processors and threads = 1231-2213


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.911967e-01    1         1  ON     0
     uu_1                 2.952136e-02    1         1  ON     1
     uu_2                -6.465040e-02    1         1  ON     2
     uu_3                -1.204190e-01    1         1  ON     3
     uu_4                -1.562044e-01    1         1  ON     4
     uu_5                -1.681909e-01    1         1  ON     5
     uu_6                -1.563004e-01    1         1  ON     6
     uu_7                -1.093951e-01    1         1  ON     7
     uu_8                -3.891562e-02    1         1  ON     8
     uu_9                 2.013265e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.529731e-01    1         1  ON     0
     ud_1                 9.540209e-02    1         1  ON     1
     ud_2                -1.296613e-02    1         1  ON     2
     ud_3                -7.411366e-02    1         1  ON     3
     ud_4                -1.245724e-01    1         1  ON     4
     ud_5                -1.629623e-01    1         1  ON     5
     ud_6                -1.779116e-01    1         1  ON     6
     ud_7                -1.588952e-01    1         1  ON     7
     ud_8                -1.113543e-01    1         1  ON     8
     ud_9                 3.229722e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.136376e-01    1         1  ON     0
     eO_1                -5.950502e-01    1         1  ON     1
     eO_2                -1.857512e-01    1         1  ON     2
     eO_3                 8.168652e-02    1         1  ON     3
     eO_4                 2.059842e-01    1         1  ON     4
     eO_5                 2.973205e-01    1         1  ON     5
     eO_6                 3.259205e-01    1         1  ON     6
     eO_7                 5.328910e-01    1         1  ON     7
     eO_8                 1.580914e-01    1         1  ON     8
     eO_9                 5.331355e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.218423e-01    1         1  ON     0
     eH1_1                -1.430037e-01    1         1  ON     1
     eH1_2                -1.019338e-01    1         1  ON     2
     eH1_3                -6.433220e-02    1         1  ON     3
     eH1_4                -1.811495e-02    1         1  ON     4
     eH1_5                -4.815560e-03    1         1  ON     5
     eH1_6                 3.565050e-02    1         1  ON     6
     eH1_7                 7.899260e-02    1         1  ON     7
     eH1_8                 2.643002e-01    1         1  ON     8
     eH1_9                 1.135317e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.106720e-01    1         1  ON     0
     eH2_1                -1.318816e-01    1         1  ON     1
     eH2_2                -9.075272e-02    1         1  ON     2
     eH2_3                -5.299842e-02    1         1  ON     3
     eH2_4                -6.342495e-03    1         1  ON     4
     eH2_5                 5.548739e-03    1         1  ON     5
     eH2_6                 4.766135e-02    1         1  ON     6
     eH2_7                 3.899821e-02    1         1  ON     7
     eH2_8                 2.479170e-01    1         1  ON     8
     eH2_9                 1.153680e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.708028e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3441e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.205624
====================================================
  Execution time = 2.0988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1757e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317646454598
                                         uncertainty =       0.003069601813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317646454598
                                         uncertainty =       0.003069601813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398480836
  error estimate for blocks of size 2^( 2) =       0.000407738238
  error estimate for blocks of size 2^( 3) =       0.000416551765
  error estimate for blocks of size 2^( 4) =       0.000422856875
  error estimate for blocks of size 2^( 5) =       0.000427520199
  error estimate for blocks of size 2^( 6) =       0.000429145827
  error estimate for blocks of size 2^( 7) =       0.000427834212

      target function =                  N/A
              le_mean =     -17.216553339975
             les_mean =     296.727282703191
             stat err =       0.000426839278
             autocorr =       1.147397431175
              std dev =       0.563537003032
             le_variance =       0.317573953786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721655333997e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553339975       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552674297       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552150165       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553616603       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216552991977       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554528362       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554359522       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216555227809       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216555417871       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216555493506       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.472213e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553339975       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553081337       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552747001       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553292209       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553152795       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553613609       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553543465       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216553705521       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.669878e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216553339975       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216553264917       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216553150263       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553300912       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216553274163       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553393255       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216553376208       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216553409036       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.253258e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6517e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.913231e-01                 1 1 ON  0
uu_1  2.951524e-02                 1 1 ON  1
uu_2  -6.466671e-02                1 1 ON  2
uu_3  -1.204010e-01                1 1 ON  3
uu_4  -1.562073e-01                1 1 ON  4
uu_5  -1.681614e-01                1 1 ON  5
uu_6  -1.562914e-01                1 1 ON  6
uu_7  -1.094814e-01                1 1 ON  7
uu_8  -3.897638e-02                1 1 ON  8
uu_9  2.012853e-01                 1 1 ON  9
ud_0  3.532813e-01                 1 1 ON  10
ud_1  9.557935e-02                 1 1 ON  11
ud_2  -1.305710e-02                1 1 ON  12
ud_3  -7.431369e-02                1 1 ON  13
ud_4  -1.246853e-01                1 1 ON  14
ud_5  -1.629046e-01                1 1 ON  15
ud_6  -1.778424e-01                1 1 ON  16
ud_7  -1.589504e-01                1 1 ON  17
ud_8  -1.114508e-01                1 1 ON  18
ud_9  3.223246e-02                 1 1 ON  19
eO_0  -9.141045e-01                1 1 ON  20
eO_1  -5.952062e-01                1 1 ON  21
eO_2  -1.854343e-01                1 1 ON  22
eO_3  8.196225e-02                 1 1 ON  23
eO_4  2.061427e-01                 1 1 ON  24
eO_5  2.972637e-01                 1 1 ON  25
eO_6  3.258906e-01                 1 1 ON  26
eO_7  5.328378e-01                 1 1 ON  27
eO_8  1.580964e-01                 1 1 ON  28
eO_9  5.331864e-02                 1 1 ON  29
eH1_0 -2.218358e-01                1 1 ON  30
eH1_1 -1.430188e-01                1 1 ON  31
eH1_2 -1.019280e-01                1 1 ON  32
eH1_3 -6.440708e-02                1 1 ON  33
eH1_4 -1.808830e-02                1 1 ON  34
eH1_5 -4.703371e-03                1 1 ON  35
eH1_6 3.569304e-02                 1 1 ON  36
eH1_7 7.891933e-02                 1 1 ON  37
eH1_8 2.642618e-01                 1 1 ON  38
eH1_9 1.135349e-01                 1 1 ON  39
eH2_0 -2.106385e-01                1 1 ON  40
eH2_1 -1.318382e-01                1 1 ON  41
eH2_2 -9.064186e-02                1 1 ON  42
eH2_3 -5.299874e-02                1 1 ON  43
eH2_4 -6.373457e-03                1 1 ON  44
eH2_5 5.545620e-03                 1 1 ON  45
eH2_6 4.754224e-02                 1 1 ON  46
eH2_7 3.899990e-02                 1 1 ON  47
eH2_8 2.478784e-01                 1 1 ON  48
eH2_9 1.153647e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.282797
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1801e-01
  Total weights = 2.0000e+06
  Execution time = 1.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317708110599
                                         uncertainty =       0.003372921499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317708110599
                                         uncertainty =       0.003372921499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398581245
  error estimate for blocks of size 2^( 2) =       0.000408045124
  error estimate for blocks of size 2^( 3) =       0.000416789910
  error estimate for blocks of size 2^( 4) =       0.000422999221
  error estimate for blocks of size 2^( 5) =       0.000426372919
  error estimate for blocks of size 2^( 6) =       0.000426258497
  error estimate for blocks of size 2^( 7) =       0.000426315842

      target function =                  N/A
              le_mean =     -17.216469389434
             les_mean =     296.724552096782
             stat err =       0.000425486620
             autocorr =       1.139562358177
              std dev =       0.563679002903
             le_variance =       0.317734018314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318451553207
                                         uncertainty =       0.003378922659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318451553207
                                         uncertainty =       0.003378922659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399047154
  error estimate for blocks of size 2^( 2) =       0.000408487369
  error estimate for blocks of size 2^( 3) =       0.000417204033
  error estimate for blocks of size 2^( 4) =       0.000423389505
  error estimate for blocks of size 2^( 5) =       0.000426761394
  error estimate for blocks of size 2^( 6) =       0.000426626489
  error estimate for blocks of size 2^( 7) =       0.000426678531

      target function =                  N/A
              le_mean =     -17.216469235462
             les_mean =     296.725290038296
             stat err =       0.000425863980
             autocorr =       1.138920424247
              std dev =       0.564337896956
             le_variance =       0.318477261941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318262181189
                                         uncertainty =       0.003377457050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318262181189
                                         uncertainty =       0.003377457050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398928539
  error estimate for blocks of size 2^( 2) =       0.000408374077
  error estimate for blocks of size 2^( 3) =       0.000417097717
  error estimate for blocks of size 2^( 4) =       0.000423289008
  error estimate for blocks of size 2^( 5) =       0.000426661466
  error estimate for blocks of size 2^( 6) =       0.000426529908
  error estimate for blocks of size 2^( 7) =       0.000426583887

      target function =                  N/A
              le_mean =     -17.216468634884
             les_mean =     296.725080055561
             stat err =       0.000425766067
             autocorr =       1.139073842503
              std dev =       0.564170150556
             le_variance =       0.318287958778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317785947850
                                         uncertainty =       0.003373562216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317785947850
                                         uncertainty =       0.003373562216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398630054
  error estimate for blocks of size 2^( 2) =       0.000408091202
  error estimate for blocks of size 2^( 3) =       0.000416832876
  error estimate for blocks of size 2^( 4) =       0.000423039474
  error estimate for blocks of size 2^( 5) =       0.000426412964
  error estimate for blocks of size 2^( 6) =       0.000426295880
  error estimate for blocks of size 2^( 7) =       0.000426352772

      target function =                  N/A
              le_mean =     -17.216469102705
             les_mean =     296.724620045628
             stat err =       0.000425525272
             autocorr =       1.139490318688
              std dev =       0.563748028951
             le_variance =       0.317811840146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216469389434        initial  <--
     2.5000e-01     2.5000e+00             1.4722e-03       -17.216469235462
     1.0000e+00     1.0000e+01             4.6699e-04       -17.216468634884
     4.0000e+00     4.0000e+01             1.2533e-04       -17.216469102705

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6707
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229722e-02 1 1  ON 19
 eO_0                -9.136376e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815560e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548739e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.188993
====================================================
  Execution time = 2.0244e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316055825151
                                         uncertainty =       0.003265125702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316055825151
                                         uncertainty =       0.003265125702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397500397
  error estimate for blocks of size 2^( 2) =       0.000407087421
  error estimate for blocks of size 2^( 3) =       0.000415235153
  error estimate for blocks of size 2^( 4) =       0.000421127946
  error estimate for blocks of size 2^( 5) =       0.000425650010
  error estimate for blocks of size 2^( 6) =       0.000426857642
  error estimate for blocks of size 2^( 7) =       0.000428794200

      target function =                  N/A
              le_mean =     -17.216820061042
             les_mean =     296.734905988272
             stat err =       0.000425607449
             autocorr =       1.146418820883
              std dev =       0.562150453144
             le_variance =       0.316013131970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682006104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820061042       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820186473       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820093580       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216820329099       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216820515392       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216820579382       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216820593083       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216820582160       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.094151e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820061042       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820094240       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820067088       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216820125588       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216820176051       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216820194375       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216820195927       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.367690e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820061042       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820069465       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820062401       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216820077005       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216820089806       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216820094563       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216820094849       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.355190e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5805e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.912087e-01 1 1  ON 0
 uu_1                 2.952592e-02 1 1  ON 1
 uu_2                -6.465021e-02 1 1  ON 2
 uu_3                -1.204201e-01 1 1  ON 3
 uu_4                -1.562195e-01 1 1  ON 4
 uu_5                -1.681893e-01 1 1  ON 5
 uu_6                -1.563022e-01 1 1  ON 6
 uu_7                -1.093971e-01 1 1  ON 7
 uu_8                -3.891543e-02 1 1  ON 8
 uu_9                 2.013241e-01 1 1  ON 9
 ud_0                 3.529993e-01 1 1  ON 10
 ud_1                 9.541828e-02 1 1  ON 11
 ud_2                -1.298118e-02 1 1  ON 12
 ud_3                -7.413905e-02 1 1  ON 13
 ud_4                -1.245835e-01 1 1  ON 14
 ud_5                -1.629554e-01 1 1  ON 15
 ud_6                -1.779065e-01 1 1  ON 16
 ud_7                -1.588942e-01 1 1  ON 17
 ud_8                -1.113566e-01 1 1  ON 18
 ud_9                 3.229404e-02 1 1  ON 19
 eO_0                -9.136912e-01 1 1  ON 20
 eO_1                -5.950648e-01 1 1  ON 21
 eO_2                -1.857213e-01 1 1  ON 22
 eO_3                 8.172457e-02 1 1  ON 23
 eO_4                 2.059930e-01 1 1  ON 24
 eO_5                 2.973128e-01 1 1  ON 25
 eO_6                 3.259207e-01 1 1  ON 26
 eO_7                 5.328881e-01 1 1  ON 27
 eO_8                 1.580926e-01 1 1  ON 28
 eO_9                 5.331419e-02 1 1  ON 29
eH1_0                -2.218557e-01 1 1  ON 30
eH1_1                -1.430041e-01 1 1  ON 31
eH1_2                -1.019393e-01 1 1  ON 32
eH1_3                -6.432654e-02 1 1  ON 33
eH1_4                -1.810744e-02 1 1  ON 34
eH1_5                -4.808243e-03 1 1  ON 35
eH1_6                 3.565363e-02 1 1  ON 36
eH1_7                 7.898924e-02 1 1  ON 37
eH1_8                 2.642978e-01 1 1  ON 38
eH1_9                 1.135321e-01 1 1  ON 39
eH2_0                -2.106731e-01 1 1  ON 40
eH2_1                -1.318826e-01 1 1  ON 41
eH2_2                -9.074526e-02 1 1  ON 42
eH2_3                -5.300591e-02 1 1  ON 43
eH2_4                -6.338048e-03 1 1  ON 44
eH2_5                 5.546615e-03 1 1  ON 45
eH2_6                 4.765731e-02 1 1  ON 46
eH2_7                 3.900319e-02 1 1  ON 47
eH2_8                 2.479157e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1583
    reference variance = 0.192285
====================================================
  Execution time = 1.9828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1873e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318774872497
                                         uncertainty =       0.007136927786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318774872497
                                         uncertainty =       0.007136927786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399186798
  error estimate for blocks of size 2^( 2) =       0.000408638190
  error estimate for blocks of size 2^( 3) =       0.000416904275
  error estimate for blocks of size 2^( 4) =       0.000422523563
  error estimate for blocks of size 2^( 5) =       0.000426445853
  error estimate for blocks of size 2^( 6) =       0.000428254318
  error estimate for blocks of size 2^( 7) =       0.000427895743

      target function =                  N/A
              le_mean =     -17.216863172239
             les_mean =     296.739077531926
             stat err =       0.000426279869
             autocorr =       1.140347744323
              std dev =       0.564535383902
             le_variance =       0.318700199678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318885323103
                                         uncertainty =       0.007137326391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318885323103
                                         uncertainty =       0.007137326391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399255957
  error estimate for blocks of size 2^( 2) =       0.000408702610
  error estimate for blocks of size 2^( 3) =       0.000416964198
  error estimate for blocks of size 2^( 4) =       0.000422580478
  error estimate for blocks of size 2^( 5) =       0.000426502227
  error estimate for blocks of size 2^( 6) =       0.000428308677
  error estimate for blocks of size 2^( 7) =       0.000427949056

      target function =                  N/A
              le_mean =     -17.216863333034
             les_mean =     296.739193507310
             stat err =       0.000426335109
             autocorr =       1.140248182862
              std dev =       0.564633189211
             le_variance =       0.318810638359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318831686430
                                         uncertainty =       0.007137027520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318831686430
                                         uncertainty =       0.007137027520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399222375
  error estimate for blocks of size 2^( 2) =       0.000408671262
  error estimate for blocks of size 2^( 3) =       0.000416934978
  error estimate for blocks of size 2^( 4) =       0.000422552695
  error estimate for blocks of size 2^( 5) =       0.000426474717
  error estimate for blocks of size 2^( 6) =       0.000428282150
  error estimate for blocks of size 2^( 7) =       0.000427922966

      target function =                  N/A
              le_mean =     -17.216863243456
             les_mean =     296.739136793364
             stat err =       0.000426308132
             autocorr =       1.140295701519
              std dev =       0.564585696661
             le_variance =       0.318757008875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318782031524
                                         uncertainty =       0.007136937248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318782031524
                                         uncertainty =       0.007136937248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399191281
  error estimate for blocks of size 2^( 2) =       0.000408642353
  error estimate for blocks of size 2^( 3) =       0.000416908136
  error estimate for blocks of size 2^( 4) =       0.000422527225
  error estimate for blocks of size 2^( 5) =       0.000426449481
  error estimate for blocks of size 2^( 6) =       0.000428257815
  error estimate for blocks of size 2^( 7) =       0.000427899159

      target function =                  N/A
              le_mean =     -17.216863179592
             les_mean =     296.739084943605
             stat err =       0.000426283420
             autocorr =       1.140341127221
              std dev =       0.564541724018
             le_variance =       0.318707358157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216863172239        initial
     2.5000e+00     2.5000e+01             2.0942e-04       -17.216863333034  <--
     1.0000e+01     1.0000e+02             5.3677e-05       -17.216863243456
     4.0000e+01     4.0000e+02             1.3552e-05       -17.216863179592

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9286e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.912451e-01 1 1  ON 0
 uu_1                 2.953975e-02 1 1  ON 1
 uu_2                -6.464672e-02 1 1  ON 2
 uu_3                -1.204257e-01 1 1  ON 3
 uu_4                -1.562625e-01 1 1  ON 4
 uu_5                -1.681876e-01 1 1  ON 5
 uu_6                -1.563083e-01 1 1  ON 6
 uu_7                -1.094030e-01 1 1  ON 7
 uu_8                -3.891481e-02 1 1  ON 8
 uu_9                 2.013169e-01 1 1  ON 9
 ud_0                 3.530742e-01 1 1  ON 10
 ud_1                 9.546049e-02 1 1  ON 11
 ud_2                -1.302110e-02 1 1  ON 12
 ud_3                -7.420739e-02 1 1  ON 13
 ud_4                -1.246170e-01 1 1  ON 14
 ud_5                -1.629384e-01 1 1  ON 15
 ud_6                -1.778907e-01 1 1  ON 16
 ud_7                -1.588909e-01 1 1  ON 17
 ud_8                -1.113639e-01 1 1  ON 18
 ud_9                 3.228415e-02 1 1  ON 19
 eO_0                -9.138470e-01 1 1  ON 20
 eO_1                -5.951063e-01 1 1  ON 21
 eO_2                -1.856435e-01 1 1  ON 22
 eO_3                 8.183832e-02 1 1  ON 23
 eO_4                 2.060234e-01 1 1  ON 24
 eO_5                 2.972899e-01 1 1  ON 25
 eO_6                 3.259215e-01 1 1  ON 26
 eO_7                 5.328789e-01 1 1  ON 27
 eO_8                 1.580961e-01 1 1  ON 28
 eO_9                 5.331621e-02 1 1  ON 29
eH1_0                -2.218943e-01 1 1  ON 30
eH1_1                -1.430071e-01 1 1  ON 31
eH1_2                -1.019563e-01 1 1  ON 32
eH1_3                -6.431026e-02 1 1  ON 33
eH1_4                -1.808468e-02 1 1  ON 34
eH1_5                -4.785370e-03 1 1  ON 35
eH1_6                 3.566379e-02 1 1  ON 36
eH1_7                 7.897891e-02 1 1  ON 37
eH1_8                 2.642907e-01 1 1  ON 38
eH1_9                 1.135334e-01 1 1  ON 39
eH2_0                -2.106755e-01 1 1  ON 40
eH2_1                -1.318850e-01 1 1  ON 41
eH2_2                -9.072436e-02 1 1  ON 42
eH2_3                -5.302557e-02 1 1  ON 43
eH2_4                -6.328704e-03 1 1  ON 44
eH2_5                 5.540281e-03 1 1  ON 45
eH2_6                 4.764561e-02 1 1  ON 46
eH2_7                 3.901883e-02 1 1  ON 47
eH2_8                 2.479117e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.443856
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326200665499
                                         uncertainty =       0.005648782021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326200665499
                                         uncertainty =       0.005648782021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403876686
  error estimate for blocks of size 2^( 2) =       0.000412869333
  error estimate for blocks of size 2^( 3) =       0.000421138770
  error estimate for blocks of size 2^( 4) =       0.000427313060
  error estimate for blocks of size 2^( 5) =       0.000431021004
  error estimate for blocks of size 2^( 6) =       0.000433476239
  error estimate for blocks of size 2^( 7) =       0.000434789157

      target function =                  N/A
              le_mean =     -17.216594509840
             les_mean =     296.737359107424
             stat err =       0.000431649865
             autocorr =       1.142261795163
              std dev =       0.571167886249
             le_variance =       0.326232754282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659450984e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594509840       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216595153251       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216595368215       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216595597104       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216596711066       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216596845214       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216597076907       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216596882350       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216596950875       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 7.179631e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594509840       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594715509       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594796537       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594844174       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216595172626       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216595207321       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216595239946       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216595208011       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.048504e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216594509840       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216594565107       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216594588168       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216594599176       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216594683702       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216594692108       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216594697974       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.276706e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5866e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.912672e-01 1 1  ON 0
 uu_1                 2.954923e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204341e-01 1 1  ON 3
 uu_4                -1.562548e-01 1 1  ON 4
 uu_5                -1.681955e-01 1 1  ON 5
 uu_6                -1.563188e-01 1 1  ON 6
 uu_7                -1.094213e-01 1 1  ON 7
 uu_8                -3.891247e-02 1 1  ON 8
 uu_9                 2.013079e-01 1 1  ON 9
 ud_0                 3.531660e-01 1 1  ON 10
 ud_1                 9.554684e-02 1 1  ON 11
 ud_2                -1.307926e-02 1 1  ON 12
 ud_3                -7.429778e-02 1 1  ON 13
 ud_4                -1.246637e-01 1 1  ON 14
 ud_5                -1.629235e-01 1 1  ON 15
 ud_6                -1.778642e-01 1 1  ON 16
 ud_7                -1.589081e-01 1 1  ON 17
 ud_8                -1.113748e-01 1 1  ON 18
 ud_9                 3.227786e-02 1 1  ON 19
 eO_0                -9.140518e-01 1 1  ON 20
 eO_1                -5.951583e-01 1 1  ON 21
 eO_2                -1.855431e-01 1 1  ON 22
 eO_3                 8.198647e-02 1 1  ON 23
 eO_4                 2.060865e-01 1 1  ON 24
 eO_5                 2.972508e-01 1 1  ON 25
 eO_6                 3.259046e-01 1 1  ON 26
 eO_7                 5.328634e-01 1 1  ON 27
 eO_8                 1.581076e-01 1 1  ON 28
 eO_9                 5.332010e-02 1 1  ON 29
eH1_0                -2.218450e-01 1 1  ON 30
eH1_1                -1.430121e-01 1 1  ON 31
eH1_2                -1.019728e-01 1 1  ON 32
eH1_3                -6.432533e-02 1 1  ON 33
eH1_4                -1.809511e-02 1 1  ON 34
eH1_5                -4.749152e-03 1 1  ON 35
eH1_6                 3.566373e-02 1 1  ON 36
eH1_7                 7.894171e-02 1 1  ON 37
eH1_8                 2.642763e-01 1 1  ON 38
eH1_9                 1.135409e-01 1 1  ON 39
eH2_0                -2.106670e-01 1 1  ON 40
eH2_1                -1.318849e-01 1 1  ON 41
eH2_2                -9.073311e-02 1 1  ON 42
eH2_3                -5.301379e-02 1 1  ON 43
eH2_4                -6.330770e-03 1 1  ON 44
eH2_5                 5.532403e-03 1 1  ON 45
eH2_6                 4.763553e-02 1 1  ON 46
eH2_7                 3.903296e-02 1 1  ON 47
eH2_8                 2.479032e-01 1 1  ON 48
eH2_9                 1.153686e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2202
    reference variance = 0.192956
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2152e-01
  Total weights = 2.0000e+06
  Execution time = 1.8818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321409744819
                                         uncertainty =       0.004565634556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321409744819
                                         uncertainty =       0.004565634556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400884366
  error estimate for blocks of size 2^( 2) =       0.000410526013
  error estimate for blocks of size 2^( 3) =       0.000418967044
  error estimate for blocks of size 2^( 4) =       0.000425229205
  error estimate for blocks of size 2^( 5) =       0.000429515778
  error estimate for blocks of size 2^( 6) =       0.000431174321
  error estimate for blocks of size 2^( 7) =       0.000432979482

      target function =                  N/A
              le_mean =     -17.216461985983
             les_mean =     296.727979704142
             stat err =       0.000429724697
             autocorr =       1.149059155805
              std dev =       0.566936107545
             le_variance =       0.321416550038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321765512898
                                         uncertainty =       0.004568512946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321765512898
                                         uncertainty =       0.004568512946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106239
  error estimate for blocks of size 2^( 2) =       0.000410734598
  error estimate for blocks of size 2^( 3) =       0.000419164222
  error estimate for blocks of size 2^( 4) =       0.000425415526
  error estimate for blocks of size 2^( 5) =       0.000429691922
  error estimate for blocks of size 2^( 6) =       0.000431346146
  error estimate for blocks of size 2^( 7) =       0.000433146766

      target function =                  N/A
              le_mean =     -17.216464272002
             les_mean =     296.728414297858
             stat err =       0.000429900090
             autocorr =       1.148725435898
              std dev =       0.567249882868
             le_variance =       0.321772429613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321617748981
                                         uncertainty =       0.004567442306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321617748981
                                         uncertainty =       0.004567442306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401014104
  error estimate for blocks of size 2^( 2) =       0.000410647379
  error estimate for blocks of size 2^( 3) =       0.000419081509
  error estimate for blocks of size 2^( 4) =       0.000425337012
  error estimate for blocks of size 2^( 5) =       0.000429616984
  error estimate for blocks of size 2^( 6) =       0.000431273120
  error estimate for blocks of size 2^( 7) =       0.000433075182

      target function =                  N/A
              le_mean =     -17.216463476133
             les_mean =     296.728239088185
             stat err =       0.000429825574
             autocorr =       1.148854973098
              std dev =       0.567119585255
             le_variance =       0.321624623980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321435639601
                                         uncertainty =       0.004565866062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321435639601
                                         uncertainty =       0.004565866062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400900520
  error estimate for blocks of size 2^( 2) =       0.000410541060
  error estimate for blocks of size 2^( 3) =       0.000418981200
  error estimate for blocks of size 2^( 4) =       0.000425242477
  error estimate for blocks of size 2^( 5) =       0.000429528158
  error estimate for blocks of size 2^( 6) =       0.000431186379
  error estimate for blocks of size 2^( 7) =       0.000432991094

      target function =                  N/A
              le_mean =     -17.216462168151
             les_mean =     296.728011881148
             stat err =       0.000429737027
             autocorr =       1.149032492007
              std dev =       0.566958953106
             le_variance =       0.321442454507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216461985983        initial
     6.2500e-01     6.2500e+00             7.1796e-04       -17.216464272002  <--
     2.5000e+00     2.5000e+01             2.0485e-04       -17.216463476133
     1.0000e+01     1.0000e+02             5.2767e-05       -17.216462168151

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9582e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.913441e-01 1 1  ON 0
 uu_1                 2.958045e-02 1 1  ON 1
 uu_2                -6.465749e-02 1 1  ON 2
 uu_3                -1.204536e-01 1 1  ON 3
 uu_4                -1.562592e-01 1 1  ON 4
 uu_5                -1.682170e-01 1 1  ON 5
 uu_6                -1.563489e-01 1 1  ON 6
 uu_7                -1.094748e-01 1 1  ON 7
 uu_8                -3.890541e-02 1 1  ON 8
 uu_9                 2.012814e-01 1 1  ON 9
 ud_0                 3.533950e-01 1 1  ON 10
 ud_1                 9.571768e-02 1 1  ON 11
 ud_2                -1.318002e-02 1 1  ON 12
 ud_3                -7.450435e-02 1 1  ON 13
 ud_4                -1.248021e-01 1 1  ON 14
 ud_5                -1.629019e-01 1 1  ON 15
 ud_6                -1.777784e-01 1 1  ON 16
 ud_7                -1.589506e-01 1 1  ON 17
 ud_8                -1.114051e-01 1 1  ON 18
 ud_9                 3.225950e-02 1 1  ON 19
 eO_0                -9.145649e-01 1 1  ON 20
 eO_1                -5.953073e-01 1 1  ON 21
 eO_2                -1.853330e-01 1 1  ON 22
 eO_3                 8.238941e-02 1 1  ON 23
 eO_4                 2.062854e-01 1 1  ON 24
 eO_5                 2.971458e-01 1 1  ON 25
 eO_6                 3.258562e-01 1 1  ON 26
 eO_7                 5.328181e-01 1 1  ON 27
 eO_8                 1.581416e-01 1 1  ON 28
 eO_9                 5.333160e-02 1 1  ON 29
eH1_0                -2.217190e-01 1 1  ON 30
eH1_1                -1.430389e-01 1 1  ON 31
eH1_2                -1.020043e-01 1 1  ON 32
eH1_3                -6.435951e-02 1 1  ON 33
eH1_4                -1.812358e-02 1 1  ON 34
eH1_5                -4.647455e-03 1 1  ON 35
eH1_6                 3.566880e-02 1 1  ON 36
eH1_7                 7.883362e-02 1 1  ON 37
eH1_8                 2.642340e-01 1 1  ON 38
eH1_9                 1.135633e-01 1 1  ON 39
eH2_0                -2.106427e-01 1 1  ON 40
eH2_1                -1.318908e-01 1 1  ON 41
eH2_2                -9.074295e-02 1 1  ON 42
eH2_3                -5.299960e-02 1 1  ON 43
eH2_4                -6.335257e-03 1 1  ON 44
eH2_5                 5.513527e-03 1 1  ON 45
eH2_6                 4.761024e-02 1 1  ON 46
eH2_7                 3.907571e-02 1 1  ON 47
eH2_8                 2.478783e-01 1 1  ON 48
eH2_9                 1.153703e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2475
    reference variance = 0.155005
====================================================
  Execution time = 2.2609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1996e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320019403391
                                         uncertainty =       0.004985583874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320019403391
                                         uncertainty =       0.004985583874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399976265
  error estimate for blocks of size 2^( 2) =       0.000409481009
  error estimate for blocks of size 2^( 3) =       0.000417669519
  error estimate for blocks of size 2^( 4) =       0.000423633830
  error estimate for blocks of size 2^( 5) =       0.000426708728
  error estimate for blocks of size 2^( 6) =       0.000428381752
  error estimate for blocks of size 2^( 7) =       0.000429876668

      target function =                  N/A
              le_mean =     -17.217419572672
             les_mean =     296.759498606821
             stat err =       0.000427150244
             autocorr =       1.140493663534
              std dev =       0.565651858821
             le_variance =       0.319962025388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721741957267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217419572672       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217419373585       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217420187947       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217422434194       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217421120661       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217422385064       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217423839719       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217423612854       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217423366275       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217423601298       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217423460744       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.708001e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217419572672       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217419484004       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217419903827       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217420863742       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217420433463       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217420781570       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217421044832       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217420992253       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.626236e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217419572672       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217419545122       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217419687125       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217419984165       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217419878966       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217419950086       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217419988751       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.526249e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8237e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.915272e-01 1 1  ON 0
 uu_1                 2.956650e-02 1 1  ON 1
 uu_2                -6.460148e-02 1 1  ON 2
 uu_3                -1.204507e-01 1 1  ON 3
 uu_4                -1.563057e-01 1 1  ON 4
 uu_5                -1.681947e-01 1 1  ON 5
 uu_6                -1.564465e-01 1 1  ON 6
 uu_7                -1.095606e-01 1 1  ON 7
 uu_8                -3.892021e-02 1 1  ON 8
 uu_9                 2.012391e-01 1 1  ON 9
 ud_0                 3.536992e-01 1 1  ON 10
 ud_1                 9.589427e-02 1 1  ON 11
 ud_2                -1.325369e-02 1 1  ON 12
 ud_3                -7.465765e-02 1 1  ON 13
 ud_4                -1.250204e-01 1 1  ON 14
 ud_5                -1.627172e-01 1 1  ON 15
 ud_6                -1.777630e-01 1 1  ON 16
 ud_7                -1.590902e-01 1 1  ON 17
 ud_8                -1.114659e-01 1 1  ON 18
 ud_9                 3.219924e-02 1 1  ON 19
 eO_0                -9.151276e-01 1 1  ON 20
 eO_1                -5.955189e-01 1 1  ON 21
 eO_2                -1.850864e-01 1 1  ON 22
 eO_3                 8.289696e-02 1 1  ON 23
 eO_4                 2.064932e-01 1 1  ON 24
 eO_5                 2.970628e-01 1 1  ON 25
 eO_6                 3.257865e-01 1 1  ON 26
 eO_7                 5.327541e-01 1 1  ON 27
 eO_8                 1.581606e-01 1 1  ON 28
 eO_9                 5.333986e-02 1 1  ON 29
eH1_0                -2.217163e-01 1 1  ON 30
eH1_1                -1.430898e-01 1 1  ON 31
eH1_2                -1.018998e-01 1 1  ON 32
eH1_3                -6.433740e-02 1 1  ON 33
eH1_4                -1.799696e-02 1 1  ON 34
eH1_5                -4.664462e-03 1 1  ON 35
eH1_6                 3.563190e-02 1 1  ON 36
eH1_7                 7.872051e-02 1 1  ON 37
eH1_8                 2.641814e-01 1 1  ON 38
eH1_9                 1.135699e-01 1 1  ON 39
eH2_0                -2.107125e-01 1 1  ON 40
eH2_1                -1.317925e-01 1 1  ON 41
eH2_2                -9.069582e-02 1 1  ON 42
eH2_3                -5.303695e-02 1 1  ON 43
eH2_4                -6.306812e-03 1 1  ON 44
eH2_5                 5.504083e-03 1 1  ON 45
eH2_6                 4.758209e-02 1 1  ON 46
eH2_7                 3.908417e-02 1 1  ON 47
eH2_8                 2.478331e-01 1 1  ON 48
eH2_9                 1.153718e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2717
    reference variance = 0.305974
====================================================
  Execution time = 2.0156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2889e-01
  Total weights = 2.0000e+06
  Execution time = 1.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328696386491
                                         uncertainty =       0.004983081031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328696386491
                                         uncertainty =       0.004983081031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405354828
  error estimate for blocks of size 2^( 2) =       0.000414769290
  error estimate for blocks of size 2^( 3) =       0.000423139750
  error estimate for blocks of size 2^( 4) =       0.000429178022
  error estimate for blocks of size 2^( 5) =       0.000433525907
  error estimate for blocks of size 2^( 6) =       0.000434842570
  error estimate for blocks of size 2^( 7) =       0.000437312467

      target function =                  N/A
              le_mean =     -17.217458021673
             les_mean =     296.769485636992
             stat err =       0.000433714741
             autocorr =       1.144821209681
              std dev =       0.573258295389
             le_variance =       0.328625073232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329383156723
                                         uncertainty =       0.004991676738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329383156723
                                         uncertainty =       0.004991676738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405778216
  error estimate for blocks of size 2^( 2) =       0.000415172780
  error estimate for blocks of size 2^( 3) =       0.000423519063
  error estimate for blocks of size 2^( 4) =       0.000429544196
  error estimate for blocks of size 2^( 5) =       0.000433886261
  error estimate for blocks of size 2^( 6) =       0.000435186280
  error estimate for blocks of size 2^( 7) =       0.000437666744

      target function =                  N/A
              le_mean =     -17.217458061839
             les_mean =     296.770173867071
             stat err =       0.000434070870
             autocorr =       1.144310354363
              std dev =       0.573857055846
             le_variance =       0.329311920544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329226158161
                                         uncertainty =       0.004989148553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329226158161
                                         uncertainty =       0.004989148553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405681502
  error estimate for blocks of size 2^( 2) =       0.000415079518
  error estimate for blocks of size 2^( 3) =       0.000423429868
  error estimate for blocks of size 2^( 4) =       0.000429458231
  error estimate for blocks of size 2^( 5) =       0.000433801339
  error estimate for blocks of size 2^( 6) =       0.000435104772
  error estimate for blocks of size 2^( 7) =       0.000437585906

      target function =                  N/A
              le_mean =     -17.217457521500
             les_mean =     296.769998301473
             stat err =       0.000433987562
             autocorr =       1.144416618329
              std dev =       0.573720281491
             le_variance =       0.329154961395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328772656180
                                         uncertainty =       0.004983914682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328772656180
                                         uncertainty =       0.004983914682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405401876
  error estimate for blocks of size 2^( 2) =       0.000414813813
  error estimate for blocks of size 2^( 3) =       0.000423181128
  error estimate for blocks of size 2^( 4) =       0.000429217865
  error estimate for blocks of size 2^( 5) =       0.000433565026
  error estimate for blocks of size 2^( 6) =       0.000434879573
  error estimate for blocks of size 2^( 7) =       0.000437351558

      target function =                  N/A
              le_mean =     -17.217457741355
             les_mean =     296.769552273841
             stat err =       0.000433753506
             autocorr =       1.144760106328
              std dev =       0.573324831885
             le_variance =       0.328701362856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217458021673        initial
     1.5625e-01     1.5625e+00             1.7080e-03       -17.217458061839  <--
     6.2500e-01     6.2500e+00             5.6262e-04       -17.217457521500
     2.5000e+00     2.5000e+01             1.5262e-04       -17.217457741355

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9620e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.919163e-01 1 1  ON 0
 uu_1                 2.969309e-02 1 1  ON 1
 uu_2                -6.448211e-02 1 1  ON 2
 uu_3                -1.204536e-01 1 1  ON 3
 uu_4                -1.564161e-01 1 1  ON 4
 uu_5                -1.682614e-01 1 1  ON 5
 uu_6                -1.566293e-01 1 1  ON 6
 uu_7                -1.097790e-01 1 1  ON 7
 uu_8                -3.895831e-02 1 1  ON 8
 uu_9                 2.011048e-01 1 1  ON 9
 ud_0                 3.541884e-01 1 1  ON 10
 ud_1                 9.618173e-02 1 1  ON 11
 ud_2                -1.324983e-02 1 1  ON 12
 ud_3                -7.486888e-02 1 1  ON 13
 ud_4                -1.253401e-01 1 1  ON 14
 ud_5                -1.625812e-01 1 1  ON 15
 ud_6                -1.775632e-01 1 1  ON 16
 ud_7                -1.593967e-01 1 1  ON 17
 ud_8                -1.116357e-01 1 1  ON 18
 ud_9                 3.200851e-02 1 1  ON 19
 eO_0                -9.162729e-01 1 1  ON 20
 eO_1                -5.960595e-01 1 1  ON 21
 eO_2                -1.848029e-01 1 1  ON 22
 eO_3                 8.393354e-02 1 1  ON 23
 eO_4                 2.072862e-01 1 1  ON 24
 eO_5                 2.969258e-01 1 1  ON 25
 eO_6                 3.256008e-01 1 1  ON 26
 eO_7                 5.325552e-01 1 1  ON 27
 eO_8                 1.582226e-01 1 1  ON 28
 eO_9                 5.336655e-02 1 1  ON 29
eH1_0                -2.216630e-01 1 1  ON 30
eH1_1                -1.430968e-01 1 1  ON 31
eH1_2                -1.017386e-01 1 1  ON 32
eH1_3                -6.423116e-02 1 1  ON 33
eH1_4                -1.781178e-02 1 1  ON 34
eH1_5                -4.668026e-03 1 1  ON 35
eH1_6                 3.559457e-02 1 1  ON 36
eH1_7                 7.838046e-02 1 1  ON 37
eH1_8                 2.640160e-01 1 1  ON 38
eH1_9                 1.135917e-01 1 1  ON 39
eH2_0                -2.107721e-01 1 1  ON 40
eH2_1                -1.317030e-01 1 1  ON 41
eH2_2                -9.062501e-02 1 1  ON 42
eH2_3                -5.304201e-02 1 1  ON 43
eH2_4                -6.308812e-03 1 1  ON 44
eH2_5                 5.494269e-03 1 1  ON 45
eH2_6                 4.756369e-02 1 1  ON 46
eH2_7                 3.913476e-02 1 1  ON 47
eH2_8                 2.476922e-01 1 1  ON 48
eH2_9                 1.153773e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7873e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2156
    reference variance = 0.251727
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1861e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318645521832
                                         uncertainty =       0.003581693694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318645521832
                                         uncertainty =       0.003581693694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399133523
  error estimate for blocks of size 2^( 2) =       0.000408462068
  error estimate for blocks of size 2^( 3) =       0.000417040210
  error estimate for blocks of size 2^( 4) =       0.000422771736
  error estimate for blocks of size 2^( 5) =       0.000425477722
  error estimate for blocks of size 2^( 6) =       0.000427383333
  error estimate for blocks of size 2^( 7) =       0.000425851687

      target function =                  N/A
              le_mean =     -17.217273189765
             les_mean =     296.753111070866
             stat err =       0.000425371120
             autocorr =       1.135794048460
              std dev =       0.564460042129
             le_variance =       0.318615139161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721727318977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217273189765       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217274800600       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276805600       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217276888809       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217278560955       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217281393044       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217283968416       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217282948005       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217281382315       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217281931809       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217281818646       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217281831892       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.862883e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217273189765       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217274267130       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276001143       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217276209003       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217277068545       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217278294427       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217279274679       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217278514673       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217278171270       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217278380319       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.307697e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217273189765       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217273653207       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217274662337       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217274856737       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217275285330       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217275421170       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217275584157       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217275444081       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.565786e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5820e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.921862e-01 1 1  ON 0
 uu_1                 2.984685e-02 1 1  ON 1
 uu_2                -6.439971e-02 1 1  ON 2
 uu_3                -1.204819e-01 1 1  ON 3
 uu_4                -1.563558e-01 1 1  ON 4
 uu_5                -1.683733e-01 1 1  ON 5
 uu_6                -1.567307e-01 1 1  ON 6
 uu_7                -1.100053e-01 1 1  ON 7
 uu_8                -3.903633e-02 1 1  ON 8
 uu_9                 2.009095e-01 1 1  ON 9
 ud_0                 3.547168e-01 1 1  ON 10
 ud_1                 9.628671e-02 1 1  ON 11
 ud_2                -1.329015e-02 1 1  ON 12
 ud_3                -7.534486e-02 1 1  ON 13
 ud_4                -1.257399e-01 1 1  ON 14
 ud_5                -1.629791e-01 1 1  ON 15
 ud_6                -1.769685e-01 1 1  ON 16
 ud_7                -1.590041e-01 1 1  ON 17
 ud_8                -1.118261e-01 1 1  ON 18
 ud_9                 3.181803e-02 1 1  ON 19
 eO_0                -9.175806e-01 1 1  ON 20
 eO_1                -5.965307e-01 1 1  ON 21
 eO_2                -1.843536e-01 1 1  ON 22
 eO_3                 8.475997e-02 1 1  ON 23
 eO_4                 2.080929e-01 1 1  ON 24
 eO_5                 2.968263e-01 1 1  ON 25
 eO_6                 3.255191e-01 1 1  ON 26
 eO_7                 5.323179e-01 1 1  ON 27
 eO_8                 1.583142e-01 1 1  ON 28
 eO_9                 5.337996e-02 1 1  ON 29
eH1_0                -2.217205e-01 1 1  ON 30
eH1_1                -1.428581e-01 1 1  ON 31
eH1_2                -1.016155e-01 1 1  ON 32
eH1_3                -6.424923e-02 1 1  ON 33
eH1_4                -1.780533e-02 1 1  ON 34
eH1_5                -4.502170e-03 1 1  ON 35
eH1_6                 3.567874e-02 1 1  ON 36
eH1_7                 7.794953e-02 1 1  ON 37
eH1_8                 2.638514e-01 1 1  ON 38
eH1_9                 1.136187e-01 1 1  ON 39
eH2_0                -2.110326e-01 1 1  ON 40
eH2_1                -1.319619e-01 1 1  ON 41
eH2_2                -9.065095e-02 1 1  ON 42
eH2_3                -5.307867e-02 1 1  ON 43
eH2_4                -6.308541e-03 1 1  ON 44
eH2_5                 5.687525e-03 1 1  ON 45
eH2_6                 4.776559e-02 1 1  ON 46
eH2_7                 3.945737e-02 1 1  ON 47
eH2_8                 2.475453e-01 1 1  ON 48
eH2_9                 1.153708e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1734
    reference variance = 0.369404
====================================================
  Execution time = 2.0232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2537e-01
  Total weights = 2.0000e+06
  Execution time = 1.8755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324732636143
                                         uncertainty =       0.007317015694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324732636143
                                         uncertainty =       0.007317015694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402990957
  error estimate for blocks of size 2^( 2) =       0.000412454836
  error estimate for blocks of size 2^( 3) =       0.000421360919
  error estimate for blocks of size 2^( 4) =       0.000427138489
  error estimate for blocks of size 2^( 5) =       0.000430422443
  error estimate for blocks of size 2^( 6) =       0.000432242801
  error estimate for blocks of size 2^( 7) =       0.000432196420

      target function =                  N/A
              le_mean =     -17.217634587410
             les_mean =     296.771744045992
             stat err =       0.000430500038
             autocorr =       1.141184296554
              std dev =       0.569915276875
             le_variance =       0.324803422816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325711474977
                                         uncertainty =       0.007367046829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325711474977
                                         uncertainty =       0.007367046829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403597719
  error estimate for blocks of size 2^( 2) =       0.000413040903
  error estimate for blocks of size 2^( 3) =       0.000421918579
  error estimate for blocks of size 2^( 4) =       0.000427678066
  error estimate for blocks of size 2^( 5) =       0.000430955465
  error estimate for blocks of size 2^( 6) =       0.000432762246
  error estimate for blocks of size 2^( 7) =       0.000432713676

      target function =                  N/A
              le_mean =     -17.217639080938
             les_mean =     296.772877595759
             stat err =       0.000431027363
             autocorr =       1.140544613413
              std dev =       0.570773367638
             le_variance =       0.325782237204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325867454593
                                         uncertainty =       0.007368616861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325867454593
                                         uncertainty =       0.007368616861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403694459
  error estimate for blocks of size 2^( 2) =       0.000413134819
  error estimate for blocks of size 2^( 3) =       0.000422010230
  error estimate for blocks of size 2^( 4) =       0.000427767236
  error estimate for blocks of size 2^( 5) =       0.000431042814
  error estimate for blocks of size 2^( 6) =       0.000432845329
  error estimate for blocks of size 2^( 7) =       0.000432795676

      target function =                  N/A
              le_mean =     -17.217640128207
             les_mean =     296.773069854477
             stat err =       0.000431112764
             autocorr =       1.140449830162
              std dev =       0.570910179464
             le_variance =       0.325938433016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324971519415
                                         uncertainty =       0.007327389962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324971519415
                                         uncertainty =       0.007327389962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403139182
  error estimate for blocks of size 2^( 2) =       0.000412597715
  error estimate for blocks of size 2^( 3) =       0.000421497478
  error estimate for blocks of size 2^( 4) =       0.000427270864
  error estimate for blocks of size 2^( 5) =       0.000430552642
  error estimate for blocks of size 2^( 6) =       0.000432369195
  error estimate for blocks of size 2^( 7) =       0.000432321592

      target function =                  N/A
              le_mean =     -17.217635144267
             les_mean =     296.772002199496
             stat err =       0.000430628573
             autocorr =       1.141026324219
              std dev =       0.570124899409
             le_variance =       0.325042400926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217634587410        initial
     3.9062e-02     3.9062e-01             2.8629e-03       -17.217639080938
     1.5625e-01     1.5625e+00             1.3077e-03       -17.217640128207  <--
     6.2500e-01     6.2500e+00             4.5658e-04       -17.217635144267

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9723e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.921862e-01 1 1  ON 0
 uu_1                 2.984685e-02 1 1  ON 1
 uu_2                -6.439971e-02 1 1  ON 2
 uu_3                -1.204819e-01 1 1  ON 3
 uu_4                -1.563558e-01 1 1  ON 4
 uu_5                -1.683733e-01 1 1  ON 5
 uu_6                -1.567307e-01 1 1  ON 6
 uu_7                -1.100053e-01 1 1  ON 7
 uu_8                -3.903633e-02 1 1  ON 8
 uu_9                 2.009095e-01 1 1  ON 9
 ud_0                 3.547168e-01 1 1  ON 10
 ud_1                 9.628671e-02 1 1  ON 11
 ud_2                -1.329015e-02 1 1  ON 12
 ud_3                -7.534486e-02 1 1  ON 13
 ud_4                -1.257399e-01 1 1  ON 14
 ud_5                -1.629791e-01 1 1  ON 15
 ud_6                -1.769685e-01 1 1  ON 16
 ud_7                -1.590041e-01 1 1  ON 17
 ud_8                -1.118261e-01 1 1  ON 18
 ud_9                 3.181803e-02 1 1  ON 19
 eO_0                -9.175806e-01 1 1  ON 20
 eO_1                -5.965307e-01 1 1  ON 21
 eO_2                -1.843536e-01 1 1  ON 22
 eO_3                 8.475997e-02 1 1  ON 23
 eO_4                 2.080929e-01 1 1  ON 24
 eO_5                 2.968263e-01 1 1  ON 25
 eO_6                 3.255191e-01 1 1  ON 26
 eO_7                 5.323179e-01 1 1  ON 27
 eO_8                 1.583142e-01 1 1  ON 28
 eO_9                 5.337996e-02 1 1  ON 29
eH1_0                -2.217205e-01 1 1  ON 30
eH1_1                -1.428581e-01 1 1  ON 31
eH1_2                -1.016155e-01 1 1  ON 32
eH1_3                -6.424923e-02 1 1  ON 33
eH1_4                -1.780533e-02 1 1  ON 34
eH1_5                -4.502170e-03 1 1  ON 35
eH1_6                 3.567874e-02 1 1  ON 36
eH1_7                 7.794953e-02 1 1  ON 37
eH1_8                 2.638514e-01 1 1  ON 38
eH1_9                 1.136187e-01 1 1  ON 39
eH2_0                -2.110326e-01 1 1  ON 40
eH2_1                -1.319619e-01 1 1  ON 41
eH2_2                -9.065095e-02 1 1  ON 42
eH2_3                -5.307867e-02 1 1  ON 43
eH2_4                -6.308541e-03 1 1  ON 44
eH2_5                 5.687525e-03 1 1  ON 45
eH2_6                 4.776559e-02 1 1  ON 46
eH2_7                 3.945737e-02 1 1  ON 47
eH2_8                 2.475453e-01 1 1  ON 48
eH2_9                 1.153708e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5554e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.149904
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315656951962
                                         uncertainty =       0.002947335916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315656951962
                                         uncertainty =       0.002947335916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397221715
  error estimate for blocks of size 2^( 2) =       0.000406640203
  error estimate for blocks of size 2^( 3) =       0.000414758693
  error estimate for blocks of size 2^( 4) =       0.000420729741
  error estimate for blocks of size 2^( 5) =       0.000424108842
  error estimate for blocks of size 2^( 6) =       0.000427133150
  error estimate for blocks of size 2^( 7) =       0.000428612893

      target function =                  N/A
              le_mean =     -17.217532039038
             les_mean =     296.758979539793
             stat err =       0.000425146157
             autocorr =       1.145540768080
              std dev =       0.561756337094
             le_variance =       0.315570182266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721753203904e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217532039038       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217534895248       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217537671228       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217537658324       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217538249637       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217538617215       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217536434434       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217536988744       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217536785936       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217536341535       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217536525881       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217536973466       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.075214e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217532039038       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217533995161       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217536221259       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217536147762       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217536479595       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217536225338       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217535227312       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217535494860       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217535405369       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217535457879       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.008920e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217532039038       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217532904375       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217534178864       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217534139964       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217534306251       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217533979499       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217533854097       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217533888811       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.668108e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6034e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.923983e-01 1 1  ON 0
 uu_1                 3.010931e-02 1 1  ON 1
 uu_2                -6.435326e-02 1 1  ON 2
 uu_3                -1.202568e-01 1 1  ON 3
 uu_4                -1.564593e-01 1 1  ON 4
 uu_5                -1.688154e-01 1 1  ON 5
 uu_6                -1.566675e-01 1 1  ON 6
 uu_7                -1.103194e-01 1 1  ON 7
 uu_8                -3.900909e-02 1 1  ON 8
 uu_9                 2.007917e-01 1 1  ON 9
 ud_0                 3.548685e-01 1 1  ON 10
 ud_1                 9.625666e-02 1 1  ON 11
 ud_2                -1.335312e-02 1 1  ON 12
 ud_3                -7.553745e-02 1 1  ON 13
 ud_4                -1.259283e-01 1 1  ON 14
 ud_5                -1.630375e-01 1 1  ON 15
 ud_6                -1.768368e-01 1 1  ON 16
 ud_7                -1.587641e-01 1 1  ON 17
 ud_8                -1.118049e-01 1 1  ON 18
 ud_9                 3.172471e-02 1 1  ON 19
 eO_0                -9.183249e-01 1 1  ON 20
 eO_1                -5.970262e-01 1 1  ON 21
 eO_2                -1.844993e-01 1 1  ON 22
 eO_3                 8.525874e-02 1 1  ON 23
 eO_4                 2.091018e-01 1 1  ON 24
 eO_5                 2.968547e-01 1 1  ON 25
 eO_6                 3.254018e-01 1 1  ON 26
 eO_7                 5.321177e-01 1 1  ON 27
 eO_8                 1.584382e-01 1 1  ON 28
 eO_9                 5.340958e-02 1 1  ON 29
eH1_0                -2.223004e-01 1 1  ON 30
eH1_1                -1.428199e-01 1 1  ON 31
eH1_2                -1.015331e-01 1 1  ON 32
eH1_3                -6.388139e-02 1 1  ON 33
eH1_4                -1.751086e-02 1 1  ON 34
eH1_5                -4.356829e-03 1 1  ON 35
eH1_6                 3.590571e-02 1 1  ON 36
eH1_7                 7.752772e-02 1 1  ON 37
eH1_8                 2.636312e-01 1 1  ON 38
eH1_9                 1.136605e-01 1 1  ON 39
eH2_0                -2.109897e-01 1 1  ON 40
eH2_1                -1.319977e-01 1 1  ON 41
eH2_2                -9.045317e-02 1 1  ON 42
eH2_3                -5.318944e-02 1 1  ON 43
eH2_4                -6.454937e-03 1 1  ON 44
eH2_5                 5.646185e-03 1 1  ON 45
eH2_6                 4.765684e-02 1 1  ON 46
eH2_7                 3.968040e-02 1 1  ON 47
eH2_8                 2.474716e-01 1 1  ON 48
eH2_9                 1.153968e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1297
    reference variance = 0.24525
====================================================
  Execution time = 2.0108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1648e-01
  Total weights = 2.0000e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316336304065
                                         uncertainty =       0.002674448917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316336304065
                                         uncertainty =       0.002674448917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397681294
  error estimate for blocks of size 2^( 2) =       0.000407096460
  error estimate for blocks of size 2^( 3) =       0.000415760507
  error estimate for blocks of size 2^( 4) =       0.000421211356
  error estimate for blocks of size 2^( 5) =       0.000425166810
  error estimate for blocks of size 2^( 6) =       0.000427993105
  error estimate for blocks of size 2^( 7) =       0.000426698241

      target function =                  N/A
              le_mean =     -17.217689619992
             les_mean =     296.765136514694
             stat err =       0.000425267378
             autocorr =       1.143546459432
              std dev =       0.562406278813
             le_variance =       0.316300822448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697068744
                                         uncertainty =       0.002676653392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316697068744
                                         uncertainty =       0.002676653392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397908093
  error estimate for blocks of size 2^( 2) =       0.000407312063
  error estimate for blocks of size 2^( 3) =       0.000415970734
  error estimate for blocks of size 2^( 4) =       0.000421414291
  error estimate for blocks of size 2^( 5) =       0.000425370302
  error estimate for blocks of size 2^( 6) =       0.000428199315
  error estimate for blocks of size 2^( 7) =       0.000426895736

      target function =                  N/A
              le_mean =     -17.217689193138
             les_mean =     296.765482694244
             stat err =       0.000425469911
             autocorr =       1.143331476235
              std dev =       0.562727021812
             le_variance =       0.316661701077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316700899134
                                         uncertainty =       0.002677001390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316700899134
                                         uncertainty =       0.002677001390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397910514
  error estimate for blocks of size 2^( 2) =       0.000407313507
  error estimate for blocks of size 2^( 3) =       0.000415975453
  error estimate for blocks of size 2^( 4) =       0.000421422896
  error estimate for blocks of size 2^( 5) =       0.000425380622
  error estimate for blocks of size 2^( 6) =       0.000428211387
  error estimate for blocks of size 2^( 7) =       0.000426910080

      target function =                  N/A
              le_mean =     -17.217691276233
             les_mean =     296.765558280424
             stat err =       0.000425481246
             autocorr =       1.143378482127
              std dev =       0.562730446216
             le_variance =       0.316665555098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316415625526
                                         uncertainty =       0.002674964458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316415625526
                                         uncertainty =       0.002674964458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397731181
  error estimate for blocks of size 2^( 2) =       0.000407143091
  error estimate for blocks of size 2^( 3) =       0.000415806885
  error estimate for blocks of size 2^( 4) =       0.000421256838
  error estimate for blocks of size 2^( 5) =       0.000425213096
  error estimate for blocks of size 2^( 6) =       0.000428040423
  error estimate for blocks of size 2^( 7) =       0.000426744741

      target function =                  N/A
              le_mean =     -17.217689929155
             les_mean =     296.765226523339
             stat err =       0.000425313775
             autocorr =       1.143509077735
              std dev =       0.562476830643
             le_variance =       0.316380185010


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217689619992        initial
     3.9062e-02     3.9062e-01             3.0752e-03       -17.217689193138
     1.5625e-01     1.5625e+00             1.0089e-03       -17.217691276233  <--
     6.2500e-01     6.2500e+00             2.6681e-04       -17.217689929155

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9564e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.923983e-01 1 1  ON 0
 uu_1                 3.010931e-02 1 1  ON 1
 uu_2                -6.435326e-02 1 1  ON 2
 uu_3                -1.202568e-01 1 1  ON 3
 uu_4                -1.564593e-01 1 1  ON 4
 uu_5                -1.688154e-01 1 1  ON 5
 uu_6                -1.566675e-01 1 1  ON 6
 uu_7                -1.103194e-01 1 1  ON 7
 uu_8                -3.900909e-02 1 1  ON 8
 uu_9                 2.007917e-01 1 1  ON 9
 ud_0                 3.548685e-01 1 1  ON 10
 ud_1                 9.625666e-02 1 1  ON 11
 ud_2                -1.335312e-02 1 1  ON 12
 ud_3                -7.553745e-02 1 1  ON 13
 ud_4                -1.259283e-01 1 1  ON 14
 ud_5                -1.630375e-01 1 1  ON 15
 ud_6                -1.768368e-01 1 1  ON 16
 ud_7                -1.587641e-01 1 1  ON 17
 ud_8                -1.118049e-01 1 1  ON 18
 ud_9                 3.172471e-02 1 1  ON 19
 eO_0                -9.183249e-01 1 1  ON 20
 eO_1                -5.970262e-01 1 1  ON 21
 eO_2                -1.844993e-01 1 1  ON 22
 eO_3                 8.525874e-02 1 1  ON 23
 eO_4                 2.091018e-01 1 1  ON 24
 eO_5                 2.968547e-01 1 1  ON 25
 eO_6                 3.254018e-01 1 1  ON 26
 eO_7                 5.321177e-01 1 1  ON 27
 eO_8                 1.584382e-01 1 1  ON 28
 eO_9                 5.340958e-02 1 1  ON 29
eH1_0                -2.223004e-01 1 1  ON 30
eH1_1                -1.428199e-01 1 1  ON 31
eH1_2                -1.015331e-01 1 1  ON 32
eH1_3                -6.388139e-02 1 1  ON 33
eH1_4                -1.751086e-02 1 1  ON 34
eH1_5                -4.356829e-03 1 1  ON 35
eH1_6                 3.590571e-02 1 1  ON 36
eH1_7                 7.752772e-02 1 1  ON 37
eH1_8                 2.636312e-01 1 1  ON 38
eH1_9                 1.136605e-01 1 1  ON 39
eH2_0                -2.109897e-01 1 1  ON 40
eH2_1                -1.319977e-01 1 1  ON 41
eH2_2                -9.045317e-02 1 1  ON 42
eH2_3                -5.318944e-02 1 1  ON 43
eH2_4                -6.454937e-03 1 1  ON 44
eH2_5                 5.646185e-03 1 1  ON 45
eH2_6                 4.765684e-02 1 1  ON 46
eH2_7                 3.968040e-02 1 1  ON 47
eH2_8                 2.474716e-01 1 1  ON 48
eH2_9                 1.153968e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.23361
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320798929066
                                         uncertainty =       0.003224442325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320798929066
                                         uncertainty =       0.003224442325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400656632
  error estimate for blocks of size 2^( 2) =       0.000410186465
  error estimate for blocks of size 2^( 3) =       0.000418406365
  error estimate for blocks of size 2^( 4) =       0.000424786568
  error estimate for blocks of size 2^( 5) =       0.000428482909
  error estimate for blocks of size 2^( 6) =       0.000430471158
  error estimate for blocks of size 2^( 7) =       0.000430170073

      target function =                  N/A
              le_mean =     -17.217274577231
             les_mean =     296.755595180552
             stat err =       0.000428477677
             autocorr =       1.143698970307
              std dev =       0.566614042628
             le_variance =       0.321051473303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721727457723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217274577231       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217276129871       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217277270982       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217277951944       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217277291976       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217278807131       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217277691596       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217277681017       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217279034138       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217279694152       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217279606587       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217279663720       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 1.918280e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217274577231       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217275546678       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276458006       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217277124051       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217276541027       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217277109794       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217276573698       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217276801484       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217277064362       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 6.839091e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217274577231       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217274964629       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217275496758       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217275880334       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217275628910       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217275574138       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217275711982       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217275652258       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.918220e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6020e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.926830e-01 1 1  ON 0
 uu_1                 3.018689e-02 1 1  ON 1
 uu_2                -6.427123e-02 1 1  ON 2
 uu_3                -1.204326e-01 1 1  ON 3
 uu_4                -1.564859e-01 1 1  ON 4
 uu_5                -1.689721e-01 1 1  ON 5
 uu_6                -1.568267e-01 1 1  ON 6
 uu_7                -1.105164e-01 1 1  ON 7
 uu_8                -3.888377e-02 1 1  ON 8
 uu_9                 2.006841e-01 1 1  ON 9
 ud_0                 3.548686e-01 1 1  ON 10
 ud_1                 9.621839e-02 1 1  ON 11
 ud_2                -1.343431e-02 1 1  ON 12
 ud_3                -7.572410e-02 1 1  ON 13
 ud_4                -1.261467e-01 1 1  ON 14
 ud_5                -1.634914e-01 1 1  ON 15
 ud_6                -1.765356e-01 1 1  ON 16
 ud_7                -1.583473e-01 1 1  ON 17
 ud_8                -1.115208e-01 1 1  ON 18
 ud_9                 3.163103e-02 1 1  ON 19
 eO_0                -9.190088e-01 1 1  ON 20
 eO_1                -5.975086e-01 1 1  ON 21
 eO_2                -1.843211e-01 1 1  ON 22
 eO_3                 8.557160e-02 1 1  ON 23
 eO_4                 2.096370e-01 1 1  ON 24
 eO_5                 2.969788e-01 1 1  ON 25
 eO_6                 3.253284e-01 1 1  ON 26
 eO_7                 5.319700e-01 1 1  ON 27
 eO_8                 1.586190e-01 1 1  ON 28
 eO_9                 5.345678e-02 1 1  ON 29
eH1_0                -2.224045e-01 1 1  ON 30
eH1_1                -1.428645e-01 1 1  ON 31
eH1_2                -1.011040e-01 1 1  ON 32
eH1_3                -6.374430e-02 1 1  ON 33
eH1_4                -1.738960e-02 1 1  ON 34
eH1_5                -4.188201e-03 1 1  ON 35
eH1_6                 3.567171e-02 1 1  ON 36
eH1_7                 7.710274e-02 1 1  ON 37
eH1_8                 2.634688e-01 1 1  ON 38
eH1_9                 1.137211e-01 1 1  ON 39
eH2_0                -2.109495e-01 1 1  ON 40
eH2_1                -1.320290e-01 1 1  ON 41
eH2_2                -9.030562e-02 1 1  ON 42
eH2_3                -5.299569e-02 1 1  ON 43
eH2_4                -6.725255e-03 1 1  ON 44
eH2_5                 5.251214e-03 1 1  ON 45
eH2_6                 4.765136e-02 1 1  ON 46
eH2_7                 4.002285e-02 1 1  ON 47
eH2_8                 2.473787e-01 1 1  ON 48
eH2_9                 1.154214e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.425993
====================================================
  Execution time = 2.0436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3217e-01
  Total weights = 2.0000e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332142928482
                                         uncertainty =       0.016874885697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332142928482
                                         uncertainty =       0.016874885697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407479797
  error estimate for blocks of size 2^( 2) =       0.000417005727
  error estimate for blocks of size 2^( 3) =       0.000425487886
  error estimate for blocks of size 2^( 4) =       0.000431434435
  error estimate for blocks of size 2^( 5) =       0.000435088793
  error estimate for blocks of size 2^( 6) =       0.000436326115
  error estimate for blocks of size 2^( 7) =       0.000439388571

      target function =                  N/A
              le_mean =     -17.217278940206
             les_mean =     296.766773508854
             stat err =       0.000435559478
             autocorr =       1.142569891962
              std dev =       0.576263455409
             le_variance =       0.332079570040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332407257241
                                         uncertainty =       0.016873274561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332407257241
                                         uncertainty =       0.016873274561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407641976
  error estimate for blocks of size 2^( 2) =       0.000417162002
  error estimate for blocks of size 2^( 3) =       0.000425639366
  error estimate for blocks of size 2^( 4) =       0.000431574942
  error estimate for blocks of size 2^( 5) =       0.000435233844
  error estimate for blocks of size 2^( 6) =       0.000436471173
  error estimate for blocks of size 2^( 7) =       0.000439526347

      target function =                  N/A
              le_mean =     -17.217274402839
             les_mean =     296.766881658026
             stat err =       0.000435701576
             autocorr =       1.142405974799
              std dev =       0.576492811361
             le_variance =       0.332343961551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332322838803
                                         uncertainty =       0.016871460542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332322838803
                                         uncertainty =       0.016871460542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407590222
  error estimate for blocks of size 2^( 2) =       0.000417111957
  error estimate for blocks of size 2^( 3) =       0.000425594244
  error estimate for blocks of size 2^( 4) =       0.000431530849
  error estimate for blocks of size 2^( 5) =       0.000435189810
  error estimate for blocks of size 2^( 6) =       0.000436427376
  error estimate for blocks of size 2^( 7) =       0.000439480850

      target function =                  N/A
              le_mean =     -17.217273753262
             les_mean =     296.766774907300
             stat err =       0.000435657221
             autocorr =       1.142463463281
              std dev =       0.576419620295
             le_variance =       0.332259578661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332162209958
                                         uncertainty =       0.016874162554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332162209958
                                         uncertainty =       0.016874162554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407491642
  error estimate for blocks of size 2^( 2) =       0.000417016775
  error estimate for blocks of size 2^( 3) =       0.000425499292
  error estimate for blocks of size 2^( 4) =       0.000431444116
  error estimate for blocks of size 2^( 5) =       0.000435099573
  error estimate for blocks of size 2^( 6) =       0.000436336796
  error estimate for blocks of size 2^( 7) =       0.000439397008

      target function =                  N/A
              le_mean =     -17.217277362855
             les_mean =     296.766738499474
             stat err =       0.000435569373
             autocorr =       1.142555382278
              std dev =       0.576280206177
             le_variance =       0.332098876031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217278940206        initial  <--
     3.9062e-02     3.9062e-01             1.9183e-03       -17.217274402839
     1.5625e-01     1.5625e+00             6.8391e-04       -17.217273753262
     6.2500e-01     6.2500e+00             1.9182e-04       -17.217277362855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9151
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.923983e-01 1 1  ON 0
 uu_1                 3.010931e-02 1 1  ON 1
 uu_2                -6.435326e-02 1 1  ON 2
 uu_3                -1.202568e-01 1 1  ON 3
 uu_4                -1.564593e-01 1 1  ON 4
 uu_5                -1.688154e-01 1 1  ON 5
 uu_6                -1.566675e-01 1 1  ON 6
 uu_7                -1.103194e-01 1 1  ON 7
 uu_8                -3.900909e-02 1 1  ON 8
 uu_9                 2.007917e-01 1 1  ON 9
 ud_0                 3.548685e-01 1 1  ON 10
 ud_1                 9.625666e-02 1 1  ON 11
 ud_2                -1.335312e-02 1 1  ON 12
 ud_3                -7.553745e-02 1 1  ON 13
 ud_4                -1.259283e-01 1 1  ON 14
 ud_5                -1.630375e-01 1 1  ON 15
 ud_6                -1.768368e-01 1 1  ON 16
 ud_7                -1.587641e-01 1 1  ON 17
 ud_8                -1.118049e-01 1 1  ON 18
 ud_9                 3.172471e-02 1 1  ON 19
 eO_0                -9.183249e-01 1 1  ON 20
 eO_1                -5.970262e-01 1 1  ON 21
 eO_2                -1.844993e-01 1 1  ON 22
 eO_3                 8.525874e-02 1 1  ON 23
 eO_4                 2.091018e-01 1 1  ON 24
 eO_5                 2.968547e-01 1 1  ON 25
 eO_6                 3.254018e-01 1 1  ON 26
 eO_7                 5.321177e-01 1 1  ON 27
 eO_8                 1.584382e-01 1 1  ON 28
 eO_9                 5.340958e-02 1 1  ON 29
eH1_0                -2.223004e-01 1 1  ON 30
eH1_1                -1.428199e-01 1 1  ON 31
eH1_2                -1.015331e-01 1 1  ON 32
eH1_3                -6.388139e-02 1 1  ON 33
eH1_4                -1.751086e-02 1 1  ON 34
eH1_5                -4.356829e-03 1 1  ON 35
eH1_6                 3.590571e-02 1 1  ON 36
eH1_7                 7.752772e-02 1 1  ON 37
eH1_8                 2.636312e-01 1 1  ON 38
eH1_9                 1.136605e-01 1 1  ON 39
eH2_0                -2.109897e-01 1 1  ON 40
eH2_1                -1.319977e-01 1 1  ON 41
eH2_2                -9.045317e-02 1 1  ON 42
eH2_3                -5.318944e-02 1 1  ON 43
eH2_4                -6.454937e-03 1 1  ON 44
eH2_5                 5.646185e-03 1 1  ON 45
eH2_6                 4.765684e-02 1 1  ON 46
eH2_7                 3.968040e-02 1 1  ON 47
eH2_8                 2.474716e-01 1 1  ON 48
eH2_9                 1.153968e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5950e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.448313
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2907e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327963534791
                                         uncertainty =       0.006784742786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327963534791
                                         uncertainty =       0.006784742786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405629609
  error estimate for blocks of size 2^( 2) =       0.000414909914
  error estimate for blocks of size 2^( 3) =       0.000423365579
  error estimate for blocks of size 2^( 4) =       0.000429228560
  error estimate for blocks of size 2^( 5) =       0.000430629015
  error estimate for blocks of size 2^( 6) =       0.000433856088
  error estimate for blocks of size 2^( 7) =       0.000435656119

      target function =                  N/A
              le_mean =     -17.216663708982
             les_mean =     296.742579863102
             stat err =       0.000432342445
             autocorr =       1.136047398752
              std dev =       0.573646894410
             le_variance =       0.329070759466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666370898e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663708982       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664163782       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664741496       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216665021817       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216665618186       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216665156700       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216665123640       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216664927627       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.458981e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663708982       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216663854100       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664065621       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664161835       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664407280       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664330007       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664320632       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216664276303       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.156642e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663708982       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216663747954       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216663808124       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216663834562       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216663907718       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216663895783       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216663895250       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.227540e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5960e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.924364e-01 1 1  ON 0
 uu_1                 3.014462e-02 1 1  ON 1
 uu_2                -6.434432e-02 1 1  ON 2
 uu_3                -1.202964e-01 1 1  ON 3
 uu_4                -1.564330e-01 1 1  ON 4
 uu_5                -1.688455e-01 1 1  ON 5
 uu_6                -1.567061e-01 1 1  ON 6
 uu_7                -1.103318e-01 1 1  ON 7
 uu_8                -3.900359e-02 1 1  ON 8
 uu_9                 2.007751e-01 1 1  ON 9
 ud_0                 3.548521e-01 1 1  ON 10
 ud_1                 9.628045e-02 1 1  ON 11
 ud_2                -1.336741e-02 1 1  ON 12
 ud_3                -7.552358e-02 1 1  ON 13
 ud_4                -1.259954e-01 1 1  ON 14
 ud_5                -1.630728e-01 1 1  ON 15
 ud_6                -1.767947e-01 1 1  ON 16
 ud_7                -1.587172e-01 1 1  ON 17
 ud_8                -1.118004e-01 1 1  ON 18
 ud_9                 3.171323e-02 1 1  ON 19
 eO_0                -9.183820e-01 1 1  ON 20
 eO_1                -5.971418e-01 1 1  ON 21
 eO_2                -1.844387e-01 1 1  ON 22
 eO_3                 8.529436e-02 1 1  ON 23
 eO_4                 2.091672e-01 1 1  ON 24
 eO_5                 2.968787e-01 1 1  ON 25
 eO_6                 3.253911e-01 1 1  ON 26
 eO_7                 5.320965e-01 1 1  ON 27
 eO_8                 1.584510e-01 1 1  ON 28
 eO_9                 5.341328e-02 1 1  ON 29
eH1_0                -2.222638e-01 1 1  ON 30
eH1_1                -1.428991e-01 1 1  ON 31
eH1_2                -1.015081e-01 1 1  ON 32
eH1_3                -6.389728e-02 1 1  ON 33
eH1_4                -1.756304e-02 1 1  ON 34
eH1_5                -4.313152e-03 1 1  ON 35
eH1_6                 3.596319e-02 1 1  ON 36
eH1_7                 7.751588e-02 1 1  ON 37
eH1_8                 2.636172e-01 1 1  ON 38
eH1_9                 1.136656e-01 1 1  ON 39
eH2_0                -2.109732e-01 1 1  ON 40
eH2_1                -1.319637e-01 1 1  ON 41
eH2_2                -9.048195e-02 1 1  ON 42
eH2_3                -5.313811e-02 1 1  ON 43
eH2_4                -6.453180e-03 1 1  ON 44
eH2_5                 5.583456e-03 1 1  ON 45
eH2_6                 4.763460e-02 1 1  ON 46
eH2_7                 3.969952e-02 1 1  ON 47
eH2_8                 2.474567e-01 1 1  ON 48
eH2_9                 1.153989e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.3608
    reference variance = 2.20518
====================================================
  Execution time = 2.0105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1802e-01
  Total weights = 2.0000e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317901239493
                                         uncertainty =       0.003334027264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317901239493
                                         uncertainty =       0.003334027264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398760451
  error estimate for blocks of size 2^( 2) =       0.000408461668
  error estimate for blocks of size 2^( 3) =       0.000417197927
  error estimate for blocks of size 2^( 4) =       0.000423330181
  error estimate for blocks of size 2^( 5) =       0.000427260765
  error estimate for blocks of size 2^( 6) =       0.000429986671
  error estimate for blocks of size 2^( 7) =       0.000429642809

      target function =                  N/A
              le_mean =     -17.217307276867
             les_mean =     296.753689500933
             stat err =       0.000427555107
             autocorr =       1.149635165203
              std dev =       0.563932437353
             le_variance =       0.318019793899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317946559966
                                         uncertainty =       0.003334828580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317946559966
                                         uncertainty =       0.003334828580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398788869
  error estimate for blocks of size 2^( 2) =       0.000408488103
  error estimate for blocks of size 2^( 3) =       0.000417222808
  error estimate for blocks of size 2^( 4) =       0.000423352613
  error estimate for blocks of size 2^( 5) =       0.000427282755
  error estimate for blocks of size 2^( 6) =       0.000430007819
  error estimate for blocks of size 2^( 7) =       0.000429657490

      target function =                  N/A
              le_mean =     -17.217310519091
             les_mean =     296.753846475722
             stat err =       0.000427575169
             autocorr =       1.149579199771
              std dev =       0.563972626963
             le_variance =       0.318065123963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317911958725
                                         uncertainty =       0.003334428176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317911958725
                                         uncertainty =       0.003334428176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398767167
  error estimate for blocks of size 2^( 2) =       0.000408467385
  error estimate for blocks of size 2^( 3) =       0.000417203191
  error estimate for blocks of size 2^( 4) =       0.000423333940
  error estimate for blocks of size 2^( 5) =       0.000427265013
  error estimate for blocks of size 2^( 6) =       0.000429990033
  error estimate for blocks of size 2^( 7) =       0.000429641354

      target function =                  N/A
              le_mean =     -17.217309641722
             les_mean =     296.753781647525
             stat err =       0.000427557585
             autocorr =       1.149609764870
              std dev =       0.563941936378
             le_variance =       0.318030507605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317901322873
                                         uncertainty =       0.003334073962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317901322873
                                         uncertainty =       0.003334073962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398760501
  error estimate for blocks of size 2^( 2) =       0.000408461588
  error estimate for blocks of size 2^( 3) =       0.000417197824
  error estimate for blocks of size 2^( 4) =       0.000423329869
  error estimate for blocks of size 2^( 5) =       0.000427260593
  error estimate for blocks of size 2^( 6) =       0.000429986353
  error estimate for blocks of size 2^( 7) =       0.000429641769

      target function =                  N/A
              le_mean =     -17.217307599129
             les_mean =     296.753700678711
             stat err =       0.000427554646
             autocorr =       1.149632397669
              std dev =       0.563932508975
             le_variance =       0.318019874679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217307276867        initial
     3.9062e-01     3.9062e+00             3.4590e-04       -17.217310519091  <--
     1.5625e+00     1.5625e+01             1.1566e-04       -17.217309641722
     6.2500e+00     6.2500e+01             3.2275e-05       -17.217307599129

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9602e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.925269e-01 1 1  ON 0
 uu_1                 3.022741e-02 1 1  ON 1
 uu_2                -6.432925e-02 1 1  ON 2
 uu_3                -1.203445e-01 1 1  ON 3
 uu_4                -1.564123e-01 1 1  ON 4
 uu_5                -1.689045e-01 1 1  ON 5
 uu_6                -1.568057e-01 1 1  ON 6
 uu_7                -1.103660e-01 1 1  ON 7
 uu_8                -3.898899e-02 1 1  ON 8
 uu_9                 2.007313e-01 1 1  ON 9
 ud_0                 3.548442e-01 1 1  ON 10
 ud_1                 9.630965e-02 1 1  ON 11
 ud_2                -1.338760e-02 1 1  ON 12
 ud_3                -7.553194e-02 1 1  ON 13
 ud_4                -1.261162e-01 1 1  ON 14
 ud_5                -1.631857e-01 1 1  ON 15
 ud_6                -1.766976e-01 1 1  ON 16
 ud_7                -1.585920e-01 1 1  ON 17
 ud_8                -1.117874e-01 1 1  ON 18
 ud_9                 3.168307e-02 1 1  ON 19
 eO_0                -9.185639e-01 1 1  ON 20
 eO_1                -5.973721e-01 1 1  ON 21
 eO_2                -1.843387e-01 1 1  ON 22
 eO_3                 8.541659e-02 1 1  ON 23
 eO_4                 2.093309e-01 1 1  ON 24
 eO_5                 2.969384e-01 1 1  ON 25
 eO_6                 3.253629e-01 1 1  ON 26
 eO_7                 5.320408e-01 1 1  ON 27
 eO_8                 1.584850e-01 1 1  ON 28
 eO_9                 5.342308e-02 1 1  ON 29
eH1_0                -2.221908e-01 1 1  ON 30
eH1_1                -1.430522e-01 1 1  ON 31
eH1_2                -1.014854e-01 1 1  ON 32
eH1_3                -6.393392e-02 1 1  ON 33
eH1_4                -1.769544e-02 1 1  ON 34
eH1_5                -4.200258e-03 1 1  ON 35
eH1_6                 3.611681e-02 1 1  ON 36
eH1_7                 7.748550e-02 1 1  ON 37
eH1_8                 2.635801e-01 1 1  ON 38
eH1_9                 1.136792e-01 1 1  ON 39
eH2_0                -2.109286e-01 1 1  ON 40
eH2_1                -1.318895e-01 1 1  ON 41
eH2_2                -9.050668e-02 1 1  ON 42
eH2_3                -5.303225e-02 1 1  ON 43
eH2_4                -6.447306e-03 1 1  ON 44
eH2_5                 5.416764e-03 1 1  ON 45
eH2_6                 4.756955e-02 1 1  ON 46
eH2_7                 3.974933e-02 1 1  ON 47
eH2_8                 2.474172e-01 1 1  ON 48
eH2_9                 1.154046e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.474492
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319976313634
                                         uncertainty =       0.006060903872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319976313634
                                         uncertainty =       0.006060903872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399998068
  error estimate for blocks of size 2^( 2) =       0.000409191698
  error estimate for blocks of size 2^( 3) =       0.000416831847
  error estimate for blocks of size 2^( 4) =       0.000422983404
  error estimate for blocks of size 2^( 5) =       0.000427260183
  error estimate for blocks of size 2^( 6) =       0.000430064733
  error estimate for blocks of size 2^( 7) =       0.000429521817

      target function =                  N/A
              le_mean =     -17.217620078220
             les_mean =     296.766437906317
             stat err =       0.000427457534
             autocorr =       1.142010680724
              std dev =       0.565682692313
             le_variance =       0.319996908382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721762007822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217620078220       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217620726482       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217621844423       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217622530938       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217623490870       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217623746922       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217623780324       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217623196467       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217623122100       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217623151309       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 8.441849e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217620078220       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217620427434       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217621041132       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217621360388       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217621881296       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217621859447       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217621820004       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217621661971       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.834891e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217620078220       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217620200957       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217620432115       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217620528014       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217620723582       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217620690209       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217620655147       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 8.366742e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8746e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.925775e-01 1 1  ON 0
 uu_1                 3.030772e-02 1 1  ON 1
 uu_2                -6.426945e-02 1 1  ON 2
 uu_3                -1.203556e-01 1 1  ON 3
 uu_4                -1.566012e-01 1 1  ON 4
 uu_5                -1.688242e-01 1 1  ON 5
 uu_6                -1.568056e-01 1 1  ON 6
 uu_7                -1.104715e-01 1 1  ON 7
 uu_8                -3.897636e-02 1 1  ON 8
 uu_9                 2.006858e-01 1 1  ON 9
 ud_0                 3.548105e-01 1 1  ON 10
 ud_1                 9.637889e-02 1 1  ON 11
 ud_2                -1.337416e-02 1 1  ON 12
 ud_3                -7.554252e-02 1 1  ON 13
 ud_4                -1.261214e-01 1 1  ON 14
 ud_5                -1.631725e-01 1 1  ON 15
 ud_6                -1.766718e-01 1 1  ON 16
 ud_7                -1.585523e-01 1 1  ON 17
 ud_8                -1.118332e-01 1 1  ON 18
 ud_9                 3.160050e-02 1 1  ON 19
 eO_0                -9.188321e-01 1 1  ON 20
 eO_1                -5.974599e-01 1 1  ON 21
 eO_2                -1.844319e-01 1 1  ON 22
 eO_3                 8.570008e-02 1 1  ON 23
 eO_4                 2.094747e-01 1 1  ON 24
 eO_5                 2.969861e-01 1 1  ON 25
 eO_6                 3.253858e-01 1 1  ON 26
 eO_7                 5.319471e-01 1 1  ON 27
 eO_8                 1.585178e-01 1 1  ON 28
 eO_9                 5.343334e-02 1 1  ON 29
eH1_0                -2.221555e-01 1 1  ON 30
eH1_1                -1.429793e-01 1 1  ON 31
eH1_2                -1.015116e-01 1 1  ON 32
eH1_3                -6.390414e-02 1 1  ON 33
eH1_4                -1.753790e-02 1 1  ON 34
eH1_5                -4.360546e-03 1 1  ON 35
eH1_6                 3.617834e-02 1 1  ON 36
eH1_7                 7.735573e-02 1 1  ON 37
eH1_8                 2.635225e-01 1 1  ON 38
eH1_9                 1.136912e-01 1 1  ON 39
eH2_0                -2.110031e-01 1 1  ON 40
eH2_1                -1.320478e-01 1 1  ON 41
eH2_2                -9.053400e-02 1 1  ON 42
eH2_3                -5.298646e-02 1 1  ON 43
eH2_4                -6.357542e-03 1 1  ON 44
eH2_5                 5.441621e-03 1 1  ON 45
eH2_6                 4.752498e-02 1 1  ON 46
eH2_7                 3.993670e-02 1 1  ON 47
eH2_8                 2.473661e-01 1 1  ON 48
eH2_9                 1.154063e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.215388
====================================================
  Execution time = 1.9986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2394e-01
  Total weights = 2.0000e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323838756609
                                         uncertainty =       0.009125237046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323838756609
                                         uncertainty =       0.009125237046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402468837
  error estimate for blocks of size 2^( 2) =       0.000411810850
  error estimate for blocks of size 2^( 3) =       0.000419828866
  error estimate for blocks of size 2^( 4) =       0.000425330292
  error estimate for blocks of size 2^( 5) =       0.000428465029
  error estimate for blocks of size 2^( 6) =       0.000431161126
  error estimate for blocks of size 2^( 7) =       0.000432278296

      target function =                  N/A
              le_mean =     -17.216836183820
             les_mean =     296.743410347727
             stat err =       0.000429308686
             autocorr =       1.137823327615
              std dev =       0.569176887465
             le_variance =       0.323962329224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939672779
                                         uncertainty =       0.009126503974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939672779
                                         uncertainty =       0.009126503974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402531663
  error estimate for blocks of size 2^( 2) =       0.000411870177
  error estimate for blocks of size 2^( 3) =       0.000419882432
  error estimate for blocks of size 2^( 4) =       0.000425380860
  error estimate for blocks of size 2^( 5) =       0.000428515930
  error estimate for blocks of size 2^( 6) =       0.000431215593
  error estimate for blocks of size 2^( 7) =       0.000432330903

      target function =                  N/A
              le_mean =     -17.216838196848
             les_mean =     296.743580813297
             stat err =       0.000429360821
             autocorr =       1.137744465710
              std dev =       0.569265736619
             le_variance =       0.324063478889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323793906110
                                         uncertainty =       0.009125246798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323793906110
                                         uncertainty =       0.009125246798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402441089
  error estimate for blocks of size 2^( 2) =       0.000411783131
  error estimate for blocks of size 2^( 3) =       0.000419799019
  error estimate for blocks of size 2^( 4) =       0.000425298449
  error estimate for blocks of size 2^( 5) =       0.000428433475
  error estimate for blocks of size 2^( 6) =       0.000431133539
  error estimate for blocks of size 2^( 7) =       0.000432247468

      target function =                  N/A
              le_mean =     -17.216837542956
             les_mean =     296.743412478356
             stat err =       0.000429278233
             autocorr =       1.137818797839
              std dev =       0.569137645725
             le_variance =       0.323917659781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323814853650
                                         uncertainty =       0.009125072974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323814853650
                                         uncertainty =       0.009125072974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402454005
  error estimate for blocks of size 2^( 2) =       0.000411796380
  error estimate for blocks of size 2^( 3) =       0.000419814402
  error estimate for blocks of size 2^( 4) =       0.000425315556
  error estimate for blocks of size 2^( 5) =       0.000428450500
  error estimate for blocks of size 2^( 6) =       0.000431147428
  error estimate for blocks of size 2^( 7) =       0.000432263866

      target function =                  N/A
              le_mean =     -17.216836342956
             les_mean =     296.743391950896
             stat err =       0.000429294338
             autocorr =       1.137831132226
              std dev =       0.569155912504
             le_variance =       0.323938452738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216836183820        initial
     9.7656e-02     9.7656e-01             8.4418e-04       -17.216838196848  <--
     3.9062e-01     3.9062e+00             2.8349e-04       -17.216837542956
     1.5625e+00     1.5625e+01             8.3667e-05       -17.216836342956

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.9466e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.927852e-01 1 1  ON 0
 uu_1                 3.047856e-02 1 1  ON 1
 uu_2                -6.418895e-02 1 1  ON 2
 uu_3                -1.203982e-01 1 1  ON 3
 uu_4                -1.568143e-01 1 1  ON 4
 uu_5                -1.688595e-01 1 1  ON 5
 uu_6                -1.568089e-01 1 1  ON 6
 uu_7                -1.107361e-01 1 1  ON 7
 uu_8                -3.893829e-02 1 1  ON 8
 uu_9                 2.005581e-01 1 1  ON 9
 ud_0                 3.549096e-01 1 1  ON 10
 ud_1                 9.645079e-02 1 1  ON 11
 ud_2                -1.333839e-02 1 1  ON 12
 ud_3                -7.556428e-02 1 1  ON 13
 ud_4                -1.261342e-01 1 1  ON 14
 ud_5                -1.631946e-01 1 1  ON 15
 ud_6                -1.766241e-01 1 1  ON 16
 ud_7                -1.584409e-01 1 1  ON 17
 ud_8                -1.119578e-01 1 1  ON 18
 ud_9                 3.136931e-02 1 1  ON 19
 eO_0                -9.194081e-01 1 1  ON 20
 eO_1                -5.977521e-01 1 1  ON 21
 eO_2                -1.845199e-01 1 1  ON 22
 eO_3                 8.611131e-02 1 1  ON 23
 eO_4                 2.099302e-01 1 1  ON 24
 eO_5                 2.971409e-01 1 1  ON 25
 eO_6                 3.254547e-01 1 1  ON 26
 eO_7                 5.316859e-01 1 1  ON 27
 eO_8                 1.586102e-01 1 1  ON 28
 eO_9                 5.346216e-02 1 1  ON 29
eH1_0                -2.220085e-01 1 1  ON 30
eH1_1                -1.429021e-01 1 1  ON 31
eH1_2                -1.014584e-01 1 1  ON 32
eH1_3                -6.380261e-02 1 1  ON 33
eH1_4                -1.729914e-02 1 1  ON 34
eH1_5                -4.690054e-03 1 1  ON 35
eH1_6                 3.636614e-02 1 1  ON 36
eH1_7                 7.699307e-02 1 1  ON 37
eH1_8                 2.633618e-01 1 1  ON 38
eH1_9                 1.137250e-01 1 1  ON 39
eH2_0                -2.111783e-01 1 1  ON 40
eH2_1                -1.322296e-01 1 1  ON 41
eH2_2                -9.058537e-02 1 1  ON 42
eH2_3                -5.297511e-02 1 1  ON 43
eH2_4                -6.299337e-03 1 1  ON 44
eH2_5                 5.478032e-03 1 1  ON 45
eH2_6                 4.742160e-02 1 1  ON 46
eH2_7                 4.046246e-02 1 1  ON 47
eH2_8                 2.472233e-01 1 1  ON 48
eH2_9                 1.154112e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2808
    reference variance = 0.342877
====================================================
  Execution time = 2.0702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2160e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321655512475
                                         uncertainty =       0.005629128884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321655512475
                                         uncertainty =       0.005629128884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400999537
  error estimate for blocks of size 2^( 2) =       0.000410490056
  error estimate for blocks of size 2^( 3) =       0.000418935653
  error estimate for blocks of size 2^( 4) =       0.000424749097
  error estimate for blocks of size 2^( 5) =       0.000428548130
  error estimate for blocks of size 2^( 6) =       0.000431008698
  error estimate for blocks of size 2^( 7) =       0.000430658091

      target function =                  N/A
              le_mean =     -17.217114506974
             les_mean =     296.750633042078
             stat err =       0.000428741004
             autocorr =       1.143147575325
              std dev =       0.567098983088
             le_variance =       0.321601256620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711450697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114506974       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217118884618       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217119454314       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217118481685       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217121874077       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217121647808       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217122090508       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217123329403       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217124004416       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217121400337       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217122821678       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217122210759       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217122299790       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217122812923       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 4.365269e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114506974       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217117564216       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217118159002       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117430477       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217119773702       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217119221754       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217119285045       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217120098997       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217120131756       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217119256600       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.682644e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114506974       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217115892538       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217116338624       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217116127889       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117028398       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217116641013       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217116639179       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217116907237       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.052268e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6214e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.929497e-01 1 1  ON 0
 uu_1                 3.067238e-02 1 1  ON 1
 uu_2                -6.404330e-02 1 1  ON 2
 uu_3                -1.203460e-01 1 1  ON 3
 uu_4                -1.569000e-01 1 1  ON 4
 uu_5                -1.693583e-01 1 1  ON 5
 uu_6                -1.568193e-01 1 1  ON 6
 uu_7                -1.107772e-01 1 1  ON 7
 uu_8                -3.891709e-02 1 1  ON 8
 uu_9                 2.003013e-01 1 1  ON 9
 ud_0                 3.554868e-01 1 1  ON 10
 ud_1                 9.689973e-02 1 1  ON 11
 ud_2                -1.298439e-02 1 1  ON 12
 ud_3                -7.554559e-02 1 1  ON 13
 ud_4                -1.265180e-01 1 1  ON 14
 ud_5                -1.636854e-01 1 1  ON 15
 ud_6                -1.769591e-01 1 1  ON 16
 ud_7                -1.584772e-01 1 1  ON 17
 ud_8                -1.121302e-01 1 1  ON 18
 ud_9                 3.116147e-02 1 1  ON 19
 eO_0                -9.205344e-01 1 1  ON 20
 eO_1                -5.985179e-01 1 1  ON 21
 eO_2                -1.843894e-01 1 1  ON 22
 eO_3                 8.697049e-02 1 1  ON 23
 eO_4                 2.116129e-01 1 1  ON 24
 eO_5                 2.966372e-01 1 1  ON 25
 eO_6                 3.252746e-01 1 1  ON 26
 eO_7                 5.313905e-01 1 1  ON 27
 eO_8                 1.587351e-01 1 1  ON 28
 eO_9                 5.350310e-02 1 1  ON 29
eH1_0                -2.223516e-01 1 1  ON 30
eH1_1                -1.431349e-01 1 1  ON 31
eH1_2                -1.012651e-01 1 1  ON 32
eH1_3                -6.354649e-02 1 1  ON 33
eH1_4                -1.672382e-02 1 1  ON 34
eH1_5                -4.241038e-03 1 1  ON 35
eH1_6                 3.640060e-02 1 1  ON 36
eH1_7                 7.624883e-02 1 1  ON 37
eH1_8                 2.630970e-01 1 1  ON 38
eH1_9                 1.137766e-01 1 1  ON 39
eH2_0                -2.114126e-01 1 1  ON 40
eH2_1                -1.322366e-01 1 1  ON 41
eH2_2                -9.060473e-02 1 1  ON 42
eH2_3                -5.322384e-02 1 1  ON 43
eH2_4                -6.435591e-03 1 1  ON 44
eH2_5                 5.697545e-03 1 1  ON 45
eH2_6                 4.756063e-02 1 1  ON 46
eH2_7                 4.080285e-02 1 1  ON 47
eH2_8                 2.471142e-01 1 1  ON 48
eH2_9                 1.154143e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1147
    reference variance = 0.400469
====================================================
  Execution time = 2.0160e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1921e-01
  Total weights = 2.0000e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319159984739
                                         uncertainty =       0.003385235742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319159984739
                                         uncertainty =       0.003385235742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399388174
  error estimate for blocks of size 2^( 2) =       0.000408869362
  error estimate for blocks of size 2^( 3) =       0.000416711355
  error estimate for blocks of size 2^( 4) =       0.000422210661
  error estimate for blocks of size 2^( 5) =       0.000425359219
  error estimate for blocks of size 2^( 6) =       0.000428554956
  error estimate for blocks of size 2^( 7) =       0.000430380751

      target function =                  N/A
              le_mean =     -17.217111623122
             les_mean =     296.747954310861
             stat err =       0.000426626397
             autocorr =       1.141050967206
              std dev =       0.564820172558
             le_variance =       0.319021827328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319652618379
                                         uncertainty =       0.003388844752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319652618379
                                         uncertainty =       0.003388844752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399696335
  error estimate for blocks of size 2^( 2) =       0.000409168883
  error estimate for blocks of size 2^( 3) =       0.000416994009
  error estimate for blocks of size 2^( 4) =       0.000422473235
  error estimate for blocks of size 2^( 5) =       0.000425607313
  error estimate for blocks of size 2^( 6) =       0.000428790367
  error estimate for blocks of size 2^( 7) =       0.000430631847

      target function =                  N/A
              le_mean =     -17.217109270895
             les_mean =     296.748365807091
             stat err =       0.000426875691
             autocorr =       1.140624023561
              std dev =       0.565255978223
             le_variance =       0.319514320917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544399927
                                         uncertainty =       0.003387796134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319544399927
                                         uncertainty =       0.003387796134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399628713
  error estimate for blocks of size 2^( 2) =       0.000409106368
  error estimate for blocks of size 2^( 3) =       0.000416935398
  error estimate for blocks of size 2^( 4) =       0.000422415984
  error estimate for blocks of size 2^( 5) =       0.000425552627
  error estimate for blocks of size 2^( 6) =       0.000428736944
  error estimate for blocks of size 2^( 7) =       0.000430588605

      target function =                  N/A
              le_mean =     -17.217109689587
             les_mean =     296.748272119670
             stat err =       0.000426823540
             autocorr =       1.140731302013
              std dev =       0.565160345474
             le_variance =       0.319406216097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319226677644
                                         uncertainty =       0.003385541059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319226677644
                                         uncertainty =       0.003385541059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399429927
  error estimate for blocks of size 2^( 2) =       0.000408910438
  error estimate for blocks of size 2^( 3) =       0.000416750291
  error estimate for blocks of size 2^( 4) =       0.000422246156
  error estimate for blocks of size 2^( 5) =       0.000425392569
  error estimate for blocks of size 2^( 6) =       0.000428585732
  error estimate for blocks of size 2^( 7) =       0.000430418338

      target function =                  N/A
              le_mean =     -17.217110521793
             les_mean =     296.747983093413
             stat err =       0.000426660699
             autocorr =       1.140995885888
              std dev =       0.564879220118
             le_variance =       0.319088533321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217111623122        initial  <--
     2.4414e-02     2.4414e-01             4.3653e-03       -17.217109270895
     9.7656e-02     9.7656e-01             1.6826e-03       -17.217109689587
     3.9062e-01     3.9062e+00             5.0523e-04       -17.217110521793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6141
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.927852e-01 1 1  ON 0
 uu_1                 3.047856e-02 1 1  ON 1
 uu_2                -6.418895e-02 1 1  ON 2
 uu_3                -1.203982e-01 1 1  ON 3
 uu_4                -1.568143e-01 1 1  ON 4
 uu_5                -1.688595e-01 1 1  ON 5
 uu_6                -1.568089e-01 1 1  ON 6
 uu_7                -1.107361e-01 1 1  ON 7
 uu_8                -3.893829e-02 1 1  ON 8
 uu_9                 2.005581e-01 1 1  ON 9
 ud_0                 3.549096e-01 1 1  ON 10
 ud_1                 9.645079e-02 1 1  ON 11
 ud_2                -1.333839e-02 1 1  ON 12
 ud_3                -7.556428e-02 1 1  ON 13
 ud_4                -1.261342e-01 1 1  ON 14
 ud_5                -1.631946e-01 1 1  ON 15
 ud_6                -1.766241e-01 1 1  ON 16
 ud_7                -1.584409e-01 1 1  ON 17
 ud_8                -1.119578e-01 1 1  ON 18
 ud_9                 3.136931e-02 1 1  ON 19
 eO_0                -9.194081e-01 1 1  ON 20
 eO_1                -5.977521e-01 1 1  ON 21
 eO_2                -1.845199e-01 1 1  ON 22
 eO_3                 8.611131e-02 1 1  ON 23
 eO_4                 2.099302e-01 1 1  ON 24
 eO_5                 2.971409e-01 1 1  ON 25
 eO_6                 3.254547e-01 1 1  ON 26
 eO_7                 5.316859e-01 1 1  ON 27
 eO_8                 1.586102e-01 1 1  ON 28
 eO_9                 5.346216e-02 1 1  ON 29
eH1_0                -2.220085e-01 1 1  ON 30
eH1_1                -1.429021e-01 1 1  ON 31
eH1_2                -1.014584e-01 1 1  ON 32
eH1_3                -6.380261e-02 1 1  ON 33
eH1_4                -1.729914e-02 1 1  ON 34
eH1_5                -4.690054e-03 1 1  ON 35
eH1_6                 3.636614e-02 1 1  ON 36
eH1_7                 7.699307e-02 1 1  ON 37
eH1_8                 2.633618e-01 1 1  ON 38
eH1_9                 1.137250e-01 1 1  ON 39
eH2_0                -2.111783e-01 1 1  ON 40
eH2_1                -1.322296e-01 1 1  ON 41
eH2_2                -9.058537e-02 1 1  ON 42
eH2_3                -5.297511e-02 1 1  ON 43
eH2_4                -6.299337e-03 1 1  ON 44
eH2_5                 5.478032e-03 1 1  ON 45
eH2_6                 4.742160e-02 1 1  ON 46
eH2_7                 4.046246e-02 1 1  ON 47
eH2_8                 2.472233e-01 1 1  ON 48
eH2_9                 1.154112e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1858
    reference variance = 0.209246
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1894e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014410995
                                         uncertainty =       0.003982019849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319014410995
                                         uncertainty =       0.003982019849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399336010
  error estimate for blocks of size 2^( 2) =       0.000408531896
  error estimate for blocks of size 2^( 3) =       0.000417162021
  error estimate for blocks of size 2^( 4) =       0.000423118238
  error estimate for blocks of size 2^( 5) =       0.000427855422
  error estimate for blocks of size 2^( 6) =       0.000429429366
  error estimate for blocks of size 2^( 7) =       0.000429754026

      target function =                  N/A
              le_mean =     -17.216795532790
             les_mean =     296.736986756420
             stat err =       0.000427539263
             autocorr =       1.146238680055
              std dev =       0.564746401492
             le_variance =       0.318938497998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679553279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795532790       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795344537       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795254142       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795452638       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216796597141       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216797010593       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216796912943       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216796945852       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216796698127       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 5.586150e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795532790       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795462587       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795465203       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795428581       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216795821832       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216795961143       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216796019512       residual = 6.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.499022e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795532790       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795512779       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795516973       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795491833       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216795597764       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216795628106       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216795659210       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.608574e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6211e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.928659e-01 1 1  ON 0
 uu_1                 3.042435e-02 1 1  ON 1
 uu_2                -6.419890e-02 1 1  ON 2
 uu_3                -1.204400e-01 1 1  ON 3
 uu_4                -1.567784e-01 1 1  ON 4
 uu_5                -1.688738e-01 1 1  ON 5
 uu_6                -1.567757e-01 1 1  ON 6
 uu_7                -1.107415e-01 1 1  ON 7
 uu_8                -3.894367e-02 1 1  ON 8
 uu_9                 2.005279e-01 1 1  ON 9
 ud_0                 3.550595e-01 1 1  ON 10
 ud_1                 9.646908e-02 1 1  ON 11
 ud_2                -1.332643e-02 1 1  ON 12
 ud_3                -7.558291e-02 1 1  ON 13
 ud_4                -1.262313e-01 1 1  ON 14
 ud_5                -1.633096e-01 1 1  ON 15
 ud_6                -1.766073e-01 1 1  ON 16
 ud_7                -1.583926e-01 1 1  ON 17
 ud_8                -1.119540e-01 1 1  ON 18
 ud_9                 3.134424e-02 1 1  ON 19
 eO_0                -9.194272e-01 1 1  ON 20
 eO_1                -5.978675e-01 1 1  ON 21
 eO_2                -1.845449e-01 1 1  ON 22
 eO_3                 8.612695e-02 1 1  ON 23
 eO_4                 2.100684e-01 1 1  ON 24
 eO_5                 2.971441e-01 1 1  ON 25
 eO_6                 3.254721e-01 1 1  ON 26
 eO_7                 5.316623e-01 1 1  ON 27
 eO_8                 1.586174e-01 1 1  ON 28
 eO_9                 5.346328e-02 1 1  ON 29
eH1_0                -2.220722e-01 1 1  ON 30
eH1_1                -1.429516e-01 1 1  ON 31
eH1_2                -1.013968e-01 1 1  ON 32
eH1_3                -6.384977e-02 1 1  ON 33
eH1_4                -1.720443e-02 1 1  ON 34
eH1_5                -4.645407e-03 1 1  ON 35
eH1_6                 3.634840e-02 1 1  ON 36
eH1_7                 7.697653e-02 1 1  ON 37
eH1_8                 2.633518e-01 1 1  ON 38
eH1_9                 1.137269e-01 1 1  ON 39
eH2_0                -2.111231e-01 1 1  ON 40
eH2_1                -1.322075e-01 1 1  ON 41
eH2_2                -9.062846e-02 1 1  ON 42
eH2_3                -5.295097e-02 1 1  ON 43
eH2_4                -6.363317e-03 1 1  ON 44
eH2_5                 5.436392e-03 1 1  ON 45
eH2_6                 4.744081e-02 1 1  ON 46
eH2_7                 4.050234e-02 1 1  ON 47
eH2_8                 2.472087e-01 1 1  ON 48
eH2_9                 1.154126e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.0929
    reference variance = 2.4388
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1600e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315822025769
                                         uncertainty =       0.002606888906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315822025769
                                         uncertainty =       0.002606888906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397420714
  error estimate for blocks of size 2^( 2) =       0.000406579938
  error estimate for blocks of size 2^( 3) =       0.000415372847
  error estimate for blocks of size 2^( 4) =       0.000421608266
  error estimate for blocks of size 2^( 5) =       0.000425223567
  error estimate for blocks of size 2^( 6) =       0.000427632524
  error estimate for blocks of size 2^( 7) =       0.000428267006

      target function =                  N/A
              le_mean =     -17.216679432386
             les_mean =     296.729936967910
             stat err =       0.000425682841
             autocorr =       1.147284929022
              std dev =       0.562037764141
             le_variance =       0.315886448320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316076972924
                                         uncertainty =       0.002609890329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316076972924
                                         uncertainty =       0.002609890329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397581053
  error estimate for blocks of size 2^( 2) =       0.000406734507
  error estimate for blocks of size 2^( 3) =       0.000415523262
  error estimate for blocks of size 2^( 4) =       0.000421751384
  error estimate for blocks of size 2^( 5) =       0.000425359437
  error estimate for blocks of size 2^( 6) =       0.000427764640
  error estimate for blocks of size 2^( 7) =       0.000428400252

      target function =                  N/A
              le_mean =     -17.216678900299
             les_mean =     296.730173584653
             stat err =       0.000425818928
             autocorr =       1.147092834678
              std dev =       0.562264516694
             le_variance =       0.316141386733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316059506585
                                         uncertainty =       0.002609630965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316059506585
                                         uncertainty =       0.002609630965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397570066
  error estimate for blocks of size 2^( 2) =       0.000406723784
  error estimate for blocks of size 2^( 3) =       0.000415513331
  error estimate for blocks of size 2^( 4) =       0.000421743297
  error estimate for blocks of size 2^( 5) =       0.000425352933
  error estimate for blocks of size 2^( 6) =       0.000427759165
  error estimate for blocks of size 2^( 7) =       0.000428393127

      target function =                  N/A
              le_mean =     -17.216679015465
             les_mean =     296.730160078860
             stat err =       0.000425812131
             autocorr =       1.147119605858
              std dev =       0.562248979859
             le_variance =       0.316123915353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315858741230
                                         uncertainty =       0.002607323539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315858741230
                                         uncertainty =       0.002607323539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397443808
  error estimate for blocks of size 2^( 2) =       0.000406602175
  error estimate for blocks of size 2^( 3) =       0.000415394599
  error estimate for blocks of size 2^( 4) =       0.000421629227
  error estimate for blocks of size 2^( 5) =       0.000425243680
  error estimate for blocks of size 2^( 6) =       0.000427652271
  error estimate for blocks of size 2^( 7) =       0.000428286544

      target function =                  N/A
              le_mean =     -17.216679339630
             les_mean =     296.729970487340
             stat err =       0.000425702930
             autocorr =       1.147259883514
              std dev =       0.562070424105
             le_variance =       0.315923161653


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216679432386        initial  <--
     2.4414e-01     2.4414e+00             5.5861e-04       -17.216678900299
     9.7656e-01     9.7656e+00             1.4990e-04       -17.216679015465
     3.9062e+00     3.9062e+01             4.6086e-05       -17.216679339630

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5557
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.927852e-01 1 1  ON 0
 uu_1                 3.047856e-02 1 1  ON 1
 uu_2                -6.418895e-02 1 1  ON 2
 uu_3                -1.203982e-01 1 1  ON 3
 uu_4                -1.568143e-01 1 1  ON 4
 uu_5                -1.688595e-01 1 1  ON 5
 uu_6                -1.568089e-01 1 1  ON 6
 uu_7                -1.107361e-01 1 1  ON 7
 uu_8                -3.893829e-02 1 1  ON 8
 uu_9                 2.005581e-01 1 1  ON 9
 ud_0                 3.549096e-01 1 1  ON 10
 ud_1                 9.645079e-02 1 1  ON 11
 ud_2                -1.333839e-02 1 1  ON 12
 ud_3                -7.556428e-02 1 1  ON 13
 ud_4                -1.261342e-01 1 1  ON 14
 ud_5                -1.631946e-01 1 1  ON 15
 ud_6                -1.766241e-01 1 1  ON 16
 ud_7                -1.584409e-01 1 1  ON 17
 ud_8                -1.119578e-01 1 1  ON 18
 ud_9                 3.136931e-02 1 1  ON 19
 eO_0                -9.194081e-01 1 1  ON 20
 eO_1                -5.977521e-01 1 1  ON 21
 eO_2                -1.845199e-01 1 1  ON 22
 eO_3                 8.611131e-02 1 1  ON 23
 eO_4                 2.099302e-01 1 1  ON 24
 eO_5                 2.971409e-01 1 1  ON 25
 eO_6                 3.254547e-01 1 1  ON 26
 eO_7                 5.316859e-01 1 1  ON 27
 eO_8                 1.586102e-01 1 1  ON 28
 eO_9                 5.346216e-02 1 1  ON 29
eH1_0                -2.220085e-01 1 1  ON 30
eH1_1                -1.429021e-01 1 1  ON 31
eH1_2                -1.014584e-01 1 1  ON 32
eH1_3                -6.380261e-02 1 1  ON 33
eH1_4                -1.729914e-02 1 1  ON 34
eH1_5                -4.690054e-03 1 1  ON 35
eH1_6                 3.636614e-02 1 1  ON 36
eH1_7                 7.699307e-02 1 1  ON 37
eH1_8                 2.633618e-01 1 1  ON 38
eH1_9                 1.137250e-01 1 1  ON 39
eH2_0                -2.111783e-01 1 1  ON 40
eH2_1                -1.322296e-01 1 1  ON 41
eH2_2                -9.058537e-02 1 1  ON 42
eH2_3                -5.297511e-02 1 1  ON 43
eH2_4                -6.299337e-03 1 1  ON 44
eH2_5                 5.478032e-03 1 1  ON 45
eH2_6                 4.742160e-02 1 1  ON 46
eH2_7                 4.046246e-02 1 1  ON 47
eH2_8                 2.472233e-01 1 1  ON 48
eH2_9                 1.154112e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2627
    reference variance = 0.177296
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2279e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322851561882
                                         uncertainty =       0.003709196023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322851561882
                                         uncertainty =       0.003709196023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401739070
  error estimate for blocks of size 2^( 2) =       0.000411181586
  error estimate for blocks of size 2^( 3) =       0.000419701494
  error estimate for blocks of size 2^( 4) =       0.000426354204
  error estimate for blocks of size 2^( 5) =       0.000430315292
  error estimate for blocks of size 2^( 6) =       0.000432182199
  error estimate for blocks of size 2^( 7) =       0.000434769023

      target function =                  N/A
              le_mean =     -17.216546528582
             les_mean =     296.732262770686
             stat err =       0.000430905179
             autocorr =       1.150469972485
              std dev =       0.568144841802
             le_variance =       0.322788561266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654652858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546528582       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546436033       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546617236       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546785486       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546666732       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546680799       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546683215       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.445690e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546528582       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546503467       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546552445       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546601225       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546568887       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546571570       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.972388e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546528582       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546522166       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546534668       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546547362       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546539127       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546539712       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.951938e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6201e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.927924e-01 1 1  ON 0
 uu_1                 3.048432e-02 1 1  ON 1
 uu_2                -6.419074e-02 1 1  ON 2
 uu_3                -1.203976e-01 1 1  ON 3
 uu_4                -1.568104e-01 1 1  ON 4
 uu_5                -1.688625e-01 1 1  ON 5
 uu_6                -1.568160e-01 1 1  ON 6
 uu_7                -1.107409e-01 1 1  ON 7
 uu_8                -3.893873e-02 1 1  ON 8
 uu_9                 2.005559e-01 1 1  ON 9
 ud_0                 3.549151e-01 1 1  ON 10
 ud_1                 9.646145e-02 1 1  ON 11
 ud_2                -1.334279e-02 1 1  ON 12
 ud_3                -7.556355e-02 1 1  ON 13
 ud_4                -1.261327e-01 1 1  ON 14
 ud_5                -1.632008e-01 1 1  ON 15
 ud_6                -1.766310e-01 1 1  ON 16
 ud_7                -1.584394e-01 1 1  ON 17
 ud_8                -1.119583e-01 1 1  ON 18
 ud_9                 3.136609e-02 1 1  ON 19
 eO_0                -9.194147e-01 1 1  ON 20
 eO_1                -5.977675e-01 1 1  ON 21
 eO_2                -1.845132e-01 1 1  ON 22
 eO_3                 8.611328e-02 1 1  ON 23
 eO_4                 2.099500e-01 1 1  ON 24
 eO_5                 2.971386e-01 1 1  ON 25
 eO_6                 3.254522e-01 1 1  ON 26
 eO_7                 5.316819e-01 1 1  ON 27
 eO_8                 1.586121e-01 1 1  ON 28
 eO_9                 5.346263e-02 1 1  ON 29
eH1_0                -2.220056e-01 1 1  ON 30
eH1_1                -1.429043e-01 1 1  ON 31
eH1_2                -1.014482e-01 1 1  ON 32
eH1_3                -6.380548e-02 1 1  ON 33
eH1_4                -1.729775e-02 1 1  ON 34
eH1_5                -4.689355e-03 1 1  ON 35
eH1_6                 3.636366e-02 1 1  ON 36
eH1_7                 7.698804e-02 1 1  ON 37
eH1_8                 2.633587e-01 1 1  ON 38
eH1_9                 1.137254e-01 1 1  ON 39
eH2_0                -2.111797e-01 1 1  ON 40
eH2_1                -1.322358e-01 1 1  ON 41
eH2_2                -9.057510e-02 1 1  ON 42
eH2_3                -5.299111e-02 1 1  ON 43
eH2_4                -6.299179e-03 1 1  ON 44
eH2_5                 5.481342e-03 1 1  ON 45
eH2_6                 4.742845e-02 1 1  ON 46
eH2_7                 4.046646e-02 1 1  ON 47
eH2_8                 2.472210e-01 1 1  ON 48
eH2_9                 1.154118e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.199904
====================================================
  Execution time = 2.0118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1994e-01
  Total weights = 2.0000e+06
  Execution time = 1.8663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320029646703
                                         uncertainty =       0.005117089685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320029646703
                                         uncertainty =       0.005117089685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399962642
  error estimate for blocks of size 2^( 2) =       0.000409044606
  error estimate for blocks of size 2^( 3) =       0.000416865529
  error estimate for blocks of size 2^( 4) =       0.000422626159
  error estimate for blocks of size 2^( 5) =       0.000427319277
  error estimate for blocks of size 2^( 6) =       0.000429674082
  error estimate for blocks of size 2^( 7) =       0.000431861195

      target function =                  N/A
              le_mean =     -17.217423000401
             les_mean =     296.759594845263
             stat err =       0.000427870178
             autocorr =       1.144419314155
              std dev =       0.565632593202
             le_variance =       0.319940230492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320046772986
                                         uncertainty =       0.005117450155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320046772986
                                         uncertainty =       0.005117450155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399973333
  error estimate for blocks of size 2^( 2) =       0.000409055056
  error estimate for blocks of size 2^( 3) =       0.000416875562
  error estimate for blocks of size 2^( 4) =       0.000422636098
  error estimate for blocks of size 2^( 5) =       0.000427329197
  error estimate for blocks of size 2^( 6) =       0.000429684807
  error estimate for blocks of size 2^( 7) =       0.000431871981

      target function =                  N/A
              le_mean =     -17.217423100394
             les_mean =     296.759615392888
             stat err =       0.000427880521
             autocorr =       1.144413457306
              std dev =       0.565647712711
             le_variance =       0.319957334895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320037597437
                                         uncertainty =       0.005117213436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320037597437
                                         uncertainty =       0.005117213436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399967605
  error estimate for blocks of size 2^( 2) =       0.000409049447
  error estimate for blocks of size 2^( 3) =       0.000416870141
  error estimate for blocks of size 2^( 4) =       0.000422630731
  error estimate for blocks of size 2^( 5) =       0.000427323851
  error estimate for blocks of size 2^( 6) =       0.000429679113
  error estimate for blocks of size 2^( 7) =       0.000431866121

      target function =                  N/A
              le_mean =     -17.217423086046
             les_mean =     296.759605734185
             stat err =       0.000427874954
             autocorr =       1.144416460427
              std dev =       0.565639611645
             le_variance =       0.319948170262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320030645862
                                         uncertainty =       0.005117104205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320030645862
                                         uncertainty =       0.005117104205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399963266
  error estimate for blocks of size 2^( 2) =       0.000409045214
  error estimate for blocks of size 2^( 3) =       0.000416866107
  error estimate for blocks of size 2^( 4) =       0.000422626732
  error estimate for blocks of size 2^( 5) =       0.000427319852
  error estimate for blocks of size 2^( 6) =       0.000429674716
  error estimate for blocks of size 2^( 7) =       0.000431861814

      target function =                  N/A
              le_mean =     -17.217423011229
             les_mean =     296.759596215880
             stat err =       0.000427870778
             autocorr =       1.144418954918
              std dev =       0.565633475173
             le_variance =       0.319941228236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217423000401        initial
     2.4414e+00     2.4414e+01             8.4457e-05       -17.217423100394  <--
     9.7656e+00     9.7656e+01             1.9724e-05       -17.217423086046
     3.9062e+01     3.9062e+02             4.9519e-06       -17.217423011229

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9555e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.928142e-01 1 1  ON 0
 uu_1                 3.050133e-02 1 1  ON 1
 uu_2                -6.419457e-02 1 1  ON 2
 uu_3                -1.203952e-01 1 1  ON 3
 uu_4                -1.568022e-01 1 1  ON 4
 uu_5                -1.688706e-01 1 1  ON 5
 uu_6                -1.568362e-01 1 1  ON 6
 uu_7                -1.107559e-01 1 1  ON 7
 uu_8                -3.893997e-02 1 1  ON 8
 uu_9                 2.005486e-01 1 1  ON 9
 ud_0                 3.549323e-01 1 1  ON 10
 ud_1                 9.648551e-02 1 1  ON 11
 ud_2                -1.334996e-02 1 1  ON 12
 ud_3                -7.556226e-02 1 1  ON 13
 ud_4                -1.261307e-01 1 1  ON 14
 ud_5                -1.632170e-01 1 1  ON 15
 ud_6                -1.766506e-01 1 1  ON 16
 ud_7                -1.584337e-01 1 1  ON 17
 ud_8                -1.119595e-01 1 1  ON 18
 ud_9                 3.135554e-02 1 1  ON 19
 eO_0                -9.194398e-01 1 1  ON 20
 eO_1                -5.978082e-01 1 1  ON 21
 eO_2                -1.845006e-01 1 1  ON 22
 eO_3                 8.612073e-02 1 1  ON 23
 eO_4                 2.100147e-01 1 1  ON 24
 eO_5                 2.971324e-01 1 1  ON 25
 eO_6                 3.254446e-01 1 1  ON 26
 eO_7                 5.316690e-01 1 1  ON 27
 eO_8                 1.586181e-01 1 1  ON 28
 eO_9                 5.346417e-02 1 1  ON 29
eH1_0                -2.219969e-01 1 1  ON 30
eH1_1                -1.429116e-01 1 1  ON 31
eH1_2                -1.014205e-01 1 1  ON 32
eH1_3                -6.381077e-02 1 1  ON 33
eH1_4                -1.729318e-02 1 1  ON 34
eH1_5                -4.686125e-03 1 1  ON 35
eH1_6                 3.635638e-02 1 1  ON 36
eH1_7                 7.697188e-02 1 1  ON 37
eH1_8                 2.633485e-01 1 1  ON 38
eH1_9                 1.137267e-01 1 1  ON 39
eH2_0                -2.111829e-01 1 1  ON 40
eH2_1                -1.322513e-01 1 1  ON 41
eH2_2                -9.055016e-02 1 1  ON 42
eH2_3                -5.303694e-02 1 1  ON 43
eH2_4                -6.302113e-03 1 1  ON 44
eH2_5                 5.491101e-03 1 1  ON 45
eH2_6                 4.745128e-02 1 1  ON 46
eH2_7                 4.047995e-02 1 1  ON 47
eH2_8                 2.472132e-01 1 1  ON 48
eH2_9                 1.154139e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.373001
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327397422328
                                         uncertainty =       0.005178379260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327397422328
                                         uncertainty =       0.005178379260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404650058
  error estimate for blocks of size 2^( 2) =       0.000414338243
  error estimate for blocks of size 2^( 3) =       0.000422898401
  error estimate for blocks of size 2^( 4) =       0.000429366244
  error estimate for blocks of size 2^( 5) =       0.000435270706
  error estimate for blocks of size 2^( 6) =       0.000437761443
  error estimate for blocks of size 2^( 7) =       0.000438600151

      target function =                  N/A
              le_mean =     -17.216850243959
             les_mean =     296.747415497799
             stat err =       0.000435249636
             autocorr =       1.156958068058
              std dev =       0.572261599826
             le_variance =       0.327483338635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685024396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850243959       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850758762       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216850759523       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216850821728       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216850811994       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216850823707       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216851051069       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.262491e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850243959       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850406174       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216850412258       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216850424333       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216850448445       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216850463159       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216850504652       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.079285e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216850243959       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216850287337       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216850289483       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216850292081       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216850302464       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216850307255       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216850315728       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.548211e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6268e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.928535e-01 1 1  ON 0
 uu_1                 3.048680e-02 1 1  ON 1
 uu_2                -6.419399e-02 1 1  ON 2
 uu_3                -1.204054e-01 1 1  ON 3
 uu_4                -1.567775e-01 1 1  ON 4
 uu_5                -1.688901e-01 1 1  ON 5
 uu_6                -1.568275e-01 1 1  ON 6
 uu_7                -1.107602e-01 1 1  ON 7
 uu_8                -3.895258e-02 1 1  ON 8
 uu_9                 2.005312e-01 1 1  ON 9
 ud_0                 3.549355e-01 1 1  ON 10
 ud_1                 9.648610e-02 1 1  ON 11
 ud_2                -1.334392e-02 1 1  ON 12
 ud_3                -7.558438e-02 1 1  ON 13
 ud_4                -1.261483e-01 1 1  ON 14
 ud_5                -1.632358e-01 1 1  ON 15
 ud_6                -1.765898e-01 1 1  ON 16
 ud_7                -1.584057e-01 1 1  ON 17
 ud_8                -1.119855e-01 1 1  ON 18
 ud_9                 3.133891e-02 1 1  ON 19
 eO_0                -9.194687e-01 1 1  ON 20
 eO_1                -5.978152e-01 1 1  ON 21
 eO_2                -1.845206e-01 1 1  ON 22
 eO_3                 8.612172e-02 1 1  ON 23
 eO_4                 2.100594e-01 1 1  ON 24
 eO_5                 2.971499e-01 1 1  ON 25
 eO_6                 3.254508e-01 1 1  ON 26
 eO_7                 5.316557e-01 1 1  ON 27
 eO_8                 1.586184e-01 1 1  ON 28
 eO_9                 5.346327e-02 1 1  ON 29
eH1_0                -2.219835e-01 1 1  ON 30
eH1_1                -1.429279e-01 1 1  ON 31
eH1_2                -1.013970e-01 1 1  ON 32
eH1_3                -6.380324e-02 1 1  ON 33
eH1_4                -1.729535e-02 1 1  ON 34
eH1_5                -4.668421e-03 1 1  ON 35
eH1_6                 3.635409e-02 1 1  ON 36
eH1_7                 7.694302e-02 1 1  ON 37
eH1_8                 2.633337e-01 1 1  ON 38
eH1_9                 1.137276e-01 1 1  ON 39
eH2_0                -2.111858e-01 1 1  ON 40
eH2_1                -1.322766e-01 1 1  ON 41
eH2_2                -9.054890e-02 1 1  ON 42
eH2_3                -5.300979e-02 1 1  ON 43
eH2_4                -6.330890e-03 1 1  ON 44
eH2_5                 5.510151e-03 1 1  ON 45
eH2_6                 4.745750e-02 1 1  ON 46
eH2_7                 4.049591e-02 1 1  ON 47
eH2_8                 2.472042e-01 1 1  ON 48
eH2_9                 1.154132e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2435
    reference variance = 0.305387
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2485e-01
  Total weights = 2.0000e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835656454
                                         uncertainty =       0.005589652871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835656454
                                         uncertainty =       0.005589652871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403018764
  error estimate for blocks of size 2^( 2) =       0.000412402674
  error estimate for blocks of size 2^( 3) =       0.000420874080
  error estimate for blocks of size 2^( 4) =       0.000427446485
  error estimate for blocks of size 2^( 5) =       0.000432437575
  error estimate for blocks of size 2^( 6) =       0.000433366146
  error estimate for blocks of size 2^( 7) =       0.000435269878

      target function =                  N/A
              le_mean =     -17.216565641377
             les_mean =     296.734980568902
             stat err =       0.000432130021
             autocorr =       1.149683621962
              std dev =       0.569954601233
             le_variance =       0.324848247467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853166619
                                         uncertainty =       0.005589173551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853166619
                                         uncertainty =       0.005589173551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403029669
  error estimate for blocks of size 2^( 2) =       0.000412412575
  error estimate for blocks of size 2^( 3) =       0.000420883934
  error estimate for blocks of size 2^( 4) =       0.000427454803
  error estimate for blocks of size 2^( 5) =       0.000432443955
  error estimate for blocks of size 2^( 6) =       0.000433371901
  error estimate for blocks of size 2^( 7) =       0.000435276112

      target function =                  N/A
              le_mean =     -17.216566031862
             les_mean =     296.735011595248
             stat err =       0.000432136693
             autocorr =       1.149656903603
              std dev =       0.569970023963
             le_variance =       0.324865828217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324844383061
                                         uncertainty =       0.005589403075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324844383061
                                         uncertainty =       0.005589403075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403024204
  error estimate for blocks of size 2^( 2) =       0.000412407609
  error estimate for blocks of size 2^( 3) =       0.000420879106
  error estimate for blocks of size 2^( 4) =       0.000427450625
  error estimate for blocks of size 2^( 5) =       0.000432440558
  error estimate for blocks of size 2^( 6) =       0.000433368666
  error estimate for blocks of size 2^( 7) =       0.000435272780

      target function =                  N/A
              le_mean =     -17.216565849544
             les_mean =     296.734996506807
             stat err =       0.000432133157
             autocorr =       1.149669272750
              std dev =       0.569962294841
             le_variance =       0.324857017541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324836644143
                                         uncertainty =       0.005589623558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324836644143
                                         uncertainty =       0.005589623558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403019380
  error estimate for blocks of size 2^( 2) =       0.000412403229
  error estimate for blocks of size 2^( 3) =       0.000420874654
  error estimate for blocks of size 2^( 4) =       0.000427446947
  error estimate for blocks of size 2^( 5) =       0.000432437886
  error estimate for blocks of size 2^( 6) =       0.000433366392
  error estimate for blocks of size 2^( 7) =       0.000435270181

      target function =                  N/A
              le_mean =     -17.216565665039
             les_mean =     296.734982377086
             stat err =       0.000432130352
             autocorr =       1.149681865992
              std dev =       0.569955472751
             le_variance =       0.324849240918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216565641377        initial
     6.1035e-01     6.1035e+00             2.2625e-04       -17.216566031862  <--
     2.4414e+00     2.4414e+01             6.0793e-05       -17.216565849544
     9.7656e+00     9.7656e+01             1.5482e-05       -17.216565665039

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9499e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.929411e-01 1 1  ON 0
 uu_1                 3.045861e-02 1 1  ON 1
 uu_2                -6.419151e-02 1 1  ON 2
 uu_3                -1.204201e-01 1 1  ON 3
 uu_4                -1.567310e-01 1 1  ON 4
 uu_5                -1.689336e-01 1 1  ON 5
 uu_6                -1.568014e-01 1 1  ON 6
 uu_7                -1.107705e-01 1 1  ON 7
 uu_8                -3.898602e-02 1 1  ON 8
 uu_9                 2.004843e-01 1 1  ON 9
 ud_0                 3.549406e-01 1 1  ON 10
 ud_1                 9.648739e-02 1 1  ON 11
 ud_2                -1.334135e-02 1 1  ON 12
 ud_3                -7.563298e-02 1 1  ON 13
 ud_4                -1.261930e-01 1 1  ON 14
 ud_5                -1.632903e-01 1 1  ON 15
 ud_6                -1.764243e-01 1 1  ON 16
 ud_7                -1.583260e-01 1 1  ON 17
 ud_8                -1.120539e-01 1 1  ON 18
 ud_9                 3.129434e-02 1 1  ON 19
 eO_0                -9.195446e-01 1 1  ON 20
 eO_1                -5.978406e-01 1 1  ON 21
 eO_2                -1.845667e-01 1 1  ON 22
 eO_3                 8.611701e-02 1 1  ON 23
 eO_4                 2.101782e-01 1 1  ON 24
 eO_5                 2.972012e-01 1 1  ON 25
 eO_6                 3.254690e-01 1 1  ON 26
 eO_7                 5.316206e-01 1 1  ON 27
 eO_8                 1.586193e-01 1 1  ON 28
 eO_9                 5.346084e-02 1 1  ON 29
eH1_0                -2.219537e-01 1 1  ON 30
eH1_1                -1.429632e-01 1 1  ON 31
eH1_2                -1.013418e-01 1 1  ON 32
eH1_3                -6.377966e-02 1 1  ON 33
eH1_4                -1.729796e-02 1 1  ON 34
eH1_5                -4.624010e-03 1 1  ON 35
eH1_6                 3.634948e-02 1 1  ON 36
eH1_7                 7.686620e-02 1 1  ON 37
eH1_8                 2.632941e-01 1 1  ON 38
eH1_9                 1.137298e-01 1 1  ON 39
eH2_0                -2.111999e-01 1 1  ON 40
eH2_1                -1.323292e-01 1 1  ON 41
eH2_2                -9.054243e-02 1 1  ON 42
eH2_3                -5.295703e-02 1 1  ON 43
eH2_4                -6.397622e-03 1 1  ON 44
eH2_5                 5.556315e-03 1 1  ON 45
eH2_6                 4.747560e-02 1 1  ON 46
eH2_7                 4.053978e-02 1 1  ON 47
eH2_8                 2.471803e-01 1 1  ON 48
eH2_9                 1.154113e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.10664
====================================================
  Execution time = 2.0751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2390e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323922580699
                                         uncertainty =       0.006983337952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323922580699
                                         uncertainty =       0.006983337952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402430297
  error estimate for blocks of size 2^( 2) =       0.000411882416
  error estimate for blocks of size 2^( 3) =       0.000419976816
  error estimate for blocks of size 2^( 4) =       0.000425920176
  error estimate for blocks of size 2^( 5) =       0.000429367232
  error estimate for blocks of size 2^( 6) =       0.000432396482
  error estimate for blocks of size 2^( 7) =       0.000432501081

      target function =                  N/A
              le_mean =     -17.217126731696
             les_mean =     296.753353020520
             stat err =       0.000430046243
             autocorr =       1.141954967898
              std dev =       0.569122383309
             le_variance =       0.323900287183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712673170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217126731696       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217127410665       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217126736758       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126364860       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217127617042       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217128411442       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217128855871       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217128981418       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217128962470       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217128908169       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 9.173774e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217126731696       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217126997916       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217126677187       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126540808       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217127073759       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217127242150       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217127241720       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.654688e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217126731696       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217126809274       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217126705335       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217126671395       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217126834494       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217126857599       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217126852223       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.456606e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6345e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.927900e-01 1 1  ON 0
 uu_1                 3.056009e-02 1 1  ON 1
 uu_2                -6.420783e-02 1 1  ON 2
 uu_3                -1.204544e-01 1 1  ON 3
 uu_4                -1.568078e-01 1 1  ON 4
 uu_5                -1.689605e-01 1 1  ON 5
 uu_6                -1.568114e-01 1 1  ON 6
 uu_7                -1.107216e-01 1 1  ON 7
 uu_8                -3.890682e-02 1 1  ON 8
 uu_9                 2.004661e-01 1 1  ON 9
 ud_0                 3.549348e-01 1 1  ON 10
 ud_1                 9.645814e-02 1 1  ON 11
 ud_2                -1.340837e-02 1 1  ON 12
 ud_3                -7.571666e-02 1 1  ON 13
 ud_4                -1.262316e-01 1 1  ON 14
 ud_5                -1.633836e-01 1 1  ON 15
 ud_6                -1.764022e-01 1 1  ON 16
 ud_7                -1.581571e-01 1 1  ON 17
 ud_8                -1.119693e-01 1 1  ON 18
 ud_9                 3.128548e-02 1 1  ON 19
 eO_0                -9.198101e-01 1 1  ON 20
 eO_1                -5.980251e-01 1 1  ON 21
 eO_2                -1.845834e-01 1 1  ON 22
 eO_3                 8.621058e-02 1 1  ON 23
 eO_4                 2.104056e-01 1 1  ON 24
 eO_5                 2.973184e-01 1 1  ON 25
 eO_6                 3.254580e-01 1 1  ON 26
 eO_7                 5.315808e-01 1 1  ON 27
 eO_8                 1.586741e-01 1 1  ON 28
 eO_9                 5.348138e-02 1 1  ON 29
eH1_0                -2.220209e-01 1 1  ON 30
eH1_1                -1.428231e-01 1 1  ON 31
eH1_2                -1.013480e-01 1 1  ON 32
eH1_3                -6.373915e-02 1 1  ON 33
eH1_4                -1.723717e-02 1 1  ON 34
eH1_5                -4.666471e-03 1 1  ON 35
eH1_6                 3.629270e-02 1 1  ON 36
eH1_7                 7.679803e-02 1 1  ON 37
eH1_8                 2.632606e-01 1 1  ON 38
eH1_9                 1.137484e-01 1 1  ON 39
eH2_0                -2.112467e-01 1 1  ON 40
eH2_1                -1.323012e-01 1 1  ON 41
eH2_2                -9.058808e-02 1 1  ON 42
eH2_3                -5.295620e-02 1 1  ON 43
eH2_4                -6.393030e-03 1 1  ON 44
eH2_5                 5.446825e-03 1 1  ON 45
eH2_6                 4.751899e-02 1 1  ON 46
eH2_7                 4.065688e-02 1 1  ON 47
eH2_8                 2.471445e-01 1 1  ON 48
eH2_9                 1.154317e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.3641
    reference variance = 0.333752
====================================================
  Execution time = 2.3428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1539e-01
  Total weights = 2.0000e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315383201546
                                         uncertainty =       0.002902963737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315383201546
                                         uncertainty =       0.002902963737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397081903
  error estimate for blocks of size 2^( 2) =       0.000406294816
  error estimate for blocks of size 2^( 3) =       0.000414080816
  error estimate for blocks of size 2^( 4) =       0.000420982493
  error estimate for blocks of size 2^( 5) =       0.000425135397
  error estimate for blocks of size 2^( 6) =       0.000427352112
  error estimate for blocks of size 2^( 7) =       0.000429484398

      target function =                  N/A
              le_mean =     -17.216366596437
             les_mean =     296.718626701032
             stat err =       0.000425738600
             autocorr =       1.149544706098
              std dev =       0.561558612954
             le_variance =       0.315348075783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315530380080
                                         uncertainty =       0.002903734919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315530380080
                                         uncertainty =       0.002903734919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397174500
  error estimate for blocks of size 2^( 2) =       0.000406383347
  error estimate for blocks of size 2^( 3) =       0.000414164114
  error estimate for blocks of size 2^( 4) =       0.000421062246
  error estimate for blocks of size 2^( 5) =       0.000425208765
  error estimate for blocks of size 2^( 6) =       0.000427425872
  error estimate for blocks of size 2^( 7) =       0.000429559934

      target function =                  N/A
              le_mean =     -17.216366227541
             les_mean =     296.718761090209
             stat err =       0.000425814205
             autocorr =       1.149416889423
              std dev =       0.561689564734
             le_variance =       0.315495167131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315474249108
                                         uncertainty =       0.002902999029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315474249108
                                         uncertainty =       0.002902999029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397139150
  error estimate for blocks of size 2^( 2) =       0.000406349021
  error estimate for blocks of size 2^( 3) =       0.000414131403
  error estimate for blocks of size 2^( 4) =       0.000421031201
  error estimate for blocks of size 2^( 5) =       0.000425179721
  error estimate for blocks of size 2^( 6) =       0.000427397146
  error estimate for blocks of size 2^( 7) =       0.000429529972

      target function =                  N/A
              le_mean =     -17.216366603681
             les_mean =     296.718717883392
             stat err =       0.000425784510
             autocorr =       1.149461187636
              std dev =       0.561639571947
             le_variance =       0.315439008777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315397680975
                                         uncertainty =       0.002902955144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315397680975
                                         uncertainty =       0.002902955144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397091007
  error estimate for blocks of size 2^( 2) =       0.000406303375
  error estimate for blocks of size 2^( 3) =       0.000414088769
  error estimate for blocks of size 2^( 4) =       0.000420990147
  error estimate for blocks of size 2^( 5) =       0.000425142375
  error estimate for blocks of size 2^( 6) =       0.000427359173
  error estimate for blocks of size 2^( 7) =       0.000429491502

      target function =                  N/A
              le_mean =     -17.216366553036
             les_mean =     296.718639666591
             stat err =       0.000425745799
             autocorr =       1.149530872351
              std dev =       0.561571487686
             le_variance =       0.315362535782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216366596437        initial
     1.5259e-01     1.5259e+00             9.1738e-04       -17.216366227541
     6.1035e-01     6.1035e+00             2.6547e-04       -17.216366603681  <--
     2.4414e+00     2.4414e+01             7.4566e-05       -17.216366553036

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.2973e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.927900e-01 1 1  ON 0
 uu_1                 3.056009e-02 1 1  ON 1
 uu_2                -6.420783e-02 1 1  ON 2
 uu_3                -1.204544e-01 1 1  ON 3
 uu_4                -1.568078e-01 1 1  ON 4
 uu_5                -1.689605e-01 1 1  ON 5
 uu_6                -1.568114e-01 1 1  ON 6
 uu_7                -1.107216e-01 1 1  ON 7
 uu_8                -3.890682e-02 1 1  ON 8
 uu_9                 2.004661e-01 1 1  ON 9
 ud_0                 3.549348e-01 1 1  ON 10
 ud_1                 9.645814e-02 1 1  ON 11
 ud_2                -1.340837e-02 1 1  ON 12
 ud_3                -7.571666e-02 1 1  ON 13
 ud_4                -1.262316e-01 1 1  ON 14
 ud_5                -1.633836e-01 1 1  ON 15
 ud_6                -1.764022e-01 1 1  ON 16
 ud_7                -1.581571e-01 1 1  ON 17
 ud_8                -1.119693e-01 1 1  ON 18
 ud_9                 3.128548e-02 1 1  ON 19
 eO_0                -9.198101e-01 1 1  ON 20
 eO_1                -5.980251e-01 1 1  ON 21
 eO_2                -1.845834e-01 1 1  ON 22
 eO_3                 8.621058e-02 1 1  ON 23
 eO_4                 2.104056e-01 1 1  ON 24
 eO_5                 2.973184e-01 1 1  ON 25
 eO_6                 3.254580e-01 1 1  ON 26
 eO_7                 5.315808e-01 1 1  ON 27
 eO_8                 1.586741e-01 1 1  ON 28
 eO_9                 5.348138e-02 1 1  ON 29
eH1_0                -2.220209e-01 1 1  ON 30
eH1_1                -1.428231e-01 1 1  ON 31
eH1_2                -1.013480e-01 1 1  ON 32
eH1_3                -6.373915e-02 1 1  ON 33
eH1_4                -1.723717e-02 1 1  ON 34
eH1_5                -4.666471e-03 1 1  ON 35
eH1_6                 3.629270e-02 1 1  ON 36
eH1_7                 7.679803e-02 1 1  ON 37
eH1_8                 2.632606e-01 1 1  ON 38
eH1_9                 1.137484e-01 1 1  ON 39
eH2_0                -2.112467e-01 1 1  ON 40
eH2_1                -1.323012e-01 1 1  ON 41
eH2_2                -9.058808e-02 1 1  ON 42
eH2_3                -5.295620e-02 1 1  ON 43
eH2_4                -6.393030e-03 1 1  ON 44
eH2_5                 5.446825e-03 1 1  ON 45
eH2_6                 4.751899e-02 1 1  ON 46
eH2_7                 4.065688e-02 1 1  ON 47
eH2_8                 2.471445e-01 1 1  ON 48
eH2_9                 1.154317e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2256
    reference variance = 0.133615
====================================================
  Execution time = 2.0724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1742e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317448514105
                                         uncertainty =       0.003094794289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317448514105
                                         uncertainty =       0.003094794289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398383054
  error estimate for blocks of size 2^( 2) =       0.000408042947
  error estimate for blocks of size 2^( 3) =       0.000416597373
  error estimate for blocks of size 2^( 4) =       0.000423454836
  error estimate for blocks of size 2^( 5) =       0.000426743366
  error estimate for blocks of size 2^( 6) =       0.000427321049
  error estimate for blocks of size 2^( 7) =       0.000427492463

      target function =                  N/A
              le_mean =     -17.217300463524
             les_mean =     296.752853207261
             stat err =       0.000426252928
             autocorr =       1.144809011115
              std dev =       0.563398717337
             le_variance =       0.317418114697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721730046352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300463524       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217300152436       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217300337918       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217301701121       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217301303273       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217301122408       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217301227074       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217301177500       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217301125926       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 8.247778e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300463524       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217300303346       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217300352264       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217300739310       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217300989450       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217300767276       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217300760288       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.356109e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217300463524       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217300409050       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217300418628       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217300480674       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217300590202       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217300554377       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217300534465       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.233535e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061578 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6235e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.928670e-01 1 1  ON 0
 uu_1                 3.050847e-02 1 1  ON 1
 uu_2                -6.418493e-02 1 1  ON 2
 uu_3                -1.204806e-01 1 1  ON 3
 uu_4                -1.567957e-01 1 1  ON 4
 uu_5                -1.690384e-01 1 1  ON 5
 uu_6                -1.567973e-01 1 1  ON 6
 uu_7                -1.107225e-01 1 1  ON 7
 uu_8                -3.891110e-02 1 1  ON 8
 uu_9                 2.004375e-01 1 1  ON 9
 ud_0                 3.550047e-01 1 1  ON 10
 ud_1                 9.649005e-02 1 1  ON 11
 ud_2                -1.339498e-02 1 1  ON 12
 ud_3                -7.564988e-02 1 1  ON 13
 ud_4                -1.263131e-01 1 1  ON 14
 ud_5                -1.634726e-01 1 1  ON 15
 ud_6                -1.764591e-01 1 1  ON 16
 ud_7                -1.580816e-01 1 1  ON 17
 ud_8                -1.119738e-01 1 1  ON 18
 ud_9                 3.123743e-02 1 1  ON 19
 eO_0                -9.198772e-01 1 1  ON 20
 eO_1                -5.981177e-01 1 1  ON 21
 eO_2                -1.846523e-01 1 1  ON 22
 eO_3                 8.624467e-02 1 1  ON 23
 eO_4                 2.106412e-01 1 1  ON 24
 eO_5                 2.973077e-01 1 1  ON 25
 eO_6                 3.254316e-01 1 1  ON 26
 eO_7                 5.315388e-01 1 1  ON 27
 eO_8                 1.587006e-01 1 1  ON 28
 eO_9                 5.349245e-02 1 1  ON 29
eH1_0                -2.220393e-01 1 1  ON 30
eH1_1                -1.428152e-01 1 1  ON 31
eH1_2                -1.013071e-01 1 1  ON 32
eH1_3                -6.378686e-02 1 1  ON 33
eH1_4                -1.727579e-02 1 1  ON 34
eH1_5                -4.527844e-03 1 1  ON 35
eH1_6                 3.633314e-02 1 1  ON 36
eH1_7                 7.670794e-02 1 1  ON 37
eH1_8                 2.632136e-01 1 1  ON 38
eH1_9                 1.137512e-01 1 1  ON 39
eH2_0                -2.112224e-01 1 1  ON 40
eH2_1                -1.323394e-01 1 1  ON 41
eH2_2                -9.064735e-02 1 1  ON 42
eH2_3                -5.297324e-02 1 1  ON 43
eH2_4                -6.408488e-03 1 1  ON 44
eH2_5                 5.554398e-03 1 1  ON 45
eH2_6                 4.750556e-02 1 1  ON 46
eH2_7                 4.070322e-02 1 1  ON 47
eH2_8                 2.471086e-01 1 1  ON 48
eH2_9                 1.154285e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.3181
    reference variance = 0.889602
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2177e-01
  Total weights = 2.0000e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321828012079
                                         uncertainty =       0.006518952729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321828012079
                                         uncertainty =       0.006518952729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401076241
  error estimate for blocks of size 2^( 2) =       0.000410471931
  error estimate for blocks of size 2^( 3) =       0.000418406780
  error estimate for blocks of size 2^( 4) =       0.000424182741
  error estimate for blocks of size 2^( 5) =       0.000426625018
  error estimate for blocks of size 2^( 6) =       0.000429019313
  error estimate for blocks of size 2^( 7) =       0.000429415614

      target function =                  N/A
              le_mean =     -17.215991198536
             les_mean =     296.712077089019
             stat err =       0.000427310672
             autocorr =       1.135098648774
              std dev =       0.567207459228
             le_variance =       0.321724301804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321929809881
                                         uncertainty =       0.006519837194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321929809881
                                         uncertainty =       0.006519837194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401139569
  error estimate for blocks of size 2^( 2) =       0.000410533543
  error estimate for blocks of size 2^( 3) =       0.000418465150
  error estimate for blocks of size 2^( 4) =       0.000424238391
  error estimate for blocks of size 2^( 5) =       0.000426680452
  error estimate for blocks of size 2^( 6) =       0.000429073841
  error estimate for blocks of size 2^( 7) =       0.000429468840

      target function =                  N/A
              le_mean =     -17.215989488127
             les_mean =     296.712119802383
             stat err =       0.000427365381
             autocorr =       1.135030862027
              std dev =       0.567297019193
             le_variance =       0.321825907985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321919498164
                                         uncertainty =       0.006520452305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321919498164
                                         uncertainty =       0.006520452305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401133135
  error estimate for blocks of size 2^( 2) =       0.000410526855
  error estimate for blocks of size 2^( 3) =       0.000418458650
  error estimate for blocks of size 2^( 4) =       0.000424232765
  error estimate for blocks of size 2^( 5) =       0.000426675600
  error estimate for blocks of size 2^( 6) =       0.000429069014
  error estimate for blocks of size 2^( 7) =       0.000429464664

      target function =                  N/A
              le_mean =     -17.215989437453
             les_mean =     296.712107734025
             stat err =       0.000427360511
             autocorr =       1.135041402346
              std dev =       0.567287920220
             le_variance =       0.321815584428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321843373689
                                         uncertainty =       0.006519288466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321843373689
                                         uncertainty =       0.006519288466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401085794
  error estimate for blocks of size 2^( 2) =       0.000410481098
  error estimate for blocks of size 2^( 3) =       0.000418415380
  error estimate for blocks of size 2^( 4) =       0.000424191076
  error estimate for blocks of size 2^( 5) =       0.000426633562
  error estimate for blocks of size 2^( 6) =       0.000429027714
  error estimate for blocks of size 2^( 7) =       0.000429423842

      target function =                  N/A
              le_mean =     -17.215990869652
             les_mean =     296.712081091996
             stat err =       0.000427319048
             autocorr =       1.135089076308
              std dev =       0.567220970103
             le_variance =       0.321739628925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215991198536        initial  <--
     1.5259e-01     1.5259e+00             8.2478e-04       -17.215989488127
     6.1035e-01     6.1035e+00             2.3561e-04       -17.215989437453
     2.4414e+00     2.4414e+01             6.2335e-05       -17.215990869652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5871
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.927900e-01 1 1  ON 0
 uu_1                 3.056009e-02 1 1  ON 1
 uu_2                -6.420783e-02 1 1  ON 2
 uu_3                -1.204544e-01 1 1  ON 3
 uu_4                -1.568078e-01 1 1  ON 4
 uu_5                -1.689605e-01 1 1  ON 5
 uu_6                -1.568114e-01 1 1  ON 6
 uu_7                -1.107216e-01 1 1  ON 7
 uu_8                -3.890682e-02 1 1  ON 8
 uu_9                 2.004661e-01 1 1  ON 9
 ud_0                 3.549348e-01 1 1  ON 10
 ud_1                 9.645814e-02 1 1  ON 11
 ud_2                -1.340837e-02 1 1  ON 12
 ud_3                -7.571666e-02 1 1  ON 13
 ud_4                -1.262316e-01 1 1  ON 14
 ud_5                -1.633836e-01 1 1  ON 15
 ud_6                -1.764022e-01 1 1  ON 16
 ud_7                -1.581571e-01 1 1  ON 17
 ud_8                -1.119693e-01 1 1  ON 18
 ud_9                 3.128548e-02 1 1  ON 19
 eO_0                -9.198101e-01 1 1  ON 20
 eO_1                -5.980251e-01 1 1  ON 21
 eO_2                -1.845834e-01 1 1  ON 22
 eO_3                 8.621058e-02 1 1  ON 23
 eO_4                 2.104056e-01 1 1  ON 24
 eO_5                 2.973184e-01 1 1  ON 25
 eO_6                 3.254580e-01 1 1  ON 26
 eO_7                 5.315808e-01 1 1  ON 27
 eO_8                 1.586741e-01 1 1  ON 28
 eO_9                 5.348138e-02 1 1  ON 29
eH1_0                -2.220209e-01 1 1  ON 30
eH1_1                -1.428231e-01 1 1  ON 31
eH1_2                -1.013480e-01 1 1  ON 32
eH1_3                -6.373915e-02 1 1  ON 33
eH1_4                -1.723717e-02 1 1  ON 34
eH1_5                -4.666471e-03 1 1  ON 35
eH1_6                 3.629270e-02 1 1  ON 36
eH1_7                 7.679803e-02 1 1  ON 37
eH1_8                 2.632606e-01 1 1  ON 38
eH1_9                 1.137484e-01 1 1  ON 39
eH2_0                -2.112467e-01 1 1  ON 40
eH2_1                -1.323012e-01 1 1  ON 41
eH2_2                -9.058808e-02 1 1  ON 42
eH2_3                -5.295620e-02 1 1  ON 43
eH2_4                -6.393030e-03 1 1  ON 44
eH2_5                 5.446825e-03 1 1  ON 45
eH2_6                 4.751899e-02 1 1  ON 46
eH2_7                 4.065688e-02 1 1  ON 47
eH2_8                 2.471445e-01 1 1  ON 48
eH2_9                 1.154317e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.192463
====================================================
  Execution time = 2.0659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313941339751
                                         uncertainty =       0.003117360122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313941339751
                                         uncertainty =       0.003117360122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396127617
  error estimate for blocks of size 2^( 2) =       0.000405465064
  error estimate for blocks of size 2^( 3) =       0.000413979114
  error estimate for blocks of size 2^( 4) =       0.000419358126
  error estimate for blocks of size 2^( 5) =       0.000422876367
  error estimate for blocks of size 2^( 6) =       0.000426077573
  error estimate for blocks of size 2^( 7) =       0.000426992197

      target function =                  N/A
              le_mean =     -17.216940198942
             les_mean =     296.736863834171
             stat err =       0.000423826066
             autocorr =       1.144735323307
              std dev =       0.560209047707
             le_variance =       0.313834177132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694019894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940198942       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940154668       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940146376       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940154395       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940453762       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940426503       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940341729       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.368608e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940198942       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940186771       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940181446       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940172989       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940250339       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940246250       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940226220       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.756796e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940198942       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940195822       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940194237       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940191262       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940210459       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940209605       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940204810       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.638257e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6216e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.927880e-01 1 1  ON 0
 uu_1                 3.055915e-02 1 1  ON 1
 uu_2                -6.419518e-02 1 1  ON 2
 uu_3                -1.204533e-01 1 1  ON 3
 uu_4                -1.568191e-01 1 1  ON 4
 uu_5                -1.689531e-01 1 1  ON 5
 uu_6                -1.568070e-01 1 1  ON 6
 uu_7                -1.107330e-01 1 1  ON 7
 uu_8                -3.890921e-02 1 1  ON 8
 uu_9                 2.004624e-01 1 1  ON 9
 ud_0                 3.549342e-01 1 1  ON 10
 ud_1                 9.646289e-02 1 1  ON 11
 ud_2                -1.340405e-02 1 1  ON 12
 ud_3                -7.572125e-02 1 1  ON 13
 ud_4                -1.262352e-01 1 1  ON 14
 ud_5                -1.633865e-01 1 1  ON 15
 ud_6                -1.764058e-01 1 1  ON 16
 ud_7                -1.581465e-01 1 1  ON 17
 ud_8                -1.119724e-01 1 1  ON 18
 ud_9                 3.128023e-02 1 1  ON 19
 eO_0                -9.198172e-01 1 1  ON 20
 eO_1                -5.980627e-01 1 1  ON 21
 eO_2                -1.845761e-01 1 1  ON 22
 eO_3                 8.622542e-02 1 1  ON 23
 eO_4                 2.104286e-01 1 1  ON 24
 eO_5                 2.973203e-01 1 1  ON 25
 eO_6                 3.254563e-01 1 1  ON 26
 eO_7                 5.315760e-01 1 1  ON 27
 eO_8                 1.586768e-01 1 1  ON 28
 eO_9                 5.348226e-02 1 1  ON 29
eH1_0                -2.220267e-01 1 1  ON 30
eH1_1                -1.428148e-01 1 1  ON 31
eH1_2                -1.013409e-01 1 1  ON 32
eH1_3                -6.373671e-02 1 1  ON 33
eH1_4                -1.724096e-02 1 1  ON 34
eH1_5                -4.655438e-03 1 1  ON 35
eH1_6                 3.629270e-02 1 1  ON 36
eH1_7                 7.678426e-02 1 1  ON 37
eH1_8                 2.632534e-01 1 1  ON 38
eH1_9                 1.137486e-01 1 1  ON 39
eH2_0                -2.112347e-01 1 1  ON 40
eH2_1                -1.322915e-01 1 1  ON 41
eH2_2                -9.059294e-02 1 1  ON 42
eH2_3                -5.296211e-02 1 1  ON 43
eH2_4                -6.415923e-03 1 1  ON 44
eH2_5                 5.450847e-03 1 1  ON 45
eH2_6                 4.752054e-02 1 1  ON 46
eH2_7                 4.066429e-02 1 1  ON 47
eH2_8                 2.471414e-01 1 1  ON 48
eH2_9                 1.154330e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2075
    reference variance = 0.251772
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1935e-01
  Total weights = 2.0000e+06
  Execution time = 1.8876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319297397130
                                         uncertainty =       0.003768762917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319297397130
                                         uncertainty =       0.003768762917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399598999
  error estimate for blocks of size 2^( 2) =       0.000409531377
  error estimate for blocks of size 2^( 3) =       0.000417581510
  error estimate for blocks of size 2^( 4) =       0.000423586376
  error estimate for blocks of size 2^( 5) =       0.000428477869
  error estimate for blocks of size 2^( 6) =       0.000429659019
  error estimate for blocks of size 2^( 7) =       0.000431551885

      target function =                  N/A
              le_mean =     -17.216546359926
             les_mean =     296.728827124291
             stat err =       0.000428318788
             autocorr =       1.148908559409
              std dev =       0.565118324313
             le_variance =       0.319358720475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319270250315
                                         uncertainty =       0.003768879385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319270250315
                                         uncertainty =       0.003768879385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399582020
  error estimate for blocks of size 2^( 2) =       0.000409515797
  error estimate for blocks of size 2^( 3) =       0.000417566218
  error estimate for blocks of size 2^( 4) =       0.000423569938
  error estimate for blocks of size 2^( 5) =       0.000428461429
  error estimate for blocks of size 2^( 6) =       0.000429643203
  error estimate for blocks of size 2^( 7) =       0.000431534862

      target function =                  N/A
              le_mean =     -17.216546436578
             les_mean =     296.728802623930
             stat err =       0.000428302358
             autocorr =       1.148918056897
              std dev =       0.565094311387
             le_variance =       0.319331580762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319280239640
                                         uncertainty =       0.003768816048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319280239640
                                         uncertainty =       0.003768816048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399588267
  error estimate for blocks of size 2^( 2) =       0.000409521475
  error estimate for blocks of size 2^( 3) =       0.000417571818
  error estimate for blocks of size 2^( 4) =       0.000423576029
  error estimate for blocks of size 2^( 5) =       0.000428467546
  error estimate for blocks of size 2^( 6) =       0.000429649085
  error estimate for blocks of size 2^( 7) =       0.000431541297

      target function =                  N/A
              le_mean =     -17.216546410693
             les_mean =     296.728811717602
             stat err =       0.000428308489
             autocorr =       1.148915027990
              std dev =       0.565103146089
             le_variance =       0.319341565720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319295098109
                                         uncertainty =       0.003768769297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319295098109
                                         uncertainty =       0.003768769297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399597561
  error estimate for blocks of size 2^( 2) =       0.000409530048
  error estimate for blocks of size 2^( 3) =       0.000417580209
  error estimate for blocks of size 2^( 4) =       0.000423584991
  error estimate for blocks of size 2^( 5) =       0.000428476488
  error estimate for blocks of size 2^( 6) =       0.000429657690
  error estimate for blocks of size 2^( 7) =       0.000431550472

      target function =                  N/A
              le_mean =     -17.216546365932
             les_mean =     296.728825032372
             stat err =       0.000428317410
             autocorr =       1.148909439554
              std dev =       0.565116290466
             le_variance =       0.319356421750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216546359926        initial
     1.5259e+00     1.5259e+01             1.3686e-04       -17.216546436578  <--
     6.1035e+00     6.1035e+01             3.7568e-05       -17.216546410693
     2.4414e+01     2.4414e+02             9.6383e-06       -17.216546365932

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9990e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.927809e-01 1 1  ON 0
 uu_1                 3.056229e-02 1 1  ON 1
 uu_2                -6.416511e-02 1 1  ON 2
 uu_3                -1.204490e-01 1 1  ON 3
 uu_4                -1.568470e-01 1 1  ON 4
 uu_5                -1.689357e-01 1 1  ON 5
 uu_6                -1.567946e-01 1 1  ON 6
 uu_7                -1.107657e-01 1 1  ON 7
 uu_8                -3.891615e-02 1 1  ON 8
 uu_9                 2.004515e-01 1 1  ON 9
 ud_0                 3.549343e-01 1 1  ON 10
 ud_1                 9.647595e-02 1 1  ON 11
 ud_2                -1.339358e-02 1 1  ON 12
 ud_3                -7.573303e-02 1 1  ON 13
 ud_4                -1.262464e-01 1 1  ON 14
 ud_5                -1.633946e-01 1 1  ON 15
 ud_6                -1.764159e-01 1 1  ON 16
 ud_7                -1.581157e-01 1 1  ON 17
 ud_8                -1.119812e-01 1 1  ON 18
 ud_9                 3.126506e-02 1 1  ON 19
 eO_0                -9.198452e-01 1 1  ON 20
 eO_1                -5.981620e-01 1 1  ON 21
 eO_2                -1.845561e-01 1 1  ON 22
 eO_3                 8.626824e-02 1 1  ON 23
 eO_4                 2.104941e-01 1 1  ON 24
 eO_5                 2.973256e-01 1 1  ON 25
 eO_6                 3.254515e-01 1 1  ON 26
 eO_7                 5.315619e-01 1 1  ON 27
 eO_8                 1.586847e-01 1 1  ON 28
 eO_9                 5.348479e-02 1 1  ON 29
eH1_0                -2.220427e-01 1 1  ON 30
eH1_1                -1.427900e-01 1 1  ON 31
eH1_2                -1.013224e-01 1 1  ON 32
eH1_3                -6.372707e-02 1 1  ON 33
eH1_4                -1.725331e-02 1 1  ON 34
eH1_5                -4.624022e-03 1 1  ON 35
eH1_6                 3.629264e-02 1 1  ON 36
eH1_7                 7.674443e-02 1 1  ON 37
eH1_8                 2.632326e-01 1 1  ON 38
eH1_9                 1.137493e-01 1 1  ON 39
eH2_0                -2.111998e-01 1 1  ON 40
eH2_1                -1.322650e-01 1 1  ON 41
eH2_2                -9.060681e-02 1 1  ON 42
eH2_3                -5.297676e-02 1 1  ON 43
eH2_4                -6.482930e-03 1 1  ON 44
eH2_5                 5.461801e-03 1 1  ON 45
eH2_6                 4.752519e-02 1 1  ON 46
eH2_7                 4.068585e-02 1 1  ON 47
eH2_8                 2.471323e-01 1 1  ON 48
eH2_9                 1.154367e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6211e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.391566
====================================================
  Execution time = 2.0675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315016353494
                                         uncertainty =       0.002727996656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315016353494
                                         uncertainty =       0.002727996656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396948890
  error estimate for blocks of size 2^( 2) =       0.000406696080
  error estimate for blocks of size 2^( 3) =       0.000415370845
  error estimate for blocks of size 2^( 4) =       0.000421266878
  error estimate for blocks of size 2^( 5) =       0.000425385929
  error estimate for blocks of size 2^( 6) =       0.000427104802
  error estimate for blocks of size 2^( 7) =       0.000428317124

      target function =                  N/A
              le_mean =     -17.216992496477
             les_mean =     296.739967308847
             stat err =       0.000425518683
             autocorr =       1.149127141760
              std dev =       0.561370503930
             le_variance =       0.315136842683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699249648e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992496477       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216993433994       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216994304654       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216995233300       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216995492274       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216995545932       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216995545373       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216995665909       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.696913e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992496477       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216992822910       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216993124473       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216993454091       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216993535732       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216993546651       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216993525183       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 8.852768e-05

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992496477       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216992586970       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216992671616       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216992765209       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216992785297       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216992788433       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216992782164       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.494311e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6260e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.928419e-01 1 1  ON 0
 uu_1                 3.055494e-02 1 1  ON 1
 uu_2                -6.419112e-02 1 1  ON 2
 uu_3                -1.204520e-01 1 1  ON 3
 uu_4                -1.568448e-01 1 1  ON 4
 uu_5                -1.689367e-01 1 1  ON 5
 uu_6                -1.568215e-01 1 1  ON 6
 uu_7                -1.107852e-01 1 1  ON 7
 uu_8                -3.890921e-02 1 1  ON 8
 uu_9                 2.004424e-01 1 1  ON 9
 ud_0                 3.549618e-01 1 1  ON 10
 ud_1                 9.646136e-02 1 1  ON 11
 ud_2                -1.338455e-02 1 1  ON 12
 ud_3                -7.575507e-02 1 1  ON 13
 ud_4                -1.262733e-01 1 1  ON 14
 ud_5                -1.634505e-01 1 1  ON 15
 ud_6                -1.763872e-01 1 1  ON 16
 ud_7                -1.580728e-01 1 1  ON 17
 ud_8                -1.119716e-01 1 1  ON 18
 ud_9                 3.124595e-02 1 1  ON 19
 eO_0                -9.198734e-01 1 1  ON 20
 eO_1                -5.982294e-01 1 1  ON 21
 eO_2                -1.845542e-01 1 1  ON 22
 eO_3                 8.626374e-02 1 1  ON 23
 eO_4                 2.105581e-01 1 1  ON 24
 eO_5                 2.973585e-01 1 1  ON 25
 eO_6                 3.254556e-01 1 1  ON 26
 eO_7                 5.315416e-01 1 1  ON 27
 eO_8                 1.586960e-01 1 1  ON 28
 eO_9                 5.348861e-02 1 1  ON 29
eH1_0                -2.220291e-01 1 1  ON 30
eH1_1                -1.428161e-01 1 1  ON 31
eH1_2                -1.012994e-01 1 1  ON 32
eH1_3                -6.376455e-02 1 1  ON 33
eH1_4                -1.726492e-02 1 1  ON 34
eH1_5                -4.554602e-03 1 1  ON 35
eH1_6                 3.629556e-02 1 1  ON 36
eH1_7                 7.672206e-02 1 1  ON 37
eH1_8                 2.632176e-01 1 1  ON 38
eH1_9                 1.137513e-01 1 1  ON 39
eH2_0                -2.112242e-01 1 1  ON 40
eH2_1                -1.322572e-01 1 1  ON 41
eH2_2                -9.051828e-02 1 1  ON 42
eH2_3                -5.300412e-02 1 1  ON 43
eH2_4                -6.542006e-03 1 1  ON 44
eH2_5                 5.431416e-03 1 1  ON 45
eH2_6                 4.752439e-02 1 1  ON 46
eH2_7                 4.072532e-02 1 1  ON 47
eH2_8                 2.471265e-01 1 1  ON 48
eH2_9                 1.154433e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.18
    reference variance = 0.22223
====================================================
  Execution time = 2.0040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1952e-01
  Total weights = 2.0000e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547707611
                                         uncertainty =       0.003254394175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547707611
                                         uncertainty =       0.003254394175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399686649
  error estimate for blocks of size 2^( 2) =       0.000408819057
  error estimate for blocks of size 2^( 3) =       0.000417282153
  error estimate for blocks of size 2^( 4) =       0.000422774882
  error estimate for blocks of size 2^( 5) =       0.000425618681
  error estimate for blocks of size 2^( 6) =       0.000426887402
  error estimate for blocks of size 2^( 7) =       0.000427761796

      target function =                  N/A
              le_mean =     -17.217214959497
             les_mean =     296.751989637245
             stat err =       0.000425760690
             autocorr =       1.134728176258
              std dev =       0.565242280323
             le_variance =       0.319498835464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319612774748
                                         uncertainty =       0.003256246134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319612774748
                                         uncertainty =       0.003256246134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399727311
  error estimate for blocks of size 2^( 2) =       0.000408859024
  error estimate for blocks of size 2^( 3) =       0.000417323075
  error estimate for blocks of size 2^( 4) =       0.000422817167
  error estimate for blocks of size 2^( 5) =       0.000425661313
  error estimate for blocks of size 2^( 6) =       0.000426930266
  error estimate for blocks of size 2^( 7) =       0.000427800800

      target function =                  N/A
              le_mean =     -17.217213364418
             les_mean =     296.751999721972
             stat err =       0.000425802386
             autocorr =       1.134719553593
              std dev =       0.565299784061
             le_variance =       0.319563845859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319598466869
                                         uncertainty =       0.003255801096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319598466869
                                         uncertainty =       0.003255801096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399718369
  error estimate for blocks of size 2^( 2) =       0.000408850125
  error estimate for blocks of size 2^( 3) =       0.000417314005
  error estimate for blocks of size 2^( 4) =       0.000422807835
  error estimate for blocks of size 2^( 5) =       0.000425652071
  error estimate for blocks of size 2^( 6) =       0.000426920785
  error estimate for blocks of size 2^( 7) =       0.000427792114

      target function =                  N/A
              le_mean =     -17.217213844372
             les_mean =     296.752001951830
             stat err =       0.000425793201
             autocorr =       1.134721366045
              std dev =       0.565287138335
             le_variance =       0.319549548768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319555292557
                                         uncertainty =       0.003254601288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319555292557
                                         uncertainty =       0.003254601288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399691389
  error estimate for blocks of size 2^( 2) =       0.000408823689
  error estimate for blocks of size 2^( 3) =       0.000417286885
  error estimate for blocks of size 2^( 4) =       0.000422779775
  error estimate for blocks of size 2^( 5) =       0.000425623650
  error estimate for blocks of size 2^( 6) =       0.000426892352
  error estimate for blocks of size 2^( 7) =       0.000427766282

      target function =                  N/A
              le_mean =     -17.217214778811
             les_mean =     296.751990992977
             stat err =       0.000425765515
             autocorr =       1.134726979549
              std dev =       0.565248983203
             le_variance =       0.319506413012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217214959497        initial  <--
     3.8147e-01     3.8147e+00             2.6969e-04       -17.217213364418
     1.5259e+00     1.5259e+01             8.8528e-05       -17.217213844372
     6.1035e+00     6.1035e+01             2.4943e-05       -17.217214778811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5156
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.927809e-01 1 1  ON 0
 uu_1                 3.056229e-02 1 1  ON 1
 uu_2                -6.416511e-02 1 1  ON 2
 uu_3                -1.204490e-01 1 1  ON 3
 uu_4                -1.568470e-01 1 1  ON 4
 uu_5                -1.689357e-01 1 1  ON 5
 uu_6                -1.567946e-01 1 1  ON 6
 uu_7                -1.107657e-01 1 1  ON 7
 uu_8                -3.891615e-02 1 1  ON 8
 uu_9                 2.004515e-01 1 1  ON 9
 ud_0                 3.549343e-01 1 1  ON 10
 ud_1                 9.647595e-02 1 1  ON 11
 ud_2                -1.339358e-02 1 1  ON 12
 ud_3                -7.573303e-02 1 1  ON 13
 ud_4                -1.262464e-01 1 1  ON 14
 ud_5                -1.633946e-01 1 1  ON 15
 ud_6                -1.764159e-01 1 1  ON 16
 ud_7                -1.581157e-01 1 1  ON 17
 ud_8                -1.119812e-01 1 1  ON 18
 ud_9                 3.126506e-02 1 1  ON 19
 eO_0                -9.198452e-01 1 1  ON 20
 eO_1                -5.981620e-01 1 1  ON 21
 eO_2                -1.845561e-01 1 1  ON 22
 eO_3                 8.626824e-02 1 1  ON 23
 eO_4                 2.104941e-01 1 1  ON 24
 eO_5                 2.973256e-01 1 1  ON 25
 eO_6                 3.254515e-01 1 1  ON 26
 eO_7                 5.315619e-01 1 1  ON 27
 eO_8                 1.586847e-01 1 1  ON 28
 eO_9                 5.348479e-02 1 1  ON 29
eH1_0                -2.220427e-01 1 1  ON 30
eH1_1                -1.427900e-01 1 1  ON 31
eH1_2                -1.013224e-01 1 1  ON 32
eH1_3                -6.372707e-02 1 1  ON 33
eH1_4                -1.725331e-02 1 1  ON 34
eH1_5                -4.624022e-03 1 1  ON 35
eH1_6                 3.629264e-02 1 1  ON 36
eH1_7                 7.674443e-02 1 1  ON 37
eH1_8                 2.632326e-01 1 1  ON 38
eH1_9                 1.137493e-01 1 1  ON 39
eH2_0                -2.111998e-01 1 1  ON 40
eH2_1                -1.322650e-01 1 1  ON 41
eH2_2                -9.060681e-02 1 1  ON 42
eH2_3                -5.297676e-02 1 1  ON 43
eH2_4                -6.482930e-03 1 1  ON 44
eH2_5                 5.461801e-03 1 1  ON 45
eH2_6                 4.752519e-02 1 1  ON 46
eH2_7                 4.068585e-02 1 1  ON 47
eH2_8                 2.471323e-01 1 1  ON 48
eH2_9                 1.154367e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1419
    reference variance = 0.254907
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320884770868
                                         uncertainty =       0.004847008793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320884770868
                                         uncertainty =       0.004847008793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400655339
  error estimate for blocks of size 2^( 2) =       0.000409650934
  error estimate for blocks of size 2^( 3) =       0.000418037051
  error estimate for blocks of size 2^( 4) =       0.000423893616
  error estimate for blocks of size 2^( 5) =       0.000428326088
  error estimate for blocks of size 2^( 6) =       0.000429718816
  error estimate for blocks of size 2^( 7) =       0.000433117343

      target function =                  N/A
              le_mean =     -17.217318060774
             les_mean =     296.757090447133
             stat err =       0.000428763966
             autocorr =       1.145235202398
              std dev =       0.566612214667
             le_variance =       0.321049401810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731806077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318060774       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318133596       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318315678       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318291194       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318267884       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318256595       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.509430e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318060774       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318079542       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318127692       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318121660       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318117541       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318114527       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 9.026204e-06

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318060774       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318065502       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318077717       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318076218       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318075317       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318074560       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.273345e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6076e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.927786e-01 1 1  ON 0
 uu_1                 3.056398e-02 1 1  ON 1
 uu_2                -6.416424e-02 1 1  ON 2
 uu_3                -1.204518e-01 1 1  ON 3
 uu_4                -1.568448e-01 1 1  ON 4
 uu_5                -1.689356e-01 1 1  ON 5
 uu_6                -1.567937e-01 1 1  ON 6
 uu_7                -1.107676e-01 1 1  ON 7
 uu_8                -3.891611e-02 1 1  ON 8
 uu_9                 2.004499e-01 1 1  ON 9
 ud_0                 3.549422e-01 1 1  ON 10
 ud_1                 9.647728e-02 1 1  ON 11
 ud_2                -1.339265e-02 1 1  ON 12
 ud_3                -7.573378e-02 1 1  ON 13
 ud_4                -1.262505e-01 1 1  ON 14
 ud_5                -1.633982e-01 1 1  ON 15
 ud_6                -1.764187e-01 1 1  ON 16
 ud_7                -1.581139e-01 1 1  ON 17
 ud_8                -1.119809e-01 1 1  ON 18
 ud_9                 3.126328e-02 1 1  ON 19
 eO_0                -9.198542e-01 1 1  ON 20
 eO_1                -5.981633e-01 1 1  ON 21
 eO_2                -1.845557e-01 1 1  ON 22
 eO_3                 8.627420e-02 1 1  ON 23
 eO_4                 2.104997e-01 1 1  ON 24
 eO_5                 2.973254e-01 1 1  ON 25
 eO_6                 3.254507e-01 1 1  ON 26
 eO_7                 5.315597e-01 1 1  ON 27
 eO_8                 1.586857e-01 1 1  ON 28
 eO_9                 5.348508e-02 1 1  ON 29
eH1_0                -2.220389e-01 1 1  ON 30
eH1_1                -1.427887e-01 1 1  ON 31
eH1_2                -1.013253e-01 1 1  ON 32
eH1_3                -6.372949e-02 1 1  ON 33
eH1_4                -1.725375e-02 1 1  ON 34
eH1_5                -4.618933e-03 1 1  ON 35
eH1_6                 3.629316e-02 1 1  ON 36
eH1_7                 7.674100e-02 1 1  ON 37
eH1_8                 2.632307e-01 1 1  ON 38
eH1_9                 1.137495e-01 1 1  ON 39
eH2_0                -2.111997e-01 1 1  ON 40
eH2_1                -1.322615e-01 1 1  ON 41
eH2_2                -9.060971e-02 1 1  ON 42
eH2_3                -5.297917e-02 1 1  ON 43
eH2_4                -6.480938e-03 1 1  ON 44
eH2_5                 5.455259e-03 1 1  ON 45
eH2_6                 4.752667e-02 1 1  ON 46
eH2_7                 4.069079e-02 1 1  ON 47
eH2_8                 2.471314e-01 1 1  ON 48
eH2_9                 1.154369e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1268
    reference variance = 0.222097
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.0000e+06
  Execution time = 1.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313888666790
                                         uncertainty =       0.002749923251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313888666790
                                         uncertainty =       0.002749923251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936377
  error estimate for blocks of size 2^( 2) =       0.000406337717
  error estimate for blocks of size 2^( 3) =       0.000415027029
  error estimate for blocks of size 2^( 4) =       0.000421930650
  error estimate for blocks of size 2^( 5) =       0.000426519315
  error estimate for blocks of size 2^( 6) =       0.000429322541
  error estimate for blocks of size 2^( 7) =       0.000429514268

      target function =                  N/A
              le_mean =     -17.217575445856
             les_mean =     296.760021050400
             stat err =       0.000426821694
             autocorr =       1.156248460103
              std dev =       0.561352807255
             le_variance =       0.315116974213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313916381269
                                         uncertainty =       0.002750196165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313916381269
                                         uncertainty =       0.002750196165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396953858
  error estimate for blocks of size 2^( 2) =       0.000406354495
  error estimate for blocks of size 2^( 3) =       0.000415042935
  error estimate for blocks of size 2^( 4) =       0.000421945475
  error estimate for blocks of size 2^( 5) =       0.000426533791
  error estimate for blocks of size 2^( 6) =       0.000429336736
  error estimate for blocks of size 2^( 7) =       0.000429528650

      target function =                  N/A
              le_mean =     -17.217575502049
             les_mean =     296.760050742039
             stat err =       0.000426836163
             autocorr =       1.156225011922
              std dev =       0.561377529711
             le_variance =       0.315144730865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313903088800
                                         uncertainty =       0.002750063827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313903088800
                                         uncertainty =       0.002750063827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396945473
  error estimate for blocks of size 2^( 2) =       0.000406346441
  error estimate for blocks of size 2^( 3) =       0.000415035297
  error estimate for blocks of size 2^( 4) =       0.000421938345
  error estimate for blocks of size 2^( 5) =       0.000426526824
  error estimate for blocks of size 2^( 6) =       0.000429329901
  error estimate for blocks of size 2^( 7) =       0.000429521722

      target function =                  N/A
              le_mean =     -17.217575472203
             les_mean =     296.760036400120
             stat err =       0.000426829198
             autocorr =       1.156236127572
              std dev =       0.561365671106
             le_variance =       0.315131416696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313890488223
                                         uncertainty =       0.002749940956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313890488223
                                         uncertainty =       0.002749940956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396937525
  error estimate for blocks of size 2^( 2) =       0.000406338818
  error estimate for blocks of size 2^( 3) =       0.000415028073
  error estimate for blocks of size 2^( 4) =       0.000421931621
  error estimate for blocks of size 2^( 5) =       0.000426520263
  error estimate for blocks of size 2^( 6) =       0.000429323470
  error estimate for blocks of size 2^( 7) =       0.000429515208

      target function =                  N/A
              le_mean =     -17.217575449027
             les_mean =     296.760022983564
             stat err =       0.000426822640
             autocorr =       1.156246897338
              std dev =       0.561354431866
             le_variance =       0.315118798176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217575445856        initial
     3.8147e+00     3.8147e+01             3.5094e-05       -17.217575502049  <--
     1.5259e+01     1.5259e+02             9.0262e-06       -17.217575472203
     6.1035e+01     6.1035e+02             2.2733e-06       -17.217575449027

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9557e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.927726e-01 1 1  ON 0
 uu_1                 3.056881e-02 1 1  ON 1
 uu_2                -6.416236e-02 1 1  ON 2
 uu_3                -1.204590e-01 1 1  ON 3
 uu_4                -1.568393e-01 1 1  ON 4
 uu_5                -1.689348e-01 1 1  ON 5
 uu_6                -1.567910e-01 1 1  ON 6
 uu_7                -1.107732e-01 1 1  ON 7
 uu_8                -3.891601e-02 1 1  ON 8
 uu_9                 2.004453e-01 1 1  ON 9
 ud_0                 3.549648e-01 1 1  ON 10
 ud_1                 9.648132e-02 1 1  ON 11
 ud_2                -1.338956e-02 1 1  ON 12
 ud_3                -7.573617e-02 1 1  ON 13
 ud_4                -1.262619e-01 1 1  ON 14
 ud_5                -1.634089e-01 1 1  ON 15
 ud_6                -1.764272e-01 1 1  ON 16
 ud_7                -1.581088e-01 1 1  ON 17
 ud_8                -1.119799e-01 1 1  ON 18
 ud_9                 3.125807e-02 1 1  ON 19
 eO_0                -9.198803e-01 1 1  ON 20
 eO_1                -5.981675e-01 1 1  ON 21
 eO_2                -1.845545e-01 1 1  ON 22
 eO_3                 8.629154e-02 1 1  ON 23
 eO_4                 2.105162e-01 1 1  ON 24
 eO_5                 2.973250e-01 1 1  ON 25
 eO_6                 3.254485e-01 1 1  ON 26
 eO_7                 5.315534e-01 1 1  ON 27
 eO_8                 1.586885e-01 1 1  ON 28
 eO_9                 5.348591e-02 1 1  ON 29
eH1_0                -2.220278e-01 1 1  ON 30
eH1_1                -1.427852e-01 1 1  ON 31
eH1_2                -1.013335e-01 1 1  ON 32
eH1_3                -6.373661e-02 1 1  ON 33
eH1_4                -1.725507e-02 1 1  ON 34
eH1_5                -4.603821e-03 1 1  ON 35
eH1_6                 3.629475e-02 1 1  ON 36
eH1_7                 7.673090e-02 1 1  ON 37
eH1_8                 2.632251e-01 1 1  ON 38
eH1_9                 1.137499e-01 1 1  ON 39
eH2_0                -2.111996e-01 1 1  ON 40
eH2_1                -1.322516e-01 1 1  ON 41
eH2_2                -9.061777e-02 1 1  ON 42
eH2_3                -5.298628e-02 1 1  ON 43
eH2_4                -6.475238e-03 1 1  ON 44
eH2_5                 5.436094e-03 1 1  ON 45
eH2_6                 4.753101e-02 1 1  ON 46
eH2_7                 4.070531e-02 1 1  ON 47
eH2_8                 2.471287e-01 1 1  ON 48
eH2_9                 1.154376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2818
    reference variance = 0.180298
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324382879552
                                         uncertainty =       0.009308828353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324382879552
                                         uncertainty =       0.009308828353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402731040
  error estimate for blocks of size 2^( 2) =       0.000412389037
  error estimate for blocks of size 2^( 3) =       0.000420797829
  error estimate for blocks of size 2^( 4) =       0.000427872491
  error estimate for blocks of size 2^( 5) =       0.000431339157
  error estimate for blocks of size 2^( 6) =       0.000433840937
  error estimate for blocks of size 2^( 7) =       0.000436078853

      target function =                  N/A
              le_mean =     -17.216711483494
             les_mean =     296.739538724733
             stat err =       0.000432282860
             autocorr =       1.152141510787
              std dev =       0.569547698674
             le_variance =       0.324384581064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671148349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711483494       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711691177       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216712033573       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216712189094       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216712343869       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216712225710       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216712355739       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.410821e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711483494       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711544344       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711652088       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711701728       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711752497       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216711714863       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216711749824       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.717303e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216711483494       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711499390       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216711528188       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711541660       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216711555623       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216711545636       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216711554528       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 9.432766e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5964e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.927872e-01 1 1  ON 0
 uu_1                 3.057926e-02 1 1  ON 1
 uu_2                -6.415000e-02 1 1  ON 2
 uu_3                -1.204722e-01 1 1  ON 3
 uu_4                -1.568507e-01 1 1  ON 4
 uu_5                -1.689354e-01 1 1  ON 5
 uu_6                -1.568048e-01 1 1  ON 6
 uu_7                -1.107860e-01 1 1  ON 7
 uu_8                -3.891459e-02 1 1  ON 8
 uu_9                 2.004435e-01 1 1  ON 9
 ud_0                 3.549898e-01 1 1  ON 10
 ud_1                 9.646184e-02 1 1  ON 11
 ud_2                -1.339234e-02 1 1  ON 12
 ud_3                -7.573194e-02 1 1  ON 13
 ud_4                -1.262772e-01 1 1  ON 14
 ud_5                -1.634182e-01 1 1  ON 15
 ud_6                -1.764308e-01 1 1  ON 16
 ud_7                -1.580974e-01 1 1  ON 17
 ud_8                -1.119753e-01 1 1  ON 18
 ud_9                 3.125384e-02 1 1  ON 19
 eO_0                -9.198869e-01 1 1  ON 20
 eO_1                -5.981885e-01 1 1  ON 21
 eO_2                -1.845607e-01 1 1  ON 22
 eO_3                 8.630029e-02 1 1  ON 23
 eO_4                 2.105534e-01 1 1  ON 24
 eO_5                 2.973194e-01 1 1  ON 25
 eO_6                 3.254393e-01 1 1  ON 26
 eO_7                 5.315450e-01 1 1  ON 27
 eO_8                 1.586953e-01 1 1  ON 28
 eO_9                 5.348906e-02 1 1  ON 29
eH1_0                -2.220170e-01 1 1  ON 30
eH1_1                -1.427832e-01 1 1  ON 31
eH1_2                -1.013263e-01 1 1  ON 32
eH1_3                -6.373632e-02 1 1  ON 33
eH1_4                -1.724937e-02 1 1  ON 34
eH1_5                -4.615595e-03 1 1  ON 35
eH1_6                 3.629254e-02 1 1  ON 36
eH1_7                 7.671901e-02 1 1  ON 37
eH1_8                 2.632172e-01 1 1  ON 38
eH1_9                 1.137542e-01 1 1  ON 39
eH2_0                -2.112023e-01 1 1  ON 40
eH2_1                -1.322823e-01 1 1  ON 41
eH2_2                -9.061097e-02 1 1  ON 42
eH2_3                -5.299942e-02 1 1  ON 43
eH2_4                -6.467258e-03 1 1  ON 44
eH2_5                 5.466283e-03 1 1  ON 45
eH2_6                 4.753337e-02 1 1  ON 46
eH2_7                 4.071124e-02 1 1  ON 47
eH2_8                 2.471212e-01 1 1  ON 48
eH2_9                 1.154374e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2394
    reference variance = 0.393399
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1801e-01
  Total weights = 2.0000e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318032345908
                                         uncertainty =       0.003640790198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318032345908
                                         uncertainty =       0.003640790198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398737323
  error estimate for blocks of size 2^( 2) =       0.000407876790
  error estimate for blocks of size 2^( 3) =       0.000416215811
  error estimate for blocks of size 2^( 4) =       0.000422701877
  error estimate for blocks of size 2^( 5) =       0.000425658301
  error estimate for blocks of size 2^( 6) =       0.000427767825
  error estimate for blocks of size 2^( 7) =       0.000428288107

      target function =                  N/A
              le_mean =     -17.216729166008
             les_mean =     296.733745921714
             stat err =       0.000426104027
             autocorr =       1.141977378843
              std dev =       0.563899729588
             le_variance =       0.317982905029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114779867
                                         uncertainty =       0.003641193719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318114779867
                                         uncertainty =       0.003641193719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398789028
  error estimate for blocks of size 2^( 2) =       0.000407926327
  error estimate for blocks of size 2^( 3) =       0.000416263498
  error estimate for blocks of size 2^( 4) =       0.000422747348
  error estimate for blocks of size 2^( 5) =       0.000425702225
  error estimate for blocks of size 2^( 6) =       0.000427811545
  error estimate for blocks of size 2^( 7) =       0.000428332694

      target function =                  N/A
              le_mean =     -17.216729741491
             les_mean =     296.733848210013
             stat err =       0.000426148453
             autocorr =       1.141919346151
              std dev =       0.563972851751
             le_variance =       0.318065377512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318087283842
                                         uncertainty =       0.003641050888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318087283842
                                         uncertainty =       0.003641050888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398771784
  error estimate for blocks of size 2^( 2) =       0.000407909836
  error estimate for blocks of size 2^( 3) =       0.000416247705
  error estimate for blocks of size 2^( 4) =       0.000422732254
  error estimate for blocks of size 2^( 5) =       0.000425687654
  error estimate for blocks of size 2^( 6) =       0.000427797047
  error estimate for blocks of size 2^( 7) =       0.000428317834

      target function =                  N/A
              le_mean =     -17.216729567593
             les_mean =     296.733814715767
             stat err =       0.000426133697
             autocorr =       1.141939023373
              std dev =       0.563948464981
             le_variance =       0.318037871155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318039840905
                                         uncertainty =       0.003640825557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318039840905
                                         uncertainty =       0.003640825557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398742024
  error estimate for blocks of size 2^( 2) =       0.000407881298
  error estimate for blocks of size 2^( 3) =       0.000416220165
  error estimate for blocks of size 2^( 4) =       0.000422706021
  error estimate for blocks of size 2^( 5) =       0.000425662306
  error estimate for blocks of size 2^( 6) =       0.000427771813
  error estimate for blocks of size 2^( 7) =       0.000428292161

      target function =                  N/A
              le_mean =     -17.216729219875
             les_mean =     296.733755275471
             stat err =       0.000426108075
             autocorr =       1.141972144515
              std dev =       0.563906378725
             le_variance =       0.317990403967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216729166008        initial
     9.5367e-01     9.5367e+00             1.4108e-04       -17.216729741491  <--
     3.8147e+00     3.8147e+01             3.7173e-05       -17.216729567593
     1.5259e+01     1.5259e+02             9.4328e-06       -17.216729219875

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.9555e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.928271e-01 1 1  ON 0
 uu_1                 3.060728e-02 1 1  ON 1
 uu_2                -6.412380e-02 1 1  ON 2
 uu_3                -1.204997e-01 1 1  ON 3
 uu_4                -1.568831e-01 1 1  ON 4
 uu_5                -1.689381e-01 1 1  ON 5
 uu_6                -1.568415e-01 1 1  ON 6
 uu_7                -1.108211e-01 1 1  ON 7
 uu_8                -3.891051e-02 1 1  ON 8
 uu_9                 2.004387e-01 1 1  ON 9
 ud_0                 3.550343e-01 1 1  ON 10
 ud_1                 9.642672e-02 1 1  ON 11
 ud_2                -1.339920e-02 1 1  ON 12
 ud_3                -7.572405e-02 1 1  ON 13
 ud_4                -1.263100e-01 1 1  ON 14
 ud_5                -1.634456e-01 1 1  ON 15
 ud_6                -1.764405e-01 1 1  ON 16
 ud_7                -1.580651e-01 1 1  ON 17
 ud_8                -1.119623e-01 1 1  ON 18
 ud_9                 3.124207e-02 1 1  ON 19
 eO_0                -9.199167e-01 1 1  ON 20
 eO_1                -5.982387e-01 1 1  ON 21
 eO_2                -1.845757e-01 1 1  ON 22
 eO_3                 8.632471e-02 1 1  ON 23
 eO_4                 2.106573e-01 1 1  ON 24
 eO_5                 2.973039e-01 1 1  ON 25
 eO_6                 3.254138e-01 1 1  ON 26
 eO_7                 5.315215e-01 1 1  ON 27
 eO_8                 1.587141e-01 1 1  ON 28
 eO_9                 5.349786e-02 1 1  ON 29
eH1_0                -2.219863e-01 1 1  ON 30
eH1_1                -1.427768e-01 1 1  ON 31
eH1_2                -1.013096e-01 1 1  ON 32
eH1_3                -6.372967e-02 1 1  ON 33
eH1_4                -1.723539e-02 1 1  ON 34
eH1_5                -4.650047e-03 1 1  ON 35
eH1_6                 3.628597e-02 1 1  ON 36
eH1_7                 7.668578e-02 1 1  ON 37
eH1_8                 2.631950e-01 1 1  ON 38
eH1_9                 1.137660e-01 1 1  ON 39
eH2_0                -2.112135e-01 1 1  ON 40
eH2_1                -1.323629e-01 1 1  ON 41
eH2_2                -9.060136e-02 1 1  ON 42
eH2_3                -5.303313e-02 1 1  ON 43
eH2_4                -6.444903e-03 1 1  ON 44
eH2_5                 5.553783e-03 1 1  ON 45
eH2_6                 4.754139e-02 1 1  ON 46
eH2_7                 4.072794e-02 1 1  ON 47
eH2_8                 2.471003e-01 1 1  ON 48
eH2_9                 1.154369e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.370877
====================================================
  Execution time = 2.2938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312785231924
                                         uncertainty =       0.002313820505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312785231924
                                         uncertainty =       0.002313820505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395497868
  error estimate for blocks of size 2^( 2) =       0.000405046000
  error estimate for blocks of size 2^( 3) =       0.000413846002
  error estimate for blocks of size 2^( 4) =       0.000420035149
  error estimate for blocks of size 2^( 5) =       0.000423327613
  error estimate for blocks of size 2^( 6) =       0.000424670778
  error estimate for blocks of size 2^( 7) =       0.000425371792

      target function =                  N/A
              le_mean =     -17.216994549867
             les_mean =     296.737738300667
             stat err =       0.000423351333
             autocorr =       1.145812539205
              std dev =       0.559318448584
             le_variance =       0.312837126927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699454987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994549867       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216996955389       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998203056       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998696206       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998964934       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216999102810       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216999516641       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216999493878       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216999256704       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 4.375293e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994549867       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216995460526       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216996073379       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216996269027       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216996493410       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216996521758       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216996602802       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216996560824       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.315551e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994549867       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216994811121       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216995010869       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216995070165       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216995161069       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216995166519       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216995179781       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.605799e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8502e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.928409e-01 1 1  ON 0
 uu_1                 3.056316e-02 1 1  ON 1
 uu_2                -6.419875e-02 1 1  ON 2
 uu_3                -1.204698e-01 1 1  ON 3
 uu_4                -1.569049e-01 1 1  ON 4
 uu_5                -1.688811e-01 1 1  ON 5
 uu_6                -1.568131e-01 1 1  ON 6
 uu_7                -1.108168e-01 1 1  ON 7
 uu_8                -3.890061e-02 1 1  ON 8
 uu_9                 2.004144e-01 1 1  ON 9
 ud_0                 3.550883e-01 1 1  ON 10
 ud_1                 9.648651e-02 1 1  ON 11
 ud_2                -1.336004e-02 1 1  ON 12
 ud_3                -7.569949e-02 1 1  ON 13
 ud_4                -1.263206e-01 1 1  ON 14
 ud_5                -1.635219e-01 1 1  ON 15
 ud_6                -1.764928e-01 1 1  ON 16
 ud_7                -1.580806e-01 1 1  ON 17
 ud_8                -1.119707e-01 1 1  ON 18
 ud_9                 3.121523e-02 1 1  ON 19
 eO_0                -9.200273e-01 1 1  ON 20
 eO_1                -5.982357e-01 1 1  ON 21
 eO_2                -1.845610e-01 1 1  ON 22
 eO_3                 8.633383e-02 1 1  ON 23
 eO_4                 2.107844e-01 1 1  ON 24
 eO_5                 2.972959e-01 1 1  ON 25
 eO_6                 3.253875e-01 1 1  ON 26
 eO_7                 5.314940e-01 1 1  ON 27
 eO_8                 1.587278e-01 1 1  ON 28
 eO_9                 5.350197e-02 1 1  ON 29
eH1_0                -2.219578e-01 1 1  ON 30
eH1_1                -1.428852e-01 1 1  ON 31
eH1_2                -1.011886e-01 1 1  ON 32
eH1_3                -6.368261e-02 1 1  ON 33
eH1_4                -1.734341e-02 1 1  ON 34
eH1_5                -4.518491e-03 1 1  ON 35
eH1_6                 3.627976e-02 1 1  ON 36
eH1_7                 7.660267e-02 1 1  ON 37
eH1_8                 2.631691e-01 1 1  ON 38
eH1_9                 1.137672e-01 1 1  ON 39
eH2_0                -2.112135e-01 1 1  ON 40
eH2_1                -1.322878e-01 1 1  ON 41
eH2_2                -9.065310e-02 1 1  ON 42
eH2_3                -5.304115e-02 1 1  ON 43
eH2_4                -6.531679e-03 1 1  ON 44
eH2_5                 5.577634e-03 1 1  ON 45
eH2_6                 4.754475e-02 1 1  ON 46
eH2_7                 4.077411e-02 1 1  ON 47
eH2_8                 2.470828e-01 1 1  ON 48
eH2_9                 1.154466e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2616
    reference variance = 0.372672
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1381e-01
  Total weights = 2.0000e+06
  Execution time = 1.8812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313856416374
                                         uncertainty =       0.002701445622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313856416374
                                         uncertainty =       0.002701445622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396099253
  error estimate for blocks of size 2^( 2) =       0.000405270328
  error estimate for blocks of size 2^( 3) =       0.000413541477
  error estimate for blocks of size 2^( 4) =       0.000419163688
  error estimate for blocks of size 2^( 5) =       0.000424084128
  error estimate for blocks of size 2^( 6) =       0.000424352469
  error estimate for blocks of size 2^( 7) =       0.000425396359

      target function =                  N/A
              le_mean =     -17.216938672942
             les_mean =     296.736766348151
             stat err =       0.000423249161
             autocorr =       1.141784555198
              std dev =       0.560168936319
             le_variance =       0.313789237217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313921647378
                                         uncertainty =       0.002701097125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313921647378
                                         uncertainty =       0.002701097125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396140451
  error estimate for blocks of size 2^( 2) =       0.000405310406
  error estimate for blocks of size 2^( 3) =       0.000413580488
  error estimate for blocks of size 2^( 4) =       0.000419200914
  error estimate for blocks of size 2^( 5) =       0.000424118342
  error estimate for blocks of size 2^( 6) =       0.000424390636
  error estimate for blocks of size 2^( 7) =       0.000425444635

      target function =                  N/A
              le_mean =     -17.216936423202
             les_mean =     296.736754157895
             stat err =       0.000423288632
             autocorr =       1.141760005397
              std dev =       0.560227198763
             le_variance =       0.313854514234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313897518139
                                         uncertainty =       0.002701013773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313897518139
                                         uncertainty =       0.002701013773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396125224
  error estimate for blocks of size 2^( 2) =       0.000405295420
  error estimate for blocks of size 2^( 3) =       0.000413566304
  error estimate for blocks of size 2^( 4) =       0.000419188074
  error estimate for blocks of size 2^( 5) =       0.000424106995
  error estimate for blocks of size 2^( 6) =       0.000424379299
  error estimate for blocks of size 2^( 7) =       0.000425431636

      target function =                  N/A
              le_mean =     -17.216936988933
             les_mean =     296.736749510033
             stat err =       0.000423276501
             autocorr =       1.141782339257
              std dev =       0.560205664080
             le_variance =       0.313830386067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313861245086
                                         uncertainty =       0.002701366010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313861245086
                                         uncertainty =       0.002701366010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396102306
  error estimate for blocks of size 2^( 2) =       0.000405273235
  error estimate for blocks of size 2^( 3) =       0.000413544377
  error estimate for blocks of size 2^( 4) =       0.000419166608
  error estimate for blocks of size 2^( 5) =       0.000424086909
  error estimate for blocks of size 2^( 6) =       0.000424355912
  error estimate for blocks of size 2^( 7) =       0.000425401100

      target function =                  N/A
              le_mean =     -17.216938412042
             les_mean =     296.736762201034
             stat err =       0.000423252632
             autocorr =       1.141785685165
              std dev =       0.560173253441
             le_variance =       0.313794073870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938672942        initial  <--
     2.3842e-01     2.3842e+00             4.3753e-04       -17.216936423202
     9.5367e-01     9.5367e+00             1.3156e-04       -17.216936988933
     3.8147e+00     3.8147e+01             3.6058e-05       -17.216938412042

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5123
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.928271e-01 1 1  ON 0
 uu_1                 3.060728e-02 1 1  ON 1
 uu_2                -6.412380e-02 1 1  ON 2
 uu_3                -1.204997e-01 1 1  ON 3
 uu_4                -1.568831e-01 1 1  ON 4
 uu_5                -1.689381e-01 1 1  ON 5
 uu_6                -1.568415e-01 1 1  ON 6
 uu_7                -1.108211e-01 1 1  ON 7
 uu_8                -3.891051e-02 1 1  ON 8
 uu_9                 2.004387e-01 1 1  ON 9
 ud_0                 3.550343e-01 1 1  ON 10
 ud_1                 9.642672e-02 1 1  ON 11
 ud_2                -1.339920e-02 1 1  ON 12
 ud_3                -7.572405e-02 1 1  ON 13
 ud_4                -1.263100e-01 1 1  ON 14
 ud_5                -1.634456e-01 1 1  ON 15
 ud_6                -1.764405e-01 1 1  ON 16
 ud_7                -1.580651e-01 1 1  ON 17
 ud_8                -1.119623e-01 1 1  ON 18
 ud_9                 3.124207e-02 1 1  ON 19
 eO_0                -9.199167e-01 1 1  ON 20
 eO_1                -5.982387e-01 1 1  ON 21
 eO_2                -1.845757e-01 1 1  ON 22
 eO_3                 8.632471e-02 1 1  ON 23
 eO_4                 2.106573e-01 1 1  ON 24
 eO_5                 2.973039e-01 1 1  ON 25
 eO_6                 3.254138e-01 1 1  ON 26
 eO_7                 5.315215e-01 1 1  ON 27
 eO_8                 1.587141e-01 1 1  ON 28
 eO_9                 5.349786e-02 1 1  ON 29
eH1_0                -2.219863e-01 1 1  ON 30
eH1_1                -1.427768e-01 1 1  ON 31
eH1_2                -1.013096e-01 1 1  ON 32
eH1_3                -6.372967e-02 1 1  ON 33
eH1_4                -1.723539e-02 1 1  ON 34
eH1_5                -4.650047e-03 1 1  ON 35
eH1_6                 3.628597e-02 1 1  ON 36
eH1_7                 7.668578e-02 1 1  ON 37
eH1_8                 2.631950e-01 1 1  ON 38
eH1_9                 1.137660e-01 1 1  ON 39
eH2_0                -2.112135e-01 1 1  ON 40
eH2_1                -1.323629e-01 1 1  ON 41
eH2_2                -9.060136e-02 1 1  ON 42
eH2_3                -5.303313e-02 1 1  ON 43
eH2_4                -6.444903e-03 1 1  ON 44
eH2_5                 5.553783e-03 1 1  ON 45
eH2_6                 4.754139e-02 1 1  ON 46
eH2_7                 4.072794e-02 1 1  ON 47
eH2_8                 2.471003e-01 1 1  ON 48
eH2_9                 1.154369e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2846
    reference variance = 0.266343
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315411130950
                                         uncertainty =       0.002708744367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315411130950
                                         uncertainty =       0.002708744367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397100748
  error estimate for blocks of size 2^( 2) =       0.000406112278
  error estimate for blocks of size 2^( 3) =       0.000414901830
  error estimate for blocks of size 2^( 4) =       0.000421566220
  error estimate for blocks of size 2^( 5) =       0.000426468703
  error estimate for blocks of size 2^( 6) =       0.000427740922
  error estimate for blocks of size 2^( 7) =       0.000429200001

      target function =                  N/A
              le_mean =     -17.217276512341
             les_mean =     296.749988352838
             stat err =       0.000426243962
             autocorr =       1.152166036541
              std dev =       0.561585263436
             le_variance =       0.315378008109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721727651234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217276512341       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217276608533       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276625982       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217276490277       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217276509508       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217276516732       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217276484949       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 5.523344e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217276512341       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217276537755       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276543273       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217276505647       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217276514026       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217276515640       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217276506183       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.406223e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217276512341       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217276518786       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217276520247       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217276510586       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217276512927       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217276513354       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217276510876       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.531850e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075124 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.928326e-01 1 1  ON 0
 uu_1                 3.059620e-02 1 1  ON 1
 uu_2                -6.412321e-02 1 1  ON 2
 uu_3                -1.204969e-01 1 1  ON 3
 uu_4                -1.568871e-01 1 1  ON 4
 uu_5                -1.689382e-01 1 1  ON 5
 uu_6                -1.568425e-01 1 1  ON 6
 uu_7                -1.108232e-01 1 1  ON 7
 uu_8                -3.890725e-02 1 1  ON 8
 uu_9                 2.004385e-01 1 1  ON 9
 ud_0                 3.550371e-01 1 1  ON 10
 ud_1                 9.643109e-02 1 1  ON 11
 ud_2                -1.339530e-02 1 1  ON 12
 ud_3                -7.572029e-02 1 1  ON 13
 ud_4                -1.263229e-01 1 1  ON 14
 ud_5                -1.634489e-01 1 1  ON 15
 ud_6                -1.764452e-01 1 1  ON 16
 ud_7                -1.580648e-01 1 1  ON 17
 ud_8                -1.119624e-01 1 1  ON 18
 ud_9                 3.124189e-02 1 1  ON 19
 eO_0                -9.199139e-01 1 1  ON 20
 eO_1                -5.982520e-01 1 1  ON 21
 eO_2                -1.845812e-01 1 1  ON 22
 eO_3                 8.633332e-02 1 1  ON 23
 eO_4                 2.106631e-01 1 1  ON 24
 eO_5                 2.973064e-01 1 1  ON 25
 eO_6                 3.254119e-01 1 1  ON 26
 eO_7                 5.315174e-01 1 1  ON 27
 eO_8                 1.587168e-01 1 1  ON 28
 eO_9                 5.349906e-02 1 1  ON 29
eH1_0                -2.219765e-01 1 1  ON 30
eH1_1                -1.427814e-01 1 1  ON 31
eH1_2                -1.013061e-01 1 1  ON 32
eH1_3                -6.373282e-02 1 1  ON 33
eH1_4                -1.723654e-02 1 1  ON 34
eH1_5                -4.645023e-03 1 1  ON 35
eH1_6                 3.628441e-02 1 1  ON 36
eH1_7                 7.667802e-02 1 1  ON 37
eH1_8                 2.631926e-01 1 1  ON 38
eH1_9                 1.137671e-01 1 1  ON 39
eH2_0                -2.112168e-01 1 1  ON 40
eH2_1                -1.323577e-01 1 1  ON 41
eH2_2                -9.059877e-02 1 1  ON 42
eH2_3                -5.302915e-02 1 1  ON 43
eH2_4                -6.441123e-03 1 1  ON 44
eH2_5                 5.539721e-03 1 1  ON 45
eH2_6                 4.753977e-02 1 1  ON 46
eH2_7                 4.073230e-02 1 1  ON 47
eH2_8                 2.470973e-01 1 1  ON 48
eH2_9                 1.154377e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.3573
    reference variance = 1.4669
====================================================
  Execution time = 2.0071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1982e-01
  Total weights = 2.0000e+06
  Execution time = 1.8903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319734206653
                                         uncertainty =       0.003547860869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319734206653
                                         uncertainty =       0.003547860869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399891164
  error estimate for blocks of size 2^( 2) =       0.000409110809
  error estimate for blocks of size 2^( 3) =       0.000417858174
  error estimate for blocks of size 2^( 4) =       0.000424541786
  error estimate for blocks of size 2^( 5) =       0.000428575968
  error estimate for blocks of size 2^( 6) =       0.000430793429
  error estimate for blocks of size 2^( 7) =       0.000431655735

      target function =                  N/A
              le_mean =     -17.216692191114
             les_mean =     296.734315730084
             stat err =       0.000428891730
             autocorr =       1.150301607451
              std dev =       0.565531507911
             le_variance =       0.319825886440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319722954454
                                         uncertainty =       0.003547683116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319722954454
                                         uncertainty =       0.003547683116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399884125
  error estimate for blocks of size 2^( 2) =       0.000409104365
  error estimate for blocks of size 2^( 3) =       0.000417851980
  error estimate for blocks of size 2^( 4) =       0.000424535992
  error estimate for blocks of size 2^( 5) =       0.000428569765
  error estimate for blocks of size 2^( 6) =       0.000430786722
  error estimate for blocks of size 2^( 7) =       0.000431648896

      target function =                  N/A
              le_mean =     -17.216692672608
             les_mean =     296.734321050335
             stat err =       0.000428885344
             autocorr =       1.150307850124
              std dev =       0.565521553254
             le_variance =       0.319814627194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319727837004
                                         uncertainty =       0.003547762335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319727837004
                                         uncertainty =       0.003547762335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399887180
  error estimate for blocks of size 2^( 2) =       0.000409107153
  error estimate for blocks of size 2^( 3) =       0.000417854666
  error estimate for blocks of size 2^( 4) =       0.000424538521
  error estimate for blocks of size 2^( 5) =       0.000428572496
  error estimate for blocks of size 2^( 6) =       0.000430789671
  error estimate for blocks of size 2^( 7) =       0.000431651884

      target function =                  N/A
              le_mean =     -17.216692461659
             les_mean =     296.734318672561
             stat err =       0.000428888143
             autocorr =       1.150305291615
              std dev =       0.565525873078
             le_variance =       0.319819513121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319733384957
                                         uncertainty =       0.003547848233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319733384957
                                         uncertainty =       0.003547848233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399890650
  error estimate for blocks of size 2^( 2) =       0.000409110337
  error estimate for blocks of size 2^( 3) =       0.000417857721
  error estimate for blocks of size 2^( 4) =       0.000424541365
  error estimate for blocks of size 2^( 5) =       0.000428575521
  error estimate for blocks of size 2^( 6) =       0.000430792945
  error estimate for blocks of size 2^( 7) =       0.000431655239

      target function =                  N/A
              le_mean =     -17.216692225766
             les_mean =     296.734316101136
             stat err =       0.000428891267
             autocorr =       1.150302085167
              std dev =       0.565530781020
             le_variance =       0.319825064281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216692191114        initial
     2.3842e+00     2.3842e+01             5.5233e-05       -17.216692672608  <--
     9.5367e+00     9.5367e+01             1.4062e-05       -17.216692461659
     3.8147e+01     3.8147e+02             3.5319e-06       -17.216692225766

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9677e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.928454e-01 1 1  ON 0
 uu_1                 3.056791e-02 1 1  ON 1
 uu_2                -6.412202e-02 1 1  ON 2
 uu_3                -1.204901e-01 1 1  ON 3
 uu_4                -1.568970e-01 1 1  ON 4
 uu_5                -1.689389e-01 1 1  ON 5
 uu_6                -1.568457e-01 1 1  ON 6
 uu_7                -1.108294e-01 1 1  ON 7
 uu_8                -3.889782e-02 1 1  ON 8
 uu_9                 2.004380e-01 1 1  ON 9
 ud_0                 3.550455e-01 1 1  ON 10
 ud_1                 9.644351e-02 1 1  ON 11
 ud_2                -1.338405e-02 1 1  ON 12
 ud_3                -7.571095e-02 1 1  ON 13
 ud_4                -1.263565e-01 1 1  ON 14
 ud_5                -1.634602e-01 1 1  ON 15
 ud_6                -1.764592e-01 1 1  ON 16
 ud_7                -1.580642e-01 1 1  ON 17
 ud_8                -1.119626e-01 1 1  ON 18
 ud_9                 3.124137e-02 1 1  ON 19
 eO_0                -9.199086e-01 1 1  ON 20
 eO_1                -5.982885e-01 1 1  ON 21
 eO_2                -1.845960e-01 1 1  ON 22
 eO_3                 8.635905e-02 1 1  ON 23
 eO_4                 2.106794e-01 1 1  ON 24
 eO_5                 2.973131e-01 1 1  ON 25
 eO_6                 3.254066e-01 1 1  ON 26
 eO_7                 5.315056e-01 1 1  ON 27
 eO_8                 1.587248e-01 1 1  ON 28
 eO_9                 5.350251e-02 1 1  ON 29
eH1_0                -2.219484e-01 1 1  ON 30
eH1_1                -1.427938e-01 1 1  ON 31
eH1_2                -1.012976e-01 1 1  ON 32
eH1_3                -6.374034e-02 1 1  ON 33
eH1_4                -1.724043e-02 1 1  ON 34
eH1_5                -4.630515e-03 1 1  ON 35
eH1_6                 3.627988e-02 1 1  ON 36
eH1_7                 7.665547e-02 1 1  ON 37
eH1_8                 2.631856e-01 1 1  ON 38
eH1_9                 1.137701e-01 1 1  ON 39
eH2_0                -2.112257e-01 1 1  ON 40
eH2_1                -1.323424e-01 1 1  ON 41
eH2_2                -9.059140e-02 1 1  ON 42
eH2_3                -5.301712e-02 1 1  ON 43
eH2_4                -6.430579e-03 1 1  ON 44
eH2_5                 5.498550e-03 1 1  ON 45
eH2_6                 4.753472e-02 1 1  ON 46
eH2_7                 4.074492e-02 1 1  ON 47
eH2_8                 2.470886e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2569
    reference variance = 0.436772
====================================================
  Execution time = 2.0393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324352647155
                                         uncertainty =       0.006953697511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324352647155
                                         uncertainty =       0.006953697511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402688338
  error estimate for blocks of size 2^( 2) =       0.000412398247
  error estimate for blocks of size 2^( 3) =       0.000420606730
  error estimate for blocks of size 2^( 4) =       0.000426285461
  error estimate for blocks of size 2^( 5) =       0.000429184104
  error estimate for blocks of size 2^( 6) =       0.000430819014
  error estimate for blocks of size 2^( 7) =       0.000430503175

      target function =                  N/A
              le_mean =     -17.216720552654
             les_mean =     296.739782221414
             stat err =       0.000429197938
             autocorr =       1.135996907403
              std dev =       0.569487309248
             le_variance =       0.324315795395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672055265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720552654       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720957478       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721277041       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721411225       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216721702435       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721740710       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721900221       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216721943554       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.191292e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720552654       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720670168       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720772426       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720811446       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720907529       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216720934912       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216720975629       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 6.558718e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720552654       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720583265       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720610787       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720621022       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720646538       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216720656258       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216720665944       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.704892e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5895e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.928276e-01 1 1  ON 0
 uu_1                 3.053157e-02 1 1  ON 1
 uu_2                -6.412462e-02 1 1  ON 2
 uu_3                -1.205166e-01 1 1  ON 3
 uu_4                -1.568755e-01 1 1  ON 4
 uu_5                -1.689624e-01 1 1  ON 5
 uu_6                -1.567917e-01 1 1  ON 6
 uu_7                -1.108118e-01 1 1  ON 7
 uu_8                -3.889038e-02 1 1  ON 8
 uu_9                 2.004276e-01 1 1  ON 9
 ud_0                 3.550465e-01 1 1  ON 10
 ud_1                 9.643033e-02 1 1  ON 11
 ud_2                -1.337648e-02 1 1  ON 12
 ud_3                -7.572973e-02 1 1  ON 13
 ud_4                -1.263757e-01 1 1  ON 14
 ud_5                -1.635016e-01 1 1  ON 15
 ud_6                -1.764244e-01 1 1  ON 16
 ud_7                -1.580269e-01 1 1  ON 17
 ud_8                -1.119572e-01 1 1  ON 18
 ud_9                 3.123585e-02 1 1  ON 19
 eO_0                -9.199348e-01 1 1  ON 20
 eO_1                -5.983279e-01 1 1  ON 21
 eO_2                -1.846077e-01 1 1  ON 22
 eO_3                 8.637597e-02 1 1  ON 23
 eO_4                 2.107075e-01 1 1  ON 24
 eO_5                 2.973337e-01 1 1  ON 25
 eO_6                 3.254170e-01 1 1  ON 26
 eO_7                 5.314956e-01 1 1  ON 27
 eO_8                 1.587322e-01 1 1  ON 28
 eO_9                 5.350474e-02 1 1  ON 29
eH1_0                -2.219443e-01 1 1  ON 30
eH1_1                -1.428013e-01 1 1  ON 31
eH1_2                -1.013055e-01 1 1  ON 32
eH1_3                -6.376807e-02 1 1  ON 33
eH1_4                -1.723307e-02 1 1  ON 34
eH1_5                -4.596823e-03 1 1  ON 35
eH1_6                 3.629194e-02 1 1  ON 36
eH1_7                 7.664214e-02 1 1  ON 37
eH1_8                 2.631775e-01 1 1  ON 38
eH1_9                 1.137729e-01 1 1  ON 39
eH2_0                -2.112332e-01 1 1  ON 40
eH2_1                -1.322768e-01 1 1  ON 41
eH2_2                -9.055985e-02 1 1  ON 42
eH2_3                -5.305585e-02 1 1  ON 43
eH2_4                -6.485758e-03 1 1  ON 44
eH2_5                 5.468629e-03 1 1  ON 45
eH2_6                 4.754744e-02 1 1  ON 46
eH2_7                 4.077333e-02 1 1  ON 47
eH2_8                 2.470802e-01 1 1  ON 48
eH2_9                 1.154403e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1777
    reference variance = 0.288908
====================================================
  Execution time = 2.0009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2990e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322111330100
                                         uncertainty =       0.004161021676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322111330100
                                         uncertainty =       0.004161021676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406144835
  error estimate for blocks of size 2^( 2) =       0.000415160858
  error estimate for blocks of size 2^( 3) =       0.000423850330
  error estimate for blocks of size 2^( 4) =       0.000430061441
  error estimate for blocks of size 2^( 5) =       0.000432475202
  error estimate for blocks of size 2^( 6) =       0.000433598173
  error estimate for blocks of size 2^( 7) =       0.000435777842

      target function =                  N/A
              le_mean =     -17.216602135902
             les_mean =     296.741296195132
             stat err =       0.000432978164
             autocorr =       1.136501780699
              std dev =       0.574375534062
             le_variance =       0.329907254129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088071073
                                         uncertainty =       0.004159691230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088071073
                                         uncertainty =       0.004159691230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406128104
  error estimate for blocks of size 2^( 2) =       0.000415146379
  error estimate for blocks of size 2^( 3) =       0.000423838021
  error estimate for blocks of size 2^( 4) =       0.000430050018
  error estimate for blocks of size 2^( 5) =       0.000432463074
  error estimate for blocks of size 2^( 6) =       0.000433586024
  error estimate for blocks of size 2^( 7) =       0.000435764082

      target function =                  N/A
              le_mean =     -17.216601951779
             les_mean =     296.741262674185
             stat err =       0.000432965800
             autocorr =       1.136530508547
              std dev =       0.574351872226
             le_variance =       0.329880073129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322092361237
                                         uncertainty =       0.004160115211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322092361237
                                         uncertainty =       0.004160115211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406131527
  error estimate for blocks of size 2^( 2) =       0.000415149163
  error estimate for blocks of size 2^( 3) =       0.000423840165
  error estimate for blocks of size 2^( 4) =       0.000430051858
  error estimate for blocks of size 2^( 5) =       0.000432465329
  error estimate for blocks of size 2^( 6) =       0.000433589002
  error estimate for blocks of size 2^( 7) =       0.000435767510

      target function =                  N/A
              le_mean =     -17.216602075087
             les_mean =     296.741272481020
             stat err =       0.000432968425
             autocorr =       1.136525131261
              std dev =       0.574356713264
             le_variance =       0.329885634072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322108635559
                                         uncertainty =       0.004160896004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322108635559
                                         uncertainty =       0.004160896004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406142947
  error estimate for blocks of size 2^( 2) =       0.000415159191
  error estimate for blocks of size 2^( 3) =       0.000423848874
  error estimate for blocks of size 2^( 4) =       0.000430060064
  error estimate for blocks of size 2^( 5) =       0.000432473798
  error estimate for blocks of size 2^( 6) =       0.000433596892
  error estimate for blocks of size 2^( 7) =       0.000435776388

      target function =                  N/A
              le_mean =     -17.216602124812
             les_mean =     296.741292745257
             stat err =       0.000432976785
             autocorr =       1.136505109654
              std dev =       0.574372863336
             le_variance =       0.329904186137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216602135902        initial  <--
     5.9605e-01     5.9605e+00             2.1913e-04       -17.216601951779
     2.3842e+00     2.3842e+01             6.5587e-05       -17.216602075087
     9.5367e+00     9.5367e+01             1.7049e-05       -17.216602124812

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5030
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.928454e-01 1 1  ON 0
 uu_1                 3.056791e-02 1 1  ON 1
 uu_2                -6.412202e-02 1 1  ON 2
 uu_3                -1.204901e-01 1 1  ON 3
 uu_4                -1.568970e-01 1 1  ON 4
 uu_5                -1.689389e-01 1 1  ON 5
 uu_6                -1.568457e-01 1 1  ON 6
 uu_7                -1.108294e-01 1 1  ON 7
 uu_8                -3.889782e-02 1 1  ON 8
 uu_9                 2.004380e-01 1 1  ON 9
 ud_0                 3.550455e-01 1 1  ON 10
 ud_1                 9.644351e-02 1 1  ON 11
 ud_2                -1.338405e-02 1 1  ON 12
 ud_3                -7.571095e-02 1 1  ON 13
 ud_4                -1.263565e-01 1 1  ON 14
 ud_5                -1.634602e-01 1 1  ON 15
 ud_6                -1.764592e-01 1 1  ON 16
 ud_7                -1.580642e-01 1 1  ON 17
 ud_8                -1.119626e-01 1 1  ON 18
 ud_9                 3.124137e-02 1 1  ON 19
 eO_0                -9.199086e-01 1 1  ON 20
 eO_1                -5.982885e-01 1 1  ON 21
 eO_2                -1.845960e-01 1 1  ON 22
 eO_3                 8.635905e-02 1 1  ON 23
 eO_4                 2.106794e-01 1 1  ON 24
 eO_5                 2.973131e-01 1 1  ON 25
 eO_6                 3.254066e-01 1 1  ON 26
 eO_7                 5.315056e-01 1 1  ON 27
 eO_8                 1.587248e-01 1 1  ON 28
 eO_9                 5.350251e-02 1 1  ON 29
eH1_0                -2.219484e-01 1 1  ON 30
eH1_1                -1.427938e-01 1 1  ON 31
eH1_2                -1.012976e-01 1 1  ON 32
eH1_3                -6.374034e-02 1 1  ON 33
eH1_4                -1.724043e-02 1 1  ON 34
eH1_5                -4.630515e-03 1 1  ON 35
eH1_6                 3.627988e-02 1 1  ON 36
eH1_7                 7.665547e-02 1 1  ON 37
eH1_8                 2.631856e-01 1 1  ON 38
eH1_9                 1.137701e-01 1 1  ON 39
eH2_0                -2.112257e-01 1 1  ON 40
eH2_1                -1.323424e-01 1 1  ON 41
eH2_2                -9.059140e-02 1 1  ON 42
eH2_3                -5.301712e-02 1 1  ON 43
eH2_4                -6.430579e-03 1 1  ON 44
eH2_5                 5.498550e-03 1 1  ON 45
eH2_6                 4.753472e-02 1 1  ON 46
eH2_7                 4.074492e-02 1 1  ON 47
eH2_8                 2.470886e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5404e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.3024
    reference variance = 0.429171
====================================================
  Execution time = 2.0490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1738e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317519038672
                                         uncertainty =       0.003279525083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317519038672
                                         uncertainty =       0.003279525083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398357360
  error estimate for blocks of size 2^( 2) =       0.000407926397
  error estimate for blocks of size 2^( 3) =       0.000416397583
  error estimate for blocks of size 2^( 4) =       0.000422540379
  error estimate for blocks of size 2^( 5) =       0.000426352722
  error estimate for blocks of size 2^( 6) =       0.000428319110
  error estimate for blocks of size 2^( 7) =       0.000429738339

      target function =                  N/A
              le_mean =     -17.217734193003
             les_mean =     296.767747754594
             stat err =       0.000426737638
             autocorr =       1.147562126327
              std dev =       0.563362381051
             le_variance =       0.317377172384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721773419300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217734193003       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217734297567       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217734286804       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217734288428       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217734264281       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217734289358       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217734296663       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.999509e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217734193003       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217734220313       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217734217814       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217734218346       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217734212515       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217734218824       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217734220643       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.624232e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217734193003       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217734199908       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217734199297       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217734199438       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217734197998       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217734199576       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217734200029       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.914232e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6101e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.928427e-01 1 1  ON 0
 uu_1                 3.056948e-02 1 1  ON 1
 uu_2                -6.412329e-02 1 1  ON 2
 uu_3                -1.204893e-01 1 1  ON 3
 uu_4                -1.568955e-01 1 1  ON 4
 uu_5                -1.689377e-01 1 1  ON 5
 uu_6                -1.568427e-01 1 1  ON 6
 uu_7                -1.108321e-01 1 1  ON 7
 uu_8                -3.889882e-02 1 1  ON 8
 uu_9                 2.004368e-01 1 1  ON 9
 ud_0                 3.550414e-01 1 1  ON 10
 ud_1                 9.644556e-02 1 1  ON 11
 ud_2                -1.338305e-02 1 1  ON 12
 ud_3                -7.571038e-02 1 1  ON 13
 ud_4                -1.263585e-01 1 1  ON 14
 ud_5                -1.634579e-01 1 1  ON 15
 ud_6                -1.764577e-01 1 1  ON 16
 ud_7                -1.580643e-01 1 1  ON 17
 ud_8                -1.119634e-01 1 1  ON 18
 ud_9                 3.123994e-02 1 1  ON 19
 eO_0                -9.199140e-01 1 1  ON 20
 eO_1                -5.982895e-01 1 1  ON 21
 eO_2                -1.845938e-01 1 1  ON 22
 eO_3                 8.635858e-02 1 1  ON 23
 eO_4                 2.106833e-01 1 1  ON 24
 eO_5                 2.973147e-01 1 1  ON 25
 eO_6                 3.254065e-01 1 1  ON 26
 eO_7                 5.315038e-01 1 1  ON 27
 eO_8                 1.587253e-01 1 1  ON 28
 eO_9                 5.350274e-02 1 1  ON 29
eH1_0                -2.219456e-01 1 1  ON 30
eH1_1                -1.427916e-01 1 1  ON 31
eH1_2                -1.012975e-01 1 1  ON 32
eH1_3                -6.373919e-02 1 1  ON 33
eH1_4                -1.724805e-02 1 1  ON 34
eH1_5                -4.627614e-03 1 1  ON 35
eH1_6                 3.628102e-02 1 1  ON 36
eH1_7                 7.665321e-02 1 1  ON 37
eH1_8                 2.631845e-01 1 1  ON 38
eH1_9                 1.137704e-01 1 1  ON 39
eH2_0                -2.112251e-01 1 1  ON 40
eH2_1                -1.323390e-01 1 1  ON 41
eH2_2                -9.059270e-02 1 1  ON 42
eH2_3                -5.301793e-02 1 1  ON 43
eH2_4                -6.431848e-03 1 1  ON 44
eH2_5                 5.495841e-03 1 1  ON 45
eH2_6                 4.753507e-02 1 1  ON 46
eH2_7                 4.074713e-02 1 1  ON 47
eH2_8                 2.470879e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.320083
====================================================
  Execution time = 2.0012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1790e-01
  Total weights = 2.0000e+06
  Execution time = 1.8756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001719468
                                         uncertainty =       0.004245956083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318001719468
                                         uncertainty =       0.004245956083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398688510
  error estimate for blocks of size 2^( 2) =       0.000408079220
  error estimate for blocks of size 2^( 3) =       0.000416952988
  error estimate for blocks of size 2^( 4) =       0.000423078213
  error estimate for blocks of size 2^( 5) =       0.000426767070
  error estimate for blocks of size 2^( 6) =       0.000427556608
  error estimate for blocks of size 2^( 7) =       0.000429426101

      target function =                  N/A
              le_mean =     -17.216475608966
             les_mean =     296.724937291520
             stat err =       0.000426706998
             autocorr =       1.145492080344
              std dev =       0.563830698296
             le_variance =       0.317905056341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317988431464
                                         uncertainty =       0.004245930052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317988431464
                                         uncertainty =       0.004245930052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398680176
  error estimate for blocks of size 2^( 2) =       0.000408071327
  error estimate for blocks of size 2^( 3) =       0.000416945379
  error estimate for blocks of size 2^( 4) =       0.000423070611
  error estimate for blocks of size 2^( 5) =       0.000426759766
  error estimate for blocks of size 2^( 6) =       0.000427549421
  error estimate for blocks of size 2^( 7) =       0.000429418794

      target function =                  N/A
              le_mean =     -17.216475645551
             les_mean =     296.724925260559
             stat err =       0.000426699648
             autocorr =       1.145500508998
              std dev =       0.563818912109
             le_variance =       0.317891765651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317994659836
                                         uncertainty =       0.004245941404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317994659836
                                         uncertainty =       0.004245941404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398684083
  error estimate for blocks of size 2^( 2) =       0.000408075026
  error estimate for blocks of size 2^( 3) =       0.000416948943
  error estimate for blocks of size 2^( 4) =       0.000423074171
  error estimate for blocks of size 2^( 5) =       0.000426763187
  error estimate for blocks of size 2^( 6) =       0.000427552793
  error estimate for blocks of size 2^( 7) =       0.000429422219

      target function =                  N/A
              le_mean =     -17.216475627256
             les_mean =     296.724930860318
             stat err =       0.000426703092
             autocorr =       1.145496553349
              std dev =       0.563824436658
             le_variance =       0.317897995373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000822755
                                         uncertainty =       0.004245954193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318000822755
                                         uncertainty =       0.004245954193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398687948
  error estimate for blocks of size 2^( 2) =       0.000408078687
  error estimate for blocks of size 2^( 3) =       0.000416952474
  error estimate for blocks of size 2^( 4) =       0.000423077699
  error estimate for blocks of size 2^( 5) =       0.000426766577
  error estimate for blocks of size 2^( 6) =       0.000427556123
  error estimate for blocks of size 2^( 7) =       0.000429425608

      target function =                  N/A
              le_mean =     -17.216475611212
             les_mean =     296.724936471954
             stat err =       0.000426706502
             autocorr =       1.145492648040
              std dev =       0.563829902951
             le_variance =       0.317904159461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216475608966        initial
     5.9605e+00     5.9605e+01             2.9995e-05       -17.216475645551  <--
     2.3842e+01     2.3842e+02             7.6242e-06       -17.216475627256
     9.5367e+01     9.5367e+02             1.9142e-06       -17.216475611212

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.9470e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.928350e-01 1 1  ON 0
 uu_1                 3.057383e-02 1 1  ON 1
 uu_2                -6.412679e-02 1 1  ON 2
 uu_3                -1.204870e-01 1 1  ON 3
 uu_4                -1.568913e-01 1 1  ON 4
 uu_5                -1.689341e-01 1 1  ON 5
 uu_6                -1.568342e-01 1 1  ON 6
 uu_7                -1.108400e-01 1 1  ON 7
 uu_8                -3.890179e-02 1 1  ON 8
 uu_9                 2.004330e-01 1 1  ON 9
 ud_0                 3.550302e-01 1 1  ON 10
 ud_1                 9.645126e-02 1 1  ON 11
 ud_2                -1.338025e-02 1 1  ON 12
 ud_3                -7.570882e-02 1 1  ON 13
 ud_4                -1.263640e-01 1 1  ON 14
 ud_5                -1.634514e-01 1 1  ON 15
 ud_6                -1.764533e-01 1 1  ON 16
 ud_7                -1.580644e-01 1 1  ON 17
 ud_8                -1.119658e-01 1 1  ON 18
 ud_9                 3.123572e-02 1 1  ON 19
 eO_0                -9.199295e-01 1 1  ON 20
 eO_1                -5.982927e-01 1 1  ON 21
 eO_2                -1.845873e-01 1 1  ON 22
 eO_3                 8.635726e-02 1 1  ON 23
 eO_4                 2.106947e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254064e-01 1 1  ON 26
 eO_7                 5.314985e-01 1 1  ON 27
 eO_8                 1.587271e-01 1 1  ON 28
 eO_9                 5.350341e-02 1 1  ON 29
eH1_0                -2.219373e-01 1 1  ON 30
eH1_1                -1.427849e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373598e-02 1 1  ON 33
eH1_4                -1.727042e-02 1 1  ON 34
eH1_5                -4.619242e-03 1 1  ON 35
eH1_6                 3.628437e-02 1 1  ON 36
eH1_7                 7.664656e-02 1 1  ON 37
eH1_8                 2.631815e-01 1 1  ON 38
eH1_9                 1.137713e-01 1 1  ON 39
eH2_0                -2.112235e-01 1 1  ON 40
eH2_1                -1.323293e-01 1 1  ON 41
eH2_2                -9.059617e-02 1 1  ON 42
eH2_3                -5.302044e-02 1 1  ON 43
eH2_4                -6.435709e-03 1 1  ON 44
eH2_5                 5.487862e-03 1 1  ON 45
eH2_6                 4.753612e-02 1 1  ON 46
eH2_7                 4.075364e-02 1 1  ON 47
eH2_8                 2.470859e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.295
    reference variance = 0.606348
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2237e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322408373393
                                         uncertainty =       0.006096720974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322408373393
                                         uncertainty =       0.006096720974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401477809
  error estimate for blocks of size 2^( 2) =       0.000410774533
  error estimate for blocks of size 2^( 3) =       0.000419309372
  error estimate for blocks of size 2^( 4) =       0.000425515917
  error estimate for blocks of size 2^( 5) =       0.000428718569
  error estimate for blocks of size 2^( 6) =       0.000430479719
  error estimate for blocks of size 2^( 7) =       0.000429111781

      target function =                  N/A
              le_mean =     -17.217602756858
             les_mean =     296.768213394001
             stat err =       0.000428456497
             autocorr =       1.138912538119
              std dev =       0.567775362473
             le_variance =       0.322368862232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721760275686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217602756858       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217602694394       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217602940776       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217603127043       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217602871045       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217602905713       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217602913972       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 7.858629e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217602756858       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217602739749       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217602804589       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217602867866       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217602800791       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217602805462       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 1.972776e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217602756858       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217602752476       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217602768894       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217602786027       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217602769238       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217602770198       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 5.019322e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.928265e-01 1 1  ON 0
 uu_1                 3.056982e-02 1 1  ON 1
 uu_2                -6.412883e-02 1 1  ON 2
 uu_3                -1.204756e-01 1 1  ON 3
 uu_4                -1.568911e-01 1 1  ON 4
 uu_5                -1.689375e-01 1 1  ON 5
 uu_6                -1.568296e-01 1 1  ON 6
 uu_7                -1.108415e-01 1 1  ON 7
 uu_8                -3.890084e-02 1 1  ON 8
 uu_9                 2.004304e-01 1 1  ON 9
 ud_0                 3.550200e-01 1 1  ON 10
 ud_1                 9.645942e-02 1 1  ON 11
 ud_2                -1.338434e-02 1 1  ON 12
 ud_3                -7.570042e-02 1 1  ON 13
 ud_4                -1.263651e-01 1 1  ON 14
 ud_5                -1.634462e-01 1 1  ON 15
 ud_6                -1.764580e-01 1 1  ON 16
 ud_7                -1.580631e-01 1 1  ON 17
 ud_8                -1.119683e-01 1 1  ON 18
 ud_9                 3.123218e-02 1 1  ON 19
 eO_0                -9.199439e-01 1 1  ON 20
 eO_1                -5.982821e-01 1 1  ON 21
 eO_2                -1.845970e-01 1 1  ON 22
 eO_3                 8.635774e-02 1 1  ON 23
 eO_4                 2.107074e-01 1 1  ON 24
 eO_5                 2.973195e-01 1 1  ON 25
 eO_6                 3.254065e-01 1 1  ON 26
 eO_7                 5.314947e-01 1 1  ON 27
 eO_8                 1.587296e-01 1 1  ON 28
 eO_9                 5.350437e-02 1 1  ON 29
eH1_0                -2.219305e-01 1 1  ON 30
eH1_1                -1.428029e-01 1 1  ON 31
eH1_2                -1.013008e-01 1 1  ON 32
eH1_3                -6.373272e-02 1 1  ON 33
eH1_4                -1.728818e-02 1 1  ON 34
eH1_5                -4.599515e-03 1 1  ON 35
eH1_6                 3.629790e-02 1 1  ON 36
eH1_7                 7.664386e-02 1 1  ON 37
eH1_8                 2.631778e-01 1 1  ON 38
eH1_9                 1.137722e-01 1 1  ON 39
eH2_0                -2.112263e-01 1 1  ON 40
eH2_1                -1.323287e-01 1 1  ON 41
eH2_2                -9.058589e-02 1 1  ON 42
eH2_3                -5.300512e-02 1 1  ON 43
eH2_4                -6.439740e-03 1 1  ON 44
eH2_5                 5.477736e-03 1 1  ON 45
eH2_6                 4.752573e-02 1 1  ON 46
eH2_7                 4.075678e-02 1 1  ON 47
eH2_8                 2.470831e-01 1 1  ON 48
eH2_9                 1.154406e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1882
    reference variance = 0.372669
====================================================
  Execution time = 2.0261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1920e-01
  Total weights = 2.0000e+06
  Execution time = 1.8820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318414531875
                                         uncertainty =       0.003462603980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318414531875
                                         uncertainty =       0.003462603980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399505473
  error estimate for blocks of size 2^( 2) =       0.000408753223
  error estimate for blocks of size 2^( 3) =       0.000417402800
  error estimate for blocks of size 2^( 4) =       0.000423233604
  error estimate for blocks of size 2^( 5) =       0.000426803267
  error estimate for blocks of size 2^( 6) =       0.000429394853
  error estimate for blocks of size 2^( 7) =       0.000430052238

      target function =                  N/A
              le_mean =     -17.217094550987
             les_mean =     296.747553863583
             stat err =       0.000427370990
             autocorr =       1.144365121223
              std dev =       0.564986057832
             le_variance =       0.319209245545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318374281977
                                         uncertainty =       0.003461878016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318374281977
                                         uncertainty =       0.003461878016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399480325
  error estimate for blocks of size 2^( 2) =       0.000408728403
  error estimate for blocks of size 2^( 3) =       0.000417378748
  error estimate for blocks of size 2^( 4) =       0.000423210325
  error estimate for blocks of size 2^( 5) =       0.000426779770
  error estimate for blocks of size 2^( 6) =       0.000429370925
  error estimate for blocks of size 2^( 7) =       0.000430027397

      target function =                  N/A
              le_mean =     -17.217094327938
             les_mean =     296.747505997947
             stat err =       0.000427347104
             autocorr =       1.144381271159
              std dev =       0.564950493777
             le_variance =       0.319169060419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318390846644
                                         uncertainty =       0.003462167805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318390846644
                                         uncertainty =       0.003462167805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399490680
  error estimate for blocks of size 2^( 2) =       0.000408738582
  error estimate for blocks of size 2^( 3) =       0.000417388561
  error estimate for blocks of size 2^( 4) =       0.000423219786
  error estimate for blocks of size 2^( 5) =       0.000426789331
  error estimate for blocks of size 2^( 6) =       0.000429380696
  error estimate for blocks of size 2^( 7) =       0.000430037538

      target function =                  N/A
              le_mean =     -17.217094421933
             les_mean =     296.747525780769
             stat err =       0.000427356838
             autocorr =       1.144374076032
              std dev =       0.564965137521
             le_variance =       0.319185606614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318411462556
                                         uncertainty =       0.003462547450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318411462556
                                         uncertainty =       0.003462547450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399503556
  error estimate for blocks of size 2^( 2) =       0.000408751324
  error estimate for blocks of size 2^( 3) =       0.000417400952
  error estimate for blocks of size 2^( 4) =       0.000423231809
  error estimate for blocks of size 2^( 5) =       0.000426801456
  error estimate for blocks of size 2^( 6) =       0.000429393011
  error estimate for blocks of size 2^( 7) =       0.000430050323

      target function =                  N/A
              le_mean =     -17.217094533399
             les_mean =     296.747550194544
             stat err =       0.000427369150
             autocorr =       1.144366246027
              std dev =       0.564983346776
             le_variance =       0.319206182134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217094550987        initial  <--
     1.4901e+00     1.4901e+01             7.8586e-05       -17.217094327938
     5.9605e+00     5.9605e+01             1.9728e-05       -17.217094421933
     2.3842e+01     2.3842e+02             5.0193e-06       -17.217094533399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7689
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.928350e-01 1 1  ON 0
 uu_1                 3.057383e-02 1 1  ON 1
 uu_2                -6.412679e-02 1 1  ON 2
 uu_3                -1.204870e-01 1 1  ON 3
 uu_4                -1.568913e-01 1 1  ON 4
 uu_5                -1.689341e-01 1 1  ON 5
 uu_6                -1.568342e-01 1 1  ON 6
 uu_7                -1.108400e-01 1 1  ON 7
 uu_8                -3.890179e-02 1 1  ON 8
 uu_9                 2.004330e-01 1 1  ON 9
 ud_0                 3.550302e-01 1 1  ON 10
 ud_1                 9.645126e-02 1 1  ON 11
 ud_2                -1.338025e-02 1 1  ON 12
 ud_3                -7.570882e-02 1 1  ON 13
 ud_4                -1.263640e-01 1 1  ON 14
 ud_5                -1.634514e-01 1 1  ON 15
 ud_6                -1.764533e-01 1 1  ON 16
 ud_7                -1.580644e-01 1 1  ON 17
 ud_8                -1.119658e-01 1 1  ON 18
 ud_9                 3.123572e-02 1 1  ON 19
 eO_0                -9.199295e-01 1 1  ON 20
 eO_1                -5.982927e-01 1 1  ON 21
 eO_2                -1.845873e-01 1 1  ON 22
 eO_3                 8.635726e-02 1 1  ON 23
 eO_4                 2.106947e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254064e-01 1 1  ON 26
 eO_7                 5.314985e-01 1 1  ON 27
 eO_8                 1.587271e-01 1 1  ON 28
 eO_9                 5.350341e-02 1 1  ON 29
eH1_0                -2.219373e-01 1 1  ON 30
eH1_1                -1.427849e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373598e-02 1 1  ON 33
eH1_4                -1.727042e-02 1 1  ON 34
eH1_5                -4.619242e-03 1 1  ON 35
eH1_6                 3.628437e-02 1 1  ON 36
eH1_7                 7.664656e-02 1 1  ON 37
eH1_8                 2.631815e-01 1 1  ON 38
eH1_9                 1.137713e-01 1 1  ON 39
eH2_0                -2.112235e-01 1 1  ON 40
eH2_1                -1.323293e-01 1 1  ON 41
eH2_2                -9.059617e-02 1 1  ON 42
eH2_3                -5.302044e-02 1 1  ON 43
eH2_4                -6.435709e-03 1 1  ON 44
eH2_5                 5.487862e-03 1 1  ON 45
eH2_6                 4.753612e-02 1 1  ON 46
eH2_7                 4.075364e-02 1 1  ON 47
eH2_8                 2.470859e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2825
    reference variance = 0.615056
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315843666792
                                         uncertainty =       0.003146966593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315843666792
                                         uncertainty =       0.003146966593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397418250
  error estimate for blocks of size 2^( 2) =       0.000406754227
  error estimate for blocks of size 2^( 3) =       0.000415188307
  error estimate for blocks of size 2^( 4) =       0.000421528269
  error estimate for blocks of size 2^( 5) =       0.000425709397
  error estimate for blocks of size 2^( 6) =       0.000427126331
  error estimate for blocks of size 2^( 7) =       0.000427444460

      target function =                  N/A
              le_mean =     -17.216749784793
             les_mean =     296.732355525037
             stat err =       0.000425452114
             autocorr =       1.146055788742
              std dev =       0.562034279039
             le_variance =       0.315882530814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674978479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749784793       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749800253       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216749797040       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216749800443       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216749812571       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216749803796       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216749803456       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.425862e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749784793       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749788705       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216749787949       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216749788841       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216749791877       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216749789632       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216749789535       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.641500e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216749784793       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216749785774       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216749785588       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216749785814       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216749786573       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216749786008       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216749785983       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.153266e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7735e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.928354e-01 1 1  ON 0
 uu_1                 3.057588e-02 1 1  ON 1
 uu_2                -6.412662e-02 1 1  ON 2
 uu_3                -1.204871e-01 1 1  ON 3
 uu_4                -1.568890e-01 1 1  ON 4
 uu_5                -1.689373e-01 1 1  ON 5
 uu_6                -1.568357e-01 1 1  ON 6
 uu_7                -1.108410e-01 1 1  ON 7
 uu_8                -3.890155e-02 1 1  ON 8
 uu_9                 2.004327e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645223e-02 1 1  ON 11
 ud_2                -1.337971e-02 1 1  ON 12
 ud_3                -7.570893e-02 1 1  ON 13
 ud_4                -1.263636e-01 1 1  ON 14
 ud_5                -1.634521e-01 1 1  ON 15
 ud_6                -1.764533e-01 1 1  ON 16
 ud_7                -1.580628e-01 1 1  ON 17
 ud_8                -1.119656e-01 1 1  ON 18
 ud_9                 3.123557e-02 1 1  ON 19
 eO_0                -9.199300e-01 1 1  ON 20
 eO_1                -5.982938e-01 1 1  ON 21
 eO_2                -1.845877e-01 1 1  ON 22
 eO_3                 8.635855e-02 1 1  ON 23
 eO_4                 2.106952e-01 1 1  ON 24
 eO_5                 2.973194e-01 1 1  ON 25
 eO_6                 3.254066e-01 1 1  ON 26
 eO_7                 5.314980e-01 1 1  ON 27
 eO_8                 1.587275e-01 1 1  ON 28
 eO_9                 5.350360e-02 1 1  ON 29
eH1_0                -2.219367e-01 1 1  ON 30
eH1_1                -1.427845e-01 1 1  ON 31
eH1_2                -1.012972e-01 1 1  ON 32
eH1_3                -6.373554e-02 1 1  ON 33
eH1_4                -1.727115e-02 1 1  ON 34
eH1_5                -4.619022e-03 1 1  ON 35
eH1_6                 3.628477e-02 1 1  ON 36
eH1_7                 7.664572e-02 1 1  ON 37
eH1_8                 2.631810e-01 1 1  ON 38
eH1_9                 1.137713e-01 1 1  ON 39
eH2_0                -2.112241e-01 1 1  ON 40
eH2_1                -1.323303e-01 1 1  ON 41
eH2_2                -9.059608e-02 1 1  ON 42
eH2_3                -5.302200e-02 1 1  ON 43
eH2_4                -6.435480e-03 1 1  ON 44
eH2_5                 5.488871e-03 1 1  ON 45
eH2_6                 4.753652e-02 1 1  ON 46
eH2_7                 4.075486e-02 1 1  ON 47
eH2_8                 2.470857e-01 1 1  ON 48
eH2_9                 1.154405e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.232201
====================================================
  Execution time = 2.0321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1815e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318150438030
                                         uncertainty =       0.002954024169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318150438030
                                         uncertainty =       0.002954024169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398842085
  error estimate for blocks of size 2^( 2) =       0.000408210460
  error estimate for blocks of size 2^( 3) =       0.000416863222
  error estimate for blocks of size 2^( 4) =       0.000422093432
  error estimate for blocks of size 2^( 5) =       0.000426326830
  error estimate for blocks of size 2^( 6) =       0.000427896779
  error estimate for blocks of size 2^( 7) =       0.000429380674

      target function =                  N/A
              le_mean =     -17.217271390604
             les_mean =     296.752583996341
             stat err =       0.000426424429
             autocorr =       1.143094662173
              std dev =       0.564047885995
             le_variance =       0.318150017696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318138053500
                                         uncertainty =       0.002953910796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318138053500
                                         uncertainty =       0.002953910796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398834322
  error estimate for blocks of size 2^( 2) =       0.000408203020
  error estimate for blocks of size 2^( 3) =       0.000416856116
  error estimate for blocks of size 2^( 4) =       0.000422086482
  error estimate for blocks of size 2^( 5) =       0.000426320013
  error estimate for blocks of size 2^( 6) =       0.000427889899
  error estimate for blocks of size 2^( 7) =       0.000429374089

      target function =                  N/A
              le_mean =     -17.217271350677
             les_mean =     296.752570237349
             stat err =       0.000426417621
             autocorr =       1.143102657690
              std dev =       0.564036907982
             le_variance =       0.318137633566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318144093733
                                         uncertainty =       0.002953966170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318144093733
                                         uncertainty =       0.002953966170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398838109
  error estimate for blocks of size 2^( 2) =       0.000408206649
  error estimate for blocks of size 2^( 3) =       0.000416859581
  error estimate for blocks of size 2^( 4) =       0.000422089872
  error estimate for blocks of size 2^( 5) =       0.000426323337
  error estimate for blocks of size 2^( 6) =       0.000427893254
  error estimate for blocks of size 2^( 7) =       0.000429377299

      target function =                  N/A
              le_mean =     -17.217271370180
             les_mean =     296.752576948964
             stat err =       0.000426420941
             autocorr =       1.143098754537
              std dev =       0.564042262255
             le_variance =       0.318143673610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318149639970
                                         uncertainty =       0.002954016877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318149639970
                                         uncertainty =       0.002954016877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398841585
  error estimate for blocks of size 2^( 2) =       0.000408209981
  error estimate for blocks of size 2^( 3) =       0.000416862764
  error estimate for blocks of size 2^( 4) =       0.000422092984
  error estimate for blocks of size 2^( 5) =       0.000426326391
  error estimate for blocks of size 2^( 6) =       0.000427896336
  error estimate for blocks of size 2^( 7) =       0.000429380249

      target function =                  N/A
              le_mean =     -17.217271388024
             les_mean =     296.752583109455
             stat err =       0.000426423990
             autocorr =       1.143095176753
              std dev =       0.564047178579
             le_variance =       0.318149219663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217271390604        initial  <--
     1.4901e+01     1.4901e+02             1.4259e-05       -17.217271350677
     5.9605e+01     5.9605e+02             3.6415e-06       -17.217271370180
     2.3842e+02     2.3842e+03             9.1533e-07       -17.217271388024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8371
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.928350e-01 1 1  ON 0
 uu_1                 3.057383e-02 1 1  ON 1
 uu_2                -6.412679e-02 1 1  ON 2
 uu_3                -1.204870e-01 1 1  ON 3
 uu_4                -1.568913e-01 1 1  ON 4
 uu_5                -1.689341e-01 1 1  ON 5
 uu_6                -1.568342e-01 1 1  ON 6
 uu_7                -1.108400e-01 1 1  ON 7
 uu_8                -3.890179e-02 1 1  ON 8
 uu_9                 2.004330e-01 1 1  ON 9
 ud_0                 3.550302e-01 1 1  ON 10
 ud_1                 9.645126e-02 1 1  ON 11
 ud_2                -1.338025e-02 1 1  ON 12
 ud_3                -7.570882e-02 1 1  ON 13
 ud_4                -1.263640e-01 1 1  ON 14
 ud_5                -1.634514e-01 1 1  ON 15
 ud_6                -1.764533e-01 1 1  ON 16
 ud_7                -1.580644e-01 1 1  ON 17
 ud_8                -1.119658e-01 1 1  ON 18
 ud_9                 3.123572e-02 1 1  ON 19
 eO_0                -9.199295e-01 1 1  ON 20
 eO_1                -5.982927e-01 1 1  ON 21
 eO_2                -1.845873e-01 1 1  ON 22
 eO_3                 8.635726e-02 1 1  ON 23
 eO_4                 2.106947e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254064e-01 1 1  ON 26
 eO_7                 5.314985e-01 1 1  ON 27
 eO_8                 1.587271e-01 1 1  ON 28
 eO_9                 5.350341e-02 1 1  ON 29
eH1_0                -2.219373e-01 1 1  ON 30
eH1_1                -1.427849e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373598e-02 1 1  ON 33
eH1_4                -1.727042e-02 1 1  ON 34
eH1_5                -4.619242e-03 1 1  ON 35
eH1_6                 3.628437e-02 1 1  ON 36
eH1_7                 7.664656e-02 1 1  ON 37
eH1_8                 2.631815e-01 1 1  ON 38
eH1_9                 1.137713e-01 1 1  ON 39
eH2_0                -2.112235e-01 1 1  ON 40
eH2_1                -1.323293e-01 1 1  ON 41
eH2_2                -9.059617e-02 1 1  ON 42
eH2_3                -5.302044e-02 1 1  ON 43
eH2_4                -6.435709e-03 1 1  ON 44
eH2_5                 5.487862e-03 1 1  ON 45
eH2_6                 4.753612e-02 1 1  ON 46
eH2_7                 4.075364e-02 1 1  ON 47
eH2_8                 2.470859e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.18519
====================================================
  Execution time = 2.0751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1389e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313858679714
                                         uncertainty =       0.002631379289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313858679714
                                         uncertainty =       0.002631379289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396165814
  error estimate for blocks of size 2^( 2) =       0.000406040131
  error estimate for blocks of size 2^( 3) =       0.000415297845
  error estimate for blocks of size 2^( 4) =       0.000421191098
  error estimate for blocks of size 2^( 5) =       0.000424368860
  error estimate for blocks of size 2^( 6) =       0.000425970774
  error estimate for blocks of size 2^( 7) =       0.000429080296

      target function =                  N/A
              le_mean =     -17.217839772408
             les_mean =     296.767900976280
             stat err =       0.000425152757
             autocorr =       1.151691085899
              std dev =       0.560263067588
             le_variance =       0.313894704903


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721783977241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217839772408       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217839771748       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217839765360       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217839764469       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217839763807       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217839764126       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 9.792253e-07

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217839772408       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217839772243       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217839770643       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217839770420       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217839770254       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217839770333       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.449821e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217839772408       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217839772367       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217839771967       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217839771911       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217839771868       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217839771891       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 6.125653e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6342e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.928350e-01 1 1  ON 0
 uu_1                 3.057384e-02 1 1  ON 1
 uu_2                -6.412677e-02 1 1  ON 2
 uu_3                -1.204870e-01 1 1  ON 3
 uu_4                -1.568914e-01 1 1  ON 4
 uu_5                -1.689340e-01 1 1  ON 5
 uu_6                -1.568342e-01 1 1  ON 6
 uu_7                -1.108400e-01 1 1  ON 7
 uu_8                -3.890176e-02 1 1  ON 8
 uu_9                 2.004330e-01 1 1  ON 9
 ud_0                 3.550301e-01 1 1  ON 10
 ud_1                 9.645126e-02 1 1  ON 11
 ud_2                -1.338011e-02 1 1  ON 12
 ud_3                -7.570878e-02 1 1  ON 13
 ud_4                -1.263639e-01 1 1  ON 14
 ud_5                -1.634515e-01 1 1  ON 15
 ud_6                -1.764534e-01 1 1  ON 16
 ud_7                -1.580644e-01 1 1  ON 17
 ud_8                -1.119658e-01 1 1  ON 18
 ud_9                 3.123569e-02 1 1  ON 19
 eO_0                -9.199295e-01 1 1  ON 20
 eO_1                -5.982927e-01 1 1  ON 21
 eO_2                -1.845875e-01 1 1  ON 22
 eO_3                 8.635728e-02 1 1  ON 23
 eO_4                 2.106949e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254063e-01 1 1  ON 26
 eO_7                 5.314985e-01 1 1  ON 27
 eO_8                 1.587271e-01 1 1  ON 28
 eO_9                 5.350342e-02 1 1  ON 29
eH1_0                -2.219372e-01 1 1  ON 30
eH1_1                -1.427850e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373593e-02 1 1  ON 33
eH1_4                -1.727052e-02 1 1  ON 34
eH1_5                -4.619170e-03 1 1  ON 35
eH1_6                 3.628437e-02 1 1  ON 36
eH1_7                 7.664648e-02 1 1  ON 37
eH1_8                 2.631815e-01 1 1  ON 38
eH1_9                 1.137713e-01 1 1  ON 39
eH2_0                -2.112235e-01 1 1  ON 40
eH2_1                -1.323294e-01 1 1  ON 41
eH2_2                -9.059624e-02 1 1  ON 42
eH2_3                -5.302048e-02 1 1  ON 43
eH2_4                -6.435612e-03 1 1  ON 44
eH2_5                 5.487986e-03 1 1  ON 45
eH2_6                 4.753611e-02 1 1  ON 46
eH2_7                 4.075367e-02 1 1  ON 47
eH2_8                 2.470859e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1829
    reference variance = 0.197482
====================================================
  Execution time = 2.0239e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1697e-01
  Total weights = 2.0000e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996960631
                                         uncertainty =       0.003299678834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996960631
                                         uncertainty =       0.003299678834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398100143
  error estimate for blocks of size 2^( 2) =       0.000407899205
  error estimate for blocks of size 2^( 3) =       0.000416067936
  error estimate for blocks of size 2^( 4) =       0.000421656039
  error estimate for blocks of size 2^( 5) =       0.000425441080
  error estimate for blocks of size 2^( 6) =       0.000427047432
  error estimate for blocks of size 2^( 7) =       0.000424973903

      target function =                  N/A
              le_mean =     -17.216318590072
             les_mean =     296.718593084547
             stat err =       0.000424779613
             autocorr =       1.138525239724
              std dev =       0.562998621828
             le_variance =       0.316967448180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996162478
                                         uncertainty =       0.003299672660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996162478
                                         uncertainty =       0.003299672660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398099642
  error estimate for blocks of size 2^( 2) =       0.000407898727
  error estimate for blocks of size 2^( 3) =       0.000416067478
  error estimate for blocks of size 2^( 4) =       0.000421655594
  error estimate for blocks of size 2^( 5) =       0.000425440642
  error estimate for blocks of size 2^( 6) =       0.000427046979
  error estimate for blocks of size 2^( 7) =       0.000424973447

      target function =                  N/A
              le_mean =     -17.216318590388
             les_mean =     296.718592297000
             stat err =       0.000424779165
             autocorr =       1.138525706070
              std dev =       0.562997912748
             le_variance =       0.316966649759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996560805
                                         uncertainty =       0.003299675740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996560805
                                         uncertainty =       0.003299675740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398099892
  error estimate for blocks of size 2^( 2) =       0.000407898966
  error estimate for blocks of size 2^( 3) =       0.000416067707
  error estimate for blocks of size 2^( 4) =       0.000421655816
  error estimate for blocks of size 2^( 5) =       0.000425440861
  error estimate for blocks of size 2^( 6) =       0.000427047205
  error estimate for blocks of size 2^( 7) =       0.000424973674

      target function =                  N/A
              le_mean =     -17.216318590226
             les_mean =     296.718592689913
             stat err =       0.000424779389
             autocorr =       1.138525473349
              std dev =       0.562998266622
             le_variance =       0.316967048219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996910629
                                         uncertainty =       0.003299678447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316996910629
                                         uncertainty =       0.003299678447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398100112
  error estimate for blocks of size 2^( 2) =       0.000407899175
  error estimate for blocks of size 2^( 3) =       0.000416067908
  error estimate for blocks of size 2^( 4) =       0.000421656012
  error estimate for blocks of size 2^( 5) =       0.000425441052
  error estimate for blocks of size 2^( 6) =       0.000427047403
  error estimate for blocks of size 2^( 7) =       0.000424973874

      target function =                  N/A
              le_mean =     -17.216318590091
             les_mean =     296.718593035188
             stat err =       0.000424779585
             autocorr =       1.138525268932
              std dev =       0.562998577406
             le_variance =       0.316967398161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216318590072        initial
     1.4901e+02     1.4901e+03             9.7923e-07       -17.216318590388  <--
     5.9605e+02     5.9605e+03             2.4498e-07       -17.216318590226
     2.3842e+03     2.3842e+04             6.1257e-08       -17.216318590091

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9772e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.928349e-01 1 1  ON 0
 uu_1                 3.057387e-02 1 1  ON 1
 uu_2                -6.412672e-02 1 1  ON 2
 uu_3                -1.204870e-01 1 1  ON 3
 uu_4                -1.568916e-01 1 1  ON 4
 uu_5                -1.689338e-01 1 1  ON 5
 uu_6                -1.568341e-01 1 1  ON 6
 uu_7                -1.108401e-01 1 1  ON 7
 uu_8                -3.890167e-02 1 1  ON 8
 uu_9                 2.004329e-01 1 1  ON 9
 ud_0                 3.550296e-01 1 1  ON 10
 ud_1                 9.645127e-02 1 1  ON 11
 ud_2                -1.337969e-02 1 1  ON 12
 ud_3                -7.570864e-02 1 1  ON 13
 ud_4                -1.263637e-01 1 1  ON 14
 ud_5                -1.634517e-01 1 1  ON 15
 ud_6                -1.764536e-01 1 1  ON 16
 ud_7                -1.580644e-01 1 1  ON 17
 ud_8                -1.119657e-01 1 1  ON 18
 ud_9                 3.123562e-02 1 1  ON 19
 eO_0                -9.199297e-01 1 1  ON 20
 eO_1                -5.982928e-01 1 1  ON 21
 eO_2                -1.845881e-01 1 1  ON 22
 eO_3                 8.635734e-02 1 1  ON 23
 eO_4                 2.106957e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254063e-01 1 1  ON 26
 eO_7                 5.314984e-01 1 1  ON 27
 eO_8                 1.587272e-01 1 1  ON 28
 eO_9                 5.350344e-02 1 1  ON 29
eH1_0                -2.219368e-01 1 1  ON 30
eH1_1                -1.427851e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373578e-02 1 1  ON 33
eH1_4                -1.727083e-02 1 1  ON 34
eH1_5                -4.618954e-03 1 1  ON 35
eH1_6                 3.628437e-02 1 1  ON 36
eH1_7                 7.664625e-02 1 1  ON 37
eH1_8                 2.631814e-01 1 1  ON 38
eH1_9                 1.137714e-01 1 1  ON 39
eH2_0                -2.112235e-01 1 1  ON 40
eH2_1                -1.323297e-01 1 1  ON 41
eH2_2                -9.059648e-02 1 1  ON 42
eH2_3                -5.302061e-02 1 1  ON 43
eH2_4                -6.435324e-03 1 1  ON 44
eH2_5                 5.488358e-03 1 1  ON 45
eH2_6                 4.753608e-02 1 1  ON 46
eH2_7                 4.075375e-02 1 1  ON 47
eH2_8                 2.470858e-01 1 1  ON 48
eH2_9                 1.154402e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2302
    reference variance = 0.135976
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315899234204
                                         uncertainty =       0.002730037695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315899234204
                                         uncertainty =       0.002730037695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397394848
  error estimate for blocks of size 2^( 2) =       0.000406941638
  error estimate for blocks of size 2^( 3) =       0.000415441895
  error estimate for blocks of size 2^( 4) =       0.000422213414
  error estimate for blocks of size 2^( 5) =       0.000424806636
  error estimate for blocks of size 2^( 6) =       0.000428036024
  error estimate for blocks of size 2^( 7) =       0.000429795548

      target function =                  N/A
              le_mean =     -17.216538650601
             les_mean =     296.725048280070
             stat err =       0.000426212906
             autocorr =       1.150293661913
              std dev =       0.562001183588
             le_variance =       0.315845330354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653865060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538650601       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538656791       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538664069       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538663323       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216538664192       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216538667430       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538667536       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.378681e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538650601       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538652153       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538653983       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538653795       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216538654030       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216538654840       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538654855       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 8.450709e-07

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538650601       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538650989       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538651447       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538651400       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216538651460       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216538651664       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538651666       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 2.112922e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6082e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.928355e-01 1 1  ON 0
 uu_1                 3.057430e-02 1 1  ON 1
 uu_2                -6.412700e-02 1 1  ON 2
 uu_3                -1.204872e-01 1 1  ON 3
 uu_4                -1.568921e-01 1 1  ON 4
 uu_5                -1.689338e-01 1 1  ON 5
 uu_6                -1.568348e-01 1 1  ON 6
 uu_7                -1.108402e-01 1 1  ON 7
 uu_8                -3.890128e-02 1 1  ON 8
 uu_9                 2.004328e-01 1 1  ON 9
 ud_0                 3.550296e-01 1 1  ON 10
 ud_1                 9.645066e-02 1 1  ON 11
 ud_2                -1.337940e-02 1 1  ON 12
 ud_3                -7.570897e-02 1 1  ON 13
 ud_4                -1.263632e-01 1 1  ON 14
 ud_5                -1.634514e-01 1 1  ON 15
 ud_6                -1.764540e-01 1 1  ON 16
 ud_7                -1.580643e-01 1 1  ON 17
 ud_8                -1.119655e-01 1 1  ON 18
 ud_9                 3.123557e-02 1 1  ON 19
 eO_0                -9.199301e-01 1 1  ON 20
 eO_1                -5.982933e-01 1 1  ON 21
 eO_2                -1.845882e-01 1 1  ON 22
 eO_3                 8.635763e-02 1 1  ON 23
 eO_4                 2.106965e-01 1 1  ON 24
 eO_5                 2.973196e-01 1 1  ON 25
 eO_6                 3.254061e-01 1 1  ON 26
 eO_7                 5.314982e-01 1 1  ON 27
 eO_8                 1.587274e-01 1 1  ON 28
 eO_9                 5.350350e-02 1 1  ON 29
eH1_0                -2.219372e-01 1 1  ON 30
eH1_1                -1.427853e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373538e-02 1 1  ON 33
eH1_4                -1.727078e-02 1 1  ON 34
eH1_5                -4.618531e-03 1 1  ON 35
eH1_6                 3.628427e-02 1 1  ON 36
eH1_7                 7.664589e-02 1 1  ON 37
eH1_8                 2.631813e-01 1 1  ON 38
eH1_9                 1.137715e-01 1 1  ON 39
eH2_0                -2.112240e-01 1 1  ON 40
eH2_1                -1.323291e-01 1 1  ON 41
eH2_2                -9.059630e-02 1 1  ON 42
eH2_3                -5.302047e-02 1 1  ON 43
eH2_4                -6.436005e-03 1 1  ON 44
eH2_5                 5.488447e-03 1 1  ON 45
eH2_6                 4.753607e-02 1 1  ON 46
eH2_7                 4.075403e-02 1 1  ON 47
eH2_8                 2.470857e-01 1 1  ON 48
eH2_9                 1.154403e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.1845
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2027e-01
  Total weights = 2.0000e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320310768041
                                         uncertainty =       0.005191486356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320310768041
                                         uncertainty =       0.005191486356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400169875
  error estimate for blocks of size 2^( 2) =       0.000409865838
  error estimate for blocks of size 2^( 3) =       0.000418606888
  error estimate for blocks of size 2^( 4) =       0.000424876218
  error estimate for blocks of size 2^( 5) =       0.000429240520
  error estimate for blocks of size 2^( 6) =       0.000431847490
  error estimate for blocks of size 2^( 7) =       0.000432266335

      target function =                  N/A
              le_mean =     -17.217253962310
             les_mean =     296.754105700590
             stat err =       0.000429557641
             autocorr =       1.152269624425
              std dev =       0.565925664778
             le_variance =       0.320271858054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320311791317
                                         uncertainty =       0.005191515972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320311791317
                                         uncertainty =       0.005191515972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170514
  error estimate for blocks of size 2^( 2) =       0.000409866481
  error estimate for blocks of size 2^( 3) =       0.000418607563
  error estimate for blocks of size 2^( 4) =       0.000424876931
  error estimate for blocks of size 2^( 5) =       0.000429241291
  error estimate for blocks of size 2^( 6) =       0.000431848240
  error estimate for blocks of size 2^( 7) =       0.000432266901

      target function =                  N/A
              le_mean =     -17.217253966314
             les_mean =     296.754106861604
             stat err =       0.000429558341
             autocorr =       1.152269699168
              std dev =       0.565926568715
             le_variance =       0.320272881178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320311287084
                                         uncertainty =       0.005191501301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320311287084
                                         uncertainty =       0.005191501301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170199
  error estimate for blocks of size 2^( 2) =       0.000409866164
  error estimate for blocks of size 2^( 3) =       0.000418607230
  error estimate for blocks of size 2^( 4) =       0.000424876580
  error estimate for blocks of size 2^( 5) =       0.000429240911
  error estimate for blocks of size 2^( 6) =       0.000431847870
  error estimate for blocks of size 2^( 7) =       0.000432266622

      target function =                  N/A
              le_mean =     -17.217253964295
             les_mean =     296.754106287924
             stat err =       0.000429557995
             autocorr =       1.152269659762
              std dev =       0.565926123289
             le_variance =       0.320272377021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320310833145
                                         uncertainty =       0.005191488228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320310833145
                                         uncertainty =       0.005191488228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400169916
  error estimate for blocks of size 2^( 2) =       0.000409865879
  error estimate for blocks of size 2^( 3) =       0.000418606931
  error estimate for blocks of size 2^( 4) =       0.000424876264
  error estimate for blocks of size 2^( 5) =       0.000429240569
  error estimate for blocks of size 2^( 6) =       0.000431847538
  error estimate for blocks of size 2^( 7) =       0.000432266371

      target function =                  N/A
              le_mean =     -17.217253962556
             les_mean =     296.754105774173
             stat err =       0.000429557685
             autocorr =       1.152269628777
              std dev =       0.565925722289
             le_variance =       0.320271923149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217253962310        initial
     3.7253e+01     3.7253e+02             3.3787e-06       -17.217253966314  <--
     1.4901e+02     1.4901e+03             8.4507e-07       -17.217253964295
     5.9605e+02     5.9605e+03             2.1129e-07       -17.217253962556

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.9760e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.928372e-01 1 1  ON 0
 uu_1                 3.057559e-02 1 1  ON 1
 uu_2                -6.412782e-02 1 1  ON 2
 uu_3                -1.204877e-01 1 1  ON 3
 uu_4                -1.568935e-01 1 1  ON 4
 uu_5                -1.689338e-01 1 1  ON 5
 uu_6                -1.568369e-01 1 1  ON 6
 uu_7                -1.108403e-01 1 1  ON 7
 uu_8                -3.890012e-02 1 1  ON 8
 uu_9                 2.004327e-01 1 1  ON 9
 ud_0                 3.550296e-01 1 1  ON 10
 ud_1                 9.644885e-02 1 1  ON 11
 ud_2                -1.337855e-02 1 1  ON 12
 ud_3                -7.570993e-02 1 1  ON 13
 ud_4                -1.263619e-01 1 1  ON 14
 ud_5                -1.634505e-01 1 1  ON 15
 ud_6                -1.764554e-01 1 1  ON 16
 ud_7                -1.580641e-01 1 1  ON 17
 ud_8                -1.119650e-01 1 1  ON 18
 ud_9                 3.123543e-02 1 1  ON 19
 eO_0                -9.199315e-01 1 1  ON 20
 eO_1                -5.982948e-01 1 1  ON 21
 eO_2                -1.845884e-01 1 1  ON 22
 eO_3                 8.635850e-02 1 1  ON 23
 eO_4                 2.106990e-01 1 1  ON 24
 eO_5                 2.973195e-01 1 1  ON 25
 eO_6                 3.254055e-01 1 1  ON 26
 eO_7                 5.314977e-01 1 1  ON 27
 eO_8                 1.587282e-01 1 1  ON 28
 eO_9                 5.350369e-02 1 1  ON 29
eH1_0                -2.219383e-01 1 1  ON 30
eH1_1                -1.427858e-01 1 1  ON 31
eH1_2                -1.012969e-01 1 1  ON 32
eH1_3                -6.373420e-02 1 1  ON 33
eH1_4                -1.727062e-02 1 1  ON 34
eH1_5                -4.617264e-03 1 1  ON 35
eH1_6                 3.628399e-02 1 1  ON 36
eH1_7                 7.664480e-02 1 1  ON 37
eH1_8                 2.631812e-01 1 1  ON 38
eH1_9                 1.137717e-01 1 1  ON 39
eH2_0                -2.112256e-01 1 1  ON 40
eH2_1                -1.323274e-01 1 1  ON 41
eH2_2                -9.059577e-02 1 1  ON 42
eH2_3                -5.302003e-02 1 1  ON 43
eH2_4                -6.438045e-03 1 1  ON 44
eH2_5                 5.488713e-03 1 1  ON 45
eH2_6                 4.753603e-02 1 1  ON 46
eH2_7                 4.075486e-02 1 1  ON 47
eH2_8                 2.470854e-01 1 1  ON 48
eH2_9                 1.154404e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.300819
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315592788479
                                         uncertainty =       0.003277204263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315592788479
                                         uncertainty =       0.003277204263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397382058
  error estimate for blocks of size 2^( 2) =       0.000406687216
  error estimate for blocks of size 2^( 3) =       0.000415119938
  error estimate for blocks of size 2^( 4) =       0.000420678067
  error estimate for blocks of size 2^( 5) =       0.000423998894
  error estimate for blocks of size 2^( 6) =       0.000426199092
  error estimate for blocks of size 2^( 7) =       0.000426641239

      target function =                  N/A
              le_mean =     -17.216693745824
             les_mean =     296.730368378965
             stat err =       0.000424379323
             autocorr =       1.140491160064
              std dev =       0.561983095274
             le_variance =       0.315824999373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669374582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693745824       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693768188       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693820938       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693821226       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693854373       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693827540       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.437663e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693745824       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693751495       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693764929       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693764932       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693773562       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693766796       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 3.663407e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216693745824       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216693747247       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216693750621       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216693750618       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216693752798       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216693751103       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 9.203188e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6176e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.928379e-01 1 1  ON 0
 uu_1                 3.057440e-02 1 1  ON 1
 uu_2                -6.412896e-02 1 1  ON 2
 uu_3                -1.204889e-01 1 1  ON 3
 uu_4                -1.568947e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568342e-01 1 1  ON 6
 uu_7                -1.108396e-01 1 1  ON 7
 uu_8                -3.889997e-02 1 1  ON 8
 uu_9                 2.004322e-01 1 1  ON 9
 ud_0                 3.550278e-01 1 1  ON 10
 ud_1                 9.645009e-02 1 1  ON 11
 ud_2                -1.337893e-02 1 1  ON 12
 ud_3                -7.570995e-02 1 1  ON 13
 ud_4                -1.263632e-01 1 1  ON 14
 ud_5                -1.634538e-01 1 1  ON 15
 ud_6                -1.764530e-01 1 1  ON 16
 ud_7                -1.580618e-01 1 1  ON 17
 ud_8                -1.119646e-01 1 1  ON 18
 ud_9                 3.123513e-02 1 1  ON 19
 eO_0                -9.199312e-01 1 1  ON 20
 eO_1                -5.982964e-01 1 1  ON 21
 eO_2                -1.845895e-01 1 1  ON 22
 eO_3                 8.635739e-02 1 1  ON 23
 eO_4                 2.106997e-01 1 1  ON 24
 eO_5                 2.973213e-01 1 1  ON 25
 eO_6                 3.254063e-01 1 1  ON 26
 eO_7                 5.314971e-01 1 1  ON 27
 eO_8                 1.587287e-01 1 1  ON 28
 eO_9                 5.350390e-02 1 1  ON 29
eH1_0                -2.219372e-01 1 1  ON 30
eH1_1                -1.427867e-01 1 1  ON 31
eH1_2                -1.013005e-01 1 1  ON 32
eH1_3                -6.373182e-02 1 1  ON 33
eH1_4                -1.727349e-02 1 1  ON 34
eH1_5                -4.614500e-03 1 1  ON 35
eH1_6                 3.628560e-02 1 1  ON 36
eH1_7                 7.664414e-02 1 1  ON 37
eH1_8                 2.631808e-01 1 1  ON 38
eH1_9                 1.137720e-01 1 1  ON 39
eH2_0                -2.112272e-01 1 1  ON 40
eH2_1                -1.323273e-01 1 1  ON 41
eH2_2                -9.059582e-02 1 1  ON 42
eH2_3                -5.301960e-02 1 1  ON 43
eH2_4                -6.436753e-03 1 1  ON 44
eH2_5                 5.486959e-03 1 1  ON 45
eH2_6                 4.753562e-02 1 1  ON 46
eH2_7                 4.075656e-02 1 1  ON 47
eH2_8                 2.470854e-01 1 1  ON 48
eH2_9                 1.154405e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.201577
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1695e-01
  Total weights = 2.0000e+06
  Execution time = 1.9277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878358820
                                         uncertainty =       0.003493973568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878358820
                                         uncertainty =       0.003493973568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398089141
  error estimate for blocks of size 2^( 2) =       0.000407015750
  error estimate for blocks of size 2^( 3) =       0.000415385238
  error estimate for blocks of size 2^( 4) =       0.000421300094
  error estimate for blocks of size 2^( 5) =       0.000425761921
  error estimate for blocks of size 2^( 6) =       0.000428317086
  error estimate for blocks of size 2^( 7) =       0.000429286020

      target function =                  N/A
              le_mean =     -17.217081913368
             les_mean =     296.744859381087
             stat err =       0.000426166280
             autocorr =       1.146034010235
              std dev =       0.562983061846
             le_variance =       0.316949927925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316875149865
                                         uncertainty =       0.003493908038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316875149865
                                         uncertainty =       0.003493908038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398087123
  error estimate for blocks of size 2^( 2) =       0.000407013807
  error estimate for blocks of size 2^( 3) =       0.000415383315
  error estimate for blocks of size 2^( 4) =       0.000421298069
  error estimate for blocks of size 2^( 5) =       0.000425759866
  error estimate for blocks of size 2^( 6) =       0.000428315011
  error estimate for blocks of size 2^( 7) =       0.000429283760

      target function =                  N/A
              le_mean =     -17.217081915252
             les_mean =     296.744856232725
             stat err =       0.000426164177
             autocorr =       1.146034314404
              std dev =       0.562980208095
             le_variance =       0.316946714706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316876676526
                                         uncertainty =       0.003493940353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316876676526
                                         uncertainty =       0.003493940353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398088083
  error estimate for blocks of size 2^( 2) =       0.000407014731
  error estimate for blocks of size 2^( 3) =       0.000415384229
  error estimate for blocks of size 2^( 4) =       0.000421299035
  error estimate for blocks of size 2^( 5) =       0.000425760848
  error estimate for blocks of size 2^( 6) =       0.000428316003
  error estimate for blocks of size 2^( 7) =       0.000429284841

      target function =                  N/A
              le_mean =     -17.217081914121
             les_mean =     296.744857722453
             stat err =       0.000426165182
             autocorr =       1.146034192879
              std dev =       0.562981565763
             le_variance =       0.316948243389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878145888
                                         uncertainty =       0.003493969402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316878145888
                                         uncertainty =       0.003493969402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398089007
  error estimate for blocks of size 2^( 2) =       0.000407015621
  error estimate for blocks of size 2^( 3) =       0.000415385110
  error estimate for blocks of size 2^( 4) =       0.000421299960
  error estimate for blocks of size 2^( 5) =       0.000425761785
  error estimate for blocks of size 2^( 6) =       0.000428316949
  error estimate for blocks of size 2^( 7) =       0.000429285871

      target function =                  N/A
              le_mean =     -17.217081913443
             les_mean =     296.744859170450
             stat err =       0.000426166141
             autocorr =       1.146034034039
              std dev =       0.562982872483
             le_variance =       0.316949714709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217081913368        initial
     9.3132e+00     9.3132e+01             1.4377e-05       -17.217081915252  <--
     3.7253e+01     3.7253e+02             3.6634e-06       -17.217081914121
     1.4901e+02     1.4901e+03             9.2032e-07       -17.217081913443

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.9612e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.928398e-01 1 1  ON 0
 uu_1                 3.057085e-02 1 1  ON 1
 uu_2                -6.413230e-02 1 1  ON 2
 uu_3                -1.204923e-01 1 1  ON 3
 uu_4                -1.568983e-01 1 1  ON 4
 uu_5                -1.689341e-01 1 1  ON 5
 uu_6                -1.568262e-01 1 1  ON 6
 uu_7                -1.108377e-01 1 1  ON 7
 uu_8                -3.889953e-02 1 1  ON 8
 uu_9                 2.004311e-01 1 1  ON 9
 ud_0                 3.550225e-01 1 1  ON 10
 ud_1                 9.645352e-02 1 1  ON 11
 ud_2                -1.337997e-02 1 1  ON 12
 ud_3                -7.571014e-02 1 1  ON 13
 ud_4                -1.263669e-01 1 1  ON 14
 ud_5                -1.634634e-01 1 1  ON 15
 ud_6                -1.764458e-01 1 1  ON 16
 ud_7                -1.580549e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123425e-02 1 1  ON 19
 eO_0                -9.199301e-01 1 1  ON 20
 eO_1                -5.983011e-01 1 1  ON 21
 eO_2                -1.845925e-01 1 1  ON 22
 eO_3                 8.635409e-02 1 1  ON 23
 eO_4                 2.107018e-01 1 1  ON 24
 eO_5                 2.973266e-01 1 1  ON 25
 eO_6                 3.254084e-01 1 1  ON 26
 eO_7                 5.314951e-01 1 1  ON 27
 eO_8                 1.587301e-01 1 1  ON 28
 eO_9                 5.350452e-02 1 1  ON 29
eH1_0                -2.219338e-01 1 1  ON 30
eH1_1                -1.427892e-01 1 1  ON 31
eH1_2                -1.013112e-01 1 1  ON 32
eH1_3                -6.372497e-02 1 1  ON 33
eH1_4                -1.728189e-02 1 1  ON 34
eH1_5                -4.606320e-03 1 1  ON 35
eH1_6                 3.629039e-02 1 1  ON 36
eH1_7                 7.664217e-02 1 1  ON 37
eH1_8                 2.631794e-01 1 1  ON 38
eH1_9                 1.137729e-01 1 1  ON 39
eH2_0                -2.112319e-01 1 1  ON 40
eH2_1                -1.323269e-01 1 1  ON 41
eH2_2                -9.059597e-02 1 1  ON 42
eH2_3                -5.301830e-02 1 1  ON 43
eH2_4                -6.432910e-03 1 1  ON 44
eH2_5                 5.481749e-03 1 1  ON 45
eH2_6                 4.753441e-02 1 1  ON 46
eH2_7                 4.076158e-02 1 1  ON 47
eH2_8                 2.470855e-01 1 1  ON 48
eH2_9                 1.154409e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.875851
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1795e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317945350388
                                         uncertainty =       0.004258666259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317945350388
                                         uncertainty =       0.004258666259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398715086
  error estimate for blocks of size 2^( 2) =       0.000407974799
  error estimate for blocks of size 2^( 3) =       0.000415983888
  error estimate for blocks of size 2^( 4) =       0.000421955119
  error estimate for blocks of size 2^( 5) =       0.000425216435
  error estimate for blocks of size 2^( 6) =       0.000427402237
  error estimate for blocks of size 2^( 7) =       0.000427392040

      target function =                  N/A
              le_mean =     -17.217112325887
             les_mean =     296.746904123146
             stat err =       0.000425491458
             autocorr =       1.138823326470
              std dev =       0.563868282415
             le_variance =       0.317947439913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711232589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217112325887       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217112329349       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217112177385       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217112097540       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217111966013       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217112043511       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217112050009       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 4.354722e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217112325887       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217112326821       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217112287136       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217112264427       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217112227161       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217112245437       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.125934e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217112325887       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217112326125       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217112316090       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217112310214       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217112300571       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217112304990       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 2.863690e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6023e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.928411e-01 1 1  ON 0
 uu_1                 3.056332e-02 1 1  ON 1
 uu_2                -6.414200e-02 1 1  ON 2
 uu_3                -1.204957e-01 1 1  ON 3
 uu_4                -1.568938e-01 1 1  ON 4
 uu_5                -1.689314e-01 1 1  ON 5
 uu_6                -1.568202e-01 1 1  ON 6
 uu_7                -1.108359e-01 1 1  ON 7
 uu_8                -3.889772e-02 1 1  ON 8
 uu_9                 2.004278e-01 1 1  ON 9
 ud_0                 3.550237e-01 1 1  ON 10
 ud_1                 9.645803e-02 1 1  ON 11
 ud_2                -1.338183e-02 1 1  ON 12
 ud_3                -7.571172e-02 1 1  ON 13
 ud_4                -1.263782e-01 1 1  ON 14
 ud_5                -1.634616e-01 1 1  ON 15
 ud_6                -1.764489e-01 1 1  ON 16
 ud_7                -1.580492e-01 1 1  ON 17
 ud_8                -1.119607e-01 1 1  ON 18
 ud_9                 3.123257e-02 1 1  ON 19
 eO_0                -9.199374e-01 1 1  ON 20
 eO_1                -5.983062e-01 1 1  ON 21
 eO_2                -1.845899e-01 1 1  ON 22
 eO_3                 8.634919e-02 1 1  ON 23
 eO_4                 2.107104e-01 1 1  ON 24
 eO_5                 2.973304e-01 1 1  ON 25
 eO_6                 3.254092e-01 1 1  ON 26
 eO_7                 5.314927e-01 1 1  ON 27
 eO_8                 1.587325e-01 1 1  ON 28
 eO_9                 5.350527e-02 1 1  ON 29
eH1_0                -2.219345e-01 1 1  ON 30
eH1_1                -1.427848e-01 1 1  ON 31
eH1_2                -1.013074e-01 1 1  ON 32
eH1_3                -6.372306e-02 1 1  ON 33
eH1_4                -1.728925e-02 1 1  ON 34
eH1_5                -4.606299e-03 1 1  ON 35
eH1_6                 3.629152e-02 1 1  ON 36
eH1_7                 7.663765e-02 1 1  ON 37
eH1_8                 2.631779e-01 1 1  ON 38
eH1_9                 1.137744e-01 1 1  ON 39
eH2_0                -2.112250e-01 1 1  ON 40
eH2_1                -1.323196e-01 1 1  ON 41
eH2_2                -9.059644e-02 1 1  ON 42
eH2_3                -5.301809e-02 1 1  ON 43
eH2_4                -6.442655e-03 1 1  ON 44
eH2_5                 5.471186e-03 1 1  ON 45
eH2_6                 4.753505e-02 1 1  ON 46
eH2_7                 4.076761e-02 1 1  ON 47
eH2_8                 2.470840e-01 1 1  ON 48
eH2_9                 1.154410e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.3065
    reference variance = 0.48305
====================================================
  Execution time = 2.0035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2169e-01
  Total weights = 2.0000e+06
  Execution time = 1.8707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321587953406
                                         uncertainty =       0.003174863601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321587953406
                                         uncertainty =       0.003174863601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401051643
  error estimate for blocks of size 2^( 2) =       0.000410183046
  error estimate for blocks of size 2^( 3) =       0.000418184670
  error estimate for blocks of size 2^( 4) =       0.000423734055
  error estimate for blocks of size 2^( 5) =       0.000427743265
  error estimate for blocks of size 2^( 6) =       0.000429495067
  error estimate for blocks of size 2^( 7) =       0.000429413414

      target function =                  N/A
              le_mean =     -17.217103361417
             les_mean =     296.750332837407
             stat err =       0.000427596450
             autocorr =       1.136756857784
              std dev =       0.567172672586
             le_variance =       0.321684840528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321601156262
                                         uncertainty =       0.003175105459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321601156262
                                         uncertainty =       0.003175105459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401059876
  error estimate for blocks of size 2^( 2) =       0.000410191256
  error estimate for blocks of size 2^( 3) =       0.000418192767
  error estimate for blocks of size 2^( 4) =       0.000423741573
  error estimate for blocks of size 2^( 5) =       0.000427750153
  error estimate for blocks of size 2^( 6) =       0.000429501784
  error estimate for blocks of size 2^( 7) =       0.000429419428

      target function =                  N/A
              le_mean =     -17.217103163029
             les_mean =     296.750339213769
             stat err =       0.000427603235
             autocorr =       1.136746257959
              std dev =       0.567184315926
             le_variance =       0.321698048232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321595017862
                                         uncertainty =       0.003175009601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321595017862
                                         uncertainty =       0.003175009601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401056048
  error estimate for blocks of size 2^( 2) =       0.000410187439
  error estimate for blocks of size 2^( 3) =       0.000418189017
  error estimate for blocks of size 2^( 4) =       0.000423738094
  error estimate for blocks of size 2^( 5) =       0.000427746963
  error estimate for blocks of size 2^( 6) =       0.000429498675
  error estimate for blocks of size 2^( 7) =       0.000429416759

      target function =                  N/A
              le_mean =     -17.217103267841
             les_mean =     296.750336681863
             stat err =       0.000427600123
             autocorr =       1.136751413117
              std dev =       0.567178902288
             le_variance =       0.321691907201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321588842618
                                         uncertainty =       0.003174882183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321588842618
                                         uncertainty =       0.003174882183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401052197
  error estimate for blocks of size 2^( 2) =       0.000410183598
  error estimate for blocks of size 2^( 3) =       0.000418185217
  error estimate for blocks of size 2^( 4) =       0.000423734562
  error estimate for blocks of size 2^( 5) =       0.000427743729
  error estimate for blocks of size 2^( 6) =       0.000429495520
  error estimate for blocks of size 2^( 7) =       0.000429413834

      target function =                  N/A
              le_mean =     -17.217103348961
             les_mean =     296.750333297995
             stat err =       0.000427596911
             autocorr =       1.136756165393
              std dev =       0.567173456744
             le_variance =       0.321685730035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217103361417        initial  <--
     2.3283e+00     2.3283e+01             4.3547e-05       -17.217103163029
     9.3132e+00     9.3132e+01             1.1259e-05       -17.217103267841
     3.7253e+01     3.7253e+02             2.8637e-06       -17.217103348961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4612
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.928398e-01 1 1  ON 0
 uu_1                 3.057085e-02 1 1  ON 1
 uu_2                -6.413230e-02 1 1  ON 2
 uu_3                -1.204923e-01 1 1  ON 3
 uu_4                -1.568983e-01 1 1  ON 4
 uu_5                -1.689341e-01 1 1  ON 5
 uu_6                -1.568262e-01 1 1  ON 6
 uu_7                -1.108377e-01 1 1  ON 7
 uu_8                -3.889953e-02 1 1  ON 8
 uu_9                 2.004311e-01 1 1  ON 9
 ud_0                 3.550225e-01 1 1  ON 10
 ud_1                 9.645352e-02 1 1  ON 11
 ud_2                -1.337997e-02 1 1  ON 12
 ud_3                -7.571014e-02 1 1  ON 13
 ud_4                -1.263669e-01 1 1  ON 14
 ud_5                -1.634634e-01 1 1  ON 15
 ud_6                -1.764458e-01 1 1  ON 16
 ud_7                -1.580549e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123425e-02 1 1  ON 19
 eO_0                -9.199301e-01 1 1  ON 20
 eO_1                -5.983011e-01 1 1  ON 21
 eO_2                -1.845925e-01 1 1  ON 22
 eO_3                 8.635409e-02 1 1  ON 23
 eO_4                 2.107018e-01 1 1  ON 24
 eO_5                 2.973266e-01 1 1  ON 25
 eO_6                 3.254084e-01 1 1  ON 26
 eO_7                 5.314951e-01 1 1  ON 27
 eO_8                 1.587301e-01 1 1  ON 28
 eO_9                 5.350452e-02 1 1  ON 29
eH1_0                -2.219338e-01 1 1  ON 30
eH1_1                -1.427892e-01 1 1  ON 31
eH1_2                -1.013112e-01 1 1  ON 32
eH1_3                -6.372497e-02 1 1  ON 33
eH1_4                -1.728189e-02 1 1  ON 34
eH1_5                -4.606320e-03 1 1  ON 35
eH1_6                 3.629039e-02 1 1  ON 36
eH1_7                 7.664217e-02 1 1  ON 37
eH1_8                 2.631794e-01 1 1  ON 38
eH1_9                 1.137729e-01 1 1  ON 39
eH2_0                -2.112319e-01 1 1  ON 40
eH2_1                -1.323269e-01 1 1  ON 41
eH2_2                -9.059597e-02 1 1  ON 42
eH2_3                -5.301830e-02 1 1  ON 43
eH2_4                -6.432910e-03 1 1  ON 44
eH2_5                 5.481749e-03 1 1  ON 45
eH2_6                 4.753441e-02 1 1  ON 46
eH2_7                 4.076158e-02 1 1  ON 47
eH2_8                 2.470855e-01 1 1  ON 48
eH2_9                 1.154409e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2847
    reference variance = 0.285209
====================================================
  Execution time = 2.1099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1594e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316064821112
                                         uncertainty =       0.003610132175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316064821112
                                         uncertainty =       0.003610132175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397451373
  error estimate for blocks of size 2^( 2) =       0.000406937625
  error estimate for blocks of size 2^( 3) =       0.000415455547
  error estimate for blocks of size 2^( 4) =       0.000422541162
  error estimate for blocks of size 2^( 5) =       0.000426176095
  error estimate for blocks of size 2^( 6) =       0.000428558553
  error estimate for blocks of size 2^( 7) =       0.000430090660

      target function =                  N/A
              le_mean =     -17.216449081767
             les_mean =     296.722054014396
             stat err =       0.000426841617
             autocorr =       1.153361661787
              std dev =       0.562081121622
             le_variance =       0.315935187284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644908177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449081767       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449084442       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449068802       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449067080       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449080364       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449074069       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 8.211517e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449081767       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449082440       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449078489       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449078018       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449081303       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449079757       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.060522e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449081767       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449081936       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449080945       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449080825       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449081644       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449081259       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.156070e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6704e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.928410e-01 1 1  ON 0
 uu_1                 3.057028e-02 1 1  ON 1
 uu_2                -6.413294e-02 1 1  ON 2
 uu_3                -1.204923e-01 1 1  ON 3
 uu_4                -1.568977e-01 1 1  ON 4
 uu_5                -1.689344e-01 1 1  ON 5
 uu_6                -1.568270e-01 1 1  ON 6
 uu_7                -1.108381e-01 1 1  ON 7
 uu_8                -3.889935e-02 1 1  ON 8
 uu_9                 2.004309e-01 1 1  ON 9
 ud_0                 3.550238e-01 1 1  ON 10
 ud_1                 9.645385e-02 1 1  ON 11
 ud_2                -1.337959e-02 1 1  ON 12
 ud_3                -7.571069e-02 1 1  ON 13
 ud_4                -1.263668e-01 1 1  ON 14
 ud_5                -1.634642e-01 1 1  ON 15
 ud_6                -1.764471e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123413e-02 1 1  ON 19
 eO_0                -9.199307e-01 1 1  ON 20
 eO_1                -5.983017e-01 1 1  ON 21
 eO_2                -1.845920e-01 1 1  ON 22
 eO_3                 8.635322e-02 1 1  ON 23
 eO_4                 2.107038e-01 1 1  ON 24
 eO_5                 2.973266e-01 1 1  ON 25
 eO_6                 3.254078e-01 1 1  ON 26
 eO_7                 5.314948e-01 1 1  ON 27
 eO_8                 1.587304e-01 1 1  ON 28
 eO_9                 5.350464e-02 1 1  ON 29
eH1_0                -2.219339e-01 1 1  ON 30
eH1_1                -1.427896e-01 1 1  ON 31
eH1_2                -1.013101e-01 1 1  ON 32
eH1_3                -6.372504e-02 1 1  ON 33
eH1_4                -1.728209e-02 1 1  ON 34
eH1_5                -4.606004e-03 1 1  ON 35
eH1_6                 3.629064e-02 1 1  ON 36
eH1_7                 7.664129e-02 1 1  ON 37
eH1_8                 2.631789e-01 1 1  ON 38
eH1_9                 1.137730e-01 1 1  ON 39
eH2_0                -2.112328e-01 1 1  ON 40
eH2_1                -1.323262e-01 1 1  ON 41
eH2_2                -9.059586e-02 1 1  ON 42
eH2_3                -5.301828e-02 1 1  ON 43
eH2_4                -6.433373e-03 1 1  ON 44
eH2_5                 5.482282e-03 1 1  ON 45
eH2_6                 4.753417e-02 1 1  ON 46
eH2_7                 4.076180e-02 1 1  ON 47
eH2_8                 2.470852e-01 1 1  ON 48
eH2_9                 1.154410e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.206
    reference variance = 0.215533
====================================================
  Execution time = 2.2466e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1157e-01
  Total weights = 2.0000e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311561849346
                                         uncertainty =       0.002499533312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311561849346
                                         uncertainty =       0.002499533312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394695782
  error estimate for blocks of size 2^( 2) =       0.000404111207
  error estimate for blocks of size 2^( 3) =       0.000412330393
  error estimate for blocks of size 2^( 4) =       0.000418144339
  error estimate for blocks of size 2^( 5) =       0.000422822965
  error estimate for blocks of size 2^( 6) =       0.000424327537
  error estimate for blocks of size 2^( 7) =       0.000425721011

      target function =                  N/A
              le_mean =     -17.216867900069
             les_mean =     296.732109652808
             stat err =       0.000422753963
             autocorr =       1.147229762169
              std dev =       0.558184127461
             le_variance =       0.311569520150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311565263047
                                         uncertainty =       0.002499580445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311565263047
                                         uncertainty =       0.002499580445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394697944
  error estimate for blocks of size 2^( 2) =       0.000404113300
  error estimate for blocks of size 2^( 3) =       0.000412332425
  error estimate for blocks of size 2^( 4) =       0.000418146381
  error estimate for blocks of size 2^( 5) =       0.000422825023
  error estimate for blocks of size 2^( 6) =       0.000424329624
  error estimate for blocks of size 2^( 7) =       0.000425723104

      target function =                  N/A
              le_mean =     -17.216867906282
             les_mean =     296.732113280695
             stat err =       0.000422756033
             autocorr =       1.147228426149
              std dev =       0.558187185548
             le_variance =       0.311572934110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311563571599
                                         uncertainty =       0.002499557087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311563571599
                                         uncertainty =       0.002499557087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394696873
  error estimate for blocks of size 2^( 2) =       0.000404112263
  error estimate for blocks of size 2^( 3) =       0.000412331418
  error estimate for blocks of size 2^( 4) =       0.000418145369
  error estimate for blocks of size 2^( 5) =       0.000422824003
  error estimate for blocks of size 2^( 6) =       0.000424328589
  error estimate for blocks of size 2^( 7) =       0.000425722067

      target function =                  N/A
              le_mean =     -17.216867903151
             les_mean =     296.732111481315
             stat err =       0.000422755007
             autocorr =       1.147229086616
              std dev =       0.558185670311
             le_variance =       0.311571242540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311562065091
                                         uncertainty =       0.002499536291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311562065091
                                         uncertainty =       0.002499536291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394695918
  error estimate for blocks of size 2^( 2) =       0.000404111339
  error estimate for blocks of size 2^( 3) =       0.000412330522
  error estimate for blocks of size 2^( 4) =       0.000418144468
  error estimate for blocks of size 2^( 5) =       0.000422823095
  error estimate for blocks of size 2^( 6) =       0.000424327669
  error estimate for blocks of size 2^( 7) =       0.000425721144

      target function =                  N/A
              le_mean =     -17.216867900451
             les_mean =     296.732109881712
             stat err =       0.000422754094
             autocorr =       1.147229677477
              std dev =       0.558184320733
             le_variance =       0.311569735912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216867900069        initial
     2.3283e+01     2.3283e+02             8.2115e-06       -17.216867906282  <--
     9.3132e+01     9.3132e+02             2.0605e-06       -17.216867903151
     3.7253e+02     3.7253e+03             5.1561e-07       -17.216867900451

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 3.2054e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.928445e-01 1 1  ON 0
 uu_1                 3.056858e-02 1 1  ON 1
 uu_2                -6.413484e-02 1 1  ON 2
 uu_3                -1.204924e-01 1 1  ON 3
 uu_4                -1.568959e-01 1 1  ON 4
 uu_5                -1.689351e-01 1 1  ON 5
 uu_6                -1.568293e-01 1 1  ON 6
 uu_7                -1.108394e-01 1 1  ON 7
 uu_8                -3.889880e-02 1 1  ON 8
 uu_9                 2.004304e-01 1 1  ON 9
 ud_0                 3.550276e-01 1 1  ON 10
 ud_1                 9.645482e-02 1 1  ON 11
 ud_2                -1.337845e-02 1 1  ON 12
 ud_3                -7.571230e-02 1 1  ON 13
 ud_4                -1.263663e-01 1 1  ON 14
 ud_5                -1.634667e-01 1 1  ON 15
 ud_6                -1.764509e-01 1 1  ON 16
 ud_7                -1.580558e-01 1 1  ON 17
 ud_8                -1.119629e-01 1 1  ON 18
 ud_9                 3.123377e-02 1 1  ON 19
 eO_0                -9.199327e-01 1 1  ON 20
 eO_1                -5.983034e-01 1 1  ON 21
 eO_2                -1.845905e-01 1 1  ON 22
 eO_3                 8.635061e-02 1 1  ON 23
 eO_4                 2.107100e-01 1 1  ON 24
 eO_5                 2.973265e-01 1 1  ON 25
 eO_6                 3.254061e-01 1 1  ON 26
 eO_7                 5.314936e-01 1 1  ON 27
 eO_8                 1.587311e-01 1 1  ON 28
 eO_9                 5.350499e-02 1 1  ON 29
eH1_0                -2.219342e-01 1 1  ON 30
eH1_1                -1.427907e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372524e-02 1 1  ON 33
eH1_4                -1.728267e-02 1 1  ON 34
eH1_5                -4.605062e-03 1 1  ON 35
eH1_6                 3.629140e-02 1 1  ON 36
eH1_7                 7.663867e-02 1 1  ON 37
eH1_8                 2.631776e-01 1 1  ON 38
eH1_9                 1.137732e-01 1 1  ON 39
eH2_0                -2.112352e-01 1 1  ON 40
eH2_1                -1.323242e-01 1 1  ON 41
eH2_2                -9.059553e-02 1 1  ON 42
eH2_3                -5.301821e-02 1 1  ON 43
eH2_4                -6.434755e-03 1 1  ON 44
eH2_5                 5.483873e-03 1 1  ON 45
eH2_6                 4.753346e-02 1 1  ON 46
eH2_7                 4.076245e-02 1 1  ON 47
eH2_8                 2.470844e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.331597
====================================================
  Execution time = 2.0978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1684e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316888624992
                                         uncertainty =       0.002465769502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316888624992
                                         uncertainty =       0.002465769502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398018415
  error estimate for blocks of size 2^( 2) =       0.000407328903
  error estimate for blocks of size 2^( 3) =       0.000415744466
  error estimate for blocks of size 2^( 4) =       0.000421488458
  error estimate for blocks of size 2^( 5) =       0.000425656357
  error estimate for blocks of size 2^( 6) =       0.000427517339
  error estimate for blocks of size 2^( 7) =       0.000428284638

      target function =                  N/A
              le_mean =     -17.216339408596
             les_mean =     296.719179791291
             stat err =       0.000425736698
             autocorr =       1.144131236588
              std dev =       0.562883040904
             le_variance =       0.316837317737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633940860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339408596       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339475236       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339623283       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216339644493       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216339684689       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216339706523       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216339713693       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.256016e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339408596       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339425738       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339464502       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216339470954       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216339481769       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216339486944       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 5.762293e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339408596       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339412913       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339422720       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216339424412       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216339427171       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216339428447       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.460038e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6561e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.928490e-01 1 1  ON 0
 uu_1                 3.056772e-02 1 1  ON 1
 uu_2                -6.414025e-02 1 1  ON 2
 uu_3                -1.204933e-01 1 1  ON 3
 uu_4                -1.568977e-01 1 1  ON 4
 uu_5                -1.689302e-01 1 1  ON 5
 uu_6                -1.568284e-01 1 1  ON 6
 uu_7                -1.108403e-01 1 1  ON 7
 uu_8                -3.889892e-02 1 1  ON 8
 uu_9                 2.004293e-01 1 1  ON 9
 ud_0                 3.550272e-01 1 1  ON 10
 ud_1                 9.646059e-02 1 1  ON 11
 ud_2                -1.337734e-02 1 1  ON 12
 ud_3                -7.571114e-02 1 1  ON 13
 ud_4                -1.263647e-01 1 1  ON 14
 ud_5                -1.634690e-01 1 1  ON 15
 ud_6                -1.764556e-01 1 1  ON 16
 ud_7                -1.580568e-01 1 1  ON 17
 ud_8                -1.119639e-01 1 1  ON 18
 ud_9                 3.123260e-02 1 1  ON 19
 eO_0                -9.199356e-01 1 1  ON 20
 eO_1                -5.983032e-01 1 1  ON 21
 eO_2                -1.845892e-01 1 1  ON 22
 eO_3                 8.635037e-02 1 1  ON 23
 eO_4                 2.107146e-01 1 1  ON 24
 eO_5                 2.973252e-01 1 1  ON 25
 eO_6                 3.254049e-01 1 1  ON 26
 eO_7                 5.314924e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350515e-02 1 1  ON 29
eH1_0                -2.219355e-01 1 1  ON 30
eH1_1                -1.427901e-01 1 1  ON 31
eH1_2                -1.013040e-01 1 1  ON 32
eH1_3                -6.372246e-02 1 1  ON 33
eH1_4                -1.728506e-02 1 1  ON 34
eH1_5                -4.605291e-03 1 1  ON 35
eH1_6                 3.629156e-02 1 1  ON 36
eH1_7                 7.663690e-02 1 1  ON 37
eH1_8                 2.631768e-01 1 1  ON 38
eH1_9                 1.137736e-01 1 1  ON 39
eH2_0                -2.112375e-01 1 1  ON 40
eH2_1                -1.323230e-01 1 1  ON 41
eH2_2                -9.059547e-02 1 1  ON 42
eH2_3                -5.301735e-02 1 1  ON 43
eH2_4                -6.434350e-03 1 1  ON 44
eH2_5                 5.483017e-03 1 1  ON 45
eH2_6                 4.753274e-02 1 1  ON 46
eH2_7                 4.076454e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154411e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2359
    reference variance = 0.430017
====================================================
  Execution time = 2.0083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1663e-01
  Total weights = 2.0000e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613905556
                                         uncertainty =       0.003315967719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613905556
                                         uncertainty =       0.003315967719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397891118
  error estimate for blocks of size 2^( 2) =       0.000407504188
  error estimate for blocks of size 2^( 3) =       0.000416033723
  error estimate for blocks of size 2^( 4) =       0.000422740982
  error estimate for blocks of size 2^( 5) =       0.000426801252
  error estimate for blocks of size 2^( 6) =       0.000428594281
  error estimate for blocks of size 2^( 7) =       0.000428830911

      target function =                  N/A
              le_mean =     -17.217094701191
             les_mean =     296.744984475245
             stat err =       0.000426741856
             autocorr =       1.150275831521
              std dev =       0.562703015614
             le_variance =       0.316634683781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316614030681
                                         uncertainty =       0.003315862606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316614030681
                                         uncertainty =       0.003315862606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397891200
  error estimate for blocks of size 2^( 2) =       0.000407504277
  error estimate for blocks of size 2^( 3) =       0.000416033835
  error estimate for blocks of size 2^( 4) =       0.000422741375
  error estimate for blocks of size 2^( 5) =       0.000426801654
  error estimate for blocks of size 2^( 6) =       0.000428594766
  error estimate for blocks of size 2^( 7) =       0.000428830999

      target function =                  N/A
              le_mean =     -17.217094593184
             les_mean =     296.744980887026
             stat err =       0.000426742199
             autocorr =       1.150277200552
              std dev =       0.562703131952
             le_variance =       0.316634814709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613377355
                                         uncertainty =       0.003315906658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613377355
                                         uncertainty =       0.003315906658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397890788
  error estimate for blocks of size 2^( 2) =       0.000407503877
  error estimate for blocks of size 2^( 3) =       0.000416033429
  error estimate for blocks of size 2^( 4) =       0.000422740847
  error estimate for blocks of size 2^( 5) =       0.000426801136
  error estimate for blocks of size 2^( 6) =       0.000428594228
  error estimate for blocks of size 2^( 7) =       0.000428830652

      target function =                  N/A
              le_mean =     -17.217094642129
             les_mean =     296.744981916750
             stat err =       0.000426741716
             autocorr =       1.150276978569
              std dev =       0.562702549334
             le_variance =       0.316634159027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613835440
                                         uncertainty =       0.003315959985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316613835440
                                         uncertainty =       0.003315959985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397891074
  error estimate for blocks of size 2^( 2) =       0.000407504147
  error estimate for blocks of size 2^( 3) =       0.000416033683
  error estimate for blocks of size 2^( 4) =       0.000422740963
  error estimate for blocks of size 2^( 5) =       0.000426801236
  error estimate for blocks of size 2^( 6) =       0.000428594272
  error estimate for blocks of size 2^( 7) =       0.000428830876

      target function =                  N/A
              le_mean =     -17.217094693639
             les_mean =     296.744984145529
             stat err =       0.000426741837
             autocorr =       1.150275978667
              std dev =       0.562702953699
             le_variance =       0.316634614101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217094701191        initial  <--
     5.8208e+00     5.8208e+01             2.2560e-05       -17.217094593184
     2.3283e+01     2.3283e+02             5.7623e-06       -17.217094642129
     9.3132e+01     9.3132e+02             1.4600e-06       -17.217094693639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6133
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.928445e-01 1 1  ON 0
 uu_1                 3.056858e-02 1 1  ON 1
 uu_2                -6.413484e-02 1 1  ON 2
 uu_3                -1.204924e-01 1 1  ON 3
 uu_4                -1.568959e-01 1 1  ON 4
 uu_5                -1.689351e-01 1 1  ON 5
 uu_6                -1.568293e-01 1 1  ON 6
 uu_7                -1.108394e-01 1 1  ON 7
 uu_8                -3.889880e-02 1 1  ON 8
 uu_9                 2.004304e-01 1 1  ON 9
 ud_0                 3.550276e-01 1 1  ON 10
 ud_1                 9.645482e-02 1 1  ON 11
 ud_2                -1.337845e-02 1 1  ON 12
 ud_3                -7.571230e-02 1 1  ON 13
 ud_4                -1.263663e-01 1 1  ON 14
 ud_5                -1.634667e-01 1 1  ON 15
 ud_6                -1.764509e-01 1 1  ON 16
 ud_7                -1.580558e-01 1 1  ON 17
 ud_8                -1.119629e-01 1 1  ON 18
 ud_9                 3.123377e-02 1 1  ON 19
 eO_0                -9.199327e-01 1 1  ON 20
 eO_1                -5.983034e-01 1 1  ON 21
 eO_2                -1.845905e-01 1 1  ON 22
 eO_3                 8.635061e-02 1 1  ON 23
 eO_4                 2.107100e-01 1 1  ON 24
 eO_5                 2.973265e-01 1 1  ON 25
 eO_6                 3.254061e-01 1 1  ON 26
 eO_7                 5.314936e-01 1 1  ON 27
 eO_8                 1.587311e-01 1 1  ON 28
 eO_9                 5.350499e-02 1 1  ON 29
eH1_0                -2.219342e-01 1 1  ON 30
eH1_1                -1.427907e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372524e-02 1 1  ON 33
eH1_4                -1.728267e-02 1 1  ON 34
eH1_5                -4.605062e-03 1 1  ON 35
eH1_6                 3.629140e-02 1 1  ON 36
eH1_7                 7.663867e-02 1 1  ON 37
eH1_8                 2.631776e-01 1 1  ON 38
eH1_9                 1.137732e-01 1 1  ON 39
eH2_0                -2.112352e-01 1 1  ON 40
eH2_1                -1.323242e-01 1 1  ON 41
eH2_2                -9.059553e-02 1 1  ON 42
eH2_3                -5.301821e-02 1 1  ON 43
eH2_4                -6.434755e-03 1 1  ON 44
eH2_5                 5.483873e-03 1 1  ON 45
eH2_6                 4.753346e-02 1 1  ON 46
eH2_7                 4.076245e-02 1 1  ON 47
eH2_8                 2.470844e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1687
    reference variance = 0.301879
====================================================
  Execution time = 2.1049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2515e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325182086725
                                         uncertainty =       0.004346714220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325182086725
                                         uncertainty =       0.004346714220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403202928
  error estimate for blocks of size 2^( 2) =       0.000412302554
  error estimate for blocks of size 2^( 3) =       0.000420818250
  error estimate for blocks of size 2^( 4) =       0.000426504301
  error estimate for blocks of size 2^( 5) =       0.000430239583
  error estimate for blocks of size 2^( 6) =       0.000431347180
  error estimate for blocks of size 2^( 7) =       0.000431737889

      target function =                  N/A
              le_mean =     -17.217103042207
             les_mean =     296.753782205995
             stat err =       0.000429957238
             autocorr =       1.137111820626
              std dev =       0.570215049431
             le_variance =       0.325145202597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710304221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217103042207       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217103041228       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217103036915       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217103036055       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217103036007       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217103036807       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217103037990       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.193654e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217103042207       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217103041961       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217103040880       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217103040662       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217103040650       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217103040852       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217103041144       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.992080e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217103042207       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217103042145       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217103041875       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217103041820       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217103041817       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217103041867       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217103041941       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.998515e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6548e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.928445e-01 1 1  ON 0
 uu_1                 3.056878e-02 1 1  ON 1
 uu_2                -6.413508e-02 1 1  ON 2
 uu_3                -1.204925e-01 1 1  ON 3
 uu_4                -1.568956e-01 1 1  ON 4
 uu_5                -1.689348e-01 1 1  ON 5
 uu_6                -1.568296e-01 1 1  ON 6
 uu_7                -1.108396e-01 1 1  ON 7
 uu_8                -3.889886e-02 1 1  ON 8
 uu_9                 2.004302e-01 1 1  ON 9
 ud_0                 3.550275e-01 1 1  ON 10
 ud_1                 9.645499e-02 1 1  ON 11
 ud_2                -1.337830e-02 1 1  ON 12
 ud_3                -7.571199e-02 1 1  ON 13
 ud_4                -1.263662e-01 1 1  ON 14
 ud_5                -1.634670e-01 1 1  ON 15
 ud_6                -1.764511e-01 1 1  ON 16
 ud_7                -1.580559e-01 1 1  ON 17
 ud_8                -1.119630e-01 1 1  ON 18
 ud_9                 3.123364e-02 1 1  ON 19
 eO_0                -9.199330e-01 1 1  ON 20
 eO_1                -5.983033e-01 1 1  ON 21
 eO_2                -1.845906e-01 1 1  ON 22
 eO_3                 8.635032e-02 1 1  ON 23
 eO_4                 2.107108e-01 1 1  ON 24
 eO_5                 2.973266e-01 1 1  ON 25
 eO_6                 3.254060e-01 1 1  ON 26
 eO_7                 5.314934e-01 1 1  ON 27
 eO_8                 1.587311e-01 1 1  ON 28
 eO_9                 5.350501e-02 1 1  ON 29
eH1_0                -2.219340e-01 1 1  ON 30
eH1_1                -1.427902e-01 1 1  ON 31
eH1_2                -1.013065e-01 1 1  ON 32
eH1_3                -6.372541e-02 1 1  ON 33
eH1_4                -1.728319e-02 1 1  ON 34
eH1_5                -4.604935e-03 1 1  ON 35
eH1_6                 3.629155e-02 1 1  ON 36
eH1_7                 7.663842e-02 1 1  ON 37
eH1_8                 2.631774e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112351e-01 1 1  ON 40
eH2_1                -1.323241e-01 1 1  ON 41
eH2_2                -9.059543e-02 1 1  ON 42
eH2_3                -5.301829e-02 1 1  ON 43
eH2_4                -6.435157e-03 1 1  ON 44
eH2_5                 5.483937e-03 1 1  ON 45
eH2_6                 4.753357e-02 1 1  ON 46
eH2_7                 4.076251e-02 1 1  ON 47
eH2_8                 2.470843e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.18754
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2468e-01
  Total weights = 2.0000e+06
  Execution time = 1.8818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853110497
                                         uncertainty =       0.006750941204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853110497
                                         uncertainty =       0.006750941204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916523
  error estimate for blocks of size 2^( 2) =       0.000412501955
  error estimate for blocks of size 2^( 3) =       0.000420426274
  error estimate for blocks of size 2^( 4) =       0.000426981913
  error estimate for blocks of size 2^( 5) =       0.000431106938
  error estimate for blocks of size 2^( 6) =       0.000433748542
  error estimate for blocks of size 2^( 7) =       0.000435153841

      target function =                  N/A
              le_mean =     -17.216981170852
             les_mean =     296.749123923984
             stat err =       0.000431747808
             autocorr =       1.148233276275
              std dev =       0.569810011181
             le_variance =       0.324683448843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853048451
                                         uncertainty =       0.006750939613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853048451
                                         uncertainty =       0.006750939613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916484
  error estimate for blocks of size 2^( 2) =       0.000412501935
  error estimate for blocks of size 2^( 3) =       0.000420426259
  error estimate for blocks of size 2^( 4) =       0.000426981896
  error estimate for blocks of size 2^( 5) =       0.000431106937
  error estimate for blocks of size 2^( 6) =       0.000433748532
  error estimate for blocks of size 2^( 7) =       0.000435153817

      target function =                  N/A
              le_mean =     -17.216981178532
             les_mean =     296.749124125866
             stat err =       0.000431747795
             autocorr =       1.148233427149
              std dev =       0.569809956275
             le_variance =       0.324683386270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853078466
                                         uncertainty =       0.006750940361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853078466
                                         uncertainty =       0.006750940361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916503
  error estimate for blocks of size 2^( 2) =       0.000412501944
  error estimate for blocks of size 2^( 3) =       0.000420426266
  error estimate for blocks of size 2^( 4) =       0.000426981904
  error estimate for blocks of size 2^( 5) =       0.000431106937
  error estimate for blocks of size 2^( 6) =       0.000433748536
  error estimate for blocks of size 2^( 7) =       0.000435153828

      target function =                  N/A
              le_mean =     -17.216981174696
             les_mean =     296.749124024038
             stat err =       0.000431747801
             autocorr =       1.148233352427
              std dev =       0.569809982843
             le_variance =       0.324683416548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853106459
                                         uncertainty =       0.006750941097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853106459
                                         uncertainty =       0.006750941097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916520
  error estimate for blocks of size 2^( 2) =       0.000412501953
  error estimate for blocks of size 2^( 3) =       0.000420426273
  error estimate for blocks of size 2^( 4) =       0.000426981912
  error estimate for blocks of size 2^( 5) =       0.000431106937
  error estimate for blocks of size 2^( 6) =       0.000433748541
  error estimate for blocks of size 2^( 7) =       0.000435153839

      target function =                  N/A
              le_mean =     -17.216981171332
             les_mean =     296.749123936445
             stat err =       0.000431747808
             autocorr =       1.148233285813
              std dev =       0.569810007609
             le_variance =       0.324683444772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216981170852        initial
     5.8208e+01     5.8208e+02             3.1937e-06       -17.216981178532  <--
     2.3283e+02     2.3283e+03             7.9921e-07       -17.216981174696
     9.3132e+02     9.3132e+03             1.9985e-07       -17.216981171332

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 3.0028e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.928446e-01 1 1  ON 0
 uu_1                 3.056938e-02 1 1  ON 1
 uu_2                -6.413580e-02 1 1  ON 2
 uu_3                -1.204928e-01 1 1  ON 3
 uu_4                -1.568946e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568303e-01 1 1  ON 6
 uu_7                -1.108402e-01 1 1  ON 7
 uu_8                -3.889904e-02 1 1  ON 8
 uu_9                 2.004297e-01 1 1  ON 9
 ud_0                 3.550273e-01 1 1  ON 10
 ud_1                 9.645547e-02 1 1  ON 11
 ud_2                -1.337787e-02 1 1  ON 12
 ud_3                -7.571108e-02 1 1  ON 13
 ud_4                -1.263658e-01 1 1  ON 14
 ud_5                -1.634678e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580563e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123325e-02 1 1  ON 19
 eO_0                -9.199339e-01 1 1  ON 20
 eO_1                -5.983032e-01 1 1  ON 21
 eO_2                -1.845908e-01 1 1  ON 22
 eO_3                 8.634945e-02 1 1  ON 23
 eO_4                 2.107132e-01 1 1  ON 24
 eO_5                 2.973267e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314928e-01 1 1  ON 27
 eO_8                 1.587313e-01 1 1  ON 28
 eO_9                 5.350506e-02 1 1  ON 29
eH1_0                -2.219334e-01 1 1  ON 30
eH1_1                -1.427886e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372593e-02 1 1  ON 33
eH1_4                -1.728476e-02 1 1  ON 34
eH1_5                -4.604555e-03 1 1  ON 35
eH1_6                 3.629200e-02 1 1  ON 36
eH1_7                 7.663766e-02 1 1  ON 37
eH1_8                 2.631769e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112350e-01 1 1  ON 40
eH2_1                -1.323236e-01 1 1  ON 41
eH2_2                -9.059515e-02 1 1  ON 42
eH2_3                -5.301854e-02 1 1  ON 43
eH2_4                -6.436360e-03 1 1  ON 44
eH2_5                 5.484128e-03 1 1  ON 45
eH2_6                 4.753391e-02 1 1  ON 46
eH2_7                 4.076267e-02 1 1  ON 47
eH2_8                 2.470840e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1923
    reference variance = 0.167742
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319936521498
                                         uncertainty =       0.003832110637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319936521498
                                         uncertainty =       0.003832110637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399896746
  error estimate for blocks of size 2^( 2) =       0.000409639260
  error estimate for blocks of size 2^( 3) =       0.000417845028
  error estimate for blocks of size 2^( 4) =       0.000424328852
  error estimate for blocks of size 2^( 5) =       0.000428336408
  error estimate for blocks of size 2^( 6) =       0.000429046558
  error estimate for blocks of size 2^( 7) =       0.000429671592

      target function =                  N/A
              le_mean =     -17.216754595637
             les_mean =     296.736473461866
             stat err =       0.000427845852
             autocorr =       1.144666337999
              std dev =       0.565539402173
             le_variance =       0.319834815410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675459564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216754595637       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216754610598       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216754655818       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216754641566       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216754631040       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216754634969       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216754636463       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 8.935730e-06

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216754595637       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216754599409       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216754610908       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216754607307       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216754604698       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216754605641       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216754605973       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.260108e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216754595637       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216754596582       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216754599469       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216754598566       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216754597916       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216754598149       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216754598229       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 5.667013e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6048e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.928453e-01 1 1  ON 0
 uu_1                 3.056809e-02 1 1  ON 1
 uu_2                -6.413600e-02 1 1  ON 2
 uu_3                -1.204934e-01 1 1  ON 3
 uu_4                -1.568936e-01 1 1  ON 4
 uu_5                -1.689340e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889907e-02 1 1  ON 8
 uu_9                 2.004294e-01 1 1  ON 9
 ud_0                 3.550279e-01 1 1  ON 10
 ud_1                 9.645553e-02 1 1  ON 11
 ud_2                -1.337863e-02 1 1  ON 12
 ud_3                -7.571059e-02 1 1  ON 13
 ud_4                -1.263669e-01 1 1  ON 14
 ud_5                -1.634696e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580545e-01 1 1  ON 17
 ud_8                -1.119626e-01 1 1  ON 18
 ud_9                 3.123300e-02 1 1  ON 19
 eO_0                -9.199339e-01 1 1  ON 20
 eO_1                -5.983055e-01 1 1  ON 21
 eO_2                -1.845908e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107148e-01 1 1  ON 24
 eO_5                 2.973278e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587317e-01 1 1  ON 28
 eO_9                 5.350520e-02 1 1  ON 29
eH1_0                -2.219346e-01 1 1  ON 30
eH1_1                -1.427890e-01 1 1  ON 31
eH1_2                -1.013065e-01 1 1  ON 32
eH1_3                -6.372596e-02 1 1  ON 33
eH1_4                -1.728546e-02 1 1  ON 34
eH1_5                -4.602937e-03 1 1  ON 35
eH1_6                 3.629357e-02 1 1  ON 36
eH1_7                 7.663713e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112337e-01 1 1  ON 40
eH2_1                -1.323221e-01 1 1  ON 41
eH2_2                -9.059401e-02 1 1  ON 42
eH2_3                -5.301912e-02 1 1  ON 43
eH2_4                -6.437213e-03 1 1  ON 44
eH2_5                 5.482180e-03 1 1  ON 45
eH2_6                 4.753275e-02 1 1  ON 46
eH2_7                 4.076354e-02 1 1  ON 47
eH2_8                 2.470837e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2718
    reference variance = 0.268498
====================================================
  Execution time = 2.0437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315388857033
                                         uncertainty =       0.002717727745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315388857033
                                         uncertainty =       0.002717727745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397053034
  error estimate for blocks of size 2^( 2) =       0.000406480109
  error estimate for blocks of size 2^( 3) =       0.000414750347
  error estimate for blocks of size 2^( 4) =       0.000420775344
  error estimate for blocks of size 2^( 5) =       0.000423908258
  error estimate for blocks of size 2^( 6) =       0.000426299433
  error estimate for blocks of size 2^( 7) =       0.000427586647

      target function =                  N/A
              le_mean =     -17.216389181468
             les_mean =     296.719358514470
             stat err =       0.000424642420
             autocorr =       1.143799004816
              std dev =       0.561517786323
             le_variance =       0.315302224357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315391096609
                                         uncertainty =       0.002717763119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315391096609
                                         uncertainty =       0.002717763119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397054445
  error estimate for blocks of size 2^( 2) =       0.000406481452
  error estimate for blocks of size 2^( 3) =       0.000414751680
  error estimate for blocks of size 2^( 4) =       0.000420776623
  error estimate for blocks of size 2^( 5) =       0.000423909565
  error estimate for blocks of size 2^( 6) =       0.000426300774
  error estimate for blocks of size 2^( 7) =       0.000427588076

      target function =                  N/A
              le_mean =     -17.216389164626
             les_mean =     296.719360174957
             stat err =       0.000424643760
             autocorr =       1.143798092350
              std dev =       0.561519781285
             le_variance =       0.315304464774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315390003271
                                         uncertainty =       0.002717745761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315390003271
                                         uncertainty =       0.002717745761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397053756
  error estimate for blocks of size 2^( 2) =       0.000406480796
  error estimate for blocks of size 2^( 3) =       0.000414751028
  error estimate for blocks of size 2^( 4) =       0.000420775998
  error estimate for blocks of size 2^( 5) =       0.000423908927
  error estimate for blocks of size 2^( 6) =       0.000426300119
  error estimate for blocks of size 2^( 7) =       0.000427587378

      target function =                  N/A
              le_mean =     -17.216389172476
             les_mean =     296.719359351520
             stat err =       0.000424643106
             autocorr =       1.143798535896
              std dev =       0.561518807362
             le_variance =       0.315303371021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315389001122
                                         uncertainty =       0.002717730008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315389001122
                                         uncertainty =       0.002717730008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397053125
  error estimate for blocks of size 2^( 2) =       0.000406480196
  error estimate for blocks of size 2^( 3) =       0.000414750432
  error estimate for blocks of size 2^( 4) =       0.000420775426
  error estimate for blocks of size 2^( 5) =       0.000423908342
  error estimate for blocks of size 2^( 6) =       0.000426299519
  error estimate for blocks of size 2^( 7) =       0.000427586739

      target function =                  N/A
              le_mean =     -17.216389180320
             les_mean =     296.719358619071
             stat err =       0.000424642507
             autocorr =       1.143798945771
              std dev =       0.561517914673
             le_variance =       0.315302368499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216389181468        initial  <--
     1.4552e+01     1.4552e+02             8.9357e-06       -17.216389164626
     5.8208e+01     5.8208e+02             2.2601e-06       -17.216389172476
     2.3283e+02     2.3283e+03             5.6670e-07       -17.216389180320

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9341
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.928446e-01 1 1  ON 0
 uu_1                 3.056938e-02 1 1  ON 1
 uu_2                -6.413580e-02 1 1  ON 2
 uu_3                -1.204928e-01 1 1  ON 3
 uu_4                -1.568946e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568303e-01 1 1  ON 6
 uu_7                -1.108402e-01 1 1  ON 7
 uu_8                -3.889904e-02 1 1  ON 8
 uu_9                 2.004297e-01 1 1  ON 9
 ud_0                 3.550273e-01 1 1  ON 10
 ud_1                 9.645547e-02 1 1  ON 11
 ud_2                -1.337787e-02 1 1  ON 12
 ud_3                -7.571108e-02 1 1  ON 13
 ud_4                -1.263658e-01 1 1  ON 14
 ud_5                -1.634678e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580563e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123325e-02 1 1  ON 19
 eO_0                -9.199339e-01 1 1  ON 20
 eO_1                -5.983032e-01 1 1  ON 21
 eO_2                -1.845908e-01 1 1  ON 22
 eO_3                 8.634945e-02 1 1  ON 23
 eO_4                 2.107132e-01 1 1  ON 24
 eO_5                 2.973267e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314928e-01 1 1  ON 27
 eO_8                 1.587313e-01 1 1  ON 28
 eO_9                 5.350506e-02 1 1  ON 29
eH1_0                -2.219334e-01 1 1  ON 30
eH1_1                -1.427886e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372593e-02 1 1  ON 33
eH1_4                -1.728476e-02 1 1  ON 34
eH1_5                -4.604555e-03 1 1  ON 35
eH1_6                 3.629200e-02 1 1  ON 36
eH1_7                 7.663766e-02 1 1  ON 37
eH1_8                 2.631769e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112350e-01 1 1  ON 40
eH2_1                -1.323236e-01 1 1  ON 41
eH2_2                -9.059515e-02 1 1  ON 42
eH2_3                -5.301854e-02 1 1  ON 43
eH2_4                -6.436360e-03 1 1  ON 44
eH2_5                 5.484128e-03 1 1  ON 45
eH2_6                 4.753391e-02 1 1  ON 46
eH2_7                 4.076267e-02 1 1  ON 47
eH2_8                 2.470840e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2676
    reference variance = 0.187523
====================================================
  Execution time = 2.0797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315432484804
                                         uncertainty =       0.002734183253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315432484804
                                         uncertainty =       0.002734183253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397117850
  error estimate for blocks of size 2^( 2) =       0.000406906450
  error estimate for blocks of size 2^( 3) =       0.000415272529
  error estimate for blocks of size 2^( 4) =       0.000421168616
  error estimate for blocks of size 2^( 5) =       0.000425362155
  error estimate for blocks of size 2^( 6) =       0.000426777015
  error estimate for blocks of size 2^( 7) =       0.000426440501

      target function =                  N/A
              le_mean =     -17.217618581467
             les_mean =     296.761794632534
             stat err =       0.000424937072
             autocorr =       1.145013019750
              std dev =       0.561609449145
             le_variance =       0.315405173369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721761858147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217618581467       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217618581244       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217618578718       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217618578596       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217618579200       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217618578693       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.069643e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217618581467       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217618581411       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217618580778       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217618580747       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217618580898       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217618580770       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 2.676052e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217618581467       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217618581453       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217618581294       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217618581287       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217618581322       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217618581294       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 6.691351e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6390e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.928447e-01 1 1  ON 0
 uu_1                 3.056940e-02 1 1  ON 1
 uu_2                -6.413580e-02 1 1  ON 2
 uu_3                -1.204928e-01 1 1  ON 3
 uu_4                -1.568946e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568304e-01 1 1  ON 6
 uu_7                -1.108403e-01 1 1  ON 7
 uu_8                -3.889902e-02 1 1  ON 8
 uu_9                 2.004296e-01 1 1  ON 9
 ud_0                 3.550272e-01 1 1  ON 10
 ud_1                 9.645563e-02 1 1  ON 11
 ud_2                -1.337797e-02 1 1  ON 12
 ud_3                -7.571094e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634679e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580562e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123324e-02 1 1  ON 19
 eO_0                -9.199342e-01 1 1  ON 20
 eO_1                -5.983031e-01 1 1  ON 21
 eO_2                -1.845909e-01 1 1  ON 22
 eO_3                 8.634933e-02 1 1  ON 23
 eO_4                 2.107135e-01 1 1  ON 24
 eO_5                 2.973268e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314927e-01 1 1  ON 27
 eO_8                 1.587313e-01 1 1  ON 28
 eO_9                 5.350507e-02 1 1  ON 29
eH1_0                -2.219334e-01 1 1  ON 30
eH1_1                -1.427886e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372595e-02 1 1  ON 33
eH1_4                -1.728476e-02 1 1  ON 34
eH1_5                -4.604436e-03 1 1  ON 35
eH1_6                 3.629200e-02 1 1  ON 36
eH1_7                 7.663757e-02 1 1  ON 37
eH1_8                 2.631769e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059524e-02 1 1  ON 42
eH2_3                -5.301852e-02 1 1  ON 43
eH2_4                -6.436465e-03 1 1  ON 44
eH2_5                 5.484121e-03 1 1  ON 45
eH2_6                 4.753390e-02 1 1  ON 46
eH2_7                 4.076274e-02 1 1  ON 47
eH2_8                 2.470839e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.173608
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2776e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862073951
                                         uncertainty =       0.012799392285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862073951
                                         uncertainty =       0.012799392285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404824094
  error estimate for blocks of size 2^( 2) =       0.000413947751
  error estimate for blocks of size 2^( 3) =       0.000422549196
  error estimate for blocks of size 2^( 4) =       0.000428225376
  error estimate for blocks of size 2^( 5) =       0.000432290965
  error estimate for blocks of size 2^( 6) =       0.000434287643
  error estimate for blocks of size 2^( 7) =       0.000434941590

      target function =                  N/A
              le_mean =     -17.216697237255
             les_mean =     296.742428689737
             stat err =       0.000432436393
             autocorr =       1.141068634919
              std dev =       0.572507724226
             le_variance =       0.327765094299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327861739452
                                         uncertainty =       0.012799370578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327861739452
                                         uncertainty =       0.012799370578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404823888
  error estimate for blocks of size 2^( 2) =       0.000413947548
  error estimate for blocks of size 2^( 3) =       0.000422548998
  error estimate for blocks of size 2^( 4) =       0.000428225163
  error estimate for blocks of size 2^( 5) =       0.000432290770
  error estimate for blocks of size 2^( 6) =       0.000434287440
  error estimate for blocks of size 2^( 7) =       0.000434941369

      target function =                  N/A
              le_mean =     -17.216697241304
             les_mean =     296.742428494899
             stat err =       0.000432436185
             autocorr =       1.141068699820
              std dev =       0.572507432303
             le_variance =       0.327764760042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327861906225
                                         uncertainty =       0.012799381409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327861906225
                                         uncertainty =       0.012799381409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404823991
  error estimate for blocks of size 2^( 2) =       0.000413947649
  error estimate for blocks of size 2^( 3) =       0.000422549097
  error estimate for blocks of size 2^( 4) =       0.000428225269
  error estimate for blocks of size 2^( 5) =       0.000432290867
  error estimate for blocks of size 2^( 6) =       0.000434287541
  error estimate for blocks of size 2^( 7) =       0.000434941479

      target function =                  N/A
              le_mean =     -17.216697239284
             les_mean =     296.742428591969
             stat err =       0.000432436289
             autocorr =       1.141068667358
              std dev =       0.572507577849
             le_variance =       0.327764926694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862052969
                                         uncertainty =       0.012799390925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327862052969
                                         uncertainty =       0.012799390925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404824081
  error estimate for blocks of size 2^( 2) =       0.000413947739
  error estimate for blocks of size 2^( 3) =       0.000422549184
  error estimate for blocks of size 2^( 4) =       0.000428225362
  error estimate for blocks of size 2^( 5) =       0.000432290952
  error estimate for blocks of size 2^( 6) =       0.000434287630
  error estimate for blocks of size 2^( 7) =       0.000434941576

      target function =                  N/A
              le_mean =     -17.216697237509
             les_mean =     296.742428677501
             stat err =       0.000432436380
             autocorr =       1.141068638967
              std dev =       0.572507705915
             le_variance =       0.327765073332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216697237255        initial
     1.4552e+02     1.4552e+03             1.0696e-06       -17.216697241304  <--
     5.8208e+02     5.8208e+03             2.6761e-07       -17.216697239284
     2.3283e+03     2.3283e+04             6.6914e-08       -17.216697237509

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.9638e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.928447e-01 1 1  ON 0
 uu_1                 3.056946e-02 1 1  ON 1
 uu_2                -6.413582e-02 1 1  ON 2
 uu_3                -1.204927e-01 1 1  ON 3
 uu_4                -1.568944e-01 1 1  ON 4
 uu_5                -1.689338e-01 1 1  ON 5
 uu_6                -1.568308e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889897e-02 1 1  ON 8
 uu_9                 2.004295e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645609e-02 1 1  ON 11
 ud_2                -1.337827e-02 1 1  ON 12
 ud_3                -7.571052e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634681e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580561e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123319e-02 1 1  ON 19
 eO_0                -9.199349e-01 1 1  ON 20
 eO_1                -5.983026e-01 1 1  ON 21
 eO_2                -1.845911e-01 1 1  ON 22
 eO_3                 8.634897e-02 1 1  ON 23
 eO_4                 2.107143e-01 1 1  ON 24
 eO_5                 2.973269e-01 1 1  ON 25
 eO_6                 3.254056e-01 1 1  ON 26
 eO_7                 5.314926e-01 1 1  ON 27
 eO_8                 1.587314e-01 1 1  ON 28
 eO_9                 5.350511e-02 1 1  ON 29
eH1_0                -2.219334e-01 1 1  ON 30
eH1_1                -1.427886e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372600e-02 1 1  ON 33
eH1_4                -1.728475e-02 1 1  ON 34
eH1_5                -4.604079e-03 1 1  ON 35
eH1_6                 3.629200e-02 1 1  ON 36
eH1_7                 7.663728e-02 1 1  ON 37
eH1_8                 2.631768e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112347e-01 1 1  ON 40
eH2_1                -1.323233e-01 1 1  ON 41
eH2_2                -9.059551e-02 1 1  ON 42
eH2_3                -5.301846e-02 1 1  ON 43
eH2_4                -6.436780e-03 1 1  ON 44
eH2_5                 5.484098e-03 1 1  ON 45
eH2_6                 4.753385e-02 1 1  ON 46
eH2_7                 4.076296e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6033e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2799
    reference variance = 0.697141
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1691e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316869251365
                                         uncertainty =       0.004592076544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316869251365
                                         uncertainty =       0.004592076544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398062238
  error estimate for blocks of size 2^( 2) =       0.000407420102
  error estimate for blocks of size 2^( 3) =       0.000415806157
  error estimate for blocks of size 2^( 4) =       0.000422300627
  error estimate for blocks of size 2^( 5) =       0.000426445390
  error estimate for blocks of size 2^( 6) =       0.000428156986
  error estimate for blocks of size 2^( 7) =       0.000430139623

      target function =                  N/A
              le_mean =     -17.217671691312
             les_mean =     296.765125401370
             stat err =       0.000426760657
             autocorr =       1.149388346143
              std dev =       0.562945015080
             le_variance =       0.316907090003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721767169131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217671691312       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217671697887       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217671718030       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217671724074       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217671723072       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217671717901       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 3.428512e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217671691312       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217671692962       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217671698035       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217671699572       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217671699328       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217671698032       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 8.624699e-07

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217671691312       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217671691725       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217671692996       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217671693382       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217671693321       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217671692997       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 2.159542e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6026e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.928444e-01 1 1  ON 0
 uu_1                 3.056908e-02 1 1  ON 1
 uu_2                -6.413583e-02 1 1  ON 2
 uu_3                -1.204928e-01 1 1  ON 3
 uu_4                -1.568941e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568304e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889888e-02 1 1  ON 8
 uu_9                 2.004294e-01 1 1  ON 9
 ud_0                 3.550258e-01 1 1  ON 10
 ud_1                 9.645601e-02 1 1  ON 11
 ud_2                -1.337777e-02 1 1  ON 12
 ud_3                -7.571089e-02 1 1  ON 13
 ud_4                -1.263653e-01 1 1  ON 14
 ud_5                -1.634687e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580556e-01 1 1  ON 17
 ud_8                -1.119631e-01 1 1  ON 18
 ud_9                 3.123309e-02 1 1  ON 19
 eO_0                -9.199354e-01 1 1  ON 20
 eO_1                -5.983031e-01 1 1  ON 21
 eO_2                -1.845911e-01 1 1  ON 22
 eO_3                 8.634896e-02 1 1  ON 23
 eO_4                 2.107148e-01 1 1  ON 24
 eO_5                 2.973272e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314924e-01 1 1  ON 27
 eO_8                 1.587315e-01 1 1  ON 28
 eO_9                 5.350513e-02 1 1  ON 29
eH1_0                -2.219339e-01 1 1  ON 30
eH1_1                -1.427891e-01 1 1  ON 31
eH1_2                -1.013054e-01 1 1  ON 32
eH1_3                -6.372608e-02 1 1  ON 33
eH1_4                -1.728471e-02 1 1  ON 34
eH1_5                -4.603822e-03 1 1  ON 35
eH1_6                 3.629227e-02 1 1  ON 36
eH1_7                 7.663713e-02 1 1  ON 37
eH1_8                 2.631767e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112348e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059515e-02 1 1  ON 42
eH2_3                -5.301851e-02 1 1  ON 43
eH2_4                -6.436513e-03 1 1  ON 44
eH2_5                 5.483702e-03 1 1  ON 45
eH2_6                 4.753365e-02 1 1  ON 46
eH2_7                 4.076323e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154414e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2242
    reference variance = 0.316045
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2012e-01
  Total weights = 2.0000e+06
  Execution time = 1.8912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168112206
                                         uncertainty =       0.004765544824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168112206
                                         uncertainty =       0.004765544824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400079031
  error estimate for blocks of size 2^( 2) =       0.000409272690
  error estimate for blocks of size 2^( 3) =       0.000417835617
  error estimate for blocks of size 2^( 4) =       0.000423720961
  error estimate for blocks of size 2^( 5) =       0.000427440566
  error estimate for blocks of size 2^( 6) =       0.000429995580
  error estimate for blocks of size 2^( 7) =       0.000431288657

      target function =                  N/A
              le_mean =     -17.217001421356
             les_mean =     296.745264244778
             stat err =       0.000428111441
             autocorr =       1.145043773239
              std dev =       0.565797191452
             le_variance =       0.320126461855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162942664
                                         uncertainty =       0.004765472488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162942664
                                         uncertainty =       0.004765472488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400075800
  error estimate for blocks of size 2^( 2) =       0.000409269631
  error estimate for blocks of size 2^( 3) =       0.000417832746
  error estimate for blocks of size 2^( 4) =       0.000423718174
  error estimate for blocks of size 2^( 5) =       0.000427437809
  error estimate for blocks of size 2^( 6) =       0.000429992895
  error estimate for blocks of size 2^( 7) =       0.000431286126

      target function =                  N/A
              le_mean =     -17.217001382926
             les_mean =     296.745257751463
             stat err =       0.000428108751
             autocorr =       1.145047876279
              std dev =       0.565792622640
             le_variance =       0.320121291834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320165506762
                                         uncertainty =       0.004765508443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320165506762
                                         uncertainty =       0.004765508443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400077403
  error estimate for blocks of size 2^( 2) =       0.000409271148
  error estimate for blocks of size 2^( 3) =       0.000417834170
  error estimate for blocks of size 2^( 4) =       0.000423719556
  error estimate for blocks of size 2^( 5) =       0.000427439177
  error estimate for blocks of size 2^( 6) =       0.000429994227
  error estimate for blocks of size 2^( 7) =       0.000431287381

      target function =                  N/A
              le_mean =     -17.217001401990
             les_mean =     296.745260972241
             stat err =       0.000428110085
             autocorr =       1.145045842336
              std dev =       0.565794888777
             le_variance =       0.320123856166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320167785858
                                         uncertainty =       0.004765540270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320167785858
                                         uncertainty =       0.004765540270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400078827
  error estimate for blocks of size 2^( 2) =       0.000409272497
  error estimate for blocks of size 2^( 3) =       0.000417835436
  error estimate for blocks of size 2^( 4) =       0.000423720785
  error estimate for blocks of size 2^( 5) =       0.000427440392
  error estimate for blocks of size 2^( 6) =       0.000429995410
  error estimate for blocks of size 2^( 7) =       0.000431288497

      target function =                  N/A
              le_mean =     -17.217001418929
             les_mean =     296.745263834818
             stat err =       0.000428111271
             autocorr =       1.145044032427
              std dev =       0.565796903028
             le_variance =       0.320126135476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217001421356        initial  <--
     3.6380e+01     3.6380e+02             3.4285e-06       -17.217001382926
     1.4552e+02     1.4552e+03             8.6247e-07       -17.217001401990
     5.8208e+02     5.8208e+03             2.1595e-07       -17.217001418929

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8264
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.928447e-01 1 1  ON 0
 uu_1                 3.056946e-02 1 1  ON 1
 uu_2                -6.413582e-02 1 1  ON 2
 uu_3                -1.204927e-01 1 1  ON 3
 uu_4                -1.568944e-01 1 1  ON 4
 uu_5                -1.689338e-01 1 1  ON 5
 uu_6                -1.568308e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889897e-02 1 1  ON 8
 uu_9                 2.004295e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645609e-02 1 1  ON 11
 ud_2                -1.337827e-02 1 1  ON 12
 ud_3                -7.571052e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634681e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580561e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123319e-02 1 1  ON 19
 eO_0                -9.199349e-01 1 1  ON 20
 eO_1                -5.983026e-01 1 1  ON 21
 eO_2                -1.845911e-01 1 1  ON 22
 eO_3                 8.634897e-02 1 1  ON 23
 eO_4                 2.107143e-01 1 1  ON 24
 eO_5                 2.973269e-01 1 1  ON 25
 eO_6                 3.254056e-01 1 1  ON 26
 eO_7                 5.314926e-01 1 1  ON 27
 eO_8                 1.587314e-01 1 1  ON 28
 eO_9                 5.350511e-02 1 1  ON 29
eH1_0                -2.219334e-01 1 1  ON 30
eH1_1                -1.427886e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372600e-02 1 1  ON 33
eH1_4                -1.728475e-02 1 1  ON 34
eH1_5                -4.604079e-03 1 1  ON 35
eH1_6                 3.629200e-02 1 1  ON 36
eH1_7                 7.663728e-02 1 1  ON 37
eH1_8                 2.631768e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112347e-01 1 1  ON 40
eH2_1                -1.323233e-01 1 1  ON 41
eH2_2                -9.059551e-02 1 1  ON 42
eH2_3                -5.301846e-02 1 1  ON 43
eH2_4                -6.436780e-03 1 1  ON 44
eH2_5                 5.484098e-03 1 1  ON 45
eH2_6                 4.753385e-02 1 1  ON 46
eH2_7                 4.076296e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5858e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.172921
====================================================
  Execution time = 2.2518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316986827000
                                         uncertainty =       0.003835177828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316986827000
                                         uncertainty =       0.003835177828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398165493
  error estimate for blocks of size 2^( 2) =       0.000407516087
  error estimate for blocks of size 2^( 3) =       0.000415862870
  error estimate for blocks of size 2^( 4) =       0.000421604694
  error estimate for blocks of size 2^( 5) =       0.000424829235
  error estimate for blocks of size 2^( 6) =       0.000426431848
  error estimate for blocks of size 2^( 7) =       0.000426719392

      target function =                  N/A
              le_mean =     -17.215951426328
             les_mean =     296.706054874876
             stat err =       0.000424896292
             autocorr =       1.138776887539
              std dev =       0.563091040345
             le_variance =       0.317071519717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595142633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951426328       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951427074       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951426544       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951425715       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951425541       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951425439       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 3.401768e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951426328       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951426515       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951426382       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951426175       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951426131       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951426105       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 8.511189e-08

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951426328       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951426375       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951426342       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215951426290       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215951426279       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215951426272       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 2.128221e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8083e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.928448e-01 1 1  ON 0
 uu_1                 3.056949e-02 1 1  ON 1
 uu_2                -6.413584e-02 1 1  ON 2
 uu_3                -1.204927e-01 1 1  ON 3
 uu_4                -1.568944e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568308e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889897e-02 1 1  ON 8
 uu_9                 2.004295e-01 1 1  ON 9
 ud_0                 3.550267e-01 1 1  ON 10
 ud_1                 9.645607e-02 1 1  ON 11
 ud_2                -1.337828e-02 1 1  ON 12
 ud_3                -7.571056e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634680e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580561e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123317e-02 1 1  ON 19
 eO_0                -9.199349e-01 1 1  ON 20
 eO_1                -5.983027e-01 1 1  ON 21
 eO_2                -1.845911e-01 1 1  ON 22
 eO_3                 8.634896e-02 1 1  ON 23
 eO_4                 2.107143e-01 1 1  ON 24
 eO_5                 2.973270e-01 1 1  ON 25
 eO_6                 3.254056e-01 1 1  ON 26
 eO_7                 5.314926e-01 1 1  ON 27
 eO_8                 1.587314e-01 1 1  ON 28
 eO_9                 5.350511e-02 1 1  ON 29
eH1_0                -2.219333e-01 1 1  ON 30
eH1_1                -1.427887e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372597e-02 1 1  ON 33
eH1_4                -1.728475e-02 1 1  ON 34
eH1_5                -4.604045e-03 1 1  ON 35
eH1_6                 3.629202e-02 1 1  ON 36
eH1_7                 7.663724e-02 1 1  ON 37
eH1_8                 2.631768e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112347e-01 1 1  ON 40
eH2_1                -1.323233e-01 1 1  ON 41
eH2_2                -9.059544e-02 1 1  ON 42
eH2_3                -5.301849e-02 1 1  ON 43
eH2_4                -6.436790e-03 1 1  ON 44
eH2_5                 5.484041e-03 1 1  ON 45
eH2_6                 4.753383e-02 1 1  ON 46
eH2_7                 4.076300e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2401
    reference variance = 0.263949
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1754e-01
  Total weights = 2.0000e+06
  Execution time = 1.8668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569246118
                                         uncertainty =       0.003466885583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569246118
                                         uncertainty =       0.003466885583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398458934
  error estimate for blocks of size 2^( 2) =       0.000408150108
  error estimate for blocks of size 2^( 3) =       0.000416406326
  error estimate for blocks of size 2^( 4) =       0.000421958601
  error estimate for blocks of size 2^( 5) =       0.000425340765
  error estimate for blocks of size 2^( 6) =       0.000427605952
  error estimate for blocks of size 2^( 7) =       0.000428591458

      target function =                  N/A
              le_mean =     -17.217555510887
             les_mean =     296.761756656162
             stat err =       0.000425874194
             autocorr =       1.142340335614
              std dev =       0.563506028763
             le_variance =       0.317539044452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569427173
                                         uncertainty =       0.003466884658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569427173
                                         uncertainty =       0.003466884658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398459048
  error estimate for blocks of size 2^( 2) =       0.000408150218
  error estimate for blocks of size 2^( 3) =       0.000416406431
  error estimate for blocks of size 2^( 4) =       0.000421958702
  error estimate for blocks of size 2^( 5) =       0.000425340873
  error estimate for blocks of size 2^( 6) =       0.000427606064
  error estimate for blocks of size 2^( 7) =       0.000428591568

      target function =                  N/A
              le_mean =     -17.217555512734
             les_mean =     296.761756900997
             stat err =       0.000425874302
             autocorr =       1.142340261372
              std dev =       0.563506189587
             le_variance =       0.317539225703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569336713
                                         uncertainty =       0.003466885120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569336713
                                         uncertainty =       0.003466885120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398458991
  error estimate for blocks of size 2^( 2) =       0.000408150163
  error estimate for blocks of size 2^( 3) =       0.000416406378
  error estimate for blocks of size 2^( 4) =       0.000421958652
  error estimate for blocks of size 2^( 5) =       0.000425340819
  error estimate for blocks of size 2^( 6) =       0.000427606008
  error estimate for blocks of size 2^( 7) =       0.000428591513

      target function =                  N/A
              le_mean =     -17.217555511811
             les_mean =     296.761756778662
             stat err =       0.000425874248
             autocorr =       1.142340298464
              std dev =       0.563506109235
             le_variance =       0.317539135145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569257444
                                         uncertainty =       0.003466885525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569257444
                                         uncertainty =       0.003466885525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398458941
  error estimate for blocks of size 2^( 2) =       0.000408150115
  error estimate for blocks of size 2^( 3) =       0.000416406333
  error estimate for blocks of size 2^( 4) =       0.000421958608
  error estimate for blocks of size 2^( 5) =       0.000425340772
  error estimate for blocks of size 2^( 6) =       0.000427605959
  error estimate for blocks of size 2^( 7) =       0.000428591465

      target function =                  N/A
              le_mean =     -17.217555511003
             les_mean =     296.761756671476
             stat err =       0.000425874201
             autocorr =       1.142340330973
              std dev =       0.563506038824
             le_variance =       0.317539055791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217555510887        initial
     3.6380e+02     3.6380e+03             3.4018e-07       -17.217555512734  <--
     1.4552e+03     1.4552e+04             8.5112e-08       -17.217555511811
     5.8208e+03     5.8208e+04             2.1282e-08       -17.217555511003

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.9387e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.928450e-01 1 1  ON 0
 uu_1                 3.056958e-02 1 1  ON 1
 uu_2                -6.413591e-02 1 1  ON 2
 uu_3                -1.204928e-01 1 1  ON 3
 uu_4                -1.568945e-01 1 1  ON 4
 uu_5                -1.689339e-01 1 1  ON 5
 uu_6                -1.568308e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889898e-02 1 1  ON 8
 uu_9                 2.004294e-01 1 1  ON 9
 ud_0                 3.550268e-01 1 1  ON 10
 ud_1                 9.645602e-02 1 1  ON 11
 ud_2                -1.337831e-02 1 1  ON 12
 ud_3                -7.571069e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634680e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580561e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123312e-02 1 1  ON 19
 eO_0                -9.199349e-01 1 1  ON 20
 eO_1                -5.983030e-01 1 1  ON 21
 eO_2                -1.845910e-01 1 1  ON 22
 eO_3                 8.634892e-02 1 1  ON 23
 eO_4                 2.107144e-01 1 1  ON 24
 eO_5                 2.973271e-01 1 1  ON 25
 eO_6                 3.254056e-01 1 1  ON 26
 eO_7                 5.314925e-01 1 1  ON 27
 eO_8                 1.587315e-01 1 1  ON 28
 eO_9                 5.350512e-02 1 1  ON 29
eH1_0                -2.219332e-01 1 1  ON 30
eH1_1                -1.427889e-01 1 1  ON 31
eH1_2                -1.013061e-01 1 1  ON 32
eH1_3                -6.372590e-02 1 1  ON 33
eH1_4                -1.728476e-02 1 1  ON 34
eH1_5                -4.603943e-03 1 1  ON 35
eH1_6                 3.629207e-02 1 1  ON 36
eH1_7                 7.663713e-02 1 1  ON 37
eH1_8                 2.631767e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323232e-01 1 1  ON 41
eH2_2                -9.059521e-02 1 1  ON 42
eH2_3                -5.301857e-02 1 1  ON 43
eH2_4                -6.436822e-03 1 1  ON 44
eH2_5                 5.483870e-03 1 1  ON 45
eH2_6                 4.753378e-02 1 1  ON 46
eH2_7                 4.076311e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2776
    reference variance = 0.452857
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2662e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326655562237
                                         uncertainty =       0.008067737763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326655562237
                                         uncertainty =       0.008067737763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113807
  error estimate for blocks of size 2^( 2) =       0.000413641676
  error estimate for blocks of size 2^( 3) =       0.000421894865
  error estimate for blocks of size 2^( 4) =       0.000428366592
  error estimate for blocks of size 2^( 5) =       0.000431100838
  error estimate for blocks of size 2^( 6) =       0.000432538062
  error estimate for blocks of size 2^( 7) =       0.000432623602

      target function =                  N/A
              le_mean =     -17.216847198697
             les_mean =     296.746443238752
             stat err =       0.000431157274
             autocorr =       1.138319185598
              std dev =       0.571503227263
             le_variance =       0.326615938772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684719870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216847198697       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216847201148       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216847200900       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216847204740       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216847208434       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216847207843       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.428048e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216847198697       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216847199311       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216847199249       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216847200214       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216847201141       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216847200993       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 3.574011e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216847198697       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216847198851       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216847198835       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216847199077       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216847199309       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216847199272       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 8.937459e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6107e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.928452e-01 1 1  ON 0
 uu_1                 3.056955e-02 1 1  ON 1
 uu_2                -6.413587e-02 1 1  ON 2
 uu_3                -1.204929e-01 1 1  ON 3
 uu_4                -1.568947e-01 1 1  ON 4
 uu_5                -1.689340e-01 1 1  ON 5
 uu_6                -1.568306e-01 1 1  ON 6
 uu_7                -1.108406e-01 1 1  ON 7
 uu_8                -3.889896e-02 1 1  ON 8
 uu_9                 2.004293e-01 1 1  ON 9
 ud_0                 3.550267e-01 1 1  ON 10
 ud_1                 9.645596e-02 1 1  ON 11
 ud_2                -1.337806e-02 1 1  ON 12
 ud_3                -7.571068e-02 1 1  ON 13
 ud_4                -1.263659e-01 1 1  ON 14
 ud_5                -1.634683e-01 1 1  ON 15
 ud_6                -1.764517e-01 1 1  ON 16
 ud_7                -1.580558e-01 1 1  ON 17
 ud_8                -1.119633e-01 1 1  ON 18
 ud_9                 3.123302e-02 1 1  ON 19
 eO_0                -9.199349e-01 1 1  ON 20
 eO_1                -5.983032e-01 1 1  ON 21
 eO_2                -1.845912e-01 1 1  ON 22
 eO_3                 8.634898e-02 1 1  ON 23
 eO_4                 2.107146e-01 1 1  ON 24
 eO_5                 2.973272e-01 1 1  ON 25
 eO_6                 3.254056e-01 1 1  ON 26
 eO_7                 5.314924e-01 1 1  ON 27
 eO_8                 1.587315e-01 1 1  ON 28
 eO_9                 5.350512e-02 1 1  ON 29
eH1_0                -2.219331e-01 1 1  ON 30
eH1_1                -1.427890e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372586e-02 1 1  ON 33
eH1_4                -1.728473e-02 1 1  ON 34
eH1_5                -4.603826e-03 1 1  ON 35
eH1_6                 3.629214e-02 1 1  ON 36
eH1_7                 7.663702e-02 1 1  ON 37
eH1_8                 2.631767e-01 1 1  ON 38
eH1_9                 1.137733e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323232e-01 1 1  ON 41
eH2_2                -9.059531e-02 1 1  ON 42
eH2_3                -5.301844e-02 1 1  ON 43
eH2_4                -6.436641e-03 1 1  ON 44
eH2_5                 5.483643e-03 1 1  ON 45
eH2_6                 4.753379e-02 1 1  ON 46
eH2_7                 4.076325e-02 1 1  ON 47
eH2_8                 2.470838e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0901
    reference variance = 0.660991
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2443e-01
  Total weights = 2.0000e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322660689
                                         uncertainty =       0.005792218553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322660689
                                         uncertainty =       0.005792218553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756637
  error estimate for blocks of size 2^( 2) =       0.000412121790
  error estimate for blocks of size 2^( 3) =       0.000420394587
  error estimate for blocks of size 2^( 4) =       0.000426013175
  error estimate for blocks of size 2^( 5) =       0.000430456234
  error estimate for blocks of size 2^( 6) =       0.000431773452
  error estimate for blocks of size 2^( 7) =       0.000433142701

      target function =                  N/A
              le_mean =     -17.216768779382
             les_mean =     296.741552858326
             stat err =       0.000430346390
             autocorr =       1.141697149853
              std dev =       0.569583898860
             le_variance =       0.324425817841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322329065
                                         uncertainty =       0.005792218522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322329065
                                         uncertainty =       0.005792218522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756431
  error estimate for blocks of size 2^( 2) =       0.000412121603
  error estimate for blocks of size 2^( 3) =       0.000420394413
  error estimate for blocks of size 2^( 4) =       0.000426013003
  error estimate for blocks of size 2^( 5) =       0.000430456043
  error estimate for blocks of size 2^( 6) =       0.000431773253
  error estimate for blocks of size 2^( 7) =       0.000433142566

      target function =                  N/A
              le_mean =     -17.216768783455
             les_mean =     296.741552666507
             stat err =       0.000430346216
             autocorr =       1.141697392934
              std dev =       0.569583607343
             le_variance =       0.324425485753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322494246
                                         uncertainty =       0.005792218549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322494246
                                         uncertainty =       0.005792218549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756534
  error estimate for blocks of size 2^( 2) =       0.000412121696
  error estimate for blocks of size 2^( 3) =       0.000420394500
  error estimate for blocks of size 2^( 4) =       0.000426013089
  error estimate for blocks of size 2^( 5) =       0.000430456138
  error estimate for blocks of size 2^( 6) =       0.000431773352
  error estimate for blocks of size 2^( 7) =       0.000433142633

      target function =                  N/A
              le_mean =     -17.216768781423
             les_mean =     296.741552761946
             stat err =       0.000430346303
             autocorr =       1.141697272290
              std dev =       0.569583752547
             le_variance =       0.324425651165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322639862
                                         uncertainty =       0.005792218553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322639862
                                         uncertainty =       0.005792218553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402756624
  error estimate for blocks of size 2^( 2) =       0.000412121778
  error estimate for blocks of size 2^( 3) =       0.000420394576
  error estimate for blocks of size 2^( 4) =       0.000426013165
  error estimate for blocks of size 2^( 5) =       0.000430456222
  error estimate for blocks of size 2^( 6) =       0.000431773440
  error estimate for blocks of size 2^( 7) =       0.000433142692

      target function =                  N/A
              le_mean =     -17.216768779637
             les_mean =     296.741552846258
             stat err =       0.000430346380
             autocorr =       1.141697165192
              std dev =       0.569583880553
             le_variance =       0.324425796986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216768779382        initial
     9.0949e+01     9.0949e+02             1.4280e-06       -17.216768783455  <--
     3.6380e+02     3.6380e+03             3.5740e-07       -17.216768781423
     1.4552e+03     1.4552e+04             8.9375e-08       -17.216768779637

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.928457e-01 1 1  ON 0
 uu_1                 3.056947e-02 1 1  ON 1
 uu_2                -6.413574e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889891e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645577e-02 1 1  ON 11
 ud_2                -1.337731e-02 1 1  ON 12
 ud_3                -7.571067e-02 1 1  ON 13
 ud_4                -1.263657e-01 1 1  ON 14
 ud_5                -1.634694e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123270e-02 1 1  ON 19
 eO_0                -9.199350e-01 1 1  ON 20
 eO_1                -5.983038e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107154e-01 1 1  ON 24
 eO_5                 2.973275e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350514e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427895e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372573e-02 1 1  ON 33
eH1_4                -1.728464e-02 1 1  ON 34
eH1_5                -4.603475e-03 1 1  ON 35
eH1_6                 3.629237e-02 1 1  ON 36
eH1_7                 7.663668e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059562e-02 1 1  ON 42
eH2_3                -5.301804e-02 1 1  ON 43
eH2_4                -6.436100e-03 1 1  ON 44
eH2_5                 5.482960e-03 1 1  ON 45
eH2_6                 4.753382e-02 1 1  ON 46
eH2_7                 4.076366e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1542
    reference variance = 0.211662
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1709e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317129922716
                                         uncertainty =       0.002377829508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317129922716
                                         uncertainty =       0.002377829508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398175789
  error estimate for blocks of size 2^( 2) =       0.000407504775
  error estimate for blocks of size 2^( 3) =       0.000416528568
  error estimate for blocks of size 2^( 4) =       0.000422575854
  error estimate for blocks of size 2^( 5) =       0.000425208048
  error estimate for blocks of size 2^( 6) =       0.000426004223
  error estimate for blocks of size 2^( 7) =       0.000427957997

      target function =                  N/A
              le_mean =     -17.217629830503
             les_mean =     296.763864738976
             stat err =       0.000425436530
             autocorr =       1.141615504738
              std dev =       0.563105600480
             le_variance =       0.317087917292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721762983050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217629830503       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217629835348       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217629817546       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217629830093       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217629840904       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217629836901       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217629837714       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 5.076246e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217629830503       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217629831723       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217629827224       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217629830390       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217629833126       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217629832125       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217629832336       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.274887e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217629830503       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217629830809       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217629829681       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217629830474       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217629831160       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217629830910       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217629830963       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 3.190897e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6028e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.928459e-01 1 1  ON 0
 uu_1                 3.056912e-02 1 1  ON 1
 uu_2                -6.413492e-02 1 1  ON 2
 uu_3                -1.204929e-01 1 1  ON 3
 uu_4                -1.568961e-01 1 1  ON 4
 uu_5                -1.689331e-01 1 1  ON 5
 uu_6                -1.568310e-01 1 1  ON 6
 uu_7                -1.108409e-01 1 1  ON 7
 uu_8                -3.889877e-02 1 1  ON 8
 uu_9                 2.004288e-01 1 1  ON 9
 ud_0                 3.550265e-01 1 1  ON 10
 ud_1                 9.645594e-02 1 1  ON 11
 ud_2                -1.337719e-02 1 1  ON 12
 ud_3                -7.571008e-02 1 1  ON 13
 ud_4                -1.263665e-01 1 1  ON 14
 ud_5                -1.634689e-01 1 1  ON 15
 ud_6                -1.764522e-01 1 1  ON 16
 ud_7                -1.580552e-01 1 1  ON 17
 ud_8                -1.119631e-01 1 1  ON 18
 ud_9                 3.123238e-02 1 1  ON 19
 eO_0                -9.199357e-01 1 1  ON 20
 eO_1                -5.983042e-01 1 1  ON 21
 eO_2                -1.845929e-01 1 1  ON 22
 eO_3                 8.635043e-02 1 1  ON 23
 eO_4                 2.107162e-01 1 1  ON 24
 eO_5                 2.973280e-01 1 1  ON 25
 eO_6                 3.254054e-01 1 1  ON 26
 eO_7                 5.314920e-01 1 1  ON 27
 eO_8                 1.587318e-01 1 1  ON 28
 eO_9                 5.350520e-02 1 1  ON 29
eH1_0                -2.219329e-01 1 1  ON 30
eH1_1                -1.427898e-01 1 1  ON 31
eH1_2                -1.013062e-01 1 1  ON 32
eH1_3                -6.372538e-02 1 1  ON 33
eH1_4                -1.728459e-02 1 1  ON 34
eH1_5                -4.603413e-03 1 1  ON 35
eH1_6                 3.629272e-02 1 1  ON 36
eH1_7                 7.663623e-02 1 1  ON 37
eH1_8                 2.631762e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112353e-01 1 1  ON 40
eH2_1                -1.323226e-01 1 1  ON 41
eH2_2                -9.059542e-02 1 1  ON 42
eH2_3                -5.301900e-02 1 1  ON 43
eH2_4                -6.435885e-03 1 1  ON 44
eH2_5                 5.482670e-03 1 1  ON 45
eH2_6                 4.753357e-02 1 1  ON 46
eH2_7                 4.076420e-02 1 1  ON 47
eH2_8                 2.470835e-01 1 1  ON 48
eH2_9                 1.154414e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.226047
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1384e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313899719069
                                         uncertainty =       0.003074573248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313899719069
                                         uncertainty =       0.003074573248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396128967
  error estimate for blocks of size 2^( 2) =       0.000405536329
  error estimate for blocks of size 2^( 3) =       0.000414163240
  error estimate for blocks of size 2^( 4) =       0.000420722405
  error estimate for blocks of size 2^( 5) =       0.000424753170
  error estimate for blocks of size 2^( 6) =       0.000428562917
  error estimate for blocks of size 2^( 7) =       0.000430004828

      target function =                  N/A
              le_mean =     -17.216671523413
             les_mean =     296.727614505374
             stat err =       0.000426010830
             autocorr =       1.156559755820
              std dev =       0.560210957763
             le_variance =       0.313836317198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313897876839
                                         uncertainty =       0.003074589314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313897876839
                                         uncertainty =       0.003074589314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396127804
  error estimate for blocks of size 2^( 2) =       0.000405535246
  error estimate for blocks of size 2^( 3) =       0.000414162218
  error estimate for blocks of size 2^( 4) =       0.000420721409
  error estimate for blocks of size 2^( 5) =       0.000424752150
  error estimate for blocks of size 2^( 6) =       0.000428561882
  error estimate for blocks of size 2^( 7) =       0.000430003527

      target function =                  N/A
              le_mean =     -17.216671509442
             les_mean =     296.727612181307
             stat err =       0.000426009742
             autocorr =       1.156560640892
              std dev =       0.560209312839
             le_variance =       0.313834474191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313898787706
                                         uncertainty =       0.003074581350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313898787706
                                         uncertainty =       0.003074581350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396128379
  error estimate for blocks of size 2^( 2) =       0.000405535782
  error estimate for blocks of size 2^( 3) =       0.000414162723
  error estimate for blocks of size 2^( 4) =       0.000420721901
  error estimate for blocks of size 2^( 5) =       0.000424752655
  error estimate for blocks of size 2^( 6) =       0.000428562394
  error estimate for blocks of size 2^( 7) =       0.000430004170

      target function =                  N/A
              le_mean =     -17.216671516321
             les_mean =     296.727613329408
             stat err =       0.000426010280
             autocorr =       1.156560204118
              std dev =       0.560210126152
             le_variance =       0.313835385443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313899602301
                                         uncertainty =       0.003074574262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313899602301
                                         uncertainty =       0.003074574262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396128893
  error estimate for blocks of size 2^( 2) =       0.000405536260
  error estimate for blocks of size 2^( 3) =       0.000414163175
  error estimate for blocks of size 2^( 4) =       0.000420722342
  error estimate for blocks of size 2^( 5) =       0.000424753105
  error estimate for blocks of size 2^( 6) =       0.000428562851
  error estimate for blocks of size 2^( 7) =       0.000430004746

      target function =                  N/A
              le_mean =     -17.216671522520
             les_mean =     296.727614357808
             stat err =       0.000426010761
             autocorr =       1.156559812034
              std dev =       0.560210853502
             le_variance =       0.313836200381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216671523413        initial  <--
     2.2737e+01     2.2737e+02             5.0762e-06       -17.216671509442
     9.0949e+01     9.0949e+02             1.2749e-06       -17.216671516321
     3.6380e+02     3.6380e+03             3.1909e-07       -17.216671522520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8020
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.928457e-01 1 1  ON 0
 uu_1                 3.056947e-02 1 1  ON 1
 uu_2                -6.413574e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889891e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645577e-02 1 1  ON 11
 ud_2                -1.337731e-02 1 1  ON 12
 ud_3                -7.571067e-02 1 1  ON 13
 ud_4                -1.263657e-01 1 1  ON 14
 ud_5                -1.634694e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123270e-02 1 1  ON 19
 eO_0                -9.199350e-01 1 1  ON 20
 eO_1                -5.983038e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107154e-01 1 1  ON 24
 eO_5                 2.973275e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350514e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427895e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372573e-02 1 1  ON 33
eH1_4                -1.728464e-02 1 1  ON 34
eH1_5                -4.603475e-03 1 1  ON 35
eH1_6                 3.629237e-02 1 1  ON 36
eH1_7                 7.663668e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059562e-02 1 1  ON 42
eH2_3                -5.301804e-02 1 1  ON 43
eH2_4                -6.436100e-03 1 1  ON 44
eH2_5                 5.482960e-03 1 1  ON 45
eH2_6                 4.753382e-02 1 1  ON 46
eH2_7                 4.076366e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.205836
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2337e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323446577639
                                         uncertainty =       0.004215145360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323446577639
                                         uncertainty =       0.004215145360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402101085
  error estimate for blocks of size 2^( 2) =       0.000411747582
  error estimate for blocks of size 2^( 3) =       0.000420128170
  error estimate for blocks of size 2^( 4) =       0.000426634813
  error estimate for blocks of size 2^( 5) =       0.000429261913
  error estimate for blocks of size 2^( 6) =       0.000431724334
  error estimate for blocks of size 2^( 7) =       0.000430863593

      target function =                  N/A
              le_mean =     -17.217236358395
             les_mean =     296.756598223594
             stat err =       0.000429621163
             autocorr =       1.141565524290
              std dev =       0.568656807264
             le_variance =       0.323370564448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721723635839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217236358395       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217236359855       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217236360380       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217236359515       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217236360873       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217236361853       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217236362407       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 6.806392e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217236358395       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217236358760       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217236358891       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217236358675       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217236359015       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217236359259       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217236359399       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.703393e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217236358395       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217236358486       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217236358519       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217236358463       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217236358550       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217236358609       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217236358645       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 4.259605e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.928459e-01 1 1  ON 0
 uu_1                 3.056936e-02 1 1  ON 1
 uu_2                -6.413586e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889889e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645573e-02 1 1  ON 11
 ud_2                -1.337726e-02 1 1  ON 12
 ud_3                -7.571065e-02 1 1  ON 13
 ud_4                -1.263656e-01 1 1  ON 14
 ud_5                -1.634695e-01 1 1  ON 15
 ud_6                -1.764519e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123268e-02 1 1  ON 19
 eO_0                -9.199351e-01 1 1  ON 20
 eO_1                -5.983037e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634905e-02 1 1  ON 23
 eO_4                 2.107155e-01 1 1  ON 24
 eO_5                 2.973276e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350515e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427894e-01 1 1  ON 31
eH1_2                -1.013065e-01 1 1  ON 32
eH1_3                -6.372577e-02 1 1  ON 33
eH1_4                -1.728471e-02 1 1  ON 34
eH1_5                -4.603478e-03 1 1  ON 35
eH1_6                 3.629237e-02 1 1  ON 36
eH1_7                 7.663664e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059553e-02 1 1  ON 42
eH2_3                -5.301805e-02 1 1  ON 43
eH2_4                -6.436194e-03 1 1  ON 44
eH2_5                 5.482976e-03 1 1  ON 45
eH2_6                 4.753380e-02 1 1  ON 46
eH2_7                 4.076370e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.281724
====================================================
  Execution time = 2.0425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2092e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049217446
                                         uncertainty =       0.005048452213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049217446
                                         uncertainty =       0.005048452213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400571975
  error estimate for blocks of size 2^( 2) =       0.000409669222
  error estimate for blocks of size 2^( 3) =       0.000417685350
  error estimate for blocks of size 2^( 4) =       0.000423637001
  error estimate for blocks of size 2^( 5) =       0.000428386812
  error estimate for blocks of size 2^( 6) =       0.000429111287
  error estimate for blocks of size 2^( 7) =       0.000430324646

      target function =                  N/A
              le_mean =     -17.216838434559
             les_mean =     296.740441335369
             stat err =       0.000427864936
             autocorr =       1.140912324970
              std dev =       0.566494319578
             le_variance =       0.320915814114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049435217
                                         uncertainty =       0.005048460943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049435217
                                         uncertainty =       0.005048460943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400572113
  error estimate for blocks of size 2^( 2) =       0.000409669361
  error estimate for blocks of size 2^( 3) =       0.000417685495
  error estimate for blocks of size 2^( 4) =       0.000423637150
  error estimate for blocks of size 2^( 5) =       0.000428386973
  error estimate for blocks of size 2^( 6) =       0.000429111434
  error estimate for blocks of size 2^( 7) =       0.000430324757

      target function =                  N/A
              le_mean =     -17.216838431960
             les_mean =     296.740441467564
             stat err =       0.000427865078
             autocorr =       1.140912294612
              std dev =       0.566494515237
             le_variance =       0.320916035794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049326518
                                         uncertainty =       0.005048456580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049326518
                                         uncertainty =       0.005048456580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400572044
  error estimate for blocks of size 2^( 2) =       0.000409669292
  error estimate for blocks of size 2^( 3) =       0.000417685423
  error estimate for blocks of size 2^( 4) =       0.000423637075
  error estimate for blocks of size 2^( 5) =       0.000428386893
  error estimate for blocks of size 2^( 6) =       0.000429111361
  error estimate for blocks of size 2^( 7) =       0.000430324702

      target function =                  N/A
              le_mean =     -17.216838433259
             les_mean =     296.740441401621
             stat err =       0.000427865008
             autocorr =       1.140912309721
              std dev =       0.566494417578
             le_variance =       0.320915925147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049231085
                                         uncertainty =       0.005048452759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049231085
                                         uncertainty =       0.005048452759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400571984
  error estimate for blocks of size 2^( 2) =       0.000409669231
  error estimate for blocks of size 2^( 3) =       0.000417685359
  error estimate for blocks of size 2^( 4) =       0.000423637010
  error estimate for blocks of size 2^( 5) =       0.000428386822
  error estimate for blocks of size 2^( 6) =       0.000429111296
  error estimate for blocks of size 2^( 7) =       0.000430324653

      target function =                  N/A
              le_mean =     -17.216838434397
             les_mean =     296.740441343653
             stat err =       0.000427864945
             autocorr =       1.140912323060
              std dev =       0.566494331833
             le_variance =       0.320915827999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216838434559        initial  <--
     2.2737e+02     2.2737e+03             6.8064e-07       -17.216838431960
     9.0949e+02     9.0949e+03             1.7034e-07       -17.216838433259
     3.6380e+03     3.6380e+04             4.2596e-08       -17.216838434397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9115
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.928457e-01 1 1  ON 0
 uu_1                 3.056947e-02 1 1  ON 1
 uu_2                -6.413574e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889891e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645577e-02 1 1  ON 11
 ud_2                -1.337731e-02 1 1  ON 12
 ud_3                -7.571067e-02 1 1  ON 13
 ud_4                -1.263657e-01 1 1  ON 14
 ud_5                -1.634694e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123270e-02 1 1  ON 19
 eO_0                -9.199350e-01 1 1  ON 20
 eO_1                -5.983038e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107154e-01 1 1  ON 24
 eO_5                 2.973275e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350514e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427895e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372573e-02 1 1  ON 33
eH1_4                -1.728464e-02 1 1  ON 34
eH1_5                -4.603475e-03 1 1  ON 35
eH1_6                 3.629237e-02 1 1  ON 36
eH1_7                 7.663668e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059562e-02 1 1  ON 42
eH2_3                -5.301804e-02 1 1  ON 43
eH2_4                -6.436100e-03 1 1  ON 44
eH2_5                 5.482960e-03 1 1  ON 45
eH2_6                 4.753382e-02 1 1  ON 46
eH2_7                 4.076366e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2419
    reference variance = 0.245456
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1890e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318875770582
                                         uncertainty =       0.002831363168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318875770582
                                         uncertainty =       0.002831363168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399309462
  error estimate for blocks of size 2^( 2) =       0.000408500844
  error estimate for blocks of size 2^( 3) =       0.000417181931
  error estimate for blocks of size 2^( 4) =       0.000424244373
  error estimate for blocks of size 2^( 5) =       0.000428246337
  error estimate for blocks of size 2^( 6) =       0.000430923311
  error estimate for blocks of size 2^( 7) =       0.000431520797

      target function =                  N/A
              le_mean =     -17.217123013515
             les_mean =     296.748220795823
             stat err =       0.000428733704
             autocorr =       1.152805527041
              std dev =       0.564708856636
             le_variance =       0.318896092763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721712301352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217123013515       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217123013356       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217123013032       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217123012861       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217123012841       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123012832       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217123012928       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 7.479706e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217123013515       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217123013475       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217123013394       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217123013351       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217123013346       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123013344       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217123013367       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 1.870055e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217123013515       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217123013505       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217123013485       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217123013474       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217123013477       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217123013530       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217123013393       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 4.675218e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6139e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.928458e-01 1 1  ON 0
 uu_1                 3.056947e-02 1 1  ON 1
 uu_2                -6.413574e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889891e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645576e-02 1 1  ON 11
 ud_2                -1.337730e-02 1 1  ON 12
 ud_3                -7.571067e-02 1 1  ON 13
 ud_4                -1.263657e-01 1 1  ON 14
 ud_5                -1.634694e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123270e-02 1 1  ON 19
 eO_0                -9.199350e-01 1 1  ON 20
 eO_1                -5.983038e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107154e-01 1 1  ON 24
 eO_5                 2.973275e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350514e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427895e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372574e-02 1 1  ON 33
eH1_4                -1.728464e-02 1 1  ON 34
eH1_5                -4.603471e-03 1 1  ON 35
eH1_6                 3.629238e-02 1 1  ON 36
eH1_7                 7.663668e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059563e-02 1 1  ON 42
eH2_3                -5.301803e-02 1 1  ON 43
eH2_4                -6.436097e-03 1 1  ON 44
eH2_5                 5.482957e-03 1 1  ON 45
eH2_6                 4.753383e-02 1 1  ON 46
eH2_7                 4.076367e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.280427
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2047e-01
  Total weights = 2.0000e+06
  Execution time = 1.8842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424402754
                                         uncertainty =       0.006075864863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424402754
                                         uncertainty =       0.006075864863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400296354
  error estimate for blocks of size 2^( 2) =       0.000409473313
  error estimate for blocks of size 2^( 3) =       0.000417263862
  error estimate for blocks of size 2^( 4) =       0.000423751363
  error estimate for blocks of size 2^( 5) =       0.000428614711
  error estimate for blocks of size 2^( 6) =       0.000431373146
  error estimate for blocks of size 2^( 7) =       0.000431737545

      target function =                  N/A
              le_mean =     -17.216885004359
             les_mean =     296.741603434478
             stat err =       0.000428869191
             autocorr =       1.147853412497
              std dev =       0.566104532205
             le_variance =       0.320474341383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424465682
                                         uncertainty =       0.006075867383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424465682
                                         uncertainty =       0.006075867383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400296393
  error estimate for blocks of size 2^( 2) =       0.000409473351
  error estimate for blocks of size 2^( 3) =       0.000417263899
  error estimate for blocks of size 2^( 4) =       0.000423751400
  error estimate for blocks of size 2^( 5) =       0.000428614748
  error estimate for blocks of size 2^( 6) =       0.000431373184
  error estimate for blocks of size 2^( 7) =       0.000431737579

      target function =                  N/A
              le_mean =     -17.216885004233
             les_mean =     296.741603493067
             stat err =       0.000428869228
             autocorr =       1.147853383413
              std dev =       0.566104587785
             le_variance =       0.320474404312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424434223
                                         uncertainty =       0.006075866123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424434223
                                         uncertainty =       0.006075866123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400296373
  error estimate for blocks of size 2^( 2) =       0.000409473332
  error estimate for blocks of size 2^( 3) =       0.000417263881
  error estimate for blocks of size 2^( 4) =       0.000423751382
  error estimate for blocks of size 2^( 5) =       0.000428614729
  error estimate for blocks of size 2^( 6) =       0.000431373165
  error estimate for blocks of size 2^( 7) =       0.000431737562

      target function =                  N/A
              le_mean =     -17.216885004296
             les_mean =     296.741603463777
             stat err =       0.000428869210
             autocorr =       1.147853397958
              std dev =       0.566104560000
             le_variance =       0.320474372852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424406688
                                         uncertainty =       0.006075865021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320424406688
                                         uncertainty =       0.006075865021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400296356
  error estimate for blocks of size 2^( 2) =       0.000409473315
  error estimate for blocks of size 2^( 3) =       0.000417263865
  error estimate for blocks of size 2^( 4) =       0.000423751365
  error estimate for blocks of size 2^( 5) =       0.000428614713
  error estimate for blocks of size 2^( 6) =       0.000431373149
  error estimate for blocks of size 2^( 7) =       0.000431737547

      target function =                  N/A
              le_mean =     -17.216885004351
             les_mean =     296.741603438141
             stat err =       0.000428869194
             autocorr =       1.147853410679
              std dev =       0.566104535680
             le_variance =       0.320474345317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216885004359        initial  <--
     2.2737e+03     2.2737e+04             7.4797e-08       -17.216885004233
     9.0949e+03     9.0949e+04             1.8701e-08       -17.216885004296
     3.6380e+04     3.6380e+05             4.6752e-09       -17.216885004351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6871
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.928457e-01 1 1  ON 0
 uu_1                 3.056947e-02 1 1  ON 1
 uu_2                -6.413574e-02 1 1  ON 2
 uu_3                -1.204932e-01 1 1  ON 3
 uu_4                -1.568951e-01 1 1  ON 4
 uu_5                -1.689343e-01 1 1  ON 5
 uu_6                -1.568302e-01 1 1  ON 6
 uu_7                -1.108405e-01 1 1  ON 7
 uu_8                -3.889891e-02 1 1  ON 8
 uu_9                 2.004290e-01 1 1  ON 9
 ud_0                 3.550266e-01 1 1  ON 10
 ud_1                 9.645577e-02 1 1  ON 11
 ud_2                -1.337731e-02 1 1  ON 12
 ud_3                -7.571067e-02 1 1  ON 13
 ud_4                -1.263657e-01 1 1  ON 14
 ud_5                -1.634694e-01 1 1  ON 15
 ud_6                -1.764518e-01 1 1  ON 16
 ud_7                -1.580551e-01 1 1  ON 17
 ud_8                -1.119632e-01 1 1  ON 18
 ud_9                 3.123270e-02 1 1  ON 19
 eO_0                -9.199350e-01 1 1  ON 20
 eO_1                -5.983038e-01 1 1  ON 21
 eO_2                -1.845918e-01 1 1  ON 22
 eO_3                 8.634916e-02 1 1  ON 23
 eO_4                 2.107154e-01 1 1  ON 24
 eO_5                 2.973275e-01 1 1  ON 25
 eO_6                 3.254057e-01 1 1  ON 26
 eO_7                 5.314922e-01 1 1  ON 27
 eO_8                 1.587316e-01 1 1  ON 28
 eO_9                 5.350514e-02 1 1  ON 29
eH1_0                -2.219326e-01 1 1  ON 30
eH1_1                -1.427895e-01 1 1  ON 31
eH1_2                -1.013066e-01 1 1  ON 32
eH1_3                -6.372573e-02 1 1  ON 33
eH1_4                -1.728464e-02 1 1  ON 34
eH1_5                -4.603475e-03 1 1  ON 35
eH1_6                 3.629237e-02 1 1  ON 36
eH1_7                 7.663668e-02 1 1  ON 37
eH1_8                 2.631765e-01 1 1  ON 38
eH1_9                 1.137734e-01 1 1  ON 39
eH2_0                -2.112349e-01 1 1  ON 40
eH2_1                -1.323235e-01 1 1  ON 41
eH2_2                -9.059562e-02 1 1  ON 42
eH2_3                -5.301804e-02 1 1  ON 43
eH2_4                -6.436100e-03 1 1  ON 44
eH2_5                 5.482960e-03 1 1  ON 45
eH2_6                 4.753382e-02 1 1  ON 46
eH2_7                 4.076366e-02 1 1  ON 47
eH2_8                 2.470836e-01 1 1  ON 48
eH2_9                 1.154413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5831e+01 secs
  Total Execution time = 2.2494e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
