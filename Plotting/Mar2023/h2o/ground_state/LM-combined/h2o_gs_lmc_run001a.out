Rank =    0  Free Memory = 80105 MB
Rank =    1  Free Memory = 80105 MB
Rank =    2  Free Memory = 80105 MB
Rank =    3  Free Memory = 80104 MB
Rank =    4  Free Memory = 80104 MB
Rank =    5  Free Memory = 80104 MB
Rank =    6  Free Memory = 80104 MB
Rank =    7  Free Memory = 80104 MB
Rank =    8  Free Memory = 80104 MB
Rank =    9  Free Memory = 80104 MB
Rank =   10  Free Memory = 80103 MB
Rank =   11  Free Memory = 80103 MB
Rank =   12  Free Memory = 80103 MB
Rank =   13  Free Memory = 80103 MB
Rank =   14  Free Memory = 80103 MB
Rank =   15  Free Memory = 80088 MB
Rank =   16  Free Memory = 80088 MB
Rank =   17  Free Memory = 80088 MB
Rank =   18  Free Memory = 80088 MB
Rank =   19  Free Memory = 80088 MB
Rank =   20  Free Memory = 80088 MB
Rank =   21  Free Memory = 80088 MB
Rank =   22  Free Memory = 80088 MB
Rank =   23  Free Memory = 80088 MB
Rank =   24  Free Memory = 80088 MB
Rank =   25  Free Memory = 80088 MB
Rank =   26  Free Memory = 80088 MB
Rank =   27  Free Memory = 80088 MB
Rank =   28  Free Memory = 80088 MB
Rank =   29  Free Memory = 80088 MB
Rank =   30  Free Memory = 80088 MB
Rank =   31  Free Memory = 80088 MB
Rank =   32  Free Memory = 74977 MB
Rank =   33  Free Memory = 74977 MB
Rank =   34  Free Memory = 74977 MB
Rank =   35  Free Memory = 74977 MB
Rank =   36  Free Memory = 74976 MB
Rank =   37  Free Memory = 74976 MB
Rank =   38  Free Memory = 74976 MB
Rank =   39  Free Memory = 74976 MB
Rank =   40  Free Memory = 74976 MB
Rank =   41  Free Memory = 74976 MB
Rank =   42  Free Memory = 74976 MB
Rank =   43  Free Memory = 74976 MB
Rank =   44  Free Memory = 74976 MB
Rank =   45  Free Memory = 74976 MB
Rank =   46  Free Memory = 74976 MB
Rank =   47  Free Memory = 74976 MB
Rank =   48  Free Memory = 74976 MB
Rank =   49  Free Memory = 74976 MB
Rank =   50  Free Memory = 74976 MB
Rank =   51  Free Memory = 74976 MB
Rank =   52  Free Memory = 74976 MB
Rank =   53  Free Memory = 74976 MB
Rank =   54  Free Memory = 74976 MB
Rank =   55  Free Memory = 74976 MB
Rank =   56  Free Memory = 74976 MB
Rank =   57  Free Memory = 74976 MB
Rank =   58  Free Memory = 74976 MB
Rank =   59  Free Memory = 74976 MB
Rank =   60  Free Memory = 74976 MB
Rank =   61  Free Memory = 74976 MB
Rank =   62  Free Memory = 74976 MB
Rank =   63  Free Memory = 74976 MB
Rank =   64  Free Memory = 86920 MB
Rank =   65  Free Memory = 86920 MB
Rank =   66  Free Memory = 86920 MB
Rank =   67  Free Memory = 86920 MB
Rank =   68  Free Memory = 86920 MB
Rank =   69  Free Memory = 86919 MB
Rank =   70  Free Memory = 86919 MB
Rank =   71  Free Memory = 86919 MB
Rank =   72  Free Memory = 86919 MB
Rank =   73  Free Memory = 86919 MB
Rank =   74  Free Memory = 86919 MB
Rank =   75  Free Memory = 86919 MB
Rank =   76  Free Memory = 86919 MB
Rank =   77  Free Memory = 86919 MB
Rank =   78  Free Memory = 86919 MB
Rank =   79  Free Memory = 86919 MB
Rank =   80  Free Memory = 86919 MB
Rank =   81  Free Memory = 86919 MB
Rank =   82  Free Memory = 86919 MB
Rank =   83  Free Memory = 86919 MB
Rank =   84  Free Memory = 86919 MB
Rank =   85  Free Memory = 86919 MB
Rank =   86  Free Memory = 86919 MB
Rank =   87  Free Memory = 86919 MB
Rank =   88  Free Memory = 86919 MB
Rank =   89  Free Memory = 86919 MB
Rank =   90  Free Memory = 86919 MB
Rank =   91  Free Memory = 86919 MB
Rank =   92  Free Memory = 86919 MB
Rank =   93  Free Memory = 86919 MB
Rank =   94  Free Memory = 86919 MB
Rank =   95  Free Memory = 86919 MB
Rank =   96  Free Memory = 77513 MB
Rank =   97  Free Memory = 77513 MB
Rank =   98  Free Memory = 77513 MB
Rank =   99  Free Memory = 77513 MB
Rank =  100  Free Memory = 77513 MB
Rank =  101  Free Memory = 77513 MB
Rank =  102  Free Memory = 77513 MB
Rank =  103  Free Memory = 77513 MB
Rank =  104  Free Memory = 77513 MB
Rank =  105  Free Memory = 77513 MB
Rank =  106  Free Memory = 77513 MB
Rank =  107  Free Memory = 77513 MB
Rank =  108  Free Memory = 77513 MB
Rank =  109  Free Memory = 77513 MB
Rank =  110  Free Memory = 77513 MB
Rank =  111  Free Memory = 77513 MB
Rank =  112  Free Memory = 77513 MB
Rank =  113  Free Memory = 77513 MB
Rank =  114  Free Memory = 77513 MB
Rank =  115  Free Memory = 77513 MB
Rank =  116  Free Memory = 77513 MB
Rank =  117  Free Memory = 77513 MB
Rank =  118  Free Memory = 77513 MB
Rank =  119  Free Memory = 77513 MB
Rank =  120  Free Memory = 77513 MB
Rank =  121  Free Memory = 77513 MB
Rank =  122  Free Memory = 77513 MB
Rank =  123  Free Memory = 77513 MB
Rank =  124  Free Memory = 77513 MB
Rank =  125  Free Memory = 77513 MB
Rank =  126  Free Memory = 77513 MB
Rank =  127  Free Memory = 77513 MB
  Input file(s): opt_h2o_gs_lmc_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmc_run001a.xml

  Project = H2O
  date    = 2023-03-01 21:28:29 PST
  host    = n0027.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 1021

  Range of prime numbers to use as seeds over processors and threads = 8147-9293


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9098e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 119
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1312
    reference variance = 0.210078
====================================================
  Execution time = 2.1503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2344e-01
  Total weights = 1.953891771e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399715016394
                                         uncertainty =       0.004724207205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399715016394
                                         uncertainty =       0.004724207205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447036710
  error estimate for blocks of size 2^( 2) =       0.000458870065
  error estimate for blocks of size 2^( 3) =       0.000468673537
  error estimate for blocks of size 2^( 4) =       0.000474925808
  error estimate for blocks of size 2^( 5) =       0.000478756858
  error estimate for blocks of size 2^( 6) =       0.000479294723
  error estimate for blocks of size 2^( 7) =       0.000483619956

      target function =                  N/A
              le_mean =     -17.199736186026
             les_mean =     296.254363586362
             stat err =       0.000479149336
             autocorr =       1.148829039105
              std dev =       0.632205378546
             le_variance =       0.399683640663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.719973618603e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199736186159       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.207154176632       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.207563645623       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.207846865725       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.208035433548       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.208121035062       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.208189687900       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.208216537099       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.208232082441       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.208263398879       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.208252963666       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.208253338993       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.208252046753       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.208251285883       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.208252122731       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.208252735414       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.208252543763       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.208252713626       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.208252695709       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 1.722221e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199736186159       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.202980288067       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.203094078388       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.203222738401       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.203299438514       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.203311497411       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.203328828571       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.203343328408       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.203341855712       residual = 8.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.203350230809       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.203348434349       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.203348166678       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.203347925905       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.203347851204       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.203347857155       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.203347872640       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 5.170578e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.199736186159       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.200733868378       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.200764333573       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.200804047878       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.200827039765       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.200827954398       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.200831714719       residual = 5.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.200835955702       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.200835361200       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.200837242109       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.200837051234       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.200836961290       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.200836880808       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.200836895084       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.200836879621       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 1.394105e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7613e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   1.922816e-01                 1 1 ON  0
uu_1   3.645380e-02                 1 1 ON  1
uu_2   -4.586621e-02                1 1 ON  2
uu_3   -9.386682e-02                1 1 ON  3
uu_4   -1.252231e-01                1 1 ON  4
uu_5   -1.326616e-01                1 1 ON  5
uu_6   -1.095228e-01                1 1 ON  6
uu_7   -3.351448e-02                1 1 ON  7
uu_8   1.029817e-01                 1 1 ON  8
uu_9   1.188729e-01                 1 1 ON  9
ud_0   3.198152e-01                 1 1 ON  10
ud_1   7.846129e-02                 1 1 ON  11
ud_2   -9.795143e-03                1 1 ON  12
ud_3   -5.878860e-02                1 1 ON  13
ud_4   -1.082269e-01                1 1 ON  14
ud_5   -1.488623e-01                1 1 ON  15
ud_6   -1.571734e-01                1 1 ON  16
ud_7   -1.078631e-01                1 1 ON  17
ud_8   9.621645e-03                 1 1 ON  18
ud_9   9.249590e-02                 1 1 ON  19
eO_0   -6.863400e-01                1 1 ON  20
eO_1   -4.055446e-01                1 1 ON  21
eO_2   -5.674156e-02                1 1 ON  22
eO_3   1.651098e-01                 1 1 ON  23
eO_4   2.645728e-01                 1 1 ON  24
eO_5   3.066743e-01                 1 1 ON  25
eO_6   2.482246e-01                 1 1 ON  26
eO_7   1.082491e-01                 1 1 ON  27
eO_8   2.729571e-02                 1 1 ON  28
eO_9   1.813854e-02                 1 1 ON  29
eH1_0  -1.762656e-01                1 1 ON  30
eH1_1  -9.881499e-02                1 1 ON  31
eH1_2  -6.246402e-02                1 1 ON  32
eH1_3  -2.827737e-02                1 1 ON  33
eH1_4  1.810176e-02                 1 1 ON  34
eH1_5  3.125710e-02                 1 1 ON  35
eH1_6  7.775579e-02                 1 1 ON  36
eH1_7  1.114707e-01                 1 1 ON  37
eH1_8  8.860946e-02                 1 1 ON  38
eH1_9  2.360399e-02                 1 1 ON  39
eH2_0  -1.779940e-01                1 1 ON  40
eH2_1  -1.004779e-01                1 1 ON  41
eH2_2  -6.446287e-02                1 1 ON  42
eH2_3  -2.982657e-02                1 1 ON  43
eH2_4  1.671437e-02                 1 1 ON  44
eH2_5  3.160002e-02                 1 1 ON  45
eH2_6  8.010613e-02                 1 1 ON  46
eH2_7  1.151660e-01                 1 1 ON  47
eH2_8  9.165220e-02                 1 1 ON  48
eH2_9  2.564124e-02                 1 1 ON  49
ci_001 -6.235256e-02                3 1 ON  50
ci_002 -4.741308e-02                3 1 ON  51
ci_003 -3.496267e-02                3 1 ON  52
ci_004 3.350116e-02                 3 1 ON  53
ci_005 3.409528e-02                 3 1 ON  54
ci_006 -3.202426e-02                3 1 ON  55
ci_007 -3.206898e-02                3 1 ON  56
ci_008 -2.841515e-02                3 1 ON  57
ci_009 -2.647308e-02                3 1 ON  58
ci_010 -2.725204e-02                3 1 ON  59
ci_011 -2.578316e-02                3 1 ON  60
ci_012 -2.629047e-02                3 1 ON  61
ci_013 -2.565154e-02                3 1 ON  62
ci_014 2.353693e-02                 3 1 ON  63
ci_015 2.437224e-02                 3 1 ON  64
ci_016 2.398314e-02                 3 1 ON  65
ci_017 2.361559e-02                 3 1 ON  66
ci_018 2.229615e-02                 3 1 ON  67
ci_019 2.234969e-02                 3 1 ON  68
ci_020 2.241077e-02                 3 1 ON  69
ci_021 2.256371e-02                 3 1 ON  70
ci_022 1.979006e-02                 3 1 ON  71
ci_023 1.973422e-02                 3 1 ON  72
ci_024 2.040686e-02                 3 1 ON  73
ci_025 2.060840e-02                 3 1 ON  74
ci_026 1.947660e-02                 3 1 ON  75
ci_027 1.948365e-02                 3 1 ON  76
ci_028 -1.981687e-02                3 1 ON  77
ci_029 -1.961647e-02                3 1 ON  78
ci_030 -1.835234e-02                3 1 ON  79
ci_031 -1.839998e-02                3 1 ON  80
ci_032 -1.746405e-02                3 1 ON  81
ci_033 1.682738e-02                 3 1 ON  82
ci_034 1.670699e-02                 3 1 ON  83
ci_035 -1.470953e-02                3 1 ON  84
ci_036 -1.642040e-02                3 1 ON  85
ci_037 -1.638676e-02                3 1 ON  86
ci_038 1.327447e-02                 3 1 ON  87
ci_039 1.343574e-02                 3 1 ON  88
ci_040 -1.265502e-02                3 1 ON  89
ci_041 1.491801e-02                 3 1 ON  90
ci_042 1.477980e-02                 3 1 ON  91
ci_043 -1.283777e-02                3 1 ON  92
ci_044 -1.583648e-02                3 1 ON  93
ci_045 -1.195001e-02                3 1 ON  94
ci_046 1.307052e-02                 3 1 ON  95
ci_047 1.304294e-02                 3 1 ON  96
ci_048 -1.383336e-02                3 1 ON  97
ci_049 -1.390752e-02                3 1 ON  98
ci_050 1.204123e-02                 3 1 ON  99
ci_051 1.202020e-02                 3 1 ON  100
ci_052 -1.128767e-02                3 1 ON  101
ci_053 -1.138124e-02                3 1 ON  102
ci_054 -1.066114e-02                3 1 ON  103
ci_055 -1.053170e-02                3 1 ON  104
ci_056 1.092676e-02                 3 1 ON  105
ci_057 1.063448e-02                 3 1 ON  106
ci_058 -1.129855e-02                3 1 ON  107
ci_059 -1.165642e-02                3 1 ON  108
ci_060 1.136095e-02                 3 1 ON  109
ci_061 1.117778e-02                 3 1 ON  110
ci_062 -9.567229e-03                3 1 ON  111
ci_063 -9.314671e-03                3 1 ON  112
ci_064 -8.481677e-03                3 1 ON  113
ci_065 -8.616908e-03                3 1 ON  114
ci_066 1.024541e-02                 3 1 ON  115
ci_067 9.546265e-03                 3 1 ON  116
ci_068 -8.865972e-03                3 1 ON  117
ci_069 -8.340553e-03                3 1 ON  118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.182177
====================================================
  Execution time = 2.1080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.7639e-01
  Total weights = 1.9541e+06
  Execution time = 1.8547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457920312382
                                         uncertainty =       0.021375774029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.457920312382
                                         uncertainty =       0.021375774029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000478479261
  error estimate for blocks of size 2^( 2) =       0.000489456304
  error estimate for blocks of size 2^( 3) =       0.000498046102
  error estimate for blocks of size 2^( 4) =       0.000504361467
  error estimate for blocks of size 2^( 5) =       0.000507546121
  error estimate for blocks of size 2^( 6) =       0.000509881719
  error estimate for blocks of size 2^( 7) =       0.000511929241

      target function =                  N/A
              le_mean =     -17.207753421395
             les_mean =     296.842010002495
             stat err =       0.000508429637
             autocorr =       1.129107985172
              std dev =       0.676671860400
             le_variance =       0.457884806658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360939403555
                                         uncertainty =       0.027302582248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360939403555
                                         uncertainty =       0.027302582248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424774950
  error estimate for blocks of size 2^( 2) =       0.000434866422
  error estimate for blocks of size 2^( 3) =       0.000442966597
  error estimate for blocks of size 2^( 4) =       0.000448460513
  error estimate for blocks of size 2^( 5) =       0.000452015026
  error estimate for blocks of size 2^( 6) =       0.000455055408
  error estimate for blocks of size 2^( 7) =       0.000457860943

      target function =                  N/A
              le_mean =     -17.208481822305
             les_mean =     296.918638283532
             stat err =       0.000453347973
             autocorr =       1.139057272063
              std dev =       0.600722495210
             le_variance =       0.360867516251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330015444663
                                         uncertainty =       0.003107887734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330015444663
                                         uncertainty =       0.003107887734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406187550
  error estimate for blocks of size 2^( 2) =       0.000416766608
  error estimate for blocks of size 2^( 3) =       0.000425514925
  error estimate for blocks of size 2^( 4) =       0.000431401325
  error estimate for blocks of size 2^( 5) =       0.000435041495
  error estimate for blocks of size 2^( 6) =       0.000437269452
  error estimate for blocks of size 2^( 7) =       0.000440655028

      target function =                  N/A
              le_mean =     -17.207688747972
             les_mean =     296.548358065363
             stat err =       0.000436091825
             autocorr =       1.152663855889
              std dev =       0.574435942137
             le_variance =       0.329976651619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401377986303
                                         uncertainty =       0.006206003925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401377986303
                                         uncertainty =       0.006206003925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447976357
  error estimate for blocks of size 2^( 2) =       0.000459256948
  error estimate for blocks of size 2^( 3) =       0.000468699370
  error estimate for blocks of size 2^( 4) =       0.000474586310
  error estimate for blocks of size 2^( 5) =       0.000477787669
  error estimate for blocks of size 2^( 6) =       0.000479601584
  error estimate for blocks of size 2^( 7) =       0.000481850772

      target function =                  N/A
              le_mean =     -17.207354236882
             les_mean =     296.573984375325
             stat err =       0.000478456584
             autocorr =       1.140709035816
              std dev =       0.633534240395
             le_variance =       0.401365633753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.207753421395        initial
     2.5000e-01     2.5000e+00             1.7222e-02       -17.208481822305  <--
     1.0000e+00     1.0000e+01             5.1706e-03       -17.207688747972
     4.0000e+00     4.0000e+01             1.3941e-03       -17.207354236882

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0292e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 1.942147e-01 1 1  ON 0
  uu_1                 3.799432e-02 1 1  ON 1
  uu_2                -4.684055e-02 1 1  ON 2
  uu_3                -9.500976e-02 1 1  ON 3
  uu_4                -1.254612e-01 1 1  ON 4
  uu_5                -1.325244e-01 1 1  ON 5
  uu_6                -1.101669e-01 1 1  ON 6
  uu_7                -3.425715e-02 1 1  ON 7
  uu_8                 1.026859e-01 1 1  ON 8
  uu_9                 1.190708e-01 1 1  ON 9
  ud_0                 3.286596e-01 1 1  ON 10
  ud_1                 8.205104e-02 1 1  ON 11
  ud_2                -1.317422e-02 1 1  ON 12
  ud_3                -6.451715e-02 1 1  ON 13
  ud_4                -1.116620e-01 1 1  ON 14
  ud_5                -1.488448e-01 1 1  ON 15
  ud_6                -1.565958e-01 1 1  ON 16
  ud_7                -1.081259e-01 1 1  ON 17
  ud_8                 9.187644e-03 1 1  ON 18
  ud_9                 9.251375e-02 1 1  ON 19
  eO_0                -6.983916e-01 1 1  ON 20
  eO_1                -4.101829e-01 1 1  ON 21
  eO_2                -4.852978e-02 1 1  ON 22
  eO_3                 1.727248e-01 1 1  ON 23
  eO_4                 2.657402e-01 1 1  ON 24
  eO_5                 3.057858e-01 1 1  ON 25
  eO_6                 2.483174e-01 1 1  ON 26
  eO_7                 1.086160e-01 1 1  ON 27
  eO_8                 2.737057e-02 1 1  ON 28
  eO_9                 1.816652e-02 1 1  ON 29
 eH1_0                -1.775172e-01 1 1  ON 30
 eH1_1                -9.964242e-02 1 1  ON 31
 eH1_2                -6.270188e-02 1 1  ON 32
 eH1_3                -2.738744e-02 1 1  ON 33
 eH1_4                 1.896598e-02 1 1  ON 34
 eH1_5                 3.200820e-02 1 1  ON 35
 eH1_6                 7.737574e-02 1 1  ON 36
 eH1_7                 1.113511e-01 1 1  ON 37
 eH1_8                 8.884981e-02 1 1  ON 38
 eH1_9                 2.366449e-02 1 1  ON 39
 eH2_0                -1.792883e-01 1 1  ON 40
 eH2_1                -1.011917e-01 1 1  ON 41
 eH2_2                -6.448433e-02 1 1  ON 42
 eH2_3                -2.899618e-02 1 1  ON 43
 eH2_4                 1.769016e-02 1 1  ON 44
 eH2_5                 3.220042e-02 1 1  ON 45
 eH2_6                 7.965044e-02 1 1  ON 46
 eH2_7                 1.149163e-01 1 1  ON 47
 eH2_8                 9.186424e-02 1 1  ON 48
 eH2_9                 2.572316e-02 1 1  ON 49
ci_001                -5.558787e-02 3 1  ON 50
ci_002                -4.077598e-02 3 1  ON 51
ci_003                -3.173669e-02 3 1  ON 52
ci_004                 2.847181e-02 3 1  ON 53
ci_005                 3.011396e-02 3 1  ON 54
ci_006                -2.670277e-02 3 1  ON 55
ci_007                -2.685763e-02 3 1  ON 56
ci_008                -2.399902e-02 3 1  ON 57
ci_009                -2.215645e-02 3 1  ON 58
ci_010                -2.400649e-02 3 1  ON 59
ci_011                -2.127261e-02 3 1  ON 60
ci_012                -2.247671e-02 3 1  ON 61
ci_013                -2.338815e-02 3 1  ON 62
ci_014                 1.885284e-02 3 1  ON 63
ci_015                 2.073175e-02 3 1  ON 64
ci_016                 2.165719e-02 3 1  ON 65
ci_017                 2.076504e-02 3 1  ON 66
ci_018                 1.827681e-02 3 1  ON 67
ci_019                 1.839464e-02 3 1  ON 68
ci_020                 1.884092e-02 3 1  ON 69
ci_021                 1.921237e-02 3 1  ON 70
ci_022                 1.657690e-02 3 1  ON 71
ci_023                 1.635269e-02 3 1  ON 72
ci_024                 1.732539e-02 3 1  ON 73
ci_025                 1.796613e-02 3 1  ON 74
ci_026                 1.624566e-02 3 1  ON 75
ci_027                 1.623939e-02 3 1  ON 76
ci_028                -1.764488e-02 3 1  ON 77
ci_029                -1.717765e-02 3 1  ON 78
ci_030                -1.582750e-02 3 1  ON 79
ci_031                -1.587355e-02 3 1  ON 80
ci_032                -1.571970e-02 3 1  ON 81
ci_033                 1.421711e-02 3 1  ON 82
ci_034                 1.380463e-02 3 1  ON 83
ci_035                -1.033738e-02 3 1  ON 84
ci_036                -1.377968e-02 3 1  ON 85
ci_037                -1.369186e-02 3 1  ON 86
ci_038                 7.856734e-03 3 1  ON 87
ci_039                 8.172787e-03 3 1  ON 88
ci_040                -7.888820e-03 3 1  ON 89
ci_041                 1.247301e-02 3 1  ON 90
ci_042                 1.217819e-02 3 1  ON 91
ci_043                -8.471100e-03 3 1  ON 92
ci_044                -1.544947e-02 3 1  ON 93
ci_045                -7.259894e-03 3 1  ON 94
ci_046                 1.001030e-02 3 1  ON 95
ci_047                 1.002061e-02 3 1  ON 96
ci_048                -1.294408e-02 3 1  ON 97
ci_049                -1.309558e-02 3 1  ON 98
ci_050                 9.937829e-03 3 1  ON 99
ci_051                 9.908157e-03 3 1  ON 100
ci_052                -9.148537e-03 3 1  ON 101
ci_053                -9.357056e-03 3 1  ON 102
ci_054                -7.741437e-03 3 1  ON 103
ci_055                -7.401702e-03 3 1  ON 104
ci_056                 8.614508e-03 3 1  ON 105
ci_057                 8.071186e-03 3 1  ON 106
ci_058                -9.557844e-03 3 1  ON 107
ci_059                -1.037770e-02 3 1  ON 108
ci_060                 1.034808e-02 3 1  ON 109
ci_061                 1.000487e-02 3 1  ON 110
ci_062                -6.764932e-03 3 1  ON 111
ci_063                -6.194552e-03 3 1  ON 112
ci_064                -5.781167e-03 3 1  ON 113
ci_065                -6.172994e-03 3 1  ON 114
ci_066                 9.308015e-03 3 1  ON 115
ci_067                 7.863702e-03 3 1  ON 116
ci_068                -7.127902e-03 3 1  ON 117
ci_069                -5.959841e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7911e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7164e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1395
    reference variance = 0.153239
====================================================
  Execution time = 2.1039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.4000e-01
  Total weights = 1.955171878e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315887513649
                                         uncertainty =       0.002421874333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315887513649
                                         uncertainty =       0.002421874333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397370471
  error estimate for blocks of size 2^( 2) =       0.000407809613
  error estimate for blocks of size 2^( 3) =       0.000416607748
  error estimate for blocks of size 2^( 4) =       0.000422930914
  error estimate for blocks of size 2^( 5) =       0.000427209352
  error estimate for blocks of size 2^( 6) =       0.000428746002
  error estimate for blocks of size 2^( 7) =       0.000429068726

      target function =                  N/A
              le_mean =     -17.212396736356
             les_mean =     296.606598534850
             stat err =       0.000426988749
             autocorr =       1.154626922087
              std dev =       0.561966709823
             le_variance =       0.315806582949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721239673636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212396736395       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214609150280       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214767742264       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214902765923       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215007258033       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215080559953       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215150441402       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215147527232       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215190064393       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215207597433       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215209075204       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215208460660       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215205488069       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215201782059       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215203694663       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215204830747       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215208635613       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215209280798       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215209678397       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215210972088       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215211024581       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215210339453       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215210944126       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215210947003       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215211042082       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215211150937       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-02 is 3.264721e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212396736395       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213848912482       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213930304788       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214010812714       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214076886325       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214101352836       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214131827277       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214130250537       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214140342898       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214145661516       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214144665589       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214144933832       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214143306603       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214142835446       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214142763386       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214142917782       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214143221522       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214143473978       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 1.286668e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212396736395       residual = 6.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213008216628       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213040466698       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213074616693       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213100469331       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213102179203       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213109780892       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213110978938       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213112087651       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213113208740       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213113046818       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213113120173       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213113122359       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213112911400       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213112879967       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 3.868841e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7218e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 1.964182e-01 1 1  ON 0
  uu_1                 3.970143e-02 1 1  ON 1
  uu_2                -4.750010e-02 1 1  ON 2
  uu_3                -9.619515e-02 1 1  ON 3
  uu_4                -1.260368e-01 1 1  ON 4
  uu_5                -1.325990e-01 1 1  ON 5
  uu_6                -1.106918e-01 1 1  ON 6
  uu_7                -3.520530e-02 1 1  ON 7
  uu_8                 1.022603e-01 1 1  ON 8
  uu_9                 1.192974e-01 1 1  ON 9
  ud_0                 3.362593e-01 1 1  ON 10
  ud_1                 8.507857e-02 1 1  ON 11
  ud_2                -1.567053e-02 1 1  ON 12
  ud_3                -6.936356e-02 1 1  ON 13
  ud_4                -1.147633e-01 1 1  ON 14
  ud_5                -1.487433e-01 1 1  ON 15
  ud_6                -1.558972e-01 1 1  ON 16
  ud_7                -1.086445e-01 1 1  ON 17
  ud_8                 8.515435e-03 1 1  ON 18
  ud_9                 9.247647e-02 1 1  ON 19
  eO_0                -7.112583e-01 1 1  ON 20
  eO_1                -4.152405e-01 1 1  ON 21
  eO_2                -4.163815e-02 1 1  ON 22
  eO_3                 1.816714e-01 1 1  ON 23
  eO_4                 2.681986e-01 1 1  ON 24
  eO_5                 3.048907e-01 1 1  ON 25
  eO_6                 2.483054e-01 1 1  ON 26
  eO_7                 1.090469e-01 1 1  ON 27
  eO_8                 2.742205e-02 1 1  ON 28
  eO_9                 1.819235e-02 1 1  ON 29
 eH1_0                -1.787716e-01 1 1  ON 30
 eH1_1                -1.003665e-01 1 1  ON 31
 eH1_2                -6.269949e-02 1 1  ON 32
 eH1_3                -2.685318e-02 1 1  ON 33
 eH1_4                 1.958863e-02 1 1  ON 34
 eH1_5                 3.302434e-02 1 1  ON 35
 eH1_6                 7.701412e-02 1 1  ON 36
 eH1_7                 1.110622e-01 1 1  ON 37
 eH1_8                 8.914711e-02 1 1  ON 38
 eH1_9                 2.377743e-02 1 1  ON 39
 eH2_0                -1.802779e-01 1 1  ON 40
 eH2_1                -1.017442e-01 1 1  ON 41
 eH2_2                -6.417994e-02 1 1  ON 42
 eH2_3                -2.814988e-02 1 1  ON 43
 eH2_4                 1.828957e-02 1 1  ON 44
 eH2_5                 3.260809e-02 1 1  ON 45
 eH2_6                 7.888950e-02 1 1  ON 46
 eH2_7                 1.146815e-01 1 1  ON 47
 eH2_8                 9.213273e-02 1 1  ON 48
 eH2_9                 2.581789e-02 1 1  ON 49
ci_001                -4.876884e-02 3 1  ON 50
ci_002                -3.638040e-02 3 1  ON 51
ci_003                -2.893845e-02 3 1  ON 52
ci_004                 2.546792e-02 3 1  ON 53
ci_005                 2.571118e-02 3 1  ON 54
ci_006                -2.336376e-02 3 1  ON 55
ci_007                -2.302666e-02 3 1  ON 56
ci_008                -2.063645e-02 3 1  ON 57
ci_009                -1.952509e-02 3 1  ON 58
ci_010                -2.154573e-02 3 1  ON 59
ci_011                -1.938198e-02 3 1  ON 60
ci_012                -1.964047e-02 3 1  ON 61
ci_013                -2.159093e-02 3 1  ON 62
ci_014                 1.670417e-02 3 1  ON 63
ci_015                 1.722092e-02 3 1  ON 64
ci_016                 1.854143e-02 3 1  ON 65
ci_017                 1.909314e-02 3 1  ON 66
ci_018                 1.504110e-02 3 1  ON 67
ci_019                 1.546621e-02 3 1  ON 68
ci_020                 1.620691e-02 3 1  ON 69
ci_021                 1.613319e-02 3 1  ON 70
ci_022                 1.344031e-02 3 1  ON 71
ci_023                 1.320247e-02 3 1  ON 72
ci_024                 1.605732e-02 3 1  ON 73
ci_025                 1.476412e-02 3 1  ON 74
ci_026                 1.418623e-02 3 1  ON 75
ci_027                 1.336730e-02 3 1  ON 76
ci_028                -1.555420e-02 3 1  ON 77
ci_029                -1.639804e-02 3 1  ON 78
ci_030                -1.413148e-02 3 1  ON 79
ci_031                -1.335441e-02 3 1  ON 80
ci_032                -1.456141e-02 3 1  ON 81
ci_033                 1.240882e-02 3 1  ON 82
ci_034                 1.249112e-02 3 1  ON 83
ci_035                -6.989715e-03 3 1  ON 84
ci_036                -1.216406e-02 3 1  ON 85
ci_037                -1.187604e-02 3 1  ON 86
ci_038                 4.163408e-03 3 1  ON 87
ci_039                 4.763689e-03 3 1  ON 88
ci_040                -5.541482e-03 3 1  ON 89
ci_041                 1.058891e-02 3 1  ON 90
ci_042                 1.129800e-02 3 1  ON 91
ci_043                -5.410984e-03 3 1  ON 92
ci_044                -1.550870e-02 3 1  ON 93
ci_045                -4.166607e-03 3 1  ON 94
ci_046                 7.948290e-03 3 1  ON 95
ci_047                 7.046128e-03 3 1  ON 96
ci_048                -1.212227e-02 3 1  ON 97
ci_049                -1.262305e-02 3 1  ON 98
ci_050                 8.757375e-03 3 1  ON 99
ci_051                 8.713401e-03 3 1  ON 100
ci_052                -7.747069e-03 3 1  ON 101
ci_053                -8.475536e-03 3 1  ON 102
ci_054                -5.393240e-03 3 1  ON 103
ci_055                -5.439584e-03 3 1  ON 104
ci_056                 5.737141e-03 3 1  ON 105
ci_057                 6.245028e-03 3 1  ON 106
ci_058                -8.522618e-03 3 1  ON 107
ci_059                -7.968244e-03 3 1  ON 108
ci_060                 9.206439e-03 3 1  ON 109
ci_061                 9.242683e-03 3 1  ON 110
ci_062                -4.741460e-03 3 1  ON 111
ci_063                -4.744680e-03 3 1  ON 112
ci_064                -4.323167e-03 3 1  ON 113
ci_065                -4.714089e-03 3 1  ON 114
ci_066                 6.722692e-03 3 1  ON 115
ci_067                 7.090824e-03 3 1  ON 116
ci_068                -5.330568e-03 3 1  ON 117
ci_069                -5.289747e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1365
    reference variance = 0.191529
====================================================
  Execution time = 2.0529e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1440e-01
  Total weights = 1.9559e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350116452232
                                         uncertainty =       0.014943853879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350116452232
                                         uncertainty =       0.014943853879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418454315
  error estimate for blocks of size 2^( 2) =       0.000428880688
  error estimate for blocks of size 2^( 3) =       0.000438102609
  error estimate for blocks of size 2^( 4) =       0.000444253355
  error estimate for blocks of size 2^( 5) =       0.000448795456
  error estimate for blocks of size 2^( 6) =       0.000450106842
  error estimate for blocks of size 2^( 7) =       0.000448452160

      target function =                  N/A
              le_mean =     -17.216843561063
             les_mean =     297.159306189276
             stat err =       0.000447901953
             autocorr =       1.145697093465
              std dev =       0.591783767768
             le_variance =       0.350208027794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      15.091417253883
                                         uncertainty =      13.211693541284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      15.091417253883
                                         uncertainty =      13.211693541284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.002742950554
  error estimate for blocks of size 2^( 2) =       0.002743751552
  error estimate for blocks of size 2^( 3) =       0.002745449138
  error estimate for blocks of size 2^( 4) =       0.002747221121
  error estimate for blocks of size 2^( 5) =       0.002750032388
  error estimate for blocks of size 2^( 6) =       0.002750359371
  error estimate for blocks of size 2^( 7) =       0.002750223525

      target function =                  N/A
              le_mean =     -17.212848862510
             les_mean =     635.832926044523
             stat err =       0.002749459101
             autocorr =       1.004751284477
              std dev =       3.879117874121
             le_variance =      15.047555481323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296196754273
                                         uncertainty =       0.001905645465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296196754273
                                         uncertainty =       0.001905645465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384851113
  error estimate for blocks of size 2^( 2) =       0.000395405346
  error estimate for blocks of size 2^( 3) =       0.000405142079
  error estimate for blocks of size 2^( 4) =       0.000411973617
  error estimate for blocks of size 2^( 5) =       0.000416230865
  error estimate for blocks of size 2^( 6) =       0.000417781327
  error estimate for blocks of size 2^( 7) =       0.000417239823

      target function =                  N/A
              le_mean =     -17.216830444794
             les_mean =     296.761235064724
             stat err =       0.000415806408
             autocorr =       1.167338641915
              std dev =       0.544261663469
             le_variance =       0.296220758322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311958577491
                                         uncertainty =       0.002698374739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311958577491
                                         uncertainty =       0.002698374739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395008689
  error estimate for blocks of size 2^( 2) =       0.000405785045
  error estimate for blocks of size 2^( 3) =       0.000415318235
  error estimate for blocks of size 2^( 4) =       0.000421850759
  error estimate for blocks of size 2^( 5) =       0.000426032310
  error estimate for blocks of size 2^( 6) =       0.000427384626
  error estimate for blocks of size 2^( 7) =       0.000426220459

      target function =                  N/A
              le_mean =     -17.216182761042
             les_mean =     296.774100060825
             stat err =       0.000425372038
             autocorr =       1.159643719373
              std dev =       0.558626644539
             le_variance =       0.312063727989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216843561063        initial  <--
     6.2500e-02     6.2500e-01             3.2647e-02       -17.212848862510
     2.5000e-01     2.5000e+00             1.2867e-02       -17.216830444794
     1.0000e+00     1.0000e+01             3.8688e-03       -17.216182761042

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.1121
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 1.942147e-01 1 1  ON 0
  uu_1                 3.799432e-02 1 1  ON 1
  uu_2                -4.684055e-02 1 1  ON 2
  uu_3                -9.500976e-02 1 1  ON 3
  uu_4                -1.254612e-01 1 1  ON 4
  uu_5                -1.325244e-01 1 1  ON 5
  uu_6                -1.101669e-01 1 1  ON 6
  uu_7                -3.425715e-02 1 1  ON 7
  uu_8                 1.026859e-01 1 1  ON 8
  uu_9                 1.190708e-01 1 1  ON 9
  ud_0                 3.286596e-01 1 1  ON 10
  ud_1                 8.205104e-02 1 1  ON 11
  ud_2                -1.317422e-02 1 1  ON 12
  ud_3                -6.451715e-02 1 1  ON 13
  ud_4                -1.116620e-01 1 1  ON 14
  ud_5                -1.488448e-01 1 1  ON 15
  ud_6                -1.565958e-01 1 1  ON 16
  ud_7                -1.081259e-01 1 1  ON 17
  ud_8                 9.187644e-03 1 1  ON 18
  ud_9                 9.251375e-02 1 1  ON 19
  eO_0                -6.983916e-01 1 1  ON 20
  eO_1                -4.101829e-01 1 1  ON 21
  eO_2                -4.852978e-02 1 1  ON 22
  eO_3                 1.727248e-01 1 1  ON 23
  eO_4                 2.657402e-01 1 1  ON 24
  eO_5                 3.057858e-01 1 1  ON 25
  eO_6                 2.483174e-01 1 1  ON 26
  eO_7                 1.086160e-01 1 1  ON 27
  eO_8                 2.737057e-02 1 1  ON 28
  eO_9                 1.816652e-02 1 1  ON 29
 eH1_0                -1.775172e-01 1 1  ON 30
 eH1_1                -9.964242e-02 1 1  ON 31
 eH1_2                -6.270188e-02 1 1  ON 32
 eH1_3                -2.738744e-02 1 1  ON 33
 eH1_4                 1.896598e-02 1 1  ON 34
 eH1_5                 3.200820e-02 1 1  ON 35
 eH1_6                 7.737574e-02 1 1  ON 36
 eH1_7                 1.113511e-01 1 1  ON 37
 eH1_8                 8.884981e-02 1 1  ON 38
 eH1_9                 2.366449e-02 1 1  ON 39
 eH2_0                -1.792883e-01 1 1  ON 40
 eH2_1                -1.011917e-01 1 1  ON 41
 eH2_2                -6.448433e-02 1 1  ON 42
 eH2_3                -2.899618e-02 1 1  ON 43
 eH2_4                 1.769016e-02 1 1  ON 44
 eH2_5                 3.220042e-02 1 1  ON 45
 eH2_6                 7.965044e-02 1 1  ON 46
 eH2_7                 1.149163e-01 1 1  ON 47
 eH2_8                 9.186424e-02 1 1  ON 48
 eH2_9                 2.572316e-02 1 1  ON 49
ci_001                -5.558787e-02 3 1  ON 50
ci_002                -4.077598e-02 3 1  ON 51
ci_003                -3.173669e-02 3 1  ON 52
ci_004                 2.847181e-02 3 1  ON 53
ci_005                 3.011396e-02 3 1  ON 54
ci_006                -2.670277e-02 3 1  ON 55
ci_007                -2.685763e-02 3 1  ON 56
ci_008                -2.399902e-02 3 1  ON 57
ci_009                -2.215645e-02 3 1  ON 58
ci_010                -2.400649e-02 3 1  ON 59
ci_011                -2.127261e-02 3 1  ON 60
ci_012                -2.247671e-02 3 1  ON 61
ci_013                -2.338815e-02 3 1  ON 62
ci_014                 1.885284e-02 3 1  ON 63
ci_015                 2.073175e-02 3 1  ON 64
ci_016                 2.165719e-02 3 1  ON 65
ci_017                 2.076504e-02 3 1  ON 66
ci_018                 1.827681e-02 3 1  ON 67
ci_019                 1.839464e-02 3 1  ON 68
ci_020                 1.884092e-02 3 1  ON 69
ci_021                 1.921237e-02 3 1  ON 70
ci_022                 1.657690e-02 3 1  ON 71
ci_023                 1.635269e-02 3 1  ON 72
ci_024                 1.732539e-02 3 1  ON 73
ci_025                 1.796613e-02 3 1  ON 74
ci_026                 1.624566e-02 3 1  ON 75
ci_027                 1.623939e-02 3 1  ON 76
ci_028                -1.764488e-02 3 1  ON 77
ci_029                -1.717765e-02 3 1  ON 78
ci_030                -1.582750e-02 3 1  ON 79
ci_031                -1.587355e-02 3 1  ON 80
ci_032                -1.571970e-02 3 1  ON 81
ci_033                 1.421711e-02 3 1  ON 82
ci_034                 1.380463e-02 3 1  ON 83
ci_035                -1.033738e-02 3 1  ON 84
ci_036                -1.377968e-02 3 1  ON 85
ci_037                -1.369186e-02 3 1  ON 86
ci_038                 7.856734e-03 3 1  ON 87
ci_039                 8.172787e-03 3 1  ON 88
ci_040                -7.888820e-03 3 1  ON 89
ci_041                 1.247301e-02 3 1  ON 90
ci_042                 1.217819e-02 3 1  ON 91
ci_043                -8.471100e-03 3 1  ON 92
ci_044                -1.544947e-02 3 1  ON 93
ci_045                -7.259894e-03 3 1  ON 94
ci_046                 1.001030e-02 3 1  ON 95
ci_047                 1.002061e-02 3 1  ON 96
ci_048                -1.294408e-02 3 1  ON 97
ci_049                -1.309558e-02 3 1  ON 98
ci_050                 9.937829e-03 3 1  ON 99
ci_051                 9.908157e-03 3 1  ON 100
ci_052                -9.148537e-03 3 1  ON 101
ci_053                -9.357056e-03 3 1  ON 102
ci_054                -7.741437e-03 3 1  ON 103
ci_055                -7.401702e-03 3 1  ON 104
ci_056                 8.614508e-03 3 1  ON 105
ci_057                 8.071186e-03 3 1  ON 106
ci_058                -9.557844e-03 3 1  ON 107
ci_059                -1.037770e-02 3 1  ON 108
ci_060                 1.034808e-02 3 1  ON 109
ci_061                 1.000487e-02 3 1  ON 110
ci_062                -6.764932e-03 3 1  ON 111
ci_063                -6.194552e-03 3 1  ON 112
ci_064                -5.781167e-03 3 1  ON 113
ci_065                -6.172994e-03 3 1  ON 114
ci_066                 9.308015e-03 3 1  ON 115
ci_067                 7.863702e-03 3 1  ON 116
ci_068                -7.127902e-03 3 1  ON 117
ci_069                -5.959841e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7151e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2868
    reference variance = 0.244022
====================================================
  Execution time = 2.0746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3451e-01
  Total weights = 1.955376323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318165414256
                                         uncertainty =       0.002340559050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318165414256
                                         uncertainty =       0.002340559050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398936926
  error estimate for blocks of size 2^( 2) =       0.000409319511
  error estimate for blocks of size 2^( 3) =       0.000418560514
  error estimate for blocks of size 2^( 4) =       0.000425334747
  error estimate for blocks of size 2^( 5) =       0.000429111300
  error estimate for blocks of size 2^( 6) =       0.000431952581
  error estimate for blocks of size 2^( 7) =       0.000433506658

      target function =                  N/A
              le_mean =     -17.212649317869
             les_mean =     296.609809783176
             stat err =       0.000429976321
             autocorr =       1.161664201212
              std dev =       0.564182011203
             le_variance =       0.318301341765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721264931787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212649317930       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213476242708       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213516860484       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213565438149       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213612190467       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213625017598       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213638279951       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213642489010       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213644738443       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213647352278       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213646516650       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.213646246055       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213645778709       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213645708353       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213645724783       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-01 is 6.027206e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212649317930       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212922599398       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212935478662       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212950873867       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212966051710       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212968126151       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212971236178       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212972255107       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212972953643       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212973421401       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212973199329       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212973171343       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212973198381       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212973141171       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 1.641843e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.212649317930       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.212723616611       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.212727160782       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.212731312577       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.212735402153       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.212735835929       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212736580785       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212736796433       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212736979071       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212737106393       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.212737069613       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212737045681       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.212737058478       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 4.191245e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6859e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 1.943972e-01 1 1  ON 0
  uu_1                 3.816563e-02 1 1  ON 1
  uu_2                -4.691749e-02 1 1  ON 2
  uu_3                -9.511044e-02 1 1  ON 3
  uu_4                -1.254730e-01 1 1  ON 4
  uu_5                -1.325480e-01 1 1  ON 5
  uu_6                -1.102255e-01 1 1  ON 6
  uu_7                -3.435479e-02 1 1  ON 7
  uu_8                 1.026453e-01 1 1  ON 8
  uu_9                 1.190942e-01 1 1  ON 9
  ud_0                 3.299048e-01 1 1  ON 10
  ud_1                 8.250871e-02 1 1  ON 11
  ud_2                -1.366291e-02 1 1  ON 12
  ud_3                -6.533178e-02 1 1  ON 13
  ud_4                -1.121006e-01 1 1  ON 14
  ud_5                -1.488137e-01 1 1  ON 15
  ud_6                -1.565096e-01 1 1  ON 16
  ud_7                -1.081565e-01 1 1  ON 17
  ud_8                 9.114999e-03 1 1  ON 18
  ud_9                 9.251272e-02 1 1  ON 19
  eO_0                -7.000334e-01 1 1  ON 20
  eO_1                -4.107742e-01 1 1  ON 21
  eO_2                -4.741474e-02 1 1  ON 22
  eO_3                 1.737196e-01 1 1  ON 23
  eO_4                 2.659078e-01 1 1  ON 24
  eO_5                 3.056779e-01 1 1  ON 25
  eO_6                 2.483244e-01 1 1  ON 26
  eO_7                 1.086600e-01 1 1  ON 27
  eO_8                 2.737771e-02 1 1  ON 28
  eO_9                 1.816907e-02 1 1  ON 29
 eH1_0                -1.776499e-01 1 1  ON 30
 eH1_1                -9.970853e-02 1 1  ON 31
 eH1_2                -6.272174e-02 1 1  ON 32
 eH1_3                -2.727730e-02 1 1  ON 33
 eH1_4                 1.904944e-02 1 1  ON 34
 eH1_5                 3.206925e-02 1 1  ON 35
 eH1_6                 7.731897e-02 1 1  ON 36
 eH1_7                 1.113344e-01 1 1  ON 37
 eH1_8                 8.887485e-02 1 1  ON 38
 eH1_9                 2.367386e-02 1 1  ON 39
 eH2_0                -1.794180e-01 1 1  ON 40
 eH2_1                -1.013078e-01 1 1  ON 41
 eH2_2                -6.449655e-02 1 1  ON 42
 eH2_3                -2.889204e-02 1 1  ON 43
 eH2_4                 1.782500e-02 1 1  ON 44
 eH2_5                 3.226847e-02 1 1  ON 45
 eH2_6                 7.959141e-02 1 1  ON 46
 eH2_7                 1.148885e-01 1 1  ON 47
 eH2_8                 9.189030e-02 1 1  ON 48
 eH2_9                 2.573196e-02 1 1  ON 49
ci_001                -5.447392e-02 3 1  ON 50
ci_002                -3.983133e-02 3 1  ON 51
ci_003                -3.127999e-02 3 1  ON 52
ci_004                 2.791366e-02 3 1  ON 53
ci_005                 2.943318e-02 3 1  ON 54
ci_006                -2.594821e-02 3 1  ON 55
ci_007                -2.617432e-02 3 1  ON 56
ci_008                -2.334602e-02 3 1  ON 57
ci_009                -2.166559e-02 3 1  ON 58
ci_010                -2.355884e-02 3 1  ON 59
ci_011                -2.094851e-02 3 1  ON 60
ci_012                -2.197749e-02 3 1  ON 61
ci_013                -2.304692e-02 3 1  ON 62
ci_014                 1.836993e-02 3 1  ON 63
ci_015                 2.016358e-02 3 1  ON 64
ci_016                 2.118624e-02 3 1  ON 65
ci_017                 2.031371e-02 3 1  ON 66
ci_018                 1.773274e-02 3 1  ON 67
ci_019                 1.794957e-02 3 1  ON 68
ci_020                 1.837760e-02 3 1  ON 69
ci_021                 1.870983e-02 3 1  ON 70
ci_022                 1.611065e-02 3 1  ON 71
ci_023                 1.586673e-02 3 1  ON 72
ci_024                 1.699961e-02 3 1  ON 73
ci_025                 1.755109e-02 3 1  ON 74
ci_026                 1.576069e-02 3 1  ON 75
ci_027                 1.573576e-02 3 1  ON 76
ci_028                -1.734399e-02 3 1  ON 77
ci_029                -1.692253e-02 3 1  ON 78
ci_030                -1.538082e-02 3 1  ON 79
ci_031                -1.540270e-02 3 1  ON 80
ci_032                -1.546760e-02 3 1  ON 81
ci_033                 1.388533e-02 3 1  ON 82
ci_034                 1.355109e-02 3 1  ON 83
ci_035                -9.639485e-03 3 1  ON 84
ci_036                -1.349307e-02 3 1  ON 85
ci_037                -1.341790e-02 3 1  ON 86
ci_038                 7.097000e-03 3 1  ON 87
ci_039                 7.372046e-03 3 1  ON 88
ci_040                -7.393026e-03 3 1  ON 89
ci_041                 1.217008e-02 3 1  ON 90
ci_042                 1.193985e-02 3 1  ON 91
ci_043                -7.871562e-03 3 1  ON 92
ci_044                -1.538142e-02 3 1  ON 93
ci_045                -6.577804e-03 3 1  ON 94
ci_046                 9.645507e-03 3 1  ON 95
ci_047                 9.611136e-03 3 1  ON 96
ci_048                -1.282419e-02 3 1  ON 97
ci_049                -1.286792e-02 3 1  ON 98
ci_050                 9.630246e-03 3 1  ON 99
ci_051                 9.551250e-03 3 1  ON 100
ci_052                -8.960679e-03 3 1  ON 101
ci_053                -8.993432e-03 3 1  ON 102
ci_054                -7.293314e-03 3 1  ON 103
ci_055                -7.031715e-03 3 1  ON 104
ci_056                 8.154728e-03 3 1  ON 105
ci_057                 7.713405e-03 3 1  ON 106
ci_058                -9.227108e-03 3 1  ON 107
ci_059                -1.003683e-02 3 1  ON 108
ci_060                 1.013685e-02 3 1  ON 109
ci_061                 9.860329e-03 3 1  ON 110
ci_062                -6.350851e-03 3 1  ON 111
ci_063                -5.882816e-03 3 1  ON 112
ci_064                -5.357922e-03 3 1  ON 113
ci_065                -5.854857e-03 3 1  ON 114
ci_066                 8.804786e-03 3 1  ON 115
ci_067                 7.616260e-03 3 1  ON 116
ci_068                -6.970568e-03 3 1  ON 117
ci_069                -5.755435e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1746
    reference variance = 0.359039
====================================================
  Execution time = 2.0500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2257e-01
  Total weights = 1.9555e+06
  Execution time = 1.8159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314494418309
                                         uncertainty =       0.002063022277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314494418309
                                         uncertainty =       0.002063022277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396567030
  error estimate for blocks of size 2^( 2) =       0.000407043308
  error estimate for blocks of size 2^( 3) =       0.000416647505
  error estimate for blocks of size 2^( 4) =       0.000422803159
  error estimate for blocks of size 2^( 5) =       0.000426537710
  error estimate for blocks of size 2^( 6) =       0.000429624282
  error estimate for blocks of size 2^( 7) =       0.000429037922

      target function =                  N/A
              le_mean =     -17.213642676700
             les_mean =     296.645432893420
             stat err =       0.000427000768
             autocorr =       1.159375455783
              std dev =       0.560830472822
             le_variance =       0.314530819246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302844544763
                                         uncertainty =       0.001936674163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302844544763
                                         uncertainty =       0.001936674163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389250796
  error estimate for blocks of size 2^( 2) =       0.000399550389
  error estimate for blocks of size 2^( 3) =       0.000409143692
  error estimate for blocks of size 2^( 4) =       0.000415279648
  error estimate for blocks of size 2^( 5) =       0.000419037579
  error estimate for blocks of size 2^( 6) =       0.000422250902
  error estimate for blocks of size 2^( 7) =       0.000421478126

      target function =                  N/A
              le_mean =     -17.213830194183
             les_mean =     296.673667226665
             stat err =       0.000419511564
             autocorr =       1.161525785712
              std dev =       0.550483754415
             le_variance =       0.303032363875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305594567979
                                         uncertainty =       0.001897517816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305594567979
                                         uncertainty =       0.001897517816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390921413
  error estimate for blocks of size 2^( 2) =       0.000401287261
  error estimate for blocks of size 2^( 3) =       0.000410892036
  error estimate for blocks of size 2^( 4) =       0.000417023856
  error estimate for blocks of size 2^( 5) =       0.000420819925
  error estimate for blocks of size 2^( 6) =       0.000423990941
  error estimate for blocks of size 2^( 7) =       0.000423245630

      target function =                  N/A
              le_mean =     -17.213709494676
             les_mean =     296.633318254869
             stat err =       0.000421270088
             autocorr =       1.161294386299
              std dev =       0.552846364117
             le_variance =       0.305639102317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313368430681
                                         uncertainty =       0.002068417227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313368430681
                                         uncertainty =       0.002068417227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395856647
  error estimate for blocks of size 2^( 2) =       0.000406315213
  error estimate for blocks of size 2^( 3) =       0.000415921343
  error estimate for blocks of size 2^( 4) =       0.000421982291
  error estimate for blocks of size 2^( 5) =       0.000425716228
  error estimate for blocks of size 2^( 6) =       0.000428849883
  error estimate for blocks of size 2^( 7) =       0.000428073554

      target function =                  N/A
              le_mean =     -17.213664096645
             les_mean =     296.647578376968
             stat err =       0.000426155489
             autocorr =       1.158938232397
              std dev =       0.559825838463
             le_variance =       0.313404969410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.213642676700        initial
     6.2500e-01     6.2500e+00             6.0272e-03       -17.213830194183  <--
     2.5000e+00     2.5000e+01             1.6418e-03       -17.213709494676
     1.0000e+01     1.0000e+02             4.1912e-04       -17.213664096645

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9853e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 1.951197e-01 1 1  ON 0
  uu_1                 3.868271e-02 1 1  ON 1
  uu_2                -4.718623e-02 1 1  ON 2
  uu_3                -9.550293e-02 1 1  ON 3
  uu_4                -1.256258e-01 1 1  ON 4
  uu_5                -1.326168e-01 1 1  ON 5
  uu_6                -1.103658e-01 1 1  ON 6
  uu_7                -3.462606e-02 1 1  ON 7
  uu_8                 1.025298e-01 1 1  ON 8
  uu_9                 1.191660e-01 1 1  ON 9
  ud_0                 3.328374e-01 1 1  ON 10
  ud_1                 8.353121e-02 1 1  ON 11
  ud_2                -1.468799e-02 1 1  ON 12
  ud_3                -6.719849e-02 1 1  ON 13
  ud_4                -1.132043e-01 1 1  ON 14
  ud_5                -1.487804e-01 1 1  ON 15
  ud_6                -1.562682e-01 1 1  ON 16
  ud_7                -1.082509e-01 1 1  ON 17
  ud_8                 8.898216e-03 1 1  ON 18
  ud_9                 9.251063e-02 1 1  ON 19
  eO_0                -7.044188e-01 1 1  ON 20
  eO_1                -4.123303e-01 1 1  ON 21
  eO_2                -4.480863e-02 1 1  ON 22
  eO_3                 1.765476e-01 1 1  ON 23
  eO_4                 2.664976e-01 1 1  ON 24
  eO_5                 3.053913e-01 1 1  ON 25
  eO_6                 2.483550e-01 1 1  ON 26
  eO_7                 1.087951e-01 1 1  ON 27
  eO_8                 2.739987e-02 1 1  ON 28
  eO_9                 1.817691e-02 1 1  ON 29
 eH1_0                -1.780210e-01 1 1  ON 30
 eH1_1                -9.991091e-02 1 1  ON 31
 eH1_2                -6.270246e-02 1 1  ON 32
 eH1_3                -2.703726e-02 1 1  ON 33
 eH1_4                 1.924419e-02 1 1  ON 34
 eH1_5                 3.226757e-02 1 1  ON 35
 eH1_6                 7.717244e-02 1 1  ON 36
 eH1_7                 1.112884e-01 1 1  ON 37
 eH1_8                 8.895080e-02 1 1  ON 38
 eH1_9                 2.370225e-02 1 1  ON 39
 eH2_0                -1.797930e-01 1 1  ON 40
 eH2_1                -1.016167e-01 1 1  ON 41
 eH2_2                -6.446607e-02 1 1  ON 42
 eH2_3                -2.866536e-02 1 1  ON 43
 eH2_4                 1.814697e-02 1 1  ON 44
 eH2_5                 3.248872e-02 1 1  ON 45
 eH2_6                 7.943948e-02 1 1  ON 46
 eH2_7                 1.148093e-01 1 1  ON 47
 eH2_8                 9.196947e-02 1 1  ON 48
 eH2_9                 2.575902e-02 1 1  ON 49
ci_001                -5.194737e-02 3 1  ON 50
ci_002                -3.777924e-02 3 1  ON 51
ci_003                -3.024427e-02 3 1  ON 52
ci_004                 2.664005e-02 3 1  ON 53
ci_005                 2.787597e-02 3 1  ON 54
ci_006                -2.431834e-02 3 1  ON 55
ci_007                -2.470033e-02 3 1  ON 56
ci_008                -2.200868e-02 3 1  ON 57
ci_009                -2.064824e-02 3 1  ON 58
ci_010                -2.251376e-02 3 1  ON 59
ci_011                -2.022989e-02 3 1  ON 60
ci_012                -2.088000e-02 3 1  ON 61
ci_013                -2.225266e-02 3 1  ON 62
ci_014                 1.733609e-02 3 1  ON 63
ci_015                 1.893938e-02 3 1  ON 64
ci_016                 2.019393e-02 3 1  ON 65
ci_017                 1.936431e-02 3 1  ON 66
ci_018                 1.659617e-02 3 1  ON 67
ci_019                 1.702349e-02 3 1  ON 68
ci_020                 1.736137e-02 3 1  ON 69
ci_021                 1.760628e-02 3 1  ON 70
ci_022                 1.514408e-02 3 1  ON 71
ci_023                 1.485800e-02 3 1  ON 72
ci_024                 1.620197e-02 3 1  ON 73
ci_025                 1.653438e-02 3 1  ON 74
ci_026                 1.473629e-02 3 1  ON 75
ci_027                 1.466915e-02 3 1  ON 76
ci_028                -1.670555e-02 3 1  ON 77
ci_029                -1.638644e-02 3 1  ON 78
ci_030                -1.443810e-02 3 1  ON 79
ci_031                -1.440760e-02 3 1  ON 80
ci_032                -1.495988e-02 3 1  ON 81
ci_033                 1.314029e-02 3 1  ON 82
ci_034                 1.297310e-02 3 1  ON 83
ci_035                -8.319173e-03 3 1  ON 84
ci_036                -1.287644e-02 3 1  ON 85
ci_037                -1.282111e-02 3 1  ON 86
ci_038                 5.657815e-03 3 1  ON 87
ci_039                 5.861722e-03 3 1  ON 88
ci_040                -6.493444e-03 3 1  ON 89
ci_041                 1.155883e-02 3 1  ON 90
ci_042                 1.146594e-02 3 1  ON 91
ci_043                -6.719576e-03 3 1  ON 92
ci_044                -1.523898e-02 3 1  ON 93
ci_045                -5.299444e-03 3 1  ON 94
ci_046                 8.864261e-03 3 1  ON 95
ci_047                 8.739388e-03 3 1  ON 96
ci_048                -1.259263e-02 3 1  ON 97
ci_049                -1.239322e-02 3 1  ON 98
ci_050                 9.038270e-03 3 1  ON 99
ci_051                 8.860478e-03 3 1  ON 100
ci_052                -8.582311e-03 3 1  ON 101
ci_053                -8.266859e-03 3 1  ON 102
ci_054                -6.366716e-03 3 1  ON 103
ci_055                -6.265378e-03 3 1  ON 104
ci_056                 7.213170e-03 3 1  ON 105
ci_057                 6.992695e-03 3 1  ON 106
ci_058                -8.563558e-03 3 1  ON 107
ci_059                -9.336431e-03 3 1  ON 108
ci_060                 9.676044e-03 3 1  ON 109
ci_061                 9.540952e-03 3 1  ON 110
ci_062                -5.484278e-03 3 1  ON 111
ci_063                -5.227540e-03 3 1  ON 112
ci_064                -4.638166e-03 3 1  ON 113
ci_065                -5.302578e-03 3 1  ON 114
ci_066                 7.794572e-03 3 1  ON 115
ci_067                 7.122118e-03 3 1  ON 116
ci_068                -6.665346e-03 3 1  ON 117
ci_069                -5.343015e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7178e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.365108
====================================================
  Execution time = 2.0919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2630e-01
  Total weights = 1.955466274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311177852194
                                         uncertainty =       0.003524852028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311177852194
                                         uncertainty =       0.003524852028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394421679
  error estimate for blocks of size 2^( 2) =       0.000404701983
  error estimate for blocks of size 2^( 3) =       0.000413891985
  error estimate for blocks of size 2^( 4) =       0.000420839897
  error estimate for blocks of size 2^( 5) =       0.000424918273
  error estimate for blocks of size 2^( 6) =       0.000428034267
  error estimate for blocks of size 2^( 7) =       0.000427360476

      target function =                  N/A
              le_mean =     -17.215248848817
             les_mean =     296.691096530337
             stat err =       0.000425288228
             autocorr =       1.162639754270
              std dev =       0.557796487876
             le_variance =       0.311136921887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721524884882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215248848888       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215900322772       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215956839295       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216023103466       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216088684316       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216130750673       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216153556922       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216162737245       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216179443972       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216188298194       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216187921719       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216185532251       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216183961146       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216183428890       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216184904576       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216185773682       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216185674793       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216185781514       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216185710299       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e-01 is 1.607649e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215248848888       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215562437364       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215588108176       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215618320671       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215649034217       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215660218690       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215667483153       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215667974341       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215671096070       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215673099603       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215672731770       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215672403054       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215672353421       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215672188567       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215672267925       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-01 is 5.228465e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215248848888       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215350838698       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215359628579       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215369486896       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215379232783       residual = 8.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215381656519       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215383380965       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215383319917       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215383835098       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215384236951       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215384185460       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215384139477       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215384151910       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 1.426879e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6974e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 1.960226e-01 1 1  ON 0
  uu_1                 3.932201e-02 1 1  ON 1
  uu_2                -4.743834e-02 1 1  ON 2
  uu_3                -9.597987e-02 1 1  ON 3
  uu_4                -1.257612e-01 1 1  ON 4
  uu_5                -1.325714e-01 1 1  ON 5
  uu_6                -1.107645e-01 1 1  ON 6
  uu_7                -3.504490e-02 1 1  ON 7
  uu_8                 1.023814e-01 1 1  ON 8
  uu_9                 1.192665e-01 1 1  ON 9
  ud_0                 3.358549e-01 1 1  ON 10
  ud_1                 8.465427e-02 1 1  ON 11
  ud_2                -1.556227e-02 1 1  ON 12
  ud_3                -6.916665e-02 1 1  ON 13
  ud_4                -1.145108e-01 1 1  ON 14
  ud_5                -1.487982e-01 1 1  ON 15
  ud_6                -1.559888e-01 1 1  ON 16
  ud_7                -1.083751e-01 1 1  ON 17
  ud_8                 8.638456e-03 1 1  ON 18
  ud_9                 9.253160e-02 1 1  ON 19
  eO_0                -7.096473e-01 1 1  ON 20
  eO_1                -4.143078e-01 1 1  ON 21
  eO_2                -4.196903e-02 1 1  ON 22
  eO_3                 1.801402e-01 1 1  ON 23
  eO_4                 2.674448e-01 1 1  ON 24
  eO_5                 3.049673e-01 1 1  ON 25
  eO_6                 2.483589e-01 1 1  ON 26
  eO_7                 1.089732e-01 1 1  ON 27
  eO_8                 2.743173e-02 1 1  ON 28
  eO_9                 1.819939e-02 1 1  ON 29
 eH1_0                -1.785619e-01 1 1  ON 30
 eH1_1                -1.002886e-01 1 1  ON 31
 eH1_2                -6.284309e-02 1 1  ON 32
 eH1_3                -2.686919e-02 1 1  ON 33
 eH1_4                 1.953699e-02 1 1  ON 34
 eH1_5                 3.281907e-02 1 1  ON 35
 eH1_6                 7.710578e-02 1 1  ON 36
 eH1_7                 1.112253e-01 1 1  ON 37
 eH1_8                 8.906615e-02 1 1  ON 38
 eH1_9                 2.374345e-02 1 1  ON 39
 eH2_0                -1.803815e-01 1 1  ON 40
 eH2_1                -1.017539e-01 1 1  ON 41
 eH2_2                -6.426179e-02 1 1  ON 42
 eH2_3                -2.832518e-02 1 1  ON 43
 eH2_4                 1.841106e-02 1 1  ON 44
 eH2_5                 3.265044e-02 1 1  ON 45
 eH2_6                 7.920350e-02 1 1  ON 46
 eH2_7                 1.146565e-01 1 1  ON 47
 eH2_8                 9.206095e-02 1 1  ON 48
 eH2_9                 2.580333e-02 1 1  ON 49
ci_001                -4.910586e-02 3 1  ON 50
ci_002                -3.582364e-02 3 1  ON 51
ci_003                -2.919174e-02 3 1  ON 52
ci_004                 2.543446e-02 3 1  ON 53
ci_005                 2.625865e-02 3 1  ON 54
ci_006                -2.311099e-02 3 1  ON 55
ci_007                -2.309064e-02 3 1  ON 56
ci_008                -2.064891e-02 3 1  ON 57
ci_009                -1.940897e-02 3 1  ON 58
ci_010                -2.131471e-02 3 1  ON 59
ci_011                -1.931893e-02 3 1  ON 60
ci_012                -1.984828e-02 3 1  ON 61
ci_013                -2.156898e-02 3 1  ON 62
ci_014                 1.642079e-02 3 1  ON 63
ci_015                 1.764270e-02 3 1  ON 64
ci_016                 1.917779e-02 3 1  ON 65
ci_017                 1.833745e-02 3 1  ON 66
ci_018                 1.551636e-02 3 1  ON 67
ci_019                 1.583166e-02 3 1  ON 68
ci_020                 1.614747e-02 3 1  ON 69
ci_021                 1.624731e-02 3 1  ON 70
ci_022                 1.414371e-02 3 1  ON 71
ci_023                 1.369959e-02 3 1  ON 72
ci_024                 1.532354e-02 3 1  ON 73
ci_025                 1.545678e-02 3 1  ON 74
ci_026                 1.361953e-02 3 1  ON 75
ci_027                 1.355934e-02 3 1  ON 76
ci_028                -1.602661e-02 3 1  ON 77
ci_029                -1.594672e-02 3 1  ON 78
ci_030                -1.341222e-02 3 1  ON 79
ci_031                -1.355644e-02 3 1  ON 80
ci_032                -1.448142e-02 3 1  ON 81
ci_033                 1.266715e-02 3 1  ON 82
ci_034                 1.214798e-02 3 1  ON 83
ci_035                -6.986561e-03 3 1  ON 84
ci_036                -1.226158e-02 3 1  ON 85
ci_037                -1.202484e-02 3 1  ON 86
ci_038                 4.504264e-03 3 1  ON 87
ci_039                 4.421162e-03 3 1  ON 88
ci_040                -5.688827e-03 3 1  ON 89
ci_041                 1.099976e-02 3 1  ON 90
ci_042                 1.091434e-02 3 1  ON 91
ci_043                -5.598867e-03 3 1  ON 92
ci_044                -1.529306e-02 3 1  ON 93
ci_045                -4.205529e-03 3 1  ON 94
ci_046                 7.928944e-03 3 1  ON 95
ci_047                 7.691150e-03 3 1  ON 96
ci_048                -1.210726e-02 3 1  ON 97
ci_049                -1.211236e-02 3 1  ON 98
ci_050                 8.276004e-03 3 1  ON 99
ci_051                 8.235497e-03 3 1  ON 100
ci_052                -7.858963e-03 3 1  ON 101
ci_053                -7.900815e-03 3 1  ON 102
ci_054                -5.352461e-03 3 1  ON 103
ci_055                -5.412047e-03 3 1  ON 104
ci_056                 6.419078e-03 3 1  ON 105
ci_057                 6.157752e-03 3 1  ON 106
ci_058                -7.845921e-03 3 1  ON 107
ci_059                -8.094299e-03 3 1  ON 108
ci_060                 9.373328e-03 3 1  ON 109
ci_061                 9.442375e-03 3 1  ON 110
ci_062                -4.842293e-03 3 1  ON 111
ci_063                -4.702033e-03 3 1  ON 112
ci_064                -3.861430e-03 3 1  ON 113
ci_065                -4.836919e-03 3 1  ON 114
ci_066                 7.127512e-03 3 1  ON 115
ci_067                 6.851507e-03 3 1  ON 116
ci_068                -6.168401e-03 3 1  ON 117
ci_069                -5.185455e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.172364
====================================================
  Execution time = 2.0837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2054e-01
  Total weights = 1.9557e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307682480317
                                         uncertainty =       0.002696509353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307682480317
                                         uncertainty =       0.002696509353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392209421
  error estimate for blocks of size 2^( 2) =       0.000402770317
  error estimate for blocks of size 2^( 3) =       0.000411953414
  error estimate for blocks of size 2^( 4) =       0.000418264643
  error estimate for blocks of size 2^( 5) =       0.000422996682
  error estimate for blocks of size 2^( 6) =       0.000424746690
  error estimate for blocks of size 2^( 7) =       0.000426921301

      target function =                  N/A
              le_mean =     -17.215528569286
             les_mean =     296.854897357049
             stat err =       0.000423232329
             autocorr =       1.164452090915
              std dev =       0.554667883067
             le_variance =       0.307656460506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345272948037
                                         uncertainty =       0.049329244218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345272948037
                                         uncertainty =       0.049329244218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415380364
  error estimate for blocks of size 2^( 2) =       0.000425075544
  error estimate for blocks of size 2^( 3) =       0.000433675338
  error estimate for blocks of size 2^( 4) =       0.000440062139
  error estimate for blocks of size 2^( 5) =       0.000444629211
  error estimate for blocks of size 2^( 6) =       0.000445816681
  error estimate for blocks of size 2^( 7) =       0.000448548360

      target function =                  N/A
              le_mean =     -17.215430245894
             les_mean =     299.006113557402
             stat err =       0.000444764098
             autocorr =       1.146482741281
              std dev =       0.587436543711
             le_variance =       0.345081692887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301995591235
                                         uncertainty =       0.006759917737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301995591235
                                         uncertainty =       0.006759917737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388556155
  error estimate for blocks of size 2^( 2) =       0.000398897232
  error estimate for blocks of size 2^( 3) =       0.000408100446
  error estimate for blocks of size 2^( 4) =       0.000414727498
  error estimate for blocks of size 2^( 5) =       0.000419766875
  error estimate for blocks of size 2^( 6) =       0.000421680733
  error estimate for blocks of size 2^( 7) =       0.000424101589

      target function =                  N/A
              le_mean =     -17.215590005218
             les_mean =     296.959451444519
             stat err =       0.000420069174
             autocorr =       1.168783412567
              std dev =       0.549501384485
             le_variance =       0.301951771551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304202705926
                                         uncertainty =       0.002415946023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304202705926
                                         uncertainty =       0.002415946023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389986701
  error estimate for blocks of size 2^( 2) =       0.000400528962
  error estimate for blocks of size 2^( 3) =       0.000409723143
  error estimate for blocks of size 2^( 4) =       0.000416065917
  error estimate for blocks of size 2^( 5) =       0.000420838194
  error estimate for blocks of size 2^( 6) =       0.000422569123
  error estimate for blocks of size 2^( 7) =       0.000424794363

      target function =                  N/A
              le_mean =     -17.215419662243
             les_mean =     297.083552948787
             stat err =       0.000421066899
             autocorr =       1.165742448776
              std dev =       0.551524481065
             le_variance =       0.304179253215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215528569286        initial
     1.5625e-01     1.5625e+00             1.6076e-02       -17.215430245894
     6.2500e-01     6.2500e+00             5.2285e-03       -17.215590005218  <--
     2.5000e+00     2.5000e+01             1.4269e-03       -17.215419662243

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0045e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 1.960226e-01 1 1  ON 0
  uu_1                 3.932201e-02 1 1  ON 1
  uu_2                -4.743834e-02 1 1  ON 2
  uu_3                -9.597987e-02 1 1  ON 3
  uu_4                -1.257612e-01 1 1  ON 4
  uu_5                -1.325714e-01 1 1  ON 5
  uu_6                -1.107645e-01 1 1  ON 6
  uu_7                -3.504490e-02 1 1  ON 7
  uu_8                 1.023814e-01 1 1  ON 8
  uu_9                 1.192665e-01 1 1  ON 9
  ud_0                 3.358549e-01 1 1  ON 10
  ud_1                 8.465427e-02 1 1  ON 11
  ud_2                -1.556227e-02 1 1  ON 12
  ud_3                -6.916665e-02 1 1  ON 13
  ud_4                -1.145108e-01 1 1  ON 14
  ud_5                -1.487982e-01 1 1  ON 15
  ud_6                -1.559888e-01 1 1  ON 16
  ud_7                -1.083751e-01 1 1  ON 17
  ud_8                 8.638456e-03 1 1  ON 18
  ud_9                 9.253160e-02 1 1  ON 19
  eO_0                -7.096473e-01 1 1  ON 20
  eO_1                -4.143078e-01 1 1  ON 21
  eO_2                -4.196903e-02 1 1  ON 22
  eO_3                 1.801402e-01 1 1  ON 23
  eO_4                 2.674448e-01 1 1  ON 24
  eO_5                 3.049673e-01 1 1  ON 25
  eO_6                 2.483589e-01 1 1  ON 26
  eO_7                 1.089732e-01 1 1  ON 27
  eO_8                 2.743173e-02 1 1  ON 28
  eO_9                 1.819939e-02 1 1  ON 29
 eH1_0                -1.785619e-01 1 1  ON 30
 eH1_1                -1.002886e-01 1 1  ON 31
 eH1_2                -6.284309e-02 1 1  ON 32
 eH1_3                -2.686919e-02 1 1  ON 33
 eH1_4                 1.953699e-02 1 1  ON 34
 eH1_5                 3.281907e-02 1 1  ON 35
 eH1_6                 7.710578e-02 1 1  ON 36
 eH1_7                 1.112253e-01 1 1  ON 37
 eH1_8                 8.906615e-02 1 1  ON 38
 eH1_9                 2.374345e-02 1 1  ON 39
 eH2_0                -1.803815e-01 1 1  ON 40
 eH2_1                -1.017539e-01 1 1  ON 41
 eH2_2                -6.426179e-02 1 1  ON 42
 eH2_3                -2.832518e-02 1 1  ON 43
 eH2_4                 1.841106e-02 1 1  ON 44
 eH2_5                 3.265044e-02 1 1  ON 45
 eH2_6                 7.920350e-02 1 1  ON 46
 eH2_7                 1.146565e-01 1 1  ON 47
 eH2_8                 9.206095e-02 1 1  ON 48
 eH2_9                 2.580333e-02 1 1  ON 49
ci_001                -4.910586e-02 3 1  ON 50
ci_002                -3.582364e-02 3 1  ON 51
ci_003                -2.919174e-02 3 1  ON 52
ci_004                 2.543446e-02 3 1  ON 53
ci_005                 2.625865e-02 3 1  ON 54
ci_006                -2.311099e-02 3 1  ON 55
ci_007                -2.309064e-02 3 1  ON 56
ci_008                -2.064891e-02 3 1  ON 57
ci_009                -1.940897e-02 3 1  ON 58
ci_010                -2.131471e-02 3 1  ON 59
ci_011                -1.931893e-02 3 1  ON 60
ci_012                -1.984828e-02 3 1  ON 61
ci_013                -2.156898e-02 3 1  ON 62
ci_014                 1.642079e-02 3 1  ON 63
ci_015                 1.764270e-02 3 1  ON 64
ci_016                 1.917779e-02 3 1  ON 65
ci_017                 1.833745e-02 3 1  ON 66
ci_018                 1.551636e-02 3 1  ON 67
ci_019                 1.583166e-02 3 1  ON 68
ci_020                 1.614747e-02 3 1  ON 69
ci_021                 1.624731e-02 3 1  ON 70
ci_022                 1.414371e-02 3 1  ON 71
ci_023                 1.369959e-02 3 1  ON 72
ci_024                 1.532354e-02 3 1  ON 73
ci_025                 1.545678e-02 3 1  ON 74
ci_026                 1.361953e-02 3 1  ON 75
ci_027                 1.355934e-02 3 1  ON 76
ci_028                -1.602661e-02 3 1  ON 77
ci_029                -1.594672e-02 3 1  ON 78
ci_030                -1.341222e-02 3 1  ON 79
ci_031                -1.355644e-02 3 1  ON 80
ci_032                -1.448142e-02 3 1  ON 81
ci_033                 1.266715e-02 3 1  ON 82
ci_034                 1.214798e-02 3 1  ON 83
ci_035                -6.986561e-03 3 1  ON 84
ci_036                -1.226158e-02 3 1  ON 85
ci_037                -1.202484e-02 3 1  ON 86
ci_038                 4.504264e-03 3 1  ON 87
ci_039                 4.421162e-03 3 1  ON 88
ci_040                -5.688827e-03 3 1  ON 89
ci_041                 1.099976e-02 3 1  ON 90
ci_042                 1.091434e-02 3 1  ON 91
ci_043                -5.598867e-03 3 1  ON 92
ci_044                -1.529306e-02 3 1  ON 93
ci_045                -4.205529e-03 3 1  ON 94
ci_046                 7.928944e-03 3 1  ON 95
ci_047                 7.691150e-03 3 1  ON 96
ci_048                -1.210726e-02 3 1  ON 97
ci_049                -1.211236e-02 3 1  ON 98
ci_050                 8.276004e-03 3 1  ON 99
ci_051                 8.235497e-03 3 1  ON 100
ci_052                -7.858963e-03 3 1  ON 101
ci_053                -7.900815e-03 3 1  ON 102
ci_054                -5.352461e-03 3 1  ON 103
ci_055                -5.412047e-03 3 1  ON 104
ci_056                 6.419078e-03 3 1  ON 105
ci_057                 6.157752e-03 3 1  ON 106
ci_058                -7.845921e-03 3 1  ON 107
ci_059                -8.094299e-03 3 1  ON 108
ci_060                 9.373328e-03 3 1  ON 109
ci_061                 9.442375e-03 3 1  ON 110
ci_062                -4.842293e-03 3 1  ON 111
ci_063                -4.702033e-03 3 1  ON 112
ci_064                -3.861430e-03 3 1  ON 113
ci_065                -4.836919e-03 3 1  ON 114
ci_066                 7.127512e-03 3 1  ON 115
ci_067                 6.851507e-03 3 1  ON 116
ci_068                -6.168401e-03 3 1  ON 117
ci_069                -5.185455e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.414157
====================================================
  Execution time = 2.0804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2152e-01
  Total weights = 1.955980880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306671533191
                                         uncertainty =       0.003803703171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306671533191
                                         uncertainty =       0.003803703171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391514659
  error estimate for blocks of size 2^( 2) =       0.000401678734
  error estimate for blocks of size 2^( 3) =       0.000410319929
  error estimate for blocks of size 2^( 4) =       0.000417098718
  error estimate for blocks of size 2^( 5) =       0.000421130628
  error estimate for blocks of size 2^( 6) =       0.000423937341
  error estimate for blocks of size 2^( 7) =       0.000425322598

      target function =                  N/A
              le_mean =     -17.215192456347
             les_mean =     296.684368888769
             stat err =       0.000421872321
             autocorr =       1.161090336961
              std dev =       0.553685340224
             le_variance =       0.306567455979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721519245635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215192456408       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215576259674       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215613257922       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215662092734       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215715041946       residual = 9.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215733866654       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215746729815       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215751889318       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215764002165       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215771694467       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215770413418       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215768384073       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215767255284       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215768098699       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215768438570       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215768293918       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215768495663       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215768635867       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215768721508       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e-01 is 1.416611e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215192456408       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215372516049       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215388779658       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215410282578       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215433178710       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215436527105       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215439091729       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215439486142       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215441791685       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215443750881       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215443436012       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215443033827       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215442931267       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215442884928       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-01 is 4.578135e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215192456408       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215250103390       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215255565154       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215262066139       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215269083273       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215270146912       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215270178149       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215270040988       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215270649751       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215271037592       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215270982567       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215270934122       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215270942470       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 1.248941e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6882e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 1.970118e-01 1 1  ON 0
  uu_1                 3.988603e-02 1 1  ON 1
  uu_2                -4.760807e-02 1 1  ON 2
  uu_3                -9.644145e-02 1 1  ON 3
  uu_4                -1.260232e-01 1 1  ON 4
  uu_5                -1.326393e-01 1 1  ON 5
  uu_6                -1.110057e-01 1 1  ON 6
  uu_7                -3.539513e-02 1 1  ON 7
  uu_8                 1.022583e-01 1 1  ON 8
  uu_9                 1.193325e-01 1 1  ON 9
  ud_0                 3.382393e-01 1 1  ON 10
  ud_1                 8.557670e-02 1 1  ON 11
  ud_2                -1.626091e-02 1 1  ON 12
  ud_3                -7.060740e-02 1 1  ON 13
  ud_4                -1.155621e-01 1 1  ON 14
  ud_5                -1.488361e-01 1 1  ON 15
  ud_6                -1.556504e-01 1 1  ON 16
  ud_7                -1.085498e-01 1 1  ON 17
  ud_8                 8.357939e-03 1 1  ON 18
  ud_9                 9.250950e-02 1 1  ON 19
  eO_0                -7.142254e-01 1 1  ON 20
  eO_1                -4.159745e-01 1 1  ON 21
  eO_2                -3.996164e-02 1 1  ON 22
  eO_3                 1.834539e-01 1 1  ON 23
  eO_4                 2.685075e-01 1 1  ON 24
  eO_5                 3.046047e-01 1 1  ON 25
  eO_6                 2.483829e-01 1 1  ON 26
  eO_7                 1.091367e-01 1 1  ON 27
  eO_8                 2.745774e-02 1 1  ON 28
  eO_9                 1.820667e-02 1 1  ON 29
 eH1_0                -1.790423e-01 1 1  ON 30
 eH1_1                -1.005164e-01 1 1  ON 31
 eH1_2                -6.269534e-02 1 1  ON 32
 eH1_3                -2.673861e-02 1 1  ON 33
 eH1_4                 1.973084e-02 1 1  ON 34
 eH1_5                 3.308064e-02 1 1  ON 35
 eH1_6                 7.703767e-02 1 1  ON 36
 eH1_7                 1.111441e-01 1 1  ON 37
 eH1_8                 8.915405e-02 1 1  ON 38
 eH1_9                 2.377379e-02 1 1  ON 39
 eH2_0                -1.808855e-01 1 1  ON 40
 eH2_1                -1.020117e-01 1 1  ON 41
 eH2_2                -6.413031e-02 1 1  ON 42
 eH2_3                -2.818109e-02 1 1  ON 43
 eH2_4                 1.867213e-02 1 1  ON 44
 eH2_5                 3.310394e-02 1 1  ON 45
 eH2_6                 7.900981e-02 1 1  ON 46
 eH2_7                 1.145041e-01 1 1  ON 47
 eH2_8                 9.214236e-02 1 1  ON 48
 eH2_9                 2.583179e-02 1 1  ON 49
ci_001                -4.718652e-02 3 1  ON 50
ci_002                -3.414196e-02 3 1  ON 51
ci_003                -2.853734e-02 3 1  ON 52
ci_004                 2.428168e-02 3 1  ON 53
ci_005                 2.485399e-02 3 1  ON 54
ci_006                -2.194965e-02 3 1  ON 55
ci_007                -2.212963e-02 3 1  ON 56
ci_008                -1.981996e-02 3 1  ON 57
ci_009                -1.850477e-02 3 1  ON 58
ci_010                -2.022592e-02 3 1  ON 59
ci_011                -1.860101e-02 3 1  ON 60
ci_012                -1.912620e-02 3 1  ON 61
ci_013                -2.085559e-02 3 1  ON 62
ci_014                 1.564789e-02 3 1  ON 63
ci_015                 1.671055e-02 3 1  ON 64
ci_016                 1.850892e-02 3 1  ON 65
ci_017                 1.774801e-02 3 1  ON 66
ci_018                 1.465140e-02 3 1  ON 67
ci_019                 1.504697e-02 3 1  ON 68
ci_020                 1.565969e-02 3 1  ON 69
ci_021                 1.554923e-02 3 1  ON 70
ci_022                 1.362478e-02 3 1  ON 71
ci_023                 1.298122e-02 3 1  ON 72
ci_024                 1.460631e-02 3 1  ON 73
ci_025                 1.482028e-02 3 1  ON 74
ci_026                 1.292246e-02 3 1  ON 75
ci_027                 1.282838e-02 3 1  ON 76
ci_028                -1.538589e-02 3 1  ON 77
ci_029                -1.562784e-02 3 1  ON 78
ci_030                -1.269712e-02 3 1  ON 79
ci_031                -1.299431e-02 3 1  ON 80
ci_032                -1.424399e-02 3 1  ON 81
ci_033                 1.229442e-02 3 1  ON 82
ci_034                 1.195864e-02 3 1  ON 83
ci_035                -6.286775e-03 3 1  ON 84
ci_036                -1.173204e-02 3 1  ON 85
ci_037                -1.167818e-02 3 1  ON 86
ci_038                 3.723214e-03 3 1  ON 87
ci_039                 3.467022e-03 3 1  ON 88
ci_040                -4.943189e-03 3 1  ON 89
ci_041                 1.092637e-02 3 1  ON 90
ci_042                 1.067821e-02 3 1  ON 91
ci_043                -4.835221e-03 3 1  ON 92
ci_044                -1.514049e-02 3 1  ON 93
ci_045                -3.554376e-03 3 1  ON 94
ci_046                 7.269556e-03 3 1  ON 95
ci_047                 7.181459e-03 3 1  ON 96
ci_048                -1.187892e-02 3 1  ON 97
ci_049                -1.179208e-02 3 1  ON 98
ci_050                 8.187637e-03 3 1  ON 99
ci_051                 8.197865e-03 3 1  ON 100
ci_052                -7.797522e-03 3 1  ON 101
ci_053                -7.609829e-03 3 1  ON 102
ci_054                -4.581467e-03 3 1  ON 103
ci_055                -4.937272e-03 3 1  ON 104
ci_056                 5.768680e-03 3 1  ON 105
ci_057                 5.664892e-03 3 1  ON 106
ci_058                -7.648856e-03 3 1  ON 107
ci_059                -7.559105e-03 3 1  ON 108
ci_060                 8.972505e-03 3 1  ON 109
ci_061                 9.470140e-03 3 1  ON 110
ci_062                -4.536157e-03 3 1  ON 111
ci_063                -4.315175e-03 3 1  ON 112
ci_064                -3.465122e-03 3 1  ON 113
ci_065                -4.376284e-03 3 1  ON 114
ci_066                 6.571938e-03 3 1  ON 115
ci_067                 6.437156e-03 3 1  ON 116
ci_068                -5.903737e-03 3 1  ON 117
ci_069                -4.963745e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.3516
    reference variance = 0.37971
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1387e-01
  Total weights = 1.9560e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301033190842
                                         uncertainty =       0.002061881014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301033190842
                                         uncertainty =       0.002061881014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387932189
  error estimate for blocks of size 2^( 2) =       0.000398126457
  error estimate for blocks of size 2^( 3) =       0.000407219856
  error estimate for blocks of size 2^( 4) =       0.000414049341
  error estimate for blocks of size 2^( 5) =       0.000418849430
  error estimate for blocks of size 2^( 6) =       0.000420617706
  error estimate for blocks of size 2^( 7) =       0.000422643591

      target function =                  N/A
              le_mean =     -17.215492805754
             les_mean =     296.707719700691
             stat err =       0.000419040017
             autocorr =       1.166807903742
              std dev =       0.548618963496
             le_variance =       0.300982767107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714480948
                                         uncertainty =       0.002388514389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299714480948
                                         uncertainty =       0.002388514389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387083465
  error estimate for blocks of size 2^( 2) =       0.000397125852
  error estimate for blocks of size 2^( 3) =       0.000406152039
  error estimate for blocks of size 2^( 4) =       0.000412851348
  error estimate for blocks of size 2^( 5) =       0.000417752857
  error estimate for blocks of size 2^( 6) =       0.000419525088
  error estimate for blocks of size 2^( 7) =       0.000421931101

      target function =                  N/A
              le_mean =     -17.215480182561
             les_mean =     303.343014619399
             stat err =       0.000418015099
             autocorr =       1.166204457292
              std dev =       0.547418686151
             le_variance =       0.299667217947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296750224104
                                         uncertainty =       0.002035950963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296750224104
                                         uncertainty =       0.002035950963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385165642
  error estimate for blocks of size 2^( 2) =       0.000395353039
  error estimate for blocks of size 2^( 3) =       0.000404495980
  error estimate for blocks of size 2^( 4) =       0.000411269360
  error estimate for blocks of size 2^( 5) =       0.000416142160
  error estimate for blocks of size 2^( 6) =       0.000417927940
  error estimate for blocks of size 2^( 7) =       0.000420342984

      target function =                  N/A
              le_mean =     -17.215447533744
             les_mean =     296.716522947427
             stat err =       0.000416420611
             autocorr =       1.168878459586
              std dev =       0.544706474072
             le_variance =       0.296705142896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299901935368
                                         uncertainty =       0.002055042523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299901935368
                                         uncertainty =       0.002055042523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387203214
  error estimate for blocks of size 2^( 2) =       0.000397393842
  error estimate for blocks of size 2^( 3) =       0.000406488687
  error estimate for blocks of size 2^( 4) =       0.000413309064
  error estimate for blocks of size 2^( 5) =       0.000418110946
  error estimate for blocks of size 2^( 6) =       0.000419885487
  error estimate for blocks of size 2^( 7) =       0.000421977725

      target function =                  N/A
              le_mean =     -17.215450429136
             les_mean =     296.691861036714
             stat err =       0.000418320805
             autocorr =       1.167188564693
              std dev =       0.547588035989
             le_variance =       0.299852657158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215492805754        initial  <--
     1.5625e-01     1.5625e+00             1.4166e-02       -17.215480182561
     6.2500e-01     6.2500e+00             4.5781e-03       -17.215447533744
     2.5000e+00     2.5000e+01             1.2489e-03       -17.215450429136

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6819
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 1.960226e-01 1 1  ON 0
  uu_1                 3.932201e-02 1 1  ON 1
  uu_2                -4.743834e-02 1 1  ON 2
  uu_3                -9.597987e-02 1 1  ON 3
  uu_4                -1.257612e-01 1 1  ON 4
  uu_5                -1.325714e-01 1 1  ON 5
  uu_6                -1.107645e-01 1 1  ON 6
  uu_7                -3.504490e-02 1 1  ON 7
  uu_8                 1.023814e-01 1 1  ON 8
  uu_9                 1.192665e-01 1 1  ON 9
  ud_0                 3.358549e-01 1 1  ON 10
  ud_1                 8.465427e-02 1 1  ON 11
  ud_2                -1.556227e-02 1 1  ON 12
  ud_3                -6.916665e-02 1 1  ON 13
  ud_4                -1.145108e-01 1 1  ON 14
  ud_5                -1.487982e-01 1 1  ON 15
  ud_6                -1.559888e-01 1 1  ON 16
  ud_7                -1.083751e-01 1 1  ON 17
  ud_8                 8.638456e-03 1 1  ON 18
  ud_9                 9.253160e-02 1 1  ON 19
  eO_0                -7.096473e-01 1 1  ON 20
  eO_1                -4.143078e-01 1 1  ON 21
  eO_2                -4.196903e-02 1 1  ON 22
  eO_3                 1.801402e-01 1 1  ON 23
  eO_4                 2.674448e-01 1 1  ON 24
  eO_5                 3.049673e-01 1 1  ON 25
  eO_6                 2.483589e-01 1 1  ON 26
  eO_7                 1.089732e-01 1 1  ON 27
  eO_8                 2.743173e-02 1 1  ON 28
  eO_9                 1.819939e-02 1 1  ON 29
 eH1_0                -1.785619e-01 1 1  ON 30
 eH1_1                -1.002886e-01 1 1  ON 31
 eH1_2                -6.284309e-02 1 1  ON 32
 eH1_3                -2.686919e-02 1 1  ON 33
 eH1_4                 1.953699e-02 1 1  ON 34
 eH1_5                 3.281907e-02 1 1  ON 35
 eH1_6                 7.710578e-02 1 1  ON 36
 eH1_7                 1.112253e-01 1 1  ON 37
 eH1_8                 8.906615e-02 1 1  ON 38
 eH1_9                 2.374345e-02 1 1  ON 39
 eH2_0                -1.803815e-01 1 1  ON 40
 eH2_1                -1.017539e-01 1 1  ON 41
 eH2_2                -6.426179e-02 1 1  ON 42
 eH2_3                -2.832518e-02 1 1  ON 43
 eH2_4                 1.841106e-02 1 1  ON 44
 eH2_5                 3.265044e-02 1 1  ON 45
 eH2_6                 7.920350e-02 1 1  ON 46
 eH2_7                 1.146565e-01 1 1  ON 47
 eH2_8                 9.206095e-02 1 1  ON 48
 eH2_9                 2.580333e-02 1 1  ON 49
ci_001                -4.910586e-02 3 1  ON 50
ci_002                -3.582364e-02 3 1  ON 51
ci_003                -2.919174e-02 3 1  ON 52
ci_004                 2.543446e-02 3 1  ON 53
ci_005                 2.625865e-02 3 1  ON 54
ci_006                -2.311099e-02 3 1  ON 55
ci_007                -2.309064e-02 3 1  ON 56
ci_008                -2.064891e-02 3 1  ON 57
ci_009                -1.940897e-02 3 1  ON 58
ci_010                -2.131471e-02 3 1  ON 59
ci_011                -1.931893e-02 3 1  ON 60
ci_012                -1.984828e-02 3 1  ON 61
ci_013                -2.156898e-02 3 1  ON 62
ci_014                 1.642079e-02 3 1  ON 63
ci_015                 1.764270e-02 3 1  ON 64
ci_016                 1.917779e-02 3 1  ON 65
ci_017                 1.833745e-02 3 1  ON 66
ci_018                 1.551636e-02 3 1  ON 67
ci_019                 1.583166e-02 3 1  ON 68
ci_020                 1.614747e-02 3 1  ON 69
ci_021                 1.624731e-02 3 1  ON 70
ci_022                 1.414371e-02 3 1  ON 71
ci_023                 1.369959e-02 3 1  ON 72
ci_024                 1.532354e-02 3 1  ON 73
ci_025                 1.545678e-02 3 1  ON 74
ci_026                 1.361953e-02 3 1  ON 75
ci_027                 1.355934e-02 3 1  ON 76
ci_028                -1.602661e-02 3 1  ON 77
ci_029                -1.594672e-02 3 1  ON 78
ci_030                -1.341222e-02 3 1  ON 79
ci_031                -1.355644e-02 3 1  ON 80
ci_032                -1.448142e-02 3 1  ON 81
ci_033                 1.266715e-02 3 1  ON 82
ci_034                 1.214798e-02 3 1  ON 83
ci_035                -6.986561e-03 3 1  ON 84
ci_036                -1.226158e-02 3 1  ON 85
ci_037                -1.202484e-02 3 1  ON 86
ci_038                 4.504264e-03 3 1  ON 87
ci_039                 4.421162e-03 3 1  ON 88
ci_040                -5.688827e-03 3 1  ON 89
ci_041                 1.099976e-02 3 1  ON 90
ci_042                 1.091434e-02 3 1  ON 91
ci_043                -5.598867e-03 3 1  ON 92
ci_044                -1.529306e-02 3 1  ON 93
ci_045                -4.205529e-03 3 1  ON 94
ci_046                 7.928944e-03 3 1  ON 95
ci_047                 7.691150e-03 3 1  ON 96
ci_048                -1.210726e-02 3 1  ON 97
ci_049                -1.211236e-02 3 1  ON 98
ci_050                 8.276004e-03 3 1  ON 99
ci_051                 8.235497e-03 3 1  ON 100
ci_052                -7.858963e-03 3 1  ON 101
ci_053                -7.900815e-03 3 1  ON 102
ci_054                -5.352461e-03 3 1  ON 103
ci_055                -5.412047e-03 3 1  ON 104
ci_056                 6.419078e-03 3 1  ON 105
ci_057                 6.157752e-03 3 1  ON 106
ci_058                -7.845921e-03 3 1  ON 107
ci_059                -8.094299e-03 3 1  ON 108
ci_060                 9.373328e-03 3 1  ON 109
ci_061                 9.442375e-03 3 1  ON 110
ci_062                -4.842293e-03 3 1  ON 111
ci_063                -4.702033e-03 3 1  ON 112
ci_064                -3.861430e-03 3 1  ON 113
ci_065                -4.836919e-03 3 1  ON 114
ci_066                 7.127512e-03 3 1  ON 115
ci_067                 6.851507e-03 3 1  ON 116
ci_068                -6.168401e-03 3 1  ON 117
ci_069                -5.185455e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1587
    reference variance = 0.142438
====================================================
  Execution time = 2.0732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1521e-01
  Total weights = 1.956145579e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300456481454
                                         uncertainty =       0.001803375391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300456481454
                                         uncertainty =       0.001803375391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731918
  error estimate for blocks of size 2^( 2) =       0.000397947026
  error estimate for blocks of size 2^( 3) =       0.000406897109
  error estimate for blocks of size 2^( 4) =       0.000415197376
  error estimate for blocks of size 2^( 5) =       0.000419269638
  error estimate for blocks of size 2^( 6) =       0.000422245436
  error estimate for blocks of size 2^( 7) =       0.000423805639

      target function =                  N/A
              le_mean =     -17.215895729542
             les_mean =     296.702275634629
             stat err =       0.000420129522
             autocorr =       1.174095145130
              std dev =       0.548335737658
             le_variance =       0.300672081193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589572954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895729592       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215984959214       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215995804780       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007374696       residual = 7.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216017875832       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216016145466       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216018880141       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019563547       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216020402797       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216021151621       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216020741065       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216020608580       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216020654891       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+00 is 1.974757e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895729592       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215920650274       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215923890830       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215927253970       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215929987488       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215929506181       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215930149407       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215930234892       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215930452961       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215930673997       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215930617695       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215930578375       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215930576228       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 5.112789e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895729592       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215902147726       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215902999200       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215903876511       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215904566892       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215904450255       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215904606339       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215904614400       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215904671149       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215904728309       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215904717709       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215904708267       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215904706760       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 1.289486e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6822e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 1.961027e-01 1 1  ON 0
  uu_1                 3.935628e-02 1 1  ON 1
  uu_2                -4.745965e-02 1 1  ON 2
  uu_3                -9.602913e-02 1 1  ON 3
  uu_4                -1.257712e-01 1 1  ON 4
  uu_5                -1.325660e-01 1 1  ON 5
  uu_6                -1.107773e-01 1 1  ON 6
  uu_7                -3.507768e-02 1 1  ON 7
  uu_8                 1.023644e-01 1 1  ON 8
  uu_9                 1.192760e-01 1 1  ON 9
  ud_0                 3.361413e-01 1 1  ON 10
  ud_1                 8.477359e-02 1 1  ON 11
  ud_2                -1.565856e-02 1 1  ON 12
  ud_3                -6.935929e-02 1 1  ON 13
  ud_4                -1.146434e-01 1 1  ON 14
  ud_5                -1.488080e-01 1 1  ON 15
  ud_6                -1.559405e-01 1 1  ON 16
  ud_7                -1.083841e-01 1 1  ON 17
  ud_8                 8.612147e-03 1 1  ON 18
  ud_9                 9.253308e-02 1 1  ON 19
  eO_0                -7.101586e-01 1 1  ON 20
  eO_1                -4.145018e-01 1 1  ON 21
  eO_2                -4.170749e-02 1 1  ON 22
  eO_3                 1.804980e-01 1 1  ON 23
  eO_4                 2.675311e-01 1 1  ON 24
  eO_5                 3.049309e-01 1 1  ON 25
  eO_6                 2.483701e-01 1 1  ON 26
  eO_7                 1.089922e-01 1 1  ON 27
  eO_8                 2.743424e-02 1 1  ON 28
  eO_9                 1.820121e-02 1 1  ON 29
 eH1_0                -1.786056e-01 1 1  ON 30
 eH1_1                -1.002995e-01 1 1  ON 31
 eH1_2                -6.283060e-02 1 1  ON 32
 eH1_3                -2.685701e-02 1 1  ON 33
 eH1_4                 1.953984e-02 1 1  ON 34
 eH1_5                 3.284908e-02 1 1  ON 35
 eH1_6                 7.709143e-02 1 1  ON 36
 eH1_7                 1.112189e-01 1 1  ON 37
 eH1_8                 8.907957e-02 1 1  ON 38
 eH1_9                 2.374740e-02 1 1  ON 39
 eH2_0                -1.804228e-01 1 1  ON 40
 eH2_1                -1.017833e-01 1 1  ON 41
 eH2_2                -6.425311e-02 1 1  ON 42
 eH2_3                -2.831176e-02 1 1  ON 43
 eH2_4                 1.844073e-02 1 1  ON 44
 eH2_5                 3.268232e-02 1 1  ON 45
 eH2_6                 7.918148e-02 1 1  ON 46
 eH2_7                 1.146473e-01 1 1  ON 47
 eH2_8                 9.207308e-02 1 1  ON 48
 eH2_9                 2.580683e-02 1 1  ON 49
ci_001                -4.884274e-02 3 1  ON 50
ci_002                -3.561076e-02 3 1  ON 51
ci_003                -2.911335e-02 3 1  ON 52
ci_004                 2.535773e-02 3 1  ON 53
ci_005                 2.605653e-02 3 1  ON 54
ci_006                -2.294867e-02 3 1  ON 55
ci_007                -2.295036e-02 3 1  ON 56
ci_008                -2.054521e-02 3 1  ON 57
ci_009                -1.932920e-02 3 1  ON 58
ci_010                -2.119028e-02 3 1  ON 59
ci_011                -1.919696e-02 3 1  ON 60
ci_012                -1.972549e-02 3 1  ON 61
ci_013                -2.150610e-02 3 1  ON 62
ci_014                 1.636304e-02 3 1  ON 63
ci_015                 1.752036e-02 3 1  ON 64
ci_016                 1.904276e-02 3 1  ON 65
ci_017                 1.826867e-02 3 1  ON 66
ci_018                 1.541674e-02 3 1  ON 67
ci_019                 1.570436e-02 3 1  ON 68
ci_020                 1.605201e-02 3 1  ON 69
ci_021                 1.613594e-02 3 1  ON 70
ci_022                 1.405237e-02 3 1  ON 71
ci_023                 1.359581e-02 3 1  ON 72
ci_024                 1.525820e-02 3 1  ON 73
ci_025                 1.537207e-02 3 1  ON 74
ci_026                 1.352664e-02 3 1  ON 75
ci_027                 1.345423e-02 3 1  ON 76
ci_028                -1.597451e-02 3 1  ON 77
ci_029                -1.588841e-02 3 1  ON 78
ci_030                -1.334370e-02 3 1  ON 79
ci_031                -1.349810e-02 3 1  ON 80
ci_032                -1.441987e-02 3 1  ON 81
ci_033                 1.260853e-02 3 1  ON 82
ci_034                 1.209115e-02 3 1  ON 83
ci_035                -6.837030e-03 3 1  ON 84
ci_036                -1.222011e-02 3 1  ON 85
ci_037                -1.192818e-02 3 1  ON 86
ci_038                 4.385251e-03 3 1  ON 87
ci_039                 4.297785e-03 3 1  ON 88
ci_040                -5.585532e-03 3 1  ON 89
ci_041                 1.097259e-02 3 1  ON 90
ci_042                 1.086561e-02 3 1  ON 91
ci_043                -5.459092e-03 3 1  ON 92
ci_044                -1.526941e-02 3 1  ON 93
ci_045                -4.107331e-03 3 1  ON 94
ci_046                 7.813547e-03 3 1  ON 95
ci_047                 7.628714e-03 3 1  ON 96
ci_048                -1.210357e-02 3 1  ON 97
ci_049                -1.209246e-02 3 1  ON 98
ci_050                 8.257818e-03 3 1  ON 99
ci_051                 8.202771e-03 3 1  ON 100
ci_052                -7.796327e-03 3 1  ON 101
ci_053                -7.834760e-03 3 1  ON 102
ci_054                -5.252096e-03 3 1  ON 103
ci_055                -5.314268e-03 3 1  ON 104
ci_056                 6.339449e-03 3 1  ON 105
ci_057                 6.076671e-03 3 1  ON 106
ci_058                -7.809274e-03 3 1  ON 107
ci_059                -8.039544e-03 3 1  ON 108
ci_060                 9.316261e-03 3 1  ON 109
ci_061                 9.422337e-03 3 1  ON 110
ci_062                -4.762350e-03 3 1  ON 111
ci_063                -4.622691e-03 3 1  ON 112
ci_064                -3.826416e-03 3 1  ON 113
ci_065                -4.783918e-03 3 1  ON 114
ci_066                 7.076301e-03 3 1  ON 115
ci_067                 6.808010e-03 3 1  ON 116
ci_068                -6.128134e-03 3 1  ON 117
ci_069                -5.161288e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.225887
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1802e-01
  Total weights = 1.9557e+06
  Execution time = 1.8116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302882843331
                                         uncertainty =       0.002006891378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302882843331
                                         uncertainty =       0.002006891378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389128376
  error estimate for blocks of size 2^( 2) =       0.000399162920
  error estimate for blocks of size 2^( 3) =       0.000408259004
  error estimate for blocks of size 2^( 4) =       0.000414657744
  error estimate for blocks of size 2^( 5) =       0.000418032503
  error estimate for blocks of size 2^( 6) =       0.000421024316
  error estimate for blocks of size 2^( 7) =       0.000423129944

      target function =                  N/A
              le_mean =     -17.215587492794
             les_mean =     296.695795910009
             stat err =       0.000419211127
             autocorr =       1.160592604389
              std dev =       0.550310627515
             le_variance =       0.302841786756

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.101538
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301512181774
                                         uncertainty =       0.001988529086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301512181774
                                         uncertainty =       0.001988529086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388245651
  error estimate for blocks of size 2^( 2) =       0.000398267788
  error estimate for blocks of size 2^( 3) =       0.000407376922
  error estimate for blocks of size 2^( 4) =       0.000413790952
  error estimate for blocks of size 2^( 5) =       0.000417234770
  error estimate for blocks of size 2^( 6) =       0.000420245619
  error estimate for blocks of size 2^( 7) =       0.000422346365

      target function =                  N/A
              le_mean =     -17.215610653992
             les_mean =     296.708547911387
             stat err =       0.000418404426
             autocorr =       1.161393366719
              std dev =       0.549062265276
             le_variance =       0.301469371150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302003413495
                                         uncertainty =       0.001993156140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302003413495
                                         uncertainty =       0.001993156140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388562316
  error estimate for blocks of size 2^( 2) =       0.000398584869
  error estimate for blocks of size 2^( 3) =       0.000407683397
  error estimate for blocks of size 2^( 4) =       0.000414098150
  error estimate for blocks of size 2^( 5) =       0.000417501891
  error estimate for blocks of size 2^( 6) =       0.000420499081
  error estimate for blocks of size 2^( 7) =       0.000422590042

      target function =                  N/A
              le_mean =     -17.215592151647
             les_mean =     296.694290828912
             stat err =       0.000418672291
             autocorr =       1.160986261231
              std dev =       0.549510096668
             le_variance =       0.301961346341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302763820995
                                         uncertainty =       0.002005064499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302763820995
                                         uncertainty =       0.002005064499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389051814
  error estimate for blocks of size 2^( 2) =       0.000399084783
  error estimate for blocks of size 2^( 3) =       0.000408181019
  error estimate for blocks of size 2^( 4) =       0.000414580755
  error estimate for blocks of size 2^( 5) =       0.000417959135
  error estimate for blocks of size 2^( 6) =       0.000420951956
  error estimate for blocks of size 2^( 7) =       0.000423057392

      target function =                  N/A
              le_mean =     -17.215587351354
             les_mean =     296.696081171194
             stat err =       0.000419137309
             autocorr =       1.160640588193
              std dev =       0.550202351383
             le_variance =       0.302722627467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215587492794        initial
     1.5625e+00     1.5625e+01             1.9748e-03       -17.215610653992  <--
     6.2500e+00     6.2500e+01             5.1128e-04       -17.215592151647
     2.5000e+01     2.5000e+02             1.2895e-04       -17.215587351354

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9585e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 1.963528e-01 1 1  ON 0
  uu_1                 3.946961e-02 1 1  ON 1
  uu_2                -4.752778e-02 1 1  ON 2
  uu_3                -9.618032e-02 1 1  ON 3
  uu_4                -1.258220e-01 1 1  ON 4
  uu_5                -1.325503e-01 1 1  ON 5
  uu_6                -1.108107e-01 1 1  ON 6
  uu_7                -3.517319e-02 1 1  ON 7
  uu_8                 1.023144e-01 1 1  ON 8
  uu_9                 1.193043e-01 1 1  ON 9
  ud_0                 3.369215e-01 1 1  ON 10
  ud_1                 8.509114e-02 1 1  ON 11
  ud_2                -1.590488e-02 1 1  ON 12
  ud_3                -6.987835e-02 1 1  ON 13
  ud_4                -1.150128e-01 1 1  ON 14
  ud_5                -1.488426e-01 1 1  ON 15
  ud_6                -1.558019e-01 1 1  ON 16
  ud_7                -1.084112e-01 1 1  ON 17
  ud_8                 8.533959e-03 1 1  ON 18
  ud_9                 9.253764e-02 1 1  ON 19
  eO_0                -7.116220e-01 1 1  ON 20
  eO_1                -4.150599e-01 1 1  ON 21
  eO_2                -4.100340e-02 1 1  ON 22
  eO_3                 1.815405e-01 1 1  ON 23
  eO_4                 2.678011e-01 1 1  ON 24
  eO_5                 3.048267e-01 1 1  ON 25
  eO_6                 2.484045e-01 1 1  ON 26
  eO_7                 1.090494e-01 1 1  ON 27
  eO_8                 2.744179e-02 1 1  ON 28
  eO_9                 1.820668e-02 1 1  ON 29
 eH1_0                -1.787298e-01 1 1  ON 30
 eH1_1                -1.003352e-01 1 1  ON 31
 eH1_2                -6.279020e-02 1 1  ON 32
 eH1_3                -2.682382e-02 1 1  ON 33
 eH1_4                 1.954210e-02 1 1  ON 34
 eH1_5                 3.293840e-02 1 1  ON 35
 eH1_6                 7.705141e-02 1 1  ON 36
 eH1_7                 1.112004e-01 1 1  ON 37
 eH1_8                 8.911976e-02 1 1  ON 38
 eH1_9                 2.375922e-02 1 1  ON 39
 eH2_0                -1.805425e-01 1 1  ON 40
 eH2_1                -1.018683e-01 1 1  ON 41
 eH2_2                -6.422318e-02 1 1  ON 42
 eH2_3                -2.827510e-02 1 1  ON 43
 eH2_4                 1.851738e-02 1 1  ON 44
 eH2_5                 3.277875e-02 1 1  ON 45
 eH2_6                 7.911885e-02 1 1  ON 46
 eH2_7                 1.146203e-01 1 1  ON 47
 eH2_8                 9.210941e-02 1 1  ON 48
 eH2_9                 2.581733e-02 1 1  ON 49
ci_001                -4.814429e-02 3 1  ON 50
ci_002                -3.505604e-02 3 1  ON 51
ci_003                -2.890241e-02 3 1  ON 52
ci_004                 2.515322e-02 3 1  ON 53
ci_005                 2.551502e-02 3 1  ON 54
ci_006                -2.252639e-02 3 1  ON 55
ci_007                -2.258616e-02 3 1  ON 56
ci_008                -2.028207e-02 3 1  ON 57
ci_009                -1.912641e-02 3 1  ON 58
ci_010                -2.085540e-02 3 1  ON 59
ci_011                -1.887680e-02 3 1  ON 60
ci_012                -1.940481e-02 3 1  ON 61
ci_013                -2.133876e-02 3 1  ON 62
ci_014                 1.621240e-02 3 1  ON 63
ci_015                 1.720078e-02 3 1  ON 64
ci_016                 1.869333e-02 3 1  ON 65
ci_017                 1.809321e-02 3 1  ON 66
ci_018                 1.516222e-02 3 1  ON 67
ci_019                 1.537812e-02 3 1  ON 68
ci_020                 1.580400e-02 3 1  ON 69
ci_021                 1.584292e-02 3 1  ON 70
ci_022                 1.381907e-02 3 1  ON 71
ci_023                 1.333084e-02 3 1  ON 72
ci_024                 1.507776e-02 3 1  ON 73
ci_025                 1.513726e-02 3 1  ON 74
ci_026                 1.328775e-02 3 1  ON 75
ci_027                 1.318509e-02 3 1  ON 76
ci_028                -1.584150e-02 3 1  ON 77
ci_029                -1.573795e-02 3 1  ON 78
ci_030                -1.316814e-02 3 1  ON 79
ci_031                -1.335118e-02 3 1  ON 80
ci_032                -1.426497e-02 3 1  ON 81
ci_033                 1.245283e-02 3 1  ON 82
ci_034                 1.193869e-02 3 1  ON 83
ci_035                -6.473068e-03 3 1  ON 84
ci_036                -1.211320e-02 3 1  ON 85
ci_037                -1.167535e-02 3 1  ON 86
ci_038                 4.094820e-03 3 1  ON 87
ci_039                 3.996470e-03 3 1  ON 88
ci_040                -5.338256e-03 3 1  ON 89
ci_041                 1.090661e-02 3 1  ON 90
ci_042                 1.074423e-02 3 1  ON 91
ci_043                -5.115896e-03 3 1  ON 92
ci_044                -1.520638e-02 3 1  ON 93
ci_045                -3.868198e-03 3 1  ON 94
ci_046                 7.514607e-03 3 1  ON 95
ci_047                 7.467896e-03 3 1  ON 96
ci_048                -1.210039e-02 3 1  ON 97
ci_049                -1.204474e-02 3 1  ON 98
ci_050                 8.210927e-03 3 1  ON 99
ci_051                 8.121604e-03 3 1  ON 100
ci_052                -7.638997e-03 3 1  ON 101
ci_053                -7.668703e-03 3 1  ON 102
ci_054                -4.996860e-03 3 1  ON 103
ci_055                -5.064964e-03 3 1  ON 104
ci_056                 6.137893e-03 3 1  ON 105
ci_057                 5.873212e-03 3 1  ON 106
ci_058                -7.717385e-03 3 1  ON 107
ci_059                -7.900045e-03 3 1  ON 108
ci_060                 9.167537e-03 3 1  ON 109
ci_061                 9.369778e-03 3 1  ON 110
ci_062                -4.559785e-03 3 1  ON 111
ci_063                -4.420416e-03 3 1  ON 112
ci_064                -3.743365e-03 3 1  ON 113
ci_065                -4.660855e-03 3 1  ON 114
ci_066                 6.946886e-03 3 1  ON 115
ci_067                 6.700635e-03 3 1  ON 116
ci_068                -6.028244e-03 3 1  ON 117
ci_069                -5.101459e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.278
    reference variance = 0.211165
====================================================
  Execution time = 2.1227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1587e-01
  Total weights = 1.955824638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301871367176
                                         uncertainty =       0.002018374865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301871367176
                                         uncertainty =       0.002018374865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388538539
  error estimate for blocks of size 2^( 2) =       0.000398467860
  error estimate for blocks of size 2^( 3) =       0.000407348960
  error estimate for blocks of size 2^( 4) =       0.000413748138
  error estimate for blocks of size 2^( 5) =       0.000418286273
  error estimate for blocks of size 2^( 6) =       0.000419959742
  error estimate for blocks of size 2^( 7) =       0.000422040345

      target function =                  N/A
              le_mean =     -17.215467990415
             les_mean =     296.688208248051
             stat err =       0.000418508625
             autocorr =       1.160220726726
              std dev =       0.549476470921
             le_variance =       0.301924392096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721546799042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215467990421       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215660619399       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215675806599       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215700605911       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215742514228       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215741656238       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215743839403       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215745497342       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215747556002       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215746575557       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215746113548       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215745650666       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215745378124       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215745448110       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215745662836       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215745802391       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e-01 is 6.622375e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215467990421       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215535553994       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215541974978       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215551956378       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215563640009       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215563601952       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215562936275       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215564221589       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215564290146       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215564391601       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215564301113       residual = 9.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215564098442       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215564061808       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215564046683       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+00 is 1.870140e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215467990421       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215486773502       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215488709985       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215491618083       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215494560912       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215494721091       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215494366770       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215494695050       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215494712472       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215494775898       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215494761071       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215494716477       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215494706065       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 4.828052e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7333e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 1.967219e-01 1 1  ON 0
  uu_1                 3.969051e-02 1 1  ON 1
  uu_2                -4.761362e-02 1 1  ON 2
  uu_3                -9.642074e-02 1 1  ON 3
  uu_4                -1.259226e-01 1 1  ON 4
  uu_5                -1.324879e-01 1 1  ON 5
  uu_6                -1.109017e-01 1 1  ON 6
  uu_7                -3.530734e-02 1 1  ON 7
  uu_8                 1.022498e-01 1 1  ON 8
  uu_9                 1.193364e-01 1 1  ON 9
  ud_0                 3.379389e-01 1 1  ON 10
  ud_1                 8.545464e-02 1 1  ON 11
  ud_2                -1.619275e-02 1 1  ON 12
  ud_3                -7.051851e-02 1 1  ON 13
  ud_4                -1.154919e-01 1 1  ON 14
  ud_5                -1.488451e-01 1 1  ON 15
  ud_6                -1.556612e-01 1 1  ON 16
  ud_7                -1.084333e-01 1 1  ON 17
  ud_8                 8.438851e-03 1 1  ON 18
  ud_9                 9.252199e-02 1 1  ON 19
  eO_0                -7.134922e-01 1 1  ON 20
  eO_1                -4.158008e-01 1 1  ON 21
  eO_2                -4.010219e-02 1 1  ON 22
  eO_3                 1.828944e-01 1 1  ON 23
  eO_4                 2.681643e-01 1 1  ON 24
  eO_5                 3.046953e-01 1 1  ON 25
  eO_6                 2.484434e-01 1 1  ON 26
  eO_7                 1.091202e-01 1 1  ON 27
  eO_8                 2.745226e-02 1 1  ON 28
  eO_9                 1.820967e-02 1 1  ON 29
 eH1_0                -1.788871e-01 1 1  ON 30
 eH1_1                -1.004945e-01 1 1  ON 31
 eH1_2                -6.277431e-02 1 1  ON 32
 eH1_3                -2.676319e-02 1 1  ON 33
 eH1_4                 1.960760e-02 1 1  ON 34
 eH1_5                 3.311404e-02 1 1  ON 35
 eH1_6                 7.703162e-02 1 1  ON 36
 eH1_7                 1.111766e-01 1 1  ON 37
 eH1_8                 8.915246e-02 1 1  ON 38
 eH1_9                 2.376655e-02 1 1  ON 39
 eH2_0                -1.806532e-01 1 1  ON 40
 eH2_1                -1.020335e-01 1 1  ON 41
 eH2_2                -6.420057e-02 1 1  ON 42
 eH2_3                -2.821982e-02 1 1  ON 43
 eH2_4                 1.858457e-02 1 1  ON 44
 eH2_5                 3.295635e-02 1 1  ON 45
 eH2_6                 7.903114e-02 1 1  ON 46
 eH2_7                 1.146036e-01 1 1  ON 47
 eH2_8                 9.215745e-02 1 1  ON 48
 eH2_9                 2.582572e-02 1 1  ON 49
ci_001                -4.730899e-02 3 1  ON 50
ci_002                -3.433410e-02 3 1  ON 51
ci_003                -2.848855e-02 3 1  ON 52
ci_004                 2.461677e-02 3 1  ON 53
ci_005                 2.515479e-02 3 1  ON 54
ci_006                -2.210602e-02 3 1  ON 55
ci_007                -2.230338e-02 3 1  ON 56
ci_008                -1.987805e-02 3 1  ON 57
ci_009                -1.898581e-02 3 1  ON 58
ci_010                -2.058765e-02 3 1  ON 59
ci_011                -1.862882e-02 3 1  ON 60
ci_012                -1.907843e-02 3 1  ON 61
ci_013                -2.110363e-02 3 1  ON 62
ci_014                 1.601328e-02 3 1  ON 63
ci_015                 1.670808e-02 3 1  ON 64
ci_016                 1.836514e-02 3 1  ON 65
ci_017                 1.779701e-02 3 1  ON 66
ci_018                 1.496141e-02 3 1  ON 67
ci_019                 1.500118e-02 3 1  ON 68
ci_020                 1.541434e-02 3 1  ON 69
ci_021                 1.565950e-02 3 1  ON 70
ci_022                 1.333629e-02 3 1  ON 71
ci_023                 1.311409e-02 3 1  ON 72
ci_024                 1.476017e-02 3 1  ON 73
ci_025                 1.469596e-02 3 1  ON 74
ci_026                 1.289619e-02 3 1  ON 75
ci_027                 1.299057e-02 3 1  ON 76
ci_028                -1.567193e-02 3 1  ON 77
ci_029                -1.559233e-02 3 1  ON 78
ci_030                -1.298823e-02 3 1  ON 79
ci_031                -1.306118e-02 3 1  ON 80
ci_032                -1.415227e-02 3 1  ON 81
ci_033                 1.216817e-02 3 1  ON 82
ci_034                 1.181693e-02 3 1  ON 83
ci_035                -6.213961e-03 3 1  ON 84
ci_036                -1.189840e-02 3 1  ON 85
ci_037                -1.144801e-02 3 1  ON 86
ci_038                 3.805143e-03 3 1  ON 87
ci_039                 3.638888e-03 3 1  ON 88
ci_040                -5.082361e-03 3 1  ON 89
ci_041                 1.075880e-02 3 1  ON 90
ci_042                 1.056515e-02 3 1  ON 91
ci_043                -4.797976e-03 3 1  ON 92
ci_044                -1.510395e-02 3 1  ON 93
ci_045                -3.550155e-03 3 1  ON 94
ci_046                 7.191990e-03 3 1  ON 95
ci_047                 7.336509e-03 3 1  ON 96
ci_048                -1.200537e-02 3 1  ON 97
ci_049                -1.191080e-02 3 1  ON 98
ci_050                 8.038640e-03 3 1  ON 99
ci_051                 8.014508e-03 3 1  ON 100
ci_052                -7.455764e-03 3 1  ON 101
ci_053                -7.733294e-03 3 1  ON 102
ci_054                -4.681566e-03 3 1  ON 103
ci_055                -4.845520e-03 3 1  ON 104
ci_056                 5.738520e-03 3 1  ON 105
ci_057                 5.621657e-03 3 1  ON 106
ci_058                -7.651965e-03 3 1  ON 107
ci_059                -7.538152e-03 3 1  ON 108
ci_060                 8.996965e-03 3 1  ON 109
ci_061                 9.262193e-03 3 1  ON 110
ci_062                -4.376540e-03 3 1  ON 111
ci_063                -4.262892e-03 3 1  ON 112
ci_064                -3.592533e-03 3 1  ON 113
ci_065                -4.602543e-03 3 1  ON 114
ci_066                 6.659195e-03 3 1  ON 115
ci_067                 6.472346e-03 3 1  ON 116
ci_068                -5.718271e-03 3 1  ON 117
ci_069                -5.080925e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.28616
====================================================
  Execution time = 2.0908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1599e-01
  Total weights = 1.9561e+06
  Execution time = 1.8166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303257883829
                                         uncertainty =       0.001852637441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303257883829
                                         uncertainty =       0.001852637441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389462176
  error estimate for blocks of size 2^( 2) =       0.000399743489
  error estimate for blocks of size 2^( 3) =       0.000408584536
  error estimate for blocks of size 2^( 4) =       0.000415386493
  error estimate for blocks of size 2^( 5) =       0.000418743127
  error estimate for blocks of size 2^( 6) =       0.000421458665
  error estimate for blocks of size 2^( 7) =       0.000421978069

      target function =                  N/A
              le_mean =     -17.216214838989
             les_mean =     296.723859201185
             stat err =       0.000419391589
             autocorr =       1.159601742663
              std dev =       0.550782691768
             le_variance =       0.303361573551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300918726793
                                         uncertainty =       0.001860240895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300918726793
                                         uncertainty =       0.001860240895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387951472
  error estimate for blocks of size 2^( 2) =       0.000398199353
  error estimate for blocks of size 2^( 3) =       0.000407040766
  error estimate for blocks of size 2^( 4) =       0.000413905456
  error estimate for blocks of size 2^( 5) =       0.000417261786
  error estimate for blocks of size 2^( 6) =       0.000419905670
  error estimate for blocks of size 2^( 7) =       0.000420388963

      target function =                  N/A
              le_mean =     -17.216239758304
             les_mean =     296.714664321116
             stat err =       0.000417865469
             autocorr =       1.160160726909
              std dev =       0.548646232881
             le_variance =       0.301012688854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301190117966
                                         uncertainty =       0.001850471518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301190117966
                                         uncertainty =       0.001850471518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388128152
  error estimate for blocks of size 2^( 2) =       0.000398399593
  error estimate for blocks of size 2^( 3) =       0.000407251020
  error estimate for blocks of size 2^( 4) =       0.000414107868
  error estimate for blocks of size 2^( 5) =       0.000417465215
  error estimate for blocks of size 2^( 6) =       0.000420137751
  error estimate for blocks of size 2^( 7) =       0.000420639199

      target function =                  N/A
              le_mean =     -17.216210148830
             les_mean =     296.714452006133
             stat err =       0.000418087508
             autocorr =       1.160336876955
              std dev =       0.548896096265
             le_variance =       0.301286924495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302902197670
                                         uncertainty =       0.001851331909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302902197670
                                         uncertainty =       0.001851331909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389233173
  error estimate for blocks of size 2^( 2) =       0.000399515892
  error estimate for blocks of size 2^( 3) =       0.000408358531
  error estimate for blocks of size 2^( 4) =       0.000415167205
  error estimate for blocks of size 2^( 5) =       0.000418521996
  error estimate for blocks of size 2^( 6) =       0.000421230977
  error estimate for blocks of size 2^( 7) =       0.000421748451

      target function =                  N/A
              le_mean =     -17.216207554672
             les_mean =     296.716772080896
             stat err =       0.000419167157
             autocorr =       1.159724416508
              std dev =       0.550458832772
             le_variance =       0.303004926577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216214838989        initial
     3.9062e-01     3.9062e+00             6.6224e-03       -17.216239758304  <--
     1.5625e+00     1.5625e+01             1.8701e-03       -17.216210148830
     6.2500e+00     6.2500e+01             4.8281e-04       -17.216207554672

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0075e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 1.978421e-01 1 1  ON 0
  uu_1                 4.030327e-02 1 1  ON 1
  uu_2                -4.779312e-02 1 1  ON 2
  uu_3                -9.702327e-02 1 1  ON 3
  uu_4                -1.263486e-01 1 1  ON 4
  uu_5                -1.324532e-01 1 1  ON 5
  uu_6                -1.111030e-01 1 1  ON 6
  uu_7                -3.567374e-02 1 1  ON 7
  uu_8                 1.020618e-01 1 1  ON 8
  uu_9                 1.194349e-01 1 1  ON 9
  ud_0                 3.401045e-01 1 1  ON 10
  ud_1                 8.628406e-02 1 1  ON 11
  ud_2                -1.671672e-02 1 1  ON 12
  ud_3                -7.185528e-02 1 1  ON 13
  ud_4                -1.165905e-01 1 1  ON 14
  ud_5                -1.489649e-01 1 1  ON 15
  ud_6                -1.552734e-01 1 1  ON 16
  ud_7                -1.084787e-01 1 1  ON 17
  ud_8                 8.161504e-03 1 1  ON 18
  ud_9                 9.247685e-02 1 1  ON 19
  eO_0                -7.182444e-01 1 1  ON 20
  eO_1                -4.177762e-01 1 1  ON 21
  eO_2                -3.829058e-02 1 1  ON 22
  eO_3                 1.864205e-01 1 1  ON 23
  eO_4                 2.694554e-01 1 1  ON 24
  eO_5                 3.044016e-01 1 1  ON 25
  eO_6                 2.485735e-01 1 1  ON 26
  eO_7                 1.093377e-01 1 1  ON 27
  eO_8                 2.748488e-02 1 1  ON 28
  eO_9                 1.821885e-02 1 1  ON 29
 eH1_0                -1.793067e-01 1 1  ON 30
 eH1_1                -1.009066e-01 1 1  ON 31
 eH1_2                -6.270609e-02 1 1  ON 32
 eH1_3                -2.663910e-02 1 1  ON 33
 eH1_4                 1.970373e-02 1 1  ON 34
 eH1_5                 3.359630e-02 1 1  ON 35
 eH1_6                 7.702314e-02 1 1  ON 36
 eH1_7                 1.111155e-01 1 1  ON 37
 eH1_8                 8.925257e-02 1 1  ON 38
 eH1_9                 2.378924e-02 1 1  ON 39
 eH2_0                -1.809632e-01 1 1  ON 40
 eH2_1                -1.024458e-01 1 1  ON 41
 eH2_2                -6.411626e-02 1 1  ON 42
 eH2_3                -2.809975e-02 1 1  ON 43
 eH2_4                 1.868357e-02 1 1  ON 44
 eH2_5                 3.344658e-02 1 1  ON 45
 eH2_6                 7.882487e-02 1 1  ON 46
 eH2_7                 1.145632e-01 1 1  ON 47
 eH2_8                 9.230332e-02 1 1  ON 48
 eH2_9                 2.585154e-02 1 1  ON 49
ci_001                -4.560635e-02 3 1  ON 50
ci_002                -3.295665e-02 3 1  ON 51
ci_003                -2.762482e-02 3 1  ON 52
ci_004                 2.352137e-02 3 1  ON 53
ci_005                 2.443449e-02 3 1  ON 54
ci_006                -2.131206e-02 3 1  ON 55
ci_007                -2.179094e-02 3 1  ON 56
ci_008                -1.916311e-02 3 1  ON 57
ci_009                -1.873526e-02 3 1  ON 58
ci_010                -2.001489e-02 3 1  ON 59
ci_011                -1.814295e-02 3 1  ON 60
ci_012                -1.843234e-02 3 1  ON 61
ci_013                -2.061305e-02 3 1  ON 62
ci_014                 1.563776e-02 3 1  ON 63
ci_015                 1.577424e-02 3 1  ON 64
ci_016                 1.776025e-02 3 1  ON 65
ci_017                 1.724809e-02 3 1  ON 66
ci_018                 1.460753e-02 3 1  ON 67
ci_019                 1.431664e-02 3 1  ON 68
ci_020                 1.464634e-02 3 1  ON 69
ci_021                 1.532423e-02 3 1  ON 70
ci_022                 1.244860e-02 3 1  ON 71
ci_023                 1.272426e-02 3 1  ON 72
ci_024                 1.405392e-02 3 1  ON 73
ci_025                 1.373269e-02 3 1  ON 74
ci_026                 1.216222e-02 3 1  ON 75
ci_027                 1.264133e-02 3 1  ON 76
ci_028                -1.536574e-02 3 1  ON 77
ci_029                -1.533269e-02 3 1  ON 78
ci_030                -1.266787e-02 3 1  ON 79
ci_031                -1.252387e-02 3 1  ON 80
ci_032                -1.395934e-02 3 1  ON 81
ci_033                 1.161251e-02 3 1  ON 82
ci_034                 1.156801e-02 3 1  ON 83
ci_035                -5.788467e-03 3 1  ON 84
ci_036                -1.148963e-02 3 1  ON 85
ci_037                -1.101682e-02 3 1  ON 86
ci_038                 3.321776e-03 3 1  ON 87
ci_039                 3.051351e-03 3 1  ON 88
ci_040                -4.680285e-03 3 1  ON 89
ci_041                 1.050106e-02 3 1  ON 90
ci_042                 1.025205e-02 3 1  ON 91
ci_043                -4.274372e-03 3 1  ON 92
ci_044                -1.488978e-02 3 1  ON 93
ci_045                -3.046129e-03 3 1  ON 94
ci_046                 6.587767e-03 3 1  ON 95
ci_047                 7.085426e-03 3 1  ON 96
ci_048                -1.185361e-02 3 1  ON 97
ci_049                -1.167719e-02 3 1  ON 98
ci_050                 7.751696e-03 3 1  ON 99
ci_051                 7.834881e-03 3 1  ON 100
ci_052                -7.134608e-03 3 1  ON 101
ci_053                -7.835273e-03 3 1  ON 102
ci_054                -4.112697e-03 3 1  ON 103
ci_055                -4.444843e-03 3 1  ON 104
ci_056                 5.055810e-03 3 1  ON 105
ci_057                 5.194387e-03 3 1  ON 106
ci_058                -7.534951e-03 3 1  ON 107
ci_059                -6.895990e-03 3 1  ON 108
ci_060                 8.659028e-03 3 1  ON 109
ci_061                 9.069346e-03 3 1  ON 110
ci_062                -4.045959e-03 3 1  ON 111
ci_063                -3.971129e-03 3 1  ON 112
ci_064                -3.369593e-03 3 1  ON 113
ci_065                -4.506821e-03 3 1  ON 114
ci_066                 6.172199e-03 3 1  ON 115
ci_067                 6.094764e-03 3 1  ON 116
ci_068                -5.162048e-03 3 1  ON 117
ci_069                -5.059161e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2881
    reference variance = 0.468633
====================================================
  Execution time = 2.2557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1084e-01
  Total weights = 1.956150893e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297078272283
                                         uncertainty =       0.001744924304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297078272283
                                         uncertainty =       0.001744924304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385469244
  error estimate for blocks of size 2^( 2) =       0.000395678277
  error estimate for blocks of size 2^( 3) =       0.000404688957
  error estimate for blocks of size 2^( 4) =       0.000411279849
  error estimate for blocks of size 2^( 5) =       0.000415951795
  error estimate for blocks of size 2^( 6) =       0.000417541309
  error estimate for blocks of size 2^( 7) =       0.000418719791

      target function =                  N/A
              le_mean =     -17.216083201986
             les_mean =     296.704363001078
             stat err =       0.000415873186
             autocorr =       1.163971573777
              std dev =       0.545135832992
             le_variance =       0.297173076412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608320199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083202031       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216213924998       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216231975277       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216257492407       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216310572696       residual = 7.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216316348803       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216335365598       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216332421985       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216327979260       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216336219779       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216335165849       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216335445290       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216336023812       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216337749792       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216338695242       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216339182603       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216339074499       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216339068436       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216338632990       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216338647693       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216338849435       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-02 is 1.615035e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083202031       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216152960656       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216163277916       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216174025436       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216200639101       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216198931933       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216202296189       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216202832443       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216201082085       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216202620711       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216202488426       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216202114749       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216202104535       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216202309953       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e-01 is 5.590676e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083202031       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107546510       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216111495128       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216114652691       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216123095801       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216122157305       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216122877455       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216123006024       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216122834716       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216123026127       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216123083118       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216122950706       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+00 is 1.592894e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8589e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 1.991144e-01 1 1  ON 0
  uu_1                 4.126749e-02 1 1  ON 1
  uu_2                -4.789105e-02 1 1  ON 2
  uu_3                -9.751116e-02 1 1  ON 3
  uu_4                -1.270305e-01 1 1  ON 4
  uu_5                -1.328903e-01 1 1  ON 5
  uu_6                -1.113451e-01 1 1  ON 6
  uu_7                -3.610342e-02 1 1  ON 7
  uu_8                 1.019120e-01 1 1  ON 8
  uu_9                 1.195688e-01 1 1  ON 9
  ud_0                 3.421626e-01 1 1  ON 10
  ud_1                 8.722873e-02 1 1  ON 11
  ud_2                -1.710192e-02 1 1  ON 12
  ud_3                -7.300684e-02 1 1  ON 13
  ud_4                -1.176058e-01 1 1  ON 14
  ud_5                -1.493455e-01 1 1  ON 15
  ud_6                -1.549195e-01 1 1  ON 16
  ud_7                -1.086530e-01 1 1  ON 17
  ud_8                 7.699563e-03 1 1  ON 18
  ud_9                 9.249924e-02 1 1  ON 19
  eO_0                -7.238351e-01 1 1  ON 20
  eO_1                -4.199907e-01 1 1  ON 21
  eO_2                -3.671657e-02 1 1  ON 22
  eO_3                 1.907120e-01 1 1  ON 23
  eO_4                 2.712911e-01 1 1  ON 24
  eO_5                 3.039848e-01 1 1  ON 25
  eO_6                 2.486957e-01 1 1  ON 26
  eO_7                 1.096518e-01 1 1  ON 27
  eO_8                 2.752691e-02 1 1  ON 28
  eO_9                 1.824002e-02 1 1  ON 29
 eH1_0                -1.799198e-01 1 1  ON 30
 eH1_1                -1.013465e-01 1 1  ON 31
 eH1_2                -6.255857e-02 1 1  ON 32
 eH1_3                -2.656668e-02 1 1  ON 33
 eH1_4                 1.991319e-02 1 1  ON 34
 eH1_5                 3.432770e-02 1 1  ON 35
 eH1_6                 7.683496e-02 1 1  ON 36
 eH1_7                 1.109820e-01 1 1  ON 37
 eH1_8                 8.937693e-02 1 1  ON 38
 eH1_9                 2.385071e-02 1 1  ON 39
 eH2_0                -1.814549e-01 1 1  ON 40
 eH2_1                -1.027390e-01 1 1  ON 41
 eH2_2                -6.401975e-02 1 1  ON 42
 eH2_3                -2.807466e-02 1 1  ON 43
 eH2_4                 1.877533e-02 1 1  ON 44
 eH2_5                 3.400507e-02 1 1  ON 45
 eH2_6                 7.866382e-02 1 1  ON 46
 eH2_7                 1.144678e-01 1 1  ON 47
 eH2_8                 9.249517e-02 1 1  ON 48
 eH2_9                 2.590421e-02 1 1  ON 49
ci_001                -4.371631e-02 3 1  ON 50
ci_002                -3.205061e-02 3 1  ON 51
ci_003                -2.681482e-02 3 1  ON 52
ci_004                 2.274999e-02 3 1  ON 53
ci_005                 2.363008e-02 3 1  ON 54
ci_006                -2.027768e-02 3 1  ON 55
ci_007                -2.089974e-02 3 1  ON 56
ci_008                -1.863363e-02 3 1  ON 57
ci_009                -1.811896e-02 3 1  ON 58
ci_010                -1.931049e-02 3 1  ON 59
ci_011                -1.753127e-02 3 1  ON 60
ci_012                -1.758656e-02 3 1  ON 61
ci_013                -2.029211e-02 3 1  ON 62
ci_014                 1.509476e-02 3 1  ON 63
ci_015                 1.507513e-02 3 1  ON 64
ci_016                 1.697711e-02 3 1  ON 65
ci_017                 1.645973e-02 3 1  ON 66
ci_018                 1.409992e-02 3 1  ON 67
ci_019                 1.404067e-02 3 1  ON 68
ci_020                 1.395082e-02 3 1  ON 69
ci_021                 1.483933e-02 3 1  ON 70
ci_022                 1.258249e-02 3 1  ON 71
ci_023                 1.240793e-02 3 1  ON 72
ci_024                 1.318556e-02 3 1  ON 73
ci_025                 1.338335e-02 3 1  ON 74
ci_026                 1.126329e-02 3 1  ON 75
ci_027                 1.191949e-02 3 1  ON 76
ci_028                -1.503554e-02 3 1  ON 77
ci_029                -1.479830e-02 3 1  ON 78
ci_030                -1.246784e-02 3 1  ON 79
ci_031                -1.192700e-02 3 1  ON 80
ci_032                -1.361672e-02 3 1  ON 81
ci_033                 1.116887e-02 3 1  ON 82
ci_034                 1.123180e-02 3 1  ON 83
ci_035                -5.236886e-03 3 1  ON 84
ci_036                -1.115164e-02 3 1  ON 85
ci_037                -1.071974e-02 3 1  ON 86
ci_038                 2.491612e-03 3 1  ON 87
ci_039                 2.818125e-03 3 1  ON 88
ci_040                -4.369986e-03 3 1  ON 89
ci_041                 1.025780e-02 3 1  ON 90
ci_042                 1.033998e-02 3 1  ON 91
ci_043                -3.909239e-03 3 1  ON 92
ci_044                -1.511119e-02 3 1  ON 93
ci_045                -2.428301e-03 3 1  ON 94
ci_046                 6.484911e-03 3 1  ON 95
ci_047                 6.567192e-03 3 1  ON 96
ci_048                -1.214964e-02 3 1  ON 97
ci_049                -1.169476e-02 3 1  ON 98
ci_050                 7.591657e-03 3 1  ON 99
ci_051                 7.753748e-03 3 1  ON 100
ci_052                -6.539300e-03 3 1  ON 101
ci_053                -7.014104e-03 3 1  ON 102
ci_054                -3.635640e-03 3 1  ON 103
ci_055                -3.742128e-03 3 1  ON 104
ci_056                 4.736167e-03 3 1  ON 105
ci_057                 4.957144e-03 3 1  ON 106
ci_058                -7.173140e-03 3 1  ON 107
ci_059                -6.739606e-03 3 1  ON 108
ci_060                 8.447812e-03 3 1  ON 109
ci_061                 8.516414e-03 3 1  ON 110
ci_062                -3.776963e-03 3 1  ON 111
ci_063                -3.734137e-03 3 1  ON 112
ci_064                -3.326375e-03 3 1  ON 113
ci_065                -4.337056e-03 3 1  ON 114
ci_066                 6.272374e-03 3 1  ON 115
ci_067                 5.922978e-03 3 1  ON 116
ci_068                -5.328868e-03 3 1  ON 117
ci_069                -5.045982e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.259939
====================================================
  Execution time = 2.0670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1411e-01
  Total weights = 1.9564e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301035898737
                                         uncertainty =       0.002408188175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301035898737
                                         uncertainty =       0.002408188175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387933544
  error estimate for blocks of size 2^( 2) =       0.000397686727
  error estimate for blocks of size 2^( 3) =       0.000407146146
  error estimate for blocks of size 2^( 4) =       0.000414121614
  error estimate for blocks of size 2^( 5) =       0.000417923474
  error estimate for blocks of size 2^( 6) =       0.000420675328
  error estimate for blocks of size 2^( 7) =       0.000420975083

      target function =                  N/A
              le_mean =     -17.216479320279
             les_mean =     296.801669258208
             stat err =       0.000418423875
             autocorr =       1.163371034149
              std dev =       0.548620878920
             le_variance =       0.300984868787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299818238598
                                         uncertainty =       0.002275124036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299818238598
                                         uncertainty =       0.002275124036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387148913
  error estimate for blocks of size 2^( 2) =       0.000396877680
  error estimate for blocks of size 2^( 3) =       0.000406389173
  error estimate for blocks of size 2^( 4) =       0.000413369241
  error estimate for blocks of size 2^( 5) =       0.000417267569
  error estimate for blocks of size 2^( 6) =       0.000419927614
  error estimate for blocks of size 2^( 7) =       0.000420401789

      target function =                  N/A
              le_mean =     -17.216499155900
             les_mean =     296.724998443114
             stat err =       0.000417741553
             autocorr =       1.164284898982
              std dev =       0.547511244053
             le_variance =       0.299768562365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299012202663
                                         uncertainty =       0.002273397740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299012202663
                                         uncertainty =       0.002273397740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386628467
  error estimate for blocks of size 2^( 2) =       0.000396408839
  error estimate for blocks of size 2^( 3) =       0.000405978558
  error estimate for blocks of size 2^( 4) =       0.000413008069
  error estimate for blocks of size 2^( 5) =       0.000416943822
  error estimate for blocks of size 2^( 6) =       0.000419619335
  error estimate for blocks of size 2^( 7) =       0.000420111846

      target function =                  N/A
              le_mean =     -17.216499215016
             les_mean =     296.728758243913
             stat err =       0.000417420768
             autocorr =       1.165629286657
              std dev =       0.546775221517
             le_variance =       0.298963142865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300047300387
                                         uncertainty =       0.002314426201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300047300387
                                         uncertainty =       0.002314426201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387296907
  error estimate for blocks of size 2^( 2) =       0.000397071418
  error estimate for blocks of size 2^( 3) =       0.000406565838
  error estimate for blocks of size 2^( 4) =       0.000413504400
  error estimate for blocks of size 2^( 5) =       0.000417377443
  error estimate for blocks of size 2^( 6) =       0.000420102022
  error estimate for blocks of size 2^( 7) =       0.000420494777

      target function =                  N/A
              le_mean =     -17.216477877704
             les_mean =     296.745967177417
             stat err =       0.000417869661
             autocorr =       1.164108934539
              std dev =       0.547720539106
             le_variance =       0.299997788959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216479320279        initial
     9.7656e-02     9.7656e-01             1.6150e-02       -17.216499155900
     3.9062e-01     3.9062e+00             5.5907e-03       -17.216499215016  <--
     1.5625e+00     1.5625e+01             1.5929e-03       -17.216477877704

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9872e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 1.991144e-01 1 1  ON 0
  uu_1                 4.126749e-02 1 1  ON 1
  uu_2                -4.789105e-02 1 1  ON 2
  uu_3                -9.751116e-02 1 1  ON 3
  uu_4                -1.270305e-01 1 1  ON 4
  uu_5                -1.328903e-01 1 1  ON 5
  uu_6                -1.113451e-01 1 1  ON 6
  uu_7                -3.610342e-02 1 1  ON 7
  uu_8                 1.019120e-01 1 1  ON 8
  uu_9                 1.195688e-01 1 1  ON 9
  ud_0                 3.421626e-01 1 1  ON 10
  ud_1                 8.722873e-02 1 1  ON 11
  ud_2                -1.710192e-02 1 1  ON 12
  ud_3                -7.300684e-02 1 1  ON 13
  ud_4                -1.176058e-01 1 1  ON 14
  ud_5                -1.493455e-01 1 1  ON 15
  ud_6                -1.549195e-01 1 1  ON 16
  ud_7                -1.086530e-01 1 1  ON 17
  ud_8                 7.699563e-03 1 1  ON 18
  ud_9                 9.249924e-02 1 1  ON 19
  eO_0                -7.238351e-01 1 1  ON 20
  eO_1                -4.199907e-01 1 1  ON 21
  eO_2                -3.671657e-02 1 1  ON 22
  eO_3                 1.907120e-01 1 1  ON 23
  eO_4                 2.712911e-01 1 1  ON 24
  eO_5                 3.039848e-01 1 1  ON 25
  eO_6                 2.486957e-01 1 1  ON 26
  eO_7                 1.096518e-01 1 1  ON 27
  eO_8                 2.752691e-02 1 1  ON 28
  eO_9                 1.824002e-02 1 1  ON 29
 eH1_0                -1.799198e-01 1 1  ON 30
 eH1_1                -1.013465e-01 1 1  ON 31
 eH1_2                -6.255857e-02 1 1  ON 32
 eH1_3                -2.656668e-02 1 1  ON 33
 eH1_4                 1.991319e-02 1 1  ON 34
 eH1_5                 3.432770e-02 1 1  ON 35
 eH1_6                 7.683496e-02 1 1  ON 36
 eH1_7                 1.109820e-01 1 1  ON 37
 eH1_8                 8.937693e-02 1 1  ON 38
 eH1_9                 2.385071e-02 1 1  ON 39
 eH2_0                -1.814549e-01 1 1  ON 40
 eH2_1                -1.027390e-01 1 1  ON 41
 eH2_2                -6.401975e-02 1 1  ON 42
 eH2_3                -2.807466e-02 1 1  ON 43
 eH2_4                 1.877533e-02 1 1  ON 44
 eH2_5                 3.400507e-02 1 1  ON 45
 eH2_6                 7.866382e-02 1 1  ON 46
 eH2_7                 1.144678e-01 1 1  ON 47
 eH2_8                 9.249517e-02 1 1  ON 48
 eH2_9                 2.590421e-02 1 1  ON 49
ci_001                -4.371631e-02 3 1  ON 50
ci_002                -3.205061e-02 3 1  ON 51
ci_003                -2.681482e-02 3 1  ON 52
ci_004                 2.274999e-02 3 1  ON 53
ci_005                 2.363008e-02 3 1  ON 54
ci_006                -2.027768e-02 3 1  ON 55
ci_007                -2.089974e-02 3 1  ON 56
ci_008                -1.863363e-02 3 1  ON 57
ci_009                -1.811896e-02 3 1  ON 58
ci_010                -1.931049e-02 3 1  ON 59
ci_011                -1.753127e-02 3 1  ON 60
ci_012                -1.758656e-02 3 1  ON 61
ci_013                -2.029211e-02 3 1  ON 62
ci_014                 1.509476e-02 3 1  ON 63
ci_015                 1.507513e-02 3 1  ON 64
ci_016                 1.697711e-02 3 1  ON 65
ci_017                 1.645973e-02 3 1  ON 66
ci_018                 1.409992e-02 3 1  ON 67
ci_019                 1.404067e-02 3 1  ON 68
ci_020                 1.395082e-02 3 1  ON 69
ci_021                 1.483933e-02 3 1  ON 70
ci_022                 1.258249e-02 3 1  ON 71
ci_023                 1.240793e-02 3 1  ON 72
ci_024                 1.318556e-02 3 1  ON 73
ci_025                 1.338335e-02 3 1  ON 74
ci_026                 1.126329e-02 3 1  ON 75
ci_027                 1.191949e-02 3 1  ON 76
ci_028                -1.503554e-02 3 1  ON 77
ci_029                -1.479830e-02 3 1  ON 78
ci_030                -1.246784e-02 3 1  ON 79
ci_031                -1.192700e-02 3 1  ON 80
ci_032                -1.361672e-02 3 1  ON 81
ci_033                 1.116887e-02 3 1  ON 82
ci_034                 1.123180e-02 3 1  ON 83
ci_035                -5.236886e-03 3 1  ON 84
ci_036                -1.115164e-02 3 1  ON 85
ci_037                -1.071974e-02 3 1  ON 86
ci_038                 2.491612e-03 3 1  ON 87
ci_039                 2.818125e-03 3 1  ON 88
ci_040                -4.369986e-03 3 1  ON 89
ci_041                 1.025780e-02 3 1  ON 90
ci_042                 1.033998e-02 3 1  ON 91
ci_043                -3.909239e-03 3 1  ON 92
ci_044                -1.511119e-02 3 1  ON 93
ci_045                -2.428301e-03 3 1  ON 94
ci_046                 6.484911e-03 3 1  ON 95
ci_047                 6.567192e-03 3 1  ON 96
ci_048                -1.214964e-02 3 1  ON 97
ci_049                -1.169476e-02 3 1  ON 98
ci_050                 7.591657e-03 3 1  ON 99
ci_051                 7.753748e-03 3 1  ON 100
ci_052                -6.539300e-03 3 1  ON 101
ci_053                -7.014104e-03 3 1  ON 102
ci_054                -3.635640e-03 3 1  ON 103
ci_055                -3.742128e-03 3 1  ON 104
ci_056                 4.736167e-03 3 1  ON 105
ci_057                 4.957144e-03 3 1  ON 106
ci_058                -7.173140e-03 3 1  ON 107
ci_059                -6.739606e-03 3 1  ON 108
ci_060                 8.447812e-03 3 1  ON 109
ci_061                 8.516414e-03 3 1  ON 110
ci_062                -3.776963e-03 3 1  ON 111
ci_063                -3.734137e-03 3 1  ON 112
ci_064                -3.326375e-03 3 1  ON 113
ci_065                -4.337056e-03 3 1  ON 114
ci_066                 6.272374e-03 3 1  ON 115
ci_067                 5.922978e-03 3 1  ON 116
ci_068                -5.328868e-03 3 1  ON 117
ci_069                -5.045982e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.169496
====================================================
  Execution time = 2.0928e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1156e-01
  Total weights = 1.956578894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298087811813
                                         uncertainty =       0.001818564404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298087811813
                                         uncertainty =       0.001818564404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386095161
  error estimate for blocks of size 2^( 2) =       0.000395821265
  error estimate for blocks of size 2^( 3) =       0.000404876429
  error estimate for blocks of size 2^( 4) =       0.000410708889
  error estimate for blocks of size 2^( 5) =       0.000414922646
  error estimate for blocks of size 2^( 6) =       0.000416000899
  error estimate for blocks of size 2^( 7) =       0.000418255355

      target function =                  N/A
              le_mean =     -17.216441441560
             les_mean =     296.717418709815
             stat err =       0.000414971947
             autocorr =       1.155177604443
              std dev =       0.546021012739
             le_variance =       0.298138946353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644144156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441441610       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512130054       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216515680159       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537976136       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216561486989       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216581406232       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216583425575       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216582041417       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216586730600       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216584690800       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216586870107       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216587165279       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216586110555       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216585990420       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216586890774       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216587543680       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216587954894       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216588071908       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216588209694       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216588269935       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-02 is 1.399838e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441441610       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477624086       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216480388930       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216493363311       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502403932       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216508557507       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216505298595       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216505869622       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216506044624       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216506202079       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216506305934       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216506317235       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216506181454       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216506246997       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e-01 is 4.681549e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441441610       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216453696124       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216454898743       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216459569572       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216462082379       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216463575102       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216462555779       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216462452606       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216462615842       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216462498989       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216462556704       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216462552393       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+00 is 1.306501e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6955e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.003648e-01 1 1  ON 0
  uu_1                 4.162853e-02 1 1  ON 1
  uu_2                -4.797556e-02 1 1  ON 2
  uu_3                -9.806193e-02 1 1  ON 3
  uu_4                -1.276136e-01 1 1  ON 4
  uu_5                -1.330483e-01 1 1  ON 5
  uu_6                -1.114191e-01 1 1  ON 6
  uu_7                -3.643169e-02 1 1  ON 7
  uu_8                 1.017124e-01 1 1  ON 8
  uu_9                 1.197078e-01 1 1  ON 9
  ud_0                 3.437228e-01 1 1  ON 10
  ud_1                 8.810733e-02 1 1  ON 11
  ud_2                -1.730536e-02 1 1  ON 12
  ud_3                -7.394832e-02 1 1  ON 13
  ud_4                -1.185467e-01 1 1  ON 14
  ud_5                -1.496644e-01 1 1  ON 15
  ud_6                -1.546835e-01 1 1  ON 16
  ud_7                -1.086998e-01 1 1  ON 17
  ud_8                 7.311323e-03 1 1  ON 18
  ud_9                 9.249177e-02 1 1  ON 19
  eO_0                -7.285166e-01 1 1  ON 20
  eO_1                -4.222695e-01 1 1  ON 21
  eO_2                -3.561640e-02 1 1  ON 22
  eO_3                 1.940786e-01 1 1  ON 23
  eO_4                 2.732958e-01 1 1  ON 24
  eO_5                 3.039606e-01 1 1  ON 25
  eO_6                 2.488358e-01 1 1  ON 26
  eO_7                 1.099484e-01 1 1  ON 27
  eO_8                 2.755707e-02 1 1  ON 28
  eO_9                 1.825996e-02 1 1  ON 29
 eH1_0                -1.805771e-01 1 1  ON 30
 eH1_1                -1.015437e-01 1 1  ON 31
 eH1_2                -6.234888e-02 1 1  ON 32
 eH1_3                -2.645525e-02 1 1  ON 33
 eH1_4                 1.994394e-02 1 1  ON 34
 eH1_5                 3.470913e-02 1 1  ON 35
 eH1_6                 7.681038e-02 1 1  ON 36
 eH1_7                 1.108666e-01 1 1  ON 37
 eH1_8                 8.956085e-02 1 1  ON 38
 eH1_9                 2.389937e-02 1 1  ON 39
 eH2_0                -1.815927e-01 1 1  ON 40
 eH2_1                -1.028720e-01 1 1  ON 41
 eH2_2                -6.390014e-02 1 1  ON 42
 eH2_3                -2.807416e-02 1 1  ON 43
 eH2_4                 1.855770e-02 1 1  ON 44
 eH2_5                 3.420052e-02 1 1  ON 45
 eH2_6                 7.864961e-02 1 1  ON 46
 eH2_7                 1.144196e-01 1 1  ON 47
 eH2_8                 9.266850e-02 1 1  ON 48
 eH2_9                 2.594891e-02 1 1  ON 49
ci_001                -4.264703e-02 3 1  ON 50
ci_002                -3.099890e-02 3 1  ON 51
ci_003                -2.628056e-02 3 1  ON 52
ci_004                 2.233214e-02 3 1  ON 53
ci_005                 2.301202e-02 3 1  ON 54
ci_006                -2.003620e-02 3 1  ON 55
ci_007                -2.006929e-02 3 1  ON 56
ci_008                -1.808967e-02 3 1  ON 57
ci_009                -1.814977e-02 3 1  ON 58
ci_010                -1.828480e-02 3 1  ON 59
ci_011                -1.693422e-02 3 1  ON 60
ci_012                -1.664234e-02 3 1  ON 61
ci_013                -2.009794e-02 3 1  ON 62
ci_014                 1.453309e-02 3 1  ON 63
ci_015                 1.484984e-02 3 1  ON 64
ci_016                 1.689347e-02 3 1  ON 65
ci_017                 1.673047e-02 3 1  ON 66
ci_018                 1.383230e-02 3 1  ON 67
ci_019                 1.373281e-02 3 1  ON 68
ci_020                 1.356195e-02 3 1  ON 69
ci_021                 1.428889e-02 3 1  ON 70
ci_022                 1.238011e-02 3 1  ON 71
ci_023                 1.195940e-02 3 1  ON 72
ci_024                 1.290963e-02 3 1  ON 73
ci_025                 1.287320e-02 3 1  ON 74
ci_026                 1.148868e-02 3 1  ON 75
ci_027                 1.186257e-02 3 1  ON 76
ci_028                -1.495823e-02 3 1  ON 77
ci_029                -1.463624e-02 3 1  ON 78
ci_030                -1.228779e-02 3 1  ON 79
ci_031                -1.180877e-02 3 1  ON 80
ci_032                -1.373050e-02 3 1  ON 81
ci_033                 1.110973e-02 3 1  ON 82
ci_034                 1.104015e-02 3 1  ON 83
ci_035                -5.027892e-03 3 1  ON 84
ci_036                -1.043161e-02 3 1  ON 85
ci_037                -1.056785e-02 3 1  ON 86
ci_038                 2.311665e-03 3 1  ON 87
ci_039                 2.423038e-03 3 1  ON 88
ci_040                -4.322306e-03 3 1  ON 89
ci_041                 1.006838e-02 3 1  ON 90
ci_042                 1.033024e-02 3 1  ON 91
ci_043                -3.573948e-03 3 1  ON 92
ci_044                -1.542625e-02 3 1  ON 93
ci_045                -2.092244e-03 3 1  ON 94
ci_046                 6.285314e-03 3 1  ON 95
ci_047                 6.145013e-03 3 1  ON 96
ci_048                -1.205151e-02 3 1  ON 97
ci_049                -1.172639e-02 3 1  ON 98
ci_050                 7.432136e-03 3 1  ON 99
ci_051                 7.731774e-03 3 1  ON 100
ci_052                -6.665122e-03 3 1  ON 101
ci_053                -6.757745e-03 3 1  ON 102
ci_054                -3.511435e-03 3 1  ON 103
ci_055                -3.485675e-03 3 1  ON 104
ci_056                 4.651117e-03 3 1  ON 105
ci_057                 4.954979e-03 3 1  ON 106
ci_058                -6.866679e-03 3 1  ON 107
ci_059                -6.832547e-03 3 1  ON 108
ci_060                 8.611420e-03 3 1  ON 109
ci_061                 8.435735e-03 3 1  ON 110
ci_062                -3.585206e-03 3 1  ON 111
ci_063                -3.356016e-03 3 1  ON 112
ci_064                -3.268991e-03 3 1  ON 113
ci_065                -4.287798e-03 3 1  ON 114
ci_066                 6.010921e-03 3 1  ON 115
ci_067                 5.906718e-03 3 1  ON 116
ci_068                -5.160127e-03 3 1  ON 117
ci_069                -4.933499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.168007
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1467e-01
  Total weights = 1.9565e+06
  Execution time = 1.8183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300421562970
                                         uncertainty =       0.002470479232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300421562970
                                         uncertainty =       0.002470479232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387522323
  error estimate for blocks of size 2^( 2) =       0.000397760748
  error estimate for blocks of size 2^( 3) =       0.000406840300
  error estimate for blocks of size 2^( 4) =       0.000412932501
  error estimate for blocks of size 2^( 5) =       0.000415411127
  error estimate for blocks of size 2^( 6) =       0.000416226935
  error estimate for blocks of size 2^( 7) =       0.000417381067

      target function =                  N/A
              le_mean =     -17.215719151817
             les_mean =     296.699166158011
             stat err =       0.000415487908
             autocorr =       1.149537990060
              std dev =       0.548039324364
             le_variance =       0.300347101049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300688684904
                                         uncertainty =       0.002468748241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300688684904
                                         uncertainty =       0.002468748241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387696370
  error estimate for blocks of size 2^( 2) =       0.000397872466
  error estimate for blocks of size 2^( 3) =       0.000406949874
  error estimate for blocks of size 2^( 4) =       0.000413061841
  error estimate for blocks of size 2^( 5) =       0.000415546641
  error estimate for blocks of size 2^( 6) =       0.000416418137
  error estimate for blocks of size 2^( 7) =       0.000417579859

      target function =                  N/A
              le_mean =     -17.215705649122
             les_mean =     296.699330755059
             stat err =       0.000415651619
             autocorr =       1.149411355658
              std dev =       0.548285464908
             le_variance =       0.300616951029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299998932698
                                         uncertainty =       0.002454337187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299998932698
                                         uncertainty =       0.002454337187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387251416
  error estimate for blocks of size 2^( 2) =       0.000397467179
  error estimate for blocks of size 2^( 3) =       0.000406582710
  error estimate for blocks of size 2^( 4) =       0.000412721950
  error estimate for blocks of size 2^( 5) =       0.000415214383
  error estimate for blocks of size 2^( 6) =       0.000416070358
  error estimate for blocks of size 2^( 7) =       0.000417233133

      target function =                  N/A
              le_mean =     -17.215706761678
             les_mean =     296.703753231039
             stat err =       0.000415309956
             autocorr =       1.150161049407
              std dev =       0.547656204586
             le_variance =       0.299927318422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300205292903
                                         uncertainty =       0.002464602631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300205292903
                                         uncertainty =       0.002464602631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387383061
  error estimate for blocks of size 2^( 2) =       0.000397621220
  error estimate for blocks of size 2^( 3) =       0.000406709798
  error estimate for blocks of size 2^( 4) =       0.000412808198
  error estimate for blocks of size 2^( 5) =       0.000415291821
  error estimate for blocks of size 2^( 6) =       0.000416114816
  error estimate for blocks of size 2^( 7) =       0.000417268332

      target function =                  N/A
              le_mean =     -17.215708149939
             les_mean =     296.714921574889
             stat err =       0.000415370792
             autocorr =       1.149716210004
              std dev =       0.547842379399
             le_variance =       0.300131272665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215719151817        initial  <--
     9.7656e-02     9.7656e-01             1.3998e-02       -17.215705649122
     3.9062e-01     3.9062e+00             4.6815e-03       -17.215706761678
     1.5625e+00     1.5625e+01             1.3065e-03       -17.215708149939

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8757
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 1.991144e-01 1 1  ON 0
  uu_1                 4.126749e-02 1 1  ON 1
  uu_2                -4.789105e-02 1 1  ON 2
  uu_3                -9.751116e-02 1 1  ON 3
  uu_4                -1.270305e-01 1 1  ON 4
  uu_5                -1.328903e-01 1 1  ON 5
  uu_6                -1.113451e-01 1 1  ON 6
  uu_7                -3.610342e-02 1 1  ON 7
  uu_8                 1.019120e-01 1 1  ON 8
  uu_9                 1.195688e-01 1 1  ON 9
  ud_0                 3.421626e-01 1 1  ON 10
  ud_1                 8.722873e-02 1 1  ON 11
  ud_2                -1.710192e-02 1 1  ON 12
  ud_3                -7.300684e-02 1 1  ON 13
  ud_4                -1.176058e-01 1 1  ON 14
  ud_5                -1.493455e-01 1 1  ON 15
  ud_6                -1.549195e-01 1 1  ON 16
  ud_7                -1.086530e-01 1 1  ON 17
  ud_8                 7.699563e-03 1 1  ON 18
  ud_9                 9.249924e-02 1 1  ON 19
  eO_0                -7.238351e-01 1 1  ON 20
  eO_1                -4.199907e-01 1 1  ON 21
  eO_2                -3.671657e-02 1 1  ON 22
  eO_3                 1.907120e-01 1 1  ON 23
  eO_4                 2.712911e-01 1 1  ON 24
  eO_5                 3.039848e-01 1 1  ON 25
  eO_6                 2.486957e-01 1 1  ON 26
  eO_7                 1.096518e-01 1 1  ON 27
  eO_8                 2.752691e-02 1 1  ON 28
  eO_9                 1.824002e-02 1 1  ON 29
 eH1_0                -1.799198e-01 1 1  ON 30
 eH1_1                -1.013465e-01 1 1  ON 31
 eH1_2                -6.255857e-02 1 1  ON 32
 eH1_3                -2.656668e-02 1 1  ON 33
 eH1_4                 1.991319e-02 1 1  ON 34
 eH1_5                 3.432770e-02 1 1  ON 35
 eH1_6                 7.683496e-02 1 1  ON 36
 eH1_7                 1.109820e-01 1 1  ON 37
 eH1_8                 8.937693e-02 1 1  ON 38
 eH1_9                 2.385071e-02 1 1  ON 39
 eH2_0                -1.814549e-01 1 1  ON 40
 eH2_1                -1.027390e-01 1 1  ON 41
 eH2_2                -6.401975e-02 1 1  ON 42
 eH2_3                -2.807466e-02 1 1  ON 43
 eH2_4                 1.877533e-02 1 1  ON 44
 eH2_5                 3.400507e-02 1 1  ON 45
 eH2_6                 7.866382e-02 1 1  ON 46
 eH2_7                 1.144678e-01 1 1  ON 47
 eH2_8                 9.249517e-02 1 1  ON 48
 eH2_9                 2.590421e-02 1 1  ON 49
ci_001                -4.371631e-02 3 1  ON 50
ci_002                -3.205061e-02 3 1  ON 51
ci_003                -2.681482e-02 3 1  ON 52
ci_004                 2.274999e-02 3 1  ON 53
ci_005                 2.363008e-02 3 1  ON 54
ci_006                -2.027768e-02 3 1  ON 55
ci_007                -2.089974e-02 3 1  ON 56
ci_008                -1.863363e-02 3 1  ON 57
ci_009                -1.811896e-02 3 1  ON 58
ci_010                -1.931049e-02 3 1  ON 59
ci_011                -1.753127e-02 3 1  ON 60
ci_012                -1.758656e-02 3 1  ON 61
ci_013                -2.029211e-02 3 1  ON 62
ci_014                 1.509476e-02 3 1  ON 63
ci_015                 1.507513e-02 3 1  ON 64
ci_016                 1.697711e-02 3 1  ON 65
ci_017                 1.645973e-02 3 1  ON 66
ci_018                 1.409992e-02 3 1  ON 67
ci_019                 1.404067e-02 3 1  ON 68
ci_020                 1.395082e-02 3 1  ON 69
ci_021                 1.483933e-02 3 1  ON 70
ci_022                 1.258249e-02 3 1  ON 71
ci_023                 1.240793e-02 3 1  ON 72
ci_024                 1.318556e-02 3 1  ON 73
ci_025                 1.338335e-02 3 1  ON 74
ci_026                 1.126329e-02 3 1  ON 75
ci_027                 1.191949e-02 3 1  ON 76
ci_028                -1.503554e-02 3 1  ON 77
ci_029                -1.479830e-02 3 1  ON 78
ci_030                -1.246784e-02 3 1  ON 79
ci_031                -1.192700e-02 3 1  ON 80
ci_032                -1.361672e-02 3 1  ON 81
ci_033                 1.116887e-02 3 1  ON 82
ci_034                 1.123180e-02 3 1  ON 83
ci_035                -5.236886e-03 3 1  ON 84
ci_036                -1.115164e-02 3 1  ON 85
ci_037                -1.071974e-02 3 1  ON 86
ci_038                 2.491612e-03 3 1  ON 87
ci_039                 2.818125e-03 3 1  ON 88
ci_040                -4.369986e-03 3 1  ON 89
ci_041                 1.025780e-02 3 1  ON 90
ci_042                 1.033998e-02 3 1  ON 91
ci_043                -3.909239e-03 3 1  ON 92
ci_044                -1.511119e-02 3 1  ON 93
ci_045                -2.428301e-03 3 1  ON 94
ci_046                 6.484911e-03 3 1  ON 95
ci_047                 6.567192e-03 3 1  ON 96
ci_048                -1.214964e-02 3 1  ON 97
ci_049                -1.169476e-02 3 1  ON 98
ci_050                 7.591657e-03 3 1  ON 99
ci_051                 7.753748e-03 3 1  ON 100
ci_052                -6.539300e-03 3 1  ON 101
ci_053                -7.014104e-03 3 1  ON 102
ci_054                -3.635640e-03 3 1  ON 103
ci_055                -3.742128e-03 3 1  ON 104
ci_056                 4.736167e-03 3 1  ON 105
ci_057                 4.957144e-03 3 1  ON 106
ci_058                -7.173140e-03 3 1  ON 107
ci_059                -6.739606e-03 3 1  ON 108
ci_060                 8.447812e-03 3 1  ON 109
ci_061                 8.516414e-03 3 1  ON 110
ci_062                -3.776963e-03 3 1  ON 111
ci_063                -3.734137e-03 3 1  ON 112
ci_064                -3.326375e-03 3 1  ON 113
ci_065                -4.337056e-03 3 1  ON 114
ci_066                 6.272374e-03 3 1  ON 115
ci_067                 5.922978e-03 3 1  ON 116
ci_068                -5.328868e-03 3 1  ON 117
ci_069                -5.045982e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2765
    reference variance = 0.196519
====================================================
  Execution time = 2.0668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1063e-01
  Total weights = 1.956504462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296888701991
                                         uncertainty =       0.002024601283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296888701991
                                         uncertainty =       0.002024601283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385264779
  error estimate for blocks of size 2^( 2) =       0.000395593313
  error estimate for blocks of size 2^( 3) =       0.000404860993
  error estimate for blocks of size 2^( 4) =       0.000411818797
  error estimate for blocks of size 2^( 5) =       0.000415703301
  error estimate for blocks of size 2^( 6) =       0.000418521913
  error estimate for blocks of size 2^( 7) =       0.000419341094

      target function =                  N/A
              le_mean =     -17.215869686446
             les_mean =     296.696801716672
             stat err =       0.000416346276
             autocorr =       1.167859923607
              std dev =       0.544846675099
             le_variance =       0.296857899367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586968645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869686502       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215884974660       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215888393972       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215892069413       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215896047989       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215898085062       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215896855200       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215898441667       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215899056109       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215898893168       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215898708784       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215898564484       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 1.919509e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869686502       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874086574       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215875133715       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215876125964       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215877260811       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215877764374       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215877403769       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215877785493       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215877910094       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215877921661       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215877868974       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215877847769       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 5.028143e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215869686502       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215870829745       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215871107085       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215871360186       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215871654680       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215871780718       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215871687701       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215871778794       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215871809741       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215871816485       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215871804708       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215871798694       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+01 is 1.272082e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6781e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 1.992645e-01 1 1  ON 0
  uu_1                 4.130780e-02 1 1  ON 1
  uu_2                -4.787951e-02 1 1  ON 2
  uu_3                -9.754868e-02 1 1  ON 3
  uu_4                -1.270775e-01 1 1  ON 4
  uu_5                -1.329130e-01 1 1  ON 5
  uu_6                -1.113846e-01 1 1  ON 6
  uu_7                -3.617697e-02 1 1  ON 7
  uu_8                 1.018892e-01 1 1  ON 8
  uu_9                 1.195887e-01 1 1  ON 9
  ud_0                 3.423824e-01 1 1  ON 10
  ud_1                 8.732404e-02 1 1  ON 11
  ud_2                -1.715314e-02 1 1  ON 12
  ud_3                -7.314007e-02 1 1  ON 13
  ud_4                -1.177261e-01 1 1  ON 14
  ud_5                -1.493452e-01 1 1  ON 15
  ud_6                -1.548817e-01 1 1  ON 16
  ud_7                -1.086775e-01 1 1  ON 17
  ud_8                 7.659692e-03 1 1  ON 18
  ud_9                 9.249885e-02 1 1  ON 19
  eO_0                -7.243379e-01 1 1  ON 20
  eO_1                -4.202175e-01 1 1  ON 21
  eO_2                -3.658223e-02 1 1  ON 22
  eO_3                 1.911023e-01 1 1  ON 23
  eO_4                 2.714800e-01 1 1  ON 24
  eO_5                 3.039494e-01 1 1  ON 25
  eO_6                 2.487094e-01 1 1  ON 26
  eO_7                 1.096798e-01 1 1  ON 27
  eO_8                 2.753194e-02 1 1  ON 28
  eO_9                 1.824295e-02 1 1  ON 29
 eH1_0                -1.799667e-01 1 1  ON 30
 eH1_1                -1.013576e-01 1 1  ON 31
 eH1_2                -6.256039e-02 1 1  ON 32
 eH1_3                -2.656361e-02 1 1  ON 33
 eH1_4                 1.995034e-02 1 1  ON 34
 eH1_5                 3.435016e-02 1 1  ON 35
 eH1_6                 7.681452e-02 1 1  ON 36
 eH1_7                 1.109703e-01 1 1  ON 37
 eH1_8                 8.939703e-02 1 1  ON 38
 eH1_9                 2.385830e-02 1 1  ON 39
 eH2_0                -1.814809e-01 1 1  ON 40
 eH2_1                -1.027791e-01 1 1  ON 41
 eH2_2                -6.400273e-02 1 1  ON 42
 eH2_3                -2.806576e-02 1 1  ON 43
 eH2_4                 1.878317e-02 1 1  ON 44
 eH2_5                 3.404379e-02 1 1  ON 45
 eH2_6                 7.864847e-02 1 1  ON 46
 eH2_7                 1.144541e-01 1 1  ON 47
 eH2_8                 9.250857e-02 1 1  ON 48
 eH2_9                 2.590923e-02 1 1  ON 49
ci_001                -4.360697e-02 3 1  ON 50
ci_002                -3.195208e-02 3 1  ON 51
ci_003                -2.676353e-02 3 1  ON 52
ci_004                 2.267932e-02 3 1  ON 53
ci_005                 2.350813e-02 3 1  ON 54
ci_006                -2.021467e-02 3 1  ON 55
ci_007                -2.078597e-02 3 1  ON 56
ci_008                -1.862299e-02 3 1  ON 57
ci_009                -1.810396e-02 3 1  ON 58
ci_010                -1.922702e-02 3 1  ON 59
ci_011                -1.742965e-02 3 1  ON 60
ci_012                -1.753171e-02 3 1  ON 61
ci_013                -2.025177e-02 3 1  ON 62
ci_014                 1.499499e-02 3 1  ON 63
ci_015                 1.501632e-02 3 1  ON 64
ci_016                 1.699193e-02 3 1  ON 65
ci_017                 1.644931e-02 3 1  ON 66
ci_018                 1.401198e-02 3 1  ON 67
ci_019                 1.399349e-02 3 1  ON 68
ci_020                 1.391300e-02 3 1  ON 69
ci_021                 1.477490e-02 3 1  ON 70
ci_022                 1.253503e-02 3 1  ON 71
ci_023                 1.229273e-02 3 1  ON 72
ci_024                 1.314190e-02 3 1  ON 73
ci_025                 1.333340e-02 3 1  ON 74
ci_026                 1.126937e-02 3 1  ON 75
ci_027                 1.187155e-02 3 1  ON 76
ci_028                -1.500842e-02 3 1  ON 77
ci_029                -1.481990e-02 3 1  ON 78
ci_030                -1.239153e-02 3 1  ON 79
ci_031                -1.191558e-02 3 1  ON 80
ci_032                -1.361437e-02 3 1  ON 81
ci_033                 1.110788e-02 3 1  ON 82
ci_034                 1.119060e-02 3 1  ON 83
ci_035                -5.233419e-03 3 1  ON 84
ci_036                -1.112674e-02 3 1  ON 85
ci_037                -1.064544e-02 3 1  ON 86
ci_038                 2.482641e-03 3 1  ON 87
ci_039                 2.776047e-03 3 1  ON 88
ci_040                -4.401097e-03 3 1  ON 89
ci_041                 1.028154e-02 3 1  ON 90
ci_042                 1.034197e-02 3 1  ON 91
ci_043                -3.864124e-03 3 1  ON 92
ci_044                -1.502092e-02 3 1  ON 93
ci_045                -2.385569e-03 3 1  ON 94
ci_046                 6.424349e-03 3 1  ON 95
ci_047                 6.584329e-03 3 1  ON 96
ci_048                -1.214945e-02 3 1  ON 97
ci_049                -1.167616e-02 3 1  ON 98
ci_050                 7.546054e-03 3 1  ON 99
ci_051                 7.770738e-03 3 1  ON 100
ci_052                -6.546668e-03 3 1  ON 101
ci_053                -6.972719e-03 3 1  ON 102
ci_054                -3.568773e-03 3 1  ON 103
ci_055                -3.743273e-03 3 1  ON 104
ci_056                 4.721781e-03 3 1  ON 105
ci_057                 4.950060e-03 3 1  ON 106
ci_058                -7.145990e-03 3 1  ON 107
ci_059                -6.720822e-03 3 1  ON 108
ci_060                 8.453391e-03 3 1  ON 109
ci_061                 8.575961e-03 3 1  ON 110
ci_062                -3.709732e-03 3 1  ON 111
ci_063                -3.721071e-03 3 1  ON 112
ci_064                -3.294757e-03 3 1  ON 113
ci_065                -4.300588e-03 3 1  ON 114
ci_066                 6.233722e-03 3 1  ON 115
ci_067                 5.912006e-03 3 1  ON 116
ci_068                -5.308310e-03 3 1  ON 117
ci_069                -5.022750e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2204
    reference variance = 0.232067
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0974e-01
  Total weights = 1.9562e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298622541408
                                         uncertainty =       0.001816066305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298622541408
                                         uncertainty =       0.001816066305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386377054
  error estimate for blocks of size 2^( 2) =       0.000396544783
  error estimate for blocks of size 2^( 3) =       0.000405549248
  error estimate for blocks of size 2^( 4) =       0.000412041310
  error estimate for blocks of size 2^( 5) =       0.000416094906
  error estimate for blocks of size 2^( 6) =       0.000418540531
  error estimate for blocks of size 2^( 7) =       0.000420899974

      target function =                  N/A
              le_mean =     -17.216255239757
             les_mean =     296.780332621985
             stat err =       0.000416894180
             autocorr =       1.164203797490
              std dev =       0.546419670004
             le_variance =       0.298574455768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298568991574
                                         uncertainty =       0.001819314991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298568991574
                                         uncertainty =       0.001819314991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343028
  error estimate for blocks of size 2^( 2) =       0.000396508096
  error estimate for blocks of size 2^( 3) =       0.000405507082
  error estimate for blocks of size 2^( 4) =       0.000412007319
  error estimate for blocks of size 2^( 5) =       0.000416059037
  error estimate for blocks of size 2^( 6) =       0.000418486183
  error estimate for blocks of size 2^( 7) =       0.000420845269

      target function =                  N/A
              le_mean =     -17.216255982217
             les_mean =     296.709971117611
             stat err =       0.000416849452
             autocorr =       1.164159029503
              std dev =       0.546371549915
             le_variance =       0.298521870556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570292472
                                         uncertainty =       0.001817676616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298570292472
                                         uncertainty =       0.001817676616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343619
  error estimate for blocks of size 2^( 2) =       0.000396510955
  error estimate for blocks of size 2^( 3) =       0.000405513363
  error estimate for blocks of size 2^( 4) =       0.000412011116
  error estimate for blocks of size 2^( 5) =       0.000416064694
  error estimate for blocks of size 2^( 6) =       0.000418499265
  error estimate for blocks of size 2^( 7) =       0.000420858518

      target function =                  N/A
              le_mean =     -17.216254774911
             les_mean =     296.709165607761
             stat err =       0.000416858398
             autocorr =       1.164205435506
              std dev =       0.546372386346
             le_variance =       0.298522784561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298613524463
                                         uncertainty =       0.001816274011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298613524463
                                         uncertainty =       0.001816274011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386371270
  error estimate for blocks of size 2^( 2) =       0.000396539133
  error estimate for blocks of size 2^( 3) =       0.000405543318
  error estimate for blocks of size 2^( 4) =       0.000412036873
  error estimate for blocks of size 2^( 5) =       0.000416090614
  error estimate for blocks of size 2^( 6) =       0.000418534211
  error estimate for blocks of size 2^( 7) =       0.000420894545

      target function =                  N/A
              le_mean =     -17.216254619137
             les_mean =     296.709225961779
             stat err =       0.000416889061
             autocorr =       1.164210058654
              std dev =       0.546411490468
             le_variance =       0.298565516915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216255239757        initial
     9.7656e-01     9.7656e+00             1.9195e-03       -17.216255982217  <--
     3.9062e+00     3.9062e+01             5.0281e-04       -17.216254774911
     1.5625e+01     1.5625e+02             1.2721e-04       -17.216254619137

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0095e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 1.996828e-01 1 1  ON 0
  uu_1                 4.145199e-02 1 1  ON 1
  uu_2                -4.784485e-02 1 1  ON 2
  uu_3                -9.766037e-02 1 1  ON 3
  uu_4                -1.272260e-01 1 1  ON 4
  uu_5                -1.329832e-01 1 1  ON 5
  uu_6                -1.114925e-01 1 1  ON 6
  uu_7                -3.639072e-02 1 1  ON 7
  uu_8                 1.018225e-01 1 1  ON 8
  uu_9                 1.196476e-01 1 1  ON 9
  ud_0                 3.429449e-01 1 1  ON 10
  ud_1                 8.757771e-02 1 1  ON 11
  ud_2                -1.726813e-02 1 1  ON 12
  ud_3                -7.347911e-02 1 1  ON 13
  ud_4                -1.180493e-01 1 1  ON 14
  ud_5                -1.493613e-01 1 1  ON 15
  ud_6                -1.547671e-01 1 1  ON 16
  ud_7                -1.087453e-01 1 1  ON 17
  ud_8                 7.542678e-03 1 1  ON 18
  ud_9                 9.249783e-02 1 1  ON 19
  eO_0                -7.257546e-01 1 1  ON 20
  eO_1                -4.208709e-01 1 1  ON 21
  eO_2                -3.625326e-02 1 1  ON 22
  eO_3                 1.922045e-01 1 1  ON 23
  eO_4                 2.720601e-01 1 1  ON 24
  eO_5                 3.038544e-01 1 1  ON 25
  eO_6                 2.487512e-01 1 1  ON 26
  eO_7                 1.097629e-01 1 1  ON 27
  eO_8                 2.754692e-02 1 1  ON 28
  eO_9                 1.825163e-02 1 1  ON 29
 eH1_0                -1.800926e-01 1 1  ON 30
 eH1_1                -1.013993e-01 1 1  ON 31
 eH1_2                -6.256141e-02 1 1  ON 32
 eH1_3                -2.655137e-02 1 1  ON 33
 eH1_4                 2.003940e-02 1 1  ON 34
 eH1_5                 3.441913e-02 1 1  ON 35
 eH1_6                 7.675971e-02 1 1  ON 36
 eH1_7                 1.109367e-01 1 1  ON 37
 eH1_8                 8.945669e-02 1 1  ON 38
 eH1_9                 2.388085e-02 1 1  ON 39
 eH2_0                -1.815530e-01 1 1  ON 40
 eH2_1                -1.028867e-01 1 1  ON 41
 eH2_2                -6.396029e-02 1 1  ON 42
 eH2_3                -2.803824e-02 1 1  ON 43
 eH2_4                 1.879558e-02 1 1  ON 44
 eH2_5                 3.415424e-02 1 1  ON 45
 eH2_6                 7.860797e-02 1 1  ON 46
 eH2_7                 1.144145e-01 1 1  ON 47
 eH2_8                 9.254831e-02 1 1  ON 48
 eH2_9                 2.592416e-02 1 1  ON 49
ci_001                -4.332987e-02 3 1  ON 50
ci_002                -3.171221e-02 3 1  ON 51
ci_003                -2.663191e-02 3 1  ON 52
ci_004                 2.250052e-02 3 1  ON 53
ci_005                 2.319764e-02 3 1  ON 54
ci_006                -2.005978e-02 3 1  ON 55
ci_007                -2.050319e-02 3 1  ON 56
ci_008                -1.859691e-02 3 1  ON 57
ci_009                -1.806949e-02 3 1  ON 58
ci_010                -1.901275e-02 3 1  ON 59
ci_011                -1.718031e-02 3 1  ON 60
ci_012                -1.739824e-02 3 1  ON 61
ci_013                -2.014775e-02 3 1  ON 62
ci_014                 1.475285e-02 3 1  ON 63
ci_015                 1.487339e-02 3 1  ON 64
ci_016                 1.703289e-02 3 1  ON 65
ci_017                 1.642686e-02 3 1  ON 66
ci_018                 1.380011e-02 3 1  ON 67
ci_019                 1.388028e-02 3 1  ON 68
ci_020                 1.381996e-02 3 1  ON 69
ci_021                 1.461446e-02 3 1  ON 70
ci_022                 1.241975e-02 3 1  ON 71
ci_023                 1.201533e-02 3 1  ON 72
ci_024                 1.302585e-02 3 1  ON 73
ci_025                 1.320099e-02 3 1  ON 74
ci_026                 1.128633e-02 3 1  ON 75
ci_027                 1.175610e-02 3 1  ON 76
ci_028                -1.494529e-02 3 1  ON 77
ci_029                -1.487685e-02 3 1  ON 78
ci_030                -1.220213e-02 3 1  ON 79
ci_031                -1.188536e-02 3 1  ON 80
ci_032                -1.360891e-02 3 1  ON 81
ci_033                 1.095771e-02 3 1  ON 82
ci_034                 1.108945e-02 3 1  ON 83
ci_035                -5.220743e-03 3 1  ON 84
ci_036                -1.106543e-02 3 1  ON 85
ci_037                -1.046308e-02 3 1  ON 86
ci_038                 2.455644e-03 3 1  ON 87
ci_039                 2.677802e-03 3 1  ON 88
ci_040                -4.462032e-03 3 1  ON 89
ci_041                 1.034027e-02 3 1  ON 90
ci_042                 1.034589e-02 3 1  ON 91
ci_043                -3.760083e-03 3 1  ON 92
ci_044                -1.478748e-02 3 1  ON 93
ci_045                -2.286999e-03 3 1  ON 94
ci_046                 6.278019e-03 3 1  ON 95
ci_047                 6.623612e-03 3 1  ON 96
ci_048                -1.215439e-02 3 1  ON 97
ci_049                -1.163124e-02 3 1  ON 98
ci_050                 7.443955e-03 3 1  ON 99
ci_051                 7.807325e-03 3 1  ON 100
ci_052                -6.562052e-03 3 1  ON 101
ci_053                -6.877004e-03 3 1  ON 102
ci_054                -3.409333e-03 3 1  ON 103
ci_055                -3.742616e-03 3 1  ON 104
ci_056                 4.686383e-03 3 1  ON 105
ci_057                 4.932653e-03 3 1  ON 106
ci_058                -7.081465e-03 3 1  ON 107
ci_059                -6.677372e-03 3 1  ON 108
ci_060                 8.468167e-03 3 1  ON 109
ci_061                 8.720200e-03 3 1  ON 110
ci_062                -3.550899e-03 3 1  ON 111
ci_063                -3.688791e-03 3 1  ON 112
ci_064                -3.229605e-03 3 1  ON 113
ci_065                -4.226158e-03 3 1  ON 114
ci_066                 6.144465e-03 3 1  ON 115
ci_067                 5.887235e-03 3 1  ON 116
ci_068                -5.260862e-03 3 1  ON 117
ci_069                -4.969856e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.183452
====================================================
  Execution time = 2.1019e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1161e-01
  Total weights = 1.956521689e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297681282901
                                         uncertainty =       0.002284544789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297681282901
                                         uncertainty =       0.002284544789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385790447
  error estimate for blocks of size 2^( 2) =       0.000395892647
  error estimate for blocks of size 2^( 3) =       0.000405170790
  error estimate for blocks of size 2^( 4) =       0.000412033184
  error estimate for blocks of size 2^( 5) =       0.000415719400
  error estimate for blocks of size 2^( 6) =       0.000416739396
  error estimate for blocks of size 2^( 7) =       0.000416552690

      target function =                  N/A
              le_mean =     -17.216333970207
             les_mean =     296.713761852004
             stat err =       0.000415261168
             autocorr =       1.158616481254
              std dev =       0.545590082831
             le_variance =       0.297668538483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633397021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216333970234       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216370137010       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374261355       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216388097343       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216408635596       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400373852       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216406068456       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216407038020       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216409366315       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216410185888       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216409684639       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216408525198       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216408278923       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216407924007       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216408091224       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e-01 is 6.450133e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216333970234       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216348205715       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216350220526       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216354966473       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216360688909       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216357733854       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216359003928       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216359388552       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216359720160       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216359903347       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216359786239       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216359655782       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 1.882435e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216333970234       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216338125875       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216338777727       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216340038926       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216341510819       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216340755017       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216341066452       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216341088804       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216341183881       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216341223202       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216341203377       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+00 is 4.926336e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7094e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.001603e-01 1 1  ON 0
  uu_1                 4.169052e-02 1 1  ON 1
  uu_2                -4.783945e-02 1 1  ON 2
  uu_3                -9.788339e-02 1 1  ON 3
  uu_4                -1.274698e-01 1 1  ON 4
  uu_5                -1.329949e-01 1 1  ON 5
  uu_6                -1.115648e-01 1 1  ON 6
  uu_7                -3.657411e-02 1 1  ON 7
  uu_8                 1.017183e-01 1 1  ON 8
  uu_9                 1.197027e-01 1 1  ON 9
  ud_0                 3.436138e-01 1 1  ON 10
  ud_1                 8.788480e-02 1 1  ON 11
  ud_2                -1.730198e-02 1 1  ON 12
  ud_3                -7.383898e-02 1 1  ON 13
  ud_4                -1.184218e-01 1 1  ON 14
  ud_5                -1.494432e-01 1 1  ON 15
  ud_6                -1.546682e-01 1 1  ON 16
  ud_7                -1.088459e-01 1 1  ON 17
  ud_8                 7.354375e-03 1 1  ON 18
  ud_9                 9.250468e-02 1 1  ON 19
  eO_0                -7.276370e-01 1 1  ON 20
  eO_1                -4.217945e-01 1 1  ON 21
  eO_2                -3.583196e-02 1 1  ON 22
  eO_3                 1.936426e-01 1 1  ON 23
  eO_4                 2.728460e-01 1 1  ON 24
  eO_5                 3.038104e-01 1 1  ON 25
  eO_6                 2.488176e-01 1 1  ON 26
  eO_7                 1.098674e-01 1 1  ON 27
  eO_8                 2.756407e-02 1 1  ON 28
  eO_9                 1.826349e-02 1 1  ON 29
 eH1_0                -1.803469e-01 1 1  ON 30
 eH1_1                -1.014534e-01 1 1  ON 31
 eH1_2                -6.248322e-02 1 1  ON 32
 eH1_3                -2.655781e-02 1 1  ON 33
 eH1_4                 2.007369e-02 1 1  ON 34
 eH1_5                 3.463415e-02 1 1  ON 35
 eH1_6                 7.674107e-02 1 1  ON 36
 eH1_7                 1.108756e-01 1 1  ON 37
 eH1_8                 8.950264e-02 1 1  ON 38
 eH1_9                 2.389711e-02 1 1  ON 39
 eH2_0                -1.816600e-01 1 1  ON 40
 eH2_1                -1.029084e-01 1 1  ON 41
 eH2_2                -6.394240e-02 1 1  ON 42
 eH2_3                -2.795666e-02 1 1  ON 43
 eH2_4                 1.871592e-02 1 1  ON 44
 eH2_5                 3.430522e-02 1 1  ON 45
 eH2_6                 7.853569e-02 1 1  ON 46
 eH2_7                 1.143501e-01 1 1  ON 47
 eH2_8                 9.261503e-02 1 1  ON 48
 eH2_9                 2.594352e-02 1 1  ON 49
ci_001                -4.287479e-02 3 1  ON 50
ci_002                -3.141342e-02 3 1  ON 51
ci_003                -2.653201e-02 3 1  ON 52
ci_004                 2.234991e-02 3 1  ON 53
ci_005                 2.292571e-02 3 1  ON 54
ci_006                -1.996692e-02 3 1  ON 55
ci_007                -2.022419e-02 3 1  ON 56
ci_008                -1.840238e-02 3 1  ON 57
ci_009                -1.800202e-02 3 1  ON 58
ci_010                -1.879731e-02 3 1  ON 59
ci_011                -1.687374e-02 3 1  ON 60
ci_012                -1.726192e-02 3 1  ON 61
ci_013                -2.000085e-02 3 1  ON 62
ci_014                 1.466375e-02 3 1  ON 63
ci_015                 1.465081e-02 3 1  ON 64
ci_016                 1.703481e-02 3 1  ON 65
ci_017                 1.656584e-02 3 1  ON 66
ci_018                 1.353479e-02 3 1  ON 67
ci_019                 1.362079e-02 3 1  ON 68
ci_020                 1.377727e-02 3 1  ON 69
ci_021                 1.450785e-02 3 1  ON 70
ci_022                 1.232365e-02 3 1  ON 71
ci_023                 1.193970e-02 3 1  ON 72
ci_024                 1.278995e-02 3 1  ON 73
ci_025                 1.319551e-02 3 1  ON 74
ci_026                 1.122296e-02 3 1  ON 75
ci_027                 1.169236e-02 3 1  ON 76
ci_028                -1.481489e-02 3 1  ON 77
ci_029                -1.469670e-02 3 1  ON 78
ci_030                -1.186510e-02 3 1  ON 79
ci_031                -1.181043e-02 3 1  ON 80
ci_032                -1.367044e-02 3 1  ON 81
ci_033                 1.089335e-02 3 1  ON 82
ci_034                 1.110398e-02 3 1  ON 83
ci_035                -5.248481e-03 3 1  ON 84
ci_036                -1.094289e-02 3 1  ON 85
ci_037                -1.051525e-02 3 1  ON 86
ci_038                 2.184052e-03 3 1  ON 87
ci_039                 2.549979e-03 3 1  ON 88
ci_040                -4.190649e-03 3 1  ON 89
ci_041                 1.031862e-02 3 1  ON 90
ci_042                 1.031500e-02 3 1  ON 91
ci_043                -3.793572e-03 3 1  ON 92
ci_044                -1.486575e-02 3 1  ON 93
ci_045                -2.298508e-03 3 1  ON 94
ci_046                 5.985089e-03 3 1  ON 95
ci_047                 6.601400e-03 3 1  ON 96
ci_048                -1.207882e-02 3 1  ON 97
ci_049                -1.170178e-02 3 1  ON 98
ci_050                 7.340801e-03 3 1  ON 99
ci_051                 7.809817e-03 3 1  ON 100
ci_052                -6.739366e-03 3 1  ON 101
ci_053                -6.752462e-03 3 1  ON 102
ci_054                -3.368344e-03 3 1  ON 103
ci_055                -3.654961e-03 3 1  ON 104
ci_056                 4.579484e-03 3 1  ON 105
ci_057                 4.885159e-03 3 1  ON 106
ci_058                -7.028960e-03 3 1  ON 107
ci_059                -6.604358e-03 3 1  ON 108
ci_060                 8.435173e-03 3 1  ON 109
ci_061                 8.617595e-03 3 1  ON 110
ci_062                -3.433064e-03 3 1  ON 111
ci_063                -3.676096e-03 3 1  ON 112
ci_064                -3.262564e-03 3 1  ON 113
ci_065                -4.198427e-03 3 1  ON 114
ci_066                 6.022668e-03 3 1  ON 115
ci_067                 5.788143e-03 3 1  ON 116
ci_068                -5.371898e-03 3 1  ON 117
ci_069                -4.947191e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2818
    reference variance = 0.203977
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0718e-01
  Total weights = 1.9564e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295681689372
                                         uncertainty =       0.001650550524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295681689372
                                         uncertainty =       0.001650550524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384446578
  error estimate for blocks of size 2^( 2) =       0.000394817808
  error estimate for blocks of size 2^( 3) =       0.000403656792
  error estimate for blocks of size 2^( 4) =       0.000410102677
  error estimate for blocks of size 2^( 5) =       0.000414786316
  error estimate for blocks of size 2^( 6) =       0.000417866364
  error estimate for blocks of size 2^( 7) =       0.000418006158

      target function =                  N/A
              le_mean =     -17.216825295652
             les_mean =     296.728055185812
             stat err =       0.000415190379
             autocorr =       1.166332999072
              std dev =       0.543689564557
             le_variance =       0.295598342608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295607881376
                                         uncertainty =       0.001658525248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295607881376
                                         uncertainty =       0.001658525248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384398567
  error estimate for blocks of size 2^( 2) =       0.000394736631
  error estimate for blocks of size 2^( 3) =       0.000403554919
  error estimate for blocks of size 2^( 4) =       0.000409993637
  error estimate for blocks of size 2^( 5) =       0.000414663908
  error estimate for blocks of size 2^( 6) =       0.000417727631
  error estimate for blocks of size 2^( 7) =       0.000417848567

      target function =                  N/A
              le_mean =     -17.216850993179
             les_mean =     296.742332688470
             stat err =       0.000415058436
             autocorr =       1.165882998175
              std dev =       0.543621667459
             le_variance =       0.295524517331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295385676448
                                         uncertainty =       0.001653130617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295385676448
                                         uncertainty =       0.001653130617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384254098
  error estimate for blocks of size 2^( 2) =       0.000394609413
  error estimate for blocks of size 2^( 3) =       0.000403445154
  error estimate for blocks of size 2^( 4) =       0.000409895311
  error estimate for blocks of size 2^( 5) =       0.000414573125
  error estimate for blocks of size 2^( 6) =       0.000417639562
  error estimate for blocks of size 2^( 7) =       0.000417770274

      target function =                  N/A
              le_mean =     -17.216840427365
             les_mean =     296.731195959284
             stat err =       0.000414969568
             autocorr =       1.166260273457
              std dev =       0.543417356326
             le_variance =       0.295302423156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295613392874
                                         uncertainty =       0.001650562110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295613392874
                                         uncertainty =       0.001650562110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384402178
  error estimate for blocks of size 2^( 2) =       0.000394771103
  error estimate for blocks of size 2^( 3) =       0.000403610147
  error estimate for blocks of size 2^( 4) =       0.000410054539
  error estimate for blocks of size 2^( 5) =       0.000414737380
  error estimate for blocks of size 2^( 6) =       0.000417816439
  error estimate for blocks of size 2^( 7) =       0.000417952034

      target function =                  N/A
              le_mean =     -17.216826478103
             les_mean =     296.726394174864
             stat err =       0.000415140098
             autocorr =       1.166319901689
              std dev =       0.543626774027
             le_variance =       0.295530069439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216825295652        initial
     2.4414e-01     2.4414e+00             6.4501e-03       -17.216850993179  <--
     9.7656e-01     9.7656e+00             1.8824e-03       -17.216840427365
     3.9062e+00     3.9062e+01             4.9263e-04       -17.216826478103

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9570e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.013929e-01 1 1  ON 0
  uu_1                 4.235543e-02 1 1  ON 1
  uu_2                -4.773847e-02 1 1  ON 2
  uu_3                -9.833523e-02 1 1  ON 3
  uu_4                -1.281194e-01 1 1  ON 4
  uu_5                -1.332643e-01 1 1  ON 5
  uu_6                -1.117385e-01 1 1  ON 6
  uu_7                -3.707393e-02 1 1  ON 7
  uu_8                 1.014148e-01 1 1  ON 8
  uu_9                 1.198674e-01 1 1  ON 9
  ud_0                 3.450235e-01 1 1  ON 10
  ud_1                 8.862531e-02 1 1  ON 11
  ud_2                -1.728349e-02 1 1  ON 12
  ud_3                -7.449514e-02 1 1  ON 13
  ud_4                -1.192272e-01 1 1  ON 14
  ud_5                -1.497755e-01 1 1  ON 15
  ud_6                -1.544292e-01 1 1  ON 16
  ud_7                -1.091014e-01 1 1  ON 17
  ud_8                 6.809672e-03 1 1  ON 18
  ud_9                 9.252653e-02 1 1  ON 19
  eO_0                -7.322047e-01 1 1  ON 20
  eO_1                -4.242756e-01 1 1  ON 21
  eO_2                -3.523776e-02 1 1  ON 22
  eO_3                 1.969477e-01 1 1  ON 23
  eO_4                 2.753384e-01 1 1  ON 24
  eO_5                 3.038402e-01 1 1  ON 25
  eO_6                 2.490305e-01 1 1  ON 26
  eO_7                 1.101807e-01 1 1  ON 27
  eO_8                 2.761596e-02 1 1  ON 28
  eO_9                 1.829875e-02 1 1  ON 29
 eH1_0                -1.809142e-01 1 1  ON 30
 eH1_1                -1.016508e-01 1 1  ON 31
 eH1_2                -6.234023e-02 1 1  ON 32
 eH1_3                -2.650853e-02 1 1  ON 33
 eH1_4                 2.006209e-02 1 1  ON 34
 eH1_5                 3.515976e-02 1 1  ON 35
 eH1_6                 7.676224e-02 1 1  ON 36
 eH1_7                 1.107121e-01 1 1  ON 37
 eH1_8                 8.964022e-02 1 1  ON 38
 eH1_9                 2.394576e-02 1 1  ON 39
 eH2_0                -1.818956e-01 1 1  ON 40
 eH2_1                -1.030313e-01 1 1  ON 41
 eH2_2                -6.385952e-02 1 1  ON 42
 eH2_3                -2.776934e-02 1 1  ON 43
 eH2_4                 1.850247e-02 1 1  ON 44
 eH2_5                 3.464428e-02 1 1  ON 45
 eH2_6                 7.839144e-02 1 1  ON 46
 eH2_7                 1.141747e-01 1 1  ON 47
 eH2_8                 9.281436e-02 1 1  ON 48
 eH2_9                 2.600151e-02 1 1  ON 49
ci_001                -4.206561e-02 3 1  ON 50
ci_002                -3.091554e-02 3 1  ON 51
ci_003                -2.633790e-02 3 1  ON 52
ci_004                 2.207094e-02 3 1  ON 53
ci_005                 2.243110e-02 3 1  ON 54
ci_006                -1.979986e-02 3 1  ON 55
ci_007                -1.975424e-02 3 1  ON 56
ci_008                -1.811977e-02 3 1  ON 57
ci_009                -1.788386e-02 3 1  ON 58
ci_010                -1.840697e-02 3 1  ON 59
ci_011                -1.637077e-02 3 1  ON 60
ci_012                -1.704148e-02 3 1  ON 61
ci_013                -1.972497e-02 3 1  ON 62
ci_014                 1.450900e-02 3 1  ON 63
ci_015                 1.427213e-02 3 1  ON 64
ci_016                 1.705942e-02 3 1  ON 65
ci_017                 1.682019e-02 3 1  ON 66
ci_018                 1.312223e-02 3 1  ON 67
ci_019                 1.323176e-02 3 1  ON 68
ci_020                 1.371043e-02 3 1  ON 69
ci_021                 1.432117e-02 3 1  ON 70
ci_022                 1.216759e-02 3 1  ON 71
ci_023                 1.181254e-02 3 1  ON 72
ci_024                 1.234433e-02 3 1  ON 73
ci_025                 1.316569e-02 3 1  ON 74
ci_026                 1.112590e-02 3 1  ON 75
ci_027                 1.159831e-02 3 1  ON 76
ci_028                -1.459522e-02 3 1  ON 77
ci_029                -1.439428e-02 3 1  ON 78
ci_030                -1.133247e-02 3 1  ON 79
ci_031                -1.168004e-02 3 1  ON 80
ci_032                -1.376629e-02 3 1  ON 81
ci_033                 1.078717e-02 3 1  ON 82
ci_034                 1.110957e-02 3 1  ON 83
ci_035                -5.253367e-03 3 1  ON 84
ci_036                -1.074698e-02 3 1  ON 85
ci_037                -1.059752e-02 3 1  ON 86
ci_038                 1.812503e-03 3 1  ON 87
ci_039                 2.345494e-03 3 1  ON 88
ci_040                -3.865498e-03 3 1  ON 89
ci_041                 1.029701e-02 3 1  ON 90
ci_042                 1.026912e-02 3 1  ON 91
ci_043                -3.804748e-03 3 1  ON 92
ci_044                -1.501462e-02 3 1  ON 93
ci_045                -2.273915e-03 3 1  ON 94
ci_046                 5.537625e-03 3 1  ON 95
ci_047                 6.558573e-03 3 1  ON 96
ci_048                -1.196495e-02 3 1  ON 97
ci_049                -1.185294e-02 3 1  ON 98
ci_050                 7.204674e-03 3 1  ON 99
ci_051                 7.801092e-03 3 1  ON 100
ci_052                -6.964456e-03 3 1  ON 101
ci_053                -6.578110e-03 3 1  ON 102
ci_054                -3.276475e-03 3 1  ON 103
ci_055                -3.496915e-03 3 1  ON 104
ci_056                 4.422914e-03 3 1  ON 105
ci_057                 4.811172e-03 3 1  ON 106
ci_058                -6.944604e-03 3 1  ON 107
ci_059                -6.495916e-03 3 1  ON 108
ci_060                 8.379168e-03 3 1  ON 109
ci_061                 8.459675e-03 3 1  ON 110
ci_062                -3.255131e-03 3 1  ON 111
ci_063                -3.639165e-03 3 1  ON 112
ci_064                -3.281640e-03 3 1  ON 113
ci_065                -4.162846e-03 3 1  ON 114
ci_066                 5.854088e-03 3 1  ON 115
ci_067                 5.662806e-03 3 1  ON 116
ci_068                -5.532873e-03 3 1  ON 117
ci_069                -4.906306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.241
    reference variance = 0.166746
====================================================
  Execution time = 2.0992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1126e-01
  Total weights = 1.956695880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295745308463
                                         uncertainty =       0.002256516427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295745308463
                                         uncertainty =       0.002256516427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384479710
  error estimate for blocks of size 2^( 2) =       0.000394499914
  error estimate for blocks of size 2^( 3) =       0.000403929394
  error estimate for blocks of size 2^( 4) =       0.000410233670
  error estimate for blocks of size 2^( 5) =       0.000414329397
  error estimate for blocks of size 2^( 6) =       0.000416584960
  error estimate for blocks of size 2^( 7) =       0.000418206406

      target function =                  N/A
              le_mean =     -17.216635239705
             les_mean =     296.723789299457
             stat err =       0.000414838608
             autocorr =       1.164156819498
              std dev =       0.543736419719
             le_variance =       0.295649294128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663523971e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635239701       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216662722758       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661807840       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675778290       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216676423389       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216697160152       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216696768624       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216701605431       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216705238832       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216707960243       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216707230881       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216708262506       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216707744926       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216708808376       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216710223748       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216711725330       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216711914595       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216712353337       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216712183774       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216712359643       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216712024953       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216711761308       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216711641991       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e-02 is 1.489146e-02

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635239701       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216651687335       residual = 7.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216651458763       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658914179       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216655885887       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664000651       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664297688       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216665922583       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216666693406       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216666919276       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216667141812       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216666616440       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216666570609       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216666800350       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e-01 is 5.099819e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216635239701       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216641550788       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216641602167       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216643586849       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216642280960       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216644704828       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216644756633       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216645248793       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216645230036       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216645383961       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216645392482       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216645311538       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e-01 is 1.454986e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178550 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7204e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.029712e-01 1 1  ON 0
  uu_1                 4.318307e-02 1 1  ON 1
  uu_2                -4.754604e-02 1 1  ON 2
  uu_3                -9.869836e-02 1 1  ON 3
  uu_4                -1.288453e-01 1 1  ON 4
  uu_5                -1.341191e-01 1 1  ON 5
  uu_6                -1.122465e-01 1 1  ON 6
  uu_7                -3.745214e-02 1 1  ON 7
  uu_8                 1.011273e-01 1 1  ON 8
  uu_9                 1.200971e-01 1 1  ON 9
  ud_0                 3.466657e-01 1 1  ON 10
  ud_1                 8.949773e-02 1 1  ON 11
  ud_2                -1.726838e-02 1 1  ON 12
  ud_3                -7.511373e-02 1 1  ON 13
  ud_4                -1.200789e-01 1 1  ON 14
  ud_5                -1.501999e-01 1 1  ON 15
  ud_6                -1.542449e-01 1 1  ON 16
  ud_7                -1.094546e-01 1 1  ON 17
  ud_8                 6.110452e-03 1 1  ON 18
  ud_9                 9.248903e-02 1 1  ON 19
  eO_0                -7.373045e-01 1 1  ON 20
  eO_1                -4.272533e-01 1 1  ON 21
  eO_2                -3.497575e-02 1 1  ON 22
  eO_3                 2.003572e-01 1 1  ON 23
  eO_4                 2.788762e-01 1 1  ON 24
  eO_5                 3.039389e-01 1 1  ON 25
  eO_6                 2.492721e-01 1 1  ON 26
  eO_7                 1.105904e-01 1 1  ON 27
  eO_8                 2.766867e-02 1 1  ON 28
  eO_9                 1.833020e-02 1 1  ON 29
 eH1_0                -1.812326e-01 1 1  ON 30
 eH1_1                -1.021126e-01 1 1  ON 31
 eH1_2                -6.246834e-02 1 1  ON 32
 eH1_3                -2.644571e-02 1 1  ON 33
 eH1_4                 2.006466e-02 1 1  ON 34
 eH1_5                 3.565629e-02 1 1  ON 35
 eH1_6                 7.686375e-02 1 1  ON 36
 eH1_7                 1.106359e-01 1 1  ON 37
 eH1_8                 8.987318e-02 1 1  ON 38
 eH1_9                 2.400062e-02 1 1  ON 39
 eH2_0                -1.825149e-01 1 1  ON 40
 eH2_1                -1.032599e-01 1 1  ON 41
 eH2_2                -6.370902e-02 1 1  ON 42
 eH2_3                -2.772954e-02 1 1  ON 43
 eH2_4                 1.873486e-02 1 1  ON 44
 eH2_5                 3.511622e-02 1 1  ON 45
 eH2_6                 7.830575e-02 1 1  ON 46
 eH2_7                 1.138734e-01 1 1  ON 47
 eH2_8                 9.306420e-02 1 1  ON 48
 eH2_9                 2.607826e-02 1 1  ON 49
ci_001                -4.098553e-02 3 1  ON 50
ci_002                -3.060424e-02 3 1  ON 51
ci_003                -2.595483e-02 3 1  ON 52
ci_004                 2.174888e-02 3 1  ON 53
ci_005                 2.145960e-02 3 1  ON 54
ci_006                -1.968966e-02 3 1  ON 55
ci_007                -1.952382e-02 3 1  ON 56
ci_008                -1.767427e-02 3 1  ON 57
ci_009                -1.789540e-02 3 1  ON 58
ci_010                -1.801482e-02 3 1  ON 59
ci_011                -1.673687e-02 3 1  ON 60
ci_012                -1.640244e-02 3 1  ON 61
ci_013                -1.934695e-02 3 1  ON 62
ci_014                 1.408029e-02 3 1  ON 63
ci_015                 1.428990e-02 3 1  ON 64
ci_016                 1.728343e-02 3 1  ON 65
ci_017                 1.624552e-02 3 1  ON 66
ci_018                 1.328237e-02 3 1  ON 67
ci_019                 1.312224e-02 3 1  ON 68
ci_020                 1.356445e-02 3 1  ON 69
ci_021                 1.346489e-02 3 1  ON 70
ci_022                 1.180781e-02 3 1  ON 71
ci_023                 1.162706e-02 3 1  ON 72
ci_024                 1.169394e-02 3 1  ON 73
ci_025                 1.289874e-02 3 1  ON 74
ci_026                 1.106777e-02 3 1  ON 75
ci_027                 1.099882e-02 3 1  ON 76
ci_028                -1.481243e-02 3 1  ON 77
ci_029                -1.457502e-02 3 1  ON 78
ci_030                -1.122682e-02 3 1  ON 79
ci_031                -1.141886e-02 3 1  ON 80
ci_032                -1.379995e-02 3 1  ON 81
ci_033                 1.028037e-02 3 1  ON 82
ci_034                 1.087173e-02 3 1  ON 83
ci_035                -5.073679e-03 3 1  ON 84
ci_036                -1.080806e-02 3 1  ON 85
ci_037                -9.908651e-03 3 1  ON 86
ci_038                 1.648980e-03 3 1  ON 87
ci_039                 2.029736e-03 3 1  ON 88
ci_040                -4.021509e-03 3 1  ON 89
ci_041                 1.007844e-02 3 1  ON 90
ci_042                 1.025306e-02 3 1  ON 91
ci_043                -3.405520e-03 3 1  ON 92
ci_044                -1.515217e-02 3 1  ON 93
ci_045                -2.101220e-03 3 1  ON 94
ci_046                 5.624380e-03 3 1  ON 95
ci_047                 6.292518e-03 3 1  ON 96
ci_048                -1.161410e-02 3 1  ON 97
ci_049                -1.136444e-02 3 1  ON 98
ci_050                 7.342030e-03 3 1  ON 99
ci_051                 7.524682e-03 3 1  ON 100
ci_052                -6.748656e-03 3 1  ON 101
ci_053                -6.669731e-03 3 1  ON 102
ci_054                -3.171105e-03 3 1  ON 103
ci_055                -3.615420e-03 3 1  ON 104
ci_056                 4.425828e-03 3 1  ON 105
ci_057                 4.649060e-03 3 1  ON 106
ci_058                -6.989480e-03 3 1  ON 107
ci_059                -6.763767e-03 3 1  ON 108
ci_060                 8.276168e-03 3 1  ON 109
ci_061                 8.685719e-03 3 1  ON 110
ci_062                -3.200686e-03 3 1  ON 111
ci_063                -3.603845e-03 3 1  ON 112
ci_064                -3.130355e-03 3 1  ON 113
ci_065                -4.035213e-03 3 1  ON 114
ci_066                 5.523767e-03 3 1  ON 115
ci_067                 5.461920e-03 3 1  ON 116
ci_068                -5.425462e-03 3 1  ON 117
ci_069                -5.052534e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.158243
====================================================
  Execution time = 2.0729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0709e-01
  Total weights = 1.9566e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293479509825
                                         uncertainty =       0.002145112834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293479509825
                                         uncertainty =       0.002145112834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383139933
  error estimate for blocks of size 2^( 2) =       0.000393270516
  error estimate for blocks of size 2^( 3) =       0.000402470166
  error estimate for blocks of size 2^( 4) =       0.000409043827
  error estimate for blocks of size 2^( 5) =       0.000413063979
  error estimate for blocks of size 2^( 6) =       0.000416222682
  error estimate for blocks of size 2^( 7) =       0.000415680992

      target function =                  N/A
              le_mean =     -17.216033067759
             les_mean =     296.701796810608
             stat err =       0.000413502870
             autocorr =       1.164775476969
              std dev =       0.541841689627
             le_variance =       0.293592416617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296414220708
                                         uncertainty =       0.002407577679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296414220708
                                         uncertainty =       0.002407577679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385046542
  error estimate for blocks of size 2^( 2) =       0.000395088497
  error estimate for blocks of size 2^( 3) =       0.000404194320
  error estimate for blocks of size 2^( 4) =       0.000410757252
  error estimate for blocks of size 2^( 5) =       0.000414841968
  error estimate for blocks of size 2^( 6) =       0.000417840424
  error estimate for blocks of size 2^( 7) =       0.000416996521

      target function =                  N/A
              le_mean =     -17.215994308595
             les_mean =     297.196797677705
             stat err =       0.000415109041
             autocorr =       1.162245652745
              std dev =       0.544538041640
             le_variance =       0.296521678793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294797191540
                                         uncertainty =       0.002169656258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294797191540
                                         uncertainty =       0.002169656258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383997773
  error estimate for blocks of size 2^( 2) =       0.000394092709
  error estimate for blocks of size 2^( 3) =       0.000403277334
  error estimate for blocks of size 2^( 4) =       0.000409828531
  error estimate for blocks of size 2^( 5) =       0.000413859583
  error estimate for blocks of size 2^( 6) =       0.000416927908
  error estimate for blocks of size 2^( 7) =       0.000416430590

      target function =                  N/A
              le_mean =     -17.216025738214
             les_mean =     296.703157732618
             stat err =       0.000414261653
             autocorr =       1.163836724720
              std dev =       0.543054857905
             le_variance =       0.294908578695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293580616446
                                         uncertainty =       0.002148361397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293580616446
                                         uncertainty =       0.002148361397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383205733
  error estimate for blocks of size 2^( 2) =       0.000393330736
  error estimate for blocks of size 2^( 3) =       0.000402530087
  error estimate for blocks of size 2^( 4) =       0.000409104563
  error estimate for blocks of size 2^( 5) =       0.000413128084
  error estimate for blocks of size 2^( 6) =       0.000416271671
  error estimate for blocks of size 2^( 7) =       0.000415731395

      target function =                  N/A
              le_mean =     -17.216020029906
             les_mean =     296.699960214528
             stat err =       0.000413558928
             autocorr =       1.164691233872
              std dev =       0.541934744806
             le_variance =       0.293693267627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216033067759        initial  <--
     6.1035e-02     6.1035e-01             1.4891e-02       -17.215994308595
     2.4414e-01     2.4414e+00             5.0998e-03       -17.216025738214
     9.7656e-01     9.7656e+00             1.4550e-03       -17.216020029906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9403
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.013929e-01 1 1  ON 0
  uu_1                 4.235543e-02 1 1  ON 1
  uu_2                -4.773847e-02 1 1  ON 2
  uu_3                -9.833523e-02 1 1  ON 3
  uu_4                -1.281194e-01 1 1  ON 4
  uu_5                -1.332643e-01 1 1  ON 5
  uu_6                -1.117385e-01 1 1  ON 6
  uu_7                -3.707393e-02 1 1  ON 7
  uu_8                 1.014148e-01 1 1  ON 8
  uu_9                 1.198674e-01 1 1  ON 9
  ud_0                 3.450235e-01 1 1  ON 10
  ud_1                 8.862531e-02 1 1  ON 11
  ud_2                -1.728349e-02 1 1  ON 12
  ud_3                -7.449514e-02 1 1  ON 13
  ud_4                -1.192272e-01 1 1  ON 14
  ud_5                -1.497755e-01 1 1  ON 15
  ud_6                -1.544292e-01 1 1  ON 16
  ud_7                -1.091014e-01 1 1  ON 17
  ud_8                 6.809672e-03 1 1  ON 18
  ud_9                 9.252653e-02 1 1  ON 19
  eO_0                -7.322047e-01 1 1  ON 20
  eO_1                -4.242756e-01 1 1  ON 21
  eO_2                -3.523776e-02 1 1  ON 22
  eO_3                 1.969477e-01 1 1  ON 23
  eO_4                 2.753384e-01 1 1  ON 24
  eO_5                 3.038402e-01 1 1  ON 25
  eO_6                 2.490305e-01 1 1  ON 26
  eO_7                 1.101807e-01 1 1  ON 27
  eO_8                 2.761596e-02 1 1  ON 28
  eO_9                 1.829875e-02 1 1  ON 29
 eH1_0                -1.809142e-01 1 1  ON 30
 eH1_1                -1.016508e-01 1 1  ON 31
 eH1_2                -6.234023e-02 1 1  ON 32
 eH1_3                -2.650853e-02 1 1  ON 33
 eH1_4                 2.006209e-02 1 1  ON 34
 eH1_5                 3.515976e-02 1 1  ON 35
 eH1_6                 7.676224e-02 1 1  ON 36
 eH1_7                 1.107121e-01 1 1  ON 37
 eH1_8                 8.964022e-02 1 1  ON 38
 eH1_9                 2.394576e-02 1 1  ON 39
 eH2_0                -1.818956e-01 1 1  ON 40
 eH2_1                -1.030313e-01 1 1  ON 41
 eH2_2                -6.385952e-02 1 1  ON 42
 eH2_3                -2.776934e-02 1 1  ON 43
 eH2_4                 1.850247e-02 1 1  ON 44
 eH2_5                 3.464428e-02 1 1  ON 45
 eH2_6                 7.839144e-02 1 1  ON 46
 eH2_7                 1.141747e-01 1 1  ON 47
 eH2_8                 9.281436e-02 1 1  ON 48
 eH2_9                 2.600151e-02 1 1  ON 49
ci_001                -4.206561e-02 3 1  ON 50
ci_002                -3.091554e-02 3 1  ON 51
ci_003                -2.633790e-02 3 1  ON 52
ci_004                 2.207094e-02 3 1  ON 53
ci_005                 2.243110e-02 3 1  ON 54
ci_006                -1.979986e-02 3 1  ON 55
ci_007                -1.975424e-02 3 1  ON 56
ci_008                -1.811977e-02 3 1  ON 57
ci_009                -1.788386e-02 3 1  ON 58
ci_010                -1.840697e-02 3 1  ON 59
ci_011                -1.637077e-02 3 1  ON 60
ci_012                -1.704148e-02 3 1  ON 61
ci_013                -1.972497e-02 3 1  ON 62
ci_014                 1.450900e-02 3 1  ON 63
ci_015                 1.427213e-02 3 1  ON 64
ci_016                 1.705942e-02 3 1  ON 65
ci_017                 1.682019e-02 3 1  ON 66
ci_018                 1.312223e-02 3 1  ON 67
ci_019                 1.323176e-02 3 1  ON 68
ci_020                 1.371043e-02 3 1  ON 69
ci_021                 1.432117e-02 3 1  ON 70
ci_022                 1.216759e-02 3 1  ON 71
ci_023                 1.181254e-02 3 1  ON 72
ci_024                 1.234433e-02 3 1  ON 73
ci_025                 1.316569e-02 3 1  ON 74
ci_026                 1.112590e-02 3 1  ON 75
ci_027                 1.159831e-02 3 1  ON 76
ci_028                -1.459522e-02 3 1  ON 77
ci_029                -1.439428e-02 3 1  ON 78
ci_030                -1.133247e-02 3 1  ON 79
ci_031                -1.168004e-02 3 1  ON 80
ci_032                -1.376629e-02 3 1  ON 81
ci_033                 1.078717e-02 3 1  ON 82
ci_034                 1.110957e-02 3 1  ON 83
ci_035                -5.253367e-03 3 1  ON 84
ci_036                -1.074698e-02 3 1  ON 85
ci_037                -1.059752e-02 3 1  ON 86
ci_038                 1.812503e-03 3 1  ON 87
ci_039                 2.345494e-03 3 1  ON 88
ci_040                -3.865498e-03 3 1  ON 89
ci_041                 1.029701e-02 3 1  ON 90
ci_042                 1.026912e-02 3 1  ON 91
ci_043                -3.804748e-03 3 1  ON 92
ci_044                -1.501462e-02 3 1  ON 93
ci_045                -2.273915e-03 3 1  ON 94
ci_046                 5.537625e-03 3 1  ON 95
ci_047                 6.558573e-03 3 1  ON 96
ci_048                -1.196495e-02 3 1  ON 97
ci_049                -1.185294e-02 3 1  ON 98
ci_050                 7.204674e-03 3 1  ON 99
ci_051                 7.801092e-03 3 1  ON 100
ci_052                -6.964456e-03 3 1  ON 101
ci_053                -6.578110e-03 3 1  ON 102
ci_054                -3.276475e-03 3 1  ON 103
ci_055                -3.496915e-03 3 1  ON 104
ci_056                 4.422914e-03 3 1  ON 105
ci_057                 4.811172e-03 3 1  ON 106
ci_058                -6.944604e-03 3 1  ON 107
ci_059                -6.495916e-03 3 1  ON 108
ci_060                 8.379168e-03 3 1  ON 109
ci_061                 8.459675e-03 3 1  ON 110
ci_062                -3.255131e-03 3 1  ON 111
ci_063                -3.639165e-03 3 1  ON 112
ci_064                -3.281640e-03 3 1  ON 113
ci_065                -4.162846e-03 3 1  ON 114
ci_066                 5.854088e-03 3 1  ON 115
ci_067                 5.662806e-03 3 1  ON 116
ci_068                -5.532873e-03 3 1  ON 117
ci_069                -4.906306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2025
    reference variance = 0.724897
====================================================
  Execution time = 2.1034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1551e-01
  Total weights = 1.956223934e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217405151
                                         uncertainty =       0.002277595736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217405151
                                         uncertainty =       0.002277595736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756043
  error estimate for blocks of size 2^( 2) =       0.000396853715
  error estimate for blocks of size 2^( 3) =       0.000406159813
  error estimate for blocks of size 2^( 4) =       0.000413685582
  error estimate for blocks of size 2^( 5) =       0.000419085940
  error estimate for blocks of size 2^( 6) =       0.000422958890
  error estimate for blocks of size 2^( 7) =       0.000423710089

      target function =                  N/A
              le_mean =     -17.216007316798
             les_mean =     296.706420096890
             stat err =       0.000419860125
             autocorr =       1.178514811206
              std dev =       0.546955641757
             le_variance =       0.299160474050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721600731680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007316804       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216010452011       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216010346011       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216015874246       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216018469623       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216020401526       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216019937155       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019967625       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216020182247       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216020308607       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216020240152       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216020112200       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e-01 is 2.445555e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007316804       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216008318102       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216008247668       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216009639208       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216010202969       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216010811691       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216010746430       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216010683790       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216010780196       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216010808932       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216010779480       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+00 is 6.519774e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216007316804       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216007585788       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216007564070       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216007894498       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216008026784       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216008199364       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216008187629       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216008168474       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216008190748       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216008202549       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+00 is 1.655414e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7442e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.015737e-01 1 1  ON 0
  uu_1                 4.244531e-02 1 1  ON 1
  uu_2                -4.774255e-02 1 1  ON 2
  uu_3                -9.840547e-02 1 1  ON 3
  uu_4                -1.282369e-01 1 1  ON 4
  uu_5                -1.332803e-01 1 1  ON 5
  uu_6                -1.117625e-01 1 1  ON 6
  uu_7                -3.714481e-02 1 1  ON 7
  uu_8                 1.013890e-01 1 1  ON 8
  uu_9                 1.198990e-01 1 1  ON 9
  ud_0                 3.452442e-01 1 1  ON 10
  ud_1                 8.873885e-02 1 1  ON 11
  ud_2                -1.729829e-02 1 1  ON 12
  ud_3                -7.458022e-02 1 1  ON 13
  ud_4                -1.193675e-01 1 1  ON 14
  ud_5                -1.498274e-01 1 1  ON 15
  ud_6                -1.543987e-01 1 1  ON 16
  ud_7                -1.091357e-01 1 1  ON 17
  ud_8                 6.748665e-03 1 1  ON 18
  ud_9                 9.252426e-02 1 1  ON 19
  eO_0                -7.328567e-01 1 1  ON 20
  eO_1                -4.245992e-01 1 1  ON 21
  eO_2                -3.516886e-02 1 1  ON 22
  eO_3                 1.974581e-01 1 1  ON 23
  eO_4                 2.756738e-01 1 1  ON 24
  eO_5                 3.038207e-01 1 1  ON 25
  eO_6                 2.490524e-01 1 1  ON 26
  eO_7                 1.102255e-01 1 1  ON 27
  eO_8                 2.762364e-02 1 1  ON 28
  eO_9                 1.830225e-02 1 1  ON 29
 eH1_0                -1.809410e-01 1 1  ON 30
 eH1_1                -1.017066e-01 1 1  ON 31
 eH1_2                -6.234761e-02 1 1  ON 32
 eH1_3                -2.647347e-02 1 1  ON 33
 eH1_4                 2.003758e-02 1 1  ON 34
 eH1_5                 3.522465e-02 1 1  ON 35
 eH1_6                 7.676659e-02 1 1  ON 36
 eH1_7                 1.106901e-01 1 1  ON 37
 eH1_8                 8.966221e-02 1 1  ON 38
 eH1_9                 2.395301e-02 1 1  ON 39
 eH2_0                -1.819662e-01 1 1  ON 40
 eH2_1                -1.030703e-01 1 1  ON 41
 eH2_2                -6.382145e-02 1 1  ON 42
 eH2_3                -2.773730e-02 1 1  ON 43
 eH2_4                 1.853245e-02 1 1  ON 44
 eH2_5                 3.464894e-02 1 1  ON 45
 eH2_6                 7.837875e-02 1 1  ON 46
 eH2_7                 1.141488e-01 1 1  ON 47
 eH2_8                 9.284427e-02 1 1  ON 48
 eH2_9                 2.601308e-02 1 1  ON 49
ci_001                -4.202046e-02 3 1  ON 50
ci_002                -3.088944e-02 3 1  ON 51
ci_003                -2.626939e-02 3 1  ON 52
ci_004                 2.198088e-02 3 1  ON 53
ci_005                 2.229868e-02 3 1  ON 54
ci_006                -1.973744e-02 3 1  ON 55
ci_007                -1.974430e-02 3 1  ON 56
ci_008                -1.810039e-02 3 1  ON 57
ci_009                -1.783530e-02 3 1  ON 58
ci_010                -1.835432e-02 3 1  ON 59
ci_011                -1.639210e-02 3 1  ON 60
ci_012                -1.693858e-02 3 1  ON 61
ci_013                -1.971244e-02 3 1  ON 62
ci_014                 1.441119e-02 3 1  ON 63
ci_015                 1.418226e-02 3 1  ON 64
ci_016                 1.700898e-02 3 1  ON 65
ci_017                 1.678879e-02 3 1  ON 66
ci_018                 1.309472e-02 3 1  ON 67
ci_019                 1.313366e-02 3 1  ON 68
ci_020                 1.360485e-02 3 1  ON 69
ci_021                 1.420618e-02 3 1  ON 70
ci_022                 1.213805e-02 3 1  ON 71
ci_023                 1.171842e-02 3 1  ON 72
ci_024                 1.227053e-02 3 1  ON 73
ci_025                 1.306482e-02 3 1  ON 74
ci_026                 1.113657e-02 3 1  ON 75
ci_027                 1.154669e-02 3 1  ON 76
ci_028                -1.457497e-02 3 1  ON 77
ci_029                -1.445915e-02 3 1  ON 78
ci_030                -1.136735e-02 3 1  ON 79
ci_031                -1.161269e-02 3 1  ON 80
ci_032                -1.375894e-02 3 1  ON 81
ci_033                 1.068050e-02 3 1  ON 82
ci_034                 1.094555e-02 3 1  ON 83
ci_035                -5.140504e-03 3 1  ON 84
ci_036                -1.074949e-02 3 1  ON 85
ci_037                -1.055274e-02 3 1  ON 86
ci_038                 1.835298e-03 3 1  ON 87
ci_039                 2.266241e-03 3 1  ON 88
ci_040                -3.967407e-03 3 1  ON 89
ci_041                 1.024012e-02 3 1  ON 90
ci_042                 1.028511e-02 3 1  ON 91
ci_043                -3.715199e-03 3 1  ON 92
ci_044                -1.500509e-02 3 1  ON 93
ci_045                -2.243047e-03 3 1  ON 94
ci_046                 5.544541e-03 3 1  ON 95
ci_047                 6.511715e-03 3 1  ON 96
ci_048                -1.196897e-02 3 1  ON 97
ci_049                -1.189921e-02 3 1  ON 98
ci_050                 7.300145e-03 3 1  ON 99
ci_051                 7.827665e-03 3 1  ON 100
ci_052                -6.979068e-03 3 1  ON 101
ci_053                -6.607944e-03 3 1  ON 102
ci_054                -3.294538e-03 3 1  ON 103
ci_055                -3.485562e-03 3 1  ON 104
ci_056                 4.370894e-03 3 1  ON 105
ci_057                 4.734533e-03 3 1  ON 106
ci_058                -6.981369e-03 3 1  ON 107
ci_059                -6.536970e-03 3 1  ON 108
ci_060                 8.404437e-03 3 1  ON 109
ci_061                 8.437009e-03 3 1  ON 110
ci_062                -3.241226e-03 3 1  ON 111
ci_063                -3.565186e-03 3 1  ON 112
ci_064                -3.220072e-03 3 1  ON 113
ci_065                -4.094878e-03 3 1  ON 114
ci_066                 5.763489e-03 3 1  ON 115
ci_067                 5.653083e-03 3 1  ON 116
ci_068                -5.514547e-03 3 1  ON 117
ci_069                -4.898799e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.311733
====================================================
  Execution time = 2.0561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1693e-01
  Total weights = 1.9563e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301505932174
                                         uncertainty =       0.002190521950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301505932174
                                         uncertainty =       0.002190521950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388270231
  error estimate for blocks of size 2^( 2) =       0.000398405227
  error estimate for blocks of size 2^( 3) =       0.000407502626
  error estimate for blocks of size 2^( 4) =       0.000414258770
  error estimate for blocks of size 2^( 5) =       0.000417316429
  error estimate for blocks of size 2^( 6) =       0.000419361070
  error estimate for blocks of size 2^( 7) =       0.000421106928

      target function =                  N/A
              le_mean =     -17.216597950095
             les_mean =     296.728105931587
             stat err =       0.000418010799
             autocorr =       1.159062397205
              std dev =       0.549097026134
             le_variance =       0.301507544109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301874775383
                                         uncertainty =       0.002194069756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301874775383
                                         uncertainty =       0.002194069756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388506176
  error estimate for blocks of size 2^( 2) =       0.000398630793
  error estimate for blocks of size 2^( 3) =       0.000407720375
  error estimate for blocks of size 2^( 4) =       0.000414470755
  error estimate for blocks of size 2^( 5) =       0.000417541811
  error estimate for blocks of size 2^( 6) =       0.000419586028
  error estimate for blocks of size 2^( 7) =       0.000421300036

      target function =                  N/A
              le_mean =     -17.216595162492
             les_mean =     296.728423128624
             stat err =       0.000418224658
             autocorr =       1.158839832557
              std dev =       0.549430702968
             le_variance =       0.301874097364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301709681539
                                         uncertainty =       0.002192269111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301709681539
                                         uncertainty =       0.002192269111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388400483
  error estimate for blocks of size 2^( 2) =       0.000398530381
  error estimate for blocks of size 2^( 3) =       0.000407624892
  error estimate for blocks of size 2^( 4) =       0.000414378461
  error estimate for blocks of size 2^( 5) =       0.000417444153
  error estimate for blocks of size 2^( 6) =       0.000419488933
  error estimate for blocks of size 2^( 7) =       0.000421214427

      target function =                  N/A
              le_mean =     -17.216594516717
             les_mean =     296.728136052708
             stat err =       0.000418131494
             autocorr =       1.158954105119
              std dev =       0.549281230231
             le_variance =       0.301709869884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301529578985
                                         uncertainty =       0.002190689462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301529578985
                                         uncertainty =       0.002190689462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388285334
  error estimate for blocks of size 2^( 2) =       0.000398419719
  error estimate for blocks of size 2^( 3) =       0.000407516829
  error estimate for blocks of size 2^( 4) =       0.000414272660
  error estimate for blocks of size 2^( 5) =       0.000417331468
  error estimate for blocks of size 2^( 6) =       0.000419375953
  error estimate for blocks of size 2^( 7) =       0.000421119235

      target function =                  N/A
              le_mean =     -17.216597110274
             les_mean =     296.728233794113
             stat err =       0.000418024829
             autocorr =       1.159050028569
              std dev =       0.549118385038
             le_variance =       0.301531000787


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216597950095        initial  <--
     6.1035e-01     6.1035e+00             2.4456e-03       -17.216595162492
     2.4414e+00     2.4414e+01             6.5198e-04       -17.216594516717
     9.7656e+00     9.7656e+01             1.6554e-04       -17.216597110274

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8000
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.013929e-01 1 1  ON 0
  uu_1                 4.235543e-02 1 1  ON 1
  uu_2                -4.773847e-02 1 1  ON 2
  uu_3                -9.833523e-02 1 1  ON 3
  uu_4                -1.281194e-01 1 1  ON 4
  uu_5                -1.332643e-01 1 1  ON 5
  uu_6                -1.117385e-01 1 1  ON 6
  uu_7                -3.707393e-02 1 1  ON 7
  uu_8                 1.014148e-01 1 1  ON 8
  uu_9                 1.198674e-01 1 1  ON 9
  ud_0                 3.450235e-01 1 1  ON 10
  ud_1                 8.862531e-02 1 1  ON 11
  ud_2                -1.728349e-02 1 1  ON 12
  ud_3                -7.449514e-02 1 1  ON 13
  ud_4                -1.192272e-01 1 1  ON 14
  ud_5                -1.497755e-01 1 1  ON 15
  ud_6                -1.544292e-01 1 1  ON 16
  ud_7                -1.091014e-01 1 1  ON 17
  ud_8                 6.809672e-03 1 1  ON 18
  ud_9                 9.252653e-02 1 1  ON 19
  eO_0                -7.322047e-01 1 1  ON 20
  eO_1                -4.242756e-01 1 1  ON 21
  eO_2                -3.523776e-02 1 1  ON 22
  eO_3                 1.969477e-01 1 1  ON 23
  eO_4                 2.753384e-01 1 1  ON 24
  eO_5                 3.038402e-01 1 1  ON 25
  eO_6                 2.490305e-01 1 1  ON 26
  eO_7                 1.101807e-01 1 1  ON 27
  eO_8                 2.761596e-02 1 1  ON 28
  eO_9                 1.829875e-02 1 1  ON 29
 eH1_0                -1.809142e-01 1 1  ON 30
 eH1_1                -1.016508e-01 1 1  ON 31
 eH1_2                -6.234023e-02 1 1  ON 32
 eH1_3                -2.650853e-02 1 1  ON 33
 eH1_4                 2.006209e-02 1 1  ON 34
 eH1_5                 3.515976e-02 1 1  ON 35
 eH1_6                 7.676224e-02 1 1  ON 36
 eH1_7                 1.107121e-01 1 1  ON 37
 eH1_8                 8.964022e-02 1 1  ON 38
 eH1_9                 2.394576e-02 1 1  ON 39
 eH2_0                -1.818956e-01 1 1  ON 40
 eH2_1                -1.030313e-01 1 1  ON 41
 eH2_2                -6.385952e-02 1 1  ON 42
 eH2_3                -2.776934e-02 1 1  ON 43
 eH2_4                 1.850247e-02 1 1  ON 44
 eH2_5                 3.464428e-02 1 1  ON 45
 eH2_6                 7.839144e-02 1 1  ON 46
 eH2_7                 1.141747e-01 1 1  ON 47
 eH2_8                 9.281436e-02 1 1  ON 48
 eH2_9                 2.600151e-02 1 1  ON 49
ci_001                -4.206561e-02 3 1  ON 50
ci_002                -3.091554e-02 3 1  ON 51
ci_003                -2.633790e-02 3 1  ON 52
ci_004                 2.207094e-02 3 1  ON 53
ci_005                 2.243110e-02 3 1  ON 54
ci_006                -1.979986e-02 3 1  ON 55
ci_007                -1.975424e-02 3 1  ON 56
ci_008                -1.811977e-02 3 1  ON 57
ci_009                -1.788386e-02 3 1  ON 58
ci_010                -1.840697e-02 3 1  ON 59
ci_011                -1.637077e-02 3 1  ON 60
ci_012                -1.704148e-02 3 1  ON 61
ci_013                -1.972497e-02 3 1  ON 62
ci_014                 1.450900e-02 3 1  ON 63
ci_015                 1.427213e-02 3 1  ON 64
ci_016                 1.705942e-02 3 1  ON 65
ci_017                 1.682019e-02 3 1  ON 66
ci_018                 1.312223e-02 3 1  ON 67
ci_019                 1.323176e-02 3 1  ON 68
ci_020                 1.371043e-02 3 1  ON 69
ci_021                 1.432117e-02 3 1  ON 70
ci_022                 1.216759e-02 3 1  ON 71
ci_023                 1.181254e-02 3 1  ON 72
ci_024                 1.234433e-02 3 1  ON 73
ci_025                 1.316569e-02 3 1  ON 74
ci_026                 1.112590e-02 3 1  ON 75
ci_027                 1.159831e-02 3 1  ON 76
ci_028                -1.459522e-02 3 1  ON 77
ci_029                -1.439428e-02 3 1  ON 78
ci_030                -1.133247e-02 3 1  ON 79
ci_031                -1.168004e-02 3 1  ON 80
ci_032                -1.376629e-02 3 1  ON 81
ci_033                 1.078717e-02 3 1  ON 82
ci_034                 1.110957e-02 3 1  ON 83
ci_035                -5.253367e-03 3 1  ON 84
ci_036                -1.074698e-02 3 1  ON 85
ci_037                -1.059752e-02 3 1  ON 86
ci_038                 1.812503e-03 3 1  ON 87
ci_039                 2.345494e-03 3 1  ON 88
ci_040                -3.865498e-03 3 1  ON 89
ci_041                 1.029701e-02 3 1  ON 90
ci_042                 1.026912e-02 3 1  ON 91
ci_043                -3.804748e-03 3 1  ON 92
ci_044                -1.501462e-02 3 1  ON 93
ci_045                -2.273915e-03 3 1  ON 94
ci_046                 5.537625e-03 3 1  ON 95
ci_047                 6.558573e-03 3 1  ON 96
ci_048                -1.196495e-02 3 1  ON 97
ci_049                -1.185294e-02 3 1  ON 98
ci_050                 7.204674e-03 3 1  ON 99
ci_051                 7.801092e-03 3 1  ON 100
ci_052                -6.964456e-03 3 1  ON 101
ci_053                -6.578110e-03 3 1  ON 102
ci_054                -3.276475e-03 3 1  ON 103
ci_055                -3.496915e-03 3 1  ON 104
ci_056                 4.422914e-03 3 1  ON 105
ci_057                 4.811172e-03 3 1  ON 106
ci_058                -6.944604e-03 3 1  ON 107
ci_059                -6.495916e-03 3 1  ON 108
ci_060                 8.379168e-03 3 1  ON 109
ci_061                 8.459675e-03 3 1  ON 110
ci_062                -3.255131e-03 3 1  ON 111
ci_063                -3.639165e-03 3 1  ON 112
ci_064                -3.281640e-03 3 1  ON 113
ci_065                -4.162846e-03 3 1  ON 114
ci_066                 5.854088e-03 3 1  ON 115
ci_067                 5.662806e-03 3 1  ON 116
ci_068                -5.532873e-03 3 1  ON 117
ci_069                -4.906306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2894
    reference variance = 0.189814
====================================================
  Execution time = 2.0803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1213e-01
  Total weights = 1.956446869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299240196578
                                         uncertainty =       0.002764847348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299240196578
                                         uncertainty =       0.002764847348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386754397
  error estimate for blocks of size 2^( 2) =       0.000396760721
  error estimate for blocks of size 2^( 3) =       0.000405765807
  error estimate for blocks of size 2^( 4) =       0.000412405812
  error estimate for blocks of size 2^( 5) =       0.000416904857
  error estimate for blocks of size 2^( 6) =       0.000419627758
  error estimate for blocks of size 2^( 7) =       0.000420380319

      target function =                  N/A
              le_mean =     -17.215872154058
             les_mean =     296.698388072983
             stat err =       0.000417329687
             autocorr =       1.164362038007
              std dev =       0.546953314080
             le_variance =       0.299157927783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587215406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872154093       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215873338710       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215873585894       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873651335       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215874259838       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215874168092       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215874285494       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215874329525       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215874341369       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215874333329       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+00 is 2.381277e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872154093       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215872459163       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872523707       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872535315       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215872688015       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215872666554       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215872696520       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215872707522       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215872711155       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215872709035       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+01 is 5.995366e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215872154093       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215872230939       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215872247256       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215872249857       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215872288037       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215872282771       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215872290308       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215872293067       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215872294014       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215872293485       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+01 is 1.501519e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6889e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.014112e-01 1 1  ON 0
  uu_1                 4.236560e-02 1 1  ON 1
  uu_2                -4.773911e-02 1 1  ON 2
  uu_3                -9.834084e-02 1 1  ON 3
  uu_4                -1.281276e-01 1 1  ON 4
  uu_5                -1.332686e-01 1 1  ON 5
  uu_6                -1.117441e-01 1 1  ON 6
  uu_7                -3.708052e-02 1 1  ON 7
  uu_8                 1.014117e-01 1 1  ON 8
  uu_9                 1.198699e-01 1 1  ON 9
  ud_0                 3.450424e-01 1 1  ON 10
  ud_1                 8.863397e-02 1 1  ON 11
  ud_2                -1.728201e-02 1 1  ON 12
  ud_3                -7.450049e-02 1 1  ON 13
  ud_4                -1.192367e-01 1 1  ON 14
  ud_5                -1.497803e-01 1 1  ON 15
  ud_6                -1.544318e-01 1 1  ON 16
  ud_7                -1.091055e-01 1 1  ON 17
  ud_8                 6.804680e-03 1 1  ON 18
  ud_9                 9.252662e-02 1 1  ON 19
  eO_0                -7.322647e-01 1 1  ON 20
  eO_1                -4.243057e-01 1 1  ON 21
  eO_2                -3.523196e-02 1 1  ON 22
  eO_3                 1.969934e-01 1 1  ON 23
  eO_4                 2.753712e-01 1 1  ON 24
  eO_5                 3.038394e-01 1 1  ON 25
  eO_6                 2.490312e-01 1 1  ON 26
  eO_7                 1.101850e-01 1 1  ON 27
  eO_8                 2.761692e-02 1 1  ON 28
  eO_9                 1.829913e-02 1 1  ON 29
 eH1_0                -1.809172e-01 1 1  ON 30
 eH1_1                -1.016542e-01 1 1  ON 31
 eH1_2                -6.233664e-02 1 1  ON 32
 eH1_3                -2.650859e-02 1 1  ON 33
 eH1_4                 2.005614e-02 1 1  ON 34
 eH1_5                 3.516577e-02 1 1  ON 35
 eH1_6                 7.676281e-02 1 1  ON 36
 eH1_7                 1.107109e-01 1 1  ON 37
 eH1_8                 8.964259e-02 1 1  ON 38
 eH1_9                 2.394653e-02 1 1  ON 39
 eH2_0                -1.819004e-01 1 1  ON 40
 eH2_1                -1.030365e-01 1 1  ON 41
 eH2_2                -6.385740e-02 1 1  ON 42
 eH2_3                -2.776541e-02 1 1  ON 43
 eH2_4                 1.850342e-02 1 1  ON 44
 eH2_5                 3.464882e-02 1 1  ON 45
 eH2_6                 7.838820e-02 1 1  ON 46
 eH2_7                 1.141725e-01 1 1  ON 47
 eH2_8                 9.281709e-02 1 1  ON 48
 eH2_9                 2.600239e-02 1 1  ON 49
ci_001                -4.205421e-02 3 1  ON 50
ci_002                -3.090805e-02 3 1  ON 51
ci_003                -2.633040e-02 3 1  ON 52
ci_004                 2.206052e-02 3 1  ON 53
ci_005                 2.242822e-02 3 1  ON 54
ci_006                -1.979312e-02 3 1  ON 55
ci_007                -1.975095e-02 3 1  ON 56
ci_008                -1.811574e-02 3 1  ON 57
ci_009                -1.787507e-02 3 1  ON 58
ci_010                -1.839948e-02 3 1  ON 59
ci_011                -1.637869e-02 3 1  ON 60
ci_012                -1.703778e-02 3 1  ON 61
ci_013                -1.971746e-02 3 1  ON 62
ci_014                 1.451094e-02 3 1  ON 63
ci_015                 1.427196e-02 3 1  ON 64
ci_016                 1.705619e-02 3 1  ON 65
ci_017                 1.682432e-02 3 1  ON 66
ci_018                 1.311919e-02 3 1  ON 67
ci_019                 1.322372e-02 3 1  ON 68
ci_020                 1.371115e-02 3 1  ON 69
ci_021                 1.431440e-02 3 1  ON 70
ci_022                 1.215955e-02 3 1  ON 71
ci_023                 1.180671e-02 3 1  ON 72
ci_024                 1.233945e-02 3 1  ON 73
ci_025                 1.315422e-02 3 1  ON 74
ci_026                 1.112398e-02 3 1  ON 75
ci_027                 1.160337e-02 3 1  ON 76
ci_028                -1.459424e-02 3 1  ON 77
ci_029                -1.439095e-02 3 1  ON 78
ci_030                -1.133877e-02 3 1  ON 79
ci_031                -1.167579e-02 3 1  ON 80
ci_032                -1.377147e-02 3 1  ON 81
ci_033                 1.078305e-02 3 1  ON 82
ci_034                 1.110708e-02 3 1  ON 83
ci_035                -5.249049e-03 3 1  ON 84
ci_036                -1.075224e-02 3 1  ON 85
ci_037                -1.059296e-02 3 1  ON 86
ci_038                 1.821017e-03 3 1  ON 87
ci_039                 2.335592e-03 3 1  ON 88
ci_040                -3.875701e-03 3 1  ON 89
ci_041                 1.029383e-02 3 1  ON 90
ci_042                 1.025962e-02 3 1  ON 91
ci_043                -3.794321e-03 3 1  ON 92
ci_044                -1.501689e-02 3 1  ON 93
ci_045                -2.269471e-03 3 1  ON 94
ci_046                 5.535465e-03 3 1  ON 95
ci_047                 6.541470e-03 3 1  ON 96
ci_048                -1.196620e-02 3 1  ON 97
ci_049                -1.185646e-02 3 1  ON 98
ci_050                 7.213798e-03 3 1  ON 99
ci_051                 7.795243e-03 3 1  ON 100
ci_052                -6.974908e-03 3 1  ON 101
ci_053                -6.579036e-03 3 1  ON 102
ci_054                -3.273449e-03 3 1  ON 103
ci_055                -3.497723e-03 3 1  ON 104
ci_056                 4.426496e-03 3 1  ON 105
ci_057                 4.801777e-03 3 1  ON 106
ci_058                -6.943883e-03 3 1  ON 107
ci_059                -6.498310e-03 3 1  ON 108
ci_060                 8.373417e-03 3 1  ON 109
ci_061                 8.466436e-03 3 1  ON 110
ci_062                -3.253682e-03 3 1  ON 111
ci_063                -3.631006e-03 3 1  ON 112
ci_064                -3.279100e-03 3 1  ON 113
ci_065                -4.165778e-03 3 1  ON 114
ci_066                 5.842343e-03 3 1  ON 115
ci_067                 5.667836e-03 3 1  ON 116
ci_068                -5.527065e-03 3 1  ON 117
ci_069                -4.903793e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.242242
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1182e-01
  Total weights = 1.9565e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296549488216
                                         uncertainty =       0.001863868441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296549488216
                                         uncertainty =       0.001863868441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385001292
  error estimate for blocks of size 2^( 2) =       0.000395245668
  error estimate for blocks of size 2^( 3) =       0.000404621473
  error estimate for blocks of size 2^( 4) =       0.000410695635
  error estimate for blocks of size 2^( 5) =       0.000413980516
  error estimate for blocks of size 2^( 6) =       0.000417561402
  error estimate for blocks of size 2^( 7) =       0.000419571246

      target function =                  N/A
              le_mean =     -17.216612406675
             les_mean =     296.723586418641
             stat err =       0.000415452200
             autocorr =       1.164441708710
              std dev =       0.544474048064
             le_variance =       0.296451989015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296575466972
                                         uncertainty =       0.001864189334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296575466972
                                         uncertainty =       0.001864189334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385018164
  error estimate for blocks of size 2^( 2) =       0.000395260493
  error estimate for blocks of size 2^( 3) =       0.000404634592
  error estimate for blocks of size 2^( 4) =       0.000410710195
  error estimate for blocks of size 2^( 5) =       0.000413994595
  error estimate for blocks of size 2^( 6) =       0.000417575712
  error estimate for blocks of size 2^( 7) =       0.000419585097

      target function =                  N/A
              le_mean =     -17.216612784448
             les_mean =     296.723530110882
             stat err =       0.000415466400
             autocorr =       1.164419249361
              std dev =       0.544497909325
             le_variance =       0.296477973260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296562434242
                                         uncertainty =       0.001864033828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296562434242
                                         uncertainty =       0.001864033828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385009700
  error estimate for blocks of size 2^( 2) =       0.000395253043
  error estimate for blocks of size 2^( 3) =       0.000404627984
  error estimate for blocks of size 2^( 4) =       0.000410702908
  error estimate for blocks of size 2^( 5) =       0.000413987539
  error estimate for blocks of size 2^( 6) =       0.000417568557
  error estimate for blocks of size 2^( 7) =       0.000419578150

      target function =                  N/A
              le_mean =     -17.216612563828
             les_mean =     296.723544731097
             stat err =       0.000415459289
             autocorr =       1.164430585003
              std dev =       0.544485939317
             le_variance =       0.296464938114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296551085418
                                         uncertainty =       0.001863888807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296551085418
                                         uncertainty =       0.001863888807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385002329
  error estimate for blocks of size 2^( 2) =       0.000395246576
  error estimate for blocks of size 2^( 3) =       0.000404622272
  error estimate for blocks of size 2^( 4) =       0.000410696531
  error estimate for blocks of size 2^( 5) =       0.000413981379
  error estimate for blocks of size 2^( 6) =       0.000417562283
  error estimate for blocks of size 2^( 7) =       0.000419572095

      target function =                  N/A
              le_mean =     -17.216612422329
             les_mean =     296.723579131874
             stat err =       0.000415453072
             autocorr =       1.164440321839
              std dev =       0.544475515174
             le_variance =       0.296453586624


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216612406675        initial
     6.1035e+00     6.1035e+01             2.3813e-04       -17.216612784448  <--
     2.4414e+01     2.4414e+02             5.9954e-05       -17.216612563828
     9.7656e+01     9.7656e+02             1.5015e-05       -17.216612422329

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9575e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.014656e-01 1 1  ON 0
  uu_1                 4.239559e-02 1 1  ON 1
  uu_2                -4.774037e-02 1 1  ON 2
  uu_3                -9.835737e-02 1 1  ON 3
  uu_4                -1.281526e-01 1 1  ON 4
  uu_5                -1.332816e-01 1 1  ON 5
  uu_6                -1.117606e-01 1 1  ON 6
  uu_7                -3.710022e-02 1 1  ON 7
  uu_8                 1.014027e-01 1 1  ON 8
  uu_9                 1.198774e-01 1 1  ON 9
  ud_0                 3.450979e-01 1 1  ON 10
  ud_1                 8.865994e-02 1 1  ON 11
  ud_2                -1.727756e-02 1 1  ON 12
  ud_3                -7.451646e-02 1 1  ON 13
  ud_4                -1.192648e-01 1 1  ON 14
  ud_5                -1.497948e-01 1 1  ON 15
  ud_6                -1.544395e-01 1 1  ON 16
  ud_7                -1.091175e-01 1 1  ON 17
  ud_8                 6.789747e-03 1 1  ON 18
  ud_9                 9.252691e-02 1 1  ON 19
  eO_0                -7.324429e-01 1 1  ON 20
  eO_1                -4.243954e-01 1 1  ON 21
  eO_2                -3.521535e-02 1 1  ON 22
  eO_3                 1.971291e-01 1 1  ON 23
  eO_4                 2.754695e-01 1 1  ON 24
  eO_5                 3.038370e-01 1 1  ON 25
  eO_6                 2.490331e-01 1 1  ON 26
  eO_7                 1.101977e-01 1 1  ON 27
  eO_8                 2.761979e-02 1 1  ON 28
  eO_9                 1.830028e-02 1 1  ON 29
 eH1_0                -1.809260e-01 1 1  ON 30
 eH1_1                -1.016643e-01 1 1  ON 31
 eH1_2                -6.232621e-02 1 1  ON 32
 eH1_3                -2.650867e-02 1 1  ON 33
 eH1_4                 2.003841e-02 1 1  ON 34
 eH1_5                 3.518354e-02 1 1  ON 35
 eH1_6                 7.676459e-02 1 1  ON 36
 eH1_7                 1.107073e-01 1 1  ON 37
 eH1_8                 8.964967e-02 1 1  ON 38
 eH1_9                 2.394883e-02 1 1  ON 39
 eH2_0                -1.819150e-01 1 1  ON 40
 eH2_1                -1.030517e-01 1 1  ON 41
 eH2_2                -6.385118e-02 1 1  ON 42
 eH2_3                -2.775378e-02 1 1  ON 43
 eH2_4                 1.850619e-02 1 1  ON 44
 eH2_5                 3.466231e-02 1 1  ON 45
 eH2_6                 7.837859e-02 1 1  ON 46
 eH2_7                 1.141662e-01 1 1  ON 47
 eH2_8                 9.282523e-02 1 1  ON 48
 eH2_9                 2.600505e-02 1 1  ON 49
ci_001                -4.202080e-02 3 1  ON 50
ci_002                -3.088636e-02 3 1  ON 51
ci_003                -2.630857e-02 3 1  ON 52
ci_004                 2.203002e-02 3 1  ON 53
ci_005                 2.241983e-02 3 1  ON 54
ci_006                -1.977345e-02 3 1  ON 55
ci_007                -1.974134e-02 3 1  ON 56
ci_008                -1.810419e-02 3 1  ON 57
ci_009                -1.784989e-02 3 1  ON 58
ci_010                -1.837771e-02 3 1  ON 59
ci_011                -1.640146e-02 3 1  ON 60
ci_012                -1.702695e-02 3 1  ON 61
ci_013                -1.969549e-02 3 1  ON 62
ci_014                 1.451647e-02 3 1  ON 63
ci_015                 1.427141e-02 3 1  ON 64
ci_016                 1.704687e-02 3 1  ON 65
ci_017                 1.683644e-02 3 1  ON 66
ci_018                 1.311043e-02 3 1  ON 67
ci_019                 1.320052e-02 3 1  ON 68
ci_020                 1.371325e-02 3 1  ON 69
ci_021                 1.429469e-02 3 1  ON 70
ci_022                 1.213628e-02 3 1  ON 71
ci_023                 1.178989e-02 3 1  ON 72
ci_024                 1.232519e-02 3 1  ON 73
ci_025                 1.312067e-02 3 1  ON 74
ci_026                 1.111836e-02 3 1  ON 75
ci_027                 1.161791e-02 3 1  ON 76
ci_028                -1.459146e-02 3 1  ON 77
ci_029                -1.438137e-02 3 1  ON 78
ci_030                -1.135694e-02 3 1  ON 79
ci_031                -1.166356e-02 3 1  ON 80
ci_032                -1.378641e-02 3 1  ON 81
ci_033                 1.077105e-02 3 1  ON 82
ci_034                 1.109977e-02 3 1  ON 83
ci_035                -5.236739e-03 3 1  ON 84
ci_036                -1.076742e-02 3 1  ON 85
ci_037                -1.057973e-02 3 1  ON 86
ci_038                 1.844836e-03 3 1  ON 87
ci_039                 2.307433e-03 3 1  ON 88
ci_040                -3.904312e-03 3 1  ON 89
ci_041                 1.028466e-02 3 1  ON 90
ci_042                 1.023227e-02 3 1  ON 91
ci_043                -3.764714e-03 3 1  ON 92
ci_044                -1.502358e-02 3 1  ON 93
ci_045                -2.256862e-03 3 1  ON 94
ci_046                 5.529211e-03 3 1  ON 95
ci_047                 6.492183e-03 3 1  ON 96
ci_048                -1.196983e-02 3 1  ON 97
ci_049                -1.186681e-02 3 1  ON 98
ci_050                 7.239651e-03 3 1  ON 99
ci_051                 7.778584e-03 3 1  ON 100
ci_052                -7.004733e-03 3 1  ON 101
ci_053                -6.581616e-03 3 1  ON 102
ci_054                -3.264643e-03 3 1  ON 103
ci_055                -3.499918e-03 3 1  ON 104
ci_056                 4.436624e-03 3 1  ON 105
ci_057                 4.774965e-03 3 1  ON 106
ci_058                -6.941779e-03 3 1  ON 107
ci_059                -6.505036e-03 3 1  ON 108
ci_060                 8.356798e-03 3 1  ON 109
ci_061                 8.485948e-03 3 1  ON 110
ci_062                -3.249486e-03 3 1  ON 111
ci_063                -3.607583e-03 3 1  ON 112
ci_064                -3.271881e-03 3 1  ON 113
ci_065                -4.173943e-03 3 1  ON 114
ci_066                 5.808880e-03 3 1  ON 115
ci_067                 5.682097e-03 3 1  ON 116
ci_068                -5.510423e-03 3 1  ON 117
ci_069                -4.896588e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2738
    reference variance = 0.180999
====================================================
  Execution time = 2.1092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0511e-01
  Total weights = 1.956544053e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293695108957
                                         uncertainty =       0.001534693992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293695108957
                                         uncertainty =       0.001534693992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383261657
  error estimate for blocks of size 2^( 2) =       0.000393873996
  error estimate for blocks of size 2^( 3) =       0.000403519264
  error estimate for blocks of size 2^( 4) =       0.000410941014
  error estimate for blocks of size 2^( 5) =       0.000415131788
  error estimate for blocks of size 2^( 6) =       0.000416401120
  error estimate for blocks of size 2^( 7) =       0.000415772541

      target function =                  N/A
              le_mean =     -17.215864074246
             les_mean =     296.691088732606
             stat err =       0.000414561616
             autocorr =       1.170004225722
              std dev =       0.542013833660
             le_variance =       0.293778995878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586407425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864074285       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215864537250       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215864933740       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215867812370       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215867393548       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215868876634       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215868203266       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215868154505       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215868079403       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215868132211       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215868132476       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+00 is 1.054392e-03

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864074285       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215864202011       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215864327377       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215865158492       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215865039144       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215865344557       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215865182951       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215865209747       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215865171882       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215865177601       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215865177722       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+00 is 2.717231e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215864074285       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215864107065       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215864140404       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215864355507       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215864324557       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215864397056       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215864357027       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215864366211       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215864356767       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215864357048       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215864357211       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+01 is 6.848061e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7145e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.015409e-01 1 1  ON 0
  uu_1                 4.244369e-02 1 1  ON 1
  uu_2                -4.775858e-02 1 1  ON 2
  uu_3                -9.839440e-02 1 1  ON 3
  uu_4                -1.281922e-01 1 1  ON 4
  uu_5                -1.333068e-01 1 1  ON 5
  uu_6                -1.117656e-01 1 1  ON 6
  uu_7                -3.711901e-02 1 1  ON 7
  uu_8                 1.013927e-01 1 1  ON 8
  uu_9                 1.198899e-01 1 1  ON 9
  ud_0                 3.451707e-01 1 1  ON 10
  ud_1                 8.871101e-02 1 1  ON 11
  ud_2                -1.730505e-02 1 1  ON 12
  ud_3                -7.455741e-02 1 1  ON 13
  ud_4                -1.193010e-01 1 1  ON 14
  ud_5                -1.498293e-01 1 1  ON 15
  ud_6                -1.544226e-01 1 1  ON 16
  ud_7                -1.091202e-01 1 1  ON 17
  ud_8                 6.769642e-03 1 1  ON 18
  ud_9                 9.253107e-02 1 1  ON 19
  eO_0                -7.327146e-01 1 1  ON 20
  eO_1                -4.245308e-01 1 1  ON 21
  eO_2                -3.515860e-02 1 1  ON 22
  eO_3                 1.973226e-01 1 1  ON 23
  eO_4                 2.755946e-01 1 1  ON 24
  eO_5                 3.038300e-01 1 1  ON 25
  eO_6                 2.490422e-01 1 1  ON 26
  eO_7                 1.102181e-01 1 1  ON 27
  eO_8                 2.762380e-02 1 1  ON 28
  eO_9                 1.830311e-02 1 1  ON 29
 eH1_0                -1.809467e-01 1 1  ON 30
 eH1_1                -1.016914e-01 1 1  ON 31
 eH1_2                -6.231952e-02 1 1  ON 32
 eH1_3                -2.649422e-02 1 1  ON 33
 eH1_4                 2.002619e-02 1 1  ON 34
 eH1_5                 3.520860e-02 1 1  ON 35
 eH1_6                 7.676692e-02 1 1  ON 36
 eH1_7                 1.107006e-01 1 1  ON 37
 eH1_8                 8.966022e-02 1 1  ON 38
 eH1_9                 2.395386e-02 1 1  ON 39
 eH2_0                -1.819431e-01 1 1  ON 40
 eH2_1                -1.030612e-01 1 1  ON 41
 eH2_2                -6.384765e-02 1 1  ON 42
 eH2_3                -2.773898e-02 1 1  ON 43
 eH2_4                 1.849461e-02 1 1  ON 44
 eH2_5                 3.466982e-02 1 1  ON 45
 eH2_6                 7.837979e-02 1 1  ON 46
 eH2_7                 1.141673e-01 1 1  ON 47
 eH2_8                 9.283900e-02 1 1  ON 48
 eH2_9                 2.600944e-02 1 1  ON 49
ci_001                -4.199642e-02 3 1  ON 50
ci_002                -3.087067e-02 3 1  ON 51
ci_003                -2.629921e-02 3 1  ON 52
ci_004                 2.199857e-02 3 1  ON 53
ci_005                 2.239397e-02 3 1  ON 54
ci_006                -1.974503e-02 3 1  ON 55
ci_007                -1.971152e-02 3 1  ON 56
ci_008                -1.807413e-02 3 1  ON 57
ci_009                -1.783777e-02 3 1  ON 58
ci_010                -1.834767e-02 3 1  ON 59
ci_011                -1.638671e-02 3 1  ON 60
ci_012                -1.699646e-02 3 1  ON 61
ci_013                -1.968052e-02 3 1  ON 62
ci_014                 1.449923e-02 3 1  ON 63
ci_015                 1.421895e-02 3 1  ON 64
ci_016                 1.703411e-02 3 1  ON 65
ci_017                 1.683316e-02 3 1  ON 66
ci_018                 1.308332e-02 3 1  ON 67
ci_019                 1.318269e-02 3 1  ON 68
ci_020                 1.371704e-02 3 1  ON 69
ci_021                 1.425347e-02 3 1  ON 70
ci_022                 1.214649e-02 3 1  ON 71
ci_023                 1.178250e-02 3 1  ON 72
ci_024                 1.233213e-02 3 1  ON 73
ci_025                 1.313314e-02 3 1  ON 74
ci_026                 1.110907e-02 3 1  ON 75
ci_027                 1.160146e-02 3 1  ON 76
ci_028                -1.457174e-02 3 1  ON 77
ci_029                -1.434695e-02 3 1  ON 78
ci_030                -1.132273e-02 3 1  ON 79
ci_031                -1.164020e-02 3 1  ON 80
ci_032                -1.380668e-02 3 1  ON 81
ci_033                 1.072314e-02 3 1  ON 82
ci_034                 1.107505e-02 3 1  ON 83
ci_035                -5.199489e-03 3 1  ON 84
ci_036                -1.075612e-02 3 1  ON 85
ci_037                -1.059674e-02 3 1  ON 86
ci_038                 1.852763e-03 3 1  ON 87
ci_039                 2.292917e-03 3 1  ON 88
ci_040                -3.912490e-03 3 1  ON 89
ci_041                 1.027507e-02 3 1  ON 90
ci_042                 1.021691e-02 3 1  ON 91
ci_043                -3.728151e-03 3 1  ON 92
ci_044                -1.504130e-02 3 1  ON 93
ci_045                -2.228606e-03 3 1  ON 94
ci_046                 5.546610e-03 3 1  ON 95
ci_047                 6.463460e-03 3 1  ON 96
ci_048                -1.191916e-02 3 1  ON 97
ci_049                -1.185226e-02 3 1  ON 98
ci_050                 7.272143e-03 3 1  ON 99
ci_051                 7.790859e-03 3 1  ON 100
ci_052                -6.972342e-03 3 1  ON 101
ci_053                -6.586881e-03 3 1  ON 102
ci_054                -3.242415e-03 3 1  ON 103
ci_055                -3.472375e-03 3 1  ON 104
ci_056                 4.424024e-03 3 1  ON 105
ci_057                 4.738486e-03 3 1  ON 106
ci_058                -6.906763e-03 3 1  ON 107
ci_059                -6.478669e-03 3 1  ON 108
ci_060                 8.373491e-03 3 1  ON 109
ci_061                 8.464186e-03 3 1  ON 110
ci_062                -3.215969e-03 3 1  ON 111
ci_063                -3.587604e-03 3 1  ON 112
ci_064                -3.271782e-03 3 1  ON 113
ci_065                -4.172435e-03 3 1  ON 114
ci_066                 5.808095e-03 3 1  ON 115
ci_067                 5.671440e-03 3 1  ON 116
ci_068                -5.486285e-03 3 1  ON 117
ci_069                -4.905753e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.212692
====================================================
  Execution time = 2.0850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1005e-01
  Total weights = 1.9564e+06
  Execution time = 1.8153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297039254030
                                         uncertainty =       0.002432679953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297039254030
                                         uncertainty =       0.002432679953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385341120
  error estimate for blocks of size 2^( 2) =       0.000395408804
  error estimate for blocks of size 2^( 3) =       0.000404367260
  error estimate for blocks of size 2^( 4) =       0.000411193693
  error estimate for blocks of size 2^( 5) =       0.000416340404
  error estimate for blocks of size 2^( 6) =       0.000419258535
  error estimate for blocks of size 2^( 7) =       0.000419270020

      target function =                  N/A
              le_mean =     -17.216268129077
             les_mean =     296.709912685536
             stat err =       0.000416515663
             autocorr =       1.168347310835
              std dev =       0.544954638579
             le_variance =       0.296975558109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064250367
                                         uncertainty =       0.002423322974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064250367
                                         uncertainty =       0.002423322974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385357221
  error estimate for blocks of size 2^( 2) =       0.000395424447
  error estimate for blocks of size 2^( 3) =       0.000404381790
  error estimate for blocks of size 2^( 4) =       0.000411213364
  error estimate for blocks of size 2^( 5) =       0.000416358482
  error estimate for blocks of size 2^( 6) =       0.000419280336
  error estimate for blocks of size 2^( 7) =       0.000419307208

      target function =                  N/A
              le_mean =     -17.216269464703
             les_mean =     296.710214464636
             stat err =       0.000416539847
             autocorr =       1.168385352184
              std dev =       0.544977408801
             le_variance =       0.297000376103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297042194018
                                         uncertainty =       0.002427462506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297042194018
                                         uncertainty =       0.002427462506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385342969
  error estimate for blocks of size 2^( 2) =       0.000395410717
  error estimate for blocks of size 2^( 3) =       0.000404368874
  error estimate for blocks of size 2^( 4) =       0.000411198435
  error estimate for blocks of size 2^( 5) =       0.000416344329
  error estimate for blocks of size 2^( 6) =       0.000419264908
  error estimate for blocks of size 2^( 7) =       0.000419284509

      target function =                  N/A
              le_mean =     -17.216268482167
             les_mean =     296.710015566090
             stat err =       0.000416523045
             autocorr =       1.168377519706
              std dev =       0.544957252229
             le_variance =       0.296978406757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297038941928
                                         uncertainty =       0.002432004073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297038941928
                                         uncertainty =       0.002432004073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385340911
  error estimate for blocks of size 2^( 2) =       0.000395408613
  error estimate for blocks of size 2^( 3) =       0.000404367040
  error estimate for blocks of size 2^( 4) =       0.000411193885
  error estimate for blocks of size 2^( 5) =       0.000416340494
  error estimate for blocks of size 2^( 6) =       0.000419258943
  error estimate for blocks of size 2^( 7) =       0.000419271450

      target function =                  N/A
              le_mean =     -17.216268125859
             les_mean =     296.709907079281
             stat err =       0.000416516193
             autocorr =       1.168351557589
              std dev =       0.544954341846
             le_variance =       0.296975234697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216268129077        initial
     1.5259e+00     1.5259e+01             1.0544e-03       -17.216269464703  <--
     6.1035e+00     6.1035e+01             2.7172e-04       -17.216268482167
     2.4414e+01     2.4414e+02             6.8481e-05       -17.216268125859

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.0058e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.017622e-01 1 1  ON 0
  uu_1                 4.257286e-02 1 1  ON 1
  uu_2                -4.779864e-02 1 1  ON 2
  uu_3                -9.850254e-02 1 1  ON 3
  uu_4                -1.283098e-01 1 1  ON 4
  uu_5                -1.333818e-01 1 1  ON 5
  uu_6                -1.117811e-01 1 1  ON 6
  uu_7                -3.717463e-02 1 1  ON 7
  uu_8                 1.013629e-01 1 1  ON 8
  uu_9                 1.199270e-01 1 1  ON 9
  ud_0                 3.453810e-01 1 1  ON 10
  ud_1                 8.884425e-02 1 1  ON 11
  ud_2                -1.736759e-02 1 1  ON 12
  ud_3                -7.467546e-02 1 1  ON 13
  ud_4                -1.194073e-01 1 1  ON 14
  ud_5                -1.499274e-01 1 1  ON 15
  ud_6                -1.543759e-01 1 1  ON 16
  ud_7                -1.091287e-01 1 1  ON 17
  ud_8                 6.709913e-03 1 1  ON 18
  ud_9                 9.254347e-02 1 1  ON 19
  eO_0                -7.334972e-01 1 1  ON 20
  eO_1                -4.249248e-01 1 1  ON 21
  eO_2                -3.501817e-02 1 1  ON 22
  eO_3                 1.978824e-01 1 1  ON 23
  eO_4                 2.759736e-01 1 1  ON 24
  eO_5                 3.038119e-01 1 1  ON 25
  eO_6                 2.490695e-01 1 1  ON 26
  eO_7                 1.102788e-01 1 1  ON 27
  eO_8                 2.763578e-02 1 1  ON 28
  eO_9                 1.831154e-02 1 1  ON 29
 eH1_0                -1.810076e-01 1 1  ON 30
 eH1_1                -1.017665e-01 1 1  ON 31
 eH1_2                -6.230274e-02 1 1  ON 32
 eH1_3                -2.645480e-02 1 1  ON 33
 eH1_4                 1.999086e-02 1 1  ON 34
 eH1_5                 3.528089e-02 1 1  ON 35
 eH1_6                 7.677516e-02 1 1  ON 36
 eH1_7                 1.106807e-01 1 1  ON 37
 eH1_8                 8.969165e-02 1 1  ON 38
 eH1_9                 2.396885e-02 1 1  ON 39
 eH2_0                -1.820227e-01 1 1  ON 40
 eH2_1                -1.030915e-01 1 1  ON 41
 eH2_2                -6.383735e-02 1 1  ON 42
 eH2_3                -2.769877e-02 1 1  ON 43
 eH2_4                 1.846106e-02 1 1  ON 44
 eH2_5                 3.469155e-02 1 1  ON 45
 eH2_6                 7.838458e-02 1 1  ON 46
 eH2_7                 1.141708e-01 1 1  ON 47
 eH2_8                 9.288007e-02 1 1  ON 48
 eH2_9                 2.602253e-02 1 1  ON 49
ci_001                -4.193052e-02 3 1  ON 50
ci_002                -3.082975e-02 3 1  ON 51
ci_003                -2.627518e-02 3 1  ON 52
ci_004                 2.191405e-02 3 1  ON 53
ci_005                 2.232438e-02 3 1  ON 54
ci_006                -1.967049e-02 3 1  ON 55
ci_007                -1.963319e-02 3 1  ON 56
ci_008                -1.799811e-02 3 1  ON 57
ci_009                -1.780569e-02 3 1  ON 58
ci_010                -1.826499e-02 3 1  ON 59
ci_011                -1.634837e-02 3 1  ON 60
ci_012                -1.691704e-02 3 1  ON 61
ci_013                -1.963957e-02 3 1  ON 62
ci_014                 1.445430e-02 3 1  ON 63
ci_015                 1.408252e-02 3 1  ON 64
ci_016                 1.700143e-02 3 1  ON 65
ci_017                 1.682583e-02 3 1  ON 66
ci_018                 1.301330e-02 3 1  ON 67
ci_019                 1.313675e-02 3 1  ON 68
ci_020                 1.372830e-02 3 1  ON 69
ci_021                 1.414346e-02 3 1  ON 70
ci_022                 1.217263e-02 3 1  ON 71
ci_023                 1.176343e-02 3 1  ON 72
ci_024                 1.235034e-02 3 1  ON 73
ci_025                 1.316576e-02 3 1  ON 74
ci_026                 1.108537e-02 3 1  ON 75
ci_027                 1.155846e-02 3 1  ON 76
ci_028                -1.451930e-02 3 1  ON 77
ci_029                -1.425563e-02 3 1  ON 78
ci_030                -1.123317e-02 3 1  ON 79
ci_031                -1.157874e-02 3 1  ON 80
ci_032                -1.385721e-02 3 1  ON 81
ci_033                 1.059879e-02 3 1  ON 82
ci_034                 1.101087e-02 3 1  ON 83
ci_035                -5.107990e-03 3 1  ON 84
ci_036                -1.072646e-02 3 1  ON 85
ci_037                -1.064149e-02 3 1  ON 86
ci_038                 1.868065e-03 3 1  ON 87
ci_039                 2.255454e-03 3 1  ON 88
ci_040                -3.929672e-03 3 1  ON 89
ci_041                 1.025054e-02 3 1  ON 90
ci_042                 1.017725e-02 3 1  ON 91
ci_043                -3.637854e-03 3 1  ON 92
ci_044                -1.509077e-02 3 1  ON 93
ci_045                -2.159569e-03 3 1  ON 94
ci_046                 5.590179e-03 3 1  ON 95
ci_047                 6.388196e-03 3 1  ON 96
ci_048                -1.178248e-02 3 1  ON 97
ci_049                -1.181489e-02 3 1  ON 98
ci_050                 7.351831e-03 3 1  ON 99
ci_051                 7.820589e-03 3 1  ON 100
ci_052                -6.891205e-03 3 1  ON 101
ci_053                -6.599841e-03 3 1  ON 102
ci_054                -3.184768e-03 3 1  ON 103
ci_055                -3.401689e-03 3 1  ON 104
ci_056                 4.392422e-03 3 1  ON 105
ci_057                 4.647468e-03 3 1  ON 106
ci_058                -6.817891e-03 3 1  ON 107
ci_059                -6.411420e-03 3 1  ON 108
ci_060                 8.416386e-03 3 1  ON 109
ci_061                 8.407531e-03 3 1  ON 110
ci_062                -3.129874e-03 3 1  ON 111
ci_063                -3.535733e-03 3 1  ON 112
ci_064                -3.270292e-03 3 1  ON 113
ci_065                -4.168666e-03 3 1  ON 114
ci_066                 5.805516e-03 3 1  ON 115
ci_067                 5.644962e-03 3 1  ON 116
ci_068                -5.423822e-03 3 1  ON 117
ci_069                -4.929084e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.15957
====================================================
  Execution time = 2.1003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0660e-01
  Total weights = 1.956187268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292534681799
                                         uncertainty =       0.001443048811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292534681799
                                         uncertainty =       0.001443048811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382514406
  error estimate for blocks of size 2^( 2) =       0.000392680662
  error estimate for blocks of size 2^( 3) =       0.000401935858
  error estimate for blocks of size 2^( 4) =       0.000408518326
  error estimate for blocks of size 2^( 5) =       0.000413509091
  error estimate for blocks of size 2^( 6) =       0.000416632346
  error estimate for blocks of size 2^( 7) =       0.000417041013

      target function =                  N/A
              le_mean =     -17.217484117063
             les_mean =     296.748358067926
             stat err =       0.000413925194
             autocorr =       1.170976364864
              std dev =       0.540957061342
             le_variance =       0.292634542216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721748411706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217484117110       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217498488764       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217495808067       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217494398554       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217506526815       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217504638706       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217506308720       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217507497089       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217507628977       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217507342171       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217507104845       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217506643338       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217506566960       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e-01 is 3.628702e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217484117110       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217489275604       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217488467389       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217487202014       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217490783482       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217490828893       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217490979477       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217491167122       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217491303705       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217491313857       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217491222272       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+00 is 1.015299e-03

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217484117110       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217485564393       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217485352020       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217484959913       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217485877786       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217485966124       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217485966010       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217485992712       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217486038180       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217486047772       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+00 is 2.629226e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7069e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.019767e-01 1 1  ON 0
  uu_1                 4.274095e-02 1 1  ON 1
  uu_2                -4.779964e-02 1 1  ON 2
  uu_3                -9.862266e-02 1 1  ON 3
  uu_4                -1.284206e-01 1 1  ON 4
  uu_5                -1.334548e-01 1 1  ON 5
  uu_6                -1.118033e-01 1 1  ON 6
  uu_7                -3.728953e-02 1 1  ON 7
  uu_8                 1.013178e-01 1 1  ON 8
  uu_9                 1.199725e-01 1 1  ON 9
  ud_0                 3.455903e-01 1 1  ON 10
  ud_1                 8.898236e-02 1 1  ON 11
  ud_2                -1.731946e-02 1 1  ON 12
  ud_3                -7.479215e-02 1 1  ON 13
  ud_4                -1.195857e-01 1 1  ON 14
  ud_5                -1.500510e-01 1 1  ON 15
  ud_6                -1.542991e-01 1 1  ON 16
  ud_7                -1.091660e-01 1 1  ON 17
  ud_8                 6.637263e-03 1 1  ON 18
  ud_9                 9.255270e-02 1 1  ON 19
  eO_0                -7.345125e-01 1 1  ON 20
  eO_1                -4.254018e-01 1 1  ON 21
  eO_2                -3.489443e-02 1 1  ON 22
  eO_3                 1.985472e-01 1 1  ON 23
  eO_4                 2.765395e-01 1 1  ON 24
  eO_5                 3.038191e-01 1 1  ON 25
  eO_6                 2.490942e-01 1 1  ON 26
  eO_7                 1.103530e-01 1 1  ON 27
  eO_8                 2.765400e-02 1 1  ON 28
  eO_9                 1.831878e-02 1 1  ON 29
 eH1_0                -1.811062e-01 1 1  ON 30
 eH1_1                -1.018191e-01 1 1  ON 31
 eH1_2                -6.229577e-02 1 1  ON 32
 eH1_3                -2.639519e-02 1 1  ON 33
 eH1_4                 1.994502e-02 1 1  ON 34
 eH1_5                 3.534539e-02 1 1  ON 35
 eH1_6                 7.680492e-02 1 1  ON 36
 eH1_7                 1.106556e-01 1 1  ON 37
 eH1_8                 8.972871e-02 1 1  ON 38
 eH1_9                 2.398610e-02 1 1  ON 39
 eH2_0                -1.821412e-01 1 1  ON 40
 eH2_1                -1.030904e-01 1 1  ON 41
 eH2_2                -6.382918e-02 1 1  ON 42
 eH2_3                -2.764527e-02 1 1  ON 43
 eH2_4                 1.838391e-02 1 1  ON 44
 eH2_5                 3.478127e-02 1 1  ON 45
 eH2_6                 7.839572e-02 1 1  ON 46
 eH2_7                 1.141443e-01 1 1  ON 47
 eH2_8                 9.291894e-02 1 1  ON 48
 eH2_9                 2.603566e-02 1 1  ON 49
ci_001                -4.174976e-02 3 1  ON 50
ci_002                -3.086847e-02 3 1  ON 51
ci_003                -2.627536e-02 3 1  ON 52
ci_004                 2.183058e-02 3 1  ON 53
ci_005                 2.230692e-02 3 1  ON 54
ci_006                -1.959324e-02 3 1  ON 55
ci_007                -1.957457e-02 3 1  ON 56
ci_008                -1.810053e-02 3 1  ON 57
ci_009                -1.778708e-02 3 1  ON 58
ci_010                -1.818594e-02 3 1  ON 59
ci_011                -1.622117e-02 3 1  ON 60
ci_012                -1.674071e-02 3 1  ON 61
ci_013                -1.959530e-02 3 1  ON 62
ci_014                 1.437746e-02 3 1  ON 63
ci_015                 1.396772e-02 3 1  ON 64
ci_016                 1.696823e-02 3 1  ON 65
ci_017                 1.667408e-02 3 1  ON 66
ci_018                 1.293804e-02 3 1  ON 67
ci_019                 1.309080e-02 3 1  ON 68
ci_020                 1.366257e-02 3 1  ON 69
ci_021                 1.401051e-02 3 1  ON 70
ci_022                 1.201155e-02 3 1  ON 71
ci_023                 1.171348e-02 3 1  ON 72
ci_024                 1.235984e-02 3 1  ON 73
ci_025                 1.291659e-02 3 1  ON 74
ci_026                 1.105109e-02 3 1  ON 75
ci_027                 1.167230e-02 3 1  ON 76
ci_028                -1.457221e-02 3 1  ON 77
ci_029                -1.424078e-02 3 1  ON 78
ci_030                -1.123474e-02 3 1  ON 79
ci_031                -1.153153e-02 3 1  ON 80
ci_032                -1.384497e-02 3 1  ON 81
ci_033                 1.050901e-02 3 1  ON 82
ci_034                 1.083196e-02 3 1  ON 83
ci_035                -4.998640e-03 3 1  ON 84
ci_036                -1.070956e-02 3 1  ON 85
ci_037                -1.051181e-02 3 1  ON 86
ci_038                 1.826132e-03 3 1  ON 87
ci_039                 2.149086e-03 3 1  ON 88
ci_040                -3.979267e-03 3 1  ON 89
ci_041                 1.021873e-02 3 1  ON 90
ci_042                 1.003751e-02 3 1  ON 91
ci_043                -3.523020e-03 3 1  ON 92
ci_044                -1.506108e-02 3 1  ON 93
ci_045                -2.094704e-03 3 1  ON 94
ci_046                 5.559645e-03 3 1  ON 95
ci_047                 6.333784e-03 3 1  ON 96
ci_048                -1.173307e-02 3 1  ON 97
ci_049                -1.172796e-02 3 1  ON 98
ci_050                 7.347496e-03 3 1  ON 99
ci_051                 7.941020e-03 3 1  ON 100
ci_052                -6.797122e-03 3 1  ON 101
ci_053                -6.598530e-03 3 1  ON 102
ci_054                -3.139347e-03 3 1  ON 103
ci_055                -3.308118e-03 3 1  ON 104
ci_056                 4.539043e-03 3 1  ON 105
ci_057                 4.794170e-03 3 1  ON 106
ci_058                -6.826781e-03 3 1  ON 107
ci_059                -6.402897e-03 3 1  ON 108
ci_060                 8.513897e-03 3 1  ON 109
ci_061                 8.358114e-03 3 1  ON 110
ci_062                -3.241507e-03 3 1  ON 111
ci_063                -3.422498e-03 3 1  ON 112
ci_064                -3.253110e-03 3 1  ON 113
ci_065                -4.278261e-03 3 1  ON 114
ci_066                 5.677134e-03 3 1  ON 115
ci_067                 5.704649e-03 3 1  ON 116
ci_068                -5.352345e-03 3 1  ON 117
ci_069                -4.824323e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2904
    reference variance = 0.597601
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1112e-01
  Total weights = 1.9566e+06
  Execution time = 1.8289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296620569463
                                         uncertainty =       0.001799119784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296620569463
                                         uncertainty =       0.001799119784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385141120
  error estimate for blocks of size 2^( 2) =       0.000395302474
  error estimate for blocks of size 2^( 3) =       0.000404433635
  error estimate for blocks of size 2^( 4) =       0.000410461599
  error estimate for blocks of size 2^( 5) =       0.000415931608
  error estimate for blocks of size 2^( 6) =       0.000419260411
  error estimate for blocks of size 2^( 7) =       0.000421360758

      target function =                  N/A
              le_mean =     -17.216379109631
             les_mean =     296.715997174152
             stat err =       0.000416753594
             autocorr =       1.170897638262
              std dev =       0.544671794880
             le_variance =       0.296667364137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296976253221
                                         uncertainty =       0.001812655900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296976253221
                                         uncertainty =       0.001812655900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385372434
  error estimate for blocks of size 2^( 2) =       0.000395523136
  error estimate for blocks of size 2^( 3) =       0.000404672289
  error estimate for blocks of size 2^( 4) =       0.000410707145
  error estimate for blocks of size 2^( 5) =       0.000416187709
  error estimate for blocks of size 2^( 6) =       0.000419514814
  error estimate for blocks of size 2^( 7) =       0.000421637050

      target function =                  N/A
              le_mean =     -17.216376510689
             les_mean =     296.715156756116
             stat err =       0.000417011680
             autocorr =       1.170941357371
              std dev =       0.544998922772
             le_variance =       0.297023825823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784127707
                                         uncertainty =       0.001808088705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784127707
                                         uncertainty =       0.001808088705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385247569
  error estimate for blocks of size 2^( 2) =       0.000395405222
  error estimate for blocks of size 2^( 3) =       0.000404553107
  error estimate for blocks of size 2^( 4) =       0.000410588739
  error estimate for blocks of size 2^( 5) =       0.000416068153
  error estimate for blocks of size 2^( 6) =       0.000419397538
  error estimate for blocks of size 2^( 7) =       0.000421512549

      target function =                  N/A
              le_mean =     -17.216375625810
             les_mean =     296.714831520488
             stat err =       0.000416891745
             autocorr =       1.171026646480
              std dev =       0.544822336802
             le_variance =       0.296831378678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296634859440
                                         uncertainty =       0.001800308626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296634859440
                                         uncertainty =       0.001800308626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385150434
  error estimate for blocks of size 2^( 2) =       0.000395310663
  error estimate for blocks of size 2^( 3) =       0.000404443740
  error estimate for blocks of size 2^( 4) =       0.000410472797
  error estimate for blocks of size 2^( 5) =       0.000415943275
  error estimate for blocks of size 2^( 6) =       0.000419275008
  error estimate for blocks of size 2^( 7) =       0.000421375416

      target function =                  N/A
              le_mean =     -17.216377449894
             les_mean =     296.742223534149
             stat err =       0.000416766624
             autocorr =       1.170914223716
              std dev =       0.544684966902
             le_variance =       0.296681713169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216379109631        initial  <--
     3.8147e-01     3.8147e+00             3.6287e-03       -17.216376510689
     1.5259e+00     1.5259e+01             1.0153e-03       -17.216375625810
     6.1035e+00     6.1035e+01             2.6292e-04       -17.216377449894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5572
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.017622e-01 1 1  ON 0
  uu_1                 4.257286e-02 1 1  ON 1
  uu_2                -4.779864e-02 1 1  ON 2
  uu_3                -9.850254e-02 1 1  ON 3
  uu_4                -1.283098e-01 1 1  ON 4
  uu_5                -1.333818e-01 1 1  ON 5
  uu_6                -1.117811e-01 1 1  ON 6
  uu_7                -3.717463e-02 1 1  ON 7
  uu_8                 1.013629e-01 1 1  ON 8
  uu_9                 1.199270e-01 1 1  ON 9
  ud_0                 3.453810e-01 1 1  ON 10
  ud_1                 8.884425e-02 1 1  ON 11
  ud_2                -1.736759e-02 1 1  ON 12
  ud_3                -7.467546e-02 1 1  ON 13
  ud_4                -1.194073e-01 1 1  ON 14
  ud_5                -1.499274e-01 1 1  ON 15
  ud_6                -1.543759e-01 1 1  ON 16
  ud_7                -1.091287e-01 1 1  ON 17
  ud_8                 6.709913e-03 1 1  ON 18
  ud_9                 9.254347e-02 1 1  ON 19
  eO_0                -7.334972e-01 1 1  ON 20
  eO_1                -4.249248e-01 1 1  ON 21
  eO_2                -3.501817e-02 1 1  ON 22
  eO_3                 1.978824e-01 1 1  ON 23
  eO_4                 2.759736e-01 1 1  ON 24
  eO_5                 3.038119e-01 1 1  ON 25
  eO_6                 2.490695e-01 1 1  ON 26
  eO_7                 1.102788e-01 1 1  ON 27
  eO_8                 2.763578e-02 1 1  ON 28
  eO_9                 1.831154e-02 1 1  ON 29
 eH1_0                -1.810076e-01 1 1  ON 30
 eH1_1                -1.017665e-01 1 1  ON 31
 eH1_2                -6.230274e-02 1 1  ON 32
 eH1_3                -2.645480e-02 1 1  ON 33
 eH1_4                 1.999086e-02 1 1  ON 34
 eH1_5                 3.528089e-02 1 1  ON 35
 eH1_6                 7.677516e-02 1 1  ON 36
 eH1_7                 1.106807e-01 1 1  ON 37
 eH1_8                 8.969165e-02 1 1  ON 38
 eH1_9                 2.396885e-02 1 1  ON 39
 eH2_0                -1.820227e-01 1 1  ON 40
 eH2_1                -1.030915e-01 1 1  ON 41
 eH2_2                -6.383735e-02 1 1  ON 42
 eH2_3                -2.769877e-02 1 1  ON 43
 eH2_4                 1.846106e-02 1 1  ON 44
 eH2_5                 3.469155e-02 1 1  ON 45
 eH2_6                 7.838458e-02 1 1  ON 46
 eH2_7                 1.141708e-01 1 1  ON 47
 eH2_8                 9.288007e-02 1 1  ON 48
 eH2_9                 2.602253e-02 1 1  ON 49
ci_001                -4.193052e-02 3 1  ON 50
ci_002                -3.082975e-02 3 1  ON 51
ci_003                -2.627518e-02 3 1  ON 52
ci_004                 2.191405e-02 3 1  ON 53
ci_005                 2.232438e-02 3 1  ON 54
ci_006                -1.967049e-02 3 1  ON 55
ci_007                -1.963319e-02 3 1  ON 56
ci_008                -1.799811e-02 3 1  ON 57
ci_009                -1.780569e-02 3 1  ON 58
ci_010                -1.826499e-02 3 1  ON 59
ci_011                -1.634837e-02 3 1  ON 60
ci_012                -1.691704e-02 3 1  ON 61
ci_013                -1.963957e-02 3 1  ON 62
ci_014                 1.445430e-02 3 1  ON 63
ci_015                 1.408252e-02 3 1  ON 64
ci_016                 1.700143e-02 3 1  ON 65
ci_017                 1.682583e-02 3 1  ON 66
ci_018                 1.301330e-02 3 1  ON 67
ci_019                 1.313675e-02 3 1  ON 68
ci_020                 1.372830e-02 3 1  ON 69
ci_021                 1.414346e-02 3 1  ON 70
ci_022                 1.217263e-02 3 1  ON 71
ci_023                 1.176343e-02 3 1  ON 72
ci_024                 1.235034e-02 3 1  ON 73
ci_025                 1.316576e-02 3 1  ON 74
ci_026                 1.108537e-02 3 1  ON 75
ci_027                 1.155846e-02 3 1  ON 76
ci_028                -1.451930e-02 3 1  ON 77
ci_029                -1.425563e-02 3 1  ON 78
ci_030                -1.123317e-02 3 1  ON 79
ci_031                -1.157874e-02 3 1  ON 80
ci_032                -1.385721e-02 3 1  ON 81
ci_033                 1.059879e-02 3 1  ON 82
ci_034                 1.101087e-02 3 1  ON 83
ci_035                -5.107990e-03 3 1  ON 84
ci_036                -1.072646e-02 3 1  ON 85
ci_037                -1.064149e-02 3 1  ON 86
ci_038                 1.868065e-03 3 1  ON 87
ci_039                 2.255454e-03 3 1  ON 88
ci_040                -3.929672e-03 3 1  ON 89
ci_041                 1.025054e-02 3 1  ON 90
ci_042                 1.017725e-02 3 1  ON 91
ci_043                -3.637854e-03 3 1  ON 92
ci_044                -1.509077e-02 3 1  ON 93
ci_045                -2.159569e-03 3 1  ON 94
ci_046                 5.590179e-03 3 1  ON 95
ci_047                 6.388196e-03 3 1  ON 96
ci_048                -1.178248e-02 3 1  ON 97
ci_049                -1.181489e-02 3 1  ON 98
ci_050                 7.351831e-03 3 1  ON 99
ci_051                 7.820589e-03 3 1  ON 100
ci_052                -6.891205e-03 3 1  ON 101
ci_053                -6.599841e-03 3 1  ON 102
ci_054                -3.184768e-03 3 1  ON 103
ci_055                -3.401689e-03 3 1  ON 104
ci_056                 4.392422e-03 3 1  ON 105
ci_057                 4.647468e-03 3 1  ON 106
ci_058                -6.817891e-03 3 1  ON 107
ci_059                -6.411420e-03 3 1  ON 108
ci_060                 8.416386e-03 3 1  ON 109
ci_061                 8.407531e-03 3 1  ON 110
ci_062                -3.129874e-03 3 1  ON 111
ci_063                -3.535733e-03 3 1  ON 112
ci_064                -3.270292e-03 3 1  ON 113
ci_065                -4.168666e-03 3 1  ON 114
ci_066                 5.805516e-03 3 1  ON 115
ci_067                 5.644962e-03 3 1  ON 116
ci_068                -5.423822e-03 3 1  ON 117
ci_069                -4.929084e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2199
    reference variance = 0.211077
====================================================
  Execution time = 2.0787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1543e-01
  Total weights = 1.956287708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301174709225
                                         uncertainty =       0.002684764397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301174709225
                                         uncertainty =       0.002684764397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388014632
  error estimate for blocks of size 2^( 2) =       0.000398164398
  error estimate for blocks of size 2^( 3) =       0.000406863356
  error estimate for blocks of size 2^( 4) =       0.000414007506
  error estimate for blocks of size 2^( 5) =       0.000417774928
  error estimate for blocks of size 2^( 6) =       0.000419282004
  error estimate for blocks of size 2^( 7) =       0.000419645442

      target function =                  N/A
              le_mean =     -17.216092520637
             les_mean =     296.709270411116
             stat err =       0.000417677470
             autocorr =       1.158739716192
              std dev =       0.548735554743
             le_variance =       0.301110709040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609252064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092520657       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216093589871       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216093598503       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216093836283       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216094432841       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216094564677       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216094522730       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216094484165       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216094445995       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216094456042       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216094456204       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+00 is 4.095578e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092520657       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216092800070       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216092801193       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216092849074       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216092996955       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216093039629       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216093032350       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216093022641       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216093010109       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216093012141       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216093012717       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+01 is 1.037564e-04

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216092520657       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216092591311       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216092591522       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216092602711       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216092639508       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216092650818       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216092649286       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216092646862       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216092643550       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216092643991       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216092644177       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+01 is 2.602784e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6844e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.017834e-01 1 1  ON 0
  uu_1                 4.258489e-02 1 1  ON 1
  uu_2                -4.780050e-02 1 1  ON 2
  uu_3                -9.850670e-02 1 1  ON 3
  uu_4                -1.283210e-01 1 1  ON 4
  uu_5                -1.333917e-01 1 1  ON 5
  uu_6                -1.117819e-01 1 1  ON 6
  uu_7                -3.718249e-02 1 1  ON 7
  uu_8                 1.013579e-01 1 1  ON 8
  uu_9                 1.199309e-01 1 1  ON 9
  ud_0                 3.454097e-01 1 1  ON 10
  ud_1                 8.886460e-02 1 1  ON 11
  ud_2                -1.737194e-02 1 1  ON 12
  ud_3                -7.469459e-02 1 1  ON 13
  ud_4                -1.194259e-01 1 1  ON 14
  ud_5                -1.499343e-01 1 1  ON 15
  ud_6                -1.543690e-01 1 1  ON 16
  ud_7                -1.091312e-01 1 1  ON 17
  ud_8                 6.703605e-03 1 1  ON 18
  ud_9                 9.254319e-02 1 1  ON 19
  eO_0                -7.336010e-01 1 1  ON 20
  eO_1                -4.249743e-01 1 1  ON 21
  eO_2                -3.500317e-02 1 1  ON 22
  eO_3                 1.979479e-01 1 1  ON 23
  eO_4                 2.760286e-01 1 1  ON 24
  eO_5                 3.038142e-01 1 1  ON 25
  eO_6                 2.490744e-01 1 1  ON 26
  eO_7                 1.102874e-01 1 1  ON 27
  eO_8                 2.763744e-02 1 1  ON 28
  eO_9                 1.831182e-02 1 1  ON 29
 eH1_0                -1.810110e-01 1 1  ON 30
 eH1_1                -1.017727e-01 1 1  ON 31
 eH1_2                -6.229922e-02 1 1  ON 32
 eH1_3                -2.645071e-02 1 1  ON 33
 eH1_4                 1.998579e-02 1 1  ON 34
 eH1_5                 3.528354e-02 1 1  ON 35
 eH1_6                 7.677596e-02 1 1  ON 36
 eH1_7                 1.106783e-01 1 1  ON 37
 eH1_8                 8.969573e-02 1 1  ON 38
 eH1_9                 2.397051e-02 1 1  ON 39
 eH2_0                -1.820335e-01 1 1  ON 40
 eH2_1                -1.030955e-01 1 1  ON 41
 eH2_2                -6.383418e-02 1 1  ON 42
 eH2_3                -2.770121e-02 1 1  ON 43
 eH2_4                 1.846448e-02 1 1  ON 44
 eH2_5                 3.469614e-02 1 1  ON 45
 eH2_6                 7.838550e-02 1 1  ON 46
 eH2_7                 1.141701e-01 1 1  ON 47
 eH2_8                 9.288465e-02 1 1  ON 48
 eH2_9                 2.602370e-02 1 1  ON 49
ci_001                -4.191989e-02 3 1  ON 50
ci_002                -3.083094e-02 3 1  ON 51
ci_003                -2.625571e-02 3 1  ON 52
ci_004                 2.190226e-02 3 1  ON 53
ci_005                 2.230841e-02 3 1  ON 54
ci_006                -1.965693e-02 3 1  ON 55
ci_007                -1.961412e-02 3 1  ON 56
ci_008                -1.798914e-02 3 1  ON 57
ci_009                -1.780416e-02 3 1  ON 58
ci_010                -1.824457e-02 3 1  ON 59
ci_011                -1.635468e-02 3 1  ON 60
ci_012                -1.691140e-02 3 1  ON 61
ci_013                -1.965100e-02 3 1  ON 62
ci_014                 1.443747e-02 3 1  ON 63
ci_015                 1.409463e-02 3 1  ON 64
ci_016                 1.699676e-02 3 1  ON 65
ci_017                 1.682676e-02 3 1  ON 66
ci_018                 1.299986e-02 3 1  ON 67
ci_019                 1.312552e-02 3 1  ON 68
ci_020                 1.370877e-02 3 1  ON 69
ci_021                 1.412440e-02 3 1  ON 70
ci_022                 1.215413e-02 3 1  ON 71
ci_023                 1.175693e-02 3 1  ON 72
ci_024                 1.234347e-02 3 1  ON 73
ci_025                 1.314136e-02 3 1  ON 74
ci_026                 1.108572e-02 3 1  ON 75
ci_027                 1.156012e-02 3 1  ON 76
ci_028                -1.451844e-02 3 1  ON 77
ci_029                -1.427532e-02 3 1  ON 78
ci_030                -1.124003e-02 3 1  ON 79
ci_031                -1.157203e-02 3 1  ON 80
ci_032                -1.386589e-02 3 1  ON 81
ci_033                 1.060519e-02 3 1  ON 82
ci_034                 1.099507e-02 3 1  ON 83
ci_035                -5.098021e-03 3 1  ON 84
ci_036                -1.072107e-02 3 1  ON 85
ci_037                -1.063105e-02 3 1  ON 86
ci_038                 1.868376e-03 3 1  ON 87
ci_039                 2.239064e-03 3 1  ON 88
ci_040                -3.934783e-03 3 1  ON 89
ci_041                 1.024870e-02 3 1  ON 90
ci_042                 1.017687e-02 3 1  ON 91
ci_043                -3.623036e-03 3 1  ON 92
ci_044                -1.508424e-02 3 1  ON 93
ci_045                -2.148463e-03 3 1  ON 94
ci_046                 5.578011e-03 3 1  ON 95
ci_047                 6.367842e-03 3 1  ON 96
ci_048                -1.176882e-02 3 1  ON 97
ci_049                -1.181800e-02 3 1  ON 98
ci_050                 7.356429e-03 3 1  ON 99
ci_051                 7.810035e-03 3 1  ON 100
ci_052                -6.885890e-03 3 1  ON 101
ci_053                -6.611257e-03 3 1  ON 102
ci_054                -3.159007e-03 3 1  ON 103
ci_055                -3.397433e-03 3 1  ON 104
ci_056                 4.385948e-03 3 1  ON 105
ci_057                 4.653930e-03 3 1  ON 106
ci_058                -6.804222e-03 3 1  ON 107
ci_059                -6.408916e-03 3 1  ON 108
ci_060                 8.420919e-03 3 1  ON 109
ci_061                 8.400809e-03 3 1  ON 110
ci_062                -3.110236e-03 3 1  ON 111
ci_063                -3.532800e-03 3 1  ON 112
ci_064                -3.250180e-03 3 1  ON 113
ci_065                -4.167862e-03 3 1  ON 114
ci_066                 5.793107e-03 3 1  ON 115
ci_067                 5.655070e-03 3 1  ON 116
ci_068                -5.413429e-03 3 1  ON 117
ci_069                -4.912474e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2809
    reference variance = 0.34341
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0848e-01
  Total weights = 1.9562e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294182718589
                                         uncertainty =       0.001667759462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294182718589
                                         uncertainty =       0.001667759462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383462665
  error estimate for blocks of size 2^( 2) =       0.000393693985
  error estimate for blocks of size 2^( 3) =       0.000403027430
  error estimate for blocks of size 2^( 4) =       0.000409816869
  error estimate for blocks of size 2^( 5) =       0.000413900460
  error estimate for blocks of size 2^( 6) =       0.000418113507
  error estimate for blocks of size 2^( 7) =       0.000418933725

      target function =                  N/A
              le_mean =     -17.215950103144
             les_mean =     296.697420142698
             stat err =       0.000415191140
             autocorr =       1.172330278994
              std dev =       0.542298101693
             le_variance =       0.294087231100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294138026124
                                         uncertainty =       0.001664101219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294138026124
                                         uncertainty =       0.001664101219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383433500
  error estimate for blocks of size 2^( 2) =       0.000393665745
  error estimate for blocks of size 2^( 3) =       0.000403002411
  error estimate for blocks of size 2^( 4) =       0.000409794821
  error estimate for blocks of size 2^( 5) =       0.000413880541
  error estimate for blocks of size 2^( 6) =       0.000418094112
  error estimate for blocks of size 2^( 7) =       0.000418908337

      target function =                  N/A
              le_mean =     -17.215951188716
             les_mean =     296.697489426643
             stat err =       0.000415169453
             autocorr =       1.172386139624
              std dev =       0.542256856027
             le_variance =       0.294042497908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294156514400
                                         uncertainty =       0.001665803005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294156514400
                                         uncertainty =       0.001665803005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383445568
  error estimate for blocks of size 2^( 2) =       0.000393677477
  error estimate for blocks of size 2^( 3) =       0.000403012703
  error estimate for blocks of size 2^( 4) =       0.000409803756
  error estimate for blocks of size 2^( 5) =       0.000413888513
  error estimate for blocks of size 2^( 6) =       0.000418101800
  error estimate for blocks of size 2^( 7) =       0.000418918936

      target function =                  N/A
              le_mean =     -17.215950586196
             les_mean =     296.697448530839
             stat err =       0.000415178251
             autocorr =       1.172362034444
              std dev =       0.542273922616
             le_variance =       0.294061007149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294179238610
                                         uncertainty =       0.001667509230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294179238610
                                         uncertainty =       0.001667509230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383460395
  error estimate for blocks of size 2^( 2) =       0.000393691793
  error estimate for blocks of size 2^( 3) =       0.000403025466
  error estimate for blocks of size 2^( 4) =       0.000409815112
  error estimate for blocks of size 2^( 5) =       0.000413898852
  error estimate for blocks of size 2^( 6) =       0.000418111929
  error estimate for blocks of size 2^( 7) =       0.000418931757

      target function =                  N/A
              le_mean =     -17.215950154550
             les_mean =     296.697421076030
             stat err =       0.000415189413
             autocorr =       1.172334406930
              std dev =       0.542294890916
             le_variance =       0.294083748714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215950103144        initial
     3.8147e+00     3.8147e+01             4.0956e-04       -17.215951188716  <--
     1.5259e+01     1.5259e+02             1.0376e-04       -17.215950586196
     6.1035e+01     6.1035e+02             2.6028e-05       -17.215950154550

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9631e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.018469e-01 1 1  ON 0
  uu_1                 4.262098e-02 1 1  ON 1
  uu_2                -4.780452e-02 1 1  ON 2
  uu_3                -9.852019e-02 1 1  ON 3
  uu_4                -1.283548e-01 1 1  ON 4
  uu_5                -1.334213e-01 1 1  ON 5
  uu_6                -1.117845e-01 1 1  ON 6
  uu_7                -3.720595e-02 1 1  ON 7
  uu_8                 1.013431e-01 1 1  ON 8
  uu_9                 1.199423e-01 1 1  ON 9
  ud_0                 3.454953e-01 1 1  ON 10
  ud_1                 8.892253e-02 1 1  ON 11
  ud_2                -1.738370e-02 1 1  ON 12
  ud_3                -7.475000e-02 1 1  ON 13
  ud_4                -1.194806e-01 1 1  ON 14
  ud_5                -1.499556e-01 1 1  ON 15
  ud_6                -1.543489e-01 1 1  ON 16
  ud_7                -1.091388e-01 1 1  ON 17
  ud_8                 6.684777e-03 1 1  ON 18
  ud_9                 9.254234e-02 1 1  ON 19
  eO_0                -7.339068e-01 1 1  ON 20
  eO_1                -4.251221e-01 1 1  ON 21
  eO_2                -3.496142e-02 1 1  ON 22
  eO_3                 1.981419e-01 1 1  ON 23
  eO_4                 2.761931e-01 1 1  ON 24
  eO_5                 3.038214e-01 1 1  ON 25
  eO_6                 2.490889e-01 1 1  ON 26
  eO_7                 1.103131e-01 1 1  ON 27
  eO_8                 2.764239e-02 1 1  ON 28
  eO_9                 1.831266e-02 1 1  ON 29
 eH1_0                -1.810212e-01 1 1  ON 30
 eH1_1                -1.017908e-01 1 1  ON 31
 eH1_2                -6.228887e-02 1 1  ON 32
 eH1_3                -2.643895e-02 1 1  ON 33
 eH1_4                 1.997104e-02 1 1  ON 34
 eH1_5                 3.529100e-02 1 1  ON 35
 eH1_6                 7.677837e-02 1 1  ON 36
 eH1_7                 1.106713e-01 1 1  ON 37
 eH1_8                 8.970790e-02 1 1  ON 38
 eH1_9                 2.397545e-02 1 1  ON 39
 eH2_0                -1.820650e-01 1 1  ON 40
 eH2_1                -1.031078e-01 1 1  ON 41
 eH2_2                -6.382511e-02 1 1  ON 42
 eH2_3                -2.770777e-02 1 1  ON 43
 eH2_4                 1.847381e-02 1 1  ON 44
 eH2_5                 3.470975e-02 1 1  ON 45
 eH2_6                 7.838841e-02 1 1  ON 46
 eH2_7                 1.141679e-01 1 1  ON 47
 eH2_8                 9.289836e-02 1 1  ON 48
 eH2_9                 2.602719e-02 1 1  ON 49
ci_001                -4.188949e-02 3 1  ON 50
ci_002                -3.083458e-02 3 1  ON 51
ci_003                -2.620005e-02 3 1  ON 52
ci_004                 2.186854e-02 3 1  ON 53
ci_005                 2.226274e-02 3 1  ON 54
ci_006                -1.961838e-02 3 1  ON 55
ci_007                -1.955990e-02 3 1  ON 56
ci_008                -1.796407e-02 3 1  ON 57
ci_009                -1.780003e-02 3 1  ON 58
ci_010                -1.818599e-02 3 1  ON 59
ci_011                -1.637251e-02 3 1  ON 60
ci_012                -1.689501e-02 3 1  ON 61
ci_013                -1.968399e-02 3 1  ON 62
ci_014                 1.438992e-02 3 1  ON 63
ci_015                 1.412876e-02 3 1  ON 64
ci_016                 1.698361e-02 3 1  ON 65
ci_017                 1.682978e-02 3 1  ON 66
ci_018                 1.296207e-02 3 1  ON 67
ci_019                 1.309381e-02 3 1  ON 68
ci_020                 1.365309e-02 3 1  ON 69
ci_021                 1.406980e-02 3 1  ON 70
ci_022                 1.210209e-02 3 1  ON 71
ci_023                 1.173852e-02 3 1  ON 72
ci_024                 1.232357e-02 3 1  ON 73
ci_025                 1.307099e-02 3 1  ON 74
ci_026                 1.108691e-02 3 1  ON 75
ci_027                 1.156486e-02 3 1  ON 76
ci_028                -1.451635e-02 3 1  ON 77
ci_029                -1.433209e-02 3 1  ON 78
ci_030                -1.125939e-02 3 1  ON 79
ci_031                -1.155318e-02 3 1  ON 80
ci_032                -1.389012e-02 3 1  ON 81
ci_033                 1.062327e-02 3 1  ON 82
ci_034                 1.095021e-02 3 1  ON 83
ci_035                -5.070520e-03 3 1  ON 84
ci_036                -1.070565e-02 3 1  ON 85
ci_037                -1.060149e-02 3 1  ON 86
ci_038                 1.868726e-03 3 1  ON 87
ci_039                 2.193982e-03 3 1  ON 88
ci_040                -3.948313e-03 3 1  ON 89
ci_041                 1.024354e-02 3 1  ON 90
ci_042                 1.017606e-02 3 1  ON 91
ci_043                -3.582262e-03 3 1  ON 92
ci_044                -1.506539e-02 3 1  ON 93
ci_045                -2.117931e-03 3 1  ON 94
ci_046                 5.543754e-03 3 1  ON 95
ci_047                 6.310556e-03 3 1  ON 96
ci_048                -1.172982e-02 3 1  ON 97
ci_049                -1.182707e-02 3 1  ON 98
ci_050                 7.369008e-03 3 1  ON 99
ci_051                 7.780837e-03 3 1  ON 100
ci_052                -6.871102e-03 3 1  ON 101
ci_053                -6.642943e-03 3 1  ON 102
ci_054                -3.086790e-03 3 1  ON 103
ci_055                -3.385245e-03 3 1  ON 104
ci_056                 4.367833e-03 3 1  ON 105
ci_057                 4.671603e-03 3 1  ON 106
ci_058                -6.766136e-03 3 1  ON 107
ci_059                -6.401820e-03 3 1  ON 108
ci_060                 8.433670e-03 3 1  ON 109
ci_061                 8.381811e-03 3 1  ON 110
ci_062                -3.055358e-03 3 1  ON 111
ci_063                -3.524638e-03 3 1  ON 112
ci_064                -3.196865e-03 3 1  ON 113
ci_065                -4.165626e-03 3 1  ON 114
ci_066                 5.758732e-03 3 1  ON 115
ci_067                 5.682867e-03 3 1  ON 116
ci_068                -5.384057e-03 3 1  ON 117
ci_069                -4.865722e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1885
    reference variance = 0.178163
====================================================
  Execution time = 2.0856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1340e-01
  Total weights = 1.956664337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297717199990
                                         uncertainty =       0.001844937983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297717199990
                                         uncertainty =       0.001844937983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385791897
  error estimate for blocks of size 2^( 2) =       0.000395683094
  error estimate for blocks of size 2^( 3) =       0.000404628519
  error estimate for blocks of size 2^( 4) =       0.000411764065
  error estimate for blocks of size 2^( 5) =       0.000416135550
  error estimate for blocks of size 2^( 6) =       0.000418274731
  error estimate for blocks of size 2^( 7) =       0.000419698569

      target function =                  N/A
              le_mean =     -17.216224614529
             les_mean =     296.711792157865
             stat err =       0.000416468229
             autocorr =       1.165353130727
              std dev =       0.545592133495
             le_variance =       0.297670776131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622461453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216224614558       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216234464015       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216233620150       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216232871617       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216236545457       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216236942126       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216237607541       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216238258292       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216238416644       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216238683718       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216238632619       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216238576885       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e-01 is 1.402255e-03

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216224614558       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216227514432       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216227297003       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216227091526       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216228100538       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216228127613       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216228214738       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216228353548       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216228425802       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216228462919       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216228476561       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+00 is 3.621339e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216224614558       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216225373227       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216225318805       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216225269231       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216225528415       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216225528082       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216225544751       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216225574636       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216225594751       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216225602901       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+01 is 9.090377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6816e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.019361e-01 1 1  ON 0
  uu_1                 4.268999e-02 1 1  ON 1
  uu_2                -4.779070e-02 1 1  ON 2
  uu_3                -9.856004e-02 1 1  ON 3
  uu_4                -1.284031e-01 1 1  ON 4
  uu_5                -1.334455e-01 1 1  ON 5
  uu_6                -1.117985e-01 1 1  ON 6
  uu_7                -3.724756e-02 1 1  ON 7
  uu_8                 1.013151e-01 1 1  ON 8
  uu_9                 1.199495e-01 1 1  ON 9
  ud_0                 3.455729e-01 1 1  ON 10
  ud_1                 8.899882e-02 1 1  ON 11
  ud_2                -1.735972e-02 1 1  ON 12
  ud_3                -7.480878e-02 1 1  ON 13
  ud_4                -1.195265e-01 1 1  ON 14
  ud_5                -1.499988e-01 1 1  ON 15
  ud_6                -1.543245e-01 1 1  ON 16
  ud_7                -1.091625e-01 1 1  ON 17
  ud_8                 6.642605e-03 1 1  ON 18
  ud_9                 9.253933e-02 1 1  ON 19
  eO_0                -7.342689e-01 1 1  ON 20
  eO_1                -4.253593e-01 1 1  ON 21
  eO_2                -3.490914e-02 1 1  ON 22
  eO_3                 1.984284e-01 1 1  ON 23
  eO_4                 2.764059e-01 1 1  ON 24
  eO_5                 3.038278e-01 1 1  ON 25
  eO_6                 2.490973e-01 1 1  ON 26
  eO_7                 1.103383e-01 1 1  ON 27
  eO_8                 2.764623e-02 1 1  ON 28
  eO_9                 1.831413e-02 1 1  ON 29
 eH1_0                -1.810618e-01 1 1  ON 30
 eH1_1                -1.018104e-01 1 1  ON 31
 eH1_2                -6.227402e-02 1 1  ON 32
 eH1_3                -2.640585e-02 1 1  ON 33
 eH1_4                 1.995817e-02 1 1  ON 34
 eH1_5                 3.531789e-02 1 1  ON 35
 eH1_6                 7.677630e-02 1 1  ON 36
 eH1_7                 1.106548e-01 1 1  ON 37
 eH1_8                 8.971855e-02 1 1  ON 38
 eH1_9                 2.397941e-02 1 1  ON 39
 eH2_0                -1.820943e-01 1 1  ON 40
 eH2_1                -1.031584e-01 1 1  ON 41
 eH2_2                -6.381632e-02 1 1  ON 42
 eH2_3                -2.769837e-02 1 1  ON 43
 eH2_4                 1.849122e-02 1 1  ON 44
 eH2_5                 3.473395e-02 1 1  ON 45
 eH2_6                 7.838643e-02 1 1  ON 46
 eH2_7                 1.141618e-01 1 1  ON 47
 eH2_8                 9.291634e-02 1 1  ON 48
 eH2_9                 2.603447e-02 1 1  ON 49
ci_001                -4.180815e-02 3 1  ON 50
ci_002                -3.081838e-02 3 1  ON 51
ci_003                -2.614347e-02 3 1  ON 52
ci_004                 2.181823e-02 3 1  ON 53
ci_005                 2.218688e-02 3 1  ON 54
ci_006                -1.958879e-02 3 1  ON 55
ci_007                -1.950830e-02 3 1  ON 56
ci_008                -1.798936e-02 3 1  ON 57
ci_009                -1.784290e-02 3 1  ON 58
ci_010                -1.818411e-02 3 1  ON 59
ci_011                -1.632966e-02 3 1  ON 60
ci_012                -1.686267e-02 3 1  ON 61
ci_013                -1.969983e-02 3 1  ON 62
ci_014                 1.434176e-02 3 1  ON 63
ci_015                 1.417352e-02 3 1  ON 64
ci_016                 1.697804e-02 3 1  ON 65
ci_017                 1.683296e-02 3 1  ON 66
ci_018                 1.294846e-02 3 1  ON 67
ci_019                 1.305110e-02 3 1  ON 68
ci_020                 1.365073e-02 3 1  ON 69
ci_021                 1.401743e-02 3 1  ON 70
ci_022                 1.199570e-02 3 1  ON 71
ci_023                 1.170102e-02 3 1  ON 72
ci_024                 1.232191e-02 3 1  ON 73
ci_025                 1.300890e-02 3 1  ON 74
ci_026                 1.114713e-02 3 1  ON 75
ci_027                 1.153866e-02 3 1  ON 76
ci_028                -1.448927e-02 3 1  ON 77
ci_029                -1.434226e-02 3 1  ON 78
ci_030                -1.127108e-02 3 1  ON 79
ci_031                -1.156366e-02 3 1  ON 80
ci_032                -1.388872e-02 3 1  ON 81
ci_033                 1.061357e-02 3 1  ON 82
ci_034                 1.088891e-02 3 1  ON 83
ci_035                -5.052644e-03 3 1  ON 84
ci_036                -1.072402e-02 3 1  ON 85
ci_037                -1.058916e-02 3 1  ON 86
ci_038                 1.846755e-03 3 1  ON 87
ci_039                 2.135574e-03 3 1  ON 88
ci_040                -3.921890e-03 3 1  ON 89
ci_041                 1.017945e-02 3 1  ON 90
ci_042                 1.016562e-02 3 1  ON 91
ci_043                -3.571065e-03 3 1  ON 92
ci_044                -1.512989e-02 3 1  ON 93
ci_045                -2.048362e-03 3 1  ON 94
ci_046                 5.540254e-03 3 1  ON 95
ci_047                 6.253104e-03 3 1  ON 96
ci_048                -1.164724e-02 3 1  ON 97
ci_049                -1.182200e-02 3 1  ON 98
ci_050                 7.412733e-03 3 1  ON 99
ci_051                 7.789963e-03 3 1  ON 100
ci_052                -6.807117e-03 3 1  ON 101
ci_053                -6.684098e-03 3 1  ON 102
ci_054                -3.089503e-03 3 1  ON 103
ci_055                -3.368865e-03 3 1  ON 104
ci_056                 4.397393e-03 3 1  ON 105
ci_057                 4.732899e-03 3 1  ON 106
ci_058                -6.770439e-03 3 1  ON 107
ci_059                -6.426655e-03 3 1  ON 108
ci_060                 8.473914e-03 3 1  ON 109
ci_061                 8.383552e-03 3 1  ON 110
ci_062                -3.059802e-03 3 1  ON 111
ci_063                -3.477536e-03 3 1  ON 112
ci_064                -3.190541e-03 3 1  ON 113
ci_065                -4.172027e-03 3 1  ON 114
ci_066                 5.814353e-03 3 1  ON 115
ci_067                 5.676314e-03 3 1  ON 116
ci_068                -5.348761e-03 3 1  ON 117
ci_069                -4.846431e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2645
    reference variance = 0.302455
====================================================
  Execution time = 2.3142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1058e-01
  Total weights = 1.9566e+06
  Execution time = 1.8107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297352148270
                                         uncertainty =       0.001866629880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297352148270
                                         uncertainty =       0.001866629880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385540373
  error estimate for blocks of size 2^( 2) =       0.000395038702
  error estimate for blocks of size 2^( 3) =       0.000404153362
  error estimate for blocks of size 2^( 4) =       0.000410599511
  error estimate for blocks of size 2^( 5) =       0.000415810293
  error estimate for blocks of size 2^( 6) =       0.000417178767
  error estimate for blocks of size 2^( 7) =       0.000418032159

      target function =                  N/A
              le_mean =     -17.216594029088
             les_mean =     296.721706856598
             stat err =       0.000415405183
             autocorr =       1.160924814227
              std dev =       0.545236424719
             le_variance =       0.297282758840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297445135420
                                         uncertainty =       0.001858210528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297445135420
                                         uncertainty =       0.001858210528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385600361
  error estimate for blocks of size 2^( 2) =       0.000395093610
  error estimate for blocks of size 2^( 3) =       0.000404205387
  error estimate for blocks of size 2^( 4) =       0.000410651139
  error estimate for blocks of size 2^( 5) =       0.000415860239
  error estimate for blocks of size 2^( 6) =       0.000417242208
  error estimate for blocks of size 2^( 7) =       0.000418094369

      target function =                  N/A
              le_mean =     -17.216594549025
             les_mean =     296.722800323141
             stat err =       0.000415461989
             autocorr =       1.160881063752
              std dev =       0.545321260643
             le_variance =       0.297375277309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297377940181
                                         uncertainty =       0.001861277314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297377940181
                                         uncertainty =       0.001861277314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385556919
  error estimate for blocks of size 2^( 2) =       0.000395053386
  error estimate for blocks of size 2^( 3) =       0.000404167325
  error estimate for blocks of size 2^( 4) =       0.000410614057
  error estimate for blocks of size 2^( 5) =       0.000415824086
  error estimate for blocks of size 2^( 6) =       0.000417200302
  error estimate for blocks of size 2^( 7) =       0.000418052471

      target function =                  N/A
              le_mean =     -17.216593655095
             les_mean =     296.721756516503
             stat err =       0.000415422729
             autocorr =       1.160923242883
              std dev =       0.545259824138
             le_variance =       0.297308275819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297353488128
                                         uncertainty =       0.001865889768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297353488128
                                         uncertainty =       0.001865889768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385541218
  error estimate for blocks of size 2^( 2) =       0.000395039353
  error estimate for blocks of size 2^( 3) =       0.000404153961
  error estimate for blocks of size 2^( 4) =       0.000410600225
  error estimate for blocks of size 2^( 5) =       0.000415810931
  error estimate for blocks of size 2^( 6) =       0.000417180353
  error estimate for blocks of size 2^( 7) =       0.000418033599

      target function =                  N/A
              le_mean =     -17.216593828457
             les_mean =     296.721982680770
             stat err =       0.000415406277
             autocorr =       1.160925841346
              std dev =       0.545237620019
             le_variance =       0.297284062284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216594029088        initial
     9.5367e-01     9.5367e+00             1.4023e-03       -17.216594549025  <--
     3.8147e+00     3.8147e+01             3.6213e-04       -17.216593655095
     1.5259e+01     1.5259e+02             9.0904e-05       -17.216593828457

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 3.2323e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.022074e-01 1 1  ON 0
  uu_1                 4.288568e-02 1 1  ON 1
  uu_2                -4.774581e-02 1 1  ON 2
  uu_3                -9.866204e-02 1 1  ON 3
  uu_4                -1.285420e-01 1 1  ON 4
  uu_5                -1.335312e-01 1 1  ON 5
  uu_6                -1.118458e-01 1 1  ON 6
  uu_7                -3.737300e-02 1 1  ON 7
  uu_8                 1.012306e-01 1 1  ON 8
  uu_9                 1.199709e-01 1 1  ON 9
  ud_0                 3.458136e-01 1 1  ON 10
  ud_1                 8.920946e-02 1 1  ON 11
  ud_2                -1.730243e-02 1 1  ON 12
  ud_3                -7.494818e-02 1 1  ON 13
  ud_4                -1.196685e-01 1 1  ON 14
  ud_5                -1.501271e-01 1 1  ON 15
  ud_6                -1.542606e-01 1 1  ON 16
  ud_7                -1.092328e-01 1 1  ON 17
  ud_8                 6.516118e-03 1 1  ON 18
  ud_9                 9.253022e-02 1 1  ON 19
  eO_0                -7.353091e-01 1 1  ON 20
  eO_1                -4.260255e-01 1 1  ON 21
  eO_2                -3.479750e-02 1 1  ON 22
  eO_3                 1.992217e-01 1 1  ON 23
  eO_4                 2.770525e-01 1 1  ON 24
  eO_5                 3.038574e-01 1 1  ON 25
  eO_6                 2.491232e-01 1 1  ON 26
  eO_7                 1.104144e-01 1 1  ON 27
  eO_8                 2.765785e-02 1 1  ON 28
  eO_9                 1.831859e-02 1 1  ON 29
 eH1_0                -1.811718e-01 1 1  ON 30
 eH1_1                -1.018624e-01 1 1  ON 31
 eH1_2                -6.223481e-02 1 1  ON 32
 eH1_3                -2.631986e-02 1 1  ON 33
 eH1_4                 1.992673e-02 1 1  ON 34
 eH1_5                 3.538876e-02 1 1  ON 35
 eH1_6                 7.677218e-02 1 1  ON 36
 eH1_7                 1.106059e-01 1 1  ON 37
 eH1_8                 8.975068e-02 1 1  ON 38
 eH1_9                 2.399136e-02 1 1  ON 39
 eH2_0                -1.821813e-01 1 1  ON 40
 eH2_1                -1.032894e-01 1 1  ON 41
 eH2_2                -6.379727e-02 1 1  ON 42
 eH2_3                -2.767170e-02 1 1  ON 43
 eH2_4                 1.853216e-02 1 1  ON 44
 eH2_5                 3.480058e-02 1 1  ON 45
 eH2_6                 7.838389e-02 1 1  ON 46
 eH2_7                 1.141438e-01 1 1  ON 47
 eH2_8                 9.297055e-02 1 1  ON 48
 eH2_9                 2.605643e-02 1 1  ON 49
ci_001                -4.160115e-02 3 1  ON 50
ci_002                -3.078101e-02 3 1  ON 51
ci_003                -2.599722e-02 3 1  ON 52
ci_004                 2.169124e-02 3 1  ON 53
ci_005                 2.199643e-02 3 1  ON 54
ci_006                -1.951600e-02 3 1  ON 55
ci_007                -1.937903e-02 3 1  ON 56
ci_008                -1.804716e-02 3 1  ON 57
ci_009                -1.794095e-02 3 1  ON 58
ci_010                -1.817756e-02 3 1  ON 59
ci_011                -1.622584e-02 3 1  ON 60
ci_012                -1.678054e-02 3 1  ON 61
ci_013                -1.974031e-02 3 1  ON 62
ci_014                 1.422574e-02 3 1  ON 63
ci_015                 1.428135e-02 3 1  ON 64
ci_016                 1.696544e-02 3 1  ON 65
ci_017                 1.684472e-02 3 1  ON 66
ci_018                 1.291641e-02 3 1  ON 67
ci_019                 1.294893e-02 3 1  ON 68
ci_020                 1.364825e-02 3 1  ON 69
ci_021                 1.388774e-02 3 1  ON 70
ci_022                 1.174079e-02 3 1  ON 71
ci_023                 1.160862e-02 3 1  ON 72
ci_024                 1.231684e-02 3 1  ON 73
ci_025                 1.284688e-02 3 1  ON 74
ci_026                 1.129255e-02 3 1  ON 75
ci_027                 1.147545e-02 3 1  ON 76
ci_028                -1.442646e-02 3 1  ON 77
ci_029                -1.437044e-02 3 1  ON 78
ci_030                -1.129717e-02 3 1  ON 79
ci_031                -1.158581e-02 3 1  ON 80
ci_032                -1.388439e-02 3 1  ON 81
ci_033                 1.058788e-02 3 1  ON 82
ci_034                 1.073772e-02 3 1  ON 83
ci_035                -5.011325e-03 3 1  ON 84
ci_036                -1.077063e-02 3 1  ON 85
ci_037                -1.056016e-02 3 1  ON 86
ci_038                 1.793630e-03 3 1  ON 87
ci_039                 2.005274e-03 3 1  ON 88
ci_040                -3.865172e-03 3 1  ON 89
ci_041                 1.002569e-02 3 1  ON 90
ci_042                 1.013852e-02 3 1  ON 91
ci_043                -3.545329e-03 3 1  ON 92
ci_044                -1.529314e-02 3 1  ON 93
ci_045                -1.898249e-03 3 1  ON 94
ci_046                 5.530404e-03 3 1  ON 95
ci_047                 6.115531e-03 3 1  ON 96
ci_048                -1.143994e-02 3 1  ON 97
ci_049                -1.181230e-02 3 1  ON 98
ci_050                 7.507703e-03 3 1  ON 99
ci_051                 7.808981e-03 3 1  ON 100
ci_052                -6.662805e-03 3 1  ON 101
ci_053                -6.776327e-03 3 1  ON 102
ci_054                -3.092298e-03 3 1  ON 103
ci_055                -3.327456e-03 3 1  ON 104
ci_056                 4.462405e-03 3 1  ON 105
ci_057                 4.868489e-03 3 1  ON 106
ci_058                -6.779716e-03 3 1  ON 107
ci_059                -6.482714e-03 3 1  ON 108
ci_060                 8.572300e-03 3 1  ON 109
ci_061                 8.388385e-03 3 1  ON 110
ci_062                -3.068498e-03 3 1  ON 111
ci_063                -3.366407e-03 3 1  ON 112
ci_064                -3.176568e-03 3 1  ON 113
ci_065                -4.184243e-03 3 1  ON 114
ci_066                 5.936231e-03 3 1  ON 115
ci_067                 5.661439e-03 3 1  ON 116
ci_068                -5.264690e-03 3 1  ON 117
ci_069                -4.802604e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.195
    reference variance = 0.315937
====================================================
  Execution time = 2.0908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1045e-01
  Total weights = 1.956546698e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296620907353
                                         uncertainty =       0.001814520025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296620907353
                                         uncertainty =       0.001814520025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385099709
  error estimate for blocks of size 2^( 2) =       0.000395340660
  error estimate for blocks of size 2^( 3) =       0.000404678735
  error estimate for blocks of size 2^( 4) =       0.000412067751
  error estimate for blocks of size 2^( 5) =       0.000415985241
  error estimate for blocks of size 2^( 6) =       0.000419222570
  error estimate for blocks of size 2^( 7) =       0.000421913969

      target function =                  N/A
              le_mean =     -17.216449009367
             les_mean =     296.716563074393
             stat err =       0.000417297383
             autocorr =       1.174207747119
              std dev =       0.544613231216
             le_variance =       0.296603571616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644900937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449009379       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463426083       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216465366431       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216463199038       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216479763629       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216481415712       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216481513719       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216481617072       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216481716536       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216481514868       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216481759559       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216481481720       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216481270017       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216481197441       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e-01 is 4.914853e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449009379       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216454779413       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455599854       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216454644510       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216459940139       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216460123849       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216460128449       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216460018386       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216460021997       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216460026196       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216459967927       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e-01 is 1.436178e-03

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449009379       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450706911       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216450961041       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216450720160       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216452113846       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216452131970       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216452134016       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216452105099       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216452097212       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216452111480       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216452088366       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+00 is 3.785384e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6926e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.026272e-01 1 1  ON 0
  uu_1                 4.310203e-02 1 1  ON 1
  uu_2                -4.770300e-02 1 1  ON 2
  uu_3                -9.878190e-02 1 1  ON 3
  uu_4                -1.288144e-01 1 1  ON 4
  uu_5                -1.336912e-01 1 1  ON 5
  uu_6                -1.118389e-01 1 1  ON 6
  uu_7                -3.754329e-02 1 1  ON 7
  uu_8                 1.011387e-01 1 1  ON 8
  uu_9                 1.200247e-01 1 1  ON 9
  ud_0                 3.462114e-01 1 1  ON 10
  ud_1                 8.944320e-02 1 1  ON 11
  ud_2                -1.733503e-02 1 1  ON 12
  ud_3                -7.508612e-02 1 1  ON 13
  ud_4                -1.198864e-01 1 1  ON 14
  ud_5                -1.503126e-01 1 1  ON 15
  ud_6                -1.542172e-01 1 1  ON 16
  ud_7                -1.092804e-01 1 1  ON 17
  ud_8                 6.371744e-03 1 1  ON 18
  ud_9                 9.252757e-02 1 1  ON 19
  eO_0                -7.367452e-01 1 1  ON 20
  eO_1                -4.266966e-01 1 1  ON 21
  eO_2                -3.464622e-02 1 1  ON 22
  eO_3                 2.002096e-01 1 1  ON 23
  eO_4                 2.778449e-01 1 1  ON 24
  eO_5                 3.038219e-01 1 1  ON 25
  eO_6                 2.491851e-01 1 1  ON 26
  eO_7                 1.105302e-01 1 1  ON 27
  eO_8                 2.767116e-02 1 1  ON 28
  eO_9                 1.832505e-02 1 1  ON 29
 eH1_0                -1.812687e-01 1 1  ON 30
 eH1_1                -1.019204e-01 1 1  ON 31
 eH1_2                -6.226627e-02 1 1  ON 32
 eH1_3                -2.620196e-02 1 1  ON 33
 eH1_4                 1.981347e-02 1 1  ON 34
 eH1_5                 3.549850e-02 1 1  ON 35
 eH1_6                 7.678637e-02 1 1  ON 36
 eH1_7                 1.105753e-01 1 1  ON 37
 eH1_8                 8.981682e-02 1 1  ON 38
 eH1_9                 2.401069e-02 1 1  ON 39
 eH2_0                -1.823150e-01 1 1  ON 40
 eH2_1                -1.033777e-01 1 1  ON 41
 eH2_2                -6.375473e-02 1 1  ON 42
 eH2_3                -2.767969e-02 1 1  ON 43
 eH2_4                 1.859154e-02 1 1  ON 44
 eH2_5                 3.488265e-02 1 1  ON 45
 eH2_6                 7.836603e-02 1 1  ON 46
 eH2_7                 1.140970e-01 1 1  ON 47
 eH2_8                 9.303862e-02 1 1  ON 48
 eH2_9                 2.607981e-02 1 1  ON 49
ci_001                -4.163929e-02 3 1  ON 50
ci_002                -3.052535e-02 3 1  ON 51
ci_003                -2.574018e-02 3 1  ON 52
ci_004                 2.161785e-02 3 1  ON 53
ci_005                 2.186255e-02 3 1  ON 54
ci_006                -1.924015e-02 3 1  ON 55
ci_007                -1.935628e-02 3 1  ON 56
ci_008                -1.805065e-02 3 1  ON 57
ci_009                -1.781082e-02 3 1  ON 58
ci_010                -1.808670e-02 3 1  ON 59
ci_011                -1.628683e-02 3 1  ON 60
ci_012                -1.667376e-02 3 1  ON 61
ci_013                -1.947497e-02 3 1  ON 62
ci_014                 1.405571e-02 3 1  ON 63
ci_015                 1.417714e-02 3 1  ON 64
ci_016                 1.672143e-02 3 1  ON 65
ci_017                 1.673301e-02 3 1  ON 66
ci_018                 1.277727e-02 3 1  ON 67
ci_019                 1.292844e-02 3 1  ON 68
ci_020                 1.350375e-02 3 1  ON 69
ci_021                 1.378202e-02 3 1  ON 70
ci_022                 1.175761e-02 3 1  ON 71
ci_023                 1.157173e-02 3 1  ON 72
ci_024                 1.239229e-02 3 1  ON 73
ci_025                 1.263013e-02 3 1  ON 74
ci_026                 1.121863e-02 3 1  ON 75
ci_027                 1.149567e-02 3 1  ON 76
ci_028                -1.442897e-02 3 1  ON 77
ci_029                -1.451714e-02 3 1  ON 78
ci_030                -1.120563e-02 3 1  ON 79
ci_031                -1.166241e-02 3 1  ON 80
ci_032                -1.365163e-02 3 1  ON 81
ci_033                 1.070520e-02 3 1  ON 82
ci_034                 1.075115e-02 3 1  ON 83
ci_035                -5.016387e-03 3 1  ON 84
ci_036                -1.082507e-02 3 1  ON 85
ci_037                -1.046065e-02 3 1  ON 86
ci_038                 1.734696e-03 3 1  ON 87
ci_039                 2.014226e-03 3 1  ON 88
ci_040                -3.992634e-03 3 1  ON 89
ci_041                 1.002516e-02 3 1  ON 90
ci_042                 9.977557e-03 3 1  ON 91
ci_043                -3.570765e-03 3 1  ON 92
ci_044                -1.533448e-02 3 1  ON 93
ci_045                -1.805790e-03 3 1  ON 94
ci_046                 5.411755e-03 3 1  ON 95
ci_047                 6.038364e-03 3 1  ON 96
ci_048                -1.138386e-02 3 1  ON 97
ci_049                -1.185258e-02 3 1  ON 98
ci_050                 7.609364e-03 3 1  ON 99
ci_051                 7.786384e-03 3 1  ON 100
ci_052                -6.814586e-03 3 1  ON 101
ci_053                -6.801516e-03 3 1  ON 102
ci_054                -3.035772e-03 3 1  ON 103
ci_055                -3.237373e-03 3 1  ON 104
ci_056                 4.600617e-03 3 1  ON 105
ci_057                 4.763648e-03 3 1  ON 106
ci_058                -6.837474e-03 3 1  ON 107
ci_059                -6.655158e-03 3 1  ON 108
ci_060                 8.506511e-03 3 1  ON 109
ci_061                 8.328638e-03 3 1  ON 110
ci_062                -3.062903e-03 3 1  ON 111
ci_063                -3.219353e-03 3 1  ON 112
ci_064                -3.083398e-03 3 1  ON 113
ci_065                -4.156838e-03 3 1  ON 114
ci_066                 5.986546e-03 3 1  ON 115
ci_067                 5.471836e-03 3 1  ON 116
ci_068                -5.297676e-03 3 1  ON 117
ci_069                -4.930426e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2538
    reference variance = 0.307472
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1353e-01
  Total weights = 1.9563e+06
  Execution time = 1.8211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296248648290
                                         uncertainty =       0.001894374044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296248648290
                                         uncertainty =       0.001894374044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384859961
  error estimate for blocks of size 2^( 2) =       0.000395031994
  error estimate for blocks of size 2^( 3) =       0.000404474143
  error estimate for blocks of size 2^( 4) =       0.000411311334
  error estimate for blocks of size 2^( 5) =       0.000415224016
  error estimate for blocks of size 2^( 6) =       0.000419386656
  error estimate for blocks of size 2^( 7) =       0.000420336440

      target function =                  N/A
              le_mean =     -17.216371240163
             les_mean =     296.717164553691
             stat err =       0.000416564612
             autocorr =       1.171545829742
              std dev =       0.544274176184
             le_variance =       0.296234378861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345370573
                                         uncertainty =       0.001904290242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297345370573
                                         uncertainty =       0.001904290242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385574498
  error estimate for blocks of size 2^( 2) =       0.000395708325
  error estimate for blocks of size 2^( 3) =       0.000405127479
  error estimate for blocks of size 2^( 4) =       0.000411946225
  error estimate for blocks of size 2^( 5) =       0.000415821457
  error estimate for blocks of size 2^( 6) =       0.000419987521
  error estimate for blocks of size 2^( 7) =       0.000420946185

      target function =                  N/A
              le_mean =     -17.216380002913
             les_mean =     296.718672560436
             stat err =       0.000417175347
             autocorr =       1.170632742635
              std dev =       0.545284685082
             le_variance =       0.297335387785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296981820276
                                         uncertainty =       0.001901063748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296981820276
                                         uncertainty =       0.001901063748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385337908
  error estimate for blocks of size 2^( 2) =       0.000395486537
  error estimate for blocks of size 2^( 3) =       0.000404918338
  error estimate for blocks of size 2^( 4) =       0.000411744924
  error estimate for blocks of size 2^( 5) =       0.000415630885
  error estimate for blocks of size 2^( 6) =       0.000419794182
  error estimate for blocks of size 2^( 7) =       0.000420748589

      target function =                  N/A
              le_mean =     -17.216375004338
             les_mean =     296.717685051199
             stat err =       0.000416979645
             autocorr =       1.170971270082
              std dev =       0.544950095972
             le_variance =       0.296970607099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296341388487
                                         uncertainty =       0.001895062433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296341388487
                                         uncertainty =       0.001895062433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384920441
  error estimate for blocks of size 2^( 2) =       0.000395089197
  error estimate for blocks of size 2^( 3) =       0.000404530222
  error estimate for blocks of size 2^( 4) =       0.000411365975
  error estimate for blocks of size 2^( 5) =       0.000415274791
  error estimate for blocks of size 2^( 6) =       0.000419437241
  error estimate for blocks of size 2^( 7) =       0.000420387949

      target function =                  N/A
              le_mean =     -17.216370491394
             les_mean =     296.716831872313
             stat err =       0.000416616489
             autocorr =       1.171469426863
              std dev =       0.544359708550
             le_variance =       0.296327492292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216371240163        initial
     2.3842e-01     2.3842e+00             4.9149e-03       -17.216380002913  <--
     9.5367e-01     9.5367e+00             1.4362e-03       -17.216375004338
     3.8147e+00     3.8147e+01             3.7854e-04       -17.216370491394

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.9851e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2431
    reference variance = 0.232357
====================================================
  Execution time = 2.0940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1422e-01
  Total weights = 1.956218214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884509775
                                         uncertainty =       0.002169218259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884509775
                                         uncertainty =       0.002169218259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385929750
  error estimate for blocks of size 2^( 2) =       0.000396242487
  error estimate for blocks of size 2^( 3) =       0.000405117126
  error estimate for blocks of size 2^( 4) =       0.000411359174
  error estimate for blocks of size 2^( 5) =       0.000415337681
  error estimate for blocks of size 2^( 6) =       0.000418781152
  error estimate for blocks of size 2^( 7) =       0.000419967862

      target function =                  N/A
              le_mean =     -17.216388108037
             les_mean =     296.718238465462
             stat err =       0.000416361467
             autocorr =       1.163923790845
              std dev =       0.545787086205
             le_variance =       0.297883543468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638810804e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388108076       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387228849       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216388408607       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216392244783       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216398007020       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216414299110       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216424755588       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216422315062       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216423101702       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216422098128       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216421466771       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216423097260       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216423164794       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216422724791       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216423652298       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216423546062       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216423579702       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216423794339       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216424266041       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216424199265       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216424074546       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e-02 is 1.115001e-02

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388108076       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387546520       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216387759609       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216389218055       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216392529364       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216398164836       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400236611       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216399596298       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216398888910       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216399005054       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216398524063       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216398859765       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216398787337       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e-01 is 3.658539e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388108076       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387878422       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216387818603       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216387507578       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216388400395       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216390654471       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216390647443       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216390611654       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216390436869       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216390374812       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216390352122       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e-01 is 1.015820e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6900e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.048209e-01 1 1  ON 0
  uu_1                 4.441024e-02 1 1  ON 1
  uu_2                -4.737936e-02 1 1  ON 2
  uu_3                -9.932960e-02 1 1  ON 3
  uu_4                -1.299286e-01 1 1  ON 4
  uu_5                -1.348837e-01 1 1  ON 5
  uu_6                -1.121601e-01 1 1  ON 6
  uu_7                -3.859548e-02 1 1  ON 7
  uu_8                 1.006187e-01 1 1  ON 8
  uu_9                 1.204640e-01 1 1  ON 9
  ud_0                 3.481646e-01 1 1  ON 10
  ud_1                 9.064582e-02 1 1  ON 11
  ud_2                -1.688743e-02 1 1  ON 12
  ud_3                -7.557404e-02 1 1  ON 13
  ud_4                -1.210280e-01 1 1  ON 14
  ud_5                -1.512919e-01 1 1  ON 15
  ud_6                -1.542185e-01 1 1  ON 16
  ud_7                -1.097566e-01 1 1  ON 17
  ud_8                 5.339557e-03 1 1  ON 18
  ud_9                 9.255008e-02 1 1  ON 19
  eO_0                -7.438825e-01 1 1  ON 20
  eO_1                -4.310121e-01 1 1  ON 21
  eO_2                -3.506698e-02 1 1  ON 22
  eO_3                 2.047531e-01 1 1  ON 23
  eO_4                 2.835247e-01 1 1  ON 24
  eO_5                 3.040295e-01 1 1  ON 25
  eO_6                 2.495624e-01 1 1  ON 26
  eO_7                 1.113220e-01 1 1  ON 27
  eO_8                 2.783108e-02 1 1  ON 28
  eO_9                 1.838392e-02 1 1  ON 29
 eH1_0                -1.819186e-01 1 1  ON 30
 eH1_1                -1.024144e-01 1 1  ON 31
 eH1_2                -6.241580e-02 1 1  ON 32
 eH1_3                -2.615144e-02 1 1  ON 33
 eH1_4                 1.964955e-02 1 1  ON 34
 eH1_5                 3.609446e-02 1 1  ON 35
 eH1_6                 7.722289e-02 1 1  ON 36
 eH1_7                 1.103737e-01 1 1  ON 37
 eH1_8                 9.021402e-02 1 1  ON 38
 eH1_9                 2.416115e-02 1 1  ON 39
 eH2_0                -1.829087e-01 1 1  ON 40
 eH2_1                -1.037042e-01 1 1  ON 41
 eH2_2                -6.358097e-02 1 1  ON 42
 eH2_3                -2.718274e-02 1 1  ON 43
 eH2_4                 1.872364e-02 1 1  ON 44
 eH2_5                 3.480258e-02 1 1  ON 45
 eH2_6                 7.809332e-02 1 1  ON 46
 eH2_7                 1.138309e-01 1 1  ON 47
 eH2_8                 9.355918e-02 1 1  ON 48
 eH2_9                 2.622240e-02 1 1  ON 49
ci_001                -4.101548e-02 3 1  ON 50
ci_002                -3.042022e-02 3 1  ON 51
ci_003                -2.501412e-02 3 1  ON 52
ci_004                 2.125739e-02 3 1  ON 53
ci_005                 2.113055e-02 3 1  ON 54
ci_006                -1.899437e-02 3 1  ON 55
ci_007                -1.890513e-02 3 1  ON 56
ci_008                -1.800379e-02 3 1  ON 57
ci_009                -1.793008e-02 3 1  ON 58
ci_010                -1.716625e-02 3 1  ON 59
ci_011                -1.684098e-02 3 1  ON 60
ci_012                -1.619171e-02 3 1  ON 61
ci_013                -1.923171e-02 3 1  ON 62
ci_014                 1.396670e-02 3 1  ON 63
ci_015                 1.416293e-02 3 1  ON 64
ci_016                 1.644543e-02 3 1  ON 65
ci_017                 1.656005e-02 3 1  ON 66
ci_018                 1.267881e-02 3 1  ON 67
ci_019                 1.281453e-02 3 1  ON 68
ci_020                 1.345792e-02 3 1  ON 69
ci_021                 1.336820e-02 3 1  ON 70
ci_022                 1.185237e-02 3 1  ON 71
ci_023                 1.100521e-02 3 1  ON 72
ci_024                 1.204275e-02 3 1  ON 73
ci_025                 1.120574e-02 3 1  ON 74
ci_026                 1.102726e-02 3 1  ON 75
ci_027                 1.114966e-02 3 1  ON 76
ci_028                -1.413104e-02 3 1  ON 77
ci_029                -1.456994e-02 3 1  ON 78
ci_030                -1.093411e-02 3 1  ON 79
ci_031                -1.165564e-02 3 1  ON 80
ci_032                -1.378384e-02 3 1  ON 81
ci_033                 1.040841e-02 3 1  ON 82
ci_034                 1.126182e-02 3 1  ON 83
ci_035                -4.868813e-03 3 1  ON 84
ci_036                -1.070446e-02 3 1  ON 85
ci_037                -1.021784e-02 3 1  ON 86
ci_038                 1.944170e-03 3 1  ON 87
ci_039                 1.982489e-03 3 1  ON 88
ci_040                -4.131246e-03 3 1  ON 89
ci_041                 9.668594e-03 3 1  ON 90
ci_042                 9.440727e-03 3 1  ON 91
ci_043                -3.281959e-03 3 1  ON 92
ci_044                -1.568465e-02 3 1  ON 93
ci_045                -1.815247e-03 3 1  ON 94
ci_046                 5.759541e-03 3 1  ON 95
ci_047                 5.724691e-03 3 1  ON 96
ci_048                -1.146491e-02 3 1  ON 97
ci_049                -1.210082e-02 3 1  ON 98
ci_050                 7.605669e-03 3 1  ON 99
ci_051                 7.677362e-03 3 1  ON 100
ci_052                -6.820689e-03 3 1  ON 101
ci_053                -6.738080e-03 3 1  ON 102
ci_054                -3.368331e-03 3 1  ON 103
ci_055                -2.740137e-03 3 1  ON 104
ci_056                 4.638469e-03 3 1  ON 105
ci_057                 5.315883e-03 3 1  ON 106
ci_058                -7.422111e-03 3 1  ON 107
ci_059                -6.824385e-03 3 1  ON 108
ci_060                 8.137420e-03 3 1  ON 109
ci_061                 8.273032e-03 3 1  ON 110
ci_062                -3.278333e-03 3 1  ON 111
ci_063                -3.232270e-03 3 1  ON 112
ci_064                -3.073097e-03 3 1  ON 113
ci_065                -3.759907e-03 3 1  ON 114
ci_066                 5.995026e-03 3 1  ON 115
ci_067                 5.910238e-03 3 1  ON 116
ci_068                -5.327575e-03 3 1  ON 117
ci_069                -4.985674e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.15544
====================================================
  Execution time = 2.1183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1174e-01
  Total weights = 1.9565e+06
  Execution time = 1.8136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.202605
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333990669601
                                         uncertainty =       0.035391981075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333990669601
                                         uncertainty =       0.035391981075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408681899
  error estimate for blocks of size 2^( 2) =       0.000418028254
  error estimate for blocks of size 2^( 3) =       0.000427363258
  error estimate for blocks of size 2^( 4) =       0.000433273540
  error estimate for blocks of size 2^( 5) =       0.000437438766
  error estimate for blocks of size 2^( 6) =       0.000440748259
  error estimate for blocks of size 2^( 7) =       0.000443246786

      target function =                  N/A
              le_mean =     -17.217521482070
             les_mean =     336.007006030784
             stat err =       0.000438676838
             autocorr =       1.152175414230
              std dev =       0.577963483867
             le_variance =       0.334041788683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747180746
                                         uncertainty =       0.002650168764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299747180746
                                         uncertainty =       0.002650168764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387152182
  error estimate for blocks of size 2^( 2) =       0.000397032178
  error estimate for blocks of size 2^( 3) =       0.000406495653
  error estimate for blocks of size 2^( 4) =       0.000412851462
  error estimate for blocks of size 2^( 5) =       0.000417113647
  error estimate for blocks of size 2^( 6) =       0.000420711774
  error estimate for blocks of size 2^( 7) =       0.000423061061

      target function =                  N/A
              le_mean =     -17.217397017787
             les_mean =     296.756181601705
             stat err =       0.000418434486
             autocorr =       1.168130913820
              std dev =       0.547515866913
             le_variance =       0.299773624521

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.211191
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299532126348
                                         uncertainty =       0.002600307832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299532126348
                                         uncertainty =       0.002600307832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387013714
  error estimate for blocks of size 2^( 2) =       0.000396922131
  error estimate for blocks of size 2^( 3) =       0.000406410111
  error estimate for blocks of size 2^( 4) =       0.000412781106
  error estimate for blocks of size 2^( 5) =       0.000417066349
  error estimate for blocks of size 2^( 6) =       0.000420680332
  error estimate for blocks of size 2^( 7) =       0.000423024526

      target function =                  N/A
              le_mean =     -17.217398360886
             les_mean =     296.762380418964
             stat err =       0.000418388078
             autocorr =       1.168707663524
              std dev =       0.547320043754
             le_variance =       0.299559230294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298660498276
                                         uncertainty =       0.002791145995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298660498276
                                         uncertainty =       0.002791145995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386449809
  error estimate for blocks of size 2^( 2) =       0.000396352275
  error estimate for blocks of size 2^( 3) =       0.000405865081
  error estimate for blocks of size 2^( 4) =       0.000412250699
  error estimate for blocks of size 2^( 5) =       0.000416533686
  error estimate for blocks of size 2^( 6) =       0.000420127547
  error estimate for blocks of size 2^( 7) =       0.000422481135

      target function =                  N/A
              le_mean =     -17.217376770213
             les_mean =     296.755865216101
             stat err =       0.000417848267
             autocorr =       1.169098265861
              std dev =       0.546522561249
             le_variance =       0.298686909955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217521482070        initial  <--
     5.9605e-02     5.9605e-01             1.1150e-02       -17.217397017787
     2.3842e-01     2.3842e+00             3.6585e-03       -17.217398360886
     9.5367e-01     9.5367e+00             1.0158e-03       -17.217376770213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3580
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.243854
====================================================
  Execution time = 2.1124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2346e-01
  Total weights = 1.956762499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305117784106
                                         uncertainty =       0.008370618150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305117784106
                                         uncertainty =       0.008370618150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390539632
  error estimate for blocks of size 2^( 2) =       0.000400358828
  error estimate for blocks of size 2^( 3) =       0.000409402722
  error estimate for blocks of size 2^( 4) =       0.000415766398
  error estimate for blocks of size 2^( 5) =       0.000419413127
  error estimate for blocks of size 2^( 6) =       0.000420194089
  error estimate for blocks of size 2^( 7) =       0.000421008648

      target function =                  N/A
              le_mean =     -17.215974600491
             les_mean =     296.713240536033
             stat err =       0.000419095566
             autocorr =       1.151584751054
              std dev =       0.552306444383
             le_variance =       0.305042408507


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597460049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215974600560       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215980028409       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215980235447       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215982201639       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215983617491       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215984925271       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215984254137       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215984383146       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215984567420       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215984713739       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215984752033       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e-01 is 1.679422e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215974600560       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215976362397       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215976283694       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215976807632       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215977142385       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215977571581       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215977405165       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215977381444       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215977407870       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215977477977       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+00 is 4.392169e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215974600560       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215975076522       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215975044599       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215975171169       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215975253420       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215975372278       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215975332222       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215975323857       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215975325625       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215975342175       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+00 is 1.108037e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7131e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.037813e-01 1 1  ON 0
  uu_1                 4.379259e-02 1 1  ON 1
  uu_2                -4.748374e-02 1 1  ON 2
  uu_3                -9.909211e-02 1 1  ON 3
  uu_4                -1.295002e-01 1 1  ON 4
  uu_5                -1.342460e-01 1 1  ON 5
  uu_6                -1.119256e-01 1 1  ON 6
  uu_7                -3.810237e-02 1 1  ON 7
  uu_8                 1.008382e-01 1 1  ON 8
  uu_9                 1.202055e-01 1 1  ON 9
  ud_0                 3.472436e-01 1 1  ON 10
  ud_1                 9.003106e-02 1 1  ON 11
  ud_2                -1.725565e-02 1 1  ON 12
  ud_3                -7.544541e-02 1 1  ON 13
  ud_4                -1.204582e-01 1 1  ON 14
  ud_5                -1.507957e-01 1 1  ON 15
  ud_6                -1.541505e-01 1 1  ON 16
  ud_7                -1.094502e-01 1 1  ON 17
  ud_8                 5.893947e-03 1 1  ON 18
  ud_9                 9.251985e-02 1 1  ON 19
  eO_0                -7.406631e-01 1 1  ON 20
  eO_1                -4.289316e-01 1 1  ON 21
  eO_2                -3.454899e-02 1 1  ON 22
  eO_3                 2.027703e-01 1 1  ON 23
  eO_4                 2.805667e-01 1 1  ON 24
  eO_5                 3.038773e-01 1 1  ON 25
  eO_6                 2.493963e-01 1 1  ON 26
  eO_7                 1.109219e-01 1 1  ON 27
  eO_8                 2.772106e-02 1 1  ON 28
  eO_9                 1.834624e-02 1 1  ON 29
 eH1_0                -1.815026e-01 1 1  ON 30
 eH1_1                -1.020661e-01 1 1  ON 31
 eH1_2                -6.227608e-02 1 1  ON 32
 eH1_3                -2.599022e-02 1 1  ON 33
 eH1_4                 1.958109e-02 1 1  ON 34
 eH1_5                 3.565943e-02 1 1  ON 35
 eH1_6                 7.682882e-02 1 1  ON 36
 eH1_7                 1.104796e-01 1 1  ON 37
 eH1_8                 9.004214e-02 1 1  ON 38
 eH1_9                 2.407682e-02 1 1  ON 39
 eH2_0                -1.826526e-01 1 1  ON 40
 eH2_1                -1.036075e-01 1 1  ON 41
 eH2_2                -6.368058e-02 1 1  ON 42
 eH2_3                -2.765145e-02 1 1  ON 43
 eH2_4                 1.865164e-02 1 1  ON 44
 eH2_5                 3.507785e-02 1 1  ON 45
 eH2_6                 7.835320e-02 1 1  ON 46
 eH2_7                 1.139548e-01 1 1  ON 47
 eH2_8                 9.326451e-02 1 1  ON 48
 eH2_9                 2.615796e-02 1 1  ON 49
ci_001                -4.160084e-02 3 1  ON 50
ci_002                -3.016999e-02 3 1  ON 51
ci_003                -2.537397e-02 3 1  ON 52
ci_004                 2.137325e-02 3 1  ON 53
ci_005                 2.161826e-02 3 1  ON 54
ci_006                -1.882948e-02 3 1  ON 55
ci_007                -1.933252e-02 3 1  ON 56
ci_008                -1.794231e-02 3 1  ON 57
ci_009                -1.765850e-02 3 1  ON 58
ci_010                -1.793956e-02 3 1  ON 59
ci_011                -1.630678e-02 3 1  ON 60
ci_012                -1.638703e-02 3 1  ON 61
ci_013                -1.909236e-02 3 1  ON 62
ci_014                 1.379249e-02 3 1  ON 63
ci_015                 1.396327e-02 3 1  ON 64
ci_016                 1.634179e-02 3 1  ON 65
ci_017                 1.660926e-02 3 1  ON 66
ci_018                 1.262018e-02 3 1  ON 67
ci_019                 1.283973e-02 3 1  ON 68
ci_020                 1.331815e-02 3 1  ON 69
ci_021                 1.357458e-02 3 1  ON 70
ci_022                 1.173319e-02 3 1  ON 71
ci_023                 1.152317e-02 3 1  ON 72
ci_024                 1.242084e-02 3 1  ON 73
ci_025                 1.220921e-02 3 1  ON 74
ci_026                 1.110704e-02 3 1  ON 75
ci_027                 1.141217e-02 3 1  ON 76
ci_028                -1.446547e-02 3 1  ON 77
ci_029                -1.474950e-02 3 1  ON 78
ci_030                -1.095223e-02 3 1  ON 79
ci_031                -1.181697e-02 3 1  ON 80
ci_032                -1.339986e-02 3 1  ON 81
ci_033                 1.090767e-02 3 1  ON 82
ci_034                 1.073740e-02 3 1  ON 83
ci_035                -4.964824e-03 3 1  ON 84
ci_036                -1.089771e-02 3 1  ON 85
ci_037                -1.013627e-02 3 1  ON 86
ci_038                 1.633413e-03 3 1  ON 87
ci_039                 1.939508e-03 3 1  ON 88
ci_040                -4.042999e-03 3 1  ON 89
ci_041                 9.974055e-03 3 1  ON 90
ci_042                 9.738685e-03 3 1  ON 91
ci_043                -3.525795e-03 3 1  ON 92
ci_044                -1.548810e-02 3 1  ON 93
ci_045                -1.779911e-03 3 1  ON 94
ci_046                 5.270871e-03 3 1  ON 95
ci_047                 5.914447e-03 3 1  ON 96
ci_048                -1.136225e-02 3 1  ON 97
ci_049                -1.192179e-02 3 1  ON 98
ci_050                 7.572551e-03 3 1  ON 99
ci_051                 7.718243e-03 3 1  ON 100
ci_052                -6.890757e-03 3 1  ON 101
ci_053                -6.794523e-03 3 1  ON 102
ci_054                -2.890149e-03 3 1  ON 103
ci_055                -3.069690e-03 3 1  ON 104
ci_056                 4.745474e-03 3 1  ON 105
ci_057                 4.551619e-03 3 1  ON 106
ci_058                -6.833885e-03 3 1  ON 107
ci_059                -6.854843e-03 3 1  ON 108
ci_060                 8.325413e-03 3 1  ON 109
ci_061                 8.279682e-03 3 1  ON 110
ci_062                -3.034381e-03 3 1  ON 111
ci_063                -2.991778e-03 3 1  ON 112
ci_064                -3.080714e-03 3 1  ON 113
ci_065                -4.160257e-03 3 1  ON 114
ci_066                 6.041560e-03 3 1  ON 115
ci_067                 5.303323e-03 3 1  ON 116
ci_068                -5.242943e-03 3 1  ON 117
ci_069                -5.013208e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.194209
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1117e-01
  Total weights = 1.9562e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297452271977
                                         uncertainty =       0.002202619390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297452271977
                                         uncertainty =       0.002202619390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385626770
  error estimate for blocks of size 2^( 2) =       0.000395313424
  error estimate for blocks of size 2^( 3) =       0.000404389385
  error estimate for blocks of size 2^( 4) =       0.000410438158
  error estimate for blocks of size 2^( 5) =       0.000414736445
  error estimate for blocks of size 2^( 6) =       0.000417162579
  error estimate for blocks of size 2^( 7) =       0.000419283547

      target function =                  N/A
              le_mean =     -17.216759690285
             les_mean =     296.730337203256
             stat err =       0.000415405182
             autocorr =       1.160404673027
              std dev =       0.545358608791
             le_variance =       0.297416012182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297286469229
                                         uncertainty =       0.002211486839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297286469229
                                         uncertainty =       0.002211486839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385519507
  error estimate for blocks of size 2^( 2) =       0.000395208771
  error estimate for blocks of size 2^( 3) =       0.000404286110
  error estimate for blocks of size 2^( 4) =       0.000410346251
  error estimate for blocks of size 2^( 5) =       0.000414650469
  error estimate for blocks of size 2^( 6) =       0.000417091074
  error estimate for blocks of size 2^( 7) =       0.000419228451

      target function =                  N/A
              le_mean =     -17.216757118294
             les_mean =     296.728891758997
             stat err =       0.000415329061
             autocorr =       1.160625009427
              std dev =       0.545206915558
             le_variance =       0.297250580773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297296131468
                                         uncertainty =       0.002206654733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297296131468
                                         uncertainty =       0.002206654733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385525686
  error estimate for blocks of size 2^( 2) =       0.000395215310
  error estimate for blocks of size 2^( 3) =       0.000404294325
  error estimate for blocks of size 2^( 4) =       0.000410351003
  error estimate for blocks of size 2^( 5) =       0.000414653950
  error estimate for blocks of size 2^( 6) =       0.000417090763
  error estimate for blocks of size 2^( 7) =       0.000419220710

      target function =                  N/A
              le_mean =     -17.216756422443
             les_mean =     296.728357788317
             stat err =       0.000415329106
             autocorr =       1.160588057517
              std dev =       0.545215654186
             le_variance =       0.297260109570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297426379475
                                         uncertainty =       0.002203052112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297426379475
                                         uncertainty =       0.002203052112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385610005
  error estimate for blocks of size 2^( 2) =       0.000395296837
  error estimate for blocks of size 2^( 3) =       0.000404373465
  error estimate for blocks of size 2^( 4) =       0.000410423878
  error estimate for blocks of size 2^( 5) =       0.000414723704
  error estimate for blocks of size 2^( 6) =       0.000417151030
  error estimate for blocks of size 2^( 7) =       0.000419269120

      target function =                  N/A
              le_mean =     -17.216758939869
             les_mean =     296.734299972102
             stat err =       0.000415391933
             autocorr =       1.160431550069
              std dev =       0.545334899390
             le_variance =       0.297390152493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216759690285        initial  <--
     5.9605e-01     5.9605e+00             1.6794e-03       -17.216757118294
     2.3842e+00     2.3842e+01             4.3922e-04       -17.216756422443
     9.5367e+00     9.5367e+01             1.1080e-04       -17.216758939869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0082
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1784
    reference variance = 0.194414
====================================================
  Execution time = 2.1111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1383e-01
  Total weights = 1.956313496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298338801609
                                         uncertainty =       0.002040185190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298338801609
                                         uncertainty =       0.002040185190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250853
  error estimate for blocks of size 2^( 2) =       0.000396326603
  error estimate for blocks of size 2^( 3) =       0.000405550961
  error estimate for blocks of size 2^( 4) =       0.000411677164
  error estimate for blocks of size 2^( 5) =       0.000416009217
  error estimate for blocks of size 2^( 6) =       0.000417904801
  error estimate for blocks of size 2^( 7) =       0.000420040218

      target function =                  N/A
              le_mean =     -17.216134219695
             les_mean =     296.709107690978
             stat err =       0.000416407850
             autocorr =       1.162248284406
              std dev =       0.546241194182
             le_variance =       0.298379442222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613421970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134219716       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216135520960       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216135671593       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216136012099       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216136302038       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216135967115       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216136158467       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216136143944       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216136144669       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216136128366       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216136129906       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+00 is 1.941448e-04

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134219716       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134554127       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216134593958       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216134683053       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216134757709       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216134671774       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216134718422       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216134715691       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216134716460       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216134711916       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+01 is 4.866548e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134219716       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134303907       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216134314008       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216134336546       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216134355349       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216134333725       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216134345320       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216134344678       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216134344916       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216134343755       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+01 is 1.218388e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7200e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.036902e-01 1 1  ON 0
  uu_1                 4.370738e-02 1 1  ON 1
  uu_2                -4.751515e-02 1 1  ON 2
  uu_3                -9.904555e-02 1 1  ON 3
  uu_4                -1.294268e-01 1 1  ON 4
  uu_5                -1.342315e-01 1 1  ON 5
  uu_6                -1.118910e-01 1 1  ON 6
  uu_7                -3.804372e-02 1 1  ON 7
  uu_8                 1.008630e-01 1 1  ON 8
  uu_9                 1.201867e-01 1 1  ON 9
  ud_0                 3.471203e-01 1 1  ON 10
  ud_1                 8.999210e-02 1 1  ON 11
  ud_2                -1.726956e-02 1 1  ON 12
  ud_3                -7.538652e-02 1 1  ON 13
  ud_4                -1.203989e-01 1 1  ON 14
  ud_5                -1.507974e-01 1 1  ON 15
  ud_6                -1.541535e-01 1 1  ON 16
  ud_7                -1.094151e-01 1 1  ON 17
  ud_8                 5.943171e-03 1 1  ON 18
  ud_9                 9.251972e-02 1 1  ON 19
  eO_0                -7.402726e-01 1 1  ON 20
  eO_1                -4.286758e-01 1 1  ON 21
  eO_2                -3.455297e-02 1 1  ON 22
  eO_3                 2.025230e-01 1 1  ON 23
  eO_4                 2.802804e-01 1 1  ON 24
  eO_5                 3.038426e-01 1 1  ON 25
  eO_6                 2.493770e-01 1 1  ON 26
  eO_7                 1.108807e-01 1 1  ON 27
  eO_8                 2.771220e-02 1 1  ON 28
  eO_9                 1.834460e-02 1 1  ON 29
 eH1_0                -1.814902e-01 1 1  ON 30
 eH1_1                -1.020748e-01 1 1  ON 31
 eH1_2                -6.229985e-02 1 1  ON 32
 eH1_3                -2.601336e-02 1 1  ON 33
 eH1_4                 1.959095e-02 1 1  ON 34
 eH1_5                 3.568826e-02 1 1  ON 35
 eH1_6                 7.685584e-02 1 1  ON 36
 eH1_7                 1.104924e-01 1 1  ON 37
 eH1_8                 9.001654e-02 1 1  ON 38
 eH1_9                 2.406912e-02 1 1  ON 39
 eH2_0                -1.826287e-01 1 1  ON 40
 eH2_1                -1.036037e-01 1 1  ON 41
 eH2_2                -6.369119e-02 1 1  ON 42
 eH2_3                -2.766576e-02 1 1  ON 43
 eH2_4                 1.867273e-02 1 1  ON 44
 eH2_5                 3.506583e-02 1 1  ON 45
 eH2_6                 7.835890e-02 1 1  ON 46
 eH2_7                 1.139678e-01 1 1  ON 47
 eH2_8                 9.324475e-02 1 1  ON 48
 eH2_9                 2.615076e-02 1 1  ON 49
ci_001                -4.168430e-02 3 1  ON 50
ci_002                -3.011155e-02 3 1  ON 51
ci_003                -2.528853e-02 3 1  ON 52
ci_004                 2.147597e-02 3 1  ON 53
ci_005                 2.162382e-02 3 1  ON 54
ci_006                -1.877217e-02 3 1  ON 55
ci_007                -1.931500e-02 3 1  ON 56
ci_008                -1.805506e-02 3 1  ON 57
ci_009                -1.763134e-02 3 1  ON 58
ci_010                -1.789793e-02 3 1  ON 59
ci_011                -1.637386e-02 3 1  ON 60
ci_012                -1.648424e-02 3 1  ON 61
ci_013                -1.900535e-02 3 1  ON 62
ci_014                 1.377142e-02 3 1  ON 63
ci_015                 1.398497e-02 3 1  ON 64
ci_016                 1.632015e-02 3 1  ON 65
ci_017                 1.654438e-02 3 1  ON 66
ci_018                 1.257669e-02 3 1  ON 67
ci_019                 1.289024e-02 3 1  ON 68
ci_020                 1.325385e-02 3 1  ON 69
ci_021                 1.360111e-02 3 1  ON 70
ci_022                 1.178174e-02 3 1  ON 71
ci_023                 1.151051e-02 3 1  ON 72
ci_024                 1.253050e-02 3 1  ON 73
ci_025                 1.222029e-02 3 1  ON 74
ci_026                 1.110807e-02 3 1  ON 75
ci_027                 1.151923e-02 3 1  ON 76
ci_028                -1.445010e-02 3 1  ON 77
ci_029                -1.475483e-02 3 1  ON 78
ci_030                -1.102417e-02 3 1  ON 79
ci_031                -1.177920e-02 3 1  ON 80
ci_032                -1.333972e-02 3 1  ON 81
ci_033                 1.087728e-02 3 1  ON 82
ci_034                 1.077428e-02 3 1  ON 83
ci_035                -4.992805e-03 3 1  ON 84
ci_036                -1.089141e-02 3 1  ON 85
ci_037                -1.029506e-02 3 1  ON 86
ci_038                 1.619819e-03 3 1  ON 87
ci_039                 1.971234e-03 3 1  ON 88
ci_040                -4.119628e-03 3 1  ON 89
ci_041                 1.001775e-02 3 1  ON 90
ci_042                 9.730877e-03 3 1  ON 91
ci_043                -3.581185e-03 3 1  ON 92
ci_044                -1.543484e-02 3 1  ON 93
ci_045                -1.671849e-03 3 1  ON 94
ci_046                 5.217410e-03 3 1  ON 95
ci_047                 5.910631e-03 3 1  ON 96
ci_048                -1.129689e-02 3 1  ON 97
ci_049                -1.192076e-02 3 1  ON 98
ci_050                 7.732544e-03 3 1  ON 99
ci_051                 7.748251e-03 3 1  ON 100
ci_052                -7.011218e-03 3 1  ON 101
ci_053                -6.823652e-03 3 1  ON 102
ci_054                -2.931879e-03 3 1  ON 103
ci_055                -3.083859e-03 3 1  ON 104
ci_056                 4.762409e-03 3 1  ON 105
ci_057                 4.626794e-03 3 1  ON 106
ci_058                -6.912176e-03 3 1  ON 107
ci_059                -6.880674e-03 3 1  ON 108
ci_060                 8.383569e-03 3 1  ON 109
ci_061                 8.246971e-03 3 1  ON 110
ci_062                -3.032325e-03 3 1  ON 111
ci_063                -3.006743e-03 3 1  ON 112
ci_064                -2.987916e-03 3 1  ON 113
ci_065                -4.128675e-03 3 1  ON 114
ci_066                 6.031327e-03 3 1  ON 115
ci_067                 5.246652e-03 3 1  ON 116
ci_068                -5.348381e-03 3 1  ON 117
ci_069                -5.099456e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.36359
====================================================
  Execution time = 2.0834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1417e-01
  Total weights = 1.9564e+06
  Execution time = 1.8166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298390055215
                                         uncertainty =       0.002187563795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298390055215
                                         uncertainty =       0.002187563795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386256063
  error estimate for blocks of size 2^( 2) =       0.000396047803
  error estimate for blocks of size 2^( 3) =       0.000405772312
  error estimate for blocks of size 2^( 4) =       0.000412551831
  error estimate for blocks of size 2^( 5) =       0.000416019548
  error estimate for blocks of size 2^( 6) =       0.000417893029
  error estimate for blocks of size 2^( 7) =       0.000420453964

      target function =                  N/A
              le_mean =     -17.216114891434
             les_mean =     296.708737350125
             stat err =       0.000416729593
             autocorr =       1.164013631749
              std dev =       0.546248562197
             le_variance =       0.298387491702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412284573
                                         uncertainty =       0.002192582812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412284573
                                         uncertainty =       0.002192582812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386270450
  error estimate for blocks of size 2^( 2) =       0.000396061903
  error estimate for blocks of size 2^( 3) =       0.000405787278
  error estimate for blocks of size 2^( 4) =       0.000412567626
  error estimate for blocks of size 2^( 5) =       0.000416034202
  error estimate for blocks of size 2^( 6) =       0.000417907918
  error estimate for blocks of size 2^( 7) =       0.000420470027

      target function =                  N/A
              le_mean =     -17.216113673986
             les_mean =     296.709213628067
             stat err =       0.000416744943
             autocorr =       1.164012665307
              std dev =       0.546268909738
             le_variance =       0.298409721746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298400837707
                                         uncertainty =       0.002190162115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298400837707
                                         uncertainty =       0.002190162115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386263042
  error estimate for blocks of size 2^( 2) =       0.000396054659
  error estimate for blocks of size 2^( 3) =       0.000405779667
  error estimate for blocks of size 2^( 4) =       0.000412559643
  error estimate for blocks of size 2^( 5) =       0.000416026768
  error estimate for blocks of size 2^( 6) =       0.000417900418
  error estimate for blocks of size 2^( 7) =       0.000420461981

      target function =                  N/A
              le_mean =     -17.216114231374
             les_mean =     296.708862833008
             stat err =       0.000416737203
             autocorr =       1.164014075537
              std dev =       0.546258432214
             le_variance =       0.298398274765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298391371024
                                         uncertainty =       0.002187890062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298391371024
                                         uncertainty =       0.002187890062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386256914
  error estimate for blocks of size 2^( 2) =       0.000396048639
  error estimate for blocks of size 2^( 3) =       0.000405773211
  error estimate for blocks of size 2^( 4) =       0.000412552790
  error estimate for blocks of size 2^( 5) =       0.000416020431
  error estimate for blocks of size 2^( 6) =       0.000417893929
  error estimate for blocks of size 2^( 7) =       0.000420454947

      target function =                  N/A
              le_mean =     -17.216114802973
             les_mean =     296.708743183714
             stat err =       0.000416730524
             autocorr =       1.164013699082
              std dev =       0.546249766645
             le_variance =       0.298388807560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216114891434        initial  <--
     5.9605e+00     5.9605e+01             1.9414e-04       -17.216113673986
     2.3842e+01     2.3842e+02             4.8665e-05       -17.216114231374
     9.5367e+01     9.5367e+02             1.2184e-05       -17.216114802973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1311
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2987
    reference variance = 0.290305
====================================================
  Execution time = 2.0995e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1385e-01
  Total weights = 1.956592702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297750568383
                                         uncertainty =       0.003736884635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297750568383
                                         uncertainty =       0.003736884635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385872944
  error estimate for blocks of size 2^( 2) =       0.000395871449
  error estimate for blocks of size 2^( 3) =       0.000405039114
  error estimate for blocks of size 2^( 4) =       0.000411640891
  error estimate for blocks of size 2^( 5) =       0.000415038500
  error estimate for blocks of size 2^( 6) =       0.000417365356
  error estimate for blocks of size 2^( 7) =       0.000416786223

      target function =                  N/A
              le_mean =     -17.215654194267
             les_mean =     296.692597186299
             stat err =       0.000415207742
             autocorr =       1.157823150406
              std dev =       0.545706751116
             le_variance =       0.297795858214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721565419427e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215654194282       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215654252506       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215654245287       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215654286046       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215654261820       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215654275887       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215654274286       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215654277513       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215654283439       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215654283501       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+01 is 1.703999e-05

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215654194282       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215654208885       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215654207072       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215654217229       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215654211148       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215654214709       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215654214305       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215654215092       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215654216569       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215654216590       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+02 is 4.259905e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215654194282       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215654197936       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215654197482       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215654200019       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215654198497       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215654199390       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215654199289       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215654199483       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215654199852       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215654199856       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+02 is 1.064969e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232412 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6905e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.036802e-01 1 1  ON 0
  uu_1                 4.370061e-02 1 1  ON 1
  uu_2                -4.751518e-02 1 1  ON 2
  uu_3                -9.904470e-02 1 1  ON 3
  uu_4                -1.294218e-01 1 1  ON 4
  uu_5                -1.342283e-01 1 1  ON 5
  uu_6                -1.118898e-01 1 1  ON 6
  uu_7                -3.803753e-02 1 1  ON 7
  uu_8                 1.008669e-01 1 1  ON 8
  uu_9                 1.201849e-01 1 1  ON 9
  ud_0                 3.471073e-01 1 1  ON 10
  ud_1                 8.998315e-02 1 1  ON 11
  ud_2                -1.727335e-02 1 1  ON 12
  ud_3                -7.538237e-02 1 1  ON 13
  ud_4                -1.203887e-01 1 1  ON 14
  ud_5                -1.507896e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094147e-01 1 1  ON 17
  ud_8                 5.948282e-03 1 1  ON 18
  ud_9                 9.251992e-02 1 1  ON 19
  eO_0                -7.402282e-01 1 1  ON 20
  eO_1                -4.286512e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024928e-01 1 1  ON 23
  eO_4                 2.802473e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108767e-01 1 1  ON 27
  eO_8                 2.771133e-02 1 1  ON 28
  eO_9                 1.834437e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020710e-01 1 1  ON 31
 eH1_2                -6.230078e-02 1 1  ON 32
 eH1_3                -2.601363e-02 1 1  ON 33
 eH1_4                 1.958770e-02 1 1  ON 34
 eH1_5                 3.568229e-02 1 1  ON 35
 eH1_6                 7.685539e-02 1 1  ON 36
 eH1_7                 1.104948e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406852e-02 1 1  ON 39
 eH2_0                -1.826251e-01 1 1  ON 40
 eH2_1                -1.036003e-01 1 1  ON 41
 eH2_2                -6.368923e-02 1 1  ON 42
 eH2_3                -2.766777e-02 1 1  ON 43
 eH2_4                 1.867307e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835857e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324190e-02 1 1  ON 48
 eH2_9                 2.614980e-02 1 1  ON 49
ci_001                -4.170728e-02 3 1  ON 50
ci_002                -3.012155e-02 3 1  ON 51
ci_003                -2.528673e-02 3 1  ON 52
ci_004                 2.147605e-02 3 1  ON 53
ci_005                 2.161970e-02 3 1  ON 54
ci_006                -1.879077e-02 3 1  ON 55
ci_007                -1.932188e-02 3 1  ON 56
ci_008                -1.805266e-02 3 1  ON 57
ci_009                -1.762769e-02 3 1  ON 58
ci_010                -1.791526e-02 3 1  ON 59
ci_011                -1.637514e-02 3 1  ON 60
ci_012                -1.648139e-02 3 1  ON 61
ci_013                -1.900009e-02 3 1  ON 62
ci_014                 1.376860e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631858e-02 3 1  ON 65
ci_017                 1.654858e-02 3 1  ON 66
ci_018                 1.257155e-02 3 1  ON 67
ci_019                 1.289846e-02 3 1  ON 68
ci_020                 1.326262e-02 3 1  ON 69
ci_021                 1.359704e-02 3 1  ON 70
ci_022                 1.177281e-02 3 1  ON 71
ci_023                 1.151054e-02 3 1  ON 72
ci_024                 1.252553e-02 3 1  ON 73
ci_025                 1.222908e-02 3 1  ON 74
ci_026                 1.110220e-02 3 1  ON 75
ci_027                 1.152057e-02 3 1  ON 76
ci_028                -1.444774e-02 3 1  ON 77
ci_029                -1.476221e-02 3 1  ON 78
ci_030                -1.102867e-02 3 1  ON 79
ci_031                -1.177306e-02 3 1  ON 80
ci_032                -1.332771e-02 3 1  ON 81
ci_033                 1.088306e-02 3 1  ON 82
ci_034                 1.077935e-02 3 1  ON 83
ci_035                -4.995124e-03 3 1  ON 84
ci_036                -1.089515e-02 3 1  ON 85
ci_037                -1.030011e-02 3 1  ON 86
ci_038                 1.622243e-03 3 1  ON 87
ci_039                 1.980610e-03 3 1  ON 88
ci_040                -4.114751e-03 3 1  ON 89
ci_041                 1.002126e-02 3 1  ON 90
ci_042                 9.731419e-03 3 1  ON 91
ci_043                -3.585736e-03 3 1  ON 92
ci_044                -1.543107e-02 3 1  ON 93
ci_045                -1.673539e-03 3 1  ON 94
ci_046                 5.223912e-03 3 1  ON 95
ci_047                 5.915568e-03 3 1  ON 96
ci_048                -1.129119e-02 3 1  ON 97
ci_049                -1.192730e-02 3 1  ON 98
ci_050                 7.726776e-03 3 1  ON 99
ci_051                 7.750186e-03 3 1  ON 100
ci_052                -7.012505e-03 3 1  ON 101
ci_053                -6.824357e-03 3 1  ON 102
ci_054                -2.930923e-03 3 1  ON 103
ci_055                -3.081938e-03 3 1  ON 104
ci_056                 4.766427e-03 3 1  ON 105
ci_057                 4.623550e-03 3 1  ON 106
ci_058                -6.911950e-03 3 1  ON 107
ci_059                -6.879176e-03 3 1  ON 108
ci_060                 8.400271e-03 3 1  ON 109
ci_061                 8.234769e-03 3 1  ON 110
ci_062                -3.044963e-03 3 1  ON 111
ci_063                -3.004420e-03 3 1  ON 112
ci_064                -2.988757e-03 3 1  ON 113
ci_065                -4.121931e-03 3 1  ON 114
ci_066                 6.045770e-03 3 1  ON 115
ci_067                 5.240898e-03 3 1  ON 116
ci_068                -5.350441e-03 3 1  ON 117
ci_069                -5.112608e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1662
    reference variance = 0.262905
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0963e-01
  Total weights = 1.9566e+06
  Execution time = 1.9043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297028238724
                                         uncertainty =       0.002397979278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297028238724
                                         uncertainty =       0.002397979278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385485807
  error estimate for blocks of size 2^( 2) =       0.000395732287
  error estimate for blocks of size 2^( 3) =       0.000404795881
  error estimate for blocks of size 2^( 4) =       0.000411988335
  error estimate for blocks of size 2^( 5) =       0.000416244718
  error estimate for blocks of size 2^( 6) =       0.000418550841
  error estimate for blocks of size 2^( 7) =       0.000419942677

      target function =                  N/A
              le_mean =     -17.217330722490
             les_mean =     296.746102000707
             stat err =       0.000416681643
             autocorr =       1.168401082521
              std dev =       0.545159255884
             le_variance =       0.297198614276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297026192641
                                         uncertainty =       0.002397949690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297026192641
                                         uncertainty =       0.002397949690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385484469
  error estimate for blocks of size 2^( 2) =       0.000395730872
  error estimate for blocks of size 2^( 3) =       0.000404794364
  error estimate for blocks of size 2^( 4) =       0.000411986853
  error estimate for blocks of size 2^( 5) =       0.000416243104
  error estimate for blocks of size 2^( 6) =       0.000418549089
  error estimate for blocks of size 2^( 7) =       0.000419941174

      target function =                  N/A
              le_mean =     -17.217330613865
             les_mean =     296.746103396751
             stat err =       0.000416680055
             autocorr =       1.168400287749
              std dev =       0.545157363736
             le_variance =       0.297196551235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297027207593
                                         uncertainty =       0.002397964378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297027207593
                                         uncertainty =       0.002397964378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385485132
  error estimate for blocks of size 2^( 2) =       0.000395731574
  error estimate for blocks of size 2^( 3) =       0.000404795117
  error estimate for blocks of size 2^( 4) =       0.000411987588
  error estimate for blocks of size 2^( 5) =       0.000416243906
  error estimate for blocks of size 2^( 6) =       0.000418549960
  error estimate for blocks of size 2^( 7) =       0.000419941921

      target function =                  N/A
              le_mean =     -17.217330667635
             les_mean =     296.746102469339
             stat err =       0.000416680844
             autocorr =       1.168400688295
              std dev =       0.545158302371
             le_variance =       0.297197574645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297028109399
                                         uncertainty =       0.002397977409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297028109399
                                         uncertainty =       0.002397977409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385485722
  error estimate for blocks of size 2^( 2) =       0.000395732197
  error estimate for blocks of size 2^( 3) =       0.000404795785
  error estimate for blocks of size 2^( 4) =       0.000411988241
  error estimate for blocks of size 2^( 5) =       0.000416244616
  error estimate for blocks of size 2^( 6) =       0.000418550731
  error estimate for blocks of size 2^( 7) =       0.000419942582

      target function =                  N/A
              le_mean =     -17.217330715592
             les_mean =     296.746102035527
             stat err =       0.000416681542
             autocorr =       1.168401033355
              std dev =       0.545159136297
             le_variance =       0.297198483888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217330722490        initial  <--
     5.9605e+01     5.9605e+02             1.7040e-05       -17.217330613865
     2.3842e+02     2.3842e+03             4.2599e-06       -17.217330667635
     9.5367e+02     9.5367e+03             1.0650e-06       -17.217330715592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1731
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1781
    reference variance = 0.155424
====================================================
  Execution time = 2.1134e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1448e-01
  Total weights = 1.956735490e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299620603859
                                         uncertainty =       0.001919576728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299620603859
                                         uncertainty =       0.001919576728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387054337
  error estimate for blocks of size 2^( 2) =       0.000396865106
  error estimate for blocks of size 2^( 3) =       0.000406189906
  error estimate for blocks of size 2^( 4) =       0.000412887789
  error estimate for blocks of size 2^( 5) =       0.000417668437
  error estimate for blocks of size 2^( 6) =       0.000419358152
  error estimate for blocks of size 2^( 7) =       0.000420898350

      target function =                  N/A
              le_mean =     -17.216498290633
             les_mean =     296.722298353464
             stat err =       0.000417703182
             autocorr =       1.164639967280
              std dev =       0.547377493390
             le_variance =       0.299622120270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649829063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216498290679       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216498298094       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216498296850       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216498294887       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216498300834       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216498301383       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216498301265       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216498301558       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216498301603       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216498301505       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+02 is 1.802203e-06

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216498290679       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216498292533       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216498292222       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216498291731       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216498293202       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216498293340       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216498293339       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216498293405       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216498293405       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216498293386       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+03 is 4.505830e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216498290679       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216498291142       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216498291065       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216498290942       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216498291314       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216498291346       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216498291344       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216498291385       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216498291372       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216498291342       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+03 is 1.126478e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7114e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.036791e-01 1 1  ON 0
  uu_1                 4.369978e-02 1 1  ON 1
  uu_2                -4.751548e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803710e-02 1 1  ON 7
  uu_8                 1.008671e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471061e-01 1 1  ON 10
  ud_1                 8.998280e-02 1 1  ON 11
  ud_2                -1.727329e-02 1 1  ON 12
  ud_3                -7.538142e-02 1 1  ON 13
  ud_4                -1.203879e-01 1 1  ON 14
  ud_5                -1.507892e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094149e-01 1 1  ON 17
  ud_8                 5.948586e-03 1 1  ON 18
  ud_9                 9.251986e-02 1 1  ON 19
  eO_0                -7.402244e-01 1 1  ON 20
  eO_1                -4.286479e-01 1 1  ON 21
  eO_2                -3.455081e-02 1 1  ON 22
  eO_3                 2.024900e-01 1 1  ON 23
  eO_4                 2.802440e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108762e-01 1 1  ON 27
  eO_8                 2.771121e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230107e-02 1 1  ON 32
 eH1_3                -2.601345e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568240e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001444e-02 1 1  ON 38
 eH1_9                 2.406841e-02 1 1  ON 39
 eH2_0                -1.826247e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368919e-02 1 1  ON 42
 eH2_3                -2.766837e-02 1 1  ON 43
 eH2_4                 1.867335e-02 1 1  ON 44
 eH2_5                 3.506260e-02 1 1  ON 45
 eH2_6                 7.835845e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324155e-02 1 1  ON 48
 eH2_9                 2.614969e-02 1 1  ON 49
ci_001                -4.170774e-02 3 1  ON 50
ci_002                -3.012096e-02 3 1  ON 51
ci_003                -2.528686e-02 3 1  ON 52
ci_004                 2.147688e-02 3 1  ON 53
ci_005                 2.161934e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932209e-02 3 1  ON 56
ci_008                -1.805350e-02 3 1  ON 57
ci_009                -1.762739e-02 3 1  ON 58
ci_010                -1.791524e-02 3 1  ON 59
ci_011                -1.637478e-02 3 1  ON 60
ci_012                -1.648163e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399703e-02 3 1  ON 64
ci_016                 1.631810e-02 3 1  ON 65
ci_017                 1.654848e-02 3 1  ON 66
ci_018                 1.257078e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326296e-02 3 1  ON 69
ci_021                 1.359750e-02 3 1  ON 70
ci_022                 1.177259e-02 3 1  ON 71
ci_023                 1.151019e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222842e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444791e-02 3 1  ON 77
ci_029                -1.476194e-02 3 1  ON 78
ci_030                -1.102878e-02 3 1  ON 79
ci_031                -1.177368e-02 3 1  ON 80
ci_032                -1.332785e-02 3 1  ON 81
ci_033                 1.088324e-02 3 1  ON 82
ci_034                 1.077963e-02 3 1  ON 83
ci_035                -4.996112e-03 3 1  ON 84
ci_036                -1.089537e-02 3 1  ON 85
ci_037                -1.029948e-02 3 1  ON 86
ci_038                 1.621955e-03 3 1  ON 87
ci_039                 1.980990e-03 3 1  ON 88
ci_040                -4.114838e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730933e-03 3 1  ON 91
ci_043                -3.586365e-03 3 1  ON 92
ci_044                -1.543133e-02 3 1  ON 93
ci_045                -1.672879e-03 3 1  ON 94
ci_046                 5.223601e-03 3 1  ON 95
ci_047                 5.916048e-03 3 1  ON 96
ci_048                -1.129098e-02 3 1  ON 97
ci_049                -1.192691e-02 3 1  ON 98
ci_050                 7.727337e-03 3 1  ON 99
ci_051                 7.751315e-03 3 1  ON 100
ci_052                -7.011554e-03 3 1  ON 101
ci_053                -6.824857e-03 3 1  ON 102
ci_054                -2.931439e-03 3 1  ON 103
ci_055                -3.081407e-03 3 1  ON 104
ci_056                 4.765850e-03 3 1  ON 105
ci_057                 4.624401e-03 3 1  ON 106
ci_058                -6.913167e-03 3 1  ON 107
ci_059                -6.879877e-03 3 1  ON 108
ci_060                 8.399844e-03 3 1  ON 109
ci_061                 8.234187e-03 3 1  ON 110
ci_062                -3.045356e-03 3 1  ON 111
ci_063                -3.004269e-03 3 1  ON 112
ci_064                -2.988383e-03 3 1  ON 113
ci_065                -4.121873e-03 3 1  ON 114
ci_066                 6.044560e-03 3 1  ON 115
ci_067                 5.241239e-03 3 1  ON 116
ci_068                -5.351266e-03 3 1  ON 117
ci_069                -5.112392e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.2468
====================================================
  Execution time = 2.0839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1427e-01
  Total weights = 1.9565e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359397617
                                         uncertainty =       0.003778136311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359397617
                                         uncertainty =       0.003778136311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388162355
  error estimate for blocks of size 2^( 2) =       0.000397814987
  error estimate for blocks of size 2^( 3) =       0.000406342097
  error estimate for blocks of size 2^( 4) =       0.000413299157
  error estimate for blocks of size 2^( 5) =       0.000417400120
  error estimate for blocks of size 2^( 6) =       0.000419245391
  error estimate for blocks of size 2^( 7) =       0.000419015475

      target function =                  N/A
              le_mean =     -17.216142188002
             les_mean =     296.709822817999
             stat err =       0.000417240036
             autocorr =       1.155433935310
              std dev =       0.548944467398
             le_variance =       0.301340028287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359261588
                                         uncertainty =       0.003778021979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359261588
                                         uncertainty =       0.003778021979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388162268
  error estimate for blocks of size 2^( 2) =       0.000397814902
  error estimate for blocks of size 2^( 3) =       0.000406342001
  error estimate for blocks of size 2^( 4) =       0.000413299070
  error estimate for blocks of size 2^( 5) =       0.000417400012
  error estimate for blocks of size 2^( 6) =       0.000419245267
  error estimate for blocks of size 2^( 7) =       0.000419015334

      target function =                  N/A
              le_mean =     -17.216142169216
             les_mean =     296.709818879534
             stat err =       0.000417239921
             autocorr =       1.155433819419
              std dev =       0.548944343714
             le_variance =       0.301339892496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359329535
                                         uncertainty =       0.003778079117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359329535
                                         uncertainty =       0.003778079117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388162312
  error estimate for blocks of size 2^( 2) =       0.000397814944
  error estimate for blocks of size 2^( 3) =       0.000406342049
  error estimate for blocks of size 2^( 4) =       0.000413299114
  error estimate for blocks of size 2^( 5) =       0.000417400066
  error estimate for blocks of size 2^( 6) =       0.000419245329
  error estimate for blocks of size 2^( 7) =       0.000419015405

      target function =                  N/A
              le_mean =     -17.216142178602
             les_mean =     296.709820770443
             stat err =       0.000417239978
             autocorr =       1.155433877368
              std dev =       0.548944405495
             le_variance =       0.301339960324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359389103
                                         uncertainty =       0.003778129161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301359389103
                                         uncertainty =       0.003778129161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388162350
  error estimate for blocks of size 2^( 2) =       0.000397814982
  error estimate for blocks of size 2^( 3) =       0.000406342091
  error estimate for blocks of size 2^( 4) =       0.000413299152
  error estimate for blocks of size 2^( 5) =       0.000417400113
  error estimate for blocks of size 2^( 6) =       0.000419245383
  error estimate for blocks of size 2^( 7) =       0.000419015466

      target function =                  N/A
              le_mean =     -17.216142186826
             les_mean =     296.709822544126
             stat err =       0.000417240028
             autocorr =       1.155433928071
              std dev =       0.548944459657
             le_variance =       0.301340019788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216142188002        initial  <--
     5.9605e+02     5.9605e+03             1.8022e-06       -17.216142169216
     2.3842e+03     2.3842e+04             4.5058e-07       -17.216142178602
     9.5367e+03     9.5367e+04             1.1265e-07       -17.216142186826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0680
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2062
    reference variance = 0.205655
====================================================
  Execution time = 2.0982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1507e-01
  Total weights = 1.956518503e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298958895260
                                         uncertainty =       0.002423408962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298958895260
                                         uncertainty =       0.002423408962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386607051
  error estimate for blocks of size 2^( 2) =       0.000396502435
  error estimate for blocks of size 2^( 3) =       0.000405440581
  error estimate for blocks of size 2^( 4) =       0.000412330170
  error estimate for blocks of size 2^( 5) =       0.000416443734
  error estimate for blocks of size 2^( 6) =       0.000418886815
  error estimate for blocks of size 2^( 7) =       0.000420410013

      target function =                  N/A
              le_mean =     -17.216412597854
             les_mean =     296.719929090303
             stat err =       0.000417017683
             autocorr =       1.163508073001
              std dev =       0.546744934661
             le_variance =       0.298930023577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641259785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412597872       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412598379       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412598317       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216412598415       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216412598120       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216412598489       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216412598602       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216412598631       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216412598629       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216412598619       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+03 is 1.751604e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412597872       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412597999       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412597984       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216412598008       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216412597931       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216412598007       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216412598041       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216412598082       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216412598087       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216412598149       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+04 is 4.379020e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412597872       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412597904       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412597900       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216412597906       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216412597802       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216412597893       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216412597899       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216412597892       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216412597721       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216412597754       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+04 is 1.094755e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7025e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751548e-02 1 1  ON 2
  uu_3                -9.904431e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803705e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948645e-03 1 1  ON 18
  ud_9                 9.251986e-02 1 1  ON 19
  eO_0                -7.402240e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024898e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826247e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170790e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805350e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376912e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151018e-02 3 1  ON 72
ci_024                 1.252641e-02 3 1  ON 73
ci_025                 1.222847e-02 3 1  ON 74
ci_026                 1.110275e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476205e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996164e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029947e-02 3 1  ON 86
ci_038                 1.621998e-03 3 1  ON 87
ci_039                 1.981009e-03 3 1  ON 88
ci_040                -4.114895e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586437e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672838e-03 3 1  ON 94
ci_046                 5.223557e-03 3 1  ON 95
ci_047                 5.916084e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751182e-03 3 1  ON 100
ci_052                -7.011582e-03 3 1  ON 101
ci_053                -6.824952e-03 3 1  ON 102
ci_054                -2.931365e-03 3 1  ON 103
ci_055                -3.081436e-03 3 1  ON 104
ci_056                 4.765898e-03 3 1  ON 105
ci_057                 4.624373e-03 3 1  ON 106
ci_058                -6.913213e-03 3 1  ON 107
ci_059                -6.879911e-03 3 1  ON 108
ci_060                 8.399823e-03 3 1  ON 109
ci_061                 8.234224e-03 3 1  ON 110
ci_062                -3.045360e-03 3 1  ON 111
ci_063                -3.004241e-03 3 1  ON 112
ci_064                -2.988325e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044689e-03 3 1  ON 115
ci_067                 5.241266e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112354e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.201
    reference variance = 0.342332
====================================================
  Execution time = 2.0678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1021e-01
  Total weights = 1.9566e+06
  Execution time = 1.8136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912670468
                                         uncertainty =       0.001815298117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912670468
                                         uncertainty =       0.001815298117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385968608
  error estimate for blocks of size 2^( 2) =       0.000395373688
  error estimate for blocks of size 2^( 3) =       0.000404175713
  error estimate for blocks of size 2^( 4) =       0.000411133958
  error estimate for blocks of size 2^( 5) =       0.000414990555
  error estimate for blocks of size 2^( 6) =       0.000417122641
  error estimate for blocks of size 2^( 7) =       0.000417737050

      target function =                  N/A
              le_mean =     -17.216983287196
             les_mean =     296.734723364994
             stat err =       0.000415246051
             autocorr =       1.157462834782
              std dev =       0.545842040099
             le_variance =       0.297943532739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912680820
                                         uncertainty =       0.001815297597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912680820
                                         uncertainty =       0.001815297597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385968615
  error estimate for blocks of size 2^( 2) =       0.000395373695
  error estimate for blocks of size 2^( 3) =       0.000404175720
  error estimate for blocks of size 2^( 4) =       0.000411133967
  error estimate for blocks of size 2^( 5) =       0.000414990563
  error estimate for blocks of size 2^( 6) =       0.000417122647
  error estimate for blocks of size 2^( 7) =       0.000417737054

      target function =                  N/A
              le_mean =     -17.216983286166
             les_mean =     296.734723251134
             stat err =       0.000415246058
             autocorr =       1.157462831274
              std dev =       0.545842049648
             le_variance =       0.297943543164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912675644
                                         uncertainty =       0.001815297857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912675644
                                         uncertainty =       0.001815297857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385968611
  error estimate for blocks of size 2^( 2) =       0.000395373691
  error estimate for blocks of size 2^( 3) =       0.000404175717
  error estimate for blocks of size 2^( 4) =       0.000411133963
  error estimate for blocks of size 2^( 5) =       0.000414990559
  error estimate for blocks of size 2^( 6) =       0.000417122644
  error estimate for blocks of size 2^( 7) =       0.000417737052

      target function =                  N/A
              le_mean =     -17.216983286681
             les_mean =     296.734723307991
             stat err =       0.000415246054
             autocorr =       1.157462833021
              std dev =       0.545842044874
             le_variance =       0.297943537952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912671115
                                         uncertainty =       0.001815298085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297912671115
                                         uncertainty =       0.001815298085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385968608
  error estimate for blocks of size 2^( 2) =       0.000395373688
  error estimate for blocks of size 2^( 3) =       0.000404175713
  error estimate for blocks of size 2^( 4) =       0.000411133959
  error estimate for blocks of size 2^( 5) =       0.000414990556
  error estimate for blocks of size 2^( 6) =       0.000417122641
  error estimate for blocks of size 2^( 7) =       0.000417737051

      target function =                  N/A
              le_mean =     -17.216983287131
             les_mean =     296.734723357861
             stat err =       0.000415246052
             autocorr =       1.157462834568
              std dev =       0.545842040696
             le_variance =       0.297943533391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216983287196        initial  <--
     5.9605e+03     5.9605e+04             1.7516e-07       -17.216983286166
     2.3842e+04     2.3842e+05             4.3790e-08       -17.216983286681
     9.5367e+04     9.5367e+05             1.0948e-08       -17.216983287131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8611
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805351e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252643e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996162e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621993e-03 3 1  ON 87
ci_039                 1.981013e-03 3 1  ON 88
ci_040                -4.114903e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730945e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223552e-03 3 1  ON 95
ci_047                 5.916091e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727273e-03 3 1  ON 99
ci_051                 7.751177e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931360e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765900e-03 3 1  ON 105
ci_057                 4.624372e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879902e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045357e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121897e-03 3 1  ON 114
ci_066                 6.044690e-03 3 1  ON 115
ci_067                 5.241257e-03 3 1  ON 116
ci_068                -5.351284e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.282196
====================================================
  Execution time = 2.0700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2381e-01
  Total weights = 1.956677841e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302338232928
                                         uncertainty =       0.002620695840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302338232928
                                         uncertainty =       0.002620695840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388761409
  error estimate for blocks of size 2^( 2) =       0.000398882191
  error estimate for blocks of size 2^( 3) =       0.000408272425
  error estimate for blocks of size 2^( 4) =       0.000415407697
  error estimate for blocks of size 2^( 5) =       0.000420093655
  error estimate for blocks of size 2^( 6) =       0.000423036893
  error estimate for blocks of size 2^( 7) =       0.000422429039

      target function =                  N/A
              le_mean =     -17.216545684849
             les_mean =     296.733255718961
             stat err =       0.000420241821
             autocorr =       1.168509489185
              std dev =       0.549791657527
             le_variance =       0.302270866686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654568485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545684874       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545684923       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545684909       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545684921       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545684914       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545684902       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545684917       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216545684988       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216545685186       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216545684830       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+04 is 2.104649e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545684874       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545684886       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545684883       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545684886       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545684804       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545684933       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545684954       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216545685192       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216545685365       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216545685252       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+05 is 5.261624e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545684874       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545684877       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545684876       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545685019       residual = 7.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545684805       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545684843       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216545684886       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216545684844       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216545684860       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216545685594       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+05 is 1.315406e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6709e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369968e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948650e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834431e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001441e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161933e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791540e-02 3 1  ON 59
ci_011                -1.637487e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899987e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152213e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332776e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996161e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621992e-03 3 1  ON 87
ci_039                 1.981012e-03 3 1  ON 88
ci_040                -4.114902e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730944e-03 3 1  ON 91
ci_043                -3.586446e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672834e-03 3 1  ON 94
ci_046                 5.223553e-03 3 1  ON 95
ci_047                 5.916090e-03 3 1  ON 96
ci_048                -1.129099e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727271e-03 3 1  ON 99
ci_051                 7.751176e-03 3 1  ON 100
ci_052                -7.011582e-03 3 1  ON 101
ci_053                -6.824951e-03 3 1  ON 102
ci_054                -2.931359e-03 3 1  ON 103
ci_055                -3.081435e-03 3 1  ON 104
ci_056                 4.765901e-03 3 1  ON 105
ci_057                 4.624371e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879901e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004233e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044688e-03 3 1  ON 115
ci_067                 5.241258e-03 3 1  ON 116
ci_068                -5.351282e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.192628
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1672e-01
  Total weights = 1.9565e+06
  Execution time = 1.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449827801
                                         uncertainty =       0.002110591039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449827801
                                         uncertainty =       0.002110591039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388843875
  error estimate for blocks of size 2^( 2) =       0.000398489833
  error estimate for blocks of size 2^( 3) =       0.000407843418
  error estimate for blocks of size 2^( 4) =       0.000414575151
  error estimate for blocks of size 2^( 5) =       0.000417464767
  error estimate for blocks of size 2^( 6) =       0.000420542883
  error estimate for blocks of size 2^( 7) =       0.000420768673

      target function =                  N/A
              le_mean =     -17.216488867592
             les_mean =     296.724211540895
             stat err =       0.000418337868
             autocorr =       1.157454248194
              std dev =       0.549908281536
             le_variance =       0.302399118101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449823672
                                         uncertainty =       0.002110591020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449823672
                                         uncertainty =       0.002110591020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388843872
  error estimate for blocks of size 2^( 2) =       0.000398489831
  error estimate for blocks of size 2^( 3) =       0.000407843416
  error estimate for blocks of size 2^( 4) =       0.000414575149
  error estimate for blocks of size 2^( 5) =       0.000417464764
  error estimate for blocks of size 2^( 6) =       0.000420542880
  error estimate for blocks of size 2^( 7) =       0.000420768670

      target function =                  N/A
              le_mean =     -17.216488867635
             les_mean =     296.724211534972
             stat err =       0.000418337866
             autocorr =       1.157454251453
              std dev =       0.549908277786
             le_variance =       0.302399113977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449825736
                                         uncertainty =       0.002110591030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449825736
                                         uncertainty =       0.002110591030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388843874
  error estimate for blocks of size 2^( 2) =       0.000398489832
  error estimate for blocks of size 2^( 3) =       0.000407843417
  error estimate for blocks of size 2^( 4) =       0.000414575150
  error estimate for blocks of size 2^( 5) =       0.000417464765
  error estimate for blocks of size 2^( 6) =       0.000420542881
  error estimate for blocks of size 2^( 7) =       0.000420768672

      target function =                  N/A
              le_mean =     -17.216488867613
             les_mean =     296.724211537933
             stat err =       0.000418337867
             autocorr =       1.157454249821
              std dev =       0.549908279661
             le_variance =       0.302399116039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449827543
                                         uncertainty =       0.002110591038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302449827543
                                         uncertainty =       0.002110591038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388843875
  error estimate for blocks of size 2^( 2) =       0.000398489833
  error estimate for blocks of size 2^( 3) =       0.000407843418
  error estimate for blocks of size 2^( 4) =       0.000414575151
  error estimate for blocks of size 2^( 5) =       0.000417464766
  error estimate for blocks of size 2^( 6) =       0.000420542882
  error estimate for blocks of size 2^( 7) =       0.000420768673

      target function =                  N/A
              le_mean =     -17.216488867594
             les_mean =     296.724211540525
             stat err =       0.000418337868
             autocorr =       1.157454248386
              std dev =       0.549908281301
             le_variance =       0.302399117844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216488867592        initial
     5.9605e+04     5.9605e+05             2.1046e-08       -17.216488867635  <--
     2.3842e+05     2.3842e+06             5.2616e-09       -17.216488867613
     9.5367e+05     9.5367e+06             1.3154e-09       -17.216488867594

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.0097e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948649e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621989e-03 3 1  ON 87
ci_039                 1.981012e-03 3 1  ON 88
ci_040                -4.114897e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730942e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223553e-03 3 1  ON 95
ci_047                 5.916088e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727267e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011581e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931358e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765903e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913218e-03 3 1  ON 107
ci_059                -6.879900e-03 3 1  ON 108
ci_060                 8.399823e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045359e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988324e-03 3 1  ON 113
ci_065                -4.121894e-03 3 1  ON 114
ci_066                 6.044681e-03 3 1  ON 115
ci_067                 5.241259e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6812e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1775
    reference variance = 0.263544
====================================================
  Execution time = 2.1039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0978e-01
  Total weights = 1.956431716e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295602205770
                                         uncertainty =       0.001606946616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295602205770
                                         uncertainty =       0.001606946616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384420235
  error estimate for blocks of size 2^( 2) =       0.000394349842
  error estimate for blocks of size 2^( 3) =       0.000403797470
  error estimate for blocks of size 2^( 4) =       0.000410694146
  error estimate for blocks of size 2^( 5) =       0.000414787402
  error estimate for blocks of size 2^( 6) =       0.000416139078
  error estimate for blocks of size 2^( 7) =       0.000416632446

      target function =                  N/A
              le_mean =     -17.216490928653
             les_mean =     296.717343673217
             stat err =       0.000414563268
             autocorr =       1.162971732097
              std dev =       0.543652310242
             le_variance =       0.295557834431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649092865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490928716       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490929061       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490929191       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490929302       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216490929365       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216490929395       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216490929396       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216490929412       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216490929385       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216490929394       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+04 is 7.139211e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490928716       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490928803       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490928835       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490928862       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216490928861       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216490928924       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216490928887       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216490928819       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216490928888       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216490928647       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+04 is 1.784806e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216490928716       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216490928738       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216490928746       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216490928753       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216490928742       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216490928705       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216490928776       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216490928738       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216490929193       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216490928633       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+05 is 4.462015e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7025e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948647e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402240e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170790e-02 3 1  ON 50
ci_002                -3.012094e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932206e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222847e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102884e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077971e-02 3 1  ON 83
ci_035                -4.996158e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621990e-03 3 1  ON 87
ci_039                 1.981010e-03 3 1  ON 88
ci_040                -4.114897e-03 3 1  ON 89
ci_041                 1.002121e-02 3 1  ON 90
ci_042                 9.730943e-03 3 1  ON 91
ci_043                -3.586441e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672837e-03 3 1  ON 94
ci_046                 5.223555e-03 3 1  ON 95
ci_047                 5.916089e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727267e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011583e-03 3 1  ON 101
ci_053                -6.824952e-03 3 1  ON 102
ci_054                -2.931359e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765903e-03 3 1  ON 105
ci_057                 4.624371e-03 3 1  ON 106
ci_058                -6.913221e-03 3 1  ON 107
ci_059                -6.879896e-03 3 1  ON 108
ci_060                 8.399821e-03 3 1  ON 109
ci_061                 8.234222e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004237e-03 3 1  ON 112
ci_064                -2.988321e-03 3 1  ON 113
ci_065                -4.121894e-03 3 1  ON 114
ci_066                 6.044681e-03 3 1  ON 115
ci_067                 5.241263e-03 3 1  ON 116
ci_068                -5.351277e-03 3 1  ON 117
ci_069                -5.112361e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1675
    reference variance = 0.263171
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1566e-01
  Total weights = 1.9566e+06
  Execution time = 1.8164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939985237
                                         uncertainty =       0.001899907661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939985237
                                         uncertainty =       0.001899907661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388496535
  error estimate for blocks of size 2^( 2) =       0.000398715078
  error estimate for blocks of size 2^( 3) =       0.000407935562
  error estimate for blocks of size 2^( 4) =       0.000415200578
  error estimate for blocks of size 2^( 5) =       0.000419956145
  error estimate for blocks of size 2^( 6) =       0.000420790474
  error estimate for blocks of size 2^( 7) =       0.000421815497

      target function =                  N/A
              le_mean =     -17.216741503419
             les_mean =     296.731849702429
             stat err =       0.000419440673
             autocorr =       1.165646288420
              std dev =       0.549417068350
             le_variance =       0.301859114995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939989189
                                         uncertainty =       0.001899907568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939989189
                                         uncertainty =       0.001899907568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388496537
  error estimate for blocks of size 2^( 2) =       0.000398715081
  error estimate for blocks of size 2^( 3) =       0.000407935564
  error estimate for blocks of size 2^( 4) =       0.000415200581
  error estimate for blocks of size 2^( 5) =       0.000419956147
  error estimate for blocks of size 2^( 6) =       0.000420790476
  error estimate for blocks of size 2^( 7) =       0.000421815499

      target function =                  N/A
              le_mean =     -17.216741502994
             les_mean =     296.731849764392
             stat err =       0.000419440676
             autocorr =       1.165646286079
              std dev =       0.549417071943
             le_variance =       0.301859118942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939987213
                                         uncertainty =       0.001899907615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939987213
                                         uncertainty =       0.001899907615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388496536
  error estimate for blocks of size 2^( 2) =       0.000398715080
  error estimate for blocks of size 2^( 3) =       0.000407935563
  error estimate for blocks of size 2^( 4) =       0.000415200580
  error estimate for blocks of size 2^( 5) =       0.000419956146
  error estimate for blocks of size 2^( 6) =       0.000420790475
  error estimate for blocks of size 2^( 7) =       0.000421815498

      target function =                  N/A
              le_mean =     -17.216741503207
             les_mean =     296.731849733385
             stat err =       0.000419440675
             autocorr =       1.165646287244
              std dev =       0.549417070146
             le_variance =       0.301859116968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939985484
                                         uncertainty =       0.001899907655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301939985484
                                         uncertainty =       0.001899907655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388496535
  error estimate for blocks of size 2^( 2) =       0.000398715079
  error estimate for blocks of size 2^( 3) =       0.000407935562
  error estimate for blocks of size 2^( 4) =       0.000415200578
  error estimate for blocks of size 2^( 5) =       0.000419956145
  error estimate for blocks of size 2^( 6) =       0.000420790474
  error estimate for blocks of size 2^( 7) =       0.000421815497

      target function =                  N/A
              le_mean =     -17.216741503393
             les_mean =     296.731849706296
             stat err =       0.000419440674
             autocorr =       1.165646288272
              std dev =       0.549417068575
             le_variance =       0.301859115241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216741503419        initial  <--
     1.4901e+04     1.4901e+05             7.1392e-08       -17.216741502994
     5.9605e+04     5.9605e+05             1.7848e-08       -17.216741503207
     2.3842e+05     2.3842e+06             4.4620e-09       -17.216741503393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0207
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948649e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326290e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621989e-03 3 1  ON 87
ci_039                 1.981012e-03 3 1  ON 88
ci_040                -4.114897e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730942e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223553e-03 3 1  ON 95
ci_047                 5.916088e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727267e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011581e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931358e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765903e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913218e-03 3 1  ON 107
ci_059                -6.879900e-03 3 1  ON 108
ci_060                 8.399823e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045359e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988324e-03 3 1  ON 113
ci_065                -4.121894e-03 3 1  ON 114
ci_066                 6.044681e-03 3 1  ON 115
ci_067                 5.241259e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.182978
====================================================
  Execution time = 2.0859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1563e-01
  Total weights = 1.956750247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302208838212
                                         uncertainty =       0.003071327654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302208838212
                                         uncertainty =       0.003071327654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388708448
  error estimate for blocks of size 2^( 2) =       0.000398184310
  error estimate for blocks of size 2^( 3) =       0.000407357824
  error estimate for blocks of size 2^( 4) =       0.000414636356
  error estimate for blocks of size 2^( 5) =       0.000417672618
  error estimate for blocks of size 2^( 6) =       0.000420259977
  error estimate for blocks of size 2^( 7) =       0.000421625168

      target function =                  N/A
              le_mean =     -17.216743231617
             les_mean =     296.731875845800
             stat err =       0.000418548530
             autocorr =       1.159427728514
              std dev =       0.549716758682
             le_variance =       0.302188514776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674323162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743231636       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743231700       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743231698       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743231672       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743231202       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743231710       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743231886       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216743231240       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216743231824       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216743232761       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+05 is 8.362717e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743231636       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743231652       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743231652       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743231653       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743231656       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743231752       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743231470       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216743232156       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216743232099       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216743232754       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+05 is 2.090680e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216743231636       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216743231640       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216743231640       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216743231641       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216743231962       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743233151       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216743229438       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216743231406       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216743231697       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216743231571       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+06 is 5.226701e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6881e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506255e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177359e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088320e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621989e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114897e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730942e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223553e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727267e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765903e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913218e-03 3 1  ON 107
ci_059                -6.879900e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045359e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988323e-03 3 1  ON 113
ci_065                -4.121894e-03 3 1  ON 114
ci_066                 6.044680e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2982
    reference variance = 0.205503
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1203e-01
  Total weights = 1.9565e+06
  Execution time = 1.8244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516488341
                                         uncertainty =       0.002329449028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516488341
                                         uncertainty =       0.002329449028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385702774
  error estimate for blocks of size 2^( 2) =       0.000395850090
  error estimate for blocks of size 2^( 3) =       0.000404973222
  error estimate for blocks of size 2^( 4) =       0.000411496928
  error estimate for blocks of size 2^( 5) =       0.000415033103
  error estimate for blocks of size 2^( 6) =       0.000416895243
  error estimate for blocks of size 2^( 7) =       0.000417393638

      target function =                  N/A
              le_mean =     -17.216205937788
             les_mean =     296.709778081637
             stat err =       0.000415204728
             autocorr =       1.158828199897
              std dev =       0.545466094312
             le_variance =       0.297533260044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516487420
                                         uncertainty =       0.002329448906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516487420
                                         uncertainty =       0.002329448906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385702774
  error estimate for blocks of size 2^( 2) =       0.000395850089
  error estimate for blocks of size 2^( 3) =       0.000404973222
  error estimate for blocks of size 2^( 4) =       0.000411496927
  error estimate for blocks of size 2^( 5) =       0.000415033103
  error estimate for blocks of size 2^( 6) =       0.000416895243
  error estimate for blocks of size 2^( 7) =       0.000417393638

      target function =                  N/A
              le_mean =     -17.216205937793
             les_mean =     296.709778082064
             stat err =       0.000415204728
             autocorr =       1.158828201342
              std dev =       0.545466093472
             le_variance =       0.297533259127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516487881
                                         uncertainty =       0.002329448967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516487881
                                         uncertainty =       0.002329448967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385702774
  error estimate for blocks of size 2^( 2) =       0.000395850090
  error estimate for blocks of size 2^( 3) =       0.000404973222
  error estimate for blocks of size 2^( 4) =       0.000411496927
  error estimate for blocks of size 2^( 5) =       0.000415033103
  error estimate for blocks of size 2^( 6) =       0.000416895243
  error estimate for blocks of size 2^( 7) =       0.000417393638

      target function =                  N/A
              le_mean =     -17.216205937791
             les_mean =     296.709778081850
             stat err =       0.000415204728
             autocorr =       1.158828200617
              std dev =       0.545466093892
             le_variance =       0.297533259586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516488284
                                         uncertainty =       0.002329449020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297516488284
                                         uncertainty =       0.002329449020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385702774
  error estimate for blocks of size 2^( 2) =       0.000395850090
  error estimate for blocks of size 2^( 3) =       0.000404973222
  error estimate for blocks of size 2^( 4) =       0.000411496928
  error estimate for blocks of size 2^( 5) =       0.000415033103
  error estimate for blocks of size 2^( 6) =       0.000416895243
  error estimate for blocks of size 2^( 7) =       0.000417393638

      target function =                  N/A
              le_mean =     -17.216205937789
             les_mean =     296.709778081664
             stat err =       0.000415204728
             autocorr =       1.158828199982
              std dev =       0.545466094259
             le_variance =       0.297533259987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216205937788        initial
     1.4901e+05     1.4901e+06             8.3627e-09       -17.216205937793  <--
     5.9605e+05     5.9605e+06             2.0907e-09       -17.216205937791
     2.3842e+06     2.3842e+07             5.2267e-10       -17.216205937789

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 2.9987e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2775
    reference variance = 0.618299
====================================================
  Execution time = 2.2804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1254e-01
  Total weights = 1.956691332e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300092683360
                                         uncertainty =       0.002072572026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300092683360
                                         uncertainty =       0.002072572026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387385900
  error estimate for blocks of size 2^( 2) =       0.000397314198
  error estimate for blocks of size 2^( 3) =       0.000406100628
  error estimate for blocks of size 2^( 4) =       0.000412808401
  error estimate for blocks of size 2^( 5) =       0.000417209137
  error estimate for blocks of size 2^( 6) =       0.000418274115
  error estimate for blocks of size 2^( 7) =       0.000420376798

      target function =                  N/A
              le_mean =     -17.216238923765
             les_mean =     296.711424873923
             stat err =       0.000417167113
             autocorr =       1.159664890695
              std dev =       0.547846393496
             le_variance =       0.300135670866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623892376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238923768       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238923873       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216238923883       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216238923915       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216238923929       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216238923965       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216238923921       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216238923968       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216238923998       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216238924005       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+04 is 3.012622e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238923768       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238923794       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216238923797       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216238923795       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216238923797       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216238923797       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216238923787       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216238923930       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216238924158       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216238923706       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+05 is 7.531559e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238923768       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238923775       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216238923775       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216238923772       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216238923780       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216238923800       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216238923767       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216238923959       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216238923566       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216238922932       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+05 is 1.882890e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8832e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904431e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948647e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177262e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996159e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621989e-03 3 1  ON 87
ci_039                 1.981010e-03 3 1  ON 88
ci_040                -4.114897e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730943e-03 3 1  ON 91
ci_043                -3.586442e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672837e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727267e-03 3 1  ON 99
ci_051                 7.751173e-03 3 1  ON 100
ci_052                -7.011578e-03 3 1  ON 101
ci_053                -6.824952e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624370e-03 3 1  ON 106
ci_058                -6.913218e-03 3 1  ON 107
ci_059                -6.879898e-03 3 1  ON 108
ci_060                 8.399826e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045359e-03 3 1  ON 111
ci_063                -3.004231e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121895e-03 3 1  ON 114
ci_066                 6.044675e-03 3 1  ON 115
ci_067                 5.241262e-03 3 1  ON 116
ci_068                -5.351277e-03 3 1  ON 117
ci_069                -5.112358e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.217851
====================================================
  Execution time = 2.0689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1662e-01
  Total weights = 1.9566e+06
  Execution time = 1.8106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279750
                                         uncertainty =       0.002746468370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279750
                                         uncertainty =       0.002746468370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387437500
  error estimate for blocks of size 2^( 2) =       0.000397239364
  error estimate for blocks of size 2^( 3) =       0.000406616685
  error estimate for blocks of size 2^( 4) =       0.000413333690
  error estimate for blocks of size 2^( 5) =       0.000417942585
  error estimate for blocks of size 2^( 6) =       0.000420294110
  error estimate for blocks of size 2^( 7) =       0.000423554775

      target function =                  N/A
              le_mean =     -17.215875811600
             les_mean =     296.702999202747
             stat err =       0.000418781290
             autocorr =       1.168345345479
              std dev =       0.547919367590
             le_variance =       0.300215633380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279992
                                         uncertainty =       0.002746467801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279992
                                         uncertainty =       0.002746467801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387437501
  error estimate for blocks of size 2^( 2) =       0.000397239364
  error estimate for blocks of size 2^( 3) =       0.000406616685
  error estimate for blocks of size 2^( 4) =       0.000413333689
  error estimate for blocks of size 2^( 5) =       0.000417942585
  error estimate for blocks of size 2^( 6) =       0.000420294110
  error estimate for blocks of size 2^( 7) =       0.000423554774

      target function =                  N/A
              le_mean =     -17.215875811592
             les_mean =     296.702999205936
             stat err =       0.000418781289
             autocorr =       1.168345340963
              std dev =       0.547919367817
             le_variance =       0.300215633629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279871
                                         uncertainty =       0.002746468086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279871
                                         uncertainty =       0.002746468086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387437500
  error estimate for blocks of size 2^( 2) =       0.000397239364
  error estimate for blocks of size 2^( 3) =       0.000406616685
  error estimate for blocks of size 2^( 4) =       0.000413333690
  error estimate for blocks of size 2^( 5) =       0.000417942585
  error estimate for blocks of size 2^( 6) =       0.000420294110
  error estimate for blocks of size 2^( 7) =       0.000423554775

      target function =                  N/A
              le_mean =     -17.215875811596
             les_mean =     296.702999204341
             stat err =       0.000418781290
             autocorr =       1.168345343217
              std dev =       0.547919367703
             le_variance =       0.300215633504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279765
                                         uncertainty =       0.002746468335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300286279765
                                         uncertainty =       0.002746468335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387437500
  error estimate for blocks of size 2^( 2) =       0.000397239364
  error estimate for blocks of size 2^( 3) =       0.000406616685
  error estimate for blocks of size 2^( 4) =       0.000413333690
  error estimate for blocks of size 2^( 5) =       0.000417942585
  error estimate for blocks of size 2^( 6) =       0.000420294110
  error estimate for blocks of size 2^( 7) =       0.000423554775

      target function =                  N/A
              le_mean =     -17.215875811599
             les_mean =     296.702999202947
             stat err =       0.000418781290
             autocorr =       1.168345345208
              std dev =       0.547919367604
             le_variance =       0.300215633395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215875811600        initial  <--
     3.7253e+04     3.7253e+05             3.0126e-08       -17.215875811592
     1.4901e+05     1.4901e+06             7.5316e-09       -17.215875811596
     5.9605e+05     5.9605e+06             1.8829e-09       -17.215875811599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8436
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.368976
====================================================
  Execution time = 2.1125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1612e-01
  Total weights = 1.956525738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298770099119
                                         uncertainty =       0.001879205767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298770099119
                                         uncertainty =       0.001879205767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386572369
  error estimate for blocks of size 2^( 2) =       0.000396860353
  error estimate for blocks of size 2^( 3) =       0.000405996096
  error estimate for blocks of size 2^( 4) =       0.000412232458
  error estimate for blocks of size 2^( 5) =       0.000415937231
  error estimate for blocks of size 2^( 6) =       0.000417177650
  error estimate for blocks of size 2^( 7) =       0.000417987302

      target function =                  N/A
              le_mean =     -17.216278802422
             les_mean =     296.716377214890
             stat err =       0.000415833660
             autocorr =       1.157118041155
              std dev =       0.546695886757
             le_variance =       0.298876392597


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627880242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216278802416       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216278802416       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216278802417       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216278802418       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216278802583       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216278802777       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216278802506       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216278802459       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216278802699       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216278802923       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216278801329       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+05 is 2.853393e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216278802416       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216278802416       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216278802416       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216278802416       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216278802039       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216278794662       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216278802403       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216278802698       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216278804806       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216278800990       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216278796790       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+06 is 7.133484e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216278802416       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216278802416       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216278802416       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216278802416       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216278802416       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216278803078       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216278803241       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216278801291       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216278801223       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216278813080       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216278811748       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+06 is 1.783370e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260295 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7120e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672837e-03 3 1  ON 94
ci_046                 5.223553e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2687
    reference variance = 0.252864
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1143e-01
  Total weights = 1.9565e+06
  Execution time = 1.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038549
                                         uncertainty =       0.001364048179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038549
                                         uncertainty =       0.001364048179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384961178
  error estimate for blocks of size 2^( 2) =       0.000394894842
  error estimate for blocks of size 2^( 3) =       0.000403766541
  error estimate for blocks of size 2^( 4) =       0.000411628387
  error estimate for blocks of size 2^( 5) =       0.000415462785
  error estimate for blocks of size 2^( 6) =       0.000417219930
  error estimate for blocks of size 2^( 7) =       0.000417478483

      target function =                  N/A
              le_mean =     -17.216124172649
             les_mean =     296.706365380619
             stat err =       0.000415447396
             autocorr =       1.164657460922
              std dev =       0.544417318827
             le_variance =       0.296390217039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038825
                                         uncertainty =       0.001364048202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038825
                                         uncertainty =       0.001364048202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384961178
  error estimate for blocks of size 2^( 2) =       0.000394894843
  error estimate for blocks of size 2^( 3) =       0.000403766541
  error estimate for blocks of size 2^( 4) =       0.000411628387
  error estimate for blocks of size 2^( 5) =       0.000415462785
  error estimate for blocks of size 2^( 6) =       0.000417219930
  error estimate for blocks of size 2^( 7) =       0.000417478483

      target function =                  N/A
              le_mean =     -17.216124172642
             les_mean =     296.706365382913
             stat err =       0.000415447396
             autocorr =       1.164657460315
              std dev =       0.544417319079
             le_variance =       0.296390217313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038687
                                         uncertainty =       0.001364048190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038687
                                         uncertainty =       0.001364048190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384961178
  error estimate for blocks of size 2^( 2) =       0.000394894843
  error estimate for blocks of size 2^( 3) =       0.000403766541
  error estimate for blocks of size 2^( 4) =       0.000411628387
  error estimate for blocks of size 2^( 5) =       0.000415462785
  error estimate for blocks of size 2^( 6) =       0.000417219930
  error estimate for blocks of size 2^( 7) =       0.000417478483

      target function =                  N/A
              le_mean =     -17.216124172646
             les_mean =     296.706365381766
             stat err =       0.000415447396
             autocorr =       1.164657460621
              std dev =       0.544417318953
             le_variance =       0.296390217176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038566
                                         uncertainty =       0.001364048180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296265038566
                                         uncertainty =       0.001364048180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384961178
  error estimate for blocks of size 2^( 2) =       0.000394894842
  error estimate for blocks of size 2^( 3) =       0.000403766541
  error estimate for blocks of size 2^( 4) =       0.000411628387
  error estimate for blocks of size 2^( 5) =       0.000415462785
  error estimate for blocks of size 2^( 6) =       0.000417219930
  error estimate for blocks of size 2^( 7) =       0.000417478483

      target function =                  N/A
              le_mean =     -17.216124172649
             les_mean =     296.706365380763
             stat err =       0.000415447396
             autocorr =       1.164657460874
              std dev =       0.544417318843
             le_variance =       0.296390217056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216124172649        initial  <--
     3.7253e+05     3.7253e+06             2.8534e-09       -17.216124172642
     1.4901e+06     1.4901e+07             7.1335e-10       -17.216124172646
     5.9605e+06     5.9605e+07             1.7834e-10       -17.216124172649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6351
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6786e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2837
    reference variance = 0.511955
====================================================
  Execution time = 2.1189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1528e-01
  Total weights = 1.956447825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300715093623
                                         uncertainty =       0.002665096455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300715093623
                                         uncertainty =       0.002665096455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387778499
  error estimate for blocks of size 2^( 2) =       0.000398091522
  error estimate for blocks of size 2^( 3) =       0.000407067377
  error estimate for blocks of size 2^( 4) =       0.000412678608
  error estimate for blocks of size 2^( 5) =       0.000416805668
  error estimate for blocks of size 2^( 6) =       0.000419370336
  error estimate for blocks of size 2^( 7) =       0.000421271959

      target function =                  N/A
              le_mean =     -17.216722508874
             les_mean =     296.730814099147
             stat err =       0.000417531643
             autocorr =       1.159341381786
              std dev =       0.548401612531
             le_variance =       0.300744328627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672250887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722508911       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722508912       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722508912       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722509299       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722506164       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722508490       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722511436       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216722507642       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216722507252       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216722509245       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+06 is 2.987164e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722508911       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722508911       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722508911       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722508911       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722507367       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722514670       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722515057       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216722501407       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216722494685       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216722516011       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+07 is 7.467924e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722508911       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722508911       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722508911       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722511417       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722507438       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722496891       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722514981       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216722478821       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216722519756       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216722485980       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+07 is 1.866982e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7185e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011580e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081433e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.235
    reference variance = 0.175818
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1561e-01
  Total weights = 1.9566e+06
  Execution time = 1.8122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695540
                                         uncertainty =       0.002297897723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695540
                                         uncertainty =       0.002297897723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388178060
  error estimate for blocks of size 2^( 2) =       0.000398003301
  error estimate for blocks of size 2^( 3) =       0.000407007319
  error estimate for blocks of size 2^( 4) =       0.000413731103
  error estimate for blocks of size 2^( 5) =       0.000418467911
  error estimate for blocks of size 2^( 6) =       0.000420301928
  error estimate for blocks of size 2^( 7) =       0.000420032226

      target function =                  N/A
              le_mean =     -17.216551930960
             les_mean =     296.725272516503
             stat err =       0.000418133292
             autocorr =       1.160292603249
              std dev =       0.548966677503
             le_variance =       0.301364413009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695529
                                         uncertainty =       0.002297897722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695529
                                         uncertainty =       0.002297897722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388178060
  error estimate for blocks of size 2^( 2) =       0.000398003301
  error estimate for blocks of size 2^( 3) =       0.000407007319
  error estimate for blocks of size 2^( 4) =       0.000413731103
  error estimate for blocks of size 2^( 5) =       0.000418467911
  error estimate for blocks of size 2^( 6) =       0.000420301928
  error estimate for blocks of size 2^( 7) =       0.000420032226

      target function =                  N/A
              le_mean =     -17.216551930961
             les_mean =     296.725272516648
             stat err =       0.000418133292
             autocorr =       1.160292603277
              std dev =       0.548966677493
             le_variance =       0.301364412998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695534
                                         uncertainty =       0.002297897722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695534
                                         uncertainty =       0.002297897722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388178060
  error estimate for blocks of size 2^( 2) =       0.000398003301
  error estimate for blocks of size 2^( 3) =       0.000407007319
  error estimate for blocks of size 2^( 4) =       0.000413731103
  error estimate for blocks of size 2^( 5) =       0.000418467911
  error estimate for blocks of size 2^( 6) =       0.000420301928
  error estimate for blocks of size 2^( 7) =       0.000420032226

      target function =                  N/A
              le_mean =     -17.216551930960
             les_mean =     296.725272516576
             stat err =       0.000418133292
             autocorr =       1.160292603258
              std dev =       0.548966677498
             le_variance =       0.301364413003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695539
                                         uncertainty =       0.002297897723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301437695539
                                         uncertainty =       0.002297897723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388178060
  error estimate for blocks of size 2^( 2) =       0.000398003301
  error estimate for blocks of size 2^( 3) =       0.000407007319
  error estimate for blocks of size 2^( 4) =       0.000413731103
  error estimate for blocks of size 2^( 5) =       0.000418467911
  error estimate for blocks of size 2^( 6) =       0.000420301928
  error estimate for blocks of size 2^( 7) =       0.000420032226

      target function =                  N/A
              le_mean =     -17.216551930960
             les_mean =     296.725272516512
             stat err =       0.000418133292
             autocorr =       1.160292603254
              std dev =       0.548966677503
             le_variance =       0.301364413008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216551930960        initial
     3.7253e+06     3.7253e+07             2.9872e-10       -17.216551930961  <--
     1.4901e+07     1.4901e+08             7.4679e-11       -17.216551930960
     5.9605e+07     5.9605e+08             1.8670e-11       -17.216551930960

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 2.9776e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.223
    reference variance = 0.125727
====================================================
  Execution time = 2.0799e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1374e-01
  Total weights = 1.956784027e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848003975
                                         uncertainty =       0.002054596084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299848003975
                                         uncertainty =       0.002054596084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387149551
  error estimate for blocks of size 2^( 2) =       0.000397525144
  error estimate for blocks of size 2^( 3) =       0.000406748725
  error estimate for blocks of size 2^( 4) =       0.000413817507
  error estimate for blocks of size 2^( 5) =       0.000417367995
  error estimate for blocks of size 2^( 6) =       0.000420763589
  error estimate for blocks of size 2^( 7) =       0.000421048009

      target function =                  N/A
              le_mean =     -17.217321451071
             les_mean =     296.749893108073
             stat err =       0.000418249275
             autocorr =       1.167112909395
              std dev =       0.547512146290
             le_variance =       0.299769550335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721732145107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217321451100       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217321451100       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217321451101       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217321451114       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217321451096       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217321450571       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217321451052       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217321451044       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217321451737       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217321451836       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+05 is 1.213996e-09

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217321451100       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217321451100       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217321451100       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217321451101       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217321451101       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217321453183       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217321451126       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217321450205       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217321450814       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217321446144       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+06 is 3.034987e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217321451100       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217321451100       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217321451100       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217321451100       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217321445457       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217321451028       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217321450405       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217321444782       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217321451381       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217321450244       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+07 is 7.587477e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6851e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586443e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672837e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.2256
====================================================
  Execution time = 2.0765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1145e-01
  Total weights = 1.9566e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501939
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501939
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386111439
  error estimate for blocks of size 2^( 2) =       0.000396092283
  error estimate for blocks of size 2^( 3) =       0.000405058358
  error estimate for blocks of size 2^( 4) =       0.000411522789
  error estimate for blocks of size 2^( 5) =       0.000416327674
  error estimate for blocks of size 2^( 6) =       0.000420173321
  error estimate for blocks of size 2^( 7) =       0.000420879135

      target function =                  N/A
              le_mean =     -17.217116985960
             les_mean =     296.740571561148
             stat err =       0.000417225730
             autocorr =       1.167661144353
              std dev =       0.546044033874
             le_variance =       0.298164086930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501954
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501954
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386111439
  error estimate for blocks of size 2^( 2) =       0.000396092283
  error estimate for blocks of size 2^( 3) =       0.000405058358
  error estimate for blocks of size 2^( 4) =       0.000411522789
  error estimate for blocks of size 2^( 5) =       0.000416327674
  error estimate for blocks of size 2^( 6) =       0.000420173321
  error estimate for blocks of size 2^( 7) =       0.000420879135

      target function =                  N/A
              le_mean =     -17.217116985959
             les_mean =     296.740571561342
             stat err =       0.000417225730
             autocorr =       1.167661144467
              std dev =       0.546044033889
             le_variance =       0.298164086945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501947
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501947
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386111439
  error estimate for blocks of size 2^( 2) =       0.000396092283
  error estimate for blocks of size 2^( 3) =       0.000405058358
  error estimate for blocks of size 2^( 4) =       0.000411522789
  error estimate for blocks of size 2^( 5) =       0.000416327674
  error estimate for blocks of size 2^( 6) =       0.000420173321
  error estimate for blocks of size 2^( 7) =       0.000420879135

      target function =                  N/A
              le_mean =     -17.217116985960
             les_mean =     296.740571561245
             stat err =       0.000417225730
             autocorr =       1.167661144418
              std dev =       0.546044033881
             le_variance =       0.298164086937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501940
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118501940
                                         uncertainty =       0.001967884558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386111439
  error estimate for blocks of size 2^( 2) =       0.000396092283
  error estimate for blocks of size 2^( 3) =       0.000405058358
  error estimate for blocks of size 2^( 4) =       0.000411522789
  error estimate for blocks of size 2^( 5) =       0.000416327674
  error estimate for blocks of size 2^( 6) =       0.000420173321
  error estimate for blocks of size 2^( 7) =       0.000420879135

      target function =                  N/A
              le_mean =     -17.217116985960
             les_mean =     296.740571561160
             stat err =       0.000417225730
             autocorr =       1.167661144351
              std dev =       0.546044033875
             le_variance =       0.298164086931


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217116985960        initial  <--
     9.3132e+05     9.3132e+06             1.2140e-09       -17.217116985959
     3.7253e+06     3.7253e+07             3.0350e-10       -17.217116985960
     1.4901e+07     1.4901e+08             7.5875e-11       -17.217116985960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9494
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.212347
====================================================
  Execution time = 2.1027e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1279e-01
  Total weights = 1.956603072e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081701884
                                         uncertainty =       0.001807011675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298081701884
                                         uncertainty =       0.001807011675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386064932
  error estimate for blocks of size 2^( 2) =       0.000395883462
  error estimate for blocks of size 2^( 3) =       0.000405235918
  error estimate for blocks of size 2^( 4) =       0.000412058812
  error estimate for blocks of size 2^( 5) =       0.000416467316
  error estimate for blocks of size 2^( 6) =       0.000418835241
  error estimate for blocks of size 2^( 7) =       0.000417017682

      target function =                  N/A
              le_mean =     -17.216690377966
             les_mean =     296.727216702794
             stat err =       0.000416094763
             autocorr =       1.161619223205
              std dev =       0.545978262797
             le_variance =       0.298092263447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669037797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690378012       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690378012       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690378013       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690378013       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690374511       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690379470       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216690376003       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216690375404       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216690380050       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+06 is 1.092321e-10

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690378012       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690378012       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690378012       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690378012       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690359756       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690375311       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216690384913       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216690400244       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216690383208       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+07 is 2.730793e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216690378012       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216690378012       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216690378012       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216690352324       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216690348391       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690361993       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216690289887       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216690339028       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216690303238       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+08 is 6.827144e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7060e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672837e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2665
    reference variance = 0.456789
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1182e-01
  Total weights = 1.9562e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135574
                                         uncertainty =       0.003662386391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135574
                                         uncertainty =       0.003662386391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895715
  error estimate for blocks of size 2^( 2) =       0.000396762770
  error estimate for blocks of size 2^( 3) =       0.000405501645
  error estimate for blocks of size 2^( 4) =       0.000412717233
  error estimate for blocks of size 2^( 5) =       0.000416549081
  error estimate for blocks of size 2^( 6) =       0.000417765187
  error estimate for blocks of size 2^( 7) =       0.000418315364

      target function =                  N/A
              le_mean =     -17.216574817460
             les_mean =     296.722267931484
             stat err =       0.000416336716
             autocorr =       1.157981402370
              std dev =       0.547153167878
             le_variance =       0.299376589119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135618
                                         uncertainty =       0.003662386397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135618
                                         uncertainty =       0.003662386397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895715
  error estimate for blocks of size 2^( 2) =       0.000396762770
  error estimate for blocks of size 2^( 3) =       0.000405501645
  error estimate for blocks of size 2^( 4) =       0.000412717233
  error estimate for blocks of size 2^( 5) =       0.000416549081
  error estimate for blocks of size 2^( 6) =       0.000417765187
  error estimate for blocks of size 2^( 7) =       0.000418315364

      target function =                  N/A
              le_mean =     -17.216574817459
             les_mean =     296.722267931476
             stat err =       0.000416336716
             autocorr =       1.157981402335
              std dev =       0.547153167918
             le_variance =       0.299376589163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135596
                                         uncertainty =       0.003662386394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135596
                                         uncertainty =       0.003662386394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895715
  error estimate for blocks of size 2^( 2) =       0.000396762770
  error estimate for blocks of size 2^( 3) =       0.000405501645
  error estimate for blocks of size 2^( 4) =       0.000412717233
  error estimate for blocks of size 2^( 5) =       0.000416549081
  error estimate for blocks of size 2^( 6) =       0.000417765187
  error estimate for blocks of size 2^( 7) =       0.000418315364

      target function =                  N/A
              le_mean =     -17.216574817460
             les_mean =     296.722267931480
             stat err =       0.000416336716
             autocorr =       1.157981402357
              std dev =       0.547153167898
             le_variance =       0.299376589141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135576
                                         uncertainty =       0.003662386391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435135576
                                         uncertainty =       0.003662386391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895715
  error estimate for blocks of size 2^( 2) =       0.000396762770
  error estimate for blocks of size 2^( 3) =       0.000405501645
  error estimate for blocks of size 2^( 4) =       0.000412717233
  error estimate for blocks of size 2^( 5) =       0.000416549081
  error estimate for blocks of size 2^( 6) =       0.000417765187
  error estimate for blocks of size 2^( 7) =       0.000418315364

      target function =                  N/A
              le_mean =     -17.216574817460
             les_mean =     296.722267931484
             stat err =       0.000416336716
             autocorr =       1.157981402370
              std dev =       0.547153167880
             le_variance =       0.299376589122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216574817460        initial  <--
     9.3132e+06     9.3132e+07             1.0923e-10       -17.216574817459
     3.7253e+07     3.7253e+08             2.7308e-11       -17.216574817460
     1.4901e+08     1.4901e+09             6.8271e-12       -17.216574817460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0261
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1268
    reference variance = 0.193667
====================================================
  Execution time = 2.2667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1789e-01
  Total weights = 1.956594261e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302586454727
                                         uncertainty =       0.002128403584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302586454727
                                         uncertainty =       0.002128403584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389003376
  error estimate for blocks of size 2^( 2) =       0.000398949104
  error estimate for blocks of size 2^( 3) =       0.000407839084
  error estimate for blocks of size 2^( 4) =       0.000414756358
  error estimate for blocks of size 2^( 5) =       0.000418840688
  error estimate for blocks of size 2^( 6) =       0.000421651818
  error estimate for blocks of size 2^( 7) =       0.000423736835

      target function =                  N/A
              le_mean =     -17.217007191516
             les_mean =     296.743230649375
             stat err =       0.000419746425
             autocorr =       1.164306363751
              std dev =       0.550133849746
             le_variance =       0.302647252636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700719152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007191575       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007191575       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007191575       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007194864       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007191575       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007137304       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217007191206       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217007079700       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217007192389       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217007196309       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+07 is 1.191818e-11

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007191575       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007191575       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007191575       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007185008       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007258499       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007092531       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217007154261       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217007192004       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217007022807       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217007063149       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+08 is 2.979561e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007191575       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217007191575       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007191575       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007191575       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217007155840       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217007578816       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217005915015       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217007185090       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217007051980       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217007049109       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+09 is 7.449130e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8731e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1586
    reference variance = 0.197881
====================================================
  Execution time = 2.0773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2025e-01
  Total weights = 1.9568e+06
  Execution time = 1.8067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577476
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577476
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388629790
  error estimate for blocks of size 2^( 2) =       0.000398791062
  error estimate for blocks of size 2^( 3) =       0.000408026158
  error estimate for blocks of size 2^( 4) =       0.000415098481
  error estimate for blocks of size 2^( 5) =       0.000419025075
  error estimate for blocks of size 2^( 6) =       0.000419623470
  error estimate for blocks of size 2^( 7) =       0.000419444867

      target function =                  N/A
              le_mean =     -17.216232391793
             les_mean =     296.718911143363
             stat err =       0.000418297973
             autocorr =       1.158508817018
              std dev =       0.549605520444
             le_variance =       0.302066228103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577475
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577475
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388629790
  error estimate for blocks of size 2^( 2) =       0.000398791062
  error estimate for blocks of size 2^( 3) =       0.000408026158
  error estimate for blocks of size 2^( 4) =       0.000415098481
  error estimate for blocks of size 2^( 5) =       0.000419025075
  error estimate for blocks of size 2^( 6) =       0.000419623470
  error estimate for blocks of size 2^( 7) =       0.000419444867

      target function =                  N/A
              le_mean =     -17.216232391793
             les_mean =     296.718911143353
             stat err =       0.000418297973
             autocorr =       1.158508817011
              std dev =       0.549605520443
             le_variance =       0.302066228101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577475
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577475
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388629790
  error estimate for blocks of size 2^( 2) =       0.000398791062
  error estimate for blocks of size 2^( 3) =       0.000408026158
  error estimate for blocks of size 2^( 4) =       0.000415098481
  error estimate for blocks of size 2^( 5) =       0.000419025075
  error estimate for blocks of size 2^( 6) =       0.000419623470
  error estimate for blocks of size 2^( 7) =       0.000419444867

      target function =                  N/A
              le_mean =     -17.216232391793
             les_mean =     296.718911143358
             stat err =       0.000418297973
             autocorr =       1.158508817013
              std dev =       0.549605520444
             le_variance =       0.302066228102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577476
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302074577476
                                         uncertainty =       0.002392778039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388629790
  error estimate for blocks of size 2^( 2) =       0.000398791062
  error estimate for blocks of size 2^( 3) =       0.000408026158
  error estimate for blocks of size 2^( 4) =       0.000415098481
  error estimate for blocks of size 2^( 5) =       0.000419025075
  error estimate for blocks of size 2^( 6) =       0.000419623470
  error estimate for blocks of size 2^( 7) =       0.000419444867

      target function =                  N/A
              le_mean =     -17.216232391793
             les_mean =     296.718911143363
             stat err =       0.000418297973
             autocorr =       1.158508817006
              std dev =       0.549605520444
             le_variance =       0.302066228103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216232391793        initial
     9.3132e+07     9.3132e+08             1.1918e-11       -17.216232391793  <--
     3.7253e+08     3.7253e+09             2.9796e-12       -17.216232391793
     1.4901e+09     1.4901e+10             7.4491e-13       -17.216232391793

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 2.9925e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8662e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.12704
====================================================
  Execution time = 2.1032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2085e-01
  Total weights = 1.956539074e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303659761742
                                         uncertainty =       0.002754435374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303659761742
                                         uncertainty =       0.002754435374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389637792
  error estimate for blocks of size 2^( 2) =       0.000399597806
  error estimate for blocks of size 2^( 3) =       0.000408201534
  error estimate for blocks of size 2^( 4) =       0.000415124953
  error estimate for blocks of size 2^( 5) =       0.000419269152
  error estimate for blocks of size 2^( 6) =       0.000420794741
  error estimate for blocks of size 2^( 7) =       0.000423267880

      target function =                  N/A
              le_mean =     -17.216082471077
             les_mean =     296.714343862498
             stat err =       0.000419614181
             autocorr =       1.159786813661
              std dev =       0.551031050172
             le_variance =       0.303635218253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608247108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216082471106       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216082471106       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216082471106       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216082470613       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216082471830       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216082469567       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216082461957       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216082433207       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216082481373       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216082479804       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+07 is 4.585121e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216082471106       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216082471106       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216082471106       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216082484452       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216082466773       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216082432972       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216082441532       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216082561824       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216082516790       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216082481608       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+07 is 1.146270e-11

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216082471106       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216082471106       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216082471106       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216082471106       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216082439276       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216082678593       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216082380042       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216082595844       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216082634233       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216082366703       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+08 is 2.865623e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7092e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1788
    reference variance = 0.325201
====================================================
  Execution time = 2.1148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1733e-01
  Total weights = 1.9567e+06
  Execution time = 1.8077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120262
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120262
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385944176
  error estimate for blocks of size 2^( 2) =       0.000395818480
  error estimate for blocks of size 2^( 3) =       0.000404601400
  error estimate for blocks of size 2^( 4) =       0.000411374717
  error estimate for blocks of size 2^( 5) =       0.000415878051
  error estimate for blocks of size 2^( 6) =       0.000418166425
  error estimate for blocks of size 2^( 7) =       0.000417963503

      target function =                  N/A
              le_mean =     -17.217294532911
             les_mean =     296.752561061929
             stat err =       0.000415845674
             autocorr =       1.160955018768
              std dev =       0.545807487602
             le_variance =       0.297905813523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120260
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120260
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385944176
  error estimate for blocks of size 2^( 2) =       0.000395818480
  error estimate for blocks of size 2^( 3) =       0.000404601400
  error estimate for blocks of size 2^( 4) =       0.000411374717
  error estimate for blocks of size 2^( 5) =       0.000415878051
  error estimate for blocks of size 2^( 6) =       0.000418166425
  error estimate for blocks of size 2^( 7) =       0.000417963503

      target function =                  N/A
              le_mean =     -17.217294532911
             les_mean =     296.752561061932
             stat err =       0.000415845674
             autocorr =       1.160955018772
              std dev =       0.545807487601
             le_variance =       0.297905813521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120261
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120261
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385944176
  error estimate for blocks of size 2^( 2) =       0.000395818480
  error estimate for blocks of size 2^( 3) =       0.000404601400
  error estimate for blocks of size 2^( 4) =       0.000411374717
  error estimate for blocks of size 2^( 5) =       0.000415878051
  error estimate for blocks of size 2^( 6) =       0.000418166425
  error estimate for blocks of size 2^( 7) =       0.000417963503

      target function =                  N/A
              le_mean =     -17.217294532911
             les_mean =     296.752561061931
             stat err =       0.000415845674
             autocorr =       1.160955018765
              std dev =       0.545807487602
             le_variance =       0.297905813522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120262
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297884120262
                                         uncertainty =       0.002094562660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385944176
  error estimate for blocks of size 2^( 2) =       0.000395818480
  error estimate for blocks of size 2^( 3) =       0.000404601400
  error estimate for blocks of size 2^( 4) =       0.000411374717
  error estimate for blocks of size 2^( 5) =       0.000415878051
  error estimate for blocks of size 2^( 6) =       0.000418166425
  error estimate for blocks of size 2^( 7) =       0.000417963503

      target function =                  N/A
              le_mean =     -17.217294532911
             les_mean =     296.752561061929
             stat err =       0.000415845674
             autocorr =       1.160955018773
              std dev =       0.545807487602
             le_variance =       0.297905813523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217294532911        initial  <--
     2.3283e+07     2.3283e+08             4.5851e-11       -17.217294532911
     9.3132e+07     9.3132e+08             1.1463e-11       -17.217294532911
     3.7253e+08     3.7253e+09             2.8656e-12       -17.217294532911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2957
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.148835
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1633e-01
  Total weights = 1.956862857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300093788891
                                         uncertainty =       0.001998006923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300093788891
                                         uncertainty =       0.001998006923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387339247
  error estimate for blocks of size 2^( 2) =       0.000397236360
  error estimate for blocks of size 2^( 3) =       0.000406035634
  error estimate for blocks of size 2^( 4) =       0.000412843585
  error estimate for blocks of size 2^( 5) =       0.000416050199
  error estimate for blocks of size 2^( 6) =       0.000419029194
  error estimate for blocks of size 2^( 7) =       0.000421052699

      target function =                  N/A
              le_mean =     -17.216709233267
             les_mean =     296.731407241470
             stat err =       0.000417243919
             autocorr =       1.160371418197
              std dev =       0.547780417037
             le_variance =       0.300063385289


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670923327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709233299       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709233299       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709233299       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216709233089       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709223063       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216709356335       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216709450231       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216709485096       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216709183312       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216709315759       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+08 is 4.886693e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709233299       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709233299       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709233299       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216709233299       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709474597       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216708874216       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216708743062       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216709185506       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216709141491       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216709022892       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+08 is 1.221788e-12

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216709233299       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216709233299       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216709233299       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216708497117       residual = 8.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216709283630       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216712354687       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216708765624       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216708417195       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216709078667       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216710239081       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+09 is 3.054432e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6862e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2383
    reference variance = 0.18866
====================================================
  Execution time = 2.0755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0807e-01
  Total weights = 1.9569e+06
  Execution time = 1.8106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384141170
  error estimate for blocks of size 2^( 2) =       0.000394102629
  error estimate for blocks of size 2^( 3) =       0.000403696517
  error estimate for blocks of size 2^( 4) =       0.000410695507
  error estimate for blocks of size 2^( 5) =       0.000415082319
  error estimate for blocks of size 2^( 6) =       0.000416530179
  error estimate for blocks of size 2^( 7) =       0.000416843650

      target function =                  N/A
              le_mean =     -17.216523310192
             les_mean =     296.716744066821
             stat err =       0.000414787914
             autocorr =       1.165924629809
              std dev =       0.543257652488
             le_variance =       0.295128876986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384141170
  error estimate for blocks of size 2^( 2) =       0.000394102629
  error estimate for blocks of size 2^( 3) =       0.000403696517
  error estimate for blocks of size 2^( 4) =       0.000410695507
  error estimate for blocks of size 2^( 5) =       0.000415082319
  error estimate for blocks of size 2^( 6) =       0.000416530179
  error estimate for blocks of size 2^( 7) =       0.000416843650

      target function =                  N/A
              le_mean =     -17.216523310192
             les_mean =     296.716744066822
             stat err =       0.000414787914
             autocorr =       1.165924629796
              std dev =       0.543257652488
             le_variance =       0.295128876986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384141170
  error estimate for blocks of size 2^( 2) =       0.000394102629
  error estimate for blocks of size 2^( 3) =       0.000403696517
  error estimate for blocks of size 2^( 4) =       0.000410695507
  error estimate for blocks of size 2^( 5) =       0.000415082319
  error estimate for blocks of size 2^( 6) =       0.000416530179
  error estimate for blocks of size 2^( 7) =       0.000416843650

      target function =                  N/A
              le_mean =     -17.216523310192
             les_mean =     296.716744066821
             stat err =       0.000414787914
             autocorr =       1.165924629802
              std dev =       0.543257652488
             le_variance =       0.295128876986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295157204391
                                         uncertainty =       0.001807459671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384141170
  error estimate for blocks of size 2^( 2) =       0.000394102629
  error estimate for blocks of size 2^( 3) =       0.000403696517
  error estimate for blocks of size 2^( 4) =       0.000410695507
  error estimate for blocks of size 2^( 5) =       0.000415082319
  error estimate for blocks of size 2^( 6) =       0.000416530179
  error estimate for blocks of size 2^( 7) =       0.000416843650

      target function =                  N/A
              le_mean =     -17.216523310192
             les_mean =     296.716744066821
             stat err =       0.000414787914
             autocorr =       1.165924629799
              std dev =       0.543257652488
             le_variance =       0.295128876986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216523310192        initial  <--
     2.3283e+08     2.3283e+09             4.8867e-12       -17.216523310192
     9.3132e+08     9.3132e+09             1.2218e-12       -17.216523310192
     3.7253e+09     3.7253e+10             3.0544e-13       -17.216523310192

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9162
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.284
    reference variance = 0.384711
====================================================
  Execution time = 2.0839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0956e-01
  Total weights = 1.956761601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296318045671
                                         uncertainty =       0.001886896928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296318045671
                                         uncertainty =       0.001886896928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384888151
  error estimate for blocks of size 2^( 2) =       0.000395131775
  error estimate for blocks of size 2^( 3) =       0.000404033724
  error estimate for blocks of size 2^( 4) =       0.000411124943
  error estimate for blocks of size 2^( 5) =       0.000415432451
  error estimate for blocks of size 2^( 6) =       0.000419019597
  error estimate for blocks of size 2^( 7) =       0.000423452014

      target function =                  N/A
              le_mean =     -17.216719259022
             les_mean =     296.724986978923
             stat err =       0.000417257251
             autocorr =       1.175272846068
              std dev =       0.544314043559
             le_variance =       0.296277778015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671925902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719259057       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719259057       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719259057       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719259057       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216719259057       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717542693       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216719242741       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216719513093       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216720122268       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216719135027       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+09 is 4.897452e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719259057       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719259057       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719259057       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719259057       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691955147       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216718958156       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717348257       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216720204000       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216717505661       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216722784537       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+09 is 1.225683e-13

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216719259057       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216719259057       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216719259057       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719259057       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216719259057       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216719259057       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216719949274       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216694814750       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216711966855       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216754869430       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216733198889       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216466757229       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216508033596       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217061112058       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216441443807       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216685105569       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217858948327       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216582107558       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216537498743       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217272433326       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217101827918       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214183704295       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218003088173       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214336048520       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218240721206       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217102617950       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217423826704       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.212045293175       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216480525554       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.213484561337       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.217027179123       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.216181623827       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.217302456672       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.218711212513       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.216327776125       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.214999197346       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.225868032377       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.220707404634       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.214368856350       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.214144876207       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.217802626930       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.221065421376       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.218078396782       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.207882479981       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.216642139524       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.212807390823       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.216508718565       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.205407246185       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.234408471496       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.217437379092       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.217119529780       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.218063574561       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.216456409223       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.220757532175       residual = 2.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.207709760389       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.205955235004       residual = 1.75e-02           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.203579280700       residual = 2.55e-02           smallest_sin_value = 9.97e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.212302176948       residual = 6.45e-03           smallest_sin_value = 9.97e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.220552467571       residual = 2.27e-03           smallest_sin_value = 9.97e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+10 is 3.045955e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6967e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2773
    reference variance = 0.325116
====================================================
  Execution time = 2.0608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1368e-01
  Total weights = 1.9565e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384818619
  error estimate for blocks of size 2^( 2) =       0.000394851559
  error estimate for blocks of size 2^( 3) =       0.000403999050
  error estimate for blocks of size 2^( 4) =       0.000410960260
  error estimate for blocks of size 2^( 5) =       0.000414688228
  error estimate for blocks of size 2^( 6) =       0.000416676468
  error estimate for blocks of size 2^( 7) =       0.000419384431

      target function =                  N/A
              le_mean =     -17.216120387123
             les_mean =     296.708481450723
             stat err =       0.000415427347
             autocorr =       1.165408043995
              std dev =       0.544215709506
             le_variance =       0.296170738474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384818619
  error estimate for blocks of size 2^( 2) =       0.000394851559
  error estimate for blocks of size 2^( 3) =       0.000403999050
  error estimate for blocks of size 2^( 4) =       0.000410960260
  error estimate for blocks of size 2^( 5) =       0.000414688228
  error estimate for blocks of size 2^( 6) =       0.000416676468
  error estimate for blocks of size 2^( 7) =       0.000419384431

      target function =                  N/A
              le_mean =     -17.216120387123
             les_mean =     296.708481450722
             stat err =       0.000415427347
             autocorr =       1.165408043990
              std dev =       0.544215709506
             le_variance =       0.296170738474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384818619
  error estimate for blocks of size 2^( 2) =       0.000394851559
  error estimate for blocks of size 2^( 3) =       0.000403999050
  error estimate for blocks of size 2^( 4) =       0.000410960260
  error estimate for blocks of size 2^( 5) =       0.000414688228
  error estimate for blocks of size 2^( 6) =       0.000416676468
  error estimate for blocks of size 2^( 7) =       0.000419384431

      target function =                  N/A
              le_mean =     -17.216120387123
             les_mean =     296.708481450723
             stat err =       0.000415427347
             autocorr =       1.165408043998
              std dev =       0.544215709506
             le_variance =       0.296170738474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296060032153
                                         uncertainty =       0.001818711338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384818619
  error estimate for blocks of size 2^( 2) =       0.000394851559
  error estimate for blocks of size 2^( 3) =       0.000403999050
  error estimate for blocks of size 2^( 4) =       0.000410960260
  error estimate for blocks of size 2^( 5) =       0.000414688228
  error estimate for blocks of size 2^( 6) =       0.000416676468
  error estimate for blocks of size 2^( 7) =       0.000419384431

      target function =                  N/A
              le_mean =     -17.216120387123
             les_mean =     296.708481450723
             stat err =       0.000415427347
             autocorr =       1.165408043994
              std dev =       0.544215709506
             le_variance =       0.296170738474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216120387123        initial  <--
     2.3283e+09     2.3283e+10             4.8975e-13       -17.216120387123
     9.3132e+09     9.3132e+10             1.2257e-13       -17.216120387123
     3.7253e+10     3.7253e+11             3.0460e-14       -17.216120387123

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7963
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3157
    reference variance = 0.293365
====================================================
  Execution time = 2.0876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1252e-01
  Total weights = 1.956540540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298220319809
                                         uncertainty =       0.001912391755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298220319809
                                         uncertainty =       0.001912391755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386096980
  error estimate for blocks of size 2^( 2) =       0.000396120412
  error estimate for blocks of size 2^( 3) =       0.000405047020
  error estimate for blocks of size 2^( 4) =       0.000411473317
  error estimate for blocks of size 2^( 5) =       0.000415629580
  error estimate for blocks of size 2^( 6) =       0.000417413269
  error estimate for blocks of size 2^( 7) =       0.000418707037

      target function =                  N/A
              le_mean =     -17.215895358267
             les_mean =     296.699569495453
             stat err =       0.000415805801
             autocorr =       1.159813817058
              std dev =       0.546023585330
             le_variance =       0.298141755737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589535827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895358289       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215895358289       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215895358289       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215903651596       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215890741632       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215894290798       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215904909826       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215913259863       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215907680657       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215902439071       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215892678843       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215939788700       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215841062182       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215811081017       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215946840435       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215809729246       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216071628594       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215711506511       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215757092659       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216374152369       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215193720394       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214523565203       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217582032679       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214545915998       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.214707662064       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216345172125       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216365571233       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.216056106720       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.214931874869       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.217324779044       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.220177593617       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.221112210146       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.217065975080       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.214446341913       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.213482388690       residual = 9.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.219109393386       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.217061833403       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.218119759452       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.210962839859       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.211001239511       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.215758560596       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.219336468508       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.218284377209       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.221279993487       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.216710761380       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.214430804810       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.227700361531       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.210616837642       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.211925534403       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.216360545574       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.221475625972       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.216476825474       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.209345236263       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.216977100515       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.211610587835       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.229224827685       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.209300784129       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.227517442749       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.228023744271       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.188400087020       residual = 1.17e-01           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.134680241243       residual = 1.03e+00           smallest_sin_value = 9.97e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.213763691688       residual = 3.30e-03           smallest_sin_value = 9.94e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.43e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+10 is 4.997650e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895358289       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215895358289       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215895358289       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215895358289       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215895358289       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215898873825       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215931557693       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215859164819       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215957204216       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215953615331       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215843841511       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215804617635       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216012642653       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216047201422       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214947393981       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215998964981       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214287632816       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217001270714       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.218410824891       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215263843368       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.211249463802       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212264099151       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214959326425       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.219098915896       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.212320430655       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214352291665       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.213423938457       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.211171860728       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.222075537932       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.215153676598       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.222313728697       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.215843683325       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.222151354209       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.218650108442       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.220110127223       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.232153587320       residual = 4.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.208361307673       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.212609484961       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.208773947838       residual = 7.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.212685271503       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.196107298337       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.212509026567       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.210985914510       residual = 6.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.193000728813       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.214997394176       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.235554079882       residual = 6.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.219066110757       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.195013458648       residual = 7.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.207311936946       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.160916815306       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.194151843353       residual = 8.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.207396669199       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.191104834352       residual = 8.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.216674910230       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.192071531694       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.171713673660       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.211258737298       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.209583026780       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.262209409589       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.212802997718       residual = 6.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -17.157759679660       residual = 5.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -17.220109878842       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -17.159209206541       residual = 4.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -17.244454920836       residual = 2.44e-01           smallest_sin_value = 9.99e-01
davidson iteration   64:   krylov dim =  65   energy =     -17.221066802249       residual = 7.39e-02           smallest_sin_value = 9.99e-01
davidson iteration   65:   krylov dim =  66   energy =     -17.271367834621       residual = 5.34e-01           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -17.154348814858       residual = 6.82e-01           smallest_sin_value = 9.99e-01
davidson iteration   67:   krylov dim =  68   energy =     -17.175037894499       residual = 3.27e-01           smallest_sin_value = 9.95e-01
davidson iteration   68:   krylov dim =  69   energy =     -17.354703976957       residual = 3.30e+00           smallest_sin_value = 9.94e-01
davidson iteration   69:   krylov dim =  70   energy =     -17.264512663285       residual = 5.72e-01           smallest_sin_value = 9.94e-01
davidson iteration   70 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         70 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+10 is 1.234121e-14

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215895358289       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215895358289       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215895358289       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215873447227       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215966646722       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216909630517       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215904354809       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215873561447       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215699609916       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215268995053       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.220610347727       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216744419473       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216639243641       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216870378864       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215322107371       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216844078424       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215222906293       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222502045003       residual = 6.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.198786826836       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.212564407515       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.196778668387       residual = 5.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215898109586       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214800260799       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.182485261443       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.257929463829       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.184381786389       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.220768754211       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.208501945979       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.251200636018       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.197378986553       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.191882114633       residual = 8.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.231305754885       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.219516724397       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.196027370195       residual = 6.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.262919259745       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.238057741019       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.337713586818       residual = 2.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.281812880492       residual = 6.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.210134991105       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.170860378458       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.207943781112       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.113820631306       residual = 1.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.240815471627       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.060570116283       residual = 3.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.125523438706       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.559263324901       residual = 1.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.140563020088       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.156718643479       residual = 8.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.220139935849       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.140439268339       residual = 8.45e-01           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   energy =     -16.143971918592       residual = 1.88e+02           smallest_sin_value = 9.97e-01
davidson iteration   51:   krylov dim =  52   energy =     -16.667734845365       residual = 5.24e+01           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.175888236705       residual = 4.07e-01           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.305860955458       residual = 1.07e+00           smallest_sin_value = 9.93e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+11 is 2.854040e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.694053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7283e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1908
    reference variance = 0.186729
====================================================
  Execution time = 2.0659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1390e-01
  Total weights = 1.9565e+06
  Execution time = 1.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016967
  error estimate for blocks of size 2^( 2) =       0.000397359446
  error estimate for blocks of size 2^( 3) =       0.000406957767
  error estimate for blocks of size 2^( 4) =       0.000413381350
  error estimate for blocks of size 2^( 5) =       0.000418025971
  error estimate for blocks of size 2^( 6) =       0.000418718686
  error estimate for blocks of size 2^( 7) =       0.000419751410

      target function =                  N/A
              le_mean =     -17.215700343373
             les_mean =     296.694241826104
             stat err =       0.000417469354
             autocorr =       1.163561091168
              std dev =       0.547324643574
             le_variance =       0.299564265464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016967
  error estimate for blocks of size 2^( 2) =       0.000397359446
  error estimate for blocks of size 2^( 3) =       0.000406957767
  error estimate for blocks of size 2^( 4) =       0.000413381350
  error estimate for blocks of size 2^( 5) =       0.000418025971
  error estimate for blocks of size 2^( 6) =       0.000418718686
  error estimate for blocks of size 2^( 7) =       0.000419751410

      target function =                  N/A
              le_mean =     -17.215700343373
             les_mean =     296.694241826104
             stat err =       0.000417469354
             autocorr =       1.163561091167
              std dev =       0.547324643574
             le_variance =       0.299564265464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016967
  error estimate for blocks of size 2^( 2) =       0.000397359446
  error estimate for blocks of size 2^( 3) =       0.000406957767
  error estimate for blocks of size 2^( 4) =       0.000413381350
  error estimate for blocks of size 2^( 5) =       0.000418025971
  error estimate for blocks of size 2^( 6) =       0.000418718686
  error estimate for blocks of size 2^( 7) =       0.000419751410

      target function =                  N/A
              le_mean =     -17.215700343373
             les_mean =     296.694241826104
             stat err =       0.000417469354
             autocorr =       1.163561091166
              std dev =       0.547324643574
             le_variance =       0.299564265464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299602774493
                                         uncertainty =       0.002230204853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016967
  error estimate for blocks of size 2^( 2) =       0.000397359446
  error estimate for blocks of size 2^( 3) =       0.000406957767
  error estimate for blocks of size 2^( 4) =       0.000413381350
  error estimate for blocks of size 2^( 5) =       0.000418025971
  error estimate for blocks of size 2^( 6) =       0.000418718686
  error estimate for blocks of size 2^( 7) =       0.000419751410

      target function =                  N/A
              le_mean =     -17.215700343373
             les_mean =     296.694241826104
             stat err =       0.000417469354
             autocorr =       1.163561091168
              std dev =       0.547324643574
             le_variance =       0.299564265464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215700343373        initial  <--
     2.3283e+10     2.3283e+11             4.9976e-14       -17.215700343373
     9.3132e+10     9.3132e+11             1.2341e-14       -17.215700343373
     3.7253e+11     3.7253e+12             2.8540e-15       -17.215700343373

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8350
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.253944
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1350e-01
  Total weights = 1.956656836e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298468442078
                                         uncertainty =       0.002382203463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298468442078
                                         uncertainty =       0.002382203463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386277971
  error estimate for blocks of size 2^( 2) =       0.000396133853
  error estimate for blocks of size 2^( 3) =       0.000405306182
  error estimate for blocks of size 2^( 4) =       0.000411768838
  error estimate for blocks of size 2^( 5) =       0.000415727407
  error estimate for blocks of size 2^( 6) =       0.000417247884
  error estimate for blocks of size 2^( 7) =       0.000416481530

      target function =                  N/A
              le_mean =     -17.216723865781
             les_mean =     296.729081667824
             stat err =       0.000415306415
             autocorr =       1.155945597973
              std dev =       0.546279545517
             le_variance =       0.298421341850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672386578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723865804       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723865804       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723865804       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216702743672       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216745398532       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216307121745       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216748019063       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217005613653       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216665500589       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216557081929       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218517331714       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217425661307       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213626054860       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214381466307       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.218596995114       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214264459144       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213631552900       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.220211832133       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214772958718       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.198699674557       residual = 5.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.221727868825       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.202072950722       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216308815711       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.230331791156       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.195692411528       residual = 6.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.219119515585       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.203265243960       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.189658092365       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.241133032974       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.307546745784       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.156616896637       residual = 5.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.231080053086       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.204894379154       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.234565507235       residual = 5.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.233095326091       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.194420717044       residual = 7.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.169946324917       residual = 3.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.207484720485       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.216509817677       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.181909010364       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.193639973893       residual = 7.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.221177990290       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.216272099068       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.237611505678       residual = 9.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.234481550913       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.236808561449       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.214791880300       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.202857881030       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.227273148676       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.177312512586       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.257845584017       residual = 2.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.160374620345       residual = 6.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.209098209981       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.189313715671       residual = 1.18e-01           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.188422160199       residual = 1.56e-01           smallest_sin_value = 9.98e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.900598474053       residual = 1.60e+01           smallest_sin_value = 9.98e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.238458512629       residual = 3.60e-01           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.390695894534       residual = 4.26e+00           smallest_sin_value = 9.97e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.244028206678       residual = 6.62e-01           smallest_sin_value = 9.96e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+11 is 4.791685e-15

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723865804       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723865804       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723865804       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216287855426       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215704790511       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213883370512       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.220023390996       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.220818334188       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218342585529       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.211558825480       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.204181469994       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.229500272488       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215889651118       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212434429290       residual = 3.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215782434805       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.206041324463       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.211937350335       residual = 3.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216696063842       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.229654618246       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.207150568107       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.229421742155       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213134115782       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.246240403174       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.222695317770       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.242961506856       residual = 9.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.289453096023       residual = 7.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.188164927518       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.197173248673       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.255571007523       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.180901155168       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.178959106759       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.373063871925       residual = 3.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.249204291713       residual = 2.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.340578784643       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.003344340458       residual = 6.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -18.303253744754       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.480967522369       residual = 8.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.954129992582       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.615310338932       residual = 2.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.238866988001       residual = 8.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.110517821685       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.259792570097       residual = 6.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.459008003098       residual = 8.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.071229992239       residual = 3.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.253793869456       residual = 2.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.186889800205       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.011958697302       residual = 7.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.239811351124       residual = 6.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.049278644530       residual = 3.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.423164394753       residual = 6.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.926973051681       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.220886961023       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.223958783613       residual = 7.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.244898486262       residual = 4.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.285943299616       residual = 6.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.389921918031       residual = 4.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.362414501650       residual = 3.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -18.739829979849       residual = 3.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -15.725686309236       residual = 3.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -18.635782811694       residual = 3.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -15.290403046170       residual = 5.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -17.120688244356       residual = 6.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.919348228676       residual = 1.37e+01           smallest_sin_value = 9.98e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.182158746099       residual = 7.03e-01           smallest_sin_value = 9.97e-01
davidson iteration   64:   krylov dim =  65   energy =     -17.085863133943       residual = 3.56e+00           smallest_sin_value = 9.96e-01
davidson iteration   65:   krylov dim =  66   energy =     -17.491556593240       residual = 1.77e+01           smallest_sin_value = 9.92e-01
davidson iteration   66 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         66 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+11 is 4.308539e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216723865804       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216723865804       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216723865804       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216573133878       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216723865805       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.220098880369       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.204927062311       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.193304254867       residual = 8.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.276829514506       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.218333096257       residual = 4.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.152898117537       residual = 6.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.238312740332       residual = 8.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.410565491184       residual = 5.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.135916730903       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.127352070819       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.913736890275       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.374424851691       residual = 4.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.236228457995       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.340269492582       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.159067278051       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.181230578903       residual = 2.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.075977609181       residual = 3.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.229757902174       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.083906054231       residual = 4.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.346925131937       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.281521328360       residual = 5.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.178042937741       residual = 4.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.057913984943       residual = 5.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.446763013034       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.389068807427       residual = 5.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -18.389713089463       residual = 2.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -19.033488672458       residual = 5.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.342313859061       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.345670473332       residual = 2.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.137244320365       residual = 3.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.213123682215       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.203473510803       residual = 6.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.967148476308       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -19.321356597632       residual = 6.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.125252400074       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.968665187277       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -15.520229115103       residual = 5.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.355308437672       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.407774193304       residual = 9.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.704513099705       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.989945149488       residual = 9.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -18.339109407920       residual = 2.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.418567220595       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.228209239826       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.708332917364       residual = 6.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.880659222217       residual = 8.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.334720838270       residual = 8.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -18.289239967038       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.457149190505       residual = 9.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.367491429913       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.724925609443       residual = 7.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.411088784269       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -24.913144419333       residual = 9.67e+03           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -12.875510067814       residual = 2.76e+03           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -18.258340208281       residual = 2.78e+02           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.752796095709       residual = 2.55e+02           smallest_sin_value = 9.98e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.537398088160       residual = 1.09e+02           smallest_sin_value = 9.90e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+12 is 1.045888e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.986446 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7333e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1429
    reference variance = 0.17562
====================================================
  Execution time = 2.2986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1284e-01
  Total weights = 1.9566e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386514706
  error estimate for blocks of size 2^( 2) =       0.000396859959
  error estimate for blocks of size 2^( 3) =       0.000406328360
  error estimate for blocks of size 2^( 4) =       0.000413366181
  error estimate for blocks of size 2^( 5) =       0.000418038382
  error estimate for blocks of size 2^( 6) =       0.000421346677
  error estimate for blocks of size 2^( 7) =       0.000421102156

      target function =                  N/A
              le_mean =     -17.216320277297
             les_mean =     296.714523235030
             stat err =       0.000418463349
             autocorr =       1.172148967603
              std dev =       0.546614338652
             le_variance =       0.298787235220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386514706
  error estimate for blocks of size 2^( 2) =       0.000396859959
  error estimate for blocks of size 2^( 3) =       0.000406328360
  error estimate for blocks of size 2^( 4) =       0.000413366181
  error estimate for blocks of size 2^( 5) =       0.000418038382
  error estimate for blocks of size 2^( 6) =       0.000421346677
  error estimate for blocks of size 2^( 7) =       0.000421102156

      target function =                  N/A
              le_mean =     -17.216320277297
             les_mean =     296.714523235030
             stat err =       0.000418463349
             autocorr =       1.172148967603
              std dev =       0.546614338652
             le_variance =       0.298787235220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386514706
  error estimate for blocks of size 2^( 2) =       0.000396859959
  error estimate for blocks of size 2^( 3) =       0.000406328360
  error estimate for blocks of size 2^( 4) =       0.000413366181
  error estimate for blocks of size 2^( 5) =       0.000418038382
  error estimate for blocks of size 2^( 6) =       0.000421346677
  error estimate for blocks of size 2^( 7) =       0.000421102156

      target function =                  N/A
              le_mean =     -17.216320277297
             les_mean =     296.714523235030
             stat err =       0.000418463349
             autocorr =       1.172148967604
              std dev =       0.546614338652
             le_variance =       0.298787235220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793848561
                                         uncertainty =       0.002183382672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386514706
  error estimate for blocks of size 2^( 2) =       0.000396859959
  error estimate for blocks of size 2^( 3) =       0.000406328360
  error estimate for blocks of size 2^( 4) =       0.000413366181
  error estimate for blocks of size 2^( 5) =       0.000418038382
  error estimate for blocks of size 2^( 6) =       0.000421346677
  error estimate for blocks of size 2^( 7) =       0.000421102156

      target function =                  N/A
              le_mean =     -17.216320277297
             les_mean =     296.714523235030
             stat err =       0.000418463349
             autocorr =       1.172148967600
              std dev =       0.546614338652
             le_variance =       0.298787235220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216320277297        initial  <--
     2.3283e+11     2.3283e+12             4.7917e-15       -17.216320277297
     9.3132e+11     9.3132e+12             4.3085e-16       -17.216320277297
     3.7253e+12     3.7253e+13             1.0459e-16       -17.216320277297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1637
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1964
    reference variance = 0.178148
====================================================
  Execution time = 2.0791e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1034e-01
  Total weights = 1.956601148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294787127935
                                         uncertainty =       0.002015614381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294787127935
                                         uncertainty =       0.002015614381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383915548
  error estimate for blocks of size 2^( 2) =       0.000394511845
  error estimate for blocks of size 2^( 3) =       0.000403667552
  error estimate for blocks of size 2^( 4) =       0.000409998731
  error estimate for blocks of size 2^( 5) =       0.000414367396
  error estimate for blocks of size 2^( 6) =       0.000417354503
  error estimate for blocks of size 2^( 7) =       0.000417465371

      target function =                  N/A
              le_mean =     -17.216293161770
             les_mean =     296.711090793679
             stat err =       0.000414796500
             autocorr =       1.167343757728
              std dev =       0.542938574432
             le_variance =       0.294782295606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629316177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293161844       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293161844       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293161844       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293161844       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216293161844       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215102679760       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214184313539       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.232193057242       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.209836565362       residual = 6.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.221719998201       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.244791608822       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.236666963887       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.278464155302       residual = 6.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.193586285887       residual = 8.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.233372779185       residual = 5.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.249628430081       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.027838268770       residual = 5.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.429591886890       residual = 6.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.525189820060       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.231644757213       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.231982764020       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.229895061967       residual = 2.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.162744462725       residual = 4.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.188600191384       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.029515965233       residual = 5.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.114626643457       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.280965189031       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.268301997992       residual = 4.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.123887528516       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.334778121311       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.154640443895       residual = 6.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.247952993943       residual = 8.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.517661644808       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.145502415350       residual = 7.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.223926038929       residual = 7.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.033892138804       residual = 6.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.592546024676       residual = 2.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.579017582611       residual = 2.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.590449977325       residual = 6.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.001924877822       residual = 8.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.457097517372       residual = 8.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.355123560243       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.097481273940       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -18.186458737788       residual = 1.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.947930457454       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.022403425166       residual = 9.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.486865017771       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.614578432106       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.749931918839       residual = 3.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.783596790610       residual = 3.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -19.060268065222       residual = 5.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.265135831893       residual = 9.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -18.451124793407       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.174083201970       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.454924469774       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -18.147897401666       residual = 1.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.690638665644       residual = 4.35e+01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -15.601588695964       residual = 4.25e+02           smallest_sin_value = 9.96e-01
davidson iteration   58:   krylov dim =  59   energy =     -18.115348654725       residual = 1.28e+02           smallest_sin_value = 9.95e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.100291196661       residual = 1.86e+02           smallest_sin_value = 9.95e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.506467888605       residual = 2.62e+01           smallest_sin_value = 9.92e-01
davidson iteration   61 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         61 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+12 is 3.172684e-16

solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293161844       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293161844       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293161844       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.195766463319       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.221710605577       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.188043332895       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.208119070127       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.262866058133       residual = 4.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.281689912366       residual = 7.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.266557616507       residual = 3.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.082991146214       residual = 2.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.272272732102       residual = 5.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.116582549436       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.022655276056       residual = 5.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.210742497787       residual = 5.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.892331963929       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.123326712891       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.379638885882       residual = 4.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.081588328333       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.082845527658       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.243572864989       residual = 2.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.431170634193       residual = 7.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.487386515769       residual = 2.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.348761550423       residual = 4.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.252378895578       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.476117368137       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.168603841424       residual = 6.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.561262052108       residual = 2.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.590154003356       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.455402212048       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.365301112186       residual = 4.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.855577840114       residual = 2.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.896962924944       residual = 7.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -18.091726299253       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -18.214659772338       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.068652298144       residual = 5.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.438164182135       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -18.094547788583       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -18.398560762631       residual = 2.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.274601304054       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.916758139933       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -21.733730701912       residual = 3.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -24.786610160464       residual = 9.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.590603377474       residual = 7.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.561709303574       residual = 3.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -19.570321452908       residual = 9.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -18.063973705298       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -18.192482099595       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -15.266665408059       residual = 6.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.926415655983       residual = 3.69e+01           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   energy =     -15.897061022389       residual = 3.22e+02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   energy =     -16.340872547130       residual = 2.39e+02           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   energy =     -13.994139382159       residual = 1.66e+03           smallest_sin_value = 9.96e-01
davidson iteration   53:   krylov dim =  54   energy =     -19.322838438171       residual = 7.69e+02           smallest_sin_value = 9.95e-01
davidson iteration   54:   krylov dim =  55   energy =     -22.693995244712       residual = 5.03e+03           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+12 is 3.810989e-17

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216293161844       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216293161844       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216293161844       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216293161844       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.198158865686       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.157763412371       residual = 6.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.232504003881       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.278778463047       residual = 7.70e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.284174825507       residual = 8.67e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.156630235429       residual = 4.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.933159029330       residual = 1.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.831235061395       residual = 2.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.275877432702       residual = 9.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.320057425774       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.632044228011       residual = 5.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.637604969779       residual = 3.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.668770950269       residual = 3.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -19.536949734022       residual = 8.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -15.251982673560       residual = 6.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.201736104938       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.631495793682       residual = 3.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.304736419443       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.278505049351       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -18.097983678535       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -14.405666399679       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -19.789335217329       residual = 9.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.899295616400       residual = 2.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.613461699062       residual = 4.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -19.043141228549       residual = 4.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.942128985867       residual = 2.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -13.557436004912       residual = 2.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -20.539411838622       residual = 1.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -21.200290712048       residual = 2.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -18.903628446307       residual = 5.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =      -9.570480797448       residual = 9.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -21.652936976995       residual = 3.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -19.685980873919       residual = 1.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -15.512002728863       residual = 4.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -19.799928377227       residual = 9.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =      -8.999537251998       residual = 1.07e+04           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+13 is 8.879815e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.174159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7047e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.273717
====================================================
  Execution time = 2.0969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1596e-01
  Total weights = 1.9566e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387176614
  error estimate for blocks of size 2^( 2) =       0.000397202530
  error estimate for blocks of size 2^( 3) =       0.000406217522
  error estimate for blocks of size 2^( 4) =       0.000413699272
  error estimate for blocks of size 2^( 5) =       0.000418486856
  error estimate for blocks of size 2^( 6) =       0.000420980226
  error estimate for blocks of size 2^( 7) =       0.000422426425

      target function =                  N/A
              le_mean =     -17.216661845464
             les_mean =     296.729402537335
             stat err =       0.000418898195
             autocorr =       1.170573646025
              std dev =       0.547550418679
             le_variance =       0.299811460996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387176614
  error estimate for blocks of size 2^( 2) =       0.000397202530
  error estimate for blocks of size 2^( 3) =       0.000406217522
  error estimate for blocks of size 2^( 4) =       0.000413699272
  error estimate for blocks of size 2^( 5) =       0.000418486856
  error estimate for blocks of size 2^( 6) =       0.000420980226
  error estimate for blocks of size 2^( 7) =       0.000422426425

      target function =                  N/A
              le_mean =     -17.216661845464
             les_mean =     296.729402537335
             stat err =       0.000418898195
             autocorr =       1.170573646025
              std dev =       0.547550418679
             le_variance =       0.299811460996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387176614
  error estimate for blocks of size 2^( 2) =       0.000397202530
  error estimate for blocks of size 2^( 3) =       0.000406217522
  error estimate for blocks of size 2^( 4) =       0.000413699272
  error estimate for blocks of size 2^( 5) =       0.000418486856
  error estimate for blocks of size 2^( 6) =       0.000420980226
  error estimate for blocks of size 2^( 7) =       0.000422426425

      target function =                  N/A
              le_mean =     -17.216661845464
             les_mean =     296.729402537335
             stat err =       0.000418898195
             autocorr =       1.170573646023
              std dev =       0.547550418679
             le_variance =       0.299811460996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299840933499
                                         uncertainty =       0.001998477678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387176614
  error estimate for blocks of size 2^( 2) =       0.000397202530
  error estimate for blocks of size 2^( 3) =       0.000406217522
  error estimate for blocks of size 2^( 4) =       0.000413699272
  error estimate for blocks of size 2^( 5) =       0.000418486856
  error estimate for blocks of size 2^( 6) =       0.000420980226
  error estimate for blocks of size 2^( 7) =       0.000422426425

      target function =                  N/A
              le_mean =     -17.216661845464
             les_mean =     296.729402537335
             stat err =       0.000418898195
             autocorr =       1.170573646025
              std dev =       0.547550418679
             le_variance =       0.299811460996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216661845464        initial  <--
     2.3283e+12     2.3283e+13             3.1727e-16       -17.216661845464
     9.3132e+12     9.3132e+13             3.8110e-17       -17.216661845464
     3.7253e+13     3.7253e+14             8.8798e-18       -17.216661845464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1584
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1603
    reference variance = 0.332202
====================================================
  Execution time = 2.1292e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2072e-01
  Total weights = 1.956334188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303784661987
                                         uncertainty =       0.002421563762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303784661987
                                         uncertainty =       0.002421563762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389671155
  error estimate for blocks of size 2^( 2) =       0.000399654376
  error estimate for blocks of size 2^( 3) =       0.000408987477
  error estimate for blocks of size 2^( 4) =       0.000415686764
  error estimate for blocks of size 2^( 5) =       0.000420374357
  error estimate for blocks of size 2^( 6) =       0.000422917969
  error estimate for blocks of size 2^( 7) =       0.000423721092

      target function =                  N/A
              le_mean =     -17.215986664771
             les_mean =     296.710916282151
             stat err =       0.000420675046
             autocorr =       1.165458957446
              std dev =       0.551078231819
             le_variance =       0.303687217585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721598666477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215986664830       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.175343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7425e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.253088
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1243e-01
  Total weights = 1.9566e+06
  Execution time = 1.8122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386150725
  error estimate for blocks of size 2^( 2) =       0.000396055866
  error estimate for blocks of size 2^( 3) =       0.000405146225
  error estimate for blocks of size 2^( 4) =       0.000411812446
  error estimate for blocks of size 2^( 5) =       0.000416036716
  error estimate for blocks of size 2^( 6) =       0.000419107761
  error estimate for blocks of size 2^( 7) =       0.000419248877

      target function =                  N/A
              le_mean =     -17.216628384510
             les_mean =     296.724725296960
             stat err =       0.000416551450
             autocorr =       1.163653265268
              std dev =       0.546099592195
             le_variance =       0.298224764596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386150725
  error estimate for blocks of size 2^( 2) =       0.000396055866
  error estimate for blocks of size 2^( 3) =       0.000405146225
  error estimate for blocks of size 2^( 4) =       0.000411812446
  error estimate for blocks of size 2^( 5) =       0.000416036716
  error estimate for blocks of size 2^( 6) =       0.000419107761
  error estimate for blocks of size 2^( 7) =       0.000419248877

      target function =                  N/A
              le_mean =     -17.216628384510
             les_mean =     296.724725296960
             stat err =       0.000416551450
             autocorr =       1.163653265268
              std dev =       0.546099592195
             le_variance =       0.298224764596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386150725
  error estimate for blocks of size 2^( 2) =       0.000396055866
  error estimate for blocks of size 2^( 3) =       0.000405146225
  error estimate for blocks of size 2^( 4) =       0.000411812446
  error estimate for blocks of size 2^( 5) =       0.000416036716
  error estimate for blocks of size 2^( 6) =       0.000419107761
  error estimate for blocks of size 2^( 7) =       0.000419248877

      target function =                  N/A
              le_mean =     -17.216628384510
             les_mean =     296.724725296960
             stat err =       0.000416551450
             autocorr =       1.163653265268
              std dev =       0.546099592195
             le_variance =       0.298224764596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732232
                                         uncertainty =       0.002126849913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386150725
  error estimate for blocks of size 2^( 2) =       0.000396055866
  error estimate for blocks of size 2^( 3) =       0.000405146225
  error estimate for blocks of size 2^( 4) =       0.000411812446
  error estimate for blocks of size 2^( 5) =       0.000416036716
  error estimate for blocks of size 2^( 6) =       0.000419107761
  error estimate for blocks of size 2^( 7) =       0.000419248877

      target function =                  N/A
              le_mean =     -17.216628384510
             les_mean =     296.724725296960
             stat err =       0.000416551450
             autocorr =       1.163653265268
              std dev =       0.546099592195
             le_variance =       0.298224764596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216628384510        initial  <--
     2.3283e+13     2.3283e+14             0.0000e+00       -17.216628384510
     9.3132e+13     9.3132e+14             0.0000e+00       -17.216628384510
     3.7253e+14     3.7253e+15             0.0000e+00       -17.216628384510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9356
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7367e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.153196
====================================================
  Execution time = 2.0990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1343e-01
  Total weights = 1.956270329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298554131314
                                         uncertainty =       0.002094968468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298554131314
                                         uncertainty =       0.002094968468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386315236
  error estimate for blocks of size 2^( 2) =       0.000396491729
  error estimate for blocks of size 2^( 3) =       0.000406005348
  error estimate for blocks of size 2^( 4) =       0.000413041369
  error estimate for blocks of size 2^( 5) =       0.000416708799
  error estimate for blocks of size 2^( 6) =       0.000417872470
  error estimate for blocks of size 2^( 7) =       0.000418487367

      target function =                  N/A
              le_mean =     -17.216808276708
             les_mean =     296.731917225536
             stat err =       0.000416527501
             autocorr =       1.162528715879
              std dev =       0.546332245526
             le_variance =       0.298478922502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680827671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808276741       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.176499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6979e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.263605
====================================================
  Execution time = 2.0560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1243e-01
  Total weights = 1.9569e+06
  Execution time = 1.8102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350051
  error estimate for blocks of size 2^( 2) =       0.000396479109
  error estimate for blocks of size 2^( 3) =       0.000405599130
  error estimate for blocks of size 2^( 4) =       0.000412332641
  error estimate for blocks of size 2^( 5) =       0.000417264498
  error estimate for blocks of size 2^( 6) =       0.000421004137
  error estimate for blocks of size 2^( 7) =       0.000423717453

      target function =                  N/A
              le_mean =     -17.215348095261
             les_mean =     296.680637356526
             stat err =       0.000418579682
             autocorr =       1.173800637044
              std dev =       0.546381481447
             le_variance =       0.298532723268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350051
  error estimate for blocks of size 2^( 2) =       0.000396479109
  error estimate for blocks of size 2^( 3) =       0.000405599130
  error estimate for blocks of size 2^( 4) =       0.000412332641
  error estimate for blocks of size 2^( 5) =       0.000417264498
  error estimate for blocks of size 2^( 6) =       0.000421004137
  error estimate for blocks of size 2^( 7) =       0.000423717453

      target function =                  N/A
              le_mean =     -17.215348095261
             les_mean =     296.680637356526
             stat err =       0.000418579682
             autocorr =       1.173800637044
              std dev =       0.546381481447
             le_variance =       0.298532723268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350051
  error estimate for blocks of size 2^( 2) =       0.000396479109
  error estimate for blocks of size 2^( 3) =       0.000405599130
  error estimate for blocks of size 2^( 4) =       0.000412332641
  error estimate for blocks of size 2^( 5) =       0.000417264498
  error estimate for blocks of size 2^( 6) =       0.000421004137
  error estimate for blocks of size 2^( 7) =       0.000423717453

      target function =                  N/A
              le_mean =     -17.215348095261
             les_mean =     296.680637356526
             stat err =       0.000418579682
             autocorr =       1.173800637044
              std dev =       0.546381481447
             le_variance =       0.298532723268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298536661003
                                         uncertainty =       0.004767191007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386350051
  error estimate for blocks of size 2^( 2) =       0.000396479109
  error estimate for blocks of size 2^( 3) =       0.000405599130
  error estimate for blocks of size 2^( 4) =       0.000412332641
  error estimate for blocks of size 2^( 5) =       0.000417264498
  error estimate for blocks of size 2^( 6) =       0.000421004137
  error estimate for blocks of size 2^( 7) =       0.000423717453

      target function =                  N/A
              le_mean =     -17.215348095261
             les_mean =     296.680637356526
             stat err =       0.000418579682
             autocorr =       1.173800637044
              std dev =       0.546381481447
             le_variance =       0.298532723268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215348095261        initial  <--
     2.3283e+14     2.3283e+15             0.0000e+00       -17.215348095261
     9.3132e+14     9.3132e+15             0.0000e+00       -17.215348095261
     3.7253e+15     3.7253e+16             0.0000e+00       -17.215348095261

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7129
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2473
    reference variance = 0.261362
====================================================
  Execution time = 2.0859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1839e-01
  Total weights = 1.956650173e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302058222261
                                         uncertainty =       0.002044603834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302058222261
                                         uncertainty =       0.002044603834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388659892
  error estimate for blocks of size 2^( 2) =       0.000398228476
  error estimate for blocks of size 2^( 3) =       0.000407361593
  error estimate for blocks of size 2^( 4) =       0.000413524444
  error estimate for blocks of size 2^( 5) =       0.000417556654
  error estimate for blocks of size 2^( 6) =       0.000420689555
  error estimate for blocks of size 2^( 7) =       0.000423151628

      target function =                  N/A
              le_mean =     -17.216836238345
             les_mean =     296.737836869521
             stat err =       0.000418730570
             autocorr =       1.160726461433
              std dev =       0.549648090974
             le_variance =       0.302113023911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683623834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+16, overlap shift 3.7253e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216836238387       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.177674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6879e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2679
    reference variance = 0.183965
====================================================
  Execution time = 2.0530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1326e-01
  Total weights = 1.9564e+06
  Execution time = 1.8102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386870092
  error estimate for blocks of size 2^( 2) =       0.000396735424
  error estimate for blocks of size 2^( 3) =       0.000406128340
  error estimate for blocks of size 2^( 4) =       0.000412127247
  error estimate for blocks of size 2^( 5) =       0.000416639053
  error estimate for blocks of size 2^( 6) =       0.000419335239
  error estimate for blocks of size 2^( 7) =       0.000421421443

      target function =                  N/A
              le_mean =     -17.216362998119
             les_mean =     296.716415069811
             stat err =       0.000417380745
             autocorr =       1.163950488838
              std dev =       0.547116930804
             le_variance =       0.299336935972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386870092
  error estimate for blocks of size 2^( 2) =       0.000396735424
  error estimate for blocks of size 2^( 3) =       0.000406128340
  error estimate for blocks of size 2^( 4) =       0.000412127247
  error estimate for blocks of size 2^( 5) =       0.000416639053
  error estimate for blocks of size 2^( 6) =       0.000419335239
  error estimate for blocks of size 2^( 7) =       0.000421421443

      target function =                  N/A
              le_mean =     -17.216362998119
             les_mean =     296.716415069811
             stat err =       0.000417380745
             autocorr =       1.163950488838
              std dev =       0.547116930804
             le_variance =       0.299336935972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386870092
  error estimate for blocks of size 2^( 2) =       0.000396735424
  error estimate for blocks of size 2^( 3) =       0.000406128340
  error estimate for blocks of size 2^( 4) =       0.000412127247
  error estimate for blocks of size 2^( 5) =       0.000416639053
  error estimate for blocks of size 2^( 6) =       0.000419335239
  error estimate for blocks of size 2^( 7) =       0.000421421443

      target function =                  N/A
              le_mean =     -17.216362998119
             les_mean =     296.716415069811
             stat err =       0.000417380745
             autocorr =       1.163950488838
              std dev =       0.547116930804
             le_variance =       0.299336935972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299369999904
                                         uncertainty =       0.002075156989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386870092
  error estimate for blocks of size 2^( 2) =       0.000396735424
  error estimate for blocks of size 2^( 3) =       0.000406128340
  error estimate for blocks of size 2^( 4) =       0.000412127247
  error estimate for blocks of size 2^( 5) =       0.000416639053
  error estimate for blocks of size 2^( 6) =       0.000419335239
  error estimate for blocks of size 2^( 7) =       0.000421421443

      target function =                  N/A
              le_mean =     -17.216362998119
             les_mean =     296.716415069811
             stat err =       0.000417380745
             autocorr =       1.163950488838
              std dev =       0.547116930804
             le_variance =       0.299336935972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216362998119        initial  <--
     2.3283e+15     2.3283e+16             0.0000e+00       -17.216362998119
     9.3132e+15     9.3132e+16             0.0000e+00       -17.216362998119
     3.7253e+16     3.7253e+17             0.0000e+00       -17.216362998119

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7024
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1404
    reference variance = 0.309429
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1808e-01
  Total weights = 1.956118122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299028479833
                                         uncertainty =       0.001774424291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299028479833
                                         uncertainty =       0.001774424291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386628205
  error estimate for blocks of size 2^( 2) =       0.000396408059
  error estimate for blocks of size 2^( 3) =       0.000405477635
  error estimate for blocks of size 2^( 4) =       0.000412240215
  error estimate for blocks of size 2^( 5) =       0.000416172258
  error estimate for blocks of size 2^( 6) =       0.000418618083
  error estimate for blocks of size 2^( 7) =       0.000420332612

      target function =                  N/A
              le_mean =     -17.216461908254
             les_mean =     296.724641179171
             stat err =       0.000416840792
             autocorr =       1.162394000594
              std dev =       0.546774850432
             le_variance =       0.298962737064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646190825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+17, overlap shift 3.7253e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461908289       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.178863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6848e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.3023
    reference variance = 0.658042
====================================================
  Execution time = 2.2532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1495e-01
  Total weights = 1.9565e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644102
  error estimate for blocks of size 2^( 2) =       0.000396540584
  error estimate for blocks of size 2^( 3) =       0.000405578659
  error estimate for blocks of size 2^( 4) =       0.000412799278
  error estimate for blocks of size 2^( 5) =       0.000416672842
  error estimate for blocks of size 2^( 6) =       0.000418760803
  error estimate for blocks of size 2^( 7) =       0.000420388536

      target function =                  N/A
              le_mean =     -17.216506944833
             les_mean =     296.723063300701
             stat err =       0.000417155365
             autocorr =       1.164053354611
              std dev =       0.546797332833
             le_variance =       0.298987323193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644102
  error estimate for blocks of size 2^( 2) =       0.000396540584
  error estimate for blocks of size 2^( 3) =       0.000405578659
  error estimate for blocks of size 2^( 4) =       0.000412799278
  error estimate for blocks of size 2^( 5) =       0.000416672842
  error estimate for blocks of size 2^( 6) =       0.000418760803
  error estimate for blocks of size 2^( 7) =       0.000420388536

      target function =                  N/A
              le_mean =     -17.216506944833
             les_mean =     296.723063300701
             stat err =       0.000417155365
             autocorr =       1.164053354611
              std dev =       0.546797332833
             le_variance =       0.298987323193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644102
  error estimate for blocks of size 2^( 2) =       0.000396540584
  error estimate for blocks of size 2^( 3) =       0.000405578659
  error estimate for blocks of size 2^( 4) =       0.000412799278
  error estimate for blocks of size 2^( 5) =       0.000416672842
  error estimate for blocks of size 2^( 6) =       0.000418760803
  error estimate for blocks of size 2^( 7) =       0.000420388536

      target function =                  N/A
              le_mean =     -17.216506944833
             les_mean =     296.723063300701
             stat err =       0.000417155365
             autocorr =       1.164053354611
              std dev =       0.546797332833
             le_variance =       0.298987323193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298923000482
                                         uncertainty =       0.002570406684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644102
  error estimate for blocks of size 2^( 2) =       0.000396540584
  error estimate for blocks of size 2^( 3) =       0.000405578659
  error estimate for blocks of size 2^( 4) =       0.000412799278
  error estimate for blocks of size 2^( 5) =       0.000416672842
  error estimate for blocks of size 2^( 6) =       0.000418760803
  error estimate for blocks of size 2^( 7) =       0.000420388536

      target function =                  N/A
              le_mean =     -17.216506944833
             les_mean =     296.723063300701
             stat err =       0.000417155365
             autocorr =       1.164053354611
              std dev =       0.546797332833
             le_variance =       0.298987323193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216506944833        initial  <--
     2.3283e+16     2.3283e+17             0.0000e+00       -17.216506944833
     9.3132e+16     9.3132e+17             0.0000e+00       -17.216506944833
     3.7253e+17     3.7253e+18             0.0000e+00       -17.216506944833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7206
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2824
    reference variance = 0.145353
====================================================
  Execution time = 2.1241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1368e-01
  Total weights = 1.956546457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300007203974
                                         uncertainty =       0.002515620543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300007203974
                                         uncertainty =       0.002515620543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387235954
  error estimate for blocks of size 2^( 2) =       0.000397248442
  error estimate for blocks of size 2^( 3) =       0.000406167898
  error estimate for blocks of size 2^( 4) =       0.000412747304
  error estimate for blocks of size 2^( 5) =       0.000417227584
  error estimate for blocks of size 2^( 6) =       0.000418521831
  error estimate for blocks of size 2^( 7) =       0.000420278386

      target function =                  N/A
              le_mean =     -17.216107762902
             les_mean =     296.708044340351
             stat err =       0.000417193776
             autocorr =       1.160711519510
              std dev =       0.547634337600
             le_variance =       0.299903367719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721610776290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107762946       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+17 is 1.875320e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107762946       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+17 is 4.688299e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+18, overlap shift 3.7253e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107762946       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216107762946       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+18 is 1.172075e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.180275 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7320e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.264304
====================================================
  Execution time = 2.0823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1771e-01
  Total weights = 1.9564e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832018
  error estimate for blocks of size 2^( 2) =       0.000398487577
  error estimate for blocks of size 2^( 3) =       0.000407879246
  error estimate for blocks of size 2^( 4) =       0.000415080547
  error estimate for blocks of size 2^( 5) =       0.000419247535
  error estimate for blocks of size 2^( 6) =       0.000420321665
  error estimate for blocks of size 2^( 7) =       0.000422810445

      target function =                  N/A
              le_mean =     -17.216035921059
             les_mean =     296.709601685298
             stat err =       0.000419365048
             autocorr =       1.163216150151
              std dev =       0.549891513592
             le_variance =       0.302380676720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832018
  error estimate for blocks of size 2^( 2) =       0.000398487577
  error estimate for blocks of size 2^( 3) =       0.000407879246
  error estimate for blocks of size 2^( 4) =       0.000415080547
  error estimate for blocks of size 2^( 5) =       0.000419247535
  error estimate for blocks of size 2^( 6) =       0.000420321665
  error estimate for blocks of size 2^( 7) =       0.000422810445

      target function =                  N/A
              le_mean =     -17.216035921059
             les_mean =     296.709601685298
             stat err =       0.000419365048
             autocorr =       1.163216150151
              std dev =       0.549891513592
             le_variance =       0.302380676720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832018
  error estimate for blocks of size 2^( 2) =       0.000398487577
  error estimate for blocks of size 2^( 3) =       0.000407879246
  error estimate for blocks of size 2^( 4) =       0.000415080547
  error estimate for blocks of size 2^( 5) =       0.000419247535
  error estimate for blocks of size 2^( 6) =       0.000420321665
  error estimate for blocks of size 2^( 7) =       0.000422810445

      target function =                  N/A
              le_mean =     -17.216035921059
             les_mean =     296.709601685298
             stat err =       0.000419365048
             autocorr =       1.163216150151
              std dev =       0.549891513592
             le_variance =       0.302380676720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240965816
                                         uncertainty =       0.002438251951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832018
  error estimate for blocks of size 2^( 2) =       0.000398487577
  error estimate for blocks of size 2^( 3) =       0.000407879246
  error estimate for blocks of size 2^( 4) =       0.000415080547
  error estimate for blocks of size 2^( 5) =       0.000419247535
  error estimate for blocks of size 2^( 6) =       0.000420321665
  error estimate for blocks of size 2^( 7) =       0.000422810445

      target function =                  N/A
              le_mean =     -17.216035921059
             les_mean =     296.709601685298
             stat err =       0.000419365048
             autocorr =       1.163216150151
              std dev =       0.549891513592
             le_variance =       0.302380676720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216035921059        initial  <--
     2.3283e+17     2.3283e+18             1.8753e-21       -17.216035921059
     9.3132e+17     9.3132e+18             4.6883e-22       -17.216035921059
     3.7253e+18     3.7253e+19             1.1721e-22       -17.216035921059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9934
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.201354
====================================================
  Execution time = 2.0806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1525e-01
  Total weights = 1.956485822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300096510504
                                         uncertainty =       0.003319409052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300096510504
                                         uncertainty =       0.003319409052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387383377
  error estimate for blocks of size 2^( 2) =       0.000397344658
  error estimate for blocks of size 2^( 3) =       0.000407001096
  error estimate for blocks of size 2^( 4) =       0.000414341763
  error estimate for blocks of size 2^( 5) =       0.000417921695
  error estimate for blocks of size 2^( 6) =       0.000421280768
  error estimate for blocks of size 2^( 7) =       0.000423473161

      target function =                  N/A
              le_mean =     -17.216928634421
             les_mean =     296.737877801820
             stat err =       0.000419254347
             autocorr =       1.171313605996
              std dev =       0.547842824967
             le_variance =       0.300131760868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692863442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+19, overlap shift 3.7253e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928634469       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.181473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6939e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.243703
====================================================
  Execution time = 2.1201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1289e-01
  Total weights = 1.9565e+06
  Execution time = 1.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076479
  error estimate for blocks of size 2^( 2) =       0.000397362573
  error estimate for blocks of size 2^( 3) =       0.000406109686
  error estimate for blocks of size 2^( 4) =       0.000413035822
  error estimate for blocks of size 2^( 5) =       0.000416584746
  error estimate for blocks of size 2^( 6) =       0.000417258064
  error estimate for blocks of size 2^( 7) =       0.000418495555

      target function =                  N/A
              le_mean =     -17.216760713313
             les_mean =     296.729738102407
             stat err =       0.000416343547
             autocorr =       1.156938066298
              std dev =       0.547408806737
             le_variance =       0.299656401694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076479
  error estimate for blocks of size 2^( 2) =       0.000397362573
  error estimate for blocks of size 2^( 3) =       0.000406109686
  error estimate for blocks of size 2^( 4) =       0.000413035822
  error estimate for blocks of size 2^( 5) =       0.000416584746
  error estimate for blocks of size 2^( 6) =       0.000417258064
  error estimate for blocks of size 2^( 7) =       0.000418495555

      target function =                  N/A
              le_mean =     -17.216760713313
             les_mean =     296.729738102407
             stat err =       0.000416343547
             autocorr =       1.156938066298
              std dev =       0.547408806737
             le_variance =       0.299656401694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076479
  error estimate for blocks of size 2^( 2) =       0.000397362573
  error estimate for blocks of size 2^( 3) =       0.000406109686
  error estimate for blocks of size 2^( 4) =       0.000413035822
  error estimate for blocks of size 2^( 5) =       0.000416584746
  error estimate for blocks of size 2^( 6) =       0.000417258064
  error estimate for blocks of size 2^( 7) =       0.000418495555

      target function =                  N/A
              le_mean =     -17.216760713313
             les_mean =     296.729738102407
             stat err =       0.000416343547
             autocorr =       1.156938066298
              std dev =       0.547408806737
             le_variance =       0.299656401694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299666015484
                                         uncertainty =       0.002001536380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387076479
  error estimate for blocks of size 2^( 2) =       0.000397362573
  error estimate for blocks of size 2^( 3) =       0.000406109686
  error estimate for blocks of size 2^( 4) =       0.000413035822
  error estimate for blocks of size 2^( 5) =       0.000416584746
  error estimate for blocks of size 2^( 6) =       0.000417258064
  error estimate for blocks of size 2^( 7) =       0.000418495555

      target function =                  N/A
              le_mean =     -17.216760713313
             les_mean =     296.729738102407
             stat err =       0.000416343547
             autocorr =       1.156938066298
              std dev =       0.547408806737
             le_variance =       0.299656401694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216760713313        initial  <--
     2.3283e+18     2.3283e+19             0.0000e+00       -17.216760713313
     9.3132e+18     9.3132e+19             0.0000e+00       -17.216760713313
     3.7253e+19     3.7253e+20             0.0000e+00       -17.216760713313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4195
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2375
    reference variance = 0.250769
====================================================
  Execution time = 2.1257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1916e-01
  Total weights = 1.956412509e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299160151722
                                         uncertainty =       0.003053423148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299160151722
                                         uncertainty =       0.003053423148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386737027
  error estimate for blocks of size 2^( 2) =       0.000396637958
  error estimate for blocks of size 2^( 3) =       0.000405738967
  error estimate for blocks of size 2^( 4) =       0.000413242231
  error estimate for blocks of size 2^( 5) =       0.000418134603
  error estimate for blocks of size 2^( 6) =       0.000418703727
  error estimate for blocks of size 2^( 7) =       0.000420838426

      target function =                  N/A
              le_mean =     -17.215930146897
             les_mean =     296.707408708931
             stat err =       0.000417729747
             autocorr =       1.166700264398
              std dev =       0.546928748937
             le_variance =       0.299131056414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593014690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+20, overlap shift 3.7253e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215930146902       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.182669 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7359e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.171407
====================================================
  Execution time = 2.0799e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0803e-01
  Total weights = 1.9565e+06
  Execution time = 1.8139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383694384
  error estimate for blocks of size 2^( 2) =       0.000393916271
  error estimate for blocks of size 2^( 3) =       0.000403153147
  error estimate for blocks of size 2^( 4) =       0.000409447652
  error estimate for blocks of size 2^( 5) =       0.000414248510
  error estimate for blocks of size 2^( 6) =       0.000417990439
  error estimate for blocks of size 2^( 7) =       0.000418837727

      target function =                  N/A
              le_mean =     -17.216746080030
             les_mean =     296.724379191861
             stat err =       0.000415131082
             autocorr =       1.170576006496
              std dev =       0.542625801395
             le_variance =       0.294442760339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383694384
  error estimate for blocks of size 2^( 2) =       0.000393916271
  error estimate for blocks of size 2^( 3) =       0.000403153147
  error estimate for blocks of size 2^( 4) =       0.000409447652
  error estimate for blocks of size 2^( 5) =       0.000414248510
  error estimate for blocks of size 2^( 6) =       0.000417990439
  error estimate for blocks of size 2^( 7) =       0.000418837727

      target function =                  N/A
              le_mean =     -17.216746080030
             les_mean =     296.724379191861
             stat err =       0.000415131082
             autocorr =       1.170576006496
              std dev =       0.542625801395
             le_variance =       0.294442760339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383694384
  error estimate for blocks of size 2^( 2) =       0.000393916271
  error estimate for blocks of size 2^( 3) =       0.000403153147
  error estimate for blocks of size 2^( 4) =       0.000409447652
  error estimate for blocks of size 2^( 5) =       0.000414248510
  error estimate for blocks of size 2^( 6) =       0.000417990439
  error estimate for blocks of size 2^( 7) =       0.000418837727

      target function =                  N/A
              le_mean =     -17.216746080030
             les_mean =     296.724379191861
             stat err =       0.000415131082
             autocorr =       1.170576006496
              std dev =       0.542625801395
             le_variance =       0.294442760339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294433575308
                                         uncertainty =       0.001549362109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383694384
  error estimate for blocks of size 2^( 2) =       0.000393916271
  error estimate for blocks of size 2^( 3) =       0.000403153147
  error estimate for blocks of size 2^( 4) =       0.000409447652
  error estimate for blocks of size 2^( 5) =       0.000414248510
  error estimate for blocks of size 2^( 6) =       0.000417990439
  error estimate for blocks of size 2^( 7) =       0.000418837727

      target function =                  N/A
              le_mean =     -17.216746080030
             les_mean =     296.724379191861
             stat err =       0.000415131082
             autocorr =       1.170576006496
              std dev =       0.542625801395
             le_variance =       0.294442760339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216746080030        initial  <--
     2.3283e+19     2.3283e+20             0.0000e+00       -17.216746080030
     9.3132e+19     9.3132e+20             0.0000e+00       -17.216746080030
     3.7253e+20     3.7253e+21             0.0000e+00       -17.216746080030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9776
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2332
    reference variance = 0.238546
====================================================
  Execution time = 2.1237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0741e-01
  Total weights = 1.956479663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294138613903
                                         uncertainty =       0.001668979565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294138613903
                                         uncertainty =       0.001668979565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383432137
  error estimate for blocks of size 2^( 2) =       0.000393503699
  error estimate for blocks of size 2^( 3) =       0.000402973581
  error estimate for blocks of size 2^( 4) =       0.000409391144
  error estimate for blocks of size 2^( 5) =       0.000413081213
  error estimate for blocks of size 2^( 6) =       0.000416548893
  error estimate for blocks of size 2^( 7) =       0.000419370556

      target function =                  N/A
              le_mean =     -17.216387417450
             les_mean =     296.711408345508
             stat err =       0.000414597951
             autocorr =       1.169168977322
              std dev =       0.542254928639
             le_variance =       0.294040407633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638741745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+21, overlap shift 3.7253e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216387417523       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.183856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7280e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2059
    reference variance = 0.166439
====================================================
  Execution time = 2.0907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1543e-01
  Total weights = 1.9569e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388556376
  error estimate for blocks of size 2^( 2) =       0.000398757897
  error estimate for blocks of size 2^( 3) =       0.000408241298
  error estimate for blocks of size 2^( 4) =       0.000415084704
  error estimate for blocks of size 2^( 5) =       0.000419474823
  error estimate for blocks of size 2^( 6) =       0.000421616177
  error estimate for blocks of size 2^( 7) =       0.000420761368

      target function =                  N/A
              le_mean =     -17.215988655930
             les_mean =     296.705693321040
             stat err =       0.000419234268
             autocorr =       1.164140686657
              std dev =       0.549501697360
             le_variance =       0.301952115402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388556376
  error estimate for blocks of size 2^( 2) =       0.000398757897
  error estimate for blocks of size 2^( 3) =       0.000408241298
  error estimate for blocks of size 2^( 4) =       0.000415084704
  error estimate for blocks of size 2^( 5) =       0.000419474823
  error estimate for blocks of size 2^( 6) =       0.000421616177
  error estimate for blocks of size 2^( 7) =       0.000420761368

      target function =                  N/A
              le_mean =     -17.215988655930
             les_mean =     296.705693321040
             stat err =       0.000419234268
             autocorr =       1.164140686657
              std dev =       0.549501697360
             le_variance =       0.301952115402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388556376
  error estimate for blocks of size 2^( 2) =       0.000398757897
  error estimate for blocks of size 2^( 3) =       0.000408241298
  error estimate for blocks of size 2^( 4) =       0.000415084704
  error estimate for blocks of size 2^( 5) =       0.000419474823
  error estimate for blocks of size 2^( 6) =       0.000421616177
  error estimate for blocks of size 2^( 7) =       0.000420761368

      target function =                  N/A
              le_mean =     -17.215988655930
             les_mean =     296.705693321040
             stat err =       0.000419234268
             autocorr =       1.164140686657
              std dev =       0.549501697360
             le_variance =       0.301952115402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301943733184
                                         uncertainty =       0.002510194514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388556376
  error estimate for blocks of size 2^( 2) =       0.000398757897
  error estimate for blocks of size 2^( 3) =       0.000408241298
  error estimate for blocks of size 2^( 4) =       0.000415084704
  error estimate for blocks of size 2^( 5) =       0.000419474823
  error estimate for blocks of size 2^( 6) =       0.000421616177
  error estimate for blocks of size 2^( 7) =       0.000420761368

      target function =                  N/A
              le_mean =     -17.215988655930
             les_mean =     296.705693321040
             stat err =       0.000419234268
             autocorr =       1.164140686657
              std dev =       0.549501697360
             le_variance =       0.301952115402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215988655930        initial  <--
     2.3283e+20     2.3283e+21             0.0000e+00       -17.215988655930
     9.3132e+20     9.3132e+21             0.0000e+00       -17.215988655930
     3.7253e+21     3.7253e+22             0.0000e+00       -17.215988655930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1091
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7396e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2097
    reference variance = 0.262932
====================================================
  Execution time = 2.1097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1979e-01
  Total weights = 1.956630345e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303301238156
                                         uncertainty =       0.002231567768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303301238156
                                         uncertainty =       0.002231567768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389386271
  error estimate for blocks of size 2^( 2) =       0.000399490126
  error estimate for blocks of size 2^( 3) =       0.000408511828
  error estimate for blocks of size 2^( 4) =       0.000414979146
  error estimate for blocks of size 2^( 5) =       0.000419957605
  error estimate for blocks of size 2^( 6) =       0.000420018360
  error estimate for blocks of size 2^( 7) =       0.000422590080

      target function =                  N/A
              le_mean =     -17.217542579700
             les_mean =     296.763557967204
             stat err =       0.000419386298
             autocorr =       1.160024610695
              std dev =       0.550675345816
             le_variance =       0.303243336490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721754257970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+22, overlap shift 3.7253e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542579800       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.185052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7336e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.155
    reference variance = 0.197306
====================================================
  Execution time = 2.0801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1242e-01
  Total weights = 1.9563e+06
  Execution time = 1.8138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387265873
  error estimate for blocks of size 2^( 2) =       0.000397081021
  error estimate for blocks of size 2^( 3) =       0.000406265955
  error estimate for blocks of size 2^( 4) =       0.000412887377
  error estimate for blocks of size 2^( 5) =       0.000416542918
  error estimate for blocks of size 2^( 6) =       0.000418486664
  error estimate for blocks of size 2^( 7) =       0.000419591817

      target function =                  N/A
              le_mean =     -17.216439891633
             les_mean =     296.718222510077
             stat err =       0.000416877194
             autocorr =       1.158771539330
              std dev =       0.547676649470
             le_variance =       0.299949712374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387265873
  error estimate for blocks of size 2^( 2) =       0.000397081021
  error estimate for blocks of size 2^( 3) =       0.000406265955
  error estimate for blocks of size 2^( 4) =       0.000412887377
  error estimate for blocks of size 2^( 5) =       0.000416542918
  error estimate for blocks of size 2^( 6) =       0.000418486664
  error estimate for blocks of size 2^( 7) =       0.000419591817

      target function =                  N/A
              le_mean =     -17.216439891633
             les_mean =     296.718222510077
             stat err =       0.000416877194
             autocorr =       1.158771539330
              std dev =       0.547676649470
             le_variance =       0.299949712374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387265873
  error estimate for blocks of size 2^( 2) =       0.000397081021
  error estimate for blocks of size 2^( 3) =       0.000406265955
  error estimate for blocks of size 2^( 4) =       0.000412887377
  error estimate for blocks of size 2^( 5) =       0.000416542918
  error estimate for blocks of size 2^( 6) =       0.000418486664
  error estimate for blocks of size 2^( 7) =       0.000419591817

      target function =                  N/A
              le_mean =     -17.216439891633
             les_mean =     296.718222510077
             stat err =       0.000416877194
             autocorr =       1.158771539330
              std dev =       0.547676649470
             le_variance =       0.299949712374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299994427316
                                         uncertainty =       0.002563687683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387265873
  error estimate for blocks of size 2^( 2) =       0.000397081021
  error estimate for blocks of size 2^( 3) =       0.000406265955
  error estimate for blocks of size 2^( 4) =       0.000412887377
  error estimate for blocks of size 2^( 5) =       0.000416542918
  error estimate for blocks of size 2^( 6) =       0.000418486664
  error estimate for blocks of size 2^( 7) =       0.000419591817

      target function =                  N/A
              le_mean =     -17.216439891633
             les_mean =     296.718222510077
             stat err =       0.000416877194
             autocorr =       1.158771539330
              std dev =       0.547676649470
             le_variance =       0.299949712374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216439891633        initial  <--
     2.3283e+21     2.3283e+22             0.0000e+00       -17.216439891633
     9.3132e+21     9.3132e+22             0.0000e+00       -17.216439891633
     3.7253e+22     3.7253e+23             0.0000e+00       -17.216439891633

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.6756
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.273
    reference variance = 0.294861
====================================================
  Execution time = 2.1189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1452e-01
  Total weights = 1.956514541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300573582592
                                         uncertainty =       0.002241328524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300573582592
                                         uncertainty =       0.002241328524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387671160
  error estimate for blocks of size 2^( 2) =       0.000397382044
  error estimate for blocks of size 2^( 3) =       0.000406672052
  error estimate for blocks of size 2^( 4) =       0.000413488079
  error estimate for blocks of size 2^( 5) =       0.000417302257
  error estimate for blocks of size 2^( 6) =       0.000419161362
  error estimate for blocks of size 2^( 7) =       0.000419525807

      target function =                  N/A
              le_mean =     -17.216270760062
             les_mean =     296.714502462985
             stat err =       0.000417369376
             autocorr =       1.159082031605
              std dev =       0.548249811730
             le_variance =       0.300577856062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627076006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+22, overlap shift 2.3283e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216270760103       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+22 is 1.419657e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216270760103       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+22 is 3.549143e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+23, overlap shift 3.7253e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216270760103       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216270760103       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+23 is 8.872858e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.186587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7138e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.296
    reference variance = 0.627193
====================================================
  Execution time = 2.0560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1117e-01
  Total weights = 1.9564e+06
  Execution time = 1.8101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385523647
  error estimate for blocks of size 2^( 2) =       0.000395958803
  error estimate for blocks of size 2^( 3) =       0.000404841042
  error estimate for blocks of size 2^( 4) =       0.000411437143
  error estimate for blocks of size 2^( 5) =       0.000415965265
  error estimate for blocks of size 2^( 6) =       0.000418047401
  error estimate for blocks of size 2^( 7) =       0.000421394765

      target function =                  N/A
              le_mean =     -17.216420679494
             les_mean =     296.716315912228
             stat err =       0.000416711144
             autocorr =       1.168337149628
              std dev =       0.545212769640
             le_variance =       0.297256964178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385523647
  error estimate for blocks of size 2^( 2) =       0.000395958803
  error estimate for blocks of size 2^( 3) =       0.000404841042
  error estimate for blocks of size 2^( 4) =       0.000411437143
  error estimate for blocks of size 2^( 5) =       0.000415965265
  error estimate for blocks of size 2^( 6) =       0.000418047401
  error estimate for blocks of size 2^( 7) =       0.000421394765

      target function =                  N/A
              le_mean =     -17.216420679494
             les_mean =     296.716315912228
             stat err =       0.000416711144
             autocorr =       1.168337149628
              std dev =       0.545212769640
             le_variance =       0.297256964178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385523647
  error estimate for blocks of size 2^( 2) =       0.000395958803
  error estimate for blocks of size 2^( 3) =       0.000404841042
  error estimate for blocks of size 2^( 4) =       0.000411437143
  error estimate for blocks of size 2^( 5) =       0.000415965265
  error estimate for blocks of size 2^( 6) =       0.000418047401
  error estimate for blocks of size 2^( 7) =       0.000421394765

      target function =                  N/A
              le_mean =     -17.216420679494
             les_mean =     296.716315912228
             stat err =       0.000416711144
             autocorr =       1.168337149628
              std dev =       0.545212769640
             le_variance =       0.297256964178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297195337090
                                         uncertainty =       0.001839953759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385523647
  error estimate for blocks of size 2^( 2) =       0.000395958803
  error estimate for blocks of size 2^( 3) =       0.000404841042
  error estimate for blocks of size 2^( 4) =       0.000411437143
  error estimate for blocks of size 2^( 5) =       0.000415965265
  error estimate for blocks of size 2^( 6) =       0.000418047401
  error estimate for blocks of size 2^( 7) =       0.000421394765

      target function =                  N/A
              le_mean =     -17.216420679494
             les_mean =     296.716315912228
             stat err =       0.000416711144
             autocorr =       1.168337149628
              std dev =       0.545212769640
             le_variance =       0.297256964178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420679494        initial  <--
     2.3283e+22     2.3283e+23             1.4197e-26       -17.216420679494
     9.3132e+22     9.3132e+23             3.5491e-27       -17.216420679494
     3.7253e+23     3.7253e+24             8.8729e-28       -17.216420679494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7209
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.20335
====================================================
  Execution time = 2.0851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2787e-01
  Total weights = 1.956778794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304526840142
                                         uncertainty =       0.005011882062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304526840142
                                         uncertainty =       0.005011882062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390193074
  error estimate for blocks of size 2^( 2) =       0.000400298436
  error estimate for blocks of size 2^( 3) =       0.000408563295
  error estimate for blocks of size 2^( 4) =       0.000415502640
  error estimate for blocks of size 2^( 5) =       0.000419328137
  error estimate for blocks of size 2^( 6) =       0.000421940987
  error estimate for blocks of size 2^( 7) =       0.000422328018

      target function =                  N/A
              le_mean =     -17.216006357359
             les_mean =     296.718740068005
             stat err =       0.000419774946
             autocorr =       1.157374512756
              std dev =       0.551816337869
             le_variance =       0.304501270739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721600635736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+23, overlap shift 2.3283e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+24, overlap shift 3.7253e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216006357354       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.187789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7018e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2905
    reference variance = 0.419001
====================================================
  Execution time = 2.0700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1930e-01
  Total weights = 1.9567e+06
  Execution time = 1.8101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694925
  error estimate for blocks of size 2^( 2) =       0.000397758853
  error estimate for blocks of size 2^( 3) =       0.000407105796
  error estimate for blocks of size 2^( 4) =       0.000413713703
  error estimate for blocks of size 2^( 5) =       0.000417364721
  error estimate for blocks of size 2^( 6) =       0.000419978174
  error estimate for blocks of size 2^( 7) =       0.000420079888

      target function =                  N/A
              le_mean =     -17.216392649991
             les_mean =     296.723475116031
             stat err =       0.000417784121
             autocorr =       1.161244389604
              std dev =       0.548283420367
             le_variance =       0.300614709049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694925
  error estimate for blocks of size 2^( 2) =       0.000397758853
  error estimate for blocks of size 2^( 3) =       0.000407105796
  error estimate for blocks of size 2^( 4) =       0.000413713703
  error estimate for blocks of size 2^( 5) =       0.000417364721
  error estimate for blocks of size 2^( 6) =       0.000419978174
  error estimate for blocks of size 2^( 7) =       0.000420079888

      target function =                  N/A
              le_mean =     -17.216392649991
             les_mean =     296.723475116031
             stat err =       0.000417784121
             autocorr =       1.161244389604
              std dev =       0.548283420367
             le_variance =       0.300614709049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694925
  error estimate for blocks of size 2^( 2) =       0.000397758853
  error estimate for blocks of size 2^( 3) =       0.000407105796
  error estimate for blocks of size 2^( 4) =       0.000413713703
  error estimate for blocks of size 2^( 5) =       0.000417364721
  error estimate for blocks of size 2^( 6) =       0.000419978174
  error estimate for blocks of size 2^( 7) =       0.000420079888

      target function =                  N/A
              le_mean =     -17.216392649991
             les_mean =     296.723475116031
             stat err =       0.000417784121
             autocorr =       1.161244389604
              std dev =       0.548283420367
             le_variance =       0.300614709049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300624657610
                                         uncertainty =       0.003237123568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694925
  error estimate for blocks of size 2^( 2) =       0.000397758853
  error estimate for blocks of size 2^( 3) =       0.000407105796
  error estimate for blocks of size 2^( 4) =       0.000413713703
  error estimate for blocks of size 2^( 5) =       0.000417364721
  error estimate for blocks of size 2^( 6) =       0.000419978174
  error estimate for blocks of size 2^( 7) =       0.000420079888

      target function =                  N/A
              le_mean =     -17.216392649991
             les_mean =     296.723475116031
             stat err =       0.000417784121
             autocorr =       1.161244389604
              std dev =       0.548283420367
             le_variance =       0.300614709049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216392649991        initial  <--
     2.3283e+23     2.3283e+24             0.0000e+00       -17.216392649991
     9.3132e+23     9.3132e+24             0.0000e+00       -17.216392649991
     3.7253e+24     3.7253e+25             0.0000e+00       -17.216392649991

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8534
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2186
    reference variance = 0.427106
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1107e-01
  Total weights = 1.956436492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297920737895
                                         uncertainty =       0.002123126797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297920737895
                                         uncertainty =       0.002123126797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386017504
  error estimate for blocks of size 2^( 2) =       0.000396141873
  error estimate for blocks of size 2^( 3) =       0.000405840705
  error estimate for blocks of size 2^( 4) =       0.000412596430
  error estimate for blocks of size 2^( 5) =       0.000415840552
  error estimate for blocks of size 2^( 6) =       0.000419358446
  error estimate for blocks of size 2^( 7) =       0.000422521332

      target function =                  N/A
              le_mean =     -17.216615867495
             les_mean =     296.722934603649
             stat err =       0.000417579190
             autocorr =       1.170209712655
              std dev =       0.545911189279
             le_variance =       0.298019026580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661586749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+24, overlap shift 2.3283e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+25, overlap shift 3.7253e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615867551       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.188976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6845e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2359
    reference variance = 0.232449
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1332e-01
  Total weights = 1.9564e+06
  Execution time = 1.8116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386700795
  error estimate for blocks of size 2^( 2) =       0.000396717587
  error estimate for blocks of size 2^( 3) =       0.000405210550
  error estimate for blocks of size 2^( 4) =       0.000411697446
  error estimate for blocks of size 2^( 5) =       0.000414645637
  error estimate for blocks of size 2^( 6) =       0.000416762473
  error estimate for blocks of size 2^( 7) =       0.000421035098

      target function =                  N/A
              le_mean =     -17.216168934138
             les_mean =     296.709791571714
             stat err =       0.000416035163
             autocorr =       1.157470545875
              std dev =       0.546877508678
             le_variance =       0.299075009498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386700795
  error estimate for blocks of size 2^( 2) =       0.000396717587
  error estimate for blocks of size 2^( 3) =       0.000405210550
  error estimate for blocks of size 2^( 4) =       0.000411697446
  error estimate for blocks of size 2^( 5) =       0.000414645637
  error estimate for blocks of size 2^( 6) =       0.000416762473
  error estimate for blocks of size 2^( 7) =       0.000421035098

      target function =                  N/A
              le_mean =     -17.216168934138
             les_mean =     296.709791571714
             stat err =       0.000416035163
             autocorr =       1.157470545875
              std dev =       0.546877508678
             le_variance =       0.299075009498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386700795
  error estimate for blocks of size 2^( 2) =       0.000396717587
  error estimate for blocks of size 2^( 3) =       0.000405210550
  error estimate for blocks of size 2^( 4) =       0.000411697446
  error estimate for blocks of size 2^( 5) =       0.000414645637
  error estimate for blocks of size 2^( 6) =       0.000416762473
  error estimate for blocks of size 2^( 7) =       0.000421035098

      target function =                  N/A
              le_mean =     -17.216168934138
             les_mean =     296.709791571714
             stat err =       0.000416035163
             autocorr =       1.157470545875
              std dev =       0.546877508678
             le_variance =       0.299075009498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999506701
                                         uncertainty =       0.002278829890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386700795
  error estimate for blocks of size 2^( 2) =       0.000396717587
  error estimate for blocks of size 2^( 3) =       0.000405210550
  error estimate for blocks of size 2^( 4) =       0.000411697446
  error estimate for blocks of size 2^( 5) =       0.000414645637
  error estimate for blocks of size 2^( 6) =       0.000416762473
  error estimate for blocks of size 2^( 7) =       0.000421035098

      target function =                  N/A
              le_mean =     -17.216168934138
             les_mean =     296.709791571714
             stat err =       0.000416035163
             autocorr =       1.157470545875
              std dev =       0.546877508678
             le_variance =       0.299075009498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216168934138        initial  <--
     2.3283e+24     2.3283e+25             0.0000e+00       -17.216168934138
     9.3132e+24     9.3132e+25             0.0000e+00       -17.216168934138
     3.7253e+25     3.7253e+26             0.0000e+00       -17.216168934138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9278
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.0356
    reference variance = 0.158505
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1546e-01
  Total weights = 1.956537880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301072694235
                                         uncertainty =       0.001768924169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301072694235
                                         uncertainty =       0.001768924169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388005510
  error estimate for blocks of size 2^( 2) =       0.000398107997
  error estimate for blocks of size 2^( 3) =       0.000407242919
  error estimate for blocks of size 2^( 4) =       0.000413663777
  error estimate for blocks of size 2^( 5) =       0.000417665964
  error estimate for blocks of size 2^( 6) =       0.000418877251
  error estimate for blocks of size 2^( 7) =       0.000418308841

      target function =                  N/A
              le_mean =     -17.216438888689
             les_mean =     296.721227199474
             stat err =       0.000417128958
             autocorr =       1.155752644577
              std dev =       0.548722654548
             le_variance =       0.301096551614


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643888869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+25, overlap shift 2.3283e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+26, overlap shift 3.7253e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216438888735       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.190152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6785e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.204579
====================================================
  Execution time = 2.0564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1187e-01
  Total weights = 1.9569e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385838071
  error estimate for blocks of size 2^( 2) =       0.000396224053
  error estimate for blocks of size 2^( 3) =       0.000405698615
  error estimate for blocks of size 2^( 4) =       0.000412407183
  error estimate for blocks of size 2^( 5) =       0.000417140699
  error estimate for blocks of size 2^( 6) =       0.000417875480
  error estimate for blocks of size 2^( 7) =       0.000420323732

      target function =                  N/A
              le_mean =     -17.216673239841
             les_mean =     296.725711614977
             stat err =       0.000416936773
             autocorr =       1.167697218858
              std dev =       0.545657433340
             le_variance =       0.297742034560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385838071
  error estimate for blocks of size 2^( 2) =       0.000396224053
  error estimate for blocks of size 2^( 3) =       0.000405698615
  error estimate for blocks of size 2^( 4) =       0.000412407183
  error estimate for blocks of size 2^( 5) =       0.000417140699
  error estimate for blocks of size 2^( 6) =       0.000417875480
  error estimate for blocks of size 2^( 7) =       0.000420323732

      target function =                  N/A
              le_mean =     -17.216673239841
             les_mean =     296.725711614977
             stat err =       0.000416936773
             autocorr =       1.167697218858
              std dev =       0.545657433340
             le_variance =       0.297742034560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385838071
  error estimate for blocks of size 2^( 2) =       0.000396224053
  error estimate for blocks of size 2^( 3) =       0.000405698615
  error estimate for blocks of size 2^( 4) =       0.000412407183
  error estimate for blocks of size 2^( 5) =       0.000417140699
  error estimate for blocks of size 2^( 6) =       0.000417875480
  error estimate for blocks of size 2^( 7) =       0.000420323732

      target function =                  N/A
              le_mean =     -17.216673239841
             les_mean =     296.725711614977
             stat err =       0.000416936773
             autocorr =       1.167697218858
              std dev =       0.545657433340
             le_variance =       0.297742034560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297778450418
                                         uncertainty =       0.001859461729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385838071
  error estimate for blocks of size 2^( 2) =       0.000396224053
  error estimate for blocks of size 2^( 3) =       0.000405698615
  error estimate for blocks of size 2^( 4) =       0.000412407183
  error estimate for blocks of size 2^( 5) =       0.000417140699
  error estimate for blocks of size 2^( 6) =       0.000417875480
  error estimate for blocks of size 2^( 7) =       0.000420323732

      target function =                  N/A
              le_mean =     -17.216673239841
             les_mean =     296.725711614977
             stat err =       0.000416936773
             autocorr =       1.167697218858
              std dev =       0.545657433340
             le_variance =       0.297742034560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216673239841        initial  <--
     2.3283e+25     2.3283e+26             0.0000e+00       -17.216673239841
     9.3132e+25     9.3132e+26             0.0000e+00       -17.216673239841
     3.7253e+26     3.7253e+27             0.0000e+00       -17.216673239841

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7287
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6520e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1627
    reference variance = 0.398013
====================================================
  Execution time = 2.0808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1009e-01
  Total weights = 1.956702734e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297319592296
                                         uncertainty =       0.001813611013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297319592296
                                         uncertainty =       0.001813611013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385517628
  error estimate for blocks of size 2^( 2) =       0.000395852694
  error estimate for blocks of size 2^( 3) =       0.000404916239
  error estimate for blocks of size 2^( 4) =       0.000411642546
  error estimate for blocks of size 2^( 5) =       0.000415840385
  error estimate for blocks of size 2^( 6) =       0.000418072845
  error estimate for blocks of size 2^( 7) =       0.000418171474

      target function =                  N/A
              le_mean =     -17.216364987164
             les_mean =     296.713309845865
             stat err =       0.000415931813
             autocorr =       1.164007545728
              std dev =       0.545204257533
             le_variance =       0.297247682432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636498716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+26, overlap shift 2.3283e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+27, overlap shift 3.7253e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364987226       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.191313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6789e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1438
    reference variance = 0.5878
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1299e-01
  Total weights = 1.9565e+06
  Execution time = 1.8078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387810711
  error estimate for blocks of size 2^( 2) =       0.000397603513
  error estimate for blocks of size 2^( 3) =       0.000406544403
  error estimate for blocks of size 2^( 4) =       0.000413453125
  error estimate for blocks of size 2^( 5) =       0.000417666802
  error estimate for blocks of size 2^( 6) =       0.000419700175
  error estimate for blocks of size 2^( 7) =       0.000420885952

      target function =                  N/A
              le_mean =     -17.216098228652
             les_mean =     296.707031332738
             stat err =       0.000417926514
             autocorr =       1.161342308109
              std dev =       0.548447167626
             le_variance =       0.300794295677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387810711
  error estimate for blocks of size 2^( 2) =       0.000397603513
  error estimate for blocks of size 2^( 3) =       0.000406544403
  error estimate for blocks of size 2^( 4) =       0.000413453125
  error estimate for blocks of size 2^( 5) =       0.000417666802
  error estimate for blocks of size 2^( 6) =       0.000419700175
  error estimate for blocks of size 2^( 7) =       0.000420885952

      target function =                  N/A
              le_mean =     -17.216098228652
             les_mean =     296.707031332738
             stat err =       0.000417926514
             autocorr =       1.161342308109
              std dev =       0.548447167626
             le_variance =       0.300794295677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387810711
  error estimate for blocks of size 2^( 2) =       0.000397603513
  error estimate for blocks of size 2^( 3) =       0.000406544403
  error estimate for blocks of size 2^( 4) =       0.000413453125
  error estimate for blocks of size 2^( 5) =       0.000417666802
  error estimate for blocks of size 2^( 6) =       0.000419700175
  error estimate for blocks of size 2^( 7) =       0.000420885952

      target function =                  N/A
              le_mean =     -17.216098228652
             les_mean =     296.707031332738
             stat err =       0.000417926514
             autocorr =       1.161342308109
              std dev =       0.548447167626
             le_variance =       0.300794295677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300845051684
                                         uncertainty =       0.002497441152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387810711
  error estimate for blocks of size 2^( 2) =       0.000397603513
  error estimate for blocks of size 2^( 3) =       0.000406544403
  error estimate for blocks of size 2^( 4) =       0.000413453125
  error estimate for blocks of size 2^( 5) =       0.000417666802
  error estimate for blocks of size 2^( 6) =       0.000419700175
  error estimate for blocks of size 2^( 7) =       0.000420885952

      target function =                  N/A
              le_mean =     -17.216098228652
             les_mean =     296.707031332738
             stat err =       0.000417926514
             autocorr =       1.161342308109
              std dev =       0.548447167626
             le_variance =       0.300794295677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216098228652        initial  <--
     2.3283e+26     2.3283e+27             0.0000e+00       -17.216098228652
     9.3132e+26     9.3132e+27             0.0000e+00       -17.216098228652
     3.7253e+27     3.7253e+28             0.0000e+00       -17.216098228652

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6478
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.22
    reference variance = 0.383311
====================================================
  Execution time = 2.2953e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1755e-01
  Total weights = 1.956243850e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301849736589
                                         uncertainty =       0.002033515157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301849736589
                                         uncertainty =       0.002033515157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388499057
  error estimate for blocks of size 2^( 2) =       0.000398312393
  error estimate for blocks of size 2^( 3) =       0.000407472273
  error estimate for blocks of size 2^( 4) =       0.000414173970
  error estimate for blocks of size 2^( 5) =       0.000418668092
  error estimate for blocks of size 2^( 6) =       0.000420021636
  error estimate for blocks of size 2^( 7) =       0.000417943493

      target function =                  N/A
              le_mean =     -17.215830191484
             les_mean =     296.702356218703
             stat err =       0.000417701798
             autocorr =       1.155986466757
              std dev =       0.549420635836
             le_variance =       0.301863035082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721583019148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+27, overlap shift 2.3283e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215830191500       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215830191500       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215830191500       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+27 is 1.375762e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215830191500       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215830191500       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215830191500       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+27 is 3.439404e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+28, overlap shift 3.7253e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215830191500       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215830191500       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215830191500       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+28 is 8.598511e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.192796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8924e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1584
    reference variance = 0.157572
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1335e-01
  Total weights = 1.9567e+06
  Execution time = 1.8076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708285
  error estimate for blocks of size 2^( 2) =       0.000396322698
  error estimate for blocks of size 2^( 3) =       0.000405237210
  error estimate for blocks of size 2^( 4) =       0.000412630718
  error estimate for blocks of size 2^( 5) =       0.000415869136
  error estimate for blocks of size 2^( 6) =       0.000419108077
  error estimate for blocks of size 2^( 7) =       0.000421061793

      target function =                  N/A
              le_mean =     -17.216449261791
             les_mean =     296.719476254320
             stat err =       0.000417167431
             autocorr =       1.163734304937
              std dev =       0.546888101018
             le_variance =       0.299086595035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708285
  error estimate for blocks of size 2^( 2) =       0.000396322698
  error estimate for blocks of size 2^( 3) =       0.000405237210
  error estimate for blocks of size 2^( 4) =       0.000412630718
  error estimate for blocks of size 2^( 5) =       0.000415869136
  error estimate for blocks of size 2^( 6) =       0.000419108077
  error estimate for blocks of size 2^( 7) =       0.000421061793

      target function =                  N/A
              le_mean =     -17.216449261791
             les_mean =     296.719476254320
             stat err =       0.000417167431
             autocorr =       1.163734304937
              std dev =       0.546888101018
             le_variance =       0.299086595035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708285
  error estimate for blocks of size 2^( 2) =       0.000396322698
  error estimate for blocks of size 2^( 3) =       0.000405237210
  error estimate for blocks of size 2^( 4) =       0.000412630718
  error estimate for blocks of size 2^( 5) =       0.000415869136
  error estimate for blocks of size 2^( 6) =       0.000419108077
  error estimate for blocks of size 2^( 7) =       0.000421061793

      target function =                  N/A
              le_mean =     -17.216449261791
             les_mean =     296.719476254320
             stat err =       0.000417167431
             autocorr =       1.163734304937
              std dev =       0.546888101018
             le_variance =       0.299086595035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299167992501
                                         uncertainty =       0.002301893894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708285
  error estimate for blocks of size 2^( 2) =       0.000396322698
  error estimate for blocks of size 2^( 3) =       0.000405237210
  error estimate for blocks of size 2^( 4) =       0.000412630718
  error estimate for blocks of size 2^( 5) =       0.000415869136
  error estimate for blocks of size 2^( 6) =       0.000419108077
  error estimate for blocks of size 2^( 7) =       0.000421061793

      target function =                  N/A
              le_mean =     -17.216449261791
             les_mean =     296.719476254320
             stat err =       0.000417167431
             autocorr =       1.163734304937
              std dev =       0.546888101018
             le_variance =       0.299086595035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216449261791        initial  <--
     2.3283e+27     2.3283e+28             1.3758e-31       -17.216449261791
     9.3132e+27     9.3132e+28             3.4394e-32       -17.216449261791
     3.7253e+28     3.7253e+29             8.5985e-33       -17.216449261791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6679
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.36687
====================================================
  Execution time = 2.0827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1215e-01
  Total weights = 1.956354882e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299900939983
                                         uncertainty =       0.001820155365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299900939983
                                         uncertainty =       0.001820155365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387229316
  error estimate for blocks of size 2^( 2) =       0.000397339216
  error estimate for blocks of size 2^( 3) =       0.000405935205
  error estimate for blocks of size 2^( 4) =       0.000412114628
  error estimate for blocks of size 2^( 5) =       0.000417186066
  error estimate for blocks of size 2^( 6) =       0.000420352717
  error estimate for blocks of size 2^( 7) =       0.000422967090

      target function =                  N/A
              le_mean =     -17.216198837037
             les_mean =     296.709655979349
             stat err =       0.000418155125
             autocorr =       1.166106969143
              std dev =       0.547624950244
             le_variance =       0.299893086130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619883704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+28, overlap shift 2.3283e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198837063       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216198837063       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198837063       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216198837035       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+28 is 1.321939e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198837063       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216198837063       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198837063       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216198837063       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216198837385       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+28 is 3.304847e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+29, overlap shift 3.7253e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216198837063       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216198837063       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198837063       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216198837063       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216198835522       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216198831797       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+29 is 8.262117e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.195011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6959e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1067
    reference variance = 0.809667
====================================================
  Execution time = 2.0947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1506e-01
  Total weights = 1.9564e+06
  Execution time = 1.8083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708641
  error estimate for blocks of size 2^( 2) =       0.000396725307
  error estimate for blocks of size 2^( 3) =       0.000405867069
  error estimate for blocks of size 2^( 4) =       0.000412032559
  error estimate for blocks of size 2^( 5) =       0.000415567674
  error estimate for blocks of size 2^( 6) =       0.000419249280
  error estimate for blocks of size 2^( 7) =       0.000419774942

      target function =                  N/A
              le_mean =     -17.216316200624
             les_mean =     296.716602258176
             stat err =       0.000416656114
             autocorr =       1.160881165507
              std dev =       0.546888604489
             le_variance =       0.299087145720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708641
  error estimate for blocks of size 2^( 2) =       0.000396725307
  error estimate for blocks of size 2^( 3) =       0.000405867069
  error estimate for blocks of size 2^( 4) =       0.000412032559
  error estimate for blocks of size 2^( 5) =       0.000415567674
  error estimate for blocks of size 2^( 6) =       0.000419249280
  error estimate for blocks of size 2^( 7) =       0.000419774942

      target function =                  N/A
              le_mean =     -17.216316200624
             les_mean =     296.716602258176
             stat err =       0.000416656114
             autocorr =       1.160881165507
              std dev =       0.546888604489
             le_variance =       0.299087145720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708641
  error estimate for blocks of size 2^( 2) =       0.000396725307
  error estimate for blocks of size 2^( 3) =       0.000405867069
  error estimate for blocks of size 2^( 4) =       0.000412032559
  error estimate for blocks of size 2^( 5) =       0.000415567674
  error estimate for blocks of size 2^( 6) =       0.000419249280
  error estimate for blocks of size 2^( 7) =       0.000419774942

      target function =                  N/A
              le_mean =     -17.216316200624
             les_mean =     296.716602258176
             stat err =       0.000416656114
             autocorr =       1.160881165507
              std dev =       0.546888604489
             le_variance =       0.299087145720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298951444630
                                         uncertainty =       0.002200723927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386708641
  error estimate for blocks of size 2^( 2) =       0.000396725307
  error estimate for blocks of size 2^( 3) =       0.000405867069
  error estimate for blocks of size 2^( 4) =       0.000412032559
  error estimate for blocks of size 2^( 5) =       0.000415567674
  error estimate for blocks of size 2^( 6) =       0.000419249280
  error estimate for blocks of size 2^( 7) =       0.000419774942

      target function =                  N/A
              le_mean =     -17.216316200624
             les_mean =     296.716602258176
             stat err =       0.000416656114
             autocorr =       1.160881165507
              std dev =       0.546888604489
             le_variance =       0.299087145720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216316200624        initial  <--
     2.3283e+28     2.3283e+29             1.3219e-32       -17.216316200624
     9.3132e+28     9.3132e+29             3.3048e-33       -17.216316200624
     3.7253e+29     3.7253e+30             8.2621e-34       -17.216316200624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1085
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.486539
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0925e-01
  Total weights = 1.956718609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296143294648
                                         uncertainty =       0.001827927766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296143294648
                                         uncertainty =       0.001827927766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384752913
  error estimate for blocks of size 2^( 2) =       0.000394606303
  error estimate for blocks of size 2^( 3) =       0.000403574667
  error estimate for blocks of size 2^( 4) =       0.000410335227
  error estimate for blocks of size 2^( 5) =       0.000413969608
  error estimate for blocks of size 2^( 6) =       0.000416439954
  error estimate for blocks of size 2^( 7) =       0.000417621826

      target function =                  N/A
              le_mean =     -17.215948287864
             les_mean =     296.698120829135
             stat err =       0.000414591654
             autocorr =       1.161120457402
              std dev =       0.544122787404
             le_variance =       0.296069607773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721594828786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+29, overlap shift 2.3283e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+30, overlap shift 3.7253e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215948287896       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.196197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6626e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.261436
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0805e-01
  Total weights = 1.9565e+06
  Execution time = 1.8127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384587117
  error estimate for blocks of size 2^( 2) =       0.000394805382
  error estimate for blocks of size 2^( 3) =       0.000403918131
  error estimate for blocks of size 2^( 4) =       0.000409621166
  error estimate for blocks of size 2^( 5) =       0.000412081523
  error estimate for blocks of size 2^( 6) =       0.000414062773
  error estimate for blocks of size 2^( 7) =       0.000414263602

      target function =                  N/A
              le_mean =     -17.215788816851
             les_mean =     296.691437716519
             stat err =       0.000412507266
             autocorr =       1.150465873836
              std dev =       0.543888317218
             le_variance =       0.295814501607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384587117
  error estimate for blocks of size 2^( 2) =       0.000394805382
  error estimate for blocks of size 2^( 3) =       0.000403918131
  error estimate for blocks of size 2^( 4) =       0.000409621166
  error estimate for blocks of size 2^( 5) =       0.000412081523
  error estimate for blocks of size 2^( 6) =       0.000414062773
  error estimate for blocks of size 2^( 7) =       0.000414263602

      target function =                  N/A
              le_mean =     -17.215788816851
             les_mean =     296.691437716519
             stat err =       0.000412507266
             autocorr =       1.150465873836
              std dev =       0.543888317218
             le_variance =       0.295814501607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384587117
  error estimate for blocks of size 2^( 2) =       0.000394805382
  error estimate for blocks of size 2^( 3) =       0.000403918131
  error estimate for blocks of size 2^( 4) =       0.000409621166
  error estimate for blocks of size 2^( 5) =       0.000412081523
  error estimate for blocks of size 2^( 6) =       0.000414062773
  error estimate for blocks of size 2^( 7) =       0.000414263602

      target function =                  N/A
              le_mean =     -17.215788816851
             les_mean =     296.691437716519
             stat err =       0.000412507266
             autocorr =       1.150465873836
              std dev =       0.543888317218
             le_variance =       0.295814501607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295835791586
                                         uncertainty =       0.001689208306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384587117
  error estimate for blocks of size 2^( 2) =       0.000394805382
  error estimate for blocks of size 2^( 3) =       0.000403918131
  error estimate for blocks of size 2^( 4) =       0.000409621166
  error estimate for blocks of size 2^( 5) =       0.000412081523
  error estimate for blocks of size 2^( 6) =       0.000414062773
  error estimate for blocks of size 2^( 7) =       0.000414263602

      target function =                  N/A
              le_mean =     -17.215788816851
             les_mean =     296.691437716519
             stat err =       0.000412507266
             autocorr =       1.150465873836
              std dev =       0.543888317218
             le_variance =       0.295814501607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215788816851        initial  <--
     2.3283e+29     2.3283e+30             0.0000e+00       -17.215788816851
     9.3132e+29     9.3132e+30             0.0000e+00       -17.215788816851
     3.7253e+30     3.7253e+31             0.0000e+00       -17.215788816851

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5918
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.281237
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1487e-01
  Total weights = 1.956512021e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299362885002
                                         uncertainty =       0.001958262460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299362885002
                                         uncertainty =       0.001958262460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386976651
  error estimate for blocks of size 2^( 2) =       0.000396840828
  error estimate for blocks of size 2^( 3) =       0.000406080130
  error estimate for blocks of size 2^( 4) =       0.000412585370
  error estimate for blocks of size 2^( 5) =       0.000416555442
  error estimate for blocks of size 2^( 6) =       0.000419138714
  error estimate for blocks of size 2^( 7) =       0.000418924824

      target function =                  N/A
              le_mean =     -17.216136946361
             les_mean =     296.710236452020
             stat err =       0.000416801087
             autocorr =       1.160080596254
              std dev =       0.547267628398
             le_variance =       0.299501857092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613694636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+30, overlap shift 2.3283e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+31, overlap shift 3.7253e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216136946406       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.197415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6875e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1768
    reference variance = 0.155497
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1505e-01
  Total weights = 1.9562e+06
  Execution time = 1.8102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089674
  error estimate for blocks of size 2^( 2) =       0.000396045962
  error estimate for blocks of size 2^( 3) =       0.000404822501
  error estimate for blocks of size 2^( 4) =       0.000411820799
  error estimate for blocks of size 2^( 5) =       0.000416349782
  error estimate for blocks of size 2^( 6) =       0.000417705124
  error estimate for blocks of size 2^( 7) =       0.000419579341

      target function =                  N/A
              le_mean =     -17.216746438566
             les_mean =     296.731412537300
             stat err =       0.000416363761
             autocorr =       1.162972578253
              std dev =       0.546013252646
             le_variance =       0.298130472065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089674
  error estimate for blocks of size 2^( 2) =       0.000396045962
  error estimate for blocks of size 2^( 3) =       0.000404822501
  error estimate for blocks of size 2^( 4) =       0.000411820799
  error estimate for blocks of size 2^( 5) =       0.000416349782
  error estimate for blocks of size 2^( 6) =       0.000417705124
  error estimate for blocks of size 2^( 7) =       0.000419579341

      target function =                  N/A
              le_mean =     -17.216746438566
             les_mean =     296.731412537300
             stat err =       0.000416363761
             autocorr =       1.162972578253
              std dev =       0.546013252646
             le_variance =       0.298130472065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089674
  error estimate for blocks of size 2^( 2) =       0.000396045962
  error estimate for blocks of size 2^( 3) =       0.000404822501
  error estimate for blocks of size 2^( 4) =       0.000411820799
  error estimate for blocks of size 2^( 5) =       0.000416349782
  error estimate for blocks of size 2^( 6) =       0.000417705124
  error estimate for blocks of size 2^( 7) =       0.000419579341

      target function =                  N/A
              le_mean =     -17.216746438566
             les_mean =     296.731412537300
             stat err =       0.000416363761
             autocorr =       1.162972578253
              std dev =       0.546013252646
             le_variance =       0.298130472065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298172041332
                                         uncertainty =       0.002281787473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089674
  error estimate for blocks of size 2^( 2) =       0.000396045962
  error estimate for blocks of size 2^( 3) =       0.000404822501
  error estimate for blocks of size 2^( 4) =       0.000411820799
  error estimate for blocks of size 2^( 5) =       0.000416349782
  error estimate for blocks of size 2^( 6) =       0.000417705124
  error estimate for blocks of size 2^( 7) =       0.000419579341

      target function =                  N/A
              le_mean =     -17.216746438566
             les_mean =     296.731412537300
             stat err =       0.000416363761
             autocorr =       1.162972578253
              std dev =       0.546013252646
             le_variance =       0.298130472065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216746438566        initial  <--
     2.3283e+30     2.3283e+31             0.0000e+00       -17.216746438566
     9.3132e+30     9.3132e+31             0.0000e+00       -17.216746438566
     3.7253e+31     3.7253e+32             0.0000e+00       -17.216746438566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6741
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1978
    reference variance = 0.232266
====================================================
  Execution time = 2.0723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3648e-01
  Total weights = 1.956709417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305124766379
                                         uncertainty =       0.003746437280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305124766379
                                         uncertainty =       0.003746437280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390519684
  error estimate for blocks of size 2^( 2) =       0.000400537566
  error estimate for blocks of size 2^( 3) =       0.000409214956
  error estimate for blocks of size 2^( 4) =       0.000415306629
  error estimate for blocks of size 2^( 5) =       0.000419163892
  error estimate for blocks of size 2^( 6) =       0.000421962193
  error estimate for blocks of size 2^( 7) =       0.000422583643

      target function =                  N/A
              le_mean =     -17.216736632644
             les_mean =     296.752499521778
             stat err =       0.000419754089
             autocorr =       1.155324579493
              std dev =       0.552278233602
             le_variance =       0.305011247310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673663264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+31, overlap shift 2.3283e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+32, overlap shift 3.7253e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216736632636       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.198614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6908e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.615835
====================================================
  Execution time = 2.0978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1059e-01
  Total weights = 1.9567e+06
  Execution time = 1.8075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384725564
  error estimate for blocks of size 2^( 2) =       0.000394745232
  error estimate for blocks of size 2^( 3) =       0.000403454315
  error estimate for blocks of size 2^( 4) =       0.000409792860
  error estimate for blocks of size 2^( 5) =       0.000413665977
  error estimate for blocks of size 2^( 6) =       0.000415825050
  error estimate for blocks of size 2^( 7) =       0.000417689272

      target function =                  N/A
              le_mean =     -17.216156368795
             les_mean =     296.706629372624
             stat err =       0.000414243290
             autocorr =       1.159334805542
              std dev =       0.544084110305
             le_variance =       0.296027519086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384725564
  error estimate for blocks of size 2^( 2) =       0.000394745232
  error estimate for blocks of size 2^( 3) =       0.000403454315
  error estimate for blocks of size 2^( 4) =       0.000409792860
  error estimate for blocks of size 2^( 5) =       0.000413665977
  error estimate for blocks of size 2^( 6) =       0.000415825050
  error estimate for blocks of size 2^( 7) =       0.000417689272

      target function =                  N/A
              le_mean =     -17.216156368795
             les_mean =     296.706629372624
             stat err =       0.000414243290
             autocorr =       1.159334805542
              std dev =       0.544084110305
             le_variance =       0.296027519086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384725564
  error estimate for blocks of size 2^( 2) =       0.000394745232
  error estimate for blocks of size 2^( 3) =       0.000403454315
  error estimate for blocks of size 2^( 4) =       0.000409792860
  error estimate for blocks of size 2^( 5) =       0.000413665977
  error estimate for blocks of size 2^( 6) =       0.000415825050
  error estimate for blocks of size 2^( 7) =       0.000417689272

      target function =                  N/A
              le_mean =     -17.216156368795
             les_mean =     296.706629372624
             stat err =       0.000414243290
             autocorr =       1.159334805542
              std dev =       0.544084110305
             le_variance =       0.296027519086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296066023052
                                         uncertainty =       0.001858485203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384725564
  error estimate for blocks of size 2^( 2) =       0.000394745232
  error estimate for blocks of size 2^( 3) =       0.000403454315
  error estimate for blocks of size 2^( 4) =       0.000409792860
  error estimate for blocks of size 2^( 5) =       0.000413665977
  error estimate for blocks of size 2^( 6) =       0.000415825050
  error estimate for blocks of size 2^( 7) =       0.000417689272

      target function =                  N/A
              le_mean =     -17.216156368795
             les_mean =     296.706629372624
             stat err =       0.000414243290
             autocorr =       1.159334805542
              std dev =       0.544084110305
             le_variance =       0.296027519086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216156368795        initial  <--
     2.3283e+31     2.3283e+32             0.0000e+00       -17.216156368795
     9.3132e+31     9.3132e+32             0.0000e+00       -17.216156368795
     3.7253e+32     3.7253e+33             0.0000e+00       -17.216156368795

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1353
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.3589
    reference variance = 1.04478
====================================================
  Execution time = 2.0666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1128e-01
  Total weights = 1.956687598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297612260030
                                         uncertainty =       0.002606368618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297612260030
                                         uncertainty =       0.002606368618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385783251
  error estimate for blocks of size 2^( 2) =       0.000395555741
  error estimate for blocks of size 2^( 3) =       0.000404767087
  error estimate for blocks of size 2^( 4) =       0.000411768564
  error estimate for blocks of size 2^( 5) =       0.000415420075
  error estimate for blocks of size 2^( 6) =       0.000418815956
  error estimate for blocks of size 2^( 7) =       0.000421715980

      target function =                  N/A
              le_mean =     -17.215741579570
             les_mean =     296.693039652639
             stat err =       0.000416930144
             autocorr =       1.167991958438
              std dev =       0.545579906191
             le_variance =       0.297657434039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721574157957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+32, overlap shift 2.3283e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+33, overlap shift 3.7253e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215741579601       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.199815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6758e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2302
    reference variance = 0.296299
====================================================
  Execution time = 2.2469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1689e-01
  Total weights = 1.9561e+06
  Execution time = 1.8106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388110365
  error estimate for blocks of size 2^( 2) =       0.000397963498
  error estimate for blocks of size 2^( 3) =       0.000406860020
  error estimate for blocks of size 2^( 4) =       0.000412957922
  error estimate for blocks of size 2^( 5) =       0.000417037513
  error estimate for blocks of size 2^( 6) =       0.000419793208
  error estimate for blocks of size 2^( 7) =       0.000421662580

      target function =                  N/A
              le_mean =     -17.216129294380
             les_mean =     296.711998151837
             stat err =       0.000417862806
             autocorr =       1.159196205788
              std dev =       0.548870941246
             le_variance =       0.301259310144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388110365
  error estimate for blocks of size 2^( 2) =       0.000397963498
  error estimate for blocks of size 2^( 3) =       0.000406860020
  error estimate for blocks of size 2^( 4) =       0.000412957922
  error estimate for blocks of size 2^( 5) =       0.000417037513
  error estimate for blocks of size 2^( 6) =       0.000419793208
  error estimate for blocks of size 2^( 7) =       0.000421662580

      target function =                  N/A
              le_mean =     -17.216129294380
             les_mean =     296.711998151837
             stat err =       0.000417862806
             autocorr =       1.159196205788
              std dev =       0.548870941246
             le_variance =       0.301259310144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388110365
  error estimate for blocks of size 2^( 2) =       0.000397963498
  error estimate for blocks of size 2^( 3) =       0.000406860020
  error estimate for blocks of size 2^( 4) =       0.000412957922
  error estimate for blocks of size 2^( 5) =       0.000417037513
  error estimate for blocks of size 2^( 6) =       0.000419793208
  error estimate for blocks of size 2^( 7) =       0.000421662580

      target function =                  N/A
              le_mean =     -17.216129294380
             les_mean =     296.711998151837
             stat err =       0.000417862806
             autocorr =       1.159196205788
              std dev =       0.548870941246
             le_variance =       0.301259310144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301283217878
                                         uncertainty =       0.002873604976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388110365
  error estimate for blocks of size 2^( 2) =       0.000397963498
  error estimate for blocks of size 2^( 3) =       0.000406860020
  error estimate for blocks of size 2^( 4) =       0.000412957922
  error estimate for blocks of size 2^( 5) =       0.000417037513
  error estimate for blocks of size 2^( 6) =       0.000419793208
  error estimate for blocks of size 2^( 7) =       0.000421662580

      target function =                  N/A
              le_mean =     -17.216129294380
             les_mean =     296.711998151837
             stat err =       0.000417862806
             autocorr =       1.159196205788
              std dev =       0.548870941246
             le_variance =       0.301259310144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216129294380        initial  <--
     2.3283e+32     2.3283e+33             0.0000e+00       -17.216129294380
     9.3132e+32     9.3132e+33             0.0000e+00       -17.216129294380
     3.7253e+33     3.7253e+34             0.0000e+00       -17.216129294380

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6731
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.247513
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2314e-01
  Total weights = 1.956784282e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302251678962
                                         uncertainty =       0.002606760501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302251678962
                                         uncertainty =       0.002606760501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388715314
  error estimate for blocks of size 2^( 2) =       0.000398604316
  error estimate for blocks of size 2^( 3) =       0.000407400697
  error estimate for blocks of size 2^( 4) =       0.000413423781
  error estimate for blocks of size 2^( 5) =       0.000416946827
  error estimate for blocks of size 2^( 6) =       0.000419312766
  error estimate for blocks of size 2^( 7) =       0.000420631870

      target function =                  N/A
              le_mean =     -17.216277065243
             les_mean =     296.723335483044
             stat err =       0.000417578811
             autocorr =       1.154020717884
              std dev =       0.549726468840
             le_variance =       0.302199190543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627706524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+33, overlap shift 2.3283e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+34, overlap shift 3.7253e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216277065290       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.201003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6648e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.249725
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1882e-01
  Total weights = 1.9566e+06
  Execution time = 1.8119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387787872
  error estimate for blocks of size 2^( 2) =       0.000397624923
  error estimate for blocks of size 2^( 3) =       0.000406867023
  error estimate for blocks of size 2^( 4) =       0.000413536736
  error estimate for blocks of size 2^( 5) =       0.000417898136
  error estimate for blocks of size 2^( 6) =       0.000420571792
  error estimate for blocks of size 2^( 7) =       0.000421962031

      target function =                  N/A
              le_mean =     -17.217387032132
             les_mean =     296.757239656822
             stat err =       0.000418492174
             autocorr =       1.164625339296
              std dev =       0.548414868518
             le_variance =       0.300758868012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387787872
  error estimate for blocks of size 2^( 2) =       0.000397624923
  error estimate for blocks of size 2^( 3) =       0.000406867023
  error estimate for blocks of size 2^( 4) =       0.000413536736
  error estimate for blocks of size 2^( 5) =       0.000417898136
  error estimate for blocks of size 2^( 6) =       0.000420571792
  error estimate for blocks of size 2^( 7) =       0.000421962031

      target function =                  N/A
              le_mean =     -17.217387032132
             les_mean =     296.757239656822
             stat err =       0.000418492174
             autocorr =       1.164625339296
              std dev =       0.548414868518
             le_variance =       0.300758868012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387787872
  error estimate for blocks of size 2^( 2) =       0.000397624923
  error estimate for blocks of size 2^( 3) =       0.000406867023
  error estimate for blocks of size 2^( 4) =       0.000413536736
  error estimate for blocks of size 2^( 5) =       0.000417898136
  error estimate for blocks of size 2^( 6) =       0.000420571792
  error estimate for blocks of size 2^( 7) =       0.000421962031

      target function =                  N/A
              le_mean =     -17.217387032132
             les_mean =     296.757239656822
             stat err =       0.000418492174
             autocorr =       1.164625339296
              std dev =       0.548414868518
             le_variance =       0.300758868012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300423068199
                                         uncertainty =       0.001905755329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387787872
  error estimate for blocks of size 2^( 2) =       0.000397624923
  error estimate for blocks of size 2^( 3) =       0.000406867023
  error estimate for blocks of size 2^( 4) =       0.000413536736
  error estimate for blocks of size 2^( 5) =       0.000417898136
  error estimate for blocks of size 2^( 6) =       0.000420571792
  error estimate for blocks of size 2^( 7) =       0.000421962031

      target function =                  N/A
              le_mean =     -17.217387032132
             les_mean =     296.757239656822
             stat err =       0.000418492174
             autocorr =       1.164625339296
              std dev =       0.548414868518
             le_variance =       0.300758868012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217387032132        initial  <--
     2.3283e+33     2.3283e+34             0.0000e+00       -17.217387032132
     9.3132e+33     9.3132e+34             0.0000e+00       -17.217387032132
     3.7253e+34     3.7253e+35             0.0000e+00       -17.217387032132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7508
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2429
    reference variance = 0.198961
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1447e-01
  Total weights = 1.956385166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299478770997
                                         uncertainty =       0.002142193427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299478770997
                                         uncertainty =       0.002142193427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386932903
  error estimate for blocks of size 2^( 2) =       0.000396991581
  error estimate for blocks of size 2^( 3) =       0.000405730735
  error estimate for blocks of size 2^( 4) =       0.000412808560
  error estimate for blocks of size 2^( 5) =       0.000416818292
  error estimate for blocks of size 2^( 6) =       0.000418655071
  error estimate for blocks of size 2^( 7) =       0.000421867590

      target function =                  N/A
              le_mean =     -17.216181951181
             les_mean =     296.711393510430
             stat err =       0.000417537378
             autocorr =       1.164446117270
              std dev =       0.547205758543
             le_variance =       0.299434142183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618195118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+34, overlap shift 2.3283e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216181951205       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216181951205       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216181951205       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216181951205       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+34 is 1.427684e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216181951205       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216181951205       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216181951205       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216181951205       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+34 is 3.569210e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+35, overlap shift 3.7253e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216181951205       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216181951205       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216181951205       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216181951205       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+35 is 8.923026e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.202777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6936e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.24641
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1376e-01
  Total weights = 1.9566e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374815
  error estimate for blocks of size 2^( 2) =       0.000396988906
  error estimate for blocks of size 2^( 3) =       0.000406614151
  error estimate for blocks of size 2^( 4) =       0.000413552940
  error estimate for blocks of size 2^( 5) =       0.000417692269
  error estimate for blocks of size 2^( 6) =       0.000419976255
  error estimate for blocks of size 2^( 7) =       0.000421352357

      target function =                  N/A
              le_mean =     -17.216220348904
             les_mean =     296.711999219173
             stat err =       0.000418143455
             autocorr =       1.165166107815
              std dev =       0.547830717183
             le_variance =       0.300118494689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374815
  error estimate for blocks of size 2^( 2) =       0.000396988906
  error estimate for blocks of size 2^( 3) =       0.000406614151
  error estimate for blocks of size 2^( 4) =       0.000413552940
  error estimate for blocks of size 2^( 5) =       0.000417692269
  error estimate for blocks of size 2^( 6) =       0.000419976255
  error estimate for blocks of size 2^( 7) =       0.000421352357

      target function =                  N/A
              le_mean =     -17.216220348904
             les_mean =     296.711999219173
             stat err =       0.000418143455
             autocorr =       1.165166107815
              std dev =       0.547830717183
             le_variance =       0.300118494689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374815
  error estimate for blocks of size 2^( 2) =       0.000396988906
  error estimate for blocks of size 2^( 3) =       0.000406614151
  error estimate for blocks of size 2^( 4) =       0.000413552940
  error estimate for blocks of size 2^( 5) =       0.000417692269
  error estimate for blocks of size 2^( 6) =       0.000419976255
  error estimate for blocks of size 2^( 7) =       0.000421352357

      target function =                  N/A
              le_mean =     -17.216220348904
             les_mean =     296.711999219173
             stat err =       0.000418143455
             autocorr =       1.165166107815
              std dev =       0.547830717183
             le_variance =       0.300118494689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300129271613
                                         uncertainty =       0.001969654094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374815
  error estimate for blocks of size 2^( 2) =       0.000396988906
  error estimate for blocks of size 2^( 3) =       0.000406614151
  error estimate for blocks of size 2^( 4) =       0.000413552940
  error estimate for blocks of size 2^( 5) =       0.000417692269
  error estimate for blocks of size 2^( 6) =       0.000419976255
  error estimate for blocks of size 2^( 7) =       0.000421352357

      target function =                  N/A
              le_mean =     -17.216220348904
             les_mean =     296.711999219173
             stat err =       0.000418143455
             autocorr =       1.165166107815
              std dev =       0.547830717183
             le_variance =       0.300118494689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216220348904        initial  <--
     2.3283e+34     2.3283e+35             1.4277e-38       -17.216220348904
     9.3132e+34     9.3132e+35             3.5692e-39       -17.216220348904
     3.7253e+35     3.7253e+36             8.9230e-40       -17.216220348904

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7749
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1784
    reference variance = 0.355699
====================================================
  Execution time = 2.1029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1364e-01
  Total weights = 1.956613950e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298732831036
                                         uncertainty =       0.002462127595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298732831036
                                         uncertainty =       0.002462127595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386472156
  error estimate for blocks of size 2^( 2) =       0.000396337811
  error estimate for blocks of size 2^( 3) =       0.000405903224
  error estimate for blocks of size 2^( 4) =       0.000413109870
  error estimate for blocks of size 2^( 5) =       0.000416275451
  error estimate for blocks of size 2^( 6) =       0.000419260616
  error estimate for blocks of size 2^( 7) =       0.000421534604

      target function =                  N/A
              le_mean =     -17.216665756079
             les_mean =     296.727218979147
             stat err =       0.000417545135
             autocorr =       1.167267618882
              std dev =       0.546554163829
             le_variance =       0.298721453999


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666575608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+35, overlap shift 2.3283e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+36, overlap shift 3.7253e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665756098       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.203972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7149e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.277
    reference variance = 0.157728
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1161e-01
  Total weights = 1.9567e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385798428
  error estimate for blocks of size 2^( 2) =       0.000396080695
  error estimate for blocks of size 2^( 3) =       0.000405015672
  error estimate for blocks of size 2^( 4) =       0.000412084475
  error estimate for blocks of size 2^( 5) =       0.000416920161
  error estimate for blocks of size 2^( 6) =       0.000419111313
  error estimate for blocks of size 2^( 7) =       0.000419375927

      target function =                  N/A
              le_mean =     -17.216339829617
             les_mean =     296.713969728363
             stat err =       0.000416872969
             autocorr =       1.167579774669
              std dev =       0.545601369119
             le_variance =       0.297680853985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385798428
  error estimate for blocks of size 2^( 2) =       0.000396080695
  error estimate for blocks of size 2^( 3) =       0.000405015672
  error estimate for blocks of size 2^( 4) =       0.000412084475
  error estimate for blocks of size 2^( 5) =       0.000416920161
  error estimate for blocks of size 2^( 6) =       0.000419111313
  error estimate for blocks of size 2^( 7) =       0.000419375927

      target function =                  N/A
              le_mean =     -17.216339829617
             les_mean =     296.713969728363
             stat err =       0.000416872969
             autocorr =       1.167579774669
              std dev =       0.545601369119
             le_variance =       0.297680853985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385798428
  error estimate for blocks of size 2^( 2) =       0.000396080695
  error estimate for blocks of size 2^( 3) =       0.000405015672
  error estimate for blocks of size 2^( 4) =       0.000412084475
  error estimate for blocks of size 2^( 5) =       0.000416920161
  error estimate for blocks of size 2^( 6) =       0.000419111313
  error estimate for blocks of size 2^( 7) =       0.000419375927

      target function =                  N/A
              le_mean =     -17.216339829617
             les_mean =     296.713969728363
             stat err =       0.000416872969
             autocorr =       1.167579774669
              std dev =       0.545601369119
             le_variance =       0.297680853985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297674985177
                                         uncertainty =       0.001869647492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385798428
  error estimate for blocks of size 2^( 2) =       0.000396080695
  error estimate for blocks of size 2^( 3) =       0.000405015672
  error estimate for blocks of size 2^( 4) =       0.000412084475
  error estimate for blocks of size 2^( 5) =       0.000416920161
  error estimate for blocks of size 2^( 6) =       0.000419111313
  error estimate for blocks of size 2^( 7) =       0.000419375927

      target function =                  N/A
              le_mean =     -17.216339829617
             les_mean =     296.713969728363
             stat err =       0.000416872969
             autocorr =       1.167579774669
              std dev =       0.545601369119
             le_variance =       0.297680853985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216339829617        initial  <--
     2.3283e+35     2.3283e+36             0.0000e+00       -17.216339829617
     9.3132e+35     9.3132e+36             0.0000e+00       -17.216339829617
     3.7253e+36     3.7253e+37             0.0000e+00       -17.216339829617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9569
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2323
    reference variance = 0.355053
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1037e-01
  Total weights = 1.956792932e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296308241623
                                         uncertainty =       0.001961012711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296308241623
                                         uncertainty =       0.001961012711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384945472
  error estimate for blocks of size 2^( 2) =       0.000394732033
  error estimate for blocks of size 2^( 3) =       0.000404357351
  error estimate for blocks of size 2^( 4) =       0.000411930975
  error estimate for blocks of size 2^( 5) =       0.000416219801
  error estimate for blocks of size 2^( 6) =       0.000418245117
  error estimate for blocks of size 2^( 7) =       0.000418456248

      target function =                  N/A
              le_mean =     -17.215900358183
             les_mean =     296.697592099664
             stat err =       0.000416213035
             autocorr =       1.169049561678
              std dev =       0.544395107871
             le_variance =       0.296366033474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590035818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+36, overlap shift 2.3283e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+36, overlap shift 9.3132e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+37, overlap shift 3.7253e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215900358205       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.205193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6858e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.210675
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1279e-01
  Total weights = 1.9566e+06
  Execution time = 1.8143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019733
  error estimate for blocks of size 2^( 2) =       0.000397255504
  error estimate for blocks of size 2^( 3) =       0.000405872657
  error estimate for blocks of size 2^( 4) =       0.000412604196
  error estimate for blocks of size 2^( 5) =       0.000416875623
  error estimate for blocks of size 2^( 6) =       0.000419418216
  error estimate for blocks of size 2^( 7) =       0.000421202665

      target function =                  N/A
              le_mean =     -17.216328535975
             les_mean =     296.714753494879
             stat err =       0.000417525175
             autocorr =       1.163855638959
              std dev =       0.547328555604
             le_variance =       0.299568547780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019733
  error estimate for blocks of size 2^( 2) =       0.000397255504
  error estimate for blocks of size 2^( 3) =       0.000405872657
  error estimate for blocks of size 2^( 4) =       0.000412604196
  error estimate for blocks of size 2^( 5) =       0.000416875623
  error estimate for blocks of size 2^( 6) =       0.000419418216
  error estimate for blocks of size 2^( 7) =       0.000421202665

      target function =                  N/A
              le_mean =     -17.216328535975
             les_mean =     296.714753494879
             stat err =       0.000417525175
             autocorr =       1.163855638959
              std dev =       0.547328555604
             le_variance =       0.299568547780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019733
  error estimate for blocks of size 2^( 2) =       0.000397255504
  error estimate for blocks of size 2^( 3) =       0.000405872657
  error estimate for blocks of size 2^( 4) =       0.000412604196
  error estimate for blocks of size 2^( 5) =       0.000416875623
  error estimate for blocks of size 2^( 6) =       0.000419418216
  error estimate for blocks of size 2^( 7) =       0.000421202665

      target function =                  N/A
              le_mean =     -17.216328535975
             les_mean =     296.714753494879
             stat err =       0.000417525175
             autocorr =       1.163855638959
              std dev =       0.547328555604
             le_variance =       0.299568547780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299595350329
                                         uncertainty =       0.002017880729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387019733
  error estimate for blocks of size 2^( 2) =       0.000397255504
  error estimate for blocks of size 2^( 3) =       0.000405872657
  error estimate for blocks of size 2^( 4) =       0.000412604196
  error estimate for blocks of size 2^( 5) =       0.000416875623
  error estimate for blocks of size 2^( 6) =       0.000419418216
  error estimate for blocks of size 2^( 7) =       0.000421202665

      target function =                  N/A
              le_mean =     -17.216328535975
             les_mean =     296.714753494879
             stat err =       0.000417525175
             autocorr =       1.163855638959
              std dev =       0.547328555604
             le_variance =       0.299568547780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216328535975        initial  <--
     2.3283e+36     2.3283e+37             0.0000e+00       -17.216328535975
     9.3132e+36     9.3132e+37             0.0000e+00       -17.216328535975
     3.7253e+37     3.7253e+38             0.0000e+00       -17.216328535975

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8493
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2583
    reference variance = 0.200478
====================================================
  Execution time = 2.0906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1783e-01
  Total weights = 1.956535327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301175448049
                                         uncertainty =       0.003237668075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301175448049
                                         uncertainty =       0.003237668075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388005045
  error estimate for blocks of size 2^( 2) =       0.000398149749
  error estimate for blocks of size 2^( 3) =       0.000407034051
  error estimate for blocks of size 2^( 4) =       0.000412741520
  error estimate for blocks of size 2^( 5) =       0.000417342289
  error estimate for blocks of size 2^( 6) =       0.000419996897
  error estimate for blocks of size 2^( 7) =       0.000422863997

      target function =                  N/A
              le_mean =     -17.215862349575
             les_mean =     296.703742635595
             stat err =       0.000418236176
             autocorr =       1.161899179732
              std dev =       0.548721996755
             le_variance =       0.301095829723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586234958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+37, overlap shift 2.3283e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+37, overlap shift 9.3132e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+38, overlap shift 3.7253e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215862349595       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.206304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6969e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2211
    reference variance = 0.210177
====================================================
  Execution time = 2.2650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1178e-01
  Total weights = 1.9565e+06
  Execution time = 1.8110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385756680
  error estimate for blocks of size 2^( 2) =       0.000395783530
  error estimate for blocks of size 2^( 3) =       0.000405064838
  error estimate for blocks of size 2^( 4) =       0.000411090403
  error estimate for blocks of size 2^( 5) =       0.000416239193
  error estimate for blocks of size 2^( 6) =       0.000420000654
  error estimate for blocks of size 2^( 7) =       0.000421540401

      target function =                  N/A
              le_mean =     -17.216422985068
             les_mean =     296.716995925086
             stat err =       0.000417217663
             autocorr =       1.169764563865
              std dev =       0.545542329072
             le_variance =       0.297616432810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385756680
  error estimate for blocks of size 2^( 2) =       0.000395783530
  error estimate for blocks of size 2^( 3) =       0.000405064838
  error estimate for blocks of size 2^( 4) =       0.000411090403
  error estimate for blocks of size 2^( 5) =       0.000416239193
  error estimate for blocks of size 2^( 6) =       0.000420000654
  error estimate for blocks of size 2^( 7) =       0.000421540401

      target function =                  N/A
              le_mean =     -17.216422985068
             les_mean =     296.716995925086
             stat err =       0.000417217663
             autocorr =       1.169764563865
              std dev =       0.545542329072
             le_variance =       0.297616432810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385756680
  error estimate for blocks of size 2^( 2) =       0.000395783530
  error estimate for blocks of size 2^( 3) =       0.000405064838
  error estimate for blocks of size 2^( 4) =       0.000411090403
  error estimate for blocks of size 2^( 5) =       0.000416239193
  error estimate for blocks of size 2^( 6) =       0.000420000654
  error estimate for blocks of size 2^( 7) =       0.000421540401

      target function =                  N/A
              le_mean =     -17.216422985068
             les_mean =     296.716995925086
             stat err =       0.000417217663
             autocorr =       1.169764563865
              std dev =       0.545542329072
             le_variance =       0.297616432810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297605894110
                                         uncertainty =       0.002009095891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385756680
  error estimate for blocks of size 2^( 2) =       0.000395783530
  error estimate for blocks of size 2^( 3) =       0.000405064838
  error estimate for blocks of size 2^( 4) =       0.000411090403
  error estimate for blocks of size 2^( 5) =       0.000416239193
  error estimate for blocks of size 2^( 6) =       0.000420000654
  error estimate for blocks of size 2^( 7) =       0.000421540401

      target function =                  N/A
              le_mean =     -17.216422985068
             les_mean =     296.716995925086
             stat err =       0.000417217663
             autocorr =       1.169764563865
              std dev =       0.545542329072
             le_variance =       0.297616432810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216422985068        initial  <--
     2.3283e+37     2.3283e+38             0.0000e+00       -17.216422985068
     9.3132e+37     9.3132e+38             0.0000e+00       -17.216422985068
     3.7253e+38     3.7253e+39             0.0000e+00       -17.216422985068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8556
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2758
    reference variance = 0.292684
====================================================
  Execution time = 2.0830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0995e-01
  Total weights = 1.956362396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296488937600
                                         uncertainty =       0.001933482604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296488937600
                                         uncertainty =       0.001933482604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385005829
  error estimate for blocks of size 2^( 2) =       0.000394826140
  error estimate for blocks of size 2^( 3) =       0.000403634309
  error estimate for blocks of size 2^( 4) =       0.000411122488
  error estimate for blocks of size 2^( 5) =       0.000415911464
  error estimate for blocks of size 2^( 6) =       0.000419623474
  error estimate for blocks of size 2^( 7) =       0.000421235599

      target function =                  N/A
              le_mean =     -17.216476220867
             les_mean =     296.717003049101
             stat err =       0.000416973256
             autocorr =       1.172956192100
              std dev =       0.544480465039
             le_variance =       0.296458976810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647622087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+38, overlap shift 2.3283e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+38, overlap shift 9.3132e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+39, overlap shift 3.7253e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216476220897       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.207473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6810e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2526
    reference variance = 0.28334
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0964e-01
  Total weights = 1.9565e+06
  Execution time = 1.8140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383480935
  error estimate for blocks of size 2^( 2) =       0.000393557800
  error estimate for blocks of size 2^( 3) =       0.000402306230
  error estimate for blocks of size 2^( 4) =       0.000409380187
  error estimate for blocks of size 2^( 5) =       0.000413645322
  error estimate for blocks of size 2^( 6) =       0.000417590769
  error estimate for blocks of size 2^( 7) =       0.000419395267

      target function =                  N/A
              le_mean =     -17.216203480120
             les_mean =     296.707302744431
             stat err =       0.000415002886
             autocorr =       1.171155814537
              std dev =       0.542323939269
             le_variance =       0.294115255104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383480935
  error estimate for blocks of size 2^( 2) =       0.000393557800
  error estimate for blocks of size 2^( 3) =       0.000402306230
  error estimate for blocks of size 2^( 4) =       0.000409380187
  error estimate for blocks of size 2^( 5) =       0.000413645322
  error estimate for blocks of size 2^( 6) =       0.000417590769
  error estimate for blocks of size 2^( 7) =       0.000419395267

      target function =                  N/A
              le_mean =     -17.216203480120
             les_mean =     296.707302744431
             stat err =       0.000415002886
             autocorr =       1.171155814537
              std dev =       0.542323939269
             le_variance =       0.294115255104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383480935
  error estimate for blocks of size 2^( 2) =       0.000393557800
  error estimate for blocks of size 2^( 3) =       0.000402306230
  error estimate for blocks of size 2^( 4) =       0.000409380187
  error estimate for blocks of size 2^( 5) =       0.000413645322
  error estimate for blocks of size 2^( 6) =       0.000417590769
  error estimate for blocks of size 2^( 7) =       0.000419395267

      target function =                  N/A
              le_mean =     -17.216203480120
             les_mean =     296.707302744431
             stat err =       0.000415002886
             autocorr =       1.171155814537
              std dev =       0.542323939269
             le_variance =       0.294115255104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294185774872
                                         uncertainty =       0.002028774262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383480935
  error estimate for blocks of size 2^( 2) =       0.000393557800
  error estimate for blocks of size 2^( 3) =       0.000402306230
  error estimate for blocks of size 2^( 4) =       0.000409380187
  error estimate for blocks of size 2^( 5) =       0.000413645322
  error estimate for blocks of size 2^( 6) =       0.000417590769
  error estimate for blocks of size 2^( 7) =       0.000419395267

      target function =                  N/A
              le_mean =     -17.216203480120
             les_mean =     296.707302744431
             stat err =       0.000415002886
             autocorr =       1.171155814537
              std dev =       0.542323939269
             le_variance =       0.294115255104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216203480120        initial  <--
     2.3283e+38     2.3283e+39             0.0000e+00       -17.216203480120
     9.3132e+38     9.3132e+39             0.0000e+00       -17.216203480120
     3.7253e+39     3.7253e+40             0.0000e+00       -17.216203480120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9362
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2066
    reference variance = 0.220914
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1404e-01
  Total weights = 1.956700493e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300533730741
                                         uncertainty =       0.002064458095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300533730741
                                         uncertainty =       0.002064458095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387614642
  error estimate for blocks of size 2^( 2) =       0.000397735909
  error estimate for blocks of size 2^( 3) =       0.000406775540
  error estimate for blocks of size 2^( 4) =       0.000413796273
  error estimate for blocks of size 2^( 5) =       0.000417385985
  error estimate for blocks of size 2^( 6) =       0.000418694451
  error estimate for blocks of size 2^( 7) =       0.000418772998

      target function =                  N/A
              le_mean =     -17.216596719102
             les_mean =     296.725243704715
             stat err =       0.000417162427
             autocorr =       1.158270572582
              std dev =       0.548169883838
             le_variance =       0.300490221547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659671910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+39, overlap shift 2.3283e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+39, overlap shift 9.3132e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+40, overlap shift 3.7253e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596719165       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.208648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6693e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.1854
====================================================
  Execution time = 2.0702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 1.9565e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388380892
  error estimate for blocks of size 2^( 2) =       0.000398166327
  error estimate for blocks of size 2^( 3) =       0.000406840211
  error estimate for blocks of size 2^( 4) =       0.000412631620
  error estimate for blocks of size 2^( 5) =       0.000416219646
  error estimate for blocks of size 2^( 6) =       0.000417245674
  error estimate for blocks of size 2^( 7) =       0.000419507153

      target function =                  N/A
              le_mean =     -17.216113682870
             les_mean =     296.709993502865
             stat err =       0.000416401023
             autocorr =       1.149497064398
              std dev =       0.549253524693
             le_variance =       0.301679434388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388380892
  error estimate for blocks of size 2^( 2) =       0.000398166327
  error estimate for blocks of size 2^( 3) =       0.000406840211
  error estimate for blocks of size 2^( 4) =       0.000412631620
  error estimate for blocks of size 2^( 5) =       0.000416219646
  error estimate for blocks of size 2^( 6) =       0.000417245674
  error estimate for blocks of size 2^( 7) =       0.000419507153

      target function =                  N/A
              le_mean =     -17.216113682870
             les_mean =     296.709993502865
             stat err =       0.000416401023
             autocorr =       1.149497064398
              std dev =       0.549253524693
             le_variance =       0.301679434388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388380892
  error estimate for blocks of size 2^( 2) =       0.000398166327
  error estimate for blocks of size 2^( 3) =       0.000406840211
  error estimate for blocks of size 2^( 4) =       0.000412631620
  error estimate for blocks of size 2^( 5) =       0.000416219646
  error estimate for blocks of size 2^( 6) =       0.000417245674
  error estimate for blocks of size 2^( 7) =       0.000419507153

      target function =                  N/A
              le_mean =     -17.216113682870
             les_mean =     296.709993502865
             stat err =       0.000416401023
             autocorr =       1.149497064398
              std dev =       0.549253524693
             le_variance =       0.301679434388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301724558322
                                         uncertainty =       0.002320884604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388380892
  error estimate for blocks of size 2^( 2) =       0.000398166327
  error estimate for blocks of size 2^( 3) =       0.000406840211
  error estimate for blocks of size 2^( 4) =       0.000412631620
  error estimate for blocks of size 2^( 5) =       0.000416219646
  error estimate for blocks of size 2^( 6) =       0.000417245674
  error estimate for blocks of size 2^( 7) =       0.000419507153

      target function =                  N/A
              le_mean =     -17.216113682870
             les_mean =     296.709993502865
             stat err =       0.000416401023
             autocorr =       1.149497064398
              std dev =       0.549253524693
             le_variance =       0.301679434388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216113682870        initial  <--
     2.3283e+39     2.3283e+40             0.0000e+00       -17.216113682870
     9.3132e+39     9.3132e+40             0.0000e+00       -17.216113682870
     3.7253e+40     3.7253e+41             0.0000e+00       -17.216113682870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9045
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.199475
====================================================
  Execution time = 2.0874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1244e-01
  Total weights = 1.956618151e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277104776
                                         uncertainty =       0.001856380571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297277104776
                                         uncertainty =       0.001856380571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385502394
  error estimate for blocks of size 2^( 2) =       0.000395736370
  error estimate for blocks of size 2^( 3) =       0.000404711515
  error estimate for blocks of size 2^( 4) =       0.000410815925
  error estimate for blocks of size 2^( 5) =       0.000415613663
  error estimate for blocks of size 2^( 6) =       0.000417150798
  error estimate for blocks of size 2^( 7) =       0.000418718883

      target function =                  N/A
              le_mean =     -17.216358461419
             les_mean =     296.715438271097
             stat err =       0.000415574817
             autocorr =       1.162102100207
              std dev =       0.545182714084
             le_variance =       0.297224191736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635846142e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+40, overlap shift 2.3283e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+40, overlap shift 9.3132e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+41, overlap shift 3.7253e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216358461435       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.209816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6962e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.162648
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1313e-01
  Total weights = 1.9564e+06
  Execution time = 1.8119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385951672
  error estimate for blocks of size 2^( 2) =       0.000395859582
  error estimate for blocks of size 2^( 3) =       0.000404721119
  error estimate for blocks of size 2^( 4) =       0.000411455744
  error estimate for blocks of size 2^( 5) =       0.000415562736
  error estimate for blocks of size 2^( 6) =       0.000418138801
  error estimate for blocks of size 2^( 7) =       0.000420853316

      target function =                  N/A
              le_mean =     -17.216255552833
             les_mean =     296.712588446700
             stat err =       0.000416502649
             autocorr =       1.164580952051
              std dev =       0.545818088872
             le_variance =       0.297917386140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385951672
  error estimate for blocks of size 2^( 2) =       0.000395859582
  error estimate for blocks of size 2^( 3) =       0.000404721119
  error estimate for blocks of size 2^( 4) =       0.000411455744
  error estimate for blocks of size 2^( 5) =       0.000415562736
  error estimate for blocks of size 2^( 6) =       0.000418138801
  error estimate for blocks of size 2^( 7) =       0.000420853316

      target function =                  N/A
              le_mean =     -17.216255552833
             les_mean =     296.712588446700
             stat err =       0.000416502649
             autocorr =       1.164580952051
              std dev =       0.545818088872
             le_variance =       0.297917386140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385951672
  error estimate for blocks of size 2^( 2) =       0.000395859582
  error estimate for blocks of size 2^( 3) =       0.000404721119
  error estimate for blocks of size 2^( 4) =       0.000411455744
  error estimate for blocks of size 2^( 5) =       0.000415562736
  error estimate for blocks of size 2^( 6) =       0.000418138801
  error estimate for blocks of size 2^( 7) =       0.000420853316

      target function =                  N/A
              le_mean =     -17.216255552833
             les_mean =     296.712588446700
             stat err =       0.000416502649
             autocorr =       1.164580952051
              std dev =       0.545818088872
             le_variance =       0.297917386140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297987293211
                                         uncertainty =       0.002235133008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385951672
  error estimate for blocks of size 2^( 2) =       0.000395859582
  error estimate for blocks of size 2^( 3) =       0.000404721119
  error estimate for blocks of size 2^( 4) =       0.000411455744
  error estimate for blocks of size 2^( 5) =       0.000415562736
  error estimate for blocks of size 2^( 6) =       0.000418138801
  error estimate for blocks of size 2^( 7) =       0.000420853316

      target function =                  N/A
              le_mean =     -17.216255552833
             les_mean =     296.712588446700
             stat err =       0.000416502649
             autocorr =       1.164580952051
              std dev =       0.545818088872
             le_variance =       0.297917386140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216255552833        initial  <--
     2.3283e+40     2.3283e+41             0.0000e+00       -17.216255552833
     9.3132e+40     9.3132e+41             0.0000e+00       -17.216255552833
     3.7253e+41     3.7253e+42             0.0000e+00       -17.216255552833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5898
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.328393
====================================================
  Execution time = 2.0621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1016e-01
  Total weights = 1.956522540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296476621490
                                         uncertainty =       0.001849297779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296476621490
                                         uncertainty =       0.001849297779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385004795
  error estimate for blocks of size 2^( 2) =       0.000394747243
  error estimate for blocks of size 2^( 3) =       0.000404238642
  error estimate for blocks of size 2^( 4) =       0.000410224243
  error estimate for blocks of size 2^( 5) =       0.000414761071
  error estimate for blocks of size 2^( 6) =       0.000416221928
  error estimate for blocks of size 2^( 7) =       0.000418511268

      target function =                  N/A
              le_mean =     -17.216220665667
             les_mean =     296.708414849882
             stat err =       0.000414929628
             autocorr =       1.161493050309
              std dev =       0.544479002941
             le_variance =       0.296457384643


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721622066567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+41, overlap shift 2.3283e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220665694       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220665694       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220665694       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+41 is 2.533799e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+41, overlap shift 9.3132e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220665694       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220665694       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220665694       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+41 is 6.334497e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+42, overlap shift 3.7253e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216220665694       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216220665694       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216220665694       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+42 is 1.583624e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.211279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6737e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2388
    reference variance = 0.294474
====================================================
  Execution time = 2.1338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1326e-01
  Total weights = 1.9568e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089822
  error estimate for blocks of size 2^( 2) =       0.000396302337
  error estimate for blocks of size 2^( 3) =       0.000405491819
  error estimate for blocks of size 2^( 4) =       0.000412109879
  error estimate for blocks of size 2^( 5) =       0.000416943435
  error estimate for blocks of size 2^( 6) =       0.000419944828
  error estimate for blocks of size 2^( 7) =       0.000421398960

      target function =                  N/A
              le_mean =     -17.216085432884
             les_mean =     296.706855578680
             stat err =       0.000417599275
             autocorr =       1.169883904554
              std dev =       0.546013463014
             le_variance =       0.298130701793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089822
  error estimate for blocks of size 2^( 2) =       0.000396302337
  error estimate for blocks of size 2^( 3) =       0.000405491819
  error estimate for blocks of size 2^( 4) =       0.000412109879
  error estimate for blocks of size 2^( 5) =       0.000416943435
  error estimate for blocks of size 2^( 6) =       0.000419944828
  error estimate for blocks of size 2^( 7) =       0.000421398960

      target function =                  N/A
              le_mean =     -17.216085432884
             les_mean =     296.706855578680
             stat err =       0.000417599275
             autocorr =       1.169883904554
              std dev =       0.546013463014
             le_variance =       0.298130701793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089822
  error estimate for blocks of size 2^( 2) =       0.000396302337
  error estimate for blocks of size 2^( 3) =       0.000405491819
  error estimate for blocks of size 2^( 4) =       0.000412109879
  error estimate for blocks of size 2^( 5) =       0.000416943435
  error estimate for blocks of size 2^( 6) =       0.000419944828
  error estimate for blocks of size 2^( 7) =       0.000421398960

      target function =                  N/A
              le_mean =     -17.216085432884
             les_mean =     296.706855578680
             stat err =       0.000417599275
             autocorr =       1.169883904554
              std dev =       0.546013463014
             le_variance =       0.298130701793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298175334757
                                         uncertainty =       0.001672345095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386089822
  error estimate for blocks of size 2^( 2) =       0.000396302337
  error estimate for blocks of size 2^( 3) =       0.000405491819
  error estimate for blocks of size 2^( 4) =       0.000412109879
  error estimate for blocks of size 2^( 5) =       0.000416943435
  error estimate for blocks of size 2^( 6) =       0.000419944828
  error estimate for blocks of size 2^( 7) =       0.000421398960

      target function =                  N/A
              le_mean =     -17.216085432884
             les_mean =     296.706855578680
             stat err =       0.000417599275
             autocorr =       1.169883904554
              std dev =       0.546013463014
             le_variance =       0.298130701793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216085432884        initial  <--
     2.3283e+41     2.3283e+42             2.5338e-45       -17.216085432884
     9.3132e+41     9.3132e+42             6.3345e-46       -17.216085432884
     3.7253e+42     3.7253e+43             1.5836e-46       -17.216085432884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5882
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1007
    reference variance = 0.240481
====================================================
  Execution time = 2.0887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1420e-01
  Total weights = 1.957005721e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299686367450
                                         uncertainty =       0.002411685039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299686367450
                                         uncertainty =       0.002411685039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387035394
  error estimate for blocks of size 2^( 2) =       0.000396963632
  error estimate for blocks of size 2^( 3) =       0.000405999876
  error estimate for blocks of size 2^( 4) =       0.000412724257
  error estimate for blocks of size 2^( 5) =       0.000417061543
  error estimate for blocks of size 2^( 6) =       0.000419767462
  error estimate for blocks of size 2^( 7) =       0.000419254318

      target function =                  N/A
              le_mean =     -17.216747463927
             les_mean =     296.730589746980
             stat err =       0.000417201895
             autocorr =       1.161960005427
              std dev =       0.547350702900
             le_variance =       0.299592791965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674746393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+42, overlap shift 2.3283e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+42, overlap shift 9.3132e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+43, overlap shift 3.7253e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747463968       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.212458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6986e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.512636
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1471e-01
  Total weights = 1.9566e+06
  Execution time = 1.8096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240382
  error estimate for blocks of size 2^( 2) =       0.000396110049
  error estimate for blocks of size 2^( 3) =       0.000405517130
  error estimate for blocks of size 2^( 4) =       0.000412371262
  error estimate for blocks of size 2^( 5) =       0.000415159325
  error estimate for blocks of size 2^( 6) =       0.000417266424
  error estimate for blocks of size 2^( 7) =       0.000416789761

      target function =                  N/A
              le_mean =     -17.217048635495
             les_mean =     296.741472808157
             stat err =       0.000415396693
             autocorr =       1.156673310792
              std dev =       0.546226385930
             le_variance =       0.298363264686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240382
  error estimate for blocks of size 2^( 2) =       0.000396110049
  error estimate for blocks of size 2^( 3) =       0.000405517130
  error estimate for blocks of size 2^( 4) =       0.000412371262
  error estimate for blocks of size 2^( 5) =       0.000415159325
  error estimate for blocks of size 2^( 6) =       0.000417266424
  error estimate for blocks of size 2^( 7) =       0.000416789761

      target function =                  N/A
              le_mean =     -17.217048635495
             les_mean =     296.741472808157
             stat err =       0.000415396693
             autocorr =       1.156673310792
              std dev =       0.546226385930
             le_variance =       0.298363264686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240382
  error estimate for blocks of size 2^( 2) =       0.000396110049
  error estimate for blocks of size 2^( 3) =       0.000405517130
  error estimate for blocks of size 2^( 4) =       0.000412371262
  error estimate for blocks of size 2^( 5) =       0.000415159325
  error estimate for blocks of size 2^( 6) =       0.000417266424
  error estimate for blocks of size 2^( 7) =       0.000416789761

      target function =                  N/A
              le_mean =     -17.217048635495
             les_mean =     296.741472808157
             stat err =       0.000415396693
             autocorr =       1.156673310792
              std dev =       0.546226385930
             le_variance =       0.298363264686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298342439332
                                         uncertainty =       0.001942408840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240382
  error estimate for blocks of size 2^( 2) =       0.000396110049
  error estimate for blocks of size 2^( 3) =       0.000405517130
  error estimate for blocks of size 2^( 4) =       0.000412371262
  error estimate for blocks of size 2^( 5) =       0.000415159325
  error estimate for blocks of size 2^( 6) =       0.000417266424
  error estimate for blocks of size 2^( 7) =       0.000416789761

      target function =                  N/A
              le_mean =     -17.217048635495
             les_mean =     296.741472808157
             stat err =       0.000415396693
             autocorr =       1.156673310792
              std dev =       0.546226385930
             le_variance =       0.298363264686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217048635495        initial  <--
     2.3283e+42     2.3283e+43             0.0000e+00       -17.217048635495
     9.3132e+42     9.3132e+43             0.0000e+00       -17.217048635495
     3.7253e+43     3.7253e+44             0.0000e+00       -17.217048635495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.0620
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.277
    reference variance = 0.243655
====================================================
  Execution time = 2.0810e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1195e-01
  Total weights = 1.956443787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298474551308
                                         uncertainty =       0.001737194656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298474551308
                                         uncertainty =       0.001737194656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386385288
  error estimate for blocks of size 2^( 2) =       0.000396613552
  error estimate for blocks of size 2^( 3) =       0.000405424657
  error estimate for blocks of size 2^( 4) =       0.000412598191
  error estimate for blocks of size 2^( 5) =       0.000416668032
  error estimate for blocks of size 2^( 6) =       0.000419486982
  error estimate for blocks of size 2^( 7) =       0.000423165115

      target function =                  N/A
              le_mean =     -17.216735561639
             les_mean =     296.727928749519
             stat err =       0.000417979580
             autocorr =       1.170223909727
              std dev =       0.546431314599
             le_variance =       0.298587181575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673556164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+43, overlap shift 2.3283e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216735561706       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+43 is 1.085865e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+43, overlap shift 9.3132e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216735561706       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 7.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+43 is 2.714663e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+44, overlap shift 3.7253e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216735561706       residual = 8.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216735561706       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+44 is 6.786657e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.214057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6742e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.228105
====================================================
  Execution time = 2.1105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0975e-01
  Total weights = 1.9563e+06
  Execution time = 1.8223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384210855
  error estimate for blocks of size 2^( 2) =       0.000394694381
  error estimate for blocks of size 2^( 3) =       0.000403857847
  error estimate for blocks of size 2^( 4) =       0.000410818324
  error estimate for blocks of size 2^( 5) =       0.000414449787
  error estimate for blocks of size 2^( 6) =       0.000414977192
  error estimate for blocks of size 2^( 7) =       0.000416753289

      target function =                  N/A
              le_mean =     -17.216620366827
             les_mean =     296.721765500874
             stat err =       0.000414249648
             autocorr =       1.162478783347
              std dev =       0.543356201733
             le_variance =       0.295235961962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384210855
  error estimate for blocks of size 2^( 2) =       0.000394694381
  error estimate for blocks of size 2^( 3) =       0.000403857847
  error estimate for blocks of size 2^( 4) =       0.000410818324
  error estimate for blocks of size 2^( 5) =       0.000414449787
  error estimate for blocks of size 2^( 6) =       0.000414977192
  error estimate for blocks of size 2^( 7) =       0.000416753289

      target function =                  N/A
              le_mean =     -17.216620366827
             les_mean =     296.721765500874
             stat err =       0.000414249648
             autocorr =       1.162478783347
              std dev =       0.543356201733
             le_variance =       0.295235961962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384210855
  error estimate for blocks of size 2^( 2) =       0.000394694381
  error estimate for blocks of size 2^( 3) =       0.000403857847
  error estimate for blocks of size 2^( 4) =       0.000410818324
  error estimate for blocks of size 2^( 5) =       0.000414449787
  error estimate for blocks of size 2^( 6) =       0.000414977192
  error estimate for blocks of size 2^( 7) =       0.000416753289

      target function =                  N/A
              le_mean =     -17.216620366827
             les_mean =     296.721765500874
             stat err =       0.000414249648
             autocorr =       1.162478783347
              std dev =       0.543356201733
             le_variance =       0.295235961962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295208168245
                                         uncertainty =       0.001847628802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384210855
  error estimate for blocks of size 2^( 2) =       0.000394694381
  error estimate for blocks of size 2^( 3) =       0.000403857847
  error estimate for blocks of size 2^( 4) =       0.000410818324
  error estimate for blocks of size 2^( 5) =       0.000414449787
  error estimate for blocks of size 2^( 6) =       0.000414977192
  error estimate for blocks of size 2^( 7) =       0.000416753289

      target function =                  N/A
              le_mean =     -17.216620366827
             les_mean =     296.721765500874
             stat err =       0.000414249648
             autocorr =       1.162478783347
              std dev =       0.543356201733
             le_variance =       0.295235961962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216620366827        initial  <--
     2.3283e+43     2.3283e+44             1.0859e-47       -17.216620366827
     9.3132e+43     9.3132e+44             2.7147e-48       -17.216620366827
     3.7253e+44     3.7253e+45             6.7867e-49       -17.216620366827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3673
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1713
    reference variance = 0.196677
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1348e-01
  Total weights = 1.956498118e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297268429278
                                         uncertainty =       0.002229597196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297268429278
                                         uncertainty =       0.002229597196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385595239
  error estimate for blocks of size 2^( 2) =       0.000395352474
  error estimate for blocks of size 2^( 3) =       0.000404181768
  error estimate for blocks of size 2^( 4) =       0.000410275241
  error estimate for blocks of size 2^( 5) =       0.000414777517
  error estimate for blocks of size 2^( 6) =       0.000415726272
  error estimate for blocks of size 2^( 7) =       0.000417122540

      target function =                  N/A
              le_mean =     -17.216094323097
             les_mean =     296.707387612176
             stat err =       0.000414475392
             autocorr =       1.155404822944
              std dev =       0.545314017110
             le_variance =       0.297367377257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609432310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+44, overlap shift 2.3283e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+44, overlap shift 9.3132e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+45, overlap shift 3.7253e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216094323144       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.215240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6953e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.267411
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1582e-01
  Total weights = 1.9566e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387594896
  error estimate for blocks of size 2^( 2) =       0.000397600734
  error estimate for blocks of size 2^( 3) =       0.000407007256
  error estimate for blocks of size 2^( 4) =       0.000413896485
  error estimate for blocks of size 2^( 5) =       0.000418612951
  error estimate for blocks of size 2^( 6) =       0.000420204045
  error estimate for blocks of size 2^( 7) =       0.000419928778

      target function =                  N/A
              le_mean =     -17.215193877222
             les_mean =     296.678720853682
             stat err =       0.000418160565
             autocorr =       1.163938541599
              std dev =       0.548141957969
             le_variance =       0.300459606086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387594896
  error estimate for blocks of size 2^( 2) =       0.000397600734
  error estimate for blocks of size 2^( 3) =       0.000407007256
  error estimate for blocks of size 2^( 4) =       0.000413896485
  error estimate for blocks of size 2^( 5) =       0.000418612951
  error estimate for blocks of size 2^( 6) =       0.000420204045
  error estimate for blocks of size 2^( 7) =       0.000419928778

      target function =                  N/A
              le_mean =     -17.215193877222
             les_mean =     296.678720853682
             stat err =       0.000418160565
             autocorr =       1.163938541599
              std dev =       0.548141957969
             le_variance =       0.300459606086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387594896
  error estimate for blocks of size 2^( 2) =       0.000397600734
  error estimate for blocks of size 2^( 3) =       0.000407007256
  error estimate for blocks of size 2^( 4) =       0.000413896485
  error estimate for blocks of size 2^( 5) =       0.000418612951
  error estimate for blocks of size 2^( 6) =       0.000420204045
  error estimate for blocks of size 2^( 7) =       0.000419928778

      target function =                  N/A
              le_mean =     -17.215193877222
             les_mean =     296.678720853682
             stat err =       0.000418160565
             autocorr =       1.163938541599
              std dev =       0.548141957969
             le_variance =       0.300459606086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300360436285
                                         uncertainty =       0.002548074812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387594896
  error estimate for blocks of size 2^( 2) =       0.000397600734
  error estimate for blocks of size 2^( 3) =       0.000407007256
  error estimate for blocks of size 2^( 4) =       0.000413896485
  error estimate for blocks of size 2^( 5) =       0.000418612951
  error estimate for blocks of size 2^( 6) =       0.000420204045
  error estimate for blocks of size 2^( 7) =       0.000419928778

      target function =                  N/A
              le_mean =     -17.215193877222
             les_mean =     296.678720853682
             stat err =       0.000418160565
             autocorr =       1.163938541599
              std dev =       0.548141957969
             le_variance =       0.300459606086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215193877222        initial  <--
     2.3283e+44     2.3283e+45             0.0000e+00       -17.215193877222
     9.3132e+44     9.3132e+45             0.0000e+00       -17.215193877222
     3.7253e+45     3.7253e+46             0.0000e+00       -17.215193877222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9583
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6917e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2794
    reference variance = 0.489103
====================================================
  Execution time = 2.0846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1467e-01
  Total weights = 1.956744840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299781514018
                                         uncertainty =       0.002263793067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299781514018
                                         uncertainty =       0.002263793067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387133738
  error estimate for blocks of size 2^( 2) =       0.000397213765
  error estimate for blocks of size 2^( 3) =       0.000406728426
  error estimate for blocks of size 2^( 4) =       0.000413966835
  error estimate for blocks of size 2^( 5) =       0.000417223416
  error estimate for blocks of size 2^( 6) =       0.000418758330
  error estimate for blocks of size 2^( 7) =       0.000420291240

      target function =                  N/A
              le_mean =     -17.216524205600
             les_mean =     296.723372779711
             stat err =       0.000417559955
             autocorr =       1.163364058008
              std dev =       0.547489783319
             le_variance =       0.299745062839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652420560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+45, overlap shift 2.3283e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+45, overlap shift 9.3132e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+46, overlap shift 3.7253e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524205617       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.216410 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6817e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1717
    reference variance = 0.229206
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1294e-01
  Total weights = 1.9566e+06
  Execution time = 1.8088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386883314
  error estimate for blocks of size 2^( 2) =       0.000397050224
  error estimate for blocks of size 2^( 3) =       0.000406634096
  error estimate for blocks of size 2^( 4) =       0.000413868897
  error estimate for blocks of size 2^( 5) =       0.000417774152
  error estimate for blocks of size 2^( 6) =       0.000420858265
  error estimate for blocks of size 2^( 7) =       0.000422164716

      target function =                  N/A
              le_mean =     -17.217072509715
             les_mean =     296.740529474096
             stat err =       0.000418666507
             autocorr =       1.171052703402
              std dev =       0.547135629263
             le_variance =       0.299357396809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386883314
  error estimate for blocks of size 2^( 2) =       0.000397050224
  error estimate for blocks of size 2^( 3) =       0.000406634096
  error estimate for blocks of size 2^( 4) =       0.000413868897
  error estimate for blocks of size 2^( 5) =       0.000417774152
  error estimate for blocks of size 2^( 6) =       0.000420858265
  error estimate for blocks of size 2^( 7) =       0.000422164716

      target function =                  N/A
              le_mean =     -17.217072509715
             les_mean =     296.740529474096
             stat err =       0.000418666507
             autocorr =       1.171052703402
              std dev =       0.547135629263
             le_variance =       0.299357396809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386883314
  error estimate for blocks of size 2^( 2) =       0.000397050224
  error estimate for blocks of size 2^( 3) =       0.000406634096
  error estimate for blocks of size 2^( 4) =       0.000413868897
  error estimate for blocks of size 2^( 5) =       0.000417774152
  error estimate for blocks of size 2^( 6) =       0.000420858265
  error estimate for blocks of size 2^( 7) =       0.000422164716

      target function =                  N/A
              le_mean =     -17.217072509715
             les_mean =     296.740529474096
             stat err =       0.000418666507
             autocorr =       1.171052703402
              std dev =       0.547135629263
             le_variance =       0.299357396809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299412826807
                                         uncertainty =       0.001923556227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386883314
  error estimate for blocks of size 2^( 2) =       0.000397050224
  error estimate for blocks of size 2^( 3) =       0.000406634096
  error estimate for blocks of size 2^( 4) =       0.000413868897
  error estimate for blocks of size 2^( 5) =       0.000417774152
  error estimate for blocks of size 2^( 6) =       0.000420858265
  error estimate for blocks of size 2^( 7) =       0.000422164716

      target function =                  N/A
              le_mean =     -17.217072509715
             les_mean =     296.740529474096
             stat err =       0.000418666507
             autocorr =       1.171052703402
              std dev =       0.547135629263
             le_variance =       0.299357396809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217072509715        initial  <--
     2.3283e+45     2.3283e+46             0.0000e+00       -17.217072509715
     9.3132e+45     9.3132e+46             0.0000e+00       -17.217072509715
     3.7253e+46     3.7253e+47             0.0000e+00       -17.217072509715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9307
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2601
    reference variance = 0.349324
====================================================
  Execution time = 2.0648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0969e-01
  Total weights = 1.956514752e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950860265
                                         uncertainty =       0.001713183347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295950860265
                                         uncertainty =       0.001713183347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384667158
  error estimate for blocks of size 2^( 2) =       0.000394618059
  error estimate for blocks of size 2^( 3) =       0.000403723416
  error estimate for blocks of size 2^( 4) =       0.000410557880
  error estimate for blocks of size 2^( 5) =       0.000415236564
  error estimate for blocks of size 2^( 6) =       0.000417356319
  error estimate for blocks of size 2^( 7) =       0.000417074883

      target function =                  N/A
              le_mean =     -17.215756243930
             les_mean =     296.691953811657
             stat err =       0.000415056412
             autocorr =       1.164244076333
              std dev =       0.544001511479
             le_variance =       0.295937644492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721575624393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+46, overlap shift 2.3283e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+46, overlap shift 9.3132e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+47, overlap shift 3.7253e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215756243952       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.217583 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6649e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1738
    reference variance = 0.302925
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1478e-01
  Total weights = 1.9564e+06
  Execution time = 1.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386668698
  error estimate for blocks of size 2^( 2) =       0.000396684678
  error estimate for blocks of size 2^( 3) =       0.000405491544
  error estimate for blocks of size 2^( 4) =       0.000412514006
  error estimate for blocks of size 2^( 5) =       0.000416404508
  error estimate for blocks of size 2^( 6) =       0.000417466107
  error estimate for blocks of size 2^( 7) =       0.000417313684

      target function =                  N/A
              le_mean =     -17.216508384010
             les_mean =     296.722937509562
             stat err =       0.000415924576
             autocorr =       1.157047355719
              std dev =       0.546832116473
             le_variance =       0.299025363606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386668698
  error estimate for blocks of size 2^( 2) =       0.000396684678
  error estimate for blocks of size 2^( 3) =       0.000405491544
  error estimate for blocks of size 2^( 4) =       0.000412514006
  error estimate for blocks of size 2^( 5) =       0.000416404508
  error estimate for blocks of size 2^( 6) =       0.000417466107
  error estimate for blocks of size 2^( 7) =       0.000417313684

      target function =                  N/A
              le_mean =     -17.216508384010
             les_mean =     296.722937509562
             stat err =       0.000415924576
             autocorr =       1.157047355719
              std dev =       0.546832116473
             le_variance =       0.299025363606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386668698
  error estimate for blocks of size 2^( 2) =       0.000396684678
  error estimate for blocks of size 2^( 3) =       0.000405491544
  error estimate for blocks of size 2^( 4) =       0.000412514006
  error estimate for blocks of size 2^( 5) =       0.000416404508
  error estimate for blocks of size 2^( 6) =       0.000417466107
  error estimate for blocks of size 2^( 7) =       0.000417313684

      target function =                  N/A
              le_mean =     -17.216508384010
             les_mean =     296.722937509562
             stat err =       0.000415924576
             autocorr =       1.157047355719
              std dev =       0.546832116473
             le_variance =       0.299025363606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299014124405
                                         uncertainty =       0.001912652154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386668698
  error estimate for blocks of size 2^( 2) =       0.000396684678
  error estimate for blocks of size 2^( 3) =       0.000405491544
  error estimate for blocks of size 2^( 4) =       0.000412514006
  error estimate for blocks of size 2^( 5) =       0.000416404508
  error estimate for blocks of size 2^( 6) =       0.000417466107
  error estimate for blocks of size 2^( 7) =       0.000417313684

      target function =                  N/A
              le_mean =     -17.216508384010
             les_mean =     296.722937509562
             stat err =       0.000415924576
             autocorr =       1.157047355719
              std dev =       0.546832116473
             le_variance =       0.299025363606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216508384010        initial  <--
     2.3283e+46     2.3283e+47             0.0000e+00       -17.216508384010
     9.3132e+46     9.3132e+47             0.0000e+00       -17.216508384010
     3.7253e+47     3.7253e+48             0.0000e+00       -17.216508384010

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6842
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.150092
====================================================
  Execution time = 2.0870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1964e-01
  Total weights = 1.956755610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300665139855
                                         uncertainty =       0.002313291149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300665139855
                                         uncertainty =       0.002313291149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387738610
  error estimate for blocks of size 2^( 2) =       0.000397871969
  error estimate for blocks of size 2^( 3) =       0.000407795131
  error estimate for blocks of size 2^( 4) =       0.000414409245
  error estimate for blocks of size 2^( 5) =       0.000419313518
  error estimate for blocks of size 2^( 6) =       0.000421072652
  error estimate for blocks of size 2^( 7) =       0.000424183681

      target function =                  N/A
              le_mean =     -17.216054628151
             les_mean =     296.712175442495
             stat err =       0.000419744774
             autocorr =       1.171905242967
              std dev =       0.548345200895
             le_variance =       0.300682459344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605462815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+47, overlap shift 2.3283e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+47, overlap shift 9.3132e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+48, overlap shift 3.7253e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216054628147       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.218779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7004e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2758
    reference variance = 0.203431
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1694e-01
  Total weights = 1.9567e+06
  Execution time = 1.8089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389109067
  error estimate for blocks of size 2^( 2) =       0.000398600177
  error estimate for blocks of size 2^( 3) =       0.000407673642
  error estimate for blocks of size 2^( 4) =       0.000413763692
  error estimate for blocks of size 2^( 5) =       0.000417763882
  error estimate for blocks of size 2^( 6) =       0.000419554169
  error estimate for blocks of size 2^( 7) =       0.000420739480

      target function =                  N/A
              le_mean =     -17.217565191859
             les_mean =     296.761491339192
             stat err =       0.000417955306
             autocorr =       1.153764001318
              std dev =       0.550283319784
             le_variance =       0.302811732033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389109067
  error estimate for blocks of size 2^( 2) =       0.000398600177
  error estimate for blocks of size 2^( 3) =       0.000407673642
  error estimate for blocks of size 2^( 4) =       0.000413763692
  error estimate for blocks of size 2^( 5) =       0.000417763882
  error estimate for blocks of size 2^( 6) =       0.000419554169
  error estimate for blocks of size 2^( 7) =       0.000420739480

      target function =                  N/A
              le_mean =     -17.217565191859
             les_mean =     296.761491339192
             stat err =       0.000417955306
             autocorr =       1.153764001318
              std dev =       0.550283319784
             le_variance =       0.302811732033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389109067
  error estimate for blocks of size 2^( 2) =       0.000398600177
  error estimate for blocks of size 2^( 3) =       0.000407673642
  error estimate for blocks of size 2^( 4) =       0.000413763692
  error estimate for blocks of size 2^( 5) =       0.000417763882
  error estimate for blocks of size 2^( 6) =       0.000419554169
  error estimate for blocks of size 2^( 7) =       0.000420739480

      target function =                  N/A
              le_mean =     -17.217565191859
             les_mean =     296.761491339192
             stat err =       0.000417955306
             autocorr =       1.153764001318
              std dev =       0.550283319784
             le_variance =       0.302811732033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302768743026
                                         uncertainty =       0.002912737155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389109067
  error estimate for blocks of size 2^( 2) =       0.000398600177
  error estimate for blocks of size 2^( 3) =       0.000407673642
  error estimate for blocks of size 2^( 4) =       0.000413763692
  error estimate for blocks of size 2^( 5) =       0.000417763882
  error estimate for blocks of size 2^( 6) =       0.000419554169
  error estimate for blocks of size 2^( 7) =       0.000420739480

      target function =                  N/A
              le_mean =     -17.217565191859
             les_mean =     296.761491339192
             stat err =       0.000417955306
             autocorr =       1.153764001318
              std dev =       0.550283319784
             le_variance =       0.302811732033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217565191859        initial  <--
     2.3283e+47     2.3283e+48             0.0000e+00       -17.217565191859
     9.3132e+47     9.3132e+48             0.0000e+00       -17.217565191859
     3.7253e+48     3.7253e+49             0.0000e+00       -17.217565191859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6894
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2339
    reference variance = 0.411383
====================================================
  Execution time = 2.2879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1611e-01
  Total weights = 1.956608291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299951770585
                                         uncertainty =       0.001908348038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299951770585
                                         uncertainty =       0.001908348038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387203817
  error estimate for blocks of size 2^( 2) =       0.000397097973
  error estimate for blocks of size 2^( 3) =       0.000406224161
  error estimate for blocks of size 2^( 4) =       0.000412828431
  error estimate for blocks of size 2^( 5) =       0.000416231676
  error estimate for blocks of size 2^( 6) =       0.000417804905
  error estimate for blocks of size 2^( 7) =       0.000418755187

      target function =                  N/A
              le_mean =     -17.216018797189
             les_mean =     296.707415534602
             stat err =       0.000416405050
             autocorr =       1.156518848244
              std dev =       0.547588889553
             le_variance =       0.299853591962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601879719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+48, overlap shift 2.3283e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+48, overlap shift 9.3132e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+49, overlap shift 3.7253e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216018797228       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.219979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9102e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2917
    reference variance = 0.274008
====================================================
  Execution time = 2.0796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1474e-01
  Total weights = 1.9565e+06
  Execution time = 1.8085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756376
  error estimate for blocks of size 2^( 2) =       0.000396777483
  error estimate for blocks of size 2^( 3) =       0.000406356785
  error estimate for blocks of size 2^( 4) =       0.000413446334
  error estimate for blocks of size 2^( 5) =       0.000417719201
  error estimate for blocks of size 2^( 6) =       0.000421725596
  error estimate for blocks of size 2^( 7) =       0.000423658041

      target function =                  N/A
              le_mean =     -17.216434907102
             les_mean =     296.720367442937
             stat err =       0.000419137293
             autocorr =       1.174458414072
              std dev =       0.546956112553
             le_variance =       0.299160989059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756376
  error estimate for blocks of size 2^( 2) =       0.000396777483
  error estimate for blocks of size 2^( 3) =       0.000406356785
  error estimate for blocks of size 2^( 4) =       0.000413446334
  error estimate for blocks of size 2^( 5) =       0.000417719201
  error estimate for blocks of size 2^( 6) =       0.000421725596
  error estimate for blocks of size 2^( 7) =       0.000423658041

      target function =                  N/A
              le_mean =     -17.216434907102
             les_mean =     296.720367442937
             stat err =       0.000419137293
             autocorr =       1.174458414072
              std dev =       0.546956112553
             le_variance =       0.299160989059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756376
  error estimate for blocks of size 2^( 2) =       0.000396777483
  error estimate for blocks of size 2^( 3) =       0.000406356785
  error estimate for blocks of size 2^( 4) =       0.000413446334
  error estimate for blocks of size 2^( 5) =       0.000417719201
  error estimate for blocks of size 2^( 6) =       0.000421725596
  error estimate for blocks of size 2^( 7) =       0.000423658041

      target function =                  N/A
              le_mean =     -17.216434907102
             les_mean =     296.720367442937
             stat err =       0.000419137293
             autocorr =       1.174458414072
              std dev =       0.546956112553
             le_variance =       0.299160989059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169124050
                                         uncertainty =       0.002348243927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756376
  error estimate for blocks of size 2^( 2) =       0.000396777483
  error estimate for blocks of size 2^( 3) =       0.000406356785
  error estimate for blocks of size 2^( 4) =       0.000413446334
  error estimate for blocks of size 2^( 5) =       0.000417719201
  error estimate for blocks of size 2^( 6) =       0.000421725596
  error estimate for blocks of size 2^( 7) =       0.000423658041

      target function =                  N/A
              le_mean =     -17.216434907102
             les_mean =     296.720367442937
             stat err =       0.000419137293
             autocorr =       1.174458414072
              std dev =       0.546956112553
             le_variance =       0.299160989059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216434907102        initial  <--
     2.3283e+48     2.3283e+49             0.0000e+00       -17.216434907102
     9.3132e+48     9.3132e+49             0.0000e+00       -17.216434907102
     3.7253e+49     3.7253e+50             0.0000e+00       -17.216434907102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9384
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9047e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.355997
====================================================
  Execution time = 2.1013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1102e-01
  Total weights = 1.956540231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298372852479
                                         uncertainty =       0.002081641912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298372852479
                                         uncertainty =       0.002081641912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386218359
  error estimate for blocks of size 2^( 2) =       0.000396146916
  error estimate for blocks of size 2^( 3) =       0.000405021661
  error estimate for blocks of size 2^( 4) =       0.000412008628
  error estimate for blocks of size 2^( 5) =       0.000415817548
  error estimate for blocks of size 2^( 6) =       0.000417511090
  error estimate for blocks of size 2^( 7) =       0.000418063831

      target function =                  N/A
              le_mean =     -17.215722163411
             les_mean =     296.692109292150
             stat err =       0.000415850274
             autocorr =       1.159332889592
              std dev =       0.546195240932
             le_variance =       0.298329241217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572216341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+49, overlap shift 2.3283e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+49, overlap shift 9.3132e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+50, overlap shift 3.7253e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215722163444       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.221160 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7073e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2611
    reference variance = 0.620055
====================================================
  Execution time = 2.0506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1178e-01
  Total weights = 1.9562e+06
  Execution time = 1.8117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385986086
  error estimate for blocks of size 2^( 2) =       0.000396408465
  error estimate for blocks of size 2^( 3) =       0.000405327049
  error estimate for blocks of size 2^( 4) =       0.000412196280
  error estimate for blocks of size 2^( 5) =       0.000415673117
  error estimate for blocks of size 2^( 6) =       0.000419080232
  error estimate for blocks of size 2^( 7) =       0.000421995701

      target function =                  N/A
              le_mean =     -17.215897886954
             les_mean =     296.698920791833
             stat err =       0.000417236333
             autocorr =       1.168479078007
              std dev =       0.545866757088
             le_variance =       0.297970516494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385986086
  error estimate for blocks of size 2^( 2) =       0.000396408465
  error estimate for blocks of size 2^( 3) =       0.000405327049
  error estimate for blocks of size 2^( 4) =       0.000412196280
  error estimate for blocks of size 2^( 5) =       0.000415673117
  error estimate for blocks of size 2^( 6) =       0.000419080232
  error estimate for blocks of size 2^( 7) =       0.000421995701

      target function =                  N/A
              le_mean =     -17.215897886954
             les_mean =     296.698920791833
             stat err =       0.000417236333
             autocorr =       1.168479078007
              std dev =       0.545866757088
             le_variance =       0.297970516494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385986086
  error estimate for blocks of size 2^( 2) =       0.000396408465
  error estimate for blocks of size 2^( 3) =       0.000405327049
  error estimate for blocks of size 2^( 4) =       0.000412196280
  error estimate for blocks of size 2^( 5) =       0.000415673117
  error estimate for blocks of size 2^( 6) =       0.000419080232
  error estimate for blocks of size 2^( 7) =       0.000421995701

      target function =                  N/A
              le_mean =     -17.215897886954
             les_mean =     296.698920791833
             stat err =       0.000417236333
             autocorr =       1.168479078007
              std dev =       0.545866757088
             le_variance =       0.297970516494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963797246
                                         uncertainty =       0.001875549039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385986086
  error estimate for blocks of size 2^( 2) =       0.000396408465
  error estimate for blocks of size 2^( 3) =       0.000405327049
  error estimate for blocks of size 2^( 4) =       0.000412196280
  error estimate for blocks of size 2^( 5) =       0.000415673117
  error estimate for blocks of size 2^( 6) =       0.000419080232
  error estimate for blocks of size 2^( 7) =       0.000421995701

      target function =                  N/A
              le_mean =     -17.215897886954
             les_mean =     296.698920791833
             stat err =       0.000417236333
             autocorr =       1.168479078007
              std dev =       0.545866757088
             le_variance =       0.297970516494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215897886954        initial  <--
     2.3283e+49     2.3283e+50             0.0000e+00       -17.215897886954
     9.3132e+49     9.3132e+50             0.0000e+00       -17.215897886954
     3.7253e+50     3.7253e+51             0.0000e+00       -17.215897886954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7059
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2917
    reference variance = 0.432018
====================================================
  Execution time = 2.0681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1693e-01
  Total weights = 1.956387196e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301371023611
                                         uncertainty =       0.002247084099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301371023611
                                         uncertainty =       0.002247084099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388175845
  error estimate for blocks of size 2^( 2) =       0.000397900747
  error estimate for blocks of size 2^( 3) =       0.000406848130
  error estimate for blocks of size 2^( 4) =       0.000413092434
  error estimate for blocks of size 2^( 5) =       0.000416848887
  error estimate for blocks of size 2^( 6) =       0.000418836746
  error estimate for blocks of size 2^( 7) =       0.000419037251

      target function =                  N/A
              le_mean =     -17.216935999660
             les_mean =     296.739810923884
             stat err =       0.000416953830
             autocorr =       1.153769141312
              std dev =       0.548963545103
             le_variance =       0.301360973852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693599966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+50, overlap shift 2.3283e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+50, overlap shift 9.3132e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+51, overlap shift 3.7253e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935999715       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.222345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6826e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2382
    reference variance = 0.187196
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1241e-01
  Total weights = 1.9567e+06
  Execution time = 1.8093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385281808
  error estimate for blocks of size 2^( 2) =       0.000395298551
  error estimate for blocks of size 2^( 3) =       0.000404371233
  error estimate for blocks of size 2^( 4) =       0.000411460777
  error estimate for blocks of size 2^( 5) =       0.000416535702
  error estimate for blocks of size 2^( 6) =       0.000419494381
  error estimate for blocks of size 2^( 7) =       0.000421647766

      target function =                  N/A
              le_mean =     -17.216914903031
             les_mean =     296.734571480969
             stat err =       0.000417284656
             autocorr =       1.173026504600
              std dev =       0.544870758105
             le_variance =       0.296884143038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385281808
  error estimate for blocks of size 2^( 2) =       0.000395298551
  error estimate for blocks of size 2^( 3) =       0.000404371233
  error estimate for blocks of size 2^( 4) =       0.000411460777
  error estimate for blocks of size 2^( 5) =       0.000416535702
  error estimate for blocks of size 2^( 6) =       0.000419494381
  error estimate for blocks of size 2^( 7) =       0.000421647766

      target function =                  N/A
              le_mean =     -17.216914903031
             les_mean =     296.734571480969
             stat err =       0.000417284656
             autocorr =       1.173026504600
              std dev =       0.544870758105
             le_variance =       0.296884143038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385281808
  error estimate for blocks of size 2^( 2) =       0.000395298551
  error estimate for blocks of size 2^( 3) =       0.000404371233
  error estimate for blocks of size 2^( 4) =       0.000411460777
  error estimate for blocks of size 2^( 5) =       0.000416535702
  error estimate for blocks of size 2^( 6) =       0.000419494381
  error estimate for blocks of size 2^( 7) =       0.000421647766

      target function =                  N/A
              le_mean =     -17.216914903031
             les_mean =     296.734571480969
             stat err =       0.000417284656
             autocorr =       1.173026504600
              std dev =       0.544870758105
             le_variance =       0.296884143038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941729190
                                         uncertainty =       0.001802164539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385281808
  error estimate for blocks of size 2^( 2) =       0.000395298551
  error estimate for blocks of size 2^( 3) =       0.000404371233
  error estimate for blocks of size 2^( 4) =       0.000411460777
  error estimate for blocks of size 2^( 5) =       0.000416535702
  error estimate for blocks of size 2^( 6) =       0.000419494381
  error estimate for blocks of size 2^( 7) =       0.000421647766

      target function =                  N/A
              le_mean =     -17.216914903031
             les_mean =     296.734571480969
             stat err =       0.000417284656
             autocorr =       1.173026504600
              std dev =       0.544870758105
             le_variance =       0.296884143038


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216914903031        initial  <--
     2.3283e+50     2.3283e+51             0.0000e+00       -17.216914903031
     9.3132e+50     9.3132e+51             0.0000e+00       -17.216914903031
     3.7253e+51     3.7253e+52             0.0000e+00       -17.216914903031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6903
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2605
    reference variance = 0.23844
====================================================
  Execution time = 2.0569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1365e-01
  Total weights = 1.956371314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292596201
                                         uncertainty =       0.001830162804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292596201
                                         uncertainty =       0.001830162804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387456757
  error estimate for blocks of size 2^( 2) =       0.000397412297
  error estimate for blocks of size 2^( 3) =       0.000406700661
  error estimate for blocks of size 2^( 4) =       0.000413754528
  error estimate for blocks of size 2^( 5) =       0.000417929553
  error estimate for blocks of size 2^( 6) =       0.000419040891
  error estimate for blocks of size 2^( 7) =       0.000421440019

      target function =                  N/A
              le_mean =     -17.216412471342
             les_mean =     296.718509689982
             stat err =       0.000418041248
             autocorr =       1.164104028807
              std dev =       0.547946600575
             le_variance =       0.300245477082


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641247134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+51, overlap shift 2.3283e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412471410       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412471410       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412471410       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+51 is 2.267172e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+51, overlap shift 9.3132e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412471410       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412471410       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412471410       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+51 is 5.667931e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+52, overlap shift 3.7253e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216412471410       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216412471410       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216412471410       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+52 is 1.416983e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.223786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6588e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1817
    reference variance = 0.230331
====================================================
  Execution time = 2.0591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1163e-01
  Total weights = 1.9564e+06
  Execution time = 1.8171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385591057
  error estimate for blocks of size 2^( 2) =       0.000395575929
  error estimate for blocks of size 2^( 3) =       0.000404837485
  error estimate for blocks of size 2^( 4) =       0.000411904797
  error estimate for blocks of size 2^( 5) =       0.000416627132
  error estimate for blocks of size 2^( 6) =       0.000417669815
  error estimate for blocks of size 2^( 7) =       0.000418274789

      target function =                  N/A
              le_mean =     -17.216149963254
             les_mean =     296.707454290521
             stat err =       0.000416119133
             autocorr =       1.164612549324
              std dev =       0.545308101922
             le_variance =       0.297360926022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385591057
  error estimate for blocks of size 2^( 2) =       0.000395575929
  error estimate for blocks of size 2^( 3) =       0.000404837485
  error estimate for blocks of size 2^( 4) =       0.000411904797
  error estimate for blocks of size 2^( 5) =       0.000416627132
  error estimate for blocks of size 2^( 6) =       0.000417669815
  error estimate for blocks of size 2^( 7) =       0.000418274789

      target function =                  N/A
              le_mean =     -17.216149963254
             les_mean =     296.707454290521
             stat err =       0.000416119133
             autocorr =       1.164612549324
              std dev =       0.545308101922
             le_variance =       0.297360926022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385591057
  error estimate for blocks of size 2^( 2) =       0.000395575929
  error estimate for blocks of size 2^( 3) =       0.000404837485
  error estimate for blocks of size 2^( 4) =       0.000411904797
  error estimate for blocks of size 2^( 5) =       0.000416627132
  error estimate for blocks of size 2^( 6) =       0.000417669815
  error estimate for blocks of size 2^( 7) =       0.000418274789

      target function =                  N/A
              le_mean =     -17.216149963254
             les_mean =     296.707454290521
             stat err =       0.000416119133
             autocorr =       1.164612549324
              std dev =       0.545308101922
             le_variance =       0.297360926022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297440869934
                                         uncertainty =       0.002096341042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385591057
  error estimate for blocks of size 2^( 2) =       0.000395575929
  error estimate for blocks of size 2^( 3) =       0.000404837485
  error estimate for blocks of size 2^( 4) =       0.000411904797
  error estimate for blocks of size 2^( 5) =       0.000416627132
  error estimate for blocks of size 2^( 6) =       0.000417669815
  error estimate for blocks of size 2^( 7) =       0.000418274789

      target function =                  N/A
              le_mean =     -17.216149963254
             les_mean =     296.707454290521
             stat err =       0.000416119133
             autocorr =       1.164612549324
              std dev =       0.545308101922
             le_variance =       0.297360926022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216149963254        initial  <--
     2.3283e+51     2.3283e+52             2.2672e-55       -17.216149963254
     9.3132e+51     9.3132e+52             5.6679e-56       -17.216149963254
     3.7253e+52     3.7253e+53             1.4170e-56       -17.216149963254

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7836
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1477
    reference variance = 1.21993
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.956442869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300070647853
                                         uncertainty =       0.001768658383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300070647853
                                         uncertainty =       0.001768658383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387314765
  error estimate for blocks of size 2^( 2) =       0.000397350325
  error estimate for blocks of size 2^( 3) =       0.000406903692
  error estimate for blocks of size 2^( 4) =       0.000413116609
  error estimate for blocks of size 2^( 5) =       0.000417407898
  error estimate for blocks of size 2^( 6) =       0.000420031208
  error estimate for blocks of size 2^( 7) =       0.000420494315

      target function =                  N/A
              le_mean =     -17.216318601525
             les_mean =     296.714191869130
             stat err =       0.000417762507
             autocorr =       1.163404703047
              std dev =       0.547745793834
             le_variance =       0.300025454663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631860152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+52, overlap shift 2.3283e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+52, overlap shift 9.3132e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+53, overlap shift 3.7253e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318601555       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.224975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6766e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2762
    reference variance = 0.394588
====================================================
  Execution time = 2.0759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1739e-01
  Total weights = 1.9566e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387115764
  error estimate for blocks of size 2^( 2) =       0.000397365002
  error estimate for blocks of size 2^( 3) =       0.000406682352
  error estimate for blocks of size 2^( 4) =       0.000413155439
  error estimate for blocks of size 2^( 5) =       0.000417719913
  error estimate for blocks of size 2^( 6) =       0.000421752201
  error estimate for blocks of size 2^( 7) =       0.000424270740

      target function =                  N/A
              le_mean =     -17.216552601850
             les_mean =     296.727072279074
             stat err =       0.000419224573
             autocorr =       1.172767035485
              std dev =       0.547464362983
             le_variance =       0.299717228736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387115764
  error estimate for blocks of size 2^( 2) =       0.000397365002
  error estimate for blocks of size 2^( 3) =       0.000406682352
  error estimate for blocks of size 2^( 4) =       0.000413155439
  error estimate for blocks of size 2^( 5) =       0.000417719913
  error estimate for blocks of size 2^( 6) =       0.000421752201
  error estimate for blocks of size 2^( 7) =       0.000424270740

      target function =                  N/A
              le_mean =     -17.216552601850
             les_mean =     296.727072279074
             stat err =       0.000419224573
             autocorr =       1.172767035485
              std dev =       0.547464362983
             le_variance =       0.299717228736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387115764
  error estimate for blocks of size 2^( 2) =       0.000397365002
  error estimate for blocks of size 2^( 3) =       0.000406682352
  error estimate for blocks of size 2^( 4) =       0.000413155439
  error estimate for blocks of size 2^( 5) =       0.000417719913
  error estimate for blocks of size 2^( 6) =       0.000421752201
  error estimate for blocks of size 2^( 7) =       0.000424270740

      target function =                  N/A
              le_mean =     -17.216552601850
             les_mean =     296.727072279074
             stat err =       0.000419224573
             autocorr =       1.172767035485
              std dev =       0.547464362983
             le_variance =       0.299717228736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299746634749
                                         uncertainty =       0.002710251483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387115764
  error estimate for blocks of size 2^( 2) =       0.000397365002
  error estimate for blocks of size 2^( 3) =       0.000406682352
  error estimate for blocks of size 2^( 4) =       0.000413155439
  error estimate for blocks of size 2^( 5) =       0.000417719913
  error estimate for blocks of size 2^( 6) =       0.000421752201
  error estimate for blocks of size 2^( 7) =       0.000424270740

      target function =                  N/A
              le_mean =     -17.216552601850
             les_mean =     296.727072279074
             stat err =       0.000419224573
             autocorr =       1.172767035485
              std dev =       0.547464362983
             le_variance =       0.299717228736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216552601850        initial  <--
     2.3283e+52     2.3283e+53             0.0000e+00       -17.216552601850
     9.3132e+52     9.3132e+53             0.0000e+00       -17.216552601850
     3.7253e+53     3.7253e+54             0.0000e+00       -17.216552601850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9577
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.418823
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1628e-01
  Total weights = 1.956603966e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605485085
                                         uncertainty =       0.001842076106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605485085
                                         uncertainty =       0.001842076106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387711670
  error estimate for blocks of size 2^( 2) =       0.000397801068
  error estimate for blocks of size 2^( 3) =       0.000406771246
  error estimate for blocks of size 2^( 4) =       0.000413773673
  error estimate for blocks of size 2^( 5) =       0.000417960212
  error estimate for blocks of size 2^( 6) =       0.000420183145
  error estimate for blocks of size 2^( 7) =       0.000422132348

      target function =                  N/A
              le_mean =     -17.216348405982
             les_mean =     296.718928069235
             stat err =       0.000418512344
             autocorr =       1.165195501770
              std dev =       0.548307101323
             le_variance =       0.300640677362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634840598e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+53, overlap shift 2.3283e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+53, overlap shift 9.3132e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+54, overlap shift 3.7253e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216348406025       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.226195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9508e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.328973
====================================================
  Execution time = 2.0741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1675e-01
  Total weights = 1.9569e+06
  Execution time = 1.8104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385647158
  error estimate for blocks of size 2^( 2) =       0.000395599357
  error estimate for blocks of size 2^( 3) =       0.000404540353
  error estimate for blocks of size 2^( 4) =       0.000410522353
  error estimate for blocks of size 2^( 5) =       0.000414142215
  error estimate for blocks of size 2^( 6) =       0.000416377039
  error estimate for blocks of size 2^( 7) =       0.000416717352

      target function =                  N/A
              le_mean =     -17.216012597727
             les_mean =     296.707837460714
             stat err =       0.000414439740
             autocorr =       1.154895036285
              std dev =       0.545387440557
             le_variance =       0.297447460318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385647158
  error estimate for blocks of size 2^( 2) =       0.000395599357
  error estimate for blocks of size 2^( 3) =       0.000404540353
  error estimate for blocks of size 2^( 4) =       0.000410522353
  error estimate for blocks of size 2^( 5) =       0.000414142215
  error estimate for blocks of size 2^( 6) =       0.000416377039
  error estimate for blocks of size 2^( 7) =       0.000416717352

      target function =                  N/A
              le_mean =     -17.216012597727
             les_mean =     296.707837460714
             stat err =       0.000414439740
             autocorr =       1.154895036285
              std dev =       0.545387440557
             le_variance =       0.297447460318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385647158
  error estimate for blocks of size 2^( 2) =       0.000395599357
  error estimate for blocks of size 2^( 3) =       0.000404540353
  error estimate for blocks of size 2^( 4) =       0.000410522353
  error estimate for blocks of size 2^( 5) =       0.000414142215
  error estimate for blocks of size 2^( 6) =       0.000416377039
  error estimate for blocks of size 2^( 7) =       0.000416717352

      target function =                  N/A
              le_mean =     -17.216012597727
             les_mean =     296.707837460714
             stat err =       0.000414439740
             autocorr =       1.154895036285
              std dev =       0.545387440557
             le_variance =       0.297447460318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297476277335
                                         uncertainty =       0.001823580784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385647158
  error estimate for blocks of size 2^( 2) =       0.000395599357
  error estimate for blocks of size 2^( 3) =       0.000404540353
  error estimate for blocks of size 2^( 4) =       0.000410522353
  error estimate for blocks of size 2^( 5) =       0.000414142215
  error estimate for blocks of size 2^( 6) =       0.000416377039
  error estimate for blocks of size 2^( 7) =       0.000416717352

      target function =                  N/A
              le_mean =     -17.216012597727
             les_mean =     296.707837460714
             stat err =       0.000414439740
             autocorr =       1.154895036285
              std dev =       0.545387440557
             le_variance =       0.297447460318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216012597727        initial  <--
     2.3283e+53     2.3283e+54             0.0000e+00       -17.216012597727
     9.3132e+53     9.3132e+54             0.0000e+00       -17.216012597727
     3.7253e+54     3.7253e+55             0.0000e+00       -17.216012597727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8997
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1795
    reference variance = 0.23073
====================================================
  Execution time = 2.0911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1417e-01
  Total weights = 1.956427718e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300157454930
                                         uncertainty =       0.002234702213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300157454930
                                         uncertainty =       0.002234702213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387350707
  error estimate for blocks of size 2^( 2) =       0.000396860313
  error estimate for blocks of size 2^( 3) =       0.000405095247
  error estimate for blocks of size 2^( 4) =       0.000411776135
  error estimate for blocks of size 2^( 5) =       0.000415931337
  error estimate for blocks of size 2^( 6) =       0.000418731040
  error estimate for blocks of size 2^( 7) =       0.000421523403

      target function =                  N/A
              le_mean =     -17.216582461042
             les_mean =     296.724881146834
             stat err =       0.000416990479
             autocorr =       1.158893622105
              std dev =       0.547796622566
             le_variance =       0.300081139695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658246104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+54, overlap shift 2.3283e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+54, overlap shift 9.3132e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+55, overlap shift 3.7253e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216582461074       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.227407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6929e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.319239
====================================================
  Execution time = 2.1424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1858e-01
  Total weights = 1.9564e+06
  Execution time = 1.8047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460402
  error estimate for blocks of size 2^( 2) =       0.000399364472
  error estimate for blocks of size 2^( 3) =       0.000408098425
  error estimate for blocks of size 2^( 4) =       0.000414565080
  error estimate for blocks of size 2^( 5) =       0.000418919325
  error estimate for blocks of size 2^( 6) =       0.000419856672
  error estimate for blocks of size 2^( 7) =       0.000420651441

      target function =                  N/A
              le_mean =     -17.216803042564
             les_mean =     296.736883662326
             stat err =       0.000418498130
             autocorr =       1.154676763290
              std dev =       0.550780183087
             le_variance =       0.303358810081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460402
  error estimate for blocks of size 2^( 2) =       0.000399364472
  error estimate for blocks of size 2^( 3) =       0.000408098425
  error estimate for blocks of size 2^( 4) =       0.000414565080
  error estimate for blocks of size 2^( 5) =       0.000418919325
  error estimate for blocks of size 2^( 6) =       0.000419856672
  error estimate for blocks of size 2^( 7) =       0.000420651441

      target function =                  N/A
              le_mean =     -17.216803042564
             les_mean =     296.736883662326
             stat err =       0.000418498130
             autocorr =       1.154676763290
              std dev =       0.550780183087
             le_variance =       0.303358810081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460402
  error estimate for blocks of size 2^( 2) =       0.000399364472
  error estimate for blocks of size 2^( 3) =       0.000408098425
  error estimate for blocks of size 2^( 4) =       0.000414565080
  error estimate for blocks of size 2^( 5) =       0.000418919325
  error estimate for blocks of size 2^( 6) =       0.000419856672
  error estimate for blocks of size 2^( 7) =       0.000420651441

      target function =                  N/A
              le_mean =     -17.216803042564
             les_mean =     296.736883662326
             stat err =       0.000418498130
             autocorr =       1.154676763290
              std dev =       0.550780183087
             le_variance =       0.303358810081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303431966117
                                         uncertainty =       0.002823099939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389460402
  error estimate for blocks of size 2^( 2) =       0.000399364472
  error estimate for blocks of size 2^( 3) =       0.000408098425
  error estimate for blocks of size 2^( 4) =       0.000414565080
  error estimate for blocks of size 2^( 5) =       0.000418919325
  error estimate for blocks of size 2^( 6) =       0.000419856672
  error estimate for blocks of size 2^( 7) =       0.000420651441

      target function =                  N/A
              le_mean =     -17.216803042564
             les_mean =     296.736883662326
             stat err =       0.000418498130
             autocorr =       1.154676763290
              std dev =       0.550780183087
             le_variance =       0.303358810081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216803042564        initial  <--
     2.3283e+54     2.3283e+55             0.0000e+00       -17.216803042564
     9.3132e+54     9.3132e+55             0.0000e+00       -17.216803042564
     3.7253e+55     3.7253e+56             0.0000e+00       -17.216803042564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5541
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.215896
====================================================
  Execution time = 2.0981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2128e-01
  Total weights = 1.956359416e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303418458922
                                         uncertainty =       0.002348467628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303418458922
                                         uncertainty =       0.002348467628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389478912
  error estimate for blocks of size 2^( 2) =       0.000399108300
  error estimate for blocks of size 2^( 3) =       0.000408483427
  error estimate for blocks of size 2^( 4) =       0.000415477266
  error estimate for blocks of size 2^( 5) =       0.000419643917
  error estimate for blocks of size 2^( 6) =       0.000422504778
  error estimate for blocks of size 2^( 7) =       0.000419954272

      target function =                  N/A
              le_mean =     -17.217099225284
             les_mean =     296.749785517953
             stat err =       0.000419395058
             autocorr =       1.159521271861
              std dev =       0.550806360185
             le_variance =       0.303387646420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709922528e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+55, overlap shift 2.3283e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+55, overlap shift 9.3132e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+56, overlap shift 3.7253e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099225347       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.228577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6968e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.173
    reference variance = 0.175625
====================================================
  Execution time = 2.0685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1734e-01
  Total weights = 1.9566e+06
  Execution time = 1.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386817757
  error estimate for blocks of size 2^( 2) =       0.000396799489
  error estimate for blocks of size 2^( 3) =       0.000405719420
  error estimate for blocks of size 2^( 4) =       0.000412429394
  error estimate for blocks of size 2^( 5) =       0.000417339569
  error estimate for blocks of size 2^( 6) =       0.000419169612
  error estimate for blocks of size 2^( 7) =       0.000420395143

      target function =                  N/A
              le_mean =     -17.215799286118
             les_mean =     296.701084406360
             stat err =       0.000417333429
             autocorr =       1.164001512566
              std dev =       0.547042917447
             le_variance =       0.299255953529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386817757
  error estimate for blocks of size 2^( 2) =       0.000396799489
  error estimate for blocks of size 2^( 3) =       0.000405719420
  error estimate for blocks of size 2^( 4) =       0.000412429394
  error estimate for blocks of size 2^( 5) =       0.000417339569
  error estimate for blocks of size 2^( 6) =       0.000419169612
  error estimate for blocks of size 2^( 7) =       0.000420395143

      target function =                  N/A
              le_mean =     -17.215799286118
             les_mean =     296.701084406360
             stat err =       0.000417333429
             autocorr =       1.164001512566
              std dev =       0.547042917447
             le_variance =       0.299255953529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386817757
  error estimate for blocks of size 2^( 2) =       0.000396799489
  error estimate for blocks of size 2^( 3) =       0.000405719420
  error estimate for blocks of size 2^( 4) =       0.000412429394
  error estimate for blocks of size 2^( 5) =       0.000417339569
  error estimate for blocks of size 2^( 6) =       0.000419169612
  error estimate for blocks of size 2^( 7) =       0.000420395143

      target function =                  N/A
              le_mean =     -17.215799286118
             les_mean =     296.701084406360
             stat err =       0.000417333429
             autocorr =       1.164001512566
              std dev =       0.547042917447
             le_variance =       0.299255953529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299259981684
                                         uncertainty =       0.002329345200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386817757
  error estimate for blocks of size 2^( 2) =       0.000396799489
  error estimate for blocks of size 2^( 3) =       0.000405719420
  error estimate for blocks of size 2^( 4) =       0.000412429394
  error estimate for blocks of size 2^( 5) =       0.000417339569
  error estimate for blocks of size 2^( 6) =       0.000419169612
  error estimate for blocks of size 2^( 7) =       0.000420395143

      target function =                  N/A
              le_mean =     -17.215799286118
             les_mean =     296.701084406360
             stat err =       0.000417333429
             autocorr =       1.164001512566
              std dev =       0.547042917447
             le_variance =       0.299255953529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215799286118        initial  <--
     2.3283e+55     2.3283e+56             0.0000e+00       -17.215799286118
     9.3132e+55     9.3132e+56             0.0000e+00       -17.215799286118
     3.7253e+56     3.7253e+57             0.0000e+00       -17.215799286118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8472
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6821e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2669
    reference variance = 0.19417
====================================================
  Execution time = 2.0848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1041e-01
  Total weights = 1.956788047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298236961559
                                         uncertainty =       0.001896343595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298236961559
                                         uncertainty =       0.001896343595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386116452
  error estimate for blocks of size 2^( 2) =       0.000396458201
  error estimate for blocks of size 2^( 3) =       0.000405684727
  error estimate for blocks of size 2^( 4) =       0.000413181261
  error estimate for blocks of size 2^( 5) =       0.000417394583
  error estimate for blocks of size 2^( 6) =       0.000420087965
  error estimate for blocks of size 2^( 7) =       0.000421844933

      target function =                  N/A
              le_mean =     -17.215901574463
             les_mean =     296.697676350862
             stat err =       0.000418127186
             autocorr =       1.172681832896
              std dev =       0.546051122767
             le_variance =       0.298171828675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590157446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+56, overlap shift 2.3283e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+56, overlap shift 9.3132e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+57, overlap shift 3.7253e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901574485       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.229759 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6786e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.202523
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1168e-01
  Total weights = 1.9564e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385596879
  error estimate for blocks of size 2^( 2) =       0.000395458475
  error estimate for blocks of size 2^( 3) =       0.000404378667
  error estimate for blocks of size 2^( 4) =       0.000411142876
  error estimate for blocks of size 2^( 5) =       0.000415506113
  error estimate for blocks of size 2^( 6) =       0.000417628626
  error estimate for blocks of size 2^( 7) =       0.000418943488

      target function =                  N/A
              le_mean =     -17.216145756044
             les_mean =     296.707357593666
             stat err =       0.000415805276
             autocorr =       1.162821277448
              std dev =       0.545316336209
             le_variance =       0.297369906537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385596879
  error estimate for blocks of size 2^( 2) =       0.000395458475
  error estimate for blocks of size 2^( 3) =       0.000404378667
  error estimate for blocks of size 2^( 4) =       0.000411142876
  error estimate for blocks of size 2^( 5) =       0.000415506113
  error estimate for blocks of size 2^( 6) =       0.000417628626
  error estimate for blocks of size 2^( 7) =       0.000418943488

      target function =                  N/A
              le_mean =     -17.216145756044
             les_mean =     296.707357593666
             stat err =       0.000415805276
             autocorr =       1.162821277448
              std dev =       0.545316336209
             le_variance =       0.297369906537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385596879
  error estimate for blocks of size 2^( 2) =       0.000395458475
  error estimate for blocks of size 2^( 3) =       0.000404378667
  error estimate for blocks of size 2^( 4) =       0.000411142876
  error estimate for blocks of size 2^( 5) =       0.000415506113
  error estimate for blocks of size 2^( 6) =       0.000417628626
  error estimate for blocks of size 2^( 7) =       0.000418943488

      target function =                  N/A
              le_mean =     -17.216145756044
             les_mean =     296.707357593666
             stat err =       0.000415805276
             autocorr =       1.162821277448
              std dev =       0.545316336209
             le_variance =       0.297369906537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297390900458
                                         uncertainty =       0.001816578758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385596879
  error estimate for blocks of size 2^( 2) =       0.000395458475
  error estimate for blocks of size 2^( 3) =       0.000404378667
  error estimate for blocks of size 2^( 4) =       0.000411142876
  error estimate for blocks of size 2^( 5) =       0.000415506113
  error estimate for blocks of size 2^( 6) =       0.000417628626
  error estimate for blocks of size 2^( 7) =       0.000418943488

      target function =                  N/A
              le_mean =     -17.216145756044
             les_mean =     296.707357593666
             stat err =       0.000415805276
             autocorr =       1.162821277448
              std dev =       0.545316336209
             le_variance =       0.297369906537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216145756044        initial  <--
     2.3283e+56     2.3283e+57             0.0000e+00       -17.216145756044
     9.3132e+56     9.3132e+57             0.0000e+00       -17.216145756044
     3.7253e+57     3.7253e+58             0.0000e+00       -17.216145756044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0189
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.679306
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1237e-01
  Total weights = 1.956525096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297726697266
                                         uncertainty =       0.001809192709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297726697266
                                         uncertainty =       0.001809192709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385839715
  error estimate for blocks of size 2^( 2) =       0.000396060765
  error estimate for blocks of size 2^( 3) =       0.000404875183
  error estimate for blocks of size 2^( 4) =       0.000410907505
  error estimate for blocks of size 2^( 5) =       0.000414982776
  error estimate for blocks of size 2^( 6) =       0.000417456577
  error estimate for blocks of size 2^( 7) =       0.000416109057

      target function =                  N/A
              le_mean =     -17.217561114248
             les_mean =     296.756778716623
             stat err =       0.000414863979
             autocorr =       1.156105852618
              std dev =       0.545659758024
             le_variance =       0.297744571527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721756111425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+57, overlap shift 2.3283e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217561114294       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217561114294       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+57 is 1.442380e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+57, overlap shift 9.3132e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217561114294       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217561114294       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+57 is 3.605950e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+58, overlap shift 3.7253e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217561114294       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217561114294       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+58 is 9.014874e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.230919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6910e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2555
    reference variance = 0.18638
====================================================
  Execution time = 2.0719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1465e-01
  Total weights = 1.9565e+06
  Execution time = 1.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387508771
  error estimate for blocks of size 2^( 2) =       0.000397714278
  error estimate for blocks of size 2^( 3) =       0.000406586011
  error estimate for blocks of size 2^( 4) =       0.000413886651
  error estimate for blocks of size 2^( 5) =       0.000418543072
  error estimate for blocks of size 2^( 6) =       0.000421012010
  error estimate for blocks of size 2^( 7) =       0.000422250634

      target function =                  N/A
              le_mean =     -17.216267126263
             les_mean =     296.714499156469
             stat err =       0.000418923092
             autocorr =       1.168706680931
              std dev =       0.548020159439
             le_variance =       0.300326095152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387508771
  error estimate for blocks of size 2^( 2) =       0.000397714278
  error estimate for blocks of size 2^( 3) =       0.000406586011
  error estimate for blocks of size 2^( 4) =       0.000413886651
  error estimate for blocks of size 2^( 5) =       0.000418543072
  error estimate for blocks of size 2^( 6) =       0.000421012010
  error estimate for blocks of size 2^( 7) =       0.000422250634

      target function =                  N/A
              le_mean =     -17.216267126263
             les_mean =     296.714499156469
             stat err =       0.000418923092
             autocorr =       1.168706680931
              std dev =       0.548020159439
             le_variance =       0.300326095152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387508771
  error estimate for blocks of size 2^( 2) =       0.000397714278
  error estimate for blocks of size 2^( 3) =       0.000406586011
  error estimate for blocks of size 2^( 4) =       0.000413886651
  error estimate for blocks of size 2^( 5) =       0.000418543072
  error estimate for blocks of size 2^( 6) =       0.000421012010
  error estimate for blocks of size 2^( 7) =       0.000422250634

      target function =                  N/A
              le_mean =     -17.216267126263
             les_mean =     296.714499156469
             stat err =       0.000418923092
             autocorr =       1.168706680931
              std dev =       0.548020159439
             le_variance =       0.300326095152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371523985
                                         uncertainty =       0.002480642996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387508771
  error estimate for blocks of size 2^( 2) =       0.000397714278
  error estimate for blocks of size 2^( 3) =       0.000406586011
  error estimate for blocks of size 2^( 4) =       0.000413886651
  error estimate for blocks of size 2^( 5) =       0.000418543072
  error estimate for blocks of size 2^( 6) =       0.000421012010
  error estimate for blocks of size 2^( 7) =       0.000422250634

      target function =                  N/A
              le_mean =     -17.216267126263
             les_mean =     296.714499156469
             stat err =       0.000418923092
             autocorr =       1.168706680931
              std dev =       0.548020159439
             le_variance =       0.300326095152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216267126263        initial  <--
     2.3283e+57     2.3283e+58             1.4424e-61       -17.216267126263
     9.3132e+57     9.3132e+58             3.6059e-62       -17.216267126263
     3.7253e+58     3.7253e+59             9.0149e-63       -17.216267126263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8797
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2757
    reference variance = 0.367875
====================================================
  Execution time = 2.0992e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1329e-01
  Total weights = 1.956794355e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298466706804
                                         uncertainty =       0.002014753368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298466706804
                                         uncertainty =       0.002014753368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386290284
  error estimate for blocks of size 2^( 2) =       0.000396047350
  error estimate for blocks of size 2^( 3) =       0.000404940904
  error estimate for blocks of size 2^( 4) =       0.000410959851
  error estimate for blocks of size 2^( 5) =       0.000415159299
  error estimate for blocks of size 2^( 6) =       0.000417618405
  error estimate for blocks of size 2^( 7) =       0.000418829839

      target function =                  N/A
              le_mean =     -17.216725765613
             les_mean =     296.728932510559
             stat err =       0.000415641849
             autocorr =       1.157739807119
              std dev =       0.546296958351
             le_variance =       0.298440366703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672576561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+58, overlap shift 2.3283e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725765639       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725765639       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725765639       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+58 is 2.381171e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+58, overlap shift 9.3132e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725765639       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725765639       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725765639       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+58 is 5.463936e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+59, overlap shift 3.7253e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216725765639       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216725765639       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216725765639       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+59 is 1.365984e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.232325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7078e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1471
    reference variance = 0.256875
====================================================
  Execution time = 2.2964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1093e-01
  Total weights = 1.9566e+06
  Execution time = 1.8157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486551
  error estimate for blocks of size 2^( 2) =       0.000395251968
  error estimate for blocks of size 2^( 3) =       0.000404426204
  error estimate for blocks of size 2^( 4) =       0.000411247426
  error estimate for blocks of size 2^( 5) =       0.000415088977
  error estimate for blocks of size 2^( 6) =       0.000418602448
  error estimate for blocks of size 2^( 7) =       0.000422783375

      target function =                  N/A
              le_mean =     -17.216589628496
             les_mean =     296.721891896497
             stat err =       0.000416930557
             autocorr =       1.169792921353
              std dev =       0.545160308750
             le_variance =       0.297199762236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486551
  error estimate for blocks of size 2^( 2) =       0.000395251968
  error estimate for blocks of size 2^( 3) =       0.000404426204
  error estimate for blocks of size 2^( 4) =       0.000411247426
  error estimate for blocks of size 2^( 5) =       0.000415088977
  error estimate for blocks of size 2^( 6) =       0.000418602448
  error estimate for blocks of size 2^( 7) =       0.000422783375

      target function =                  N/A
              le_mean =     -17.216589628496
             les_mean =     296.721891896497
             stat err =       0.000416930557
             autocorr =       1.169792921353
              std dev =       0.545160308750
             le_variance =       0.297199762236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486551
  error estimate for blocks of size 2^( 2) =       0.000395251968
  error estimate for blocks of size 2^( 3) =       0.000404426204
  error estimate for blocks of size 2^( 4) =       0.000411247426
  error estimate for blocks of size 2^( 5) =       0.000415088977
  error estimate for blocks of size 2^( 6) =       0.000418602448
  error estimate for blocks of size 2^( 7) =       0.000422783375

      target function =                  N/A
              le_mean =     -17.216589628496
             les_mean =     296.721891896497
             stat err =       0.000416930557
             autocorr =       1.169792921353
              std dev =       0.545160308750
             le_variance =       0.297199762236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297239676177
                                         uncertainty =       0.002141241946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385486551
  error estimate for blocks of size 2^( 2) =       0.000395251968
  error estimate for blocks of size 2^( 3) =       0.000404426204
  error estimate for blocks of size 2^( 4) =       0.000411247426
  error estimate for blocks of size 2^( 5) =       0.000415088977
  error estimate for blocks of size 2^( 6) =       0.000418602448
  error estimate for blocks of size 2^( 7) =       0.000422783375

      target function =                  N/A
              le_mean =     -17.216589628496
             les_mean =     296.721891896497
             stat err =       0.000416930557
             autocorr =       1.169792921353
              std dev =       0.545160308750
             le_variance =       0.297199762236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216589628496        initial  <--
     2.3283e+58     2.3283e+59             2.3812e-62       -17.216589628496
     9.3132e+58     9.3132e+59             5.4639e-63       -17.216589628496
     3.7253e+59     3.7253e+60             1.3660e-63       -17.216589628496

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2453
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.339214
====================================================
  Execution time = 2.0756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1974e-01
  Total weights = 1.956988153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303544701215
                                         uncertainty =       0.002438627315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303544701215
                                         uncertainty =       0.002438627315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389566446
  error estimate for blocks of size 2^( 2) =       0.000399232473
  error estimate for blocks of size 2^( 3) =       0.000408150452
  error estimate for blocks of size 2^( 4) =       0.000414268415
  error estimate for blocks of size 2^( 5) =       0.000418128718
  error estimate for blocks of size 2^( 6) =       0.000420724472
  error estimate for blocks of size 2^( 7) =       0.000419532908

      target function =                  N/A
              le_mean =     -17.216994911788
             les_mean =     296.744654516919
             stat err =       0.000418163628
             autocorr =       1.152204118425
              std dev =       0.550930151701
             le_variance =       0.303524032054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699491179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+59, overlap shift 2.3283e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+59, overlap shift 9.3132e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+60, overlap shift 3.7253e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216994911857       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.236814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6772e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1569
    reference variance = 0.231318
====================================================
  Execution time = 2.0698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1339e-01
  Total weights = 1.9565e+06
  Execution time = 1.8093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865449
  error estimate for blocks of size 2^( 2) =       0.000395772197
  error estimate for blocks of size 2^( 3) =       0.000404736438
  error estimate for blocks of size 2^( 4) =       0.000411148058
  error estimate for blocks of size 2^( 5) =       0.000414699546
  error estimate for blocks of size 2^( 6) =       0.000415997521
  error estimate for blocks of size 2^( 7) =       0.000417294484

      target function =                  N/A
              le_mean =     -17.216797120230
             les_mean =     296.731488153025
             stat err =       0.000414784902
             autocorr =       1.155511025853
              std dev =       0.545696151545
             le_variance =       0.297784289811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865449
  error estimate for blocks of size 2^( 2) =       0.000395772197
  error estimate for blocks of size 2^( 3) =       0.000404736438
  error estimate for blocks of size 2^( 4) =       0.000411148058
  error estimate for blocks of size 2^( 5) =       0.000414699546
  error estimate for blocks of size 2^( 6) =       0.000415997521
  error estimate for blocks of size 2^( 7) =       0.000417294484

      target function =                  N/A
              le_mean =     -17.216797120230
             les_mean =     296.731488153025
             stat err =       0.000414784902
             autocorr =       1.155511025853
              std dev =       0.545696151545
             le_variance =       0.297784289811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865449
  error estimate for blocks of size 2^( 2) =       0.000395772197
  error estimate for blocks of size 2^( 3) =       0.000404736438
  error estimate for blocks of size 2^( 4) =       0.000411148058
  error estimate for blocks of size 2^( 5) =       0.000414699546
  error estimate for blocks of size 2^( 6) =       0.000415997521
  error estimate for blocks of size 2^( 7) =       0.000417294484

      target function =                  N/A
              le_mean =     -17.216797120230
             les_mean =     296.731488153025
             stat err =       0.000414784902
             autocorr =       1.155511025853
              std dev =       0.545696151545
             le_variance =       0.297784289811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765936923
                                         uncertainty =       0.002062937723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865449
  error estimate for blocks of size 2^( 2) =       0.000395772197
  error estimate for blocks of size 2^( 3) =       0.000404736438
  error estimate for blocks of size 2^( 4) =       0.000411148058
  error estimate for blocks of size 2^( 5) =       0.000414699546
  error estimate for blocks of size 2^( 6) =       0.000415997521
  error estimate for blocks of size 2^( 7) =       0.000417294484

      target function =                  N/A
              le_mean =     -17.216797120230
             les_mean =     296.731488153025
             stat err =       0.000414784902
             autocorr =       1.155511025853
              std dev =       0.545696151545
             le_variance =       0.297784289811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216797120230        initial  <--
     2.3283e+59     2.3283e+60             0.0000e+00       -17.216797120230
     9.3132e+59     9.3132e+60             0.0000e+00       -17.216797120230
     3.7253e+60     3.7253e+61             0.0000e+00       -17.216797120230

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8511
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.188
    reference variance = 0.223269
====================================================
  Execution time = 2.1103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1194e-01
  Total weights = 1.956684948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297957610368
                                         uncertainty =       0.002254033166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297957610368
                                         uncertainty =       0.002254033166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385963552
  error estimate for blocks of size 2^( 2) =       0.000396105523
  error estimate for blocks of size 2^( 3) =       0.000405477181
  error estimate for blocks of size 2^( 4) =       0.000412613166
  error estimate for blocks of size 2^( 5) =       0.000416879962
  error estimate for blocks of size 2^( 6) =       0.000420083617
  error estimate for blocks of size 2^( 7) =       0.000421487038

      target function =                  N/A
              le_mean =     -17.216450413335
             les_mean =     296.718106442150
             stat err =       0.000417765946
             autocorr =       1.171584134091
              std dev =       0.545834890065
             le_variance =       0.297935727212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645041333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+60, overlap shift 2.3283e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216450413393       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450413393       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216450413393       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+60 is 1.751800e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+60, overlap shift 9.3132e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216450413393       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450413393       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+60 is 3.632185e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+61, overlap shift 3.7253e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216450413393       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216450413393       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.238171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7266e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.342417
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1945e-01
  Total weights = 1.9566e+06
  Execution time = 1.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387876637
  error estimate for blocks of size 2^( 2) =       0.000398047155
  error estimate for blocks of size 2^( 3) =       0.000407089636
  error estimate for blocks of size 2^( 4) =       0.000414174235
  error estimate for blocks of size 2^( 5) =       0.000418486671
  error estimate for blocks of size 2^( 6) =       0.000420777638
  error estimate for blocks of size 2^( 7) =       0.000422830841

      target function =                  N/A
              le_mean =     -17.215528109568
             les_mean =     296.693857327767
             stat err =       0.000419067346
             autocorr =       1.167294397498
              std dev =       0.548540400569
             le_variance =       0.300896571056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387876637
  error estimate for blocks of size 2^( 2) =       0.000398047155
  error estimate for blocks of size 2^( 3) =       0.000407089636
  error estimate for blocks of size 2^( 4) =       0.000414174235
  error estimate for blocks of size 2^( 5) =       0.000418486671
  error estimate for blocks of size 2^( 6) =       0.000420777638
  error estimate for blocks of size 2^( 7) =       0.000422830841

      target function =                  N/A
              le_mean =     -17.215528109568
             les_mean =     296.693857327767
             stat err =       0.000419067346
             autocorr =       1.167294397498
              std dev =       0.548540400569
             le_variance =       0.300896571056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387876637
  error estimate for blocks of size 2^( 2) =       0.000398047155
  error estimate for blocks of size 2^( 3) =       0.000407089636
  error estimate for blocks of size 2^( 4) =       0.000414174235
  error estimate for blocks of size 2^( 5) =       0.000418486671
  error estimate for blocks of size 2^( 6) =       0.000420777638
  error estimate for blocks of size 2^( 7) =       0.000422830841

      target function =                  N/A
              le_mean =     -17.215528109568
             les_mean =     296.693857327767
             stat err =       0.000419067346
             autocorr =       1.167294397498
              std dev =       0.548540400569
             le_variance =       0.300896571056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300974334209
                                         uncertainty =       0.002475694737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387876637
  error estimate for blocks of size 2^( 2) =       0.000398047155
  error estimate for blocks of size 2^( 3) =       0.000407089636
  error estimate for blocks of size 2^( 4) =       0.000414174235
  error estimate for blocks of size 2^( 5) =       0.000418486671
  error estimate for blocks of size 2^( 6) =       0.000420777638
  error estimate for blocks of size 2^( 7) =       0.000422830841

      target function =                  N/A
              le_mean =     -17.215528109568
             les_mean =     296.693857327767
             stat err =       0.000419067346
             autocorr =       1.167294397498
              std dev =       0.548540400569
             le_variance =       0.300896571056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215528109568        initial  <--
     2.3283e+60     2.3283e+61             1.7518e-64       -17.215528109568
     9.3132e+60     9.3132e+61             3.6322e-65       -17.215528109568
     3.7253e+61     3.7253e+62             0.0000e+00       -17.215528109568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1261
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.262
    reference variance = 0.195166
====================================================
  Execution time = 2.0865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1483e-01
  Total weights = 1.956569441e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301059474549
                                         uncertainty =       0.002328292416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301059474549
                                         uncertainty =       0.002328292416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387994944
  error estimate for blocks of size 2^( 2) =       0.000398113876
  error estimate for blocks of size 2^( 3) =       0.000407143663
  error estimate for blocks of size 2^( 4) =       0.000414821551
  error estimate for blocks of size 2^( 5) =       0.000418774241
  error estimate for blocks of size 2^( 6) =       0.000420162628
  error estimate for blocks of size 2^( 7) =       0.000420525285

      target function =                  N/A
              le_mean =     -17.216125729699
             les_mean =     296.709815482584
             stat err =       0.000418570926
             autocorr =       1.163820451461
              std dev =       0.548707712637
             le_variance =       0.301080153907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612572970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+61, overlap shift 2.3283e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216125729732       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216125729732       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+61 is 1.623540e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+61, overlap shift 9.3132e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216125729732       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216125729732       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+61 is 4.058851e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+62, overlap shift 3.7253e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216125729732       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216125729732       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+62 is 1.014713e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.239309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6905e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2323
    reference variance = 0.190294
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1391e-01
  Total weights = 1.9564e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800146
  error estimate for blocks of size 2^( 2) =       0.000397630785
  error estimate for blocks of size 2^( 3) =       0.000406903911
  error estimate for blocks of size 2^( 4) =       0.000414180061
  error estimate for blocks of size 2^( 5) =       0.000417285127
  error estimate for blocks of size 2^( 6) =       0.000420538772
  error estimate for blocks of size 2^( 7) =       0.000423209973

      target function =                  N/A
              le_mean =     -17.217119752021
             les_mean =     296.743124575031
             stat err =       0.000418803483
             autocorr =       1.166284850601
              std dev =       0.548432225527
             le_variance =       0.300777905996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800146
  error estimate for blocks of size 2^( 2) =       0.000397630785
  error estimate for blocks of size 2^( 3) =       0.000406903911
  error estimate for blocks of size 2^( 4) =       0.000414180061
  error estimate for blocks of size 2^( 5) =       0.000417285127
  error estimate for blocks of size 2^( 6) =       0.000420538772
  error estimate for blocks of size 2^( 7) =       0.000423209973

      target function =                  N/A
              le_mean =     -17.217119752021
             les_mean =     296.743124575031
             stat err =       0.000418803483
             autocorr =       1.166284850601
              std dev =       0.548432225527
             le_variance =       0.300777905996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800146
  error estimate for blocks of size 2^( 2) =       0.000397630785
  error estimate for blocks of size 2^( 3) =       0.000406903911
  error estimate for blocks of size 2^( 4) =       0.000414180061
  error estimate for blocks of size 2^( 5) =       0.000417285127
  error estimate for blocks of size 2^( 6) =       0.000420538772
  error estimate for blocks of size 2^( 7) =       0.000423209973

      target function =                  N/A
              le_mean =     -17.217119752021
             les_mean =     296.743124575031
             stat err =       0.000418803483
             autocorr =       1.166284850601
              std dev =       0.548432225527
             le_variance =       0.300777905996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300853158187
                                         uncertainty =       0.002828882345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800146
  error estimate for blocks of size 2^( 2) =       0.000397630785
  error estimate for blocks of size 2^( 3) =       0.000406903911
  error estimate for blocks of size 2^( 4) =       0.000414180061
  error estimate for blocks of size 2^( 5) =       0.000417285127
  error estimate for blocks of size 2^( 6) =       0.000420538772
  error estimate for blocks of size 2^( 7) =       0.000423209973

      target function =                  N/A
              le_mean =     -17.217119752021
             les_mean =     296.743124575031
             stat err =       0.000418803483
             autocorr =       1.166284850601
              std dev =       0.548432225527
             le_variance =       0.300777905996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217119752021        initial  <--
     2.3283e+61     2.3283e+62             1.6235e-65       -17.217119752021
     9.3132e+61     9.3132e+62             4.0589e-66       -17.217119752021
     3.7253e+62     3.7253e+63             1.0147e-66       -17.217119752021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8499
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6761e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.300495
====================================================
  Execution time = 2.1187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1897e-01
  Total weights = 1.956545145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298484840080
                                         uncertainty =       0.002195710407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298484840080
                                         uncertainty =       0.002195710407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386300362
  error estimate for blocks of size 2^( 2) =       0.000396792295
  error estimate for blocks of size 2^( 3) =       0.000405567563
  error estimate for blocks of size 2^( 4) =       0.000411660510
  error estimate for blocks of size 2^( 5) =       0.000417167836
  error estimate for blocks of size 2^( 6) =       0.000419756714
  error estimate for blocks of size 2^( 7) =       0.000421674278

      target function =                  N/A
              le_mean =     -17.215854995014
             les_mean =     296.704635310666
             stat err =       0.000417564835
             autocorr =       1.168416289973
              std dev =       0.546311211735
             le_variance =       0.298455940068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721585499501e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+62, overlap shift 2.3283e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+62, overlap shift 9.3132e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+63, overlap shift 3.7253e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215854995073       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.240483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7266e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2322
    reference variance = 0.183184
====================================================
  Execution time = 2.0876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1022e-01
  Total weights = 1.9570e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385315376
  error estimate for blocks of size 2^( 2) =       0.000395328038
  error estimate for blocks of size 2^( 3) =       0.000404435972
  error estimate for blocks of size 2^( 4) =       0.000411106411
  error estimate for blocks of size 2^( 5) =       0.000415218722
  error estimate for blocks of size 2^( 6) =       0.000417733138
  error estimate for blocks of size 2^( 7) =       0.000419382149

      target function =                  N/A
              le_mean =     -17.214973581241
             les_mean =     296.665536725990
             stat err =       0.000415860105
             autocorr =       1.164828096814
              std dev =       0.544918230347
             le_variance =       0.296935877764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385315376
  error estimate for blocks of size 2^( 2) =       0.000395328038
  error estimate for blocks of size 2^( 3) =       0.000404435972
  error estimate for blocks of size 2^( 4) =       0.000411106411
  error estimate for blocks of size 2^( 5) =       0.000415218722
  error estimate for blocks of size 2^( 6) =       0.000417733138
  error estimate for blocks of size 2^( 7) =       0.000419382149

      target function =                  N/A
              le_mean =     -17.214973581241
             les_mean =     296.665536725990
             stat err =       0.000415860105
             autocorr =       1.164828096814
              std dev =       0.544918230347
             le_variance =       0.296935877764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385315376
  error estimate for blocks of size 2^( 2) =       0.000395328038
  error estimate for blocks of size 2^( 3) =       0.000404435972
  error estimate for blocks of size 2^( 4) =       0.000411106411
  error estimate for blocks of size 2^( 5) =       0.000415218722
  error estimate for blocks of size 2^( 6) =       0.000417733138
  error estimate for blocks of size 2^( 7) =       0.000419382149

      target function =                  N/A
              le_mean =     -17.214973581241
             les_mean =     296.665536725990
             stat err =       0.000415860105
             autocorr =       1.164828096814
              std dev =       0.544918230347
             le_variance =       0.296935877764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296973700017
                                         uncertainty =       0.001781293145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385315376
  error estimate for blocks of size 2^( 2) =       0.000395328038
  error estimate for blocks of size 2^( 3) =       0.000404435972
  error estimate for blocks of size 2^( 4) =       0.000411106411
  error estimate for blocks of size 2^( 5) =       0.000415218722
  error estimate for blocks of size 2^( 6) =       0.000417733138
  error estimate for blocks of size 2^( 7) =       0.000419382149

      target function =                  N/A
              le_mean =     -17.214973581241
             les_mean =     296.665536725990
             stat err =       0.000415860105
             autocorr =       1.164828096814
              std dev =       0.544918230347
             le_variance =       0.296935877764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.214973581241        initial  <--
     2.3283e+62     2.3283e+63             0.0000e+00       -17.214973581241
     9.3132e+62     9.3132e+63             0.0000e+00       -17.214973581241
     3.7253e+63     3.7253e+64             0.0000e+00       -17.214973581241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0453
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2993
    reference variance = 0.497391
====================================================
  Execution time = 2.1317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1740e-01
  Total weights = 1.956363965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301645658016
                                         uncertainty =       0.002324282396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301645658016
                                         uncertainty =       0.002324282396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388374566
  error estimate for blocks of size 2^( 2) =       0.000398290644
  error estimate for blocks of size 2^( 3) =       0.000407738861
  error estimate for blocks of size 2^( 4) =       0.000413808630
  error estimate for blocks of size 2^( 5) =       0.000418901617
  error estimate for blocks of size 2^( 6) =       0.000420803549
  error estimate for blocks of size 2^( 7) =       0.000421996542

      target function =                  N/A
              le_mean =     -17.216114070463
             les_mean =     296.711982651446
             stat err =       0.000418877585
             autocorr =       1.163248975871
              std dev =       0.549244578647
             le_variance =       0.301669607173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611407046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+63, overlap shift 2.3283e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+63, overlap shift 9.3132e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+64, overlap shift 3.7253e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216114070516       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.241659 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7322e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.242028
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1800e-01
  Total weights = 1.9565e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386823669
  error estimate for blocks of size 2^( 2) =       0.000396695387
  error estimate for blocks of size 2^( 3) =       0.000405382484
  error estimate for blocks of size 2^( 4) =       0.000412029941
  error estimate for blocks of size 2^( 5) =       0.000415358569
  error estimate for blocks of size 2^( 6) =       0.000418099894
  error estimate for blocks of size 2^( 7) =       0.000418948237

      target function =                  N/A
              le_mean =     -17.217036331436
             les_mean =     296.744341240669
             stat err =       0.000416109160
             autocorr =       1.157146838752
              std dev =       0.547051278833
             le_variance =       0.299265101673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386823669
  error estimate for blocks of size 2^( 2) =       0.000396695387
  error estimate for blocks of size 2^( 3) =       0.000405382484
  error estimate for blocks of size 2^( 4) =       0.000412029941
  error estimate for blocks of size 2^( 5) =       0.000415358569
  error estimate for blocks of size 2^( 6) =       0.000418099894
  error estimate for blocks of size 2^( 7) =       0.000418948237

      target function =                  N/A
              le_mean =     -17.217036331436
             les_mean =     296.744341240669
             stat err =       0.000416109160
             autocorr =       1.157146838752
              std dev =       0.547051278833
             le_variance =       0.299265101673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386823669
  error estimate for blocks of size 2^( 2) =       0.000396695387
  error estimate for blocks of size 2^( 3) =       0.000405382484
  error estimate for blocks of size 2^( 4) =       0.000412029941
  error estimate for blocks of size 2^( 5) =       0.000415358569
  error estimate for blocks of size 2^( 6) =       0.000418099894
  error estimate for blocks of size 2^( 7) =       0.000418948237

      target function =                  N/A
              le_mean =     -17.217036331436
             les_mean =     296.744341240669
             stat err =       0.000416109160
             autocorr =       1.157146838752
              std dev =       0.547051278833
             le_variance =       0.299265101673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299306859531
                                         uncertainty =       0.002092593901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386823669
  error estimate for blocks of size 2^( 2) =       0.000396695387
  error estimate for blocks of size 2^( 3) =       0.000405382484
  error estimate for blocks of size 2^( 4) =       0.000412029941
  error estimate for blocks of size 2^( 5) =       0.000415358569
  error estimate for blocks of size 2^( 6) =       0.000418099894
  error estimate for blocks of size 2^( 7) =       0.000418948237

      target function =                  N/A
              le_mean =     -17.217036331436
             les_mean =     296.744341240669
             stat err =       0.000416109160
             autocorr =       1.157146838752
              std dev =       0.547051278833
             le_variance =       0.299265101673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217036331436        initial  <--
     2.3283e+63     2.3283e+64             0.0000e+00       -17.217036331436
     9.3132e+63     9.3132e+64             0.0000e+00       -17.217036331436
     3.7253e+64     3.7253e+65             0.0000e+00       -17.217036331436

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3979
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1452
    reference variance = 0.38899
====================================================
  Execution time = 2.0783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1408e-01
  Total weights = 1.956442694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870160230
                                         uncertainty =       0.001990879484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298870160230
                                         uncertainty =       0.001990879484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386511102
  error estimate for blocks of size 2^( 2) =       0.000396314177
  error estimate for blocks of size 2^( 3) =       0.000405051035
  error estimate for blocks of size 2^( 4) =       0.000411983337
  error estimate for blocks of size 2^( 5) =       0.000415561065
  error estimate for blocks of size 2^( 6) =       0.000417004992
  error estimate for blocks of size 2^( 7) =       0.000418877852

      target function =                  N/A
              le_mean =     -17.217353808414
             les_mean =     296.751352739993
             stat err =       0.000415856811
             autocorr =       1.157613791578
              std dev =       0.546609242765
             le_variance =       0.298781664276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721735380841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+64, overlap shift 2.3283e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+64, overlap shift 9.3132e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+65, overlap shift 3.7253e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217353808420       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.242838 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6784e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.200372
====================================================
  Execution time = 2.0829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1643e-01
  Total weights = 1.9565e+06
  Execution time = 1.8020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751145
  error estimate for blocks of size 2^( 2) =       0.000396430849
  error estimate for blocks of size 2^( 3) =       0.000405825715
  error estimate for blocks of size 2^( 4) =       0.000412582725
  error estimate for blocks of size 2^( 5) =       0.000416314654
  error estimate for blocks of size 2^( 6) =       0.000419352127
  error estimate for blocks of size 2^( 7) =       0.000422571980

      target function =                  N/A
              le_mean =     -17.216562617305
             les_mean =     296.726457597887
             stat err =       0.000417705372
             autocorr =       1.166478945826
              std dev =       0.546948714312
             le_variance =       0.299152896087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751145
  error estimate for blocks of size 2^( 2) =       0.000396430849
  error estimate for blocks of size 2^( 3) =       0.000405825715
  error estimate for blocks of size 2^( 4) =       0.000412582725
  error estimate for blocks of size 2^( 5) =       0.000416314654
  error estimate for blocks of size 2^( 6) =       0.000419352127
  error estimate for blocks of size 2^( 7) =       0.000422571980

      target function =                  N/A
              le_mean =     -17.216562617305
             les_mean =     296.726457597887
             stat err =       0.000417705372
             autocorr =       1.166478945826
              std dev =       0.546948714312
             le_variance =       0.299152896087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751145
  error estimate for blocks of size 2^( 2) =       0.000396430849
  error estimate for blocks of size 2^( 3) =       0.000405825715
  error estimate for blocks of size 2^( 4) =       0.000412582725
  error estimate for blocks of size 2^( 5) =       0.000416314654
  error estimate for blocks of size 2^( 6) =       0.000419352127
  error estimate for blocks of size 2^( 7) =       0.000422571980

      target function =                  N/A
              le_mean =     -17.216562617305
             les_mean =     296.726457597887
             stat err =       0.000417705372
             autocorr =       1.166478945826
              std dev =       0.546948714312
             le_variance =       0.299152896087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299140180216
                                         uncertainty =       0.003211244156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386751145
  error estimate for blocks of size 2^( 2) =       0.000396430849
  error estimate for blocks of size 2^( 3) =       0.000405825715
  error estimate for blocks of size 2^( 4) =       0.000412582725
  error estimate for blocks of size 2^( 5) =       0.000416314654
  error estimate for blocks of size 2^( 6) =       0.000419352127
  error estimate for blocks of size 2^( 7) =       0.000422571980

      target function =                  N/A
              le_mean =     -17.216562617305
             les_mean =     296.726457597887
             stat err =       0.000417705372
             autocorr =       1.166478945826
              std dev =       0.546948714312
             le_variance =       0.299152896087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216562617305        initial  <--
     2.3283e+64     2.3283e+65             0.0000e+00       -17.216562617305
     9.3132e+64     9.3132e+65             0.0000e+00       -17.216562617305
     3.7253e+65     3.7253e+66             0.0000e+00       -17.216562617305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9454
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1507
    reference variance = 0.19718
====================================================
  Execution time = 2.0911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0966e-01
  Total weights = 1.956555720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296723511444
                                         uncertainty =       0.001586498770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296723511444
                                         uncertainty =       0.001586498770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385676374
  error estimate for blocks of size 2^( 2) =       0.000395682012
  error estimate for blocks of size 2^( 3) =       0.000405315154
  error estimate for blocks of size 2^( 4) =       0.000411240929
  error estimate for blocks of size 2^( 5) =       0.000415837366
  error estimate for blocks of size 2^( 6) =       0.000418233113
  error estimate for blocks of size 2^( 7) =       0.000417609450

      target function =                  N/A
              le_mean =     -17.216564892715
             les_mean =     296.719770311924
             stat err =       0.000415730214
             autocorr =       1.161922354765
              std dev =       0.545428759044
             le_variance =       0.297492531192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656489271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+65, overlap shift 2.3283e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+65, overlap shift 9.3132e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+66, overlap shift 3.7253e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564892733       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.244031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6956e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.214747
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1383e-01
  Total weights = 1.9564e+06
  Execution time = 1.8097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386126862
  error estimate for blocks of size 2^( 2) =       0.000395912919
  error estimate for blocks of size 2^( 3) =       0.000405190965
  error estimate for blocks of size 2^( 4) =       0.000412181350
  error estimate for blocks of size 2^( 5) =       0.000416228159
  error estimate for blocks of size 2^( 6) =       0.000419720494
  error estimate for blocks of size 2^( 7) =       0.000420541574

      target function =                  N/A
              le_mean =     -17.215044954351
             les_mean =     296.671603126676
             stat err =       0.000417167894
             autocorr =       1.167244193505
              std dev =       0.546065845527
             le_variance =       0.298187907652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386126862
  error estimate for blocks of size 2^( 2) =       0.000395912919
  error estimate for blocks of size 2^( 3) =       0.000405190965
  error estimate for blocks of size 2^( 4) =       0.000412181350
  error estimate for blocks of size 2^( 5) =       0.000416228159
  error estimate for blocks of size 2^( 6) =       0.000419720494
  error estimate for blocks of size 2^( 7) =       0.000420541574

      target function =                  N/A
              le_mean =     -17.215044954351
             les_mean =     296.671603126676
             stat err =       0.000417167894
             autocorr =       1.167244193505
              std dev =       0.546065845527
             le_variance =       0.298187907652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386126862
  error estimate for blocks of size 2^( 2) =       0.000395912919
  error estimate for blocks of size 2^( 3) =       0.000405190965
  error estimate for blocks of size 2^( 4) =       0.000412181350
  error estimate for blocks of size 2^( 5) =       0.000416228159
  error estimate for blocks of size 2^( 6) =       0.000419720494
  error estimate for blocks of size 2^( 7) =       0.000420541574

      target function =                  N/A
              le_mean =     -17.215044954351
             les_mean =     296.671603126676
             stat err =       0.000417167894
             autocorr =       1.167244193505
              std dev =       0.546065845527
             le_variance =       0.298187907652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298216627877
                                         uncertainty =       0.001941090117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386126862
  error estimate for blocks of size 2^( 2) =       0.000395912919
  error estimate for blocks of size 2^( 3) =       0.000405190965
  error estimate for blocks of size 2^( 4) =       0.000412181350
  error estimate for blocks of size 2^( 5) =       0.000416228159
  error estimate for blocks of size 2^( 6) =       0.000419720494
  error estimate for blocks of size 2^( 7) =       0.000420541574

      target function =                  N/A
              le_mean =     -17.215044954351
             les_mean =     296.671603126676
             stat err =       0.000417167894
             autocorr =       1.167244193505
              std dev =       0.546065845527
             le_variance =       0.298187907652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215044954351        initial  <--
     2.3283e+65     2.3283e+66             0.0000e+00       -17.215044954351
     9.3132e+65     9.3132e+66             0.0000e+00       -17.215044954351
     3.7253e+66     3.7253e+67             0.0000e+00       -17.215044954351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7826
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2685
    reference variance = 0.275551
====================================================
  Execution time = 2.0772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1046e-01
  Total weights = 1.956489121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297347001861
                                         uncertainty =       0.001660614760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297347001861
                                         uncertainty =       0.001660614760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385545740
  error estimate for blocks of size 2^( 2) =       0.000395948492
  error estimate for blocks of size 2^( 3) =       0.000404955412
  error estimate for blocks of size 2^( 4) =       0.000412121685
  error estimate for blocks of size 2^( 5) =       0.000417370703
  error estimate for blocks of size 2^( 6) =       0.000419316800
  error estimate for blocks of size 2^( 7) =       0.000419748979

      target function =                  N/A
              le_mean =     -17.215626943262
             les_mean =     296.688269720255
             stat err =       0.000417139542
             autocorr =       1.170606420878
              std dev =       0.545244014276
             le_variance =       0.297291035104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721562694326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+66, overlap shift 2.3283e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+66, overlap shift 9.3132e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+67, overlap shift 3.7253e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215626943296       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.245199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6798e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.204
    reference variance = 0.368143
====================================================
  Execution time = 2.0681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1802e-01
  Total weights = 1.9566e+06
  Execution time = 1.8177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389643321
  error estimate for blocks of size 2^( 2) =       0.000399767687
  error estimate for blocks of size 2^( 3) =       0.000408704386
  error estimate for blocks of size 2^( 4) =       0.000415828775
  error estimate for blocks of size 2^( 5) =       0.000419452331
  error estimate for blocks of size 2^( 6) =       0.000422457684
  error estimate for blocks of size 2^( 7) =       0.000421764345

      target function =                  N/A
              le_mean =     -17.216534654216
             les_mean =     296.727089609438
             stat err =       0.000419875784
             autocorr =       1.161200417327
              std dev =       0.551038868792
             le_variance =       0.303643834920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389643321
  error estimate for blocks of size 2^( 2) =       0.000399767687
  error estimate for blocks of size 2^( 3) =       0.000408704386
  error estimate for blocks of size 2^( 4) =       0.000415828775
  error estimate for blocks of size 2^( 5) =       0.000419452331
  error estimate for blocks of size 2^( 6) =       0.000422457684
  error estimate for blocks of size 2^( 7) =       0.000421764345

      target function =                  N/A
              le_mean =     -17.216534654216
             les_mean =     296.727089609438
             stat err =       0.000419875784
             autocorr =       1.161200417327
              std dev =       0.551038868792
             le_variance =       0.303643834920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389643321
  error estimate for blocks of size 2^( 2) =       0.000399767687
  error estimate for blocks of size 2^( 3) =       0.000408704386
  error estimate for blocks of size 2^( 4) =       0.000415828775
  error estimate for blocks of size 2^( 5) =       0.000419452331
  error estimate for blocks of size 2^( 6) =       0.000422457684
  error estimate for blocks of size 2^( 7) =       0.000421764345

      target function =                  N/A
              le_mean =     -17.216534654216
             les_mean =     296.727089609438
             stat err =       0.000419875784
             autocorr =       1.161200417327
              std dev =       0.551038868792
             le_variance =       0.303643834920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303668102908
                                         uncertainty =       0.003235413347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389643321
  error estimate for blocks of size 2^( 2) =       0.000399767687
  error estimate for blocks of size 2^( 3) =       0.000408704386
  error estimate for blocks of size 2^( 4) =       0.000415828775
  error estimate for blocks of size 2^( 5) =       0.000419452331
  error estimate for blocks of size 2^( 6) =       0.000422457684
  error estimate for blocks of size 2^( 7) =       0.000421764345

      target function =                  N/A
              le_mean =     -17.216534654216
             les_mean =     296.727089609438
             stat err =       0.000419875784
             autocorr =       1.161200417327
              std dev =       0.551038868792
             le_variance =       0.303643834920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216534654216        initial  <--
     2.3283e+66     2.3283e+67             0.0000e+00       -17.216534654216
     9.3132e+66     9.3132e+67             0.0000e+00       -17.216534654216
     3.7253e+67     3.7253e+68             0.0000e+00       -17.216534654216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8734
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.429691
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0978e-01
  Total weights = 1.956498875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941436537
                                         uncertainty =       0.001882132159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296941436537
                                         uncertainty =       0.001882132159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385290669
  error estimate for blocks of size 2^( 2) =       0.000395394517
  error estimate for blocks of size 2^( 3) =       0.000404398163
  error estimate for blocks of size 2^( 4) =       0.000409936748
  error estimate for blocks of size 2^( 5) =       0.000414403600
  error estimate for blocks of size 2^( 6) =       0.000415116441
  error estimate for blocks of size 2^( 7) =       0.000414897479

      target function =                  N/A
              le_mean =     -17.216539595926
             les_mean =     296.719015535580
             stat err =       0.000413588567
             autocorr =       1.152285421026
              std dev =       0.544883289520
             le_variance =       0.296897799198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653959593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+67, overlap shift 2.3283e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+67, overlap shift 9.3132e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+68, overlap shift 3.7253e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216539595938       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.246363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7026e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2588
    reference variance = 0.227254
====================================================
  Execution time = 2.0822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1111e-01
  Total weights = 1.9565e+06
  Execution time = 1.8048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385174183
  error estimate for blocks of size 2^( 2) =       0.000395415121
  error estimate for blocks of size 2^( 3) =       0.000404446863
  error estimate for blocks of size 2^( 4) =       0.000411695535
  error estimate for blocks of size 2^( 5) =       0.000414728349
  error estimate for blocks of size 2^( 6) =       0.000416813779
  error estimate for blocks of size 2^( 7) =       0.000417750967

      target function =                  N/A
              le_mean =     -17.216359853686
             les_mean =     296.714155572246
             stat err =       0.000415247157
             autocorr =       1.162248505449
              std dev =       0.544718553453
             le_variance =       0.296718302476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385174183
  error estimate for blocks of size 2^( 2) =       0.000395415121
  error estimate for blocks of size 2^( 3) =       0.000404446863
  error estimate for blocks of size 2^( 4) =       0.000411695535
  error estimate for blocks of size 2^( 5) =       0.000414728349
  error estimate for blocks of size 2^( 6) =       0.000416813779
  error estimate for blocks of size 2^( 7) =       0.000417750967

      target function =                  N/A
              le_mean =     -17.216359853686
             les_mean =     296.714155572246
             stat err =       0.000415247157
             autocorr =       1.162248505449
              std dev =       0.544718553453
             le_variance =       0.296718302476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385174183
  error estimate for blocks of size 2^( 2) =       0.000395415121
  error estimate for blocks of size 2^( 3) =       0.000404446863
  error estimate for blocks of size 2^( 4) =       0.000411695535
  error estimate for blocks of size 2^( 5) =       0.000414728349
  error estimate for blocks of size 2^( 6) =       0.000416813779
  error estimate for blocks of size 2^( 7) =       0.000417750967

      target function =                  N/A
              le_mean =     -17.216359853686
             les_mean =     296.714155572246
             stat err =       0.000415247157
             autocorr =       1.162248505449
              std dev =       0.544718553453
             le_variance =       0.296718302476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296756889882
                                         uncertainty =       0.002539011592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385174183
  error estimate for blocks of size 2^( 2) =       0.000395415121
  error estimate for blocks of size 2^( 3) =       0.000404446863
  error estimate for blocks of size 2^( 4) =       0.000411695535
  error estimate for blocks of size 2^( 5) =       0.000414728349
  error estimate for blocks of size 2^( 6) =       0.000416813779
  error estimate for blocks of size 2^( 7) =       0.000417750967

      target function =                  N/A
              le_mean =     -17.216359853686
             les_mean =     296.714155572246
             stat err =       0.000415247157
             autocorr =       1.162248505449
              std dev =       0.544718553453
             le_variance =       0.296718302476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216359853686        initial  <--
     2.3283e+67     2.3283e+68             0.0000e+00       -17.216359853686
     9.3132e+67     9.3132e+68             0.0000e+00       -17.216359853686
     3.7253e+68     3.7253e+69             0.0000e+00       -17.216359853686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9487
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.241599
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1422e-01
  Total weights = 1.956194501e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298961354991
                                         uncertainty =       0.001938853887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298961354991
                                         uncertainty =       0.001938853887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386598677
  error estimate for blocks of size 2^( 2) =       0.000396655763
  error estimate for blocks of size 2^( 3) =       0.000405128372
  error estimate for blocks of size 2^( 4) =       0.000412212247
  error estimate for blocks of size 2^( 5) =       0.000416681653
  error estimate for blocks of size 2^( 6) =       0.000420157973
  error estimate for blocks of size 2^( 7) =       0.000419460458

      target function =                  N/A
              le_mean =     -17.216893608512
             les_mean =     296.735650237043
             stat err =       0.000417128083
             autocorr =       1.164174629438
              std dev =       0.546733092709
             le_variance =       0.298917074663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689360851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+68, overlap shift 2.3283e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+68, overlap shift 9.3132e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+69, overlap shift 3.7253e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216893608558       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.247542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7130e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2627
    reference variance = 0.194175
====================================================
  Execution time = 2.1250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1469e-01
  Total weights = 1.9564e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385835002
  error estimate for blocks of size 2^( 2) =       0.000395405724
  error estimate for blocks of size 2^( 3) =       0.000404546305
  error estimate for blocks of size 2^( 4) =       0.000410247546
  error estimate for blocks of size 2^( 5) =       0.000414559355
  error estimate for blocks of size 2^( 6) =       0.000416881672
  error estimate for blocks of size 2^( 7) =       0.000417991983

      target function =                  N/A
              le_mean =     -17.216034076874
             les_mean =     296.706516426965
             stat err =       0.000414920139
             autocorr =       1.156447127902
              std dev =       0.545653093223
             le_variance =       0.297737298143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385835002
  error estimate for blocks of size 2^( 2) =       0.000395405724
  error estimate for blocks of size 2^( 3) =       0.000404546305
  error estimate for blocks of size 2^( 4) =       0.000410247546
  error estimate for blocks of size 2^( 5) =       0.000414559355
  error estimate for blocks of size 2^( 6) =       0.000416881672
  error estimate for blocks of size 2^( 7) =       0.000417991983

      target function =                  N/A
              le_mean =     -17.216034076874
             les_mean =     296.706516426965
             stat err =       0.000414920139
             autocorr =       1.156447127902
              std dev =       0.545653093223
             le_variance =       0.297737298143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385835002
  error estimate for blocks of size 2^( 2) =       0.000395405724
  error estimate for blocks of size 2^( 3) =       0.000404546305
  error estimate for blocks of size 2^( 4) =       0.000410247546
  error estimate for blocks of size 2^( 5) =       0.000414559355
  error estimate for blocks of size 2^( 6) =       0.000416881672
  error estimate for blocks of size 2^( 7) =       0.000417991983

      target function =                  N/A
              le_mean =     -17.216034076874
             les_mean =     296.706516426965
             stat err =       0.000414920139
             autocorr =       1.156447127902
              std dev =       0.545653093223
             le_variance =       0.297737298143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297776883813
                                         uncertainty =       0.001857196406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385835002
  error estimate for blocks of size 2^( 2) =       0.000395405724
  error estimate for blocks of size 2^( 3) =       0.000404546305
  error estimate for blocks of size 2^( 4) =       0.000410247546
  error estimate for blocks of size 2^( 5) =       0.000414559355
  error estimate for blocks of size 2^( 6) =       0.000416881672
  error estimate for blocks of size 2^( 7) =       0.000417991983

      target function =                  N/A
              le_mean =     -17.216034076874
             les_mean =     296.706516426965
             stat err =       0.000414920139
             autocorr =       1.156447127902
              std dev =       0.545653093223
             le_variance =       0.297737298143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216034076874        initial  <--
     2.3283e+68     2.3283e+69             0.0000e+00       -17.216034076874
     9.3132e+68     9.3132e+69             0.0000e+00       -17.216034076874
     3.7253e+69     3.7253e+70             0.0000e+00       -17.216034076874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4202
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.191518
====================================================
  Execution time = 2.3089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1455e-01
  Total weights = 1.956246773e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300779626563
                                         uncertainty =       0.002269924117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300779626563
                                         uncertainty =       0.002269924117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387766217
  error estimate for blocks of size 2^( 2) =       0.000398034116
  error estimate for blocks of size 2^( 3) =       0.000407204134
  error estimate for blocks of size 2^( 4) =       0.000414040956
  error estimate for blocks of size 2^( 5) =       0.000417371630
  error estimate for blocks of size 2^( 6) =       0.000419761767
  error estimate for blocks of size 2^( 7) =       0.000419751605

      target function =                  N/A
              le_mean =     -17.215953825049
             les_mean =     296.703611836753
             stat err =       0.000417731490
             autocorr =       1.160524970320
              std dev =       0.548384243420
             le_variance =       0.300725278432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595382505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+69, overlap shift 2.3283e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+69, overlap shift 9.3132e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+70, overlap shift 3.7253e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953825066       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.248718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9203e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.162156
====================================================
  Execution time = 2.0870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1455e-01
  Total weights = 1.9565e+06
  Execution time = 1.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387145368
  error estimate for blocks of size 2^( 2) =       0.000397154404
  error estimate for blocks of size 2^( 3) =       0.000406052223
  error estimate for blocks of size 2^( 4) =       0.000413492786
  error estimate for blocks of size 2^( 5) =       0.000418901369
  error estimate for blocks of size 2^( 6) =       0.000419939975
  error estimate for blocks of size 2^( 7) =       0.000420291776

      target function =                  N/A
              le_mean =     -17.216855010789
             les_mean =     296.734648643014
             stat err =       0.000418156477
             autocorr =       1.166620275947
              std dev =       0.547506230060
             le_variance =       0.299763071955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387145368
  error estimate for blocks of size 2^( 2) =       0.000397154404
  error estimate for blocks of size 2^( 3) =       0.000406052223
  error estimate for blocks of size 2^( 4) =       0.000413492786
  error estimate for blocks of size 2^( 5) =       0.000418901369
  error estimate for blocks of size 2^( 6) =       0.000419939975
  error estimate for blocks of size 2^( 7) =       0.000420291776

      target function =                  N/A
              le_mean =     -17.216855010789
             les_mean =     296.734648643014
             stat err =       0.000418156477
             autocorr =       1.166620275947
              std dev =       0.547506230060
             le_variance =       0.299763071955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387145368
  error estimate for blocks of size 2^( 2) =       0.000397154404
  error estimate for blocks of size 2^( 3) =       0.000406052223
  error estimate for blocks of size 2^( 4) =       0.000413492786
  error estimate for blocks of size 2^( 5) =       0.000418901369
  error estimate for blocks of size 2^( 6) =       0.000419939975
  error estimate for blocks of size 2^( 7) =       0.000420291776

      target function =                  N/A
              le_mean =     -17.216855010789
             les_mean =     296.734648643014
             stat err =       0.000418156477
             autocorr =       1.166620275947
              std dev =       0.547506230060
             le_variance =       0.299763071955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299842829199
                                         uncertainty =       0.001699674350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387145368
  error estimate for blocks of size 2^( 2) =       0.000397154404
  error estimate for blocks of size 2^( 3) =       0.000406052223
  error estimate for blocks of size 2^( 4) =       0.000413492786
  error estimate for blocks of size 2^( 5) =       0.000418901369
  error estimate for blocks of size 2^( 6) =       0.000419939975
  error estimate for blocks of size 2^( 7) =       0.000420291776

      target function =                  N/A
              le_mean =     -17.216855010789
             les_mean =     296.734648643014
             stat err =       0.000418156477
             autocorr =       1.166620275947
              std dev =       0.547506230060
             le_variance =       0.299763071955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216855010789        initial  <--
     2.3283e+69     2.3283e+70             0.0000e+00       -17.216855010789
     9.3132e+69     9.3132e+70             0.0000e+00       -17.216855010789
     3.7253e+70     3.7253e+71             0.0000e+00       -17.216855010789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0427
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9252e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.235366
====================================================
  Execution time = 2.1440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1795e-01
  Total weights = 1.956562584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423969657
                                         uncertainty =       0.002271234268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302423969657
                                         uncertainty =       0.002271234268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388907631
  error estimate for blocks of size 2^( 2) =       0.000398778567
  error estimate for blocks of size 2^( 3) =       0.000407510210
  error estimate for blocks of size 2^( 4) =       0.000415531021
  error estimate for blocks of size 2^( 5) =       0.000419025971
  error estimate for blocks of size 2^( 6) =       0.000421920409
  error estimate for blocks of size 2^( 7) =       0.000424766573

      target function =                  N/A
              le_mean =     -17.216593286109
             les_mean =     296.729030894675
             stat err =       0.000420310994
             autocorr =       1.168015402116
              std dev =       0.549998446002
             le_variance =       0.302498290604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659328611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+70, overlap shift 2.3283e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+70, overlap shift 9.3132e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+71, overlap shift 3.7253e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216593286183       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.249889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7647e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.32667
====================================================
  Execution time = 2.0900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1245e-01
  Total weights = 1.9566e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963376
  error estimate for blocks of size 2^( 2) =       0.000397151438
  error estimate for blocks of size 2^( 3) =       0.000406554117
  error estimate for blocks of size 2^( 4) =       0.000413377275
  error estimate for blocks of size 2^( 5) =       0.000418402539
  error estimate for blocks of size 2^( 6) =       0.000421936110
  error estimate for blocks of size 2^( 7) =       0.000424151981

      target function =                  N/A
              le_mean =     -17.216462710492
             les_mean =     296.719033349305
             stat err =       0.000419466976
             autocorr =       1.175048583331
              std dev =       0.547248855043
             le_variance =       0.299481309346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963376
  error estimate for blocks of size 2^( 2) =       0.000397151438
  error estimate for blocks of size 2^( 3) =       0.000406554117
  error estimate for blocks of size 2^( 4) =       0.000413377275
  error estimate for blocks of size 2^( 5) =       0.000418402539
  error estimate for blocks of size 2^( 6) =       0.000421936110
  error estimate for blocks of size 2^( 7) =       0.000424151981

      target function =                  N/A
              le_mean =     -17.216462710492
             les_mean =     296.719033349305
             stat err =       0.000419466976
             autocorr =       1.175048583331
              std dev =       0.547248855043
             le_variance =       0.299481309346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963376
  error estimate for blocks of size 2^( 2) =       0.000397151438
  error estimate for blocks of size 2^( 3) =       0.000406554117
  error estimate for blocks of size 2^( 4) =       0.000413377275
  error estimate for blocks of size 2^( 5) =       0.000418402539
  error estimate for blocks of size 2^( 6) =       0.000421936110
  error estimate for blocks of size 2^( 7) =       0.000424151981

      target function =                  N/A
              le_mean =     -17.216462710492
             les_mean =     296.719033349305
             stat err =       0.000419466976
             autocorr =       1.175048583331
              std dev =       0.547248855043
             le_variance =       0.299481309346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299459625044
                                         uncertainty =       0.002513867916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386963376
  error estimate for blocks of size 2^( 2) =       0.000397151438
  error estimate for blocks of size 2^( 3) =       0.000406554117
  error estimate for blocks of size 2^( 4) =       0.000413377275
  error estimate for blocks of size 2^( 5) =       0.000418402539
  error estimate for blocks of size 2^( 6) =       0.000421936110
  error estimate for blocks of size 2^( 7) =       0.000424151981

      target function =                  N/A
              le_mean =     -17.216462710492
             les_mean =     296.719033349305
             stat err =       0.000419466976
             autocorr =       1.175048583331
              std dev =       0.547248855043
             le_variance =       0.299481309346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216462710492        initial  <--
     2.3283e+70     2.3283e+71             0.0000e+00       -17.216462710492
     9.3132e+70     9.3132e+71             0.0000e+00       -17.216462710492
     3.7253e+71     3.7253e+72             0.0000e+00       -17.216462710492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0627
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.21462
====================================================
  Execution time = 2.1045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1485e-01
  Total weights = 1.956728211e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299897434744
                                         uncertainty =       0.001866971590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299897434744
                                         uncertainty =       0.001866971590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387216851
  error estimate for blocks of size 2^( 2) =       0.000397096460
  error estimate for blocks of size 2^( 3) =       0.000405896961
  error estimate for blocks of size 2^( 4) =       0.000412650455
  error estimate for blocks of size 2^( 5) =       0.000416242921
  error estimate for blocks of size 2^( 6) =       0.000417912383
  error estimate for blocks of size 2^( 7) =       0.000418762879

      target function =                  N/A
              le_mean =     -17.216563806911
             les_mean =     296.724919325276
             stat err =       0.000416392160
             autocorr =       1.156369393692
              std dev =       0.547607322971
             le_variance =       0.299873780171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656380691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+71, overlap shift 2.3283e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216563806957       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216563806957       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+71 is 1.889906e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+71, overlap shift 9.3132e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216563806957       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216563806957       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216563806957       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+71 is 4.922047e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+72, overlap shift 3.7253e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216563806957       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216563806957       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216563806957       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+72 is 1.230512e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.251235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7124e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1939
    reference variance = 0.444087
====================================================
  Execution time = 2.0796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1766e-01
  Total weights = 1.9564e+06
  Execution time = 1.8156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387639485
  error estimate for blocks of size 2^( 2) =       0.000397866909
  error estimate for blocks of size 2^( 3) =       0.000406778523
  error estimate for blocks of size 2^( 4) =       0.000413538935
  error estimate for blocks of size 2^( 5) =       0.000418143601
  error estimate for blocks of size 2^( 6) =       0.000421069162
  error estimate for blocks of size 2^( 7) =       0.000422173116

      target function =                  N/A
              le_mean =     -17.216689583698
             les_mean =     296.732059956467
             stat err =       0.000418731203
             autocorr =       1.166848934101
              std dev =       0.548205017386
             le_variance =       0.300528741087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387639485
  error estimate for blocks of size 2^( 2) =       0.000397866909
  error estimate for blocks of size 2^( 3) =       0.000406778523
  error estimate for blocks of size 2^( 4) =       0.000413538935
  error estimate for blocks of size 2^( 5) =       0.000418143601
  error estimate for blocks of size 2^( 6) =       0.000421069162
  error estimate for blocks of size 2^( 7) =       0.000422173116

      target function =                  N/A
              le_mean =     -17.216689583698
             les_mean =     296.732059956467
             stat err =       0.000418731203
             autocorr =       1.166848934101
              std dev =       0.548205017386
             le_variance =       0.300528741087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387639485
  error estimate for blocks of size 2^( 2) =       0.000397866909
  error estimate for blocks of size 2^( 3) =       0.000406778523
  error estimate for blocks of size 2^( 4) =       0.000413538935
  error estimate for blocks of size 2^( 5) =       0.000418143601
  error estimate for blocks of size 2^( 6) =       0.000421069162
  error estimate for blocks of size 2^( 7) =       0.000422173116

      target function =                  N/A
              le_mean =     -17.216689583698
             les_mean =     296.732059956467
             stat err =       0.000418731203
             autocorr =       1.166848934101
              std dev =       0.548205017386
             le_variance =       0.300528741087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300554329649
                                         uncertainty =       0.002087974921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387639485
  error estimate for blocks of size 2^( 2) =       0.000397866909
  error estimate for blocks of size 2^( 3) =       0.000406778523
  error estimate for blocks of size 2^( 4) =       0.000413538935
  error estimate for blocks of size 2^( 5) =       0.000418143601
  error estimate for blocks of size 2^( 6) =       0.000421069162
  error estimate for blocks of size 2^( 7) =       0.000422173116

      target function =                  N/A
              le_mean =     -17.216689583698
             les_mean =     296.732059956467
             stat err =       0.000418731203
             autocorr =       1.166848934101
              std dev =       0.548205017386
             le_variance =       0.300528741087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216689583698        initial  <--
     2.3283e+71     2.3283e+72             1.8899e-75       -17.216689583698
     9.3132e+71     9.3132e+72             4.9220e-76       -17.216689583698
     3.7253e+72     3.7253e+73             1.2305e-76       -17.216689583698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9852
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.187972
====================================================
  Execution time = 2.0849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1254e-01
  Total weights = 1.956448007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534395385
                                         uncertainty =       0.001957211825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299534395385
                                         uncertainty =       0.001957211825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386980384
  error estimate for blocks of size 2^( 2) =       0.000397103173
  error estimate for blocks of size 2^( 3) =       0.000405979379
  error estimate for blocks of size 2^( 4) =       0.000412164078
  error estimate for blocks of size 2^( 5) =       0.000415971055
  error estimate for blocks of size 2^( 6) =       0.000419609085
  error estimate for blocks of size 2^( 7) =       0.000420411061

      target function =                  N/A
              le_mean =     -17.215925103803
             les_mean =     296.700618207217
             stat err =       0.000417038820
             autocorr =       1.161381927976
              std dev =       0.547272906968
             le_variance =       0.299507634701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592510380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+72, overlap shift 2.3283e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+72, overlap shift 9.3132e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+73, overlap shift 3.7253e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925103820       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.252431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6856e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2242
    reference variance = 0.357421
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1651e-01
  Total weights = 1.9565e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387208216
  error estimate for blocks of size 2^( 2) =       0.000397272203
  error estimate for blocks of size 2^( 3) =       0.000406530660
  error estimate for blocks of size 2^( 4) =       0.000413572923
  error estimate for blocks of size 2^( 5) =       0.000418245430
  error estimate for blocks of size 2^( 6) =       0.000420629536
  error estimate for blocks of size 2^( 7) =       0.000422742296

      target function =                  N/A
              le_mean =     -17.216480122039
             les_mean =     296.723701067417
             stat err =       0.000418797546
             autocorr =       1.169820236064
              std dev =       0.547595110326
             le_variance =       0.299860404853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387208216
  error estimate for blocks of size 2^( 2) =       0.000397272203
  error estimate for blocks of size 2^( 3) =       0.000406530660
  error estimate for blocks of size 2^( 4) =       0.000413572923
  error estimate for blocks of size 2^( 5) =       0.000418245430
  error estimate for blocks of size 2^( 6) =       0.000420629536
  error estimate for blocks of size 2^( 7) =       0.000422742296

      target function =                  N/A
              le_mean =     -17.216480122039
             les_mean =     296.723701067417
             stat err =       0.000418797546
             autocorr =       1.169820236064
              std dev =       0.547595110326
             le_variance =       0.299860404853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387208216
  error estimate for blocks of size 2^( 2) =       0.000397272203
  error estimate for blocks of size 2^( 3) =       0.000406530660
  error estimate for blocks of size 2^( 4) =       0.000413572923
  error estimate for blocks of size 2^( 5) =       0.000418245430
  error estimate for blocks of size 2^( 6) =       0.000420629536
  error estimate for blocks of size 2^( 7) =       0.000422742296

      target function =                  N/A
              le_mean =     -17.216480122039
             les_mean =     296.723701067417
             stat err =       0.000418797546
             autocorr =       1.169820236064
              std dev =       0.547595110326
             le_variance =       0.299860404853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299883257894
                                         uncertainty =       0.002022022066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387208216
  error estimate for blocks of size 2^( 2) =       0.000397272203
  error estimate for blocks of size 2^( 3) =       0.000406530660
  error estimate for blocks of size 2^( 4) =       0.000413572923
  error estimate for blocks of size 2^( 5) =       0.000418245430
  error estimate for blocks of size 2^( 6) =       0.000420629536
  error estimate for blocks of size 2^( 7) =       0.000422742296

      target function =                  N/A
              le_mean =     -17.216480122039
             les_mean =     296.723701067417
             stat err =       0.000418797546
             autocorr =       1.169820236064
              std dev =       0.547595110326
             le_variance =       0.299860404853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216480122039        initial  <--
     2.3283e+72     2.3283e+73             0.0000e+00       -17.216480122039
     9.3132e+72     9.3132e+73             0.0000e+00       -17.216480122039
     3.7253e+73     3.7253e+74             0.0000e+00       -17.216480122039

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9247
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6787e+01 secs
  Total Execution time = 5.7352e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
